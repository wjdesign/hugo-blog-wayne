<!doctype html><html lang=zh-tw dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="ç¶²ç«™å»ºç½®ä¸æ˜¯ä»¶ç°¡å–®çš„äº‹ï¼Œæˆ‘å€‘éƒ½çŸ¥é“ç¶²ç«™åšå¥½ä¹‹å¾Œï¼Œæœ‰å¥½å¤šç´°ç¯€éœ€è¦å…¼é¡§ï¼Œæ‰€ä»¥è¨±å¤šå…¬å¸èŠ±äº†å¤§é‡çš„æ™‚é–“èˆ‡é‡‘éŒ¢ï¼Œè€—ç”¨äººåŠ›å°ç¶­è­·ä¸­çš„ç¶²ç«™é€²è¡Œä¸æ–·çš„ã€é‡è¤‡çš„äººå·¥æ¸¬è©¦ï¼Œæƒ³é”åˆ°çš„ç›®çš„ä¸å¤–ä¹æ˜¯å¸Œæœ›ç¶²ç«™ä¸è¦å‡ºéŒ¯ï¼Œå¯ä»¥çµ¦å®¢æˆ¶/ä½¿ç”¨è€…æœ€å¥½çš„ç¶²ç«™ä½¿ç”¨é«”é©—ã€‚æœ¬ç¯‡ç« èªªæ˜ä½¿ç”¨ Vue3 é–‹ç™¼çš„å°ˆæ¡ˆï¼Œå°å…¥ Vitest é€²è¡Œæ¥µé€Ÿå–®å…ƒæ¸¬è©¦çš„é«”é©—ï¼"><meta name=keywords content="javascript,vue,vite,vitest,unit test,unit,å–®å…ƒ,æ¸¬è©¦,å–®å…ƒæ¸¬è©¦"><title>é—¡è¿°å–®å…ƒæ¸¬è©¦ã€å…ƒä»¶æ¸¬è©¦ï¼Œä¸¦å­¸ç¿’åœ¨è‡ªå·±çš„ Vue3 å°ˆæ¡ˆä¸­åŠ å…¥ Vitestï¼</title><link rel=canonical href=https://wayneblog.ga/2022-12-29/vitest-unit-test/><link rel=stylesheet href=https://wayneblog.ga/scss/style.min.500a9027405aec36a424dd29f18c89ede2aef02d12c577ed94fe7a53d759fe1f.css><script>!function(e,t,n,s,o,i,a){if(e.fbq)return;o=e.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)},e._fbq||(e._fbq=o),o.push=o,o.loaded=!0,o.version="2.0",o.queue=[],i=t.createElement(n),i.async=!0,i.src=s,a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(i,a)}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js"),fbq("init","843131703668116"),fbq("track","PageView")</script><noscript><img height=1 width=1 style=display:none src="https://www.facebook.com/tr?id=843131703668116&ev=PageView&noscript=1"></noscript><meta property="og:title" content="é—¡è¿°å–®å…ƒæ¸¬è©¦ã€å…ƒä»¶æ¸¬è©¦ï¼Œä¸¦å­¸ç¿’åœ¨è‡ªå·±çš„ Vue3 å°ˆæ¡ˆä¸­åŠ å…¥ Vitestï¼"><meta property="og:description" content="ç¶²ç«™å»ºç½®ä¸æ˜¯ä»¶ç°¡å–®çš„äº‹ï¼Œæˆ‘å€‘éƒ½çŸ¥é“ç¶²ç«™åšå¥½ä¹‹å¾Œï¼Œæœ‰å¥½å¤šç´°ç¯€éœ€è¦å…¼é¡§ï¼Œæ‰€ä»¥è¨±å¤šå…¬å¸èŠ±äº†å¤§é‡çš„æ™‚é–“èˆ‡é‡‘éŒ¢ï¼Œè€—ç”¨äººåŠ›å°ç¶­è­·ä¸­çš„ç¶²ç«™é€²è¡Œä¸æ–·çš„ã€é‡è¤‡çš„äººå·¥æ¸¬è©¦ï¼Œæƒ³é”åˆ°çš„ç›®çš„ä¸å¤–ä¹æ˜¯å¸Œæœ›ç¶²ç«™ä¸è¦å‡ºéŒ¯ï¼Œå¯ä»¥çµ¦å®¢æˆ¶/ä½¿ç”¨è€…æœ€å¥½çš„ç¶²ç«™ä½¿ç”¨é«”é©—ã€‚æœ¬ç¯‡ç« èªªæ˜ä½¿ç”¨ Vue3 é–‹ç™¼çš„å°ˆæ¡ˆï¼Œå°å…¥ Vitest é€²è¡Œæ¥µé€Ÿå–®å…ƒæ¸¬è©¦çš„é«”é©—ï¼"><meta property="og:url" content="https://wayneblog.ga/2022-12-29/vitest-unit-test/"><meta property="og:site_name" content="Wayne's blog | å‰æ©çš„éƒ¨è½æ ¼ | æŠ€è¡“åšå®¢"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="vitest"><meta property="article:tag" content="typescript"><meta property="article:tag" content="javascript"><meta property="article:published_time" content="2022-12-29T00:00:00+00:00"><meta property="article:modified_time" content="2022-12-29T00:00:00+00:00"><meta property="og:image" content="https://madewithnetworkfra.fra1.digitaloceanspaces.com/spatie-space-production/29079/vitest.jpg"><meta name=twitter:site content="@4006wayne"><meta name=twitter:creator content="@4006wayne"><meta name=twitter:title content="é—¡è¿°å–®å…ƒæ¸¬è©¦ã€å…ƒä»¶æ¸¬è©¦ï¼Œä¸¦å­¸ç¿’åœ¨è‡ªå·±çš„ Vue3 å°ˆæ¡ˆä¸­åŠ å…¥ Vitestï¼"><meta name=twitter:description content="ç¶²ç«™å»ºç½®ä¸æ˜¯ä»¶ç°¡å–®çš„äº‹ï¼Œæˆ‘å€‘éƒ½çŸ¥é“ç¶²ç«™åšå¥½ä¹‹å¾Œï¼Œæœ‰å¥½å¤šç´°ç¯€éœ€è¦å…¼é¡§ï¼Œæ‰€ä»¥è¨±å¤šå…¬å¸èŠ±äº†å¤§é‡çš„æ™‚é–“èˆ‡é‡‘éŒ¢ï¼Œè€—ç”¨äººåŠ›å°ç¶­è­·ä¸­çš„ç¶²ç«™é€²è¡Œä¸æ–·çš„ã€é‡è¤‡çš„äººå·¥æ¸¬è©¦ï¼Œæƒ³é”åˆ°çš„ç›®çš„ä¸å¤–ä¹æ˜¯å¸Œæœ›ç¶²ç«™ä¸è¦å‡ºéŒ¯ï¼Œå¯ä»¥çµ¦å®¢æˆ¶/ä½¿ç”¨è€…æœ€å¥½çš„ç¶²ç«™ä½¿ç”¨é«”é©—ã€‚æœ¬ç¯‡ç« èªªæ˜ä½¿ç”¨ Vue3 é–‹ç™¼çš„å°ˆæ¡ˆï¼Œå°å…¥ Vitest é€²è¡Œæ¥µé€Ÿå–®å…ƒæ¸¬è©¦çš„é«”é©—ï¼"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://madewithnetworkfra.fra1.digitaloceanspaces.com/spatie-space-production/29079/vitest.jpg"><link rel="shortcut icon" href=https://live.staticflickr.com/65535/52275825736_808b1fd4a8_o.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-FG6KQD7H6C"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FG6KQD7H6C",{anonymize_ip:!1})}</script><link rel=stylesheet type=text/css href=./toastify/style.min.css><script type=text/javascript src=./toastify/index.js></script><script>const hackKey="hack",author="Wayne (å‰æ©)",link="https://wayneblog.ga/",source="Wayne\u0027s blog | å‰æ©çš„éƒ¨è½æ ¼ | æŠ€è¡“åšå®¢",warningText="è«‹é‡è¦–è‘—ä½œæ¬Šï¼Œå•†æ¥­è½‰è¼‰è«‹è¯ç¹«ä½œè€…ç²å¾—æˆæ¬Šï¼Œéå•†æ¥­è½‰è¼‰è«‹è¨»æ˜å‡ºè™•ã€‚",warningBackgroundColor="linear-gradient(to right, rgb(108 47 87), rgb(191 86 86))",successBackgroundColor="linear-gradient(to right, rgb(47 151 127), rgb(69 195 137))",ignoreTagNames=["INPUT"];window.addEventListener("keyup",function(e){if(document.activeElement&&ignoreTagNames.includes(document.activeElement.tagName))return;if(e.key&&e.key.toLowerCase()==="h"){let e={text:"",duration:1e3,destination:"",newWindow:!0,close:!0,gravity:"top",position:"center",stopOnFocus:!1,style:{borderRadius:"50em"}};const t=new URL(window.location.href),n=new URLSearchParams(t.search);if(n.has(hackKey)){e.text="Hackæ¨¡å¼å·²é—œé–‰",e.style.background=warningBackgroundColor,Toastify(e).showToast(),n.delete(hackKey),t.search=n.toString(),window.history.replaceState(null,"",t.toString());return}e.text="Hackæ¨¡å¼å·²é–‹å•Ÿ",e.style.background=successBackgroundColor,Toastify(e).showToast(),n.set(hackKey,"1"),t.search=n.toString(),window.history.replaceState(null,"",t.toString())}}),window.addEventListener("copy",function(e){const t=new URL(window.location.href),n=new URLSearchParams(t.search);if(!n.has(hackKey)){e.preventDefault();const t=document.getSelection();e.clipboardData.setData("text/plain",`${t.toString()}

ä½œè€…ï¼š${author}
é€£çµï¼š${link}
ä¾†æºï¼š${source}
${warningText}`)}})</script><style>:root{--zh-font-family:"Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”";--code-font-family:Menlo, Monaco, Consolas, "Courier New"}</style><meta name=theme-color content="#57BCB9"><link rel=manifest href=./manifest.json><link rel=apple-touch-icon sizes=57x57 href=./apple-touch-icon-57x57.webp><link rel=apple-touch-icon sizes=114x114 href=./apple-touch-icon-114x114.webp><link rel=apple-touch-icon sizes=120x120 href=./apple-touch-icon-120x120.webp><link rel=apple-touch-icon sizes=180x180 href=./apple-touch-icon-180x180.webp><link rel=apple-touch-icon sizes=192x192 href=./apple-touch-icon-192x192.webp><link rel=apple-touch-icon sizes=512x512 href=./apple-touch-icon-512x512.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ›é¸å–®>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=https://wayneblog.ga/><img src=https://wayneblog.ga/img/avatar2d.webp width=256 height=256 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ§§</span></figure><div class=site-meta><h1 class=site-name><a href=https://wayneblog.ga/>Wayne (å‰æ©)</a></h1><h2 class=site-description>è»Ÿé«”é–‹ç™¼ | ç¶²è·¯å·¥ç¨‹ | æŠ€è¡“åšå®¢</h2></div></header><ol class=social-menu><li><a href=https://www.facebook.com/wayne.blog.ga/ target=_blank title=Facebook rel=me><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48" height="48"><linearGradient id="CXanuwD9EGkBgTn76_1mxa" x1="9.993" x2="40.615" y1="-299.993" y2="-330.615" gradientTransform="matrix(1 0 0 -1 0 -290)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#2aa4f4"/><stop offset="1" stop-color="#007ad9"/></linearGradient><path fill="url(#CXanuwD9EGkBgTn76_1mxa)" d="M24 4C12.954 4 4 12.954 4 24c0 10.028 7.379 18.331 17.004 19.777C21.981 43.924 22.982 41 24 41c.919.0 1.824 2.938 2.711 2.818C36.475 42.495 44 34.127 44 24 44 12.954 35.046 4 24 4z"/><path d="M27.707 21.169c0-1.424.305-3.121 1.757-3.121h4.283l-.001-5.617-.05-.852-.846-.114c-.608-.082-1.873-.253-4.206-.253-5.569.0-8.636 3.315-8.636 9.334v2.498H15.06v7.258h4.948V43.6C21.298 43.861 22.633 44 24 44c1.268.0 2.504-.131 3.707-.357V30.301h5.033l1.122-7.258h-6.155V21.169z" opacity=".05"/><path d="M27.207 21.169c0-1.353.293-3.621 2.257-3.621h3.783V12.46l-.026-.44-.433-.059c-.597-.081-1.838-.249-4.143-.249-5.323.0-8.136 3.055-8.136 8.834v2.998H15.56v6.258h4.948v13.874C21.644 43.876 22.806 44 24 44c1.094.0 2.16-.112 3.207-.281V29.801h5.104l.967-6.258h-6.072V21.169z" opacity=".05"/><path fill="#fff" d="M26.707 29.301h5.176l.813-5.258h-5.989v-2.874c0-2.184.714-4.121 2.757-4.121h3.283V12.46c-.577-.078-1.797-.248-4.102-.248-4.814.0-7.636 2.542-7.636 8.334v3.498H16.06v5.258h4.948v14.475C21.988 43.923 22.981 44 24 44c.921.0 1.82-.062 2.707-.182V29.301z"/></svg></a></li><li><a href=https://github.com/wjdesign target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.instagram.com/huai_lin/ target=_blank title=Instagram rel=me><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48" height="48"><path fill="#304ffe" d="M41.67 13.48c-.4.26-.97.5-1.21.77-.09.09-.14.19-.12.29v1.03l-.3 1.01-.3 1-.33 1.1-.68 2.25-.66 2.22-.5 1.67c0 .26-.01.52-.03.77-.07.96-.27 1.88-.59 2.74-.19.53-.42 1.04-.7 1.52-.1.19-.22.38-.34.56-.4.63-.88 1.21-1.41 1.72-.41.41-.86.79-1.35 1.11h-.01c-.08.07-.17.13-.27.18-.31.21-.64.39-.98.55-.23.12-.46.22-.7.31-.05.03-.11.05-.16.07-.57.27-1.23.45-1.89.54-.04.01-.07.01-.11.02-.4.07-.79.13-1.19.16-.18.02-.37.03-.55.03l-.71-.04-3.42-.18c0-.01-.01.0-.01.0l-1.72-.09c-.13.0-.27.0-.4-.01-.54-.02-1.06-.08-1.58-.19h-.01c-.95-.18-1.86-.5-2.71-.93-.47-.24-.93-.51-1.36-.82-.18-.13-.35-.27-.52-.42-.48-.4-.91-.83-1.31-1.27-.06-.06-.11-.12-.16-.18-.06-.06-.12-.13-.17-.19-.38-.48-.7-.97-.96-1.49-.24-.46-.43-.95-.58-1.49-.06-.19-.11-.37-.15-.57-.01-.01-.02-.03-.02-.05-.1-.41-.19-.84-.24-1.27-.06-.33-.09-.66-.09-1-.02-.13-.02-.27-.02-.4l1.91-2.95 1.87-2.88.85-1.31.77-1.18.26-.41v-1.03c.02-.23.03-.47.02-.69-.01-.7-.15-1.38-.38-2.03-.22-.69-.53-1.34-.85-1.94-.38-.69-.78-1.31-1.11-1.87C14 7.4 13.66 6.73 13.75 6.26 14.47 6.09 15.23 6 16 6h16c4.18.0 7.78 2.6 9.27 6.26C41.43 12.65 41.57 13.06 41.67 13.48z"/><path fill="#4928f4" d="M42 16v.27l-1.38.8-.88.51-.97.56-1.94 1.13-1.9 1.1-1.94 1.12-.77.45c0 .48-.12.92-.34 1.32-.31.58-.83 1.06-1.49 1.47-.67.41-1.49.74-2.41.98.0.0.0-.01-.01.0-3.56.92-8.42.5-10.78-1.26-.66-.49-1.12-1.09-1.32-1.78-.06-.23-.09-.48-.09-.73v-7.19c.01-.15-.09-.3-.27-.45-.54-.43-1.81-.84-3.23-1.25-1.11-.31-2.3-.62-3.3-.92-.79-.24-1.46-.48-1.86-.71.18-.35.39-.7.61-1.03 1.4-2.05 3.54-3.56 6.02-4.13C14.47 6.09 15.23 6 16 6h10.8c5.37.94 10.32 3.13 14.47 6.26.16.39.3.8.4 1.22.18.66.29 1.34.32 2.05C42 15.68 42 15.84 42 16z"/><path fill="#6200ea" d="M42 16v4.41l-.22.68-.75 2.33-.78 2.4-.41 1.28-.38 1.19-.37 1.13-.36 1.12-.19.59-.25.78c0 .76-.02 1.43-.07 2-.01.06-.02.12-.02.18-.06.53-.14.98-.27 1.36-.01.06-.03.12-.05.17-.26.72-.65 1.18-1.23 1.48-.14.08-.3.14-.47.2-.53.18-1.2.27-2.02.32-.6.04-1.29.05-2.07.05H31.4l-1.19-.05L30 37.61l-2.17-.09-2.2-.09-7.25-.3-1.88-.08h-.26c-.78-.01-1.45-.06-2.03-.14-.84-.13-1.49-.35-1.98-.68-.7-.45-1.11-1.11-1.35-2.03-.06-.22-.11-.45-.14-.7-.1-.58-.15-1.25-.18-2 0-.15.0-.3-.01-.46-.01-.01.0-.01.0-.01v-.58c-.01-.29-.01-.59-.01-.9l.05-1.61.03-1.15.04-1.34v-.19l.07-2.46.07-2.46.07-2.31.06-2.27.02-.6c0-.31-1.05-.49-2.22-.64-.93-.12-1.95-.23-2.56-.37.05-.23.1-.46.16-.68.18-.72.45-1.4.79-2.05.18-.35.39-.7.61-1.03 2.16-.95 4.41-1.69 6.76-2.17 2.06-.43 4.21-.66 6.43-.66 7.36.0 14.16 2.49 19.54 6.69.52.4 1.03.83 1.53 1.28C42 15.68 42 15.84 42 16z"/><path fill="#673ab7" d="M42 18.37v4.54l-.55 1.06-1.05 2.05-.56 1.08-.51.99-.22.43c0 .31.0.61-.02.9.0.43-.02.84-.05 1.22-.04.45-.1.86-.16 1.24-.15.79-.36 1.47-.66 2.03-.04.07-.08.14-.12.2-.11.18-.24.35-.38.51-.18.22-.38.41-.61.57-.34.26-.74.47-1.2.63-.57.21-1.23.35-2.01.43-.51.05-1.07.08-1.68.08l-.42.02-2.08.12h-.01L27.5 36.6l-2.25.13-3.1.18-3.77.22-.55.03c-.51.0-.99-.03-1.45-.09-.05-.01-.09-.02-.14-.02-.68-.11-1.3-.29-1.86-.54-.68-.3-1.27-.7-1.77-1.18-.44-.43-.82-.92-1.13-1.47-.07-.13-.14-.25-.2-.39-.3-.59-.54-1.25-.72-1.97-.03-.12-.06-.25-.08-.38-.06-.23-.11-.47-.14-.72-.11-.64-.17-1.32-.2-2.03v-.01c-.01-.29-.02-.57-.02-.87l-.49-1.17-.07-.18L9.5 25.99 8.75 24.2l-.12-.29-.72-1.73-.8-1.93H7.1L6.29 18.3 6 17.59V16c0-.63.06-1.25.17-1.85.05-.23.1-.46.16-.68.85-.49 1.74-.94 2.65-1.34 2.08-.93 4.31-1.62 6.62-2.04 1.72-.31 3.51-.48 5.32-.48 7.31.0 13.94 2.65 19.12 6.97.2.16.39.32.58.49C41.09 17.48 41.55 17.91 42 18.37z"/><path fill="#8e24aa" d="M42 21.35v5.14l-.57 1.19-1.08 2.25-.01.03c0 .43-.02.82-.05 1.17-.1 1.15-.38 1.88-.84 2.33-.33.34-.74.53-1.25.63-.03.01-.07.01-.1.02-.16.03-.33.05-.51.05-.62.06-1.35.02-2.19-.04-.09.0-.19-.01-.29-.02-.61-.04-1.26-.08-1.98-.11-.39-.01-.8-.02-1.22-.02h-.02l-1.01.08h-.01l-2.27.16-2.59.2-.38.03-3.03.22-1.57.12-1.55.11c-.27.0-.53.0-.79-.01.0.0-.01-.01-.01.0-1.13-.02-2.14-.09-3.04-.26-.83-.14-1.56-.36-2.18-.69-.64-.31-1.17-.75-1.6-1.31-.41-.55-.71-1.24-.9-2.07v-.01c-.14-.67-.22-1.45-.22-2.33l-.15-.27L9.7 26.35l-.13-.22L9.5 25.99l-.93-1.65-.46-.83-.58-1.03-1-1.79L6 19.75v-3.68c.88-.58 1.79-1.09 2.73-1.55 1.14-.58 2.32-1.07 3.55-1.47 1.34-.44 2.74-.79 4.17-1.02 1.45-.24 2.94-.36 4.47-.36 6.8.0 13.04 2.43 17.85 6.47.22.17.43.36.64.54.84.75 1.64 1.56 2.37 2.41C41.86 21.18 41.94 21.26 42 21.35z"/><path fill="#c2185b" d="M42 24.71v7.23c-.24-.14-.57-.31-.98-.49-.22-.11-.47-.22-.73-.32-.38-.17-.79-.33-1.25-.49-.1-.04-.2-.07-.31-.1-.18-.07-.37-.13-.56-.19-.59-.18-1.24-.35-1.92-.5-.26-.05-.53-.1-.8-.14-.87-.15-1.8-.24-2.77-.25-.08-.01-.17-.01-.25-.01l-2.57.02-3.5.02h-.01l-7.49.06c-2.38.0-3.84.57-4.72.8.0.0-.01.0-.01.01-.93.24-1.22.09-1.3-1.54-.02-.45-.03-1.03-.03-1.74l-.56-.43-.98-.74-.6-.46-.12-.09L8.88 24.1l-.25-.19-.52-.4-.96-.72L6 21.91v-3.4c.1-.08.19-.15.29-.21 1.45-1 3-1.85 4.64-2.54 1.46-.62 3-1.11 4.58-1.46.43-.09.87-.18 1.32-.24 1.33-.23 2.7-.34 4.09-.34 6.01.0 11.53 2.09 15.91 5.55.66.52 1.3 1.07 1.9 1.66.82.78 1.59 1.61 2.3 2.49.14.18.28.36.42.55C41.64 24.21 41.82 24.46 42 24.71z"/><path fill="#d81b60" d="M42 28.72V32c0 .65-.06 1.29-.18 1.91-.18.92-.49 1.8-.91 2.62-.22.05-.47.05-.75.01-.63-.11-1.37-.44-2.17-.87-.04-.01-.08-.03-.11-.05-.25-.13-.51-.27-.77-.43-.53-.29-1.09-.61-1.65-.91-.12-.06-.24-.12-.35-.18-.64-.33-1.3-.63-1.96-.86h-.01c-.14-.05-.29-.1-.44-.14-.57-.16-1.15-.26-1.71-.26l-1.1-.32-4.87-1.41h-.01l-2.99-.87h-.01l-1.3-.38c-3.76.0-6.07 1.6-7.19.99-.44-.23-.7-.81-.79-1.95-.03-.32-.04-.68-.04-1.1l-1.17-.57-.05-.02h-.01l-.84-.42L9.7 26.35l-.07-.03-.17-.09L7.5 25.28 6 24.55v-3.43c.17-.15.35-.29.53-.43.19-.15.38-.29.57-.44h.01c1.18-.85 2.43-1.6 3.76-2.22 1.55-.74 3.2-1.31 4.91-1.68.25-.06.51-.12.77-.16 1.42-.27 2.88-.41 4.37-.41 5.27.0 10.11 1.71 14.01 4.59 1.13.84 2.18 1.77 3.14 2.78.79.83 1.52 1.73 2.18 2.67.05.07.1.14.15.2.37.54.71 1.09 1.03 1.66C41.64 28.02 41.82 28.37 42 28.72z"/><path fill="#f50057" d="M41.82 33.91c-.18.92-.49 1.8-.91 2.62-.19.37-.4.72-.63 1.06-.14.21-.29.41-.44.6-.36-.14-.89-.34-1.54-.56v-.01c-.49-.17-1.05-.35-1.65-.52-.17-.05-.34-.1-.52-.15-.71-.19-1.45-.36-2.17-.46-.6-.1-1.19-.16-1.74-.16l-.46-.13h-.01l-2.42-.7-1.49-.43-1.66-.48h-.01l-.54-.15-6.53-1.88-1.88-.54-1.4-.33-2.28-.54-.28-.07h-.01l-2.29-.53v-.01l-.41-.09-.21-.05-1.67-.39-.19-.05-1.42-1.17L6 27.9v-4.08c.37-.36.75-.7 1.15-1.03.12-.11.25-.21.38-.31.12-.1.25-.2.38-.3.91-.69 1.87-1.31 2.89-1.84 1.3-.7 2.68-1.26 4.13-1.66.28-.09.56-.17.85-.23 1.64-.41 3.36-.62 5.14-.62 4.47.0 8.63 1.35 12.07 3.66 1.71 1.15 3.25 2.53 4.55 4.1.66.79 1.26 1.62 1.79 2.5.05.07.09.13.13.2.32.53.62 1.08.89 1.64.25.5.47 1 .67 1.52C41.34 32.25 41.6 33.07 41.82 33.91z"/><path fill="#ff1744" d="M40.28 37.59c-.14.21-.29.41-.44.6-.44.55-.92 1.05-1.46 1.49-.47.39-.97.74-1.5 1.04-.2-.05-.4-.11-.61-.19-.66-.23-1.35-.61-1.99-1.01-.96-.61-1.79-1.27-2.16-1.57-.14-.12-.21-.18-.21-.18l-1.7-.15L30 37.6l-2.2-.19-2.28-.2-3.37-.3-5.34-.47-.02-.01-1.88-.91-1.9-.92-1.53-.74-.33-.16-.41-.2-1.42-.69L7.43 31.9l-.59-.29L6 31.35v-4.47c.47-.56.97-1.09 1.5-1.6.34-.32.7-.64 1.07-.94.06-.05.12-.1.18-.14.04-.05.09-.08.13-.1.59-.48 1.21-.91 1.85-1.3.74-.47 1.52-.89 2.33-1.24.87-.39 1.78-.72 2.72-.97 1.63-.46 3.36-.7 5.14-.7 4.08.0 7.85 1.24 10.96 3.37 1.99 1.36 3.71 3.08 5.07 5.07.45.64.85 1.32 1.22 2.02.13.26.26.52.37.78.12.25.23.5.34.75.21.52.4 1.04.57 1.58.32 1 .56 2.02.71 3.08C40.21 36.89 40.25 37.24 40.28 37.59z"/><path fill="#ff5722" d="M38.39 39.42c0 .08.0.17-.01.26-.47.39-.97.74-1.5 1.04-.22.12-.44.24-.67.34-.23.11-.46.21-.7.3-.34-.18-.8-.4-1.29-.61-.69-.31-1.44-.59-2.02-.68-.14-.03-.27-.04-.39-.04l-1.64-.21h-.02l-2.04-.27-2.06-.27-.96-.12-7.56-.98c-.49.0-1.01-.03-1.55-.1-.66-.06-1.35-.16-2.04-.3-.68-.12-1.37-.28-2.03-.45-.69-.16-1.37-.35-2-.53-.73-.22-1.41-.43-1.98-.62-.47-.15-.87-.29-1.18-.4-.18-.43-.33-.88-.44-1.34C6.1 33.66 6 32.84 6 32v-1.67c.32-.53.67-1.05 1.06-1.54.71-.94 1.52-1.8 2.4-2.56.03-.04.07-.07.1-.09l.01-.01c.31-.28.63-.53.97-.77.04-.04.08-.07.12-.1.16-.12.33-.24.51-.35 1.43-.97 3.01-1.73 4.7-2.24 1.6-.48 3.29-.73 5.05-.73 3.49.0 6.75 1.03 9.47 2.79 2.01 1.29 3.74 2.99 5.06 4.98.16.23.31.46.46.7.69 1.17 1.26 2.43 1.68 3.75.05.15.09.3.13.46.08.27.15.55.21.83.02.07.04.14.06.22.14.63.24 1.29.31 1.95v.01C38.36 38.22 38.39 38.82 38.39 39.42z"/><path fill="#ff6f00" d="M36.33 39.42c0 .35-.02.73-.06 1.11-.02.18-.04.36-.06.53-.23.11-.46.21-.7.3-.45.17-.91.31-1.38.41-.32.07-.65.13-.98.16h-.01c-.31-.19-.67-.42-1.04-.68-.67-.47-1.37-1-1.93-1.43-.01-.01-.01-.01-.02-.02-.59-.45-1.01-.79-1.01-.79l-1.06.04-2.04.07-.95.04-3.82.14-3.23.12c-.21.01-.46.01-.77.0h-.01c-.42-.01-.92-.04-1.47-.09-.64-.05-1.34-.11-2.05-.18-.69-.08-1.39-.16-2.06-.24-.74-.08-1.44-.17-2.04-.25-.47-.06-.88-.11-1.21-.15-.28-.32-.53-.65-.77-1.01-.36-.54-.67-1.11-.91-1.72-.18-.43-.33-.88-.44-1.34.29-.89.67-1.73 1.12-2.54.36-.66.78-1.29 1.24-1.89.45-.59.94-1.14 1.47-1.64v-.01c.15-.15.3-.29.45-.42.28-.26.57-.5.87-.73h.01c.01-.02.02-.02.03-.03.24-.19.49-.36.74-.53 1.48-1.01 3.15-1.76 4.95-2.2 1.19-.29 2.44-.45 3.73-.45 2.54.0 4.94.61 7.05 1.71h.01c1.81.93 3.41 2.21 4.7 3.75.71.82 1.32 1.72 1.82 2.67.35.64.65 1.31.9 1.99.02.06.04.11.06.16.17.5.32 1.02.45 1.54.09.37.16.75.22 1.13.02.12.04.23.05.35C36.28 37.99 36.33 38.7 36.33 39.42z"/><path fill="#ff9800" d="M34.28 39.42v.1c0 .34-.03.77-.06 1.23-.03.34-.06.69-.09 1.02-.32.07-.65.13-.98.16h-.01C32.76 41.98 32.39 42 32 42h-1.75l-.38-.11-1.97-.6-2-.6-4.63-1.39-2-.6s-.83.33-2 .72h-.01c-.45.15-.94.31-1.46.47-.65.19-1.34.38-2.02.53-.7.16-1.39.28-2.01.33-.19.02-.38.03-.55.03-.56-.31-1.1-.68-1.59-1.09-.43-.36-.83-.75-1.2-1.18-.28-.32-.53-.65-.77-1.01.07-.45.15-.89.27-1.32.3-1.19.77-2.33 1.39-3.37.34-.59.72-1.16 1.16-1.69.01-.03.04-.06.07-.08-.01-.01.0-.01.0-.01.13-.17.27-.33.41-.48v-.01c.41-.44.83-.86 1.29-1.25.16-.13.31-.26.48-.39.03-.03.06-.05.1-.08 2.25-1.72 5.06-2.76 8.09-2.76 3.44.0 6.57 1.29 8.94 3.41 1.14 1.03 2.11 2.26 2.84 3.63.06.1.12.21.17.32.09.18.18.37.26.57.33.72.59 1.48.77 2.26.02.08.04.16.06.24.08.37.15.75.2 1.13C34.24 38.21 34.28 38.81 34.28 39.42z"/><path fill="#ffc107" d="M32.22 39.42c0 .2-.01.42-.02.65-.02.37-.05.77-.1 1.18-.02.25-.06.5-.1.75h-5.48l-1.06-.17-4.14-.66-.59-.09-1.35-.22c-.59.0-1.87.26-3.22.51-.71.13-1.43.27-2.08.36-.08.01-.16.02-.23.03h-.01c-.7-.15-1.38-.38-2.02-.68-.2-.09-.4-.19-.6-.3-.56-.31-1.1-.68-1.59-1.09-.01-.12-.02-.22-.02-.27.0-.26.01-.51.03-.76.04-.64.13-1.26.27-1.86.22-.91.54-1.79.97-2.6.08-.17.17-.34.27-.5.04-.08.09-.15.13-.23.18-.29.38-.57.58-.85.42-.55.89-1.07 1.39-1.54h.01c.04-.04.08-.08.12-.11.05-.04.09-.09.14-.12.2-.18.4-.34.61-.49.0-.01.01-.01.01-.01 1.89-1.41 4.23-2.24 6.78-2.24 1.98.0 3.82.5 5.43 1.38h.01c1.38.76 2.58 1.79 3.53 3.03.37.48.7.99.98 1.53h.01c.05.1.1.2.15.3.3.59.54 1.21.72 1.85h.01c.01.05.03.1.04.15.12.43.22.87.29 1.32.01.09.02.19.03.28C32.19 38.43 32.22 38.92 32.22 39.42z"/><path fill="#ffd54f" d="M30.17 39.31c0 .16.0.33-.02.49v.01.01c-.02.72-.12 1.43-.28 2.07.0.04-.01.07-.03.11h-4.67l-3.85-.83-.51-.11-.08.02-4.27.88L16.27 42H16c-.64.0-1.27-.06-1.88-.18-.09-.02-.18-.04-.27-.06h-.01c-.7-.15-1.38-.38-2.02-.68-.02-.11-.04-.22-.05-.33-.07-.43-.1-.88-.1-1.33.0-.17.0-.34.01-.51.03-.54.11-1.07.23-1.58.08-.38.19-.75.32-1.1.11-.31.24-.61.38-.9.12-.25.26-.49.4-.73.14-.23.29-.45.45-.67.4-.55.87-1.06 1.39-1.51.3-.26.63-.51.97-.73 1.46-.96 3.21-1.52 5.1-1.52.37.0.73.02 1.08.07h.02c1.07.12 2.07.42 2.99.87h.01c1.45.71 2.68 1.78 3.58 3.1.15.22.3.46.43.7.11.19.21.39.3.59.14.31.27.64.38.97h.01c.11.37.21.74.28 1.13v.01C30.11 38.16 30.17 38.73 30.17 39.31z"/><path fill="#ffe082" d="M28.11 39.52v.03c0 .59-.07 1.17-.21 1.74-.05.24-.12.48-.21.71h-4.48l-2.29-.63L18.63 42H16c-.64.0-1.27-.06-1.88-.18-.02-.03-.03-.06-.04-.09-.14-.43-.25-.86-.3-1.31-.04-.29-.06-.59-.06-.9.0-.12.0-.25.02-.37.01-.47.08-.93.2-1.37.06-.3.15-.59.27-.87.04-.14.1-.27.17-.4.15-.34.33-.67.53-.99.22-.32.46-.62.73-.9.32-.36.68-.69 1.09-.96.7-.51 1.5-.89 2.37-1.1.58-.16 1.19-.24 1.82-.24 2 0 3.79.8 5.09 2.09.05.05.11.11.16.18h.01c.14.15.27.3.4.47.37.47.68.98.92 1.54.12.26.22.53.3.81.01.04.02.07.03.11.14.49.23 1 .25 1.53C28.1 39.2 28.11 39.36 28.11 39.52z"/><path fill="#ffecb3" d="M26.06 39.52c0 .41-.05.8-.16 1.17-.1.4-.25.78-.44 1.14-.03.06-.1.17-.1.17h-8.88c-.01-.01-.02-.03-.02-.04-.12-.19-.22-.38-.3-.59-.2-.46-.32-.96-.36-1.48-.02-.12-.02-.25-.02-.37.0-.06.0-.13.01-.19.01-.44.07-.86.19-1.25.1-.36.23-.69.4-1.01.0.0.01-.01.01-.02.12-.21.25-.42.4-.62.49-.66 1.14-1.2 1.89-1.55h.01c.24-.12.49-.22.75-.29h.01c.46-.14.96-.21 1.47-.21.59.0 1.16.09 1.68.28.19.05.37.13.55.22h.01c.86.41 1.59 1.05 2.09 1.85.1.15.19.31.27.48.04.07.08.15.11.22.23.52.37 1.09.41 1.69.01.05.01.1.01.16C26.06 39.36 26.06 39.44 26.06 39.52z"/><g><path fill="none" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M30 11H18c-3.9.0-7 3.1-7 7v12c0 3.9 3.1 7 7 7h12c3.9.0 7-3.1 7-7V18c0-3.9-3.1-7-7-7z"/><circle cx="31" cy="16" r="1" fill="#fff"/></g><g><circle cx="24" cy="24" r="6" fill="none" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2"/></g></svg></a></li><li><a href=https://twitter.com/4006wayne target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=https://wayneblog.ga/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>é—œæ–¼æœ¬ç«™</span></a></li><li><a href=https://wayneblog.ga/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>æ–‡ç« å·å®—</span></a></li><li><a href=https://wayneblog.ga/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>æœå°‹æª¢ç´¢</span></a></li><li><a href=https://wayneblog.ga/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>ç›¸é—œé€£çµ</span></a></li><li><a href=https://wayneblog.ga/categories/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg><span>åˆ†é¡æª¢ç´¢</span></a></li><li><a href=https://wayneblog.ga/tags/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11 3l9 9a1.5 1.5.0 010 2l-6 6a1.5 1.5.0 01-2 0L3 11V7a4 4 0 014-4h4"/><circle cx="9" cy="9" r="2"/></svg><span>æ¨™ç±¤æª¢ç´¢</span></a></li><li><a href=https://wayneblog.ga/index.xml target=_blank><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg><span>RSS Feed</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://wayneblog.ga/ selected>ç¹é«”ä¸­æ–‡</option><option value=https://wayneblog.ga/en/>English</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>å¤œæ™šæ¨¡å¼</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®éŒ„</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#æ¸¬è©¦çš„ç¨®é¡>æ¸¬è©¦çš„ç¨®é¡</a><ol><li><a href=#å–®å…ƒæ¸¬è©¦-unit-testing>å–®å…ƒæ¸¬è©¦ (Unit testing)</a></li><li><a href=#æ•´åˆæ¸¬è©¦-integration-testing>æ•´åˆæ¸¬è©¦ (Integration testing)</a></li><li><a href=#ç«¯å°ç«¯æ¸¬è©¦-end-to-end-testing-e2e-testing>ç«¯å°ç«¯æ¸¬è©¦ (End-to-end testing) (E2E testing)</a></li></ol></li><li><a href=#æ¸¬è©¦æ¡ˆä¾‹ä¸­çš„-3a-æ¨¡å¼>æ¸¬è©¦æ¡ˆä¾‹ä¸­çš„ 3A æ¨¡å¼</a></li><li><a href=#å°ˆæ¡ˆåŠ å…¥-vitest>å°ˆæ¡ˆåŠ å…¥ Vitest</a><ol><li><a href=#åœ¨åˆå§‹åŒ–å°ˆæ¡ˆéç¨‹åŠ å…¥-vitest>åœ¨åˆå§‹åŒ–å°ˆæ¡ˆéç¨‹åŠ å…¥ Vitest</a></li><li><a href=#åœ¨æ—¢æœ‰å°ˆæ¡ˆä¸­åŠ å…¥-vitest>åœ¨æ—¢æœ‰å°ˆæ¡ˆä¸­åŠ å…¥ Vitest</a><ol><li></li></ol></li></ol></li><li><a href=#vitest-config-è¨­å®šæ–¹å¼>Vitest Config è¨­å®šæ–¹å¼</a><ol><li><a href=#åŸ·è¡Œ-npm-æŒ‡ä»¤æ™‚å¸¶åƒæ•¸æŒ‡å®šè¨­å®šæª”æ¡ˆè·¯å¾‘>åŸ·è¡Œ npm æŒ‡ä»¤æ™‚å¸¶åƒæ•¸æŒ‡å®šè¨­å®šæª”æ¡ˆè·¯å¾‘</a><ol><li></li></ol></li><li><a href=#åœ¨å°ˆæ¡ˆä¸­çš„-viteconfigjs-ä¸­èª¿æ•´æ¸¬è©¦è¨­å®š>åœ¨å°ˆæ¡ˆä¸­çš„ vite.config.js ä¸­èª¿æ•´æ¸¬è©¦è¨­å®š</a><ol><li></li></ol></li><li><a href=#é€é-vitestconfigjs-æª”æ¡ˆèª¿æ•´æ¸¬è©¦è¨­å®š>é€é vitest.config.js æª”æ¡ˆèª¿æ•´æ¸¬è©¦è¨­å®š</a></li></ol></li><li><a href=#vitest-config-option>Vitest config option</a><ol><li><a href=#include>include</a><ol><li></li></ol></li><li><a href=#exclude>exclude</a><ol><li></li></ol></li><li><a href=#globals>Globals</a><ol><li></li></ol></li><li><a href=#environment>environment</a></li></ol></li><li><a href=#æ¸¬è©¦çš„æœ¬è³ª>æ¸¬è©¦çš„æœ¬è³ª</a><ol><li><a href=#æƒ…å¢ƒèˆ‰ä¾‹>æƒ…å¢ƒèˆ‰ä¾‹</a></li><li><a href=#ç°¡æ˜“çš„æ¸¬è©¦å·¥å…·>ç°¡æ˜“çš„æ¸¬è©¦å·¥å…·</a></li><li><a href=#å¯«æ¸¬è©¦æ¡ˆä¾‹>å¯«æ¸¬è©¦æ¡ˆä¾‹</a></li><li><a href=#å¯«å—æ¸¬ç¨‹å¼ç¢¼çš„å¯¦ä½œ>å¯«å—æ¸¬ç¨‹å¼ç¢¼çš„å¯¦ä½œ</a></li></ol></li><li><a href=#æ¸¬è©¦å·¥å…·çš„é¸æ“‡>æ¸¬è©¦å·¥å…·çš„é¸æ“‡</a></li><li><a href=#æ±ºå®šæ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹>æ±ºå®šæ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹</a><ol><li><a href=#æ¸¬è©¦æƒ…å¢ƒtest-suiteæ¸¬è©¦æ¡ˆä¾‹test-case>æ¸¬è©¦æƒ…å¢ƒ(test suite)æ¸¬è©¦æ¡ˆä¾‹(test case)</a></li><li><a href=#æ¡ˆä¾‹è·¯å¾‘happy-pathsad-pathbad-path>æ¡ˆä¾‹è·¯å¾‘(happy pathã€sad pathã€bad path)</a></li><li><a href=#è·¯å¾‘å„ªå…ˆåº¦>è·¯å¾‘å„ªå…ˆåº¦</a></li></ol></li><li><a href=#æ’°å¯«æ¸¬è©¦ç¨‹å¼ç¢¼çš„å‰è¨€>æ’°å¯«æ¸¬è©¦ç¨‹å¼ç¢¼çš„å‰è¨€</a><ol><li><a href=#æ’°å¯«æ¸¬è©¦ç¨‹å¼ç¢¼éœ€ä¿æŒçš„å¿ƒå¢ƒ>æ’°å¯«æ¸¬è©¦ç¨‹å¼ç¢¼éœ€ä¿æŒçš„å¿ƒå¢ƒ</a></li><li><a href=#first-æ³•å‰‡>F.I.R.S.T æ³•å‰‡</a><ol><li><a href=#fastå¿«>Fast(å¿«)</a></li><li><a href=#independentç¨ç«‹>Independent(ç¨ç«‹)</a></li><li><a href=#repeatableå¯é‡è¤‡>Repeatable(å¯é‡è¤‡)</a></li><li><a href=#self-validatingèƒ½è‡ªæˆ‘é©—è­‰>Self-Validating(èƒ½è‡ªæˆ‘é©—è­‰)</a></li><li><a href=#timelyå³æ™‚>Timely(å³æ™‚)</a></li></ol></li></ol></li><li><a href=#describe--it-èˆ‡-è¼”åŠ©-api>describe & it èˆ‡ è¼”åŠ© API</a><ol><li><a href=#describe--it-åŸºç¤ç”¨æ³•>describe & it åŸºç¤ç”¨æ³•</a></li><li><a href=#describe--it-è¼”åŠ©-api>describe & it è¼”åŠ© API</a><ol><li><a href=#only>only</a></li><li><a href=#skip>skip</a></li><li><a href=#todo>todo</a></li><li><a href=#fails>fails</a></li></ol></li></ol></li><li><a href=#æº–å‚™setupèˆ‡æ¸…ç†teardown>æº–å‚™(Setup)èˆ‡æ¸…ç†(Teardown)</a><ol><li><a href=#setup--teardown-api-çš„ç¯„ç–‡>Setup & Teardown API çš„ç¯„ç–‡</a></li><li><a href=#é¿å…èª¤å€åœ¨-expect-å¾Œåšæ¸…æƒè™•ç†>é¿å…èª¤å€ï¼šåœ¨ expect å¾Œåšæ¸…æƒè™•ç†</a></li><li><a href=#é¿å…éåº¦ä½¿ç”¨-setup--teardown-api>é¿å…éåº¦ä½¿ç”¨ Setup & Teardown API</a></li><li><a href=#æŠ½è±¡å…‰è­œthe-spectrum-of-abstraction>æŠ½è±¡å…‰è­œ(The Spectrum of Abstraction)</a></li></ol></li><li><a href=#æ–·è¨€èªæ³•èˆ‡-matchers>æ–·è¨€èªæ³•èˆ‡ Matchers</a><ol><li><a href=#æ–·è¨€èªæ³•>æ–·è¨€èªæ³•</a><ol><li><a href=#chai-assertion>Chai Assertion</a></li><li><a href=#jest-assertion>Jest Assertion</a></li><li><a href=#vitest>Vitest</a></li></ol></li><li><a href=#vitestjest-expect-matchers>Vitest(Jest expect Matchers)</a><ol><li><a href=#å¸¸ç”¨>å¸¸ç”¨</a></li><li><a href=#ç´”å€¼è³‡æ–™é¡å‹æ¯”å°>ç´”å€¼è³‡æ–™é¡å‹æ¯”å°</a></li><li><a href=#é™£åˆ—æ¯”å°èˆ‡æª¢æŸ¥>é™£åˆ—æ¯”å°èˆ‡æª¢æŸ¥</a></li><li><a href=#ç‰©ä»¶æ¯”å°èˆ‡æª¢æŸ¥>ç‰©ä»¶æ¯”å°èˆ‡æª¢æŸ¥</a></li><li><a href=#ç›£è½å‡½å¼>ç›£è½å‡½å¼</a></li></ol></li><li><a href=#å¿«ç…§æ¸¬è©¦snapshot-testingèˆ‡å¿«ç…§-matchers>å¿«ç…§æ¸¬è©¦(Snapshot Testing)èˆ‡å¿«ç…§ matchers</a><ol><li><a href=#jest-snapshot>Jest Snapshot</a></li><li><a href=#vitest-snapshot>Vitest Snapshot</a></li></ol></li><li><a href=#error>Error</a></li></ol></li><li><a href=#å…ƒä»¶æ¸¬è©¦>å…ƒä»¶æ¸¬è©¦</a><ol><li><a href=#vue-test-utils-èˆ‡å…ƒä»¶æ¸¬è©¦>Vue Test Utils èˆ‡å…ƒä»¶æ¸¬è©¦</a></li><li><a href=#vue-test-utils>Vue-Test-Utils</a></li><li><a href=#å…ƒä»¶æ¸¬è©¦çš„ç›®æ¨™>å…ƒä»¶æ¸¬è©¦çš„ç›®æ¨™</a></li><li><a href=#å¥½çš„å…ƒä»¶æ¸¬è©¦>å¥½çš„å…ƒä»¶æ¸¬è©¦</a></li><li><a href=#å…ƒä»¶æ¸¬è©¦èˆ‡å–®å…ƒæ¸¬è©¦çš„é—œä¿‚>å…ƒä»¶æ¸¬è©¦èˆ‡å–®å…ƒæ¸¬è©¦çš„é—œä¿‚</a></li></ol></li><li><a href=#å…ƒä»¶æ¸¬è©¦å®¹å™¨wrapper>å…ƒä»¶æ¸¬è©¦ï¼šå®¹å™¨(Wrapper)</a><ol><li><a href=#mount>mount</a></li><li><a href=#shallowmount>shallowMount</a><ol><li></li></ol></li></ol></li><li><a href=#å®¹å™¨çš„æ–¹æ³•wrapper-methods---é¸æ“‡å™¨>å®¹å™¨çš„æ–¹æ³•ï¼ˆWrapper methodsï¼‰ - é¸æ“‡å™¨</a><ol><li><a href=#é¸æ“‡å™¨>é¸æ“‡å™¨</a><ol><li><a href=#å…ƒç´ é¸æ“‡å™¨>å…ƒç´ é¸æ“‡å™¨</a></li><li><a href=#find-åˆ¤æ–·å…ƒç´ é™·é˜±>find åˆ¤æ–·å…ƒç´ é™·é˜±</a></li><li><a href=#å…ƒä»¶componenté¸æ“‡å™¨>å…ƒä»¶ï¼ˆcomponentï¼‰é¸æ“‡å™¨</a></li></ol></li><li><a href=#åˆ¤æ–·ç›®æ¨™å­˜åœ¨>åˆ¤æ–·ç›®æ¨™å­˜åœ¨</a></li><li><a href=#ä½¿ç”¨-data--attribute>ä½¿ç”¨ data-* attribute</a><ol><li><a href=#åœ¨ç”Ÿç”¢ç’°å¢ƒåˆªé™¤-data--attribute>åœ¨ç”Ÿç”¢ç’°å¢ƒåˆªé™¤ data-* attribute</a></li></ol></li></ol></li><li><a href=#å®¹å™¨çš„æ–¹æ³•wrapper-methods---å–å¾—ç›®æ¨™è³‡è¨Š>å®¹å™¨çš„æ–¹æ³•(Wrapper methods) - å–å¾—ç›®æ¨™è³‡è¨Š</a><ol><li><a href=#åˆ¤æ–·å±¬æ€§>åˆ¤æ–·å±¬æ€§</a><ol><li><a href=#attributes>attributes</a></li><li><a href=#classes>classes</a></li></ol></li><li><a href=#åˆ¤æ–·å…§å®¹ç‰©>åˆ¤æ–·å…§å®¹ç‰©</a><ol><li><a href=#text>text</a></li><li><a href=#html>html</a></li></ol></li></ol></li><li><a href=#å®¹å™¨çš„æ–¹æ³•wrapper-methods---æ¨¡æ“¬äº‹ä»¶>å®¹å™¨çš„æ–¹æ³•(Wrapper methods) - æ¨¡æ“¬äº‹ä»¶</a><ol><li><a href=#æ»‘é¼ äº‹ä»¶>æ»‘é¼ äº‹ä»¶</a></li><li><a href=#æ»‘é¼ äº‹ä»¶-1>æ»‘é¼ äº‹ä»¶</a><ol><li><a href=#é»æ“Šèˆ‡é›™æ“Š>é»æ“Šèˆ‡é›™æ“Š</a></li><li><a href=#æŒ‡å®šæŒ‰éµé»æ“Š>æŒ‡å®šæŒ‰éµé»æ“Š</a></li></ol></li><li><a href=#éµç›¤äº‹ä»¶>éµç›¤äº‹ä»¶</a></li><li><a href=#è¡¨å–®äº‹ä»¶>è¡¨å–®äº‹ä»¶</a><ol><li><a href=#æ¨¡æ“¬-input-è¼¸å…¥>æ¨¡æ“¬ input è¼¸å…¥</a></li><li><a href=#æ¨¡æ“¬-radio-å‹¾é¸>æ¨¡æ“¬ radio å‹¾é¸</a></li><li><a href=#æ¨¡æ“¬-checkbox-å‹¾é¸>æ¨¡æ“¬ checkbox å‹¾é¸</a></li><li><a href=#æ¨¡æ“¬-select-é¸æ“‡>æ¨¡æ“¬ select é¸æ“‡</a></li></ol></li></ol></li><li><a href=#æ¨¡æ“¬-vue-apis>æ¨¡æ“¬ Vue APIs</a><ol><li><a href=#data>data</a><ol><li><a href=#ç§æœ‰æ–¹æ³•private-method>ç§æœ‰æ–¹æ³•ï¼ˆprivate methodï¼‰</a></li></ol></li><li><a href=#dataoptions-api>dataï¼ˆoptions APIï¼‰</a></li><li><a href=#datacomposition-api-script-setup-èªæ³•ç³–>dataï¼ˆcomposition API, <code>&lt;script setup></code> èªæ³•ç³–ï¼‰</a><ol><li><a href=#composition-api>composition APIï¼š</a></li><li><a href=#script-setup-èªæ³•ç³–><code>&lt;script setup></code> èªæ³•ç³–ï¼š</a></li></ol></li><li><a href=#props>props</a><ol><li><a href=#æ¨¡æ“¬-props-å‚³å…¥>æ¨¡æ“¬ props å‚³å…¥</a></li></ol></li><li><a href=#æ–·è¨€æ˜¯å¦å‚³å…¥å°-props-åƒæ•¸çµ¦å­å…ƒä»¶>æ–·è¨€æ˜¯å¦å‚³å…¥å° props åƒæ•¸çµ¦å­å…ƒä»¶</a></li><li><a href=#emit>emit</a></li><li><a href=#provide>provide</a><ol><li><a href=#é€éå…ƒä»¶å®¹å™¨ä¸­çš„-globalstubs-æ¨¡æ“¬å‡å…ƒä»¶>é€éå…ƒä»¶å®¹å™¨ä¸­çš„ global.stubs æ¨¡æ“¬å‡å…ƒä»¶</a></li></ol></li><li><a href=#inject>inject</a></li><li><a href=#slots>slots</a><ol><li><a href=#é è¨­æ’æ§½default-slots>é è¨­æ’æ§½ï¼ˆDefault slotsï¼‰</a></li><li><a href=#å…·åæ’æ§½named-slots>å…·åæ’æ§½ï¼ˆNamed slotsï¼‰</a></li><li><a href=#ä½œç”¨åŸŸæ’æ§½scoped-slots>ä½œç”¨åŸŸæ’æ§½ï¼ˆScoped slotsï¼‰</a></li><li><a href=#æ’æ§½è¼‰å…¥é¸é …mounting-options>æ’æ§½è¼‰å…¥é¸é …ï¼ˆMounting optionsï¼‰</a></li></ol></li><li><a href=#custom-directives>custom directives</a></li></ol></li><li><a href=#vitest-ui>Vitest UI</a><ol><li><a href=#ä»‹é¢>ä»‹é¢</a></li><li><a href=#report>Report</a></li><li><a href=#module-graph>Module Graph</a></li><li><a href=#console>Console</a></li><li><a href=#code>Code</a></li></ol></li><li><a href=#ç¨‹å¼ç¢¼è¦†è“‹ç‡code-coverage>ç¨‹å¼ç¢¼è¦†è“‹ç‡ï¼ˆCode Coverageï¼‰</a><ol><li><a href=#c8>c8</a></li><li><a href=#è¦†è“‹ç‡ç›®æ¨™>è¦†è“‹ç‡ç›®æ¨™</a></li><li><a href=#è¦†è“‹ç‡è­°é¡Œ>è¦†è“‹ç‡è­°é¡Œ</a><ol><li><a href=#è¦†è“‹ç‡èˆ‡ä»˜å‡ºçš„å¿ƒåŠ›>è¦†è“‹ç‡èˆ‡ä»˜å‡ºçš„å¿ƒåŠ›</a></li><li><a href=#è¦†è“‹ç‡-100-çš„èª¤å€>è¦†è“‹ç‡ 100% çš„èª¤å€</a></li><li><a href=#çªè®Šæ¸¬è©¦mutation-testing>çªè®Šæ¸¬è©¦ï¼ˆmutation testingï¼‰</a></li><li><a href=#çªè®Šæ¸¬è©¦çš„å·¥å…·>çªè®Šæ¸¬è©¦çš„å·¥å…·</a></li></ol></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><a class=btnBack href=javascript:void(0) onclick=backEvent()><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-back" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9 11l-4 4 4 4m-4-4h11a4 4 0 000-8h-1"/></svg><span class=btnBackText>BACK</span></a>
<script>function backEvent(){if(document.referrer.indexOf(window.location.host)!==-1){history.go(-1);return}window.location.href=window.location.origin}</script><header class=article-header><div class=article-image><a href=https://wayneblog.ga/2022-12-29/vitest-unit-test/><img src=https://madewithnetworkfra.fra1.digitaloceanspaces.com/spatie-space-production/29079/vitest.jpg loading=lazy alt="Featured image of post é—¡è¿°å–®å…ƒæ¸¬è©¦ã€å…ƒä»¶æ¸¬è©¦ï¼Œä¸¦å­¸ç¿’åœ¨è‡ªå·±çš„ Vue3 å°ˆæ¡ˆä¸­åŠ å…¥ Vitestï¼"></a></div><div class=article-details><header class=article-category><a href=https://wayneblog.ga/categories/vitest/ style=background-color:#719d2a;color:#fff>Vitest</a>
<a href=https://wayneblog.ga/categories/typescript/ style=background-color:#2d79c7;color:#fff>Typescript</a>
<a href=https://wayneblog.ga/categories/javascript/ style=background-color:#f7b41b;color:#fff>Javascript</a></header><div class=article-title-wrapper><h2 class=article-title><a href=https://wayneblog.ga/2022-12-29/vitest-unit-test/>é—¡è¿°å–®å…ƒæ¸¬è©¦ã€å…ƒä»¶æ¸¬è©¦ï¼Œä¸¦å­¸ç¿’åœ¨è‡ªå·±çš„ Vue3 å°ˆæ¡ˆä¸­åŠ å…¥ Vitestï¼</a></h2><h3 class=article-subtitle>ç¶²ç«™å»ºç½®ä¸æ˜¯ä»¶ç°¡å–®çš„äº‹ï¼Œæˆ‘å€‘éƒ½çŸ¥é“ç¶²ç«™åšå¥½ä¹‹å¾Œï¼Œæœ‰å¥½å¤šç´°ç¯€éœ€è¦å…¼é¡§ï¼Œæ‰€ä»¥è¨±å¤šå…¬å¸èŠ±äº†å¤§é‡çš„æ™‚é–“èˆ‡é‡‘éŒ¢ï¼Œè€—ç”¨äººåŠ›å°ç¶­è­·ä¸­çš„ç¶²ç«™é€²è¡Œä¸æ–·çš„ã€é‡è¤‡çš„äººå·¥æ¸¬è©¦ï¼Œæƒ³é”åˆ°çš„ç›®çš„ä¸å¤–ä¹æ˜¯å¸Œæœ›ç¶²ç«™ä¸è¦å‡ºéŒ¯ï¼Œå¯ä»¥çµ¦å®¢æˆ¶/ä½¿ç”¨è€…æœ€å¥½çš„ç¶²ç«™ä½¿ç”¨é«”é©—ã€‚æœ¬ç¯‡ç« èªªæ˜ä½¿ç”¨ Vue3 é–‹ç™¼çš„å°ˆæ¡ˆï¼Œå°å…¥ Vitest é€²è¡Œæ¥µé€Ÿå–®å…ƒæ¸¬è©¦çš„é«”é©—ï¼</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Dec 29, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>é–±è®€æ™‚é–“: 40 åˆ†é˜</time></div></footer></div></header><section class=article-content><style>.article-content p code{background-color:#f5f5f5;color:#ff3860}.focus{background:#f1e2e2;color:#d62c2c;padding:0 5px}</style><p><a class=link href=https://blog.miniasp.com/post/2019/02/18/Unit-testing-Integration-testing-e2e-testing target=_blank rel=noopener>åƒè€ƒç¶²ç«™</a><br><a class=link href=https://ithelp.ithome.com.tw/articles/10278764 target=_blank rel=noopener>åƒè€ƒç¶²ç«™</a><br><a class=link href=https://ithelp.ithome.com.tw/articles/10298229 target=_blank rel=noopener>åƒè€ƒç¶²ç«™</a><br><a class=link href=https://ithelp.ithome.com.tw/articles/10293368 target=_blank rel=noopener>åƒè€ƒç¶²ç«™</a></p><p>ç¶²ç«™å»ºç½®ä¸æ˜¯ä»¶ç°¡å–®çš„äº‹ï¼Œæˆ‘å€‘éƒ½çŸ¥é“ç¶²ç«™åšå¥½ä¹‹å¾Œï¼Œæœ‰å¥½å¤šç´°ç¯€éœ€è¦å…¼é¡§ï¼Œæ‰€ä»¥è¨±å¤šå…¬å¸èŠ±äº†å¤§é‡çš„æ™‚é–“èˆ‡é‡‘éŒ¢ï¼Œè€—ç”¨äººåŠ›å°ç¶­è­·ä¸­çš„ç¶²ç«™é€²è¡Œä¸æ–·çš„ã€é‡è¤‡çš„äººå·¥æ¸¬è©¦ï¼Œæƒ³é”åˆ°çš„ç›®çš„ä¸å¤–ä¹æ˜¯å¸Œæœ›ç¶²ç«™ä¸è¦å‡ºéŒ¯ï¼Œå¯ä»¥çµ¦å®¢æˆ¶/ä½¿ç”¨è€…æœ€å¥½çš„ç¶²ç«™ä½¿ç”¨é«”é©—ã€‚æœ¬ç¯‡ç« èªªæ˜ä½¿ç”¨ Vue3 é–‹ç™¼çš„å°ˆæ¡ˆï¼Œå°å…¥ Vitest é€²è¡Œæ¥µé€Ÿå–®å…ƒæ¸¬è©¦çš„é«”é©—ï¼</p><hr><h2 id=æ¸¬è©¦çš„ç¨®é¡>æ¸¬è©¦çš„ç¨®é¡</h2><p>åœ¨ä¸åŒçš„æ¸¬è©¦é¡å‹ä¸­ï¼Œæ‰€éœ€è¦ä¿è­·çš„é¢å‘ä¸å¤ªç›¸åŒï¼Œä»¥ä¸‹æ˜¯ä¸åŒæ¸¬è©¦é¡å‹çš„å¤§è‡´ä»‹ç´¹ï¼š</p><h3 id=å–®å…ƒæ¸¬è©¦-unit-testing>å–®å…ƒæ¸¬è©¦ (Unit testing)</h3><p>ä»¥ç¨‹å¼ç¢¼çš„æœ€å°å–®ä½é€²è¡Œæ¸¬è©¦ï¼Œä¿è­·ç¨‹å¼é‚è¼¯ä¸æœƒåœ¨ç³»çµ±ç¶­è­·çš„éç¨‹ä¸­é­åˆ°ç ´å£ï¼Œä¹Ÿé€²ä¸€æ­¥ç¢ºä¿ç¶­è­·ä¸­çš„ç¨‹å¼ç¢¼å“è³ªã€‚</p><p>é€™ç¨®æ¸¬è©¦é¡å‹é€šå¸¸ç”±é–‹ç™¼äººå“¡è‡ªè¡Œæ’°å¯«ï¼Œè‡ªå·±å¯«çš„ Code è‡ªå·±å¯«æ¸¬è©¦ï¼Œæœ‰ç¶“é©—çš„é–‹ç™¼äººå“¡å¯ä»¥ç”¨éå¸¸æœ‰æ•ˆç‡çš„æ–¹å¼æ’°å¯«å–®å…ƒæ¸¬è©¦ï¼Œå› ç‚ºæ¸¬è©¦ç¯„åœå°ï¼Œé€™ç¨®é¡å‹çš„æ¸¬è©¦é€šå¸¸ä¸éœ€è¦è¨­ç«‹æ¸¬è©¦ç’°å¢ƒï¼Œå› æ­¤å¯ä»¥å¾—åˆ°è¼ƒé«˜çš„æ’°å¯«æ•ˆç‡ï¼Œä¹Ÿæ˜¯æ‰€æœ‰æ¸¬è©¦é¡å‹ä¸­æœ€å®¹æ˜“æ’°å¯«çš„æ¸¬è©¦é¡å‹ã€‚ä¸éï¼Œå°æ–¼ä¸€å€‹æ²’æœ‰ç¶“é©—çš„é–‹ç™¼è€…ä¾†èªªï¼Œæ’°å¯«å–®å…ƒæ¸¬è©¦å¯èƒ½æœƒè€—ç”¨å¤§é‡æ™‚é–“ï¼Œå¯«æ¸¬è©¦ç¨‹å¼çš„æ™‚é–“å¾ˆæœ‰å¯èƒ½æœƒé å¤§æ–¼å¯¦éš›æ’°å¯«ç¨‹å¼ç¢¼çš„æ™‚é–“ï¼Œæœ‰è »å¤šäººæœƒå› ç‚ºé€™æ¨£è€Œæ”¾æ£„æ’°å¯«å–®å…ƒæ¸¬è©¦ã€‚</p><h3 id=æ•´åˆæ¸¬è©¦-integration-testing>æ•´åˆæ¸¬è©¦ (Integration testing)</h3><p>æ•´åˆå¤šæ–¹è³‡æºé€²è¡Œæ¸¬è©¦ï¼Œç¢ºä¿æ¨¡çµ„èˆ‡æ¨¡çµ„ä¹‹é–“çš„äº’å‹•è¡Œç‚ºæ­£ç¢ºç„¡èª¤ï¼Œä¹Ÿè®“ä¸åŒæ¨¡çµ„åœ¨å„è‡ªé–‹ç™¼ç¶­è­·çš„éç¨‹ä¸­ä¸æœƒå› ç‚ºåŠŸèƒ½èª¿æ•´è€Œé­åˆ°ç ´å£ã€‚</p><p>é€™ç¨®é¡å‹çš„æ¸¬è©¦é€šå¸¸ä»‹æ–¼å–®å…ƒæ¸¬è©¦èˆ‡ç«¯å°ç«¯æ¸¬è©¦ä¹‹é–“ï¼Œæœ‰æ™‚å€™æœƒç”±å°ˆè·çš„æ¸¬è©¦äººå“¡é€²è¡Œé–‹ç™¼ï¼Œä½†å¤§éƒ¨åˆ†é‚„æ˜¯ç”±é–‹ç™¼åœ˜éšŠä¸­è² è²¬ç‰¹å®šæ¨¡çµ„çš„äººä¾†æ’°å¯«ã€‚æœ‰æ™‚å€™å–®ä¸€æ¨¡çµ„å³ä¾¿å®Œå…¨é€šéå–®å…ƒæ¸¬è©¦ï¼Œç¨ç«‹é‹ä½œä¹Ÿæ­£å¸¸ï¼Œä½†æ˜¯ç•¶éœ€è¦èˆ‡å…¶ä»–æ¨¡çµ„äº’å‹•æ™‚ï¼Œä¹Ÿæ˜¯æœ‰å¯èƒ½ç™¼ç”ŸéŒ¯èª¤ï¼Œé€™æ™‚å°±æ˜¯æ•´åˆæ¸¬è©¦çš„ä¸»è¦è² è²¬é ˜åŸŸã€‚</p><p>ä»¥ä¸‹æ˜¯æœªé€šéæ•´åˆæ¸¬è©¦çš„æ¡ˆä¾‹ï¼š(å…©å€‹å…ƒä»¶åœ¨æ•´åˆæ™‚ç™¼ç¾å•é¡Œ)</p><p><img src=https://live.staticflickr.com/65535/52593420093_cb58f5a813_o.gif max-width=100% max-height=100% class=gallery-image loading=lazy></p><h3 id=ç«¯å°ç«¯æ¸¬è©¦-end-to-end-testing-e2e-testing>ç«¯å°ç«¯æ¸¬è©¦ (End-to-end testing) (E2E testing)</h3><p>æ‰€è¬‚çš„ã€Œç«¯å°ç«¯ã€(E2E) æ˜¯æŒ‡å¾ä½¿ç”¨è€…çš„è§’åº¦å‡ºç™¼(ä¸€ç«¯)ï¼Œå°çœŸå¯¦ç³»çµ±(å¦ä¸€ç«¯)é€²è¡Œæ¸¬è©¦ã€‚</p><p>é€™ç¨®é¡å‹çš„æ¸¬è©¦å°è¨±å¤šå…¬å¸ä¾†èªªï¼Œå°±æ˜¯ã€Œäººå·¥æ¸¬è©¦ã€çš„ä¸»è¦ç¯„åœï¼Œå› ç‚ºä½ å¯ä»¥é€éäººå·¥å°å·²ç¶“å®Œæ•´éƒ¨å±¬çš„ç¶²ç«™é€²è¡Œæ¸¬è©¦ï¼Œå› æ­¤å¯ä»¥é©—è­‰å‡ºç³»çµ±æ˜¯å¦ç¬¦åˆå®¢æˆ¶çš„å¯¦éš›éœ€æ±‚ã€‚é€™éƒ¨åˆ†ä¹Ÿå¯ä»¥é€éæ’°å¯« E2E æ¸¬è©¦ç¨‹å¼ä¾†é€²è¡Œè‡ªå‹•åŒ–ï¼Œå¢åŠ æ¸¬è©¦æ•ˆç‡ã€‚</p><p>é€™è£¡æœ‰å€‹<a class=link href=https://twitter.com/i/status/1078363114666627072 target=_blank rel=noopener>æœªé€šé E2E æ¸¬è©¦çš„æ¡ˆä¾‹</a>ç›¸ç•¶æœ‰è¶£ï¼Œé›–ç„¶æ¯å€‹æ•´å¥—ç³»çµ±æ¯å€‹æ¨¡çµ„éƒ½é€šéæ‰€æœ‰å–®å…ƒæ¸¬è©¦èˆ‡æ•´åˆæ¸¬è©¦ï¼Œä½†æœ€å¾Œçµ„è£èµ·ä¾†å¾Œï¼Œå¾ä½¿ç”¨è€…çš„è§’åº¦ç„¡æ³•æ¥å—ï¼</p><hr><h2 id=æ¸¬è©¦æ¡ˆä¾‹ä¸­çš„-3a-æ¨¡å¼>æ¸¬è©¦æ¡ˆä¾‹ä¸­çš„ 3A æ¨¡å¼</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;è²“å’ª&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;é¤µé£Ÿï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‹¿ç©å…·é€—ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;ä»€éº¼éƒ½ä¸åšï¼Œæ‡‰è©²æ¨å€’çœ¼å‰çœ‹åˆ°çš„æ‰€æœ‰æ±è¥¿&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ç•¶æˆ‘å€‘è¨­ç«‹å¥½æ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹çš„æ•˜è¿°çµæ§‹ä¹‹å¾Œï¼Œè¦é–‹å§‹æ’°å¯«æ¸¬è©¦æ¡ˆä¾‹å…§éƒ¨çš„å¯¦ä½œæ™‚å°±å¯ä»¥åˆ©ç”¨æ‰€è¬‚çš„ 3A æ¨¡å¼ä¾†å®‰æ’ã€‚</p><p><strong>3A</strong> æ¨¡å¼ä¸»è¦æ˜¯ç‚º(<strong>Arrange-Act-Assert</strong>)ä¸‰å€‹è‹±æ–‡å­—çš„ç¸®å¯«ï¼Œè€Œä»–å€‘åˆ†åˆ¥ä»£è¡¨äº†ï¼š</p><ul><li><strong>æº–å‚™(Arrange)</strong>ï¼šæº–å‚™å¥½å—æ¸¬ç›®æ¨™éœ€è¦çš„ä¸€åˆ‡ï¼ŒåŒ…å«ä¾è³´çš„éš”é›¢ç­‰</li><li><strong>æ“ä½œ(Act)</strong>ï¼šæ“ä½œå—æ¸¬ç‰©ç›®æ¨™</li><li><strong>æ–·è¨€(Assert)</strong>ï¼šé æœŸå—æ¸¬ç‰©çš„æŸå€‹ç‹€æ…‹æ˜¯å¦ç‚ºæˆ‘å€‘æ‰€é æœŸ</li></ul><p>ä»¥ä¸Šæ–¹ç¬¬ä¸€é …æ¸¬è©¦æ¡ˆä¾‹ä¾†å¥—ç”¨ 3A æ¨¡å¼çš„è©±å°±æœƒåƒæ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Arrange: æº–å‚™å¥½ä¸€éš»è²“
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>target</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Cat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Act: æ‘¸æ‘¸é‚£éš»è²“å’ª
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>target</span><span class=p>.</span><span class=nx>touch</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Assert: è§€å¯Ÿé‚£éš»è²“æ˜¯å¦ç™¼å‡ºå‘¼åš•åš•å«è²
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>speaking</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;å‘¼åš•åš•&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>é‚£å¦‚æœé€™æ™‚å€™ä½ å¯èƒ½æœƒæƒ³åˆ°æ¯å€‹æ¸¬è©¦æ¡ˆä¾‹éƒ½è¦æº–å‚™ä¸€éš»è²“è²“ï¼Œå°æ–¼æ¸¬è©¦æ¡ˆä¾‹ä¾†èªªå°±æœƒä¸€ç›´ä¸æ–·åœ°å»åšã€Œ<strong>æº–å‚™(Arrange)</strong>ã€é€™å€‹è¡Œç‚ºï¼Œå› æ­¤ä½ å¯èƒ½æœƒå¾ˆç›´è¦ºçš„é€™éº¼è™•ç†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;è²“å’ª&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>target</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Cat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>target</span><span class=p>.</span><span class=nx>touch</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>speaking</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;å‘¼åš•åš•&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;é¤µé£Ÿï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>target</span><span class=p>.</span><span class=nx>feed</span><span class=p>(</span><span class=s1>&#39;ä¹¾ä¹¾&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>speaking</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;å‘¼åš•åš•&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‹¿ç©å…·é€—ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>target</span><span class=p>.</span><span class=nx>play</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>speaking</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;å‘¼åš•åš•&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½†é€™æ¨£çš„å¾Œæœå°±æ˜¯æ¯å€‹æ¸¬è©¦æ¡ˆä¾‹ä¹‹é–“å°±æœƒæœ‰é—œè¯äº†ï¼Œæ¯”æ–¹è²“è²“å…¶å¯¦æ‘¸å¤ªå¤šä¸‹ä»–ä¹Ÿæœƒè¦ºå¾—å­ç…©ï¼Œå¾è€Œå°è‡´æ¸¬è©¦å¤±æ•—ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;è²“å’ª&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>target</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Cat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸ä¸‹å·´ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>target</span><span class=p>.</span><span class=nx>touch</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>speaking</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;å‘¼åš•åš•&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;å†æ‘¸ä¸€æ¬¡ä¸‹å·´ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>target</span><span class=p>.</span><span class=nx>touch</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>speaking</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;å‘¼åš•åš•&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;å†æ‘¸ä¸€æ¬¡ä¸‹å·´ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>target</span><span class=p>.</span><span class=nx>touch</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>speaking</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;å‘¼åš•åš•&#39;</span><span class=p>)</span> <span class=c1>// é æœŸå‘¼åš•åš•ï¼Œçµæœè²“å’ªç”Ÿæ°£äº†
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œè¦å¯«å¥½æ¸¬è©¦æ¡ˆä¾‹çš„å…¶ä¸­å¹¾å€‹æ¦‚å¿µå°±æ˜¯è¦ç›¡é‡è®“æ¯å€‹æ¸¬è©¦æ¡ˆä¾‹ä¹‹é–“ã€Œ<strong>ä¸å—é †åºå½±éŸ¿æ¸¬è©¦çµæœ</strong>ã€èˆ‡ã€Œ<strong>ä¿æŒç¨ç«‹</strong>ã€ã€‚</p><p>å› æ­¤å¤§å¤šæ•¸çš„ã€Œæ¸¬è©¦ç’°å¢ƒã€çš„å·¥å…·éƒ½æœƒæä¾›é¡ä¼¼ç›¸é—œçš„ API ä¾†å”åŠ©è™•ç†æ¸¬è©¦é–‹å§‹å‰çš„ã€Œ<strong>Setup</strong>ã€èˆ‡çµæŸå¾Œçš„ã€Œ<strong>Teardown</strong>ã€ç’°ç¯€ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;è²“å’ª&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>target</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Cat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>beforeEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æ¯å€‹æ¸¬è©¦æ¡ˆä¾‹é–‹å§‹å‰è¦åšçš„äº‹æƒ…
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>target</span><span class=p>.</span><span class=nx>init</span><span class=p>()</span> <span class=c1>// åˆå§‹åŒ–è²“è²“çš„å„ç¨®ç‹€æ…‹
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>afterEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æ¯å€‹æ¸¬è©¦æ¡ˆä¾‹çµæŸå¾Œè¦åšçš„äº‹æƒ…
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>target</span><span class=p>.</span><span class=nx>touch</span><span class=p>()</span> <span class=c1>// é€™æ™‚å€™çš„ target å·²ç¶“æ˜¯ç¶“é init() çš„ç‰ˆæœ¬äº†
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>speaking</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;å‘¼åš•åš•&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;é¤µé£Ÿï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>target</span><span class=p>.</span><span class=nx>feed</span><span class=p>(</span><span class=s1>&#39;ä¹¾ä¹¾&#39;</span><span class=p>)</span> <span class=c1>// é€™æ™‚å€™çš„ target å·²ç¶“æ˜¯ç¶“é init() çš„ç‰ˆæœ¬äº†
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>speaking</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;å‘¼åš•åš•&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‹¿ç©å…·é€—ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>target</span><span class=p>.</span><span class=nx>play</span><span class=p>()</span> <span class=c1>// é€™æ™‚å€™çš„ target å·²ç¶“æ˜¯ç¶“é init() çš„ç‰ˆæœ¬äº†
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>speaking</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;å‘¼åš•åš•&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ç¶œåˆä¸Šè¿° <strong>3A</strong> èˆ‡è™•ç† <strong>Setup</strong> & <strong>Teardown</strong> çš„è§€å¿µï¼Œä¹‹å¾Œå†å¯«æ¸¬è©¦æ¡ˆä¾‹æ™‚ï¼Œæˆ‘å€‘å¯ä»¥å…ˆå¾åŸºç¤çš„ <strong>3A</strong> æ¨¡å¼é–‹å§‹æ’°å¯«ï¼Œè€Œåˆ°æœ‰éœ€è¦è™•ç†é‡è¤‡çš„äº‹å‰æº–å‚™(Setup)èˆ‡å¾ŒçºŒæ¸…ç†æ™‚(Teardown)ï¼Œå°±å¯ä»¥è—‰ç”±å·¥å…·ä¾†æ›¿æˆ‘å€‘çµ±ä¸€è™•ç†ã€‚</p><p>çœ‹åˆ°é€™é‚Šè®€è€…æ‡‰è©²æœƒç™¼ç¾ï¼Œæ¸¬è©¦çš„åŸºæœ¬æ¦‚å¿µå…¶å¯¦ä¸é›£æ‡‚ï¼Œè€Œåœ¨ç­è§£æ¸¬è©¦çš„æ¦‚å¿µå¾Œï¼Œå‰©ä¸‹çš„å°±æ˜¯æŠŠæ¦‚å¿µè½‰æ›ç‚ºæ¸¬è©¦å·¥å…·å¯è®€æ‡‚æ¸¬è©¦ç¨‹å¼ç¢¼å°±å¥½äº†ï¼</p><hr><h2 id=å°ˆæ¡ˆåŠ å…¥-vitest>å°ˆæ¡ˆåŠ å…¥ Vitest</h2><h3 id=åœ¨åˆå§‹åŒ–å°ˆæ¡ˆéç¨‹åŠ å…¥-vitest>åœ¨åˆå§‹åŒ–å°ˆæ¡ˆéç¨‹åŠ å…¥ Vitest</h3><p>å»ºç«‹å°ˆæ¡ˆæ™‚è‹¥è¦åŠ å…¥å–®å…ƒæ¸¬è©¦è¦æ³¨æ„åˆ°çš„æ˜¯ï¼šNode.js ç‰ˆæœ¬å¿…é ˆç‚º 14 ä»¥ä¸Šï¼Œå¦å‰‡ Vitest æœƒç„¡æ³•é †åˆ©åŸ·è¡Œï¼</p><p>ç¢ºèª Node.js ç‰ˆæœ¬å¾Œï¼Œåœ¨è¦å»ºç«‹å°ˆæ¡ˆçš„çˆ¶å±¤è·¯å¾‘åº•ä¸‹é€éçµ‚ç«¯æ©ŸæŒ‡ä»¤è¼¸å…¥ <code>npm create vite@latest</code> ä¾†å»ºç«‹ä¸€å€‹åŸºæ–¼ Vite æ‰€å»ºæ§‹çš„å°ˆæ¡ˆï¼Œæ¥è‘—çµ‚ç«¯æ©Ÿæœƒå‡ºç¾ä¸€äº›å•é¡Œï¼Œè¦–å°ˆæ¡ˆéœ€æ±‚é¸æ“‡ï¼š</p><p><img src=https://live.staticflickr.com/65535/52593587230_cdfd077261_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><ul><li>Project name â‡’ è¼¸å…¥è‡ªè¨‚çš„å°ˆæ¡ˆåç¨±å¾ŒæŒ‰ä¸‹ Enter</li><li>Select a framework â‡’ é¸æ“‡ <code>Vue</code> å¾ŒæŒ‰ä¸‹ Enter</li><li>Select a variant â‡’ é¸æ“‡ <code>Customize with create-vue</code> å¾ŒæŒ‰ä¸‹ Enter</li><li>ä¸­é–“å¯èƒ½é‚„æœƒæœ‰ TypeScript, ESLintâ‹¯â‹¯ç­‰ç­‰å•é¡Œï¼Œè«‹è¦–å°ˆæ¡ˆéœ€è¦åŠ å…¥</li><li>Add Vitest for Unit Testing(y/n) â‡’ é¸æ“‡ <code>Yes</code> å¾ŒæŒ‰ä¸‹ Enter <strong>(æœ€é‡è¦çš„éƒ¨åˆ†</strong></li></ul><p>å›ç­”å®Œä¸Šé¢çš„å•é¡Œå¾Œï¼Œå»ºæ§‹å·¥å…·å°±æœƒä¾æ“šå‰›æ‰ç­”è¦†çš„å…§å®¹ï¼Œè‡ªå‹•ç”Ÿæˆéœ€è¦çš„éƒ¨åˆ†ã€‚</p><p>æ¯”æ–¹åœ¨ <code>Add Vitest for Unit Testing</code> å•é¡Œå›ç­” <code>Yes</code> çš„è©±ï¼Œé€™æ™‚å»ºæ§‹å·¥å…·å°±æœƒåœ¨å°ˆæ¡ˆä¸­ç”Ÿæˆå–®å…ƒæ¸¬è©¦æ‰€éœ€è¦çš„ç›¸é—œå…§å®¹å¦‚ä¸‹ï¼š</p><ul><li>ä¸€å€‹ä½æ–¼ <code>~å°ˆæ¡ˆæ ¹ç›®éŒ„/src/components/__test__/HelloWorld.spec.js</code> çš„æ¸¬è©¦ç¯„ä¾‹</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>describe</span><span class=p>,</span> <span class=nx>it</span><span class=p>,</span> <span class=nx>expect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vitest&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>mount</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@vue/test-utils&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>HelloWorld</span> <span class=nx>from</span> <span class=s1>&#39;../HelloWorld.vue&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;HelloWorld&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;renders properly&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>HelloWorld</span><span class=p>,</span> <span class=p>{</span> <span class=nx>props</span><span class=o>:</span> <span class=p>{</span> <span class=nx>msg</span><span class=o>:</span> <span class=s1>&#39;Hello Vitest&#39;</span> <span class=p>}</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toContain</span><span class=p>(</span><span class=s1>&#39;Hello Vitest&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>åœ¨ <code>~å°ˆæ¡ˆæ ¹ç›®éŒ„/package.json</code> è‡ªå‹•æ–°å¢ä¸€å€‹å•Ÿå‹•å–®å…ƒæ¸¬è©¦çš„ scripts æŒ‡ä»¤</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;test:unit&#34;</span><span class=p>:</span> <span class=s2>&#34;vitest --environment jsdom&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>åœ¨ <code>~å°ˆæ¡ˆæ ¹ç›®éŒ„/package.json</code> è‡ªå‹•æ–°å¢å–®å…ƒæ¸¬è©¦æ‰€éœ€è¦çš„å·¥å…·å€‘</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;devDependencies&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;@vue/test-utils&#34;</span><span class=p>:</span> <span class=s2>&#34;^2.0.2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;jsdom&#34;</span><span class=p>:</span> <span class=s2>&#34;^20.0.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;vitest&#34;</span><span class=p>:</span> <span class=s2>&#34;^0.23.0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥è‘—å¦‚å‰›å‰›çµ‚ç«¯æ©Ÿå¾Œæ–¹çš„æç¤ºï¼š</p><p><img src=https://live.staticflickr.com/65535/52593586900_2fbde224e0_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><ul><li>åŸ·è¡Œ <code>cd {å‰›æ‰å°ˆæ¡ˆåç¨±}</code> åˆ‡æ›åˆ°å°ˆæ¡ˆç›®éŒ„åº•ä¸‹</li><li>åŸ·è¡Œ <code>npm install</code> å®‰è£å°ˆæ¡ˆæ‰€éœ€è¦çš„å…§å®¹</li></ul><p>å®‰è£å®Œç•¢å¾Œï¼Œæ¥è‘—å°±å¯ä»¥åŸ·è¡Œ <code>npm run dev</code> ç¢ºèªç’°å¢ƒï¼Œå¾ŒçºŒè¦åŸ·è¡Œæ¸¬è©¦çš„è©±ï¼ŒåŸ·è¡Œ <code>npm run test:unit</code> å°±èƒ½ç«‹å³é‹ä½œäº†ã€‚</p><h3 id=åœ¨æ—¢æœ‰å°ˆæ¡ˆä¸­åŠ å…¥-vitest>åœ¨æ—¢æœ‰å°ˆæ¡ˆä¸­åŠ å…¥ Vitest</h3><p>åœ¨æ—¢æœ‰å°ˆæ¡ˆä¸­åŠ å…¥ <code>Vitest</code> ä¾†ä½œç‚ºåŸ·è¡Œæ¸¬è©¦çš„ç’°å¢ƒæ™‚ï¼Œéœ€ç¢ºèªå°ˆæ¡ˆæœ¬èº«æ˜¯ç”± <code>Vite</code>(<code>2.7.10</code> ç‰ˆæœ¬ä»¥ä¸Š)æ‰€å»ºæ§‹çš„ä¹‹å¤–ï¼Œå…¶ <code>Node.js</code> ç‰ˆæœ¬ä¹Ÿå¿…é ˆç‚º <code>14</code> ä»¥ä¸Šï¼Œå¦å‰‡æœƒç„¡æ³•é †åˆ©åŸ·è¡Œæ¸¬è©¦ï¼</p><p>ç¢ºèªå¥½å¿…è¦æ¢ä»¶å¾Œå°±å¯ä»¥é–‹å§‹å®‰è£æ¸¬è©¦å·¥å…·ï¼š</p><ul><li><code>vitest</code>ï¼šå–®å…ƒæ¸¬è©¦æ¡†æ¶(æä¾›äº†åŸ·è¡Œæ¸¬è©¦çš„ç’°å¢ƒã€æ–·è¨€ã€éš”é›¢åº«â‹¯â‹¯ç­‰ç­‰åŠŸèƒ½èˆ‡ API)</li><li><code>@vue/test-utils</code>ï¼šæ¸¬è©¦ <code>Vue</code> å…ƒä»¶çš„å·¥å…·</li><li><code>jsdom</code>ï¼šè®“æˆ‘å€‘å¯ä»¥åœ¨ <code>Node</code> ç’°å¢ƒæ¨¡æ“¬å‡ºç€è¦½å™¨ä¸­çš„ <code>DOM</code> ç’°å¢ƒ(æ–¹ä¾¿æ¸¬è©¦)</li></ul><ol><li>åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹åŸ·è¡Œï¼š</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm install -D vitest @vue/test-utils jsdom
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>æ–°å¢ npm åŸ·è¡Œå–®å…ƒæ¸¬è©¦çš„æŒ‡ä»¤ï¼š</li></ol><h5 id=packagejson>package.json</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;test:unit&#34;</span><span class=p>:</span> <span class=s2>&#34;vitest --environment jsdom&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>é€™æ™‚è‹¥å¿ƒæ€¥çš„åŸ·è¡Œ <code>npm run test:unit</code> æœƒç™¼ç¾çµ‚ç«¯æ©Ÿå‘Šè¨´ä½  <code>No test files found, exiting with code 1</code>ï¼ŒåŸå› æ˜¯ä½ <strong>å°šæœªåŠ å…¥ä»»ä½•ä¸€å€‹æ¸¬è©¦æ¡ˆä¾‹</strong>ã€‚</p><p>è€Œä¸€é–‹å§‹ <code>Vitest</code> é è¨­æ¸¬è©¦çš„æ¯”å°è¦å‰‡æ˜¯ <code>*/*.{test,spec}.{js,mjs,cjs,ts,mts,cts,jsx,tsx}</code>ï¼Œç°¡å–®ä¾†èªªä½ åœ¨å°ˆæ¡ˆåº•ä¸‹ä½¿ç”¨ <code>A.test.js</code> æˆ–æ˜¯ <code>B.spec.ts</code> çš„æ–¹å¼éƒ½æœƒè¢« Vitest èªç‚ºæ˜¯æ¸¬è©¦ç¨‹å¼æª”ã€‚</p><p>é€™æ™‚ï¼Œæˆ‘å€‘å¯ä»¥åœ¨ <code>~å°ˆæ¡ˆæ ¹ç›®éŒ„/src/components/__test__/</code> åº•ä¸‹æ–°å»º <code>HelloWorld.spec.js</code>ï¼š</p><h5 id=srccomponents__test__helloworldspecjs>src/components/<strong>test</strong>/HelloWorld.spec.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>describe</span><span class=p>,</span> <span class=nx>it</span><span class=p>,</span> <span class=nx>expect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vitest&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;HelloWorld&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;1 + 1 should be 2&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=mi>1</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å†æ¬¡åŸ·è¡Œ <code>npm run test:unit</code> çµ‚ç«¯æ©Ÿå°±æœƒé¡¯ç¤ºï¼š</p><p><img src=https://live.staticflickr.com/65535/52593421644_db0c07f63f_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>åˆ°é€™è£¡å°±ç®—æ˜¯æˆåŠŸå®‰è£å¥½å›‰ï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘æœƒå†æŠŠ <code>Vitest Config</code> åˆæœŸéœ€è¦è¨­å®šçš„éƒ¨åˆ†èª¿æ•´å¥½å¾Œï¼Œå»ºç½®çš„éƒ¨åˆ†å°±å®Œæˆäº†ã€‚</p><hr><h2 id=vitest-config-è¨­å®šæ–¹å¼>Vitest Config è¨­å®šæ–¹å¼</h2><p>Vitest æ¸¬è©¦åœ¨åŸ·è¡Œçš„æ™‚å€™é è¨­æœƒåŸºæ–¼åŸå…ˆå°ˆæ¡ˆä¸­çš„ <code>vite.config.js</code> è¨­å®šæª”ï¼Œæ‰€ä»¥æ²’æœ‰éœ€è¦èª¿æ•´çš„è©±ä¸å¤ªéœ€è¦å¦å¤–è¨­ç½®ï¼Œéœ€è¦èª¿æ•´çš„è©± Vitest ä¹Ÿæä¾›äº†ä¸‰ç¨®æ–¹æ³•è®“ä½ åœ¨ä¸åŒé–‹ç™¼æƒ…å¢ƒä¸‹é¸æ“‡èª¿æ•´æ–¹å¼ï¼š</p><ul><li>åŸ·è¡Œ <code>npm</code> æŒ‡ä»¤æ™‚å¸¶åƒæ•¸æŒ‡å®šè¨­å®šæª”æ¡ˆè·¯å¾‘</li><li>ç›´æ¥åœ¨åŸå…ˆ <code>vite.config.js</code> ä¸­èª¿æ•´</li><li>é€é <code>vitest.config.js</code> æª”æ¡ˆèª¿æ•´æ¸¬è©¦è¨­å®š</li></ul><h3 id=åŸ·è¡Œ-npm-æŒ‡ä»¤æ™‚å¸¶åƒæ•¸æŒ‡å®šè¨­å®šæª”æ¡ˆè·¯å¾‘>åŸ·è¡Œ npm æŒ‡ä»¤æ™‚å¸¶åƒæ•¸æŒ‡å®šè¨­å®šæª”æ¡ˆè·¯å¾‘</h3><p>è‹¥æƒ³è¦åœ¨åŸ·è¡Œçš„æ™‚å€™å»å¼•å…¥ä¸åŒçš„è¨­å®šæª”æ¡ˆï¼Œå‰‡å¯ä»¥åœ¨ <code>package.json</code> æŒ‡ä»¤ä¸­é€é <code>--config</code> åŠ ä¸Šè¨­å®šæª”æ¡ˆçš„è·¯å¾‘(e.g. <code>vitest --config ./src/scripts/vitest.config.js</code> )ï¼š</p><h5 id=packagejson-1>package.json</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>//...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;test:unit&#34;</span><span class=p>:</span> <span class=s2>&#34;vitest --config ./src/__test__/config/vitest.config.js&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>//...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥è‘—è©²æª”æ¡ˆå°±å¦‚è¨­å®š <code>vitest.config.js</code> ä¸€æ¨£èª¿æ•´å°±å¯ä»¥äº†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineConfig</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vite&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>vue</span> <span class=nx>from</span> <span class=s1>&#39;@vitejs/plugin-vue&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// https://vitejs.dev/config/
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=k>default</span> <span class=nx>defineConfig</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>plugins</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=nx>vue</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// åœ¨é€™é‚ŠåŠ å…¥è¨­å®š
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=åœ¨å°ˆæ¡ˆä¸­çš„-viteconfigjs-ä¸­èª¿æ•´æ¸¬è©¦è¨­å®š>åœ¨å°ˆæ¡ˆä¸­çš„ vite.config.js ä¸­èª¿æ•´æ¸¬è©¦è¨­å®š</h3><p>è‹¥æƒ³åœ¨åŸå…ˆçš„ <code>vite.config.js</code> ä¸­èª¿æ•´æ¸¬è©¦è¨­å®šï¼Œæœ‰å…©ç¨®æ–¹å¼å¯ä»¥ä½¿ç”¨ï¼š</p><ul><li>ç¬¬ä¸€ç¨®æ˜¯ç›´æ¥åœ¨æœ€ä¸Šæ–¹åŠ å…¥ <code>/// &lt;reference types="vitest" /></code> å¾Œï¼Œåœ¨ test å±¬æ€§ä¸­åŠ å…¥è¨­å®šï¼š</li></ul><h5 id=viteconfigjs>vite.config.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>/// &lt;reference types=&#34;vitest&#34; /&gt;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineConfig</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vite&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>defineConfig</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// åœ¨é€™é‚ŠåŠ å…¥è¨­å®š
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>ç¬¬äºŒç¨®ï¼ŒæŠŠåŸå…ˆçš„ <code>defineConfig</code> æ”¹ç”± <code>vitest/config</code> å‚³å…¥å¾Œï¼Œåœ¨ <code>test</code> å±¬æ€§ä¸­åŠ å…¥è¨­å®šï¼š</li></ul><h5 id=viteconfigjs-1>vite.config.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineConfig</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vitest/config&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>defineConfig</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// åœ¨é€™é‚ŠåŠ å…¥è¨­å®š
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=é€é-vitestconfigjs-æª”æ¡ˆèª¿æ•´æ¸¬è©¦è¨­å®š>é€é vitest.config.js æª”æ¡ˆèª¿æ•´æ¸¬è©¦è¨­å®š</h3><p>è‹¥æƒ³å€éš”é–‹ç™¼èˆ‡æ¸¬è©¦ç”¨çš„è¨­å®šæ™‚ï¼Œå¯ä»¥åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸­æ–°å¢ <code>vitest.config.js</code> æª”æ¡ˆï¼Œé€™æœƒæ¯”åŸå…ˆåƒè€ƒçš„ <code>vite.config.js</code> æ“æœ‰æ›´é«˜çš„å„ªå…ˆæ¬Šã€‚</p><p>ä¸æƒ³å°‡åŸå…ˆåœ¨ <code>vite.config.js</code> è¨­å®šéƒ½é‡æ–°å…¨å¯«ä¸€æ¬¡çš„è©±ï¼Œä¹Ÿå¯ä»¥åœ¨ <code>vitest.config.js</code> ä¸­ï¼Œä½¿ç”¨ <code>mergeConfig</code> ä¾†èåˆ <code>vite.config.js</code> çš„è¨­å®šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>mergeConfig</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vite&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineConfig</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vitest/config&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>viteConfig</span> <span class=nx>from</span> <span class=s1>&#39;./vite.config&#39;</span> <span class=c1>// åŸå…ˆçš„ vite è¨­å®šæª”æ¡ˆ
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>mergeConfig</span><span class=p>(</span><span class=nx>viteConfig</span><span class=p>,</span> <span class=nx>defineConfig</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// åœ¨é€™è£¡åŠ å…¥æ¸¬è©¦è¨­å®š
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}))</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=vitest-config-option>Vitest config option</h2><p>è‡³æ–¼ Vitest config èƒ½èª¿æ•´ä»€éº¼å…§å®¹å‘¢ï¼Œé€™è£¡åˆ—äº†å¹¾å€‹å¸¸è¦‹çš„èª¿æ•´é¸é …ï¼š</p><ul><li>include</li><li>exclude</li><li>globals</li><li>environment</li></ul><blockquote><p>è¨»ï¼šä»¥ä¸‹éƒ¨åˆ†è³‡æ–™å¼•ç”¨ <a class=link href=https://cn.vitest.dev/config/ target=_blank rel=noopener>Vitest Config Option</a> ä¸¦ç¿»è­¯èˆ‡è£œå……ã€‚</p></blockquote><h3 id=include>include</h3><ul><li>Typeï¼š string[]</li><li>é è¨­å€¼ï¼š [&rsquo;**/*.{test,spec}.{js,mjs,cjs,ts,mts,cts,jsx,tsx}']</li></ul><p>è—‰ç”±é€™å€‹æ¬„ä½æˆ‘å€‘å¯ä»¥æä¾› glob æ ¼å¼è®“ vitest å»æ¯”å°å“ªäº›æ˜¯æ¸¬è©¦æª”æ¡ˆï¼Œä¹Ÿå¯ä»¥æ”¾å…¥å¤šå€‹æ¢ä»¶åœ¨é™£åˆ—ä¸­ã€‚</p><h5 id=vitestconfigjs>vitest.config.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineConfig</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vitest/config&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>defineConfig</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>include</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;**/*.spec.js&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>é€™å€‹è¨­å®šä¸»è¦æœƒå½±éŸ¿åˆ°å¾ŒçºŒæˆ‘å€‘è¦å¦‚ä½•æ“ºæ”¾æ¸¬è©¦ç¨‹å¼ç¢¼ï¼Œå› æ­¤åšè¦åŠƒæ™‚å¯ä»¥æŒ‰éœ€æ±‚è€ƒé‡èª¿æ•´ã€‚</p><h3 id=exclude>exclude</h3><ul><li>Typeï¼š string[]</li><li>é è¨­å€¼ï¼š [&rsquo;<strong>/node_modules/</strong>&rsquo;, &lsquo;<strong>/dist/</strong>&rsquo;, &lsquo;<strong>/cypress/</strong>&rsquo;, &lsquo;<strong>/.{idea,git,cache,output,temp}/</strong>&rsquo;]</li></ul><p>è—‰ç”±é€™å€‹æ¬„ä½æˆ‘å€‘å¯ä»¥æä¾› glob æ ¼å¼è®“ vitest å»æ’é™¤å“ªäº›ä¸æ˜¯æ¸¬è©¦æª”æ¡ˆï¼Œä¹Ÿå¯ä»¥æ”¾å…¥å¤šå€‹æ¢ä»¶åœ¨é™£åˆ—ä¸­ã€‚</p><h5 id=vitestconfigjs-1>vitest.config.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineConfig</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vitest/config&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>defineConfig</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>exclude</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;**/node_modules/**&#39;</span><span class=p>,</span> <span class=s1>&#39;**/dist/**&#39;</span><span class=p>,</span> <span class=s1>&#39;**/cypress/**&#39;</span><span class=p>,</span> <span class=s1>&#39;**/.{idea,git,cache,output,temp}/**&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>èˆ‡ <code>include</code> ç›¸åï¼Œé€™æ¬¡å‰‡æ˜¯è¦æ’é™¤å“ªäº›è·¯å¾‘ä¸éœ€è¦å°‹æ‰¾æ˜¯å¦æœ‰æ¸¬è©¦æª”æ¡ˆï¼Œå…¶ä¸­å¦‚æœæœ‰ç”¨åˆ° <code>cypress</code> åš E2E æ¸¬è©¦çš„è©±ï¼Œé è¨­è¦å‰‡ä¸­å°±å·²ç¶“æœ‰å¦å¤–æ’é™¤äº†ï¼Œæ‰€ä»¥æ²’å¿…è¦çš„è©±ä¸å¿…ç‰¹åˆ¥è¨­ç½®ï¼Œä½†å¯ä»¥å…ˆè¨˜å¾—æœ‰é€™å€‹æ–¹ä¾¿çš„æ¬„ä½ã€‚</p><h3 id=globals>Globals</h3><ul><li>Typeï¼š boolean</li><li>é è¨­å€¼ï¼š false</li></ul><p>ç”±æ–¼åœ¨æ’°å¯«æ¸¬è©¦æ™‚ï¼ŒVitest é è¨­æ˜¯éœ€è¦è‡ªå·±æŒ‰éœ€è¦å¼•å…¥å°æ‡‰çš„æ–¹æ³•ç­‰ç­‰ï¼Œå¦‚æœè¦é¡ä¼¼åƒ Jest ä»¥<strong>å…¨åŸŸ</strong>çš„æ–¹å¼æ³¨å…¥åˆ°æ¸¬è©¦ä¸­ï¼Œå°±å¯ä»¥é€éåœ¨åŸ·è¡Œæ™‚åŠ ä¸Š <code>--globals</code> é¸é …ï¼Œæˆ–æ˜¯åœ¨ <code>vitest config</code> é¸é …ä¸­åŠ å…¥ <code>globals: true</code>ã€‚</p><h5 id=vitestconfigjs-2>vitest.config.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineConfig</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vitest/config&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>defineConfig</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>globals</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>åŸå…ˆè¨­å®šå‰ï¼Œæ¸¬è©¦ç¨‹å¼ç¢¼éœ€è¦å¦‚ä¸‹æ–¹å¼•å…¥ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>describe</span><span class=p>,</span> <span class=nx>it</span><span class=p>,</span> <span class=nx>expect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vitest&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;HelloWorld&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;1 + 1 should be 2&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=mi>1</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>åŠ å…¥ <code>Globals: true</code> å¾Œï¼Œå°±ä¸éœ€è¦é¡¯ç¤ºå¼•å…¥ vitest æ¸¬è©¦ç›¸é—œçš„ APIï¼Œè®“æ¸¬è©¦çœ‹èµ·ä¾†æ›´ä¹¾æ·¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;HelloWorld&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;1 + 1 should be 2&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=mi>1</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=environment>environment</h3><ul><li>Typeï¼š &rsquo;node&rsquo; | &lsquo;jsdom&rsquo; | &lsquo;happy-dom&rsquo; | &rsquo;edge-runtime&rsquo; | string</li><li>é è¨­å€¼ï¼š &rsquo;node&rsquo;</li></ul><p>ç”±æ–¼ Vitest æœ¬èº«é»˜èªç’°å¢ƒ Node.jsï¼Œå› æ­¤è‹¥è¦åœ¨æ¸¬è©¦ä¸­ä»¿é€ ç€è¦½å™¨çš„æ‡‰ç”¨ç¨‹å¼ï¼Œå¯ä»¥é€éé¡ä¼¼ <code>jsdom</code> ç­‰å·¥å…·ä¾†å–ä»£ï¼Œè€Œå·²ç¶“ä»‹ç´¹éçš„ npm æŒ‡ä»¤çš„å¯«æ³•ä¹‹å¤– <code>-environment jsdom</code> ï¼Œé‚„å¯ä»¥åœ¨æ¸¬è©¦æª”æ¡ˆä¸Šä»¥ docblock æˆ– comment é¢¨æ ¼çš„æ–¹å¼è¨»è¨˜ã€‚</p><p>Docblock é¢¨æ ¼ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * @vitest-environment jsdom
</span></span></span><span class=line><span class=cl><span class=cm>**/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;use jsdom in this test file&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>element</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;div&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>element</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s1>&#39;&lt;p&gt;Hello, HTML!&lt;/p&gt;&#39;</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>element</span><span class=p>.</span><span class=nx>innerHTML</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;&lt;p&gt;Hello, HTML!&lt;/p&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>Comment é¢¨æ ¼ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// @vitest-environment jsdom
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;use jsdom in this test file&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>element</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;div&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>element</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s1>&#39;&lt;p&gt;Hello, HTML!&lt;/p&gt;&#39;</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>element</span><span class=p>.</span><span class=nx>innerHTML</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;&lt;p&gt;Hello, HTML!&lt;/p&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å¯«åœ¨ <code>vitest config</code> ä¸­ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineConfig</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vitest/config&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>defineConfig</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>environment</span><span class=o>:</span> <span class=s1>&#39;jsdom&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æ­¤ä¸€ä¾†åœ¨æ¸¬è©¦ä¸­æˆ‘å€‘å°±å¯ä»¥æ¨¡æ“¬ Web ç«¯ç’°å¢ƒä¾†æ“ä½œäº†ã€‚</p><p>ä»¥ä¸Šæ˜¯ Vitest å¹¾å€‹æ¯”è¼ƒå¸¸è¦‹çš„è¨­å®šï¼Œå…¶é¤˜çš„è¨­å®šå¾ŒçºŒä¹ŸæœƒæŒ‰éœ€æ±‚é™¸çºŒæåˆ°ï¼Œè‹¥å°æ–¼å…¶ä»–è¨­å®šé¸é …æœ‰èˆˆè¶£çš„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ°å®˜æ–¹æ–‡ä»¶ä¸­çš„ <a class=link href=https://cn.vitest.dev/config/ target=_blank rel=noopener>config åˆ†é </a> æŸ¥çœ‹ã€‚</p><hr><h2 id=æ¸¬è©¦çš„æœ¬è³ª>æ¸¬è©¦çš„æœ¬è³ª</h2><p>æ¸¬è©¦çš„æœ¬è³ªç©¶ç«Ÿæ˜¯ä»€éº¼ï¼Ÿæ¸¬è©¦ç°¡å–®çš„ä¾†èªªä¸»è¦å°±æ˜¯è—‰ç”±æ“æ§å—æ¸¬ç‰©(SUT, System Under Test)ï¼Œè§€å¯Ÿç”±å—æ¸¬ç‰©ç”¢ç”Ÿçš„æœ€çµ‚ç‹€æ…‹æ˜¯å¦å¦‚æˆ‘å€‘æ‰€é æœŸçš„æ¨£å­ï¼š</p><p><img src=https://live.staticflickr.com/65535/52593421659_5c5cde3ea2_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>è‹¥æœ€çµ‚ç‹€æ…‹ç¬¦åˆæˆ‘å€‘çš„é æœŸï¼Œå°æ–¼é–‹ç™¼è€…çš„å«ç¾©ä¾†èªªï¼Œå°±æ˜¯å—æ¸¬ç‰©ç¬¦åˆäº†æˆ‘å€‘çš„æœŸå¾…ã€‚</p><p>ä½†é€™é»å¥½è™•çœ‹ä¼¼æ²’æœ‰åšã€Œæ¸¬è©¦ã€çš„å¿…è¦ï¼Œç•¢ç«Ÿæˆ‘å€‘å¹³æ™‚é–‹ç™¼èƒ½é©—æ”¶å®Œæˆä¸å°±æ˜¯ç¬¦åˆäº†è¦æ ¼æ›¸çš„æœŸå¾…å—ï¼Ÿ</p><p>å› æ­¤ç‚ºäº†èƒ½å¤ æ›´åŠ é«”æœƒæ¸¬è©¦èƒŒå¾Œçš„åƒ¹å€¼ï¼Œæˆ‘å€‘æ¥ä¸‹ä¾†å°‡å¯¦éš›åšä¸€å€‹æ¸¬è©¦å·¥å…·ä¾†ä¾†æª¢é©—æˆ‘å€‘è‡ªå·±æ‰€å¯«çš„å‡½å¼ã€‚</p><h3 id=æƒ…å¢ƒèˆ‰ä¾‹>æƒ…å¢ƒèˆ‰ä¾‹</h3><p>é¦–å…ˆï¼Œæƒ…å¢ƒå‡è¨­åœ¨å°ˆæ¡ˆä¸­æœ‰ä¸€è™•é‚è¼¯åˆ¤æ–·éœ€è¦æª¢æ¸¬å‚³é€²ä¾†è³‡æ–™çš„æ˜¯å¦ç‚ºæ•¸å€¼(Numeric)ï¼Œè€Œå‚³é€²ä¾†çš„è³‡æ–™å¯èƒ½æœ‰ <code>1</code>, <code>null</code>, <code>'100'</code>, <code>NaN</code> ç­‰ã€‚</p><p>æˆ‘å€‘å¸Œæœ›ç•¶ <code>1</code> å’Œ <code>'100'</code> æ™‚ï¼Œè©²åˆ¤æ–·æ‡‰è©²è¦ç‚º <code>true</code>ï¼Œè€Œ <code>null</code> èˆ‡ <code>NaN</code> å‰‡æ˜¯è¦ç‚º <code>false</code>ã€‚</p><p>æ¥ä¸‹ä¾†çš„ç›®æ¨™æˆ‘å€‘è¦åšçš„å°±æ˜¯ï¼š</p><ol><li>è£½ä½œä¸€å€‹ç°¡æ˜“çš„æ¸¬è©¦å·¥å…·</li><li>å¯«æ¸¬è©¦æ¡ˆä¾‹</li><li>å¯«å—æ¸¬ç¨‹å¼ç¢¼çš„å¯¦ä½œ</li></ol><h3 id=ç°¡æ˜“çš„æ¸¬è©¦å·¥å…·>ç°¡æ˜“çš„æ¸¬è©¦å·¥å…·</h3><p>é¦–å…ˆè¦åŠƒä¸€ä¸‹å·¥å…·æˆ‘æœ€å¾Œå¸Œæœ›ç”¨èµ·ä¾†åƒæ˜¯é€™å€‹æ¨£å­ï¼š</p><p><code>expect(å—æ¸¬ç‰©).toBe(é æœŸç‹€æ…‹)</code></p><ul><li>å›å‚³ <code>true</code> è¡¨ç¤ºæ¸¬è©¦æˆåŠŸ (å³ç‚ºæœ€çµ‚ç‹€æ…‹èˆ‡é æœŸç‹€æ…‹ç›¸åŒ)</li><li>å›å‚³ <code>false</code> è¡¨ç¤ºæ¸¬è©¦å¤±æ•— (å³ç‚ºæœ€çµ‚ç‹€æ…‹èˆ‡é æœŸç‹€æ…‹ä¸åŒ)ï¼Œç„¶å¾ŒåŠ ä¸Š error æç¤ºé æœŸç‹€æ…‹æ‡‰è©²è¦æ˜¯ä»€éº¼ï¼Œæœ€çµ‚ç‹€æ…‹ç›®å‰æ˜¯ä»€éº¼ã€‚</li></ul><p>æ¥è‘—æŒ‰ç…§ä¸Šé¢çš„è¨­æƒ³ï¼Œå…ˆå®šç¾©äº†ä¸€å€‹å®£å‘Šå‡½å¼ <code>expect</code>ï¼Œåƒæ•¸å‰‡æ˜¯é è¨ˆè¼¸å…¥å—æ¸¬ç‰©(<code>input</code>)èˆ‡ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>expect</span> <span class=o>=</span> <span class=p>(</span><span class=nx>input</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å†ä¾†å·¥å…·æœ¬èº«å‘¼å«æ™‚éœ€å›å‚³äº†ä¸€å€‹å«åš <code>toBe</code> çš„é©—è­‰æ–¹æ³•ï¼Œè©²é©—è­‰æ–¹æ³•çš„åƒæ•¸ç‚ºé æœŸç›®æ¨™(<code>expected</code>)ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>expect</span> <span class=o>=</span> <span class=p>(</span><span class=nx>input</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>toBe</span> <span class=o>=</span> <span class=p>(</span><span class=nx>expected</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>toBe</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥è‘—è¨­è¨ˆè©²é©—è­‰çš„æ–¹æ³•ï¼Œä½¿å…¶èƒ½å¤ å›æ‡‰æ¸¬è©¦çš„çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>expect</span> <span class=o>=</span> <span class=p>(</span><span class=nx>input</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>toBe</span> <span class=o>=</span> <span class=p>(</span><span class=nx>expected</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>input</span> <span class=o>===</span> <span class=nx>expected</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>toBe</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ç¾åœ¨æˆ‘å€‘é€éç¶²é ç€è¦½å™¨çš„ devtool console æ§åˆ¶å°ï¼Œå°±å¯ä»¥é€éè©²æ¸¬è©¦å·¥å…·åšç°¡æ˜“çš„æ¸¬è©¦æ¡ˆä¾‹äº†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>expect</span> <span class=o>=</span> <span class=p>(</span><span class=nx>input</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>toBe</span> <span class=o>=</span> <span class=p>(</span><span class=nx>expected</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>input</span> <span class=o>===</span> <span class=nx>expected</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>toBe</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=mi>1</span> <span class=o>===</span> <span class=mi>1</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=mi>2</span> <span class=o>!==</span> <span class=mi>1</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½†æˆ‘å€‘å¸Œæœ›ä»–èƒ½å¤ åœ¨æ¸¬è©¦æ¡ˆä¾‹å¤±æ•—çš„æ™‚å€™å›æ‡‰ä¸€ä¸‹ç•¶ä¸‹é æœŸèˆ‡çµæœçš„ç‹€æ³ï¼Œå¾ŒçºŒæˆ‘å€‘æ‰èƒ½é‡å°ç´€éŒ„çš„çµæœåšä¿®æ­£ã€‚å› æ­¤æˆ‘å€‘å†ä¿®æ”¹ä¸€ä¸‹æ¸¬è©¦æ–¹æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>expect</span> <span class=o>=</span> <span class=p>(</span><span class=nx>input</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>handleOnError</span> <span class=o>=</span> <span class=p>(</span><span class=nx>result</span><span class=p>,</span> <span class=nx>expected</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=sb>`æ¸¬è©¦å¤±æ•—ï¼šé æœŸæ‡‰è©²ç‚º </span><span class=si>${</span><span class=nx>expected</span><span class=si>}</span><span class=sb>ï¼Œçµæœç¾åœ¨ç‚º </span><span class=si>${</span><span class=nx>result</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>toBe</span> <span class=o>=</span> <span class=p>(</span><span class=nx>expected</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>input</span> <span class=o>===</span> <span class=nx>expected</span> <span class=o>?</span> <span class=kc>true</span> <span class=o>:</span> <span class=nx>handleOnError</span><span class=p>(</span><span class=nx>input</span><span class=p>,</span> <span class=nx>expected</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>toBe</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å†åŸ·è¡Œä¸€å€‹æ•…æ„å¯«éŒ¯çš„æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=mi>2</span> <span class=o>===</span> <span class=mi>1</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://live.staticflickr.com/65535/52593679828_d73a14781b_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>ç¾åœ¨å¯ä»¥çœ‹åˆ°ç•¶æ¸¬è©¦æ¡ˆä¾‹ç™¼ç”ŸéŒ¯èª¤çš„æ™‚å€™ï¼Œé™¤äº†æœƒå›å‚³æ¸¬è©¦çµæœä¹‹å¤–ï¼Œé‚„æœƒå¤šå€‹éŒ¯èª¤æé†’ç›®å‰éŒ¯èª¤çš„åŸå› äº†ï¼</p><h3 id=å¯«æ¸¬è©¦æ¡ˆä¾‹>å¯«æ¸¬è©¦æ¡ˆä¾‹</h3><p>åœ¨å®Œæˆæ¸¬è©¦å·¥å…·å¾Œï¼Œç¾åœ¨æˆ‘å€‘è¦ä¾†å¯«æ¸¬è©¦æ¡ˆä¾‹ï¼Œé¦–å…ˆæˆ‘å€‘å…ˆå¯«ä¸€å€‹é‚„æ²’æœ‰å¯«å¯¦ä½œéƒ¨åˆ†çš„åˆ¤æ–·å‡½å¼(<code>isNumeric</code>)ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>isNumeric</span> <span class=o>=</span> <span class=p>(</span><span class=nx>val</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥è‘—æŒ‰ç…§é¡Œç›®æ‰€è¨­å®šçš„æ¢ä»¶ï¼Œä¾†æ’°å¯«æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><blockquote><p>é¡Œç›®è¨­å®šï¼š<br>ç•¶ <code>1</code> å’Œ <code>'100'</code> æ™‚ï¼Œè©²åˆ¤æ–·æ‡‰è©²è¦ç‚º <code>true</code>ï¼Œ<br>è€Œ <code>null</code> èˆ‡ <code>NaN</code> å‰‡æ˜¯è¦ç‚º <code>false</code>ã€‚</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>isNumeric</span> <span class=o>=</span> <span class=p>(</span><span class=nx>val</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=mi>1</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=s1>&#39;100&#39;</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=kc>null</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=kc>NaN</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>æ­¤æ™‚åŸ·è¡Œå¾Œæœƒç™¼ç¾æœƒç™¼ç¾å››å€‹æ¡ˆä¾‹éƒ½å ±éŒ¯ï¼Œå› ç‚ºç›®å‰æˆ‘å€‘é‚„æ²’æ’°å¯« <code>isNumeric</code> çš„åˆ¤æ–·å¯¦ä½œï¼Œä½†åˆ°é€™ä¸€æ­¥æ¸¬è©¦æ¡ˆä¾‹å°±å·²ç¶“ç®—æ˜¯å¯«å¥½äº†ï¼Œå› ç‚ºæˆ‘å€‘çš„ç›®çš„æ˜¯è¦å¯«å°çš„æ¸¬è©¦æ¡ˆä¾‹ï¼Œè®“å¯¦ä½œå»ç¬¦åˆã€‚</p><h3 id=å¯«å—æ¸¬ç¨‹å¼ç¢¼çš„å¯¦ä½œ>å¯«å—æ¸¬ç¨‹å¼ç¢¼çš„å¯¦ä½œ</h3><p>å®Œæˆæ¸¬è©¦æ¡ˆä¾‹å¾Œï¼Œæˆ‘å€‘å°‡è¦ä¾†å¯«æ¸¬è©¦ç¨‹å¼ç¢¼çš„å¯¦ä½œéƒ¨åˆ†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>isNumeric</span> <span class=o>=</span> <span class=p>(</span><span class=nx>value</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=o>!</span><span class=nb>isNaN</span><span class=p>(</span><span class=nx>value</span> <span class=o>-</span> <span class=nb>parseFloat</span><span class=p>(</span><span class=nx>value</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ€å¾Œï¼Œå°‡æ•´å€‹æ¸¬è©¦èˆ‡å¯¦ä½œåˆä½µèµ·ä¾†å°±æœƒåƒé€™æ¨£å­ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// æ¸¬è©¦å·¥å…·ç¨‹å¼ç¢¼éƒ¨åˆ†
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>expect</span> <span class=o>=</span> <span class=p>(</span><span class=nx>input</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>handleOnError</span> <span class=o>=</span> <span class=p>(</span><span class=nx>result</span><span class=p>,</span> <span class=nx>expected</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=sb>`æ¸¬è©¦å¤±æ•—ï¼šé æœŸæ‡‰è©²ç‚º </span><span class=si>${</span><span class=nx>expected</span><span class=si>}</span><span class=sb>ï¼Œçµæœç¾åœ¨ç‚º </span><span class=si>${</span><span class=nx>result</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>toBe</span> <span class=o>=</span> <span class=p>(</span><span class=nx>expected</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>input</span> <span class=o>===</span> <span class=nx>expected</span> <span class=o>?</span> <span class=kc>true</span> <span class=o>:</span> <span class=nx>handleOnError</span><span class=p>(</span><span class=nx>input</span><span class=p>,</span> <span class=nx>expected</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>toBe</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// å¯¦ä½œç¨‹å¼ç¢¼éƒ¨åˆ†
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>isNumeric</span> <span class=o>=</span> <span class=p>(</span><span class=nx>value</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=o>!</span><span class=nb>isNaN</span><span class=p>(</span><span class=nx>value</span> <span class=o>-</span> <span class=nb>parseFloat</span><span class=p>(</span><span class=nx>value</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æ¸¬è©¦æ¡ˆä¾‹éƒ¨åˆ†
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=mi>1</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=c1>// trueï¼Œå³ç‚ºé€šéæ¸¬è©¦
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=s1>&#39;100&#39;</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span> <span class=c1>// trueï¼Œå³ç‚ºé€šéæ¸¬è©¦
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=kc>null</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span> <span class=c1>// trueï¼Œå³ç‚ºé€šéæ¸¬è©¦
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=kc>NaN</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span> <span class=c1>// trueï¼Œå³ç‚ºé€šéæ¸¬è©¦
</span></span></span></code></pre></td></tr></table></div></div><p>å®Œæˆï¼ç¾åœ¨å·²ç¶“ä¸æœƒé¡¯ç¤ºæ¸¬è©¦å¤±æ•—çš„è¨Šæ¯äº†ï¼Œä¹Ÿå°±è¡¨ç¤º <code>isNumeric</code> æ–¹æ³•ç¬¦åˆæˆ‘å€‘çš„é æœŸå›‰ã€‚</p><p>è€Œç¾åœ¨å‡ä½¿æˆ‘æƒ³ä½¿å¯¦ä½œç¨‹å¼ç¢¼çš„éƒ¨åˆ†æ›´åŠ çš„å®Œå–„ï¼Œåªè¦å¢åŠ åˆé©çš„æ¸¬è©¦æ¡ˆä¾‹é€²å»å°±å¯ä»¥å¢æ·»å—æ¸¬ç‰©æœ¬èº«çš„ä¿¡è³´èˆ‡ç©©å®šåº¦ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=mi>1</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=mf>1.123</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=mh>0xFFF</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=s1>&#39;100&#39;</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=kc>undefined</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=kc>null</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>isNumeric</span><span class=p>(</span><span class=kc>NaN</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ç”šè‡³å°‡ä¾†æ”¹å¯«å¯¦ä½œ(<code>isNumeric</code>)çš„æ™‚å€™ï¼Œæ—¢æœ‰çš„æ¸¬è©¦å…§å®¹å°±æœƒæé†’ä½ æ˜¯å¦é•åäº†ä¹‹å‰æ‰€å¯«çš„æ¸¬è©¦æ¡ˆä¾‹ã€‚</p><hr><h2 id=æ¸¬è©¦å·¥å…·çš„é¸æ“‡>æ¸¬è©¦å·¥å…·çš„é¸æ“‡</h2><p>ä¸Šé¢æœ‰æåˆ°ç°¡æ˜“çš„æ¸¬è©¦å·¥å…·æ˜¯å¦‚ä½•æ‰‹åˆ»å‡ºä¾†çš„ï¼Œä¹Ÿç¨å¾®è«‡åˆ°äº†æ‰‹åˆ»æ¸¬è©¦å·¥å…·çš„å›°é›£ï¼Œå› æ­¤é¸æ“‡ä¸€å€‹é©ç•¶çš„æ¸¬è©¦å·¥å…·ä¾†è¼”åŠ©æˆ‘å€‘é€²è¡Œæ¸¬è©¦æ˜¯æœ‰å¿…è¦æ€§çš„ã€‚</p><p>ä½†æ¸¬è©¦å·¥å…·ç™¾ç™¾ç¨®ï¼Œè¨±å¤šå·¥å…·åœ¨æä¾›çš„åŠŸèƒ½ä¸Šåˆé‡ç–Šï¼Œé‚£éº¼æˆ‘å€‘è©²å¦‚ä½•é¸æ“‡å·¥å…·å‘¢ï¼Ÿ</p><p>è‹¥æ˜¯ä»¥ã€Œ<strong>å–®å…ƒæ¸¬è©¦</strong>ã€ä¾†èªªçš„è©±ï¼Œæˆ‘å€‘åœ¨æ’°å¯«æ¸¬è©¦ç¨‹å¼ç¢¼æ™‚å¯èƒ½è‡³å°‘å°±æœƒæœ‰ä»¥ä¸‹çš„éœ€æ±‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=cm>/* å¼•å…¥ç›¸é—œæª”æ¡ˆ */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒæè¿°&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹æè¿°&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;Hello, World&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;å¦ä¸€å€‹æ¸¬è©¦æ¡ˆä¾‹æè¿°&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>content</span><span class=o>:</span> <span class=s1>&#39;Unit-test!&#39;</span>   
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;Unit-test!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>æ¸¬è©¦ç’°å¢ƒ(test runner)ï¼šæä¾›ä¸Šæ–¹æ¸¬è©¦ç¨‹å¼ç¢¼åŸ·è¡Œçš„ç’°å¢ƒã€‚</li><li>æ¸¬è©¦æƒ…å¢ƒ(test suite)ï¼šå¦‚ä¸Šæ–¹çš„ <code>describe</code>ï¼Œç”¨ä¾†åŒ…è£¹å¤šå€‹æ¸¬è©¦æ¡ˆä¾‹ï¼Œä»¥åŠæè¿°æ¸¬è©¦æƒ…å¢ƒâ‹¯â‹¯ç­‰åŠŸèƒ½ã€‚</li><li>æ¸¬è©¦æ¡ˆä¾‹(test case)ï¼šå¦‚ä¸Šæ–¹çš„ <code>it</code>ï¼Œç”¨ä¾†åŒ…è£¹è©²æ¸¬è©¦æ¡ˆä¾‹çš„å¯¦éš›æƒ…æ³ï¼Œè‹¥æœ‰éŒ¯èª¤æ™‚éœ€è®“æˆ‘å€‘èƒ½å¤ è¼•æ˜“æ‰¾åˆ°æ˜¯å“ªå€‹æ¡ˆä¾‹ç™¼ç”Ÿçš„â‹¯â‹¯ç­‰ç­‰åŠŸèƒ½ã€‚</li><li>æ–·è¨€(Assertion)ï¼šå¦‚ä¸Šæ–¹çš„ expectï¼Œä¸»è¦æ˜¯ç”¨ä¾†åˆ¤æ–·å—æ¸¬ç‰©èˆ‡é æœŸçµæœæ˜¯å¦ä¸€è‡´çš„æ–¹æ³•ï¼Œç”šè‡³ä¾æ“šä¸åŒåˆ¤æ–·æ–¹å¼å…§éƒ¨ä¹Ÿæä¾›äº†å¤šç¨®åˆ¤æ–·æ–¹å¼ï¼Œå¦‚ .toBe å¯ç”¨ä¾†åˆ¤æ–·é¸å–çš„ç›®æ¨™èˆ‡é æœŸçµæœæ˜¯å¦ç›¸ç­‰ã€‚</li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨å¿…è¦çš„æƒ…æ³ä¸‹ç”šè‡³æœƒéœ€è¦ï¼š</p><ul><li>æ¸¬è©¦æ›¿èº«(test double)ï¼šç”¨ä¾†æ¨¡ä»¿ä¾è³´å·¥å…·æˆ–å‡½å¼åŸå…ˆçš„åŠŸèƒ½ç‹€æ³</li><li>è§£ææˆ–æ¨¡æ“¬å…ƒä»¶å®¹å™¨</li><li>æ¨¡æ“¬ç€è¦½å™¨ä¸­ DOM çš„ç’°å¢ƒ</li></ul><p>è€Œæ ¹æ“šä¸Šè¿°éœ€æ±‚ï¼Œå°±èƒ½å¤ åˆ—å‡ºä¸€å€‹éœ€æ±‚è¡¨ï¼Œä¾†è©•ä¼°å„å€‹æ¸¬è©¦å·¥å…·æ˜¯å¦ç¬¦åˆæˆ‘å€‘æ¸¬è©¦éœ€è¦çš„éƒ¨åˆ†ï¼š</p><blockquote><p>æ¸¬è©¦å·¥å…·åˆ—è¡¨å¯åƒè€ƒå€‹æ¡†æ¶ä¸­çš„æ¸¬è©¦å»ºè­°æŒ‡å—ï¼Œæ¯”æ–¹ <a class=link href=https://cn.vuejs.org/guide/scaling-up/testing.html#component-testing target=_blank rel=noopener>Vue çš„æ¸¬è©¦å»ºè­°æŒ‡å—</a></p></blockquote><div class=table-wrapper><table><thead><tr><th>éœ€æ±‚</th><th>Vitest</th><th>Jest</th><th>Mocha</th><th>Chai.js</th><th>Sinon.js</th><th>Vue-test-utils</th><th>jsdom</th></tr></thead><tbody><tr><td>æ¸¬è©¦ç’°å¢ƒ(test runner)</td><td>âœ”(è¨»1)</td><td>âœ”</td><td>âœ”</td><td></td><td></td><td></td><td></td></tr><tr><td>æ¸¬è©¦æƒ…å¢ƒ(test suite)</td><td>âœ”</td><td>âœ”</td><td>âœ”</td><td></td><td></td><td></td><td></td></tr><tr><td>æ¸¬è©¦æ¡ˆä¾‹(test case)</td><td>âœ”</td><td>âœ”</td><td>âœ”</td><td></td><td></td><td></td><td></td></tr><tr><td>æ–·è¨€(Assertion)</td><td>âœ”</td><td>âœ”</td><td></td><td>âœ”</td><td></td><td></td><td></td></tr><tr><td>æ¸¬è©¦æ›¿èº«(test double)</td><td>âœ”</td><td>âœ”</td><td></td><td></td><td>âœ”</td><td></td><td></td></tr><tr><td>è§£ææˆ–æ¨¡æ“¬å…ƒä»¶å®¹å™¨</td><td></td><td></td><td></td><td></td><td></td><td>âœ”</td><td></td></tr><tr><td>æä¾›æ¨¡æ“¬ DOM ç’°å¢ƒ</td><td></td><td></td><td></td><td></td><td></td><td></td><td>âœ”</td></tr></tbody></table></div><blockquote><p>è¨»1ï¼šVitest æœ¬èº«åŸºæ–¼ Vite ç’°å¢ƒï¼Œå› æ­¤å°ˆæ¡ˆè‹¥éé€é Vite æ‰€æ§‹å»ºçš„è©±å°±ç„¡æ³•ä½¿ç”¨ã€‚</p></blockquote><p>ç¾åœ¨é€éé€™å€‹è¡¨æˆ‘å€‘å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹è¦‹ï¼Œå‡è¨­å°ˆæ¡ˆæ˜¯åŸºæ–¼ <code>Vite</code> æ‰€å»ºç«‹çš„é‚£éº¼æˆ‘å¯ä»¥é¸æ“‡ä¸‹åˆ—é€™å€‹çµ„åˆï¼š</p><ul><li><code>Vitest</code> + <code>Vue-test-utils</code> + <code>jsdom</code></li></ul><p>å¦‚æœå°ˆæ¡ˆæ˜¯åŸºæ–¼ <code>Vue-cli</code> æ‰€å»ºç«‹çš„ï¼Œé‚£éº¼å°±ç„¡æ³•ä½¿ç”¨äº† <code>Vitest</code> ä½œç‚ºæ¸¬è©¦é‹è¡Œçš„ç’°å¢ƒäº†ï¼Œæ­¤æ™‚æ ¹æ“šè¡¨ä¸­æˆ‘å€‘å°±å¯ä»¥æ›¿æ›ç‚ºï¼š</p><ul><li>æ–¹æ¡ˆä¸€ï¼š<code>Jest</code> + <code>Vue-test-utils</code> + <code>jsdom</code></li><li>æ–¹æ¡ˆäºŒï¼š<code>Mocha</code> + <code>Chai.js</code> + <code>Sinon.js</code> + <code>Vue-test-utils</code> + <code>jsdom</code></li></ul><p>è€Œåœ¨åšå·¥å…·æ›¿æ›æ™‚ï¼Œéœ€è¦æ³¨æ„åˆ°çš„æ˜¯ï¼Œä¸åŒçš„æ¸¬è©¦ç’°å¢ƒ(test runner)å¯èƒ½æœƒå°æ–¼å¼•å…¥(<code>import</code>)æª”æ¡ˆæ™‚ç™¼ç”Ÿè§£æä¸Šçš„å•é¡Œï¼Œæ¯”æ–¹è‹¥ç”¨åˆ° Vue ä¸­çš„ <code>SFC</code> é¡å‹æª”æ¡ˆä½œç‚ºé–‹ç™¼ï¼Œé‚£åœ¨ <code>Jest</code> åšç‚ºæ¸¬è©¦ç’°å¢ƒæ™‚æˆ‘å€‘å°±éœ€è¦å¦å¤–å®‰è£ <code>vue-jest</code> ä¾†åšè½‰æ› <code>SFC</code> ä¸Šçš„è™•ç†ã€‚</p><p>ç•¶ç„¶ï¼Œä¸Šè¿°çš„éœ€æ±‚è¡¨åªæ˜¯ä¸€å€‹ç°¡å–®çš„ç¯„ä¾‹ï¼Œè€Œéš¨è‘—æ’°å¯«æ¸¬è©¦çš„ç¶“é©—è¶Šå¤šï¼Œå¾ŒçºŒæ…¢æ…¢å°±æœƒç­è§£åˆ°å°ˆæ¡ˆä¸­æœƒéœ€è¦å“ªäº›æ¸¬è©¦å·¥å…·ä¾†å”åŠ©æˆ‘å€‘é€²è¡Œæ¸¬è©¦ï¼Œç”šè‡³æ¯”è¼ƒå„ç¨®æ¸¬è©¦å·¥å…·çš„å„ªç¼ºé»å¾è€Œé¸å‡ºæœ€é©åˆåœ˜éšŠçš„æ¸¬è©¦å·¥å…·ï¼</p><p>ç¾åœ¨æˆ‘å€‘å·²ç¶“äº†è§£è¦å¦‚ä½•æŒ‘é¸æ¸¬è©¦å·¥å…·äº†ï¼Œæ¥ä¸‹ä¾†è¦é–‹å§‹èŠèŠæ’°å¯«æ¸¬è©¦æ¡ˆä¾‹æ™‚æ‡‰è©²è¦å¦‚ä½•æ€è€ƒï¼</p><hr><h2 id=æ±ºå®šæ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹>æ±ºå®šæ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹</h2><p>å†ä¾†è«‡è«‡åœ¨é¸æ“‡é€™äº›å·¥å…·å¾Œï¼Œæˆ‘å€‘è¦å¦‚ä½•ä¾†æ€è€ƒé‡å°ã€Œå–®å…ƒæ¸¬è©¦ã€çš„éƒ¨åˆ†ï¼Œæ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹è¦æ€éº¼æ’°å¯«ä»¥åŠéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚</p><h3 id=æ¸¬è©¦æƒ…å¢ƒtest-suiteæ¸¬è©¦æ¡ˆä¾‹test-case>æ¸¬è©¦æƒ…å¢ƒ(test suite)æ¸¬è©¦æ¡ˆä¾‹(test case)</h3><p>æä¾›æ¸¬è©¦ç’°å¢ƒçš„å·¥å…·ä¸€èˆ¬æœƒçµ¦äºˆæ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹çš„ç›¸é—œ APIï¼Œè€Œæ¸¬è©¦æƒ…å¢ƒèˆ‡æ¡ˆä¾‹æœ€ä¸»è¦çš„ç”¨æ„æ˜¯ç”¨ä¾†å¹«åŠ©æˆ‘å€‘è¦åŠƒèˆ‡æ•´ç†æ•´å€‹æ¸¬è©¦é‚è¼¯ï¼Œä¸¦ä¸”åœ¨æˆ‘å€‘æ¸¬è©¦æ¡ˆä¾‹éŒ¯èª¤çš„æ™‚å€™åŒæ™‚æä¾›ç›¸å°æ‡‰çš„è³‡è¨Šã€‚</p><p>æ¥ä¸‹ä¾†æˆ‘å€‘ä»¥ã€Œ<strong>è²“å’ªä½œç‚ºå…ƒä»¶</strong>ã€ç‚ºæ•…äº‹ä¸»è»¸ä¾†è«‡è«‡å–®å…ƒæ¸¬è©¦çš„æ€è·¯æœƒæ˜¯æ€éº¼æ’°å¯«ã€‚</p><p>é¦–å…ˆæˆ‘å€‘å‡è¨­ã€Œ<strong>è²“å’ª</strong>ã€å…ƒä»¶æœƒæä¾›ä¸‹åˆ—åŠŸèƒ½ï¼š</p><ul><li>ç™¼å‡ºå‘¼åš•åš•å«è²</li><li>æ¨å€’çœ¼å‰çœ‹åˆ°çš„æ‰€æœ‰æ±è¥¿</li></ul><p>è€Œä»¥ä½¿ç”¨è€…è§’åº¦ä¸Šä¾†çœ‹ï¼Œæˆ‘å€‘æœƒå°ã€Œ<strong>è²“å’ª</strong>ã€åšå‡ºé€™äº›äº‹æƒ…ï¼š</p><ul><li>æ‘¸æ‘¸</li><li>é¤µé£Ÿ</li><li>æ‹¿ç©å…·é€—</li></ul><p>æ¥è‘—æˆ‘å€‘å°±å¯ä»¥ä»¥å…ƒä»¶ä½œç‚ºæƒ…å¢ƒä¾†å®šç¾©å‡ºå„ç¨®ä½¿ç”¨ä¸Šçš„æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;è²“å’ª&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;é¤µé£Ÿï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‹¿ç©å…·é€—ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;ä»€éº¼éƒ½ä¸åšï¼Œæ‡‰è©²æ¨å€’çœ¼å‰çœ‹åˆ°çš„æ‰€æœ‰æ±è¥¿&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½†çœŸå¯¦çš„æ¸¬è©¦æ¡ˆä¾‹ä¸æœƒé€™éº¼ç°¡å–®ï¼Œç¸½æœƒæœ‰ä¸€äº›ä¾‹å¤–ç‹€æ³ï¼Œé‚£éº¼æ¸¬è©¦æ¡ˆä¾‹æ‡‰è©²è¦åŒ…å«å“ªäº›è¦ç´ æ¯”è¼ƒå¥½ï¼Ÿ</p><h3 id=æ¡ˆä¾‹è·¯å¾‘happy-pathsad-pathbad-path>æ¡ˆä¾‹è·¯å¾‘(happy pathã€sad pathã€bad path)</h3><p>åœ¨è¨­å®šæ¸¬è©¦æ¡ˆä¾‹æ™‚ï¼Œç¸½æœƒæœ‰ç™¾ç™¾ç¨®æƒ…æ³ï¼Œä½†æ˜¯æˆ‘å€‘ä¸å¯èƒ½æ¯å€‹éƒ½å¯«å‡ºä¾†ï¼Œè€Œæ ¹æ“šæ¸¬è©¦æ¡ˆä¾‹çš„é¡å‹ä¸»è¦å¯ä»¥åˆ†ç‚ºä¸‰ç¨®è·¯å¾‘ï¼š</p><ul><li>Happy Pathï¼šåœ¨æˆ‘å€‘å®šç¾©æ‰€è¬‚ã€Œ<strong>æ­£å¸¸çš„ä½¿ç”¨ç‹€æ³</strong>ã€ä¸‹ï¼Œé‡å°ã€Œ<strong>æ­£ç¢ºçš„å…§å®¹</strong>ã€ï¼Œæˆ‘å€‘é æœŸæ‡‰è©²è¦åšå‡ºçš„åæ‡‰ã€‚</li><li>Sad Pathï¼šåœ¨æˆ‘å€‘å®šç¾©æ‰€è¬‚ã€Œ<strong>æ­£å¸¸çš„ä½¿ç”¨ç‹€æ³</strong>ã€ä¸‹ï¼Œé‡å°ã€Œ<strong>éŒ¯èª¤çš„å…§å®¹</strong>ã€ï¼Œæˆ‘å€‘é æœŸæ‡‰è©²è¦åšå‡ºçš„åæ‡‰ã€‚</li><li>Bad Pathï¼šåœ¨æˆ‘å€‘å®šç¾©æ‰€è¬‚ã€Œ<strong>éŒ¯èª¤</strong>ã€çš„ä½¿ç”¨ç‹€æ³ä¸‹ï¼Œæˆ‘å€‘é æœŸæ‡‰è©²è¦åšå‡ºçš„åæ‡‰ã€‚</li></ul><p>åŒæ¨£ä»¥è²“è¢«æ‘¸æ‘¸ä½œç‚ºä¾‹å­ä¾†çœ‹ï¼Œå‡è¨­å°æ–¼è²“ä¾†èªªèƒ½å¤ æ¥å—æ‘¸æ‘¸çš„æƒ…æ³åªé™æ–¼ã€Œ<strong>é ­èˆ‡ä¸‹å·´</strong>ã€ï¼Œè€Œå–œæ­¡è¢«æ‘¸çš„éƒ¨åˆ†åªæœ‰ã€Œ<strong>ä¸‹å·´</strong>ã€ï¼Œé‚£éº¼æ¸¬è©¦æ¡ˆä¾‹è·¯å¾‘å°±å¯ä»¥é€™éº¼å®šç¾©ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;è²“å’ª&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Happy Path
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸ä¸‹å·´ï¼Œæ‡‰è©²æœƒç™¼å‡ºã€Œå‘¼åš•åš•ã€è²&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Sad Path
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸é ­ï¼Œæ‡‰è©²æ²’åæ‡‰&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Bad Path
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸è‚šå­ï¼Œæ‡‰è©²æ‹‹å‡ºéŒ¯èª¤&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=è·¯å¾‘å„ªå…ˆåº¦>è·¯å¾‘å„ªå…ˆåº¦</h3><p>è€Œä»¥å„å€‹è·¯å¾‘å„ªå…ˆåº¦ä¾†èªªï¼Œæˆ‘å€‘æ‡‰ç•¶ç›¡å¯èƒ½çš„å…ˆå®Œå–„ Happy Path èˆ‡ Sad Path çš„å„ç¨®æ¡ˆä¾‹ï¼Œå› ç‚ºå°æ–¼å¯¦éš›å°ˆæ¡ˆä¸Šä¾†èªªï¼Œé€™äº›å…§å®¹æ˜¯æˆ‘å€‘é æœŸå…ƒä»¶æˆ–å‡½å¼æœ¬èº«æ‡‰æä¾›çš„å…§å®¹ã€‚</p><p>ç„¶è€Œ Bad Path é€šå¸¸æ˜¯å»ºç«‹å·²çŸ¥å“ªäº›æƒ…æ³æœƒæ˜¯ã€Œä¸æ­£ç¢ºçš„ä½¿ç”¨ã€ï¼Œæˆ‘å€‘åªèƒ½å°±å·²çŸ¥çš„ç‹€æ³ä¾†é é˜²ã€‚ç„¶è€Œï¼Œé€™ä¸€éƒ¨åˆ†å…¶å¯¦å†æ€éº¼ç¸å¯†ï¼Œéƒ½é‚„æ˜¯æœƒæœ‰æ¥µå…¶ä¾‹å¤–çš„äº‹æƒ…ç™¼ç”Ÿï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;è²“å’ª&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// Bad Path
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸è‚šå­ï¼Œæ‡‰è©²æ‹‹å‡ºéŒ¯èª¤&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸å°¾å·´ï¼Œæ‡‰è©²æ‹‹å‡ºéŒ¯èª¤&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸æ‰‹ï¼Œæ‡‰è©²æ‹‹å‡ºéŒ¯èª¤&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ‘¸æ‘¸è…³ï¼Œæ‡‰è©²æ‹‹å‡ºéŒ¯èª¤&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=c1>// èˆ‰ä¸å®Œ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å› æ­¤é€éæ¸¬è©¦ä¾†ä½œé˜²ç¦¦æ‰€æœ‰ä¸åˆç†çš„è¡Œç‚ºæ˜¯ä¸æ²»æœ¬çš„è¡Œç‚ºï¼Œæˆ‘æ‡‰è©²å¾å—æ¸¬ç‰©æœ¬èº«æä¾›çš„æ“ä½œæˆ–æ˜¯ç”¢å“è¦åŠƒä¸Šä¾†å»è€ƒé‡ç›¸å°æ²»æœ¬çš„æ–¹å¼ï¼›æ¯”æ–¹åœ¨ã€Œ<strong>è²“å’ª</strong>ã€å…ƒä»¶ä¸Šé€éç¨‹å¼è¨­è¨ˆçš„éƒ¨åˆ†ï¼Œè¦åŠƒã€Œ<strong>æ‘¸æ‘¸</strong>ã€è¡Œç‚ºåªé–‹æ”¾ã€Œ**é ­ã€**èˆ‡ã€Œ<strong>ä¸‹å·´</strong>ã€çš„éƒ¨ä½ï¼Œå¾é–‹ç™¼éšæ®µå°±é˜»æ­¢å…¶ä»–é–‹ç™¼è€…èª¤ç”¨ã€Œ<strong>æ‘¸æ‘¸</strong>ã€æ–¹æ³•ï¼Œåˆ°æœ€å¾ŒçœŸçš„æœ‰å…¶å¿…è¦ç‰¹åˆ¥æ‹‹å‡ºæ™‚æ‰é‡å°é€™ä¸€éƒ¨åˆ†å¯« Bad Path æ¡ˆä¾‹ã€‚</p><p>æœ€å¾Œï¼Œå†ç”¨ä¸€å€‹å¯¦éš›ä¸€é»çš„ä¾‹å­èªªæ˜ï¼Œå‡è¨­ä»Šå¤©æœ‰å€‹ç™»å…¥çš„è¡¨å–®å…ƒä»¶ï¼Œé‚£éº¼æœ€ç°¡å–®é æœŸæœƒæœ‰çš„æ¡ˆä¾‹å°±æœƒæ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;ç™»å…¥å…ƒä»¶&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Happy Path
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;è¼¸å…¥æ­£ç¢ºå¸³è™Ÿå¯†ç¢¼ï¼Œæ‡‰ç™»å…¥åˆ°ï¼¯ï¼¯é é¢&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Sad Path
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;åªè¼¸å…¥å¸³è™Ÿï¼Œæ‡‰è©²é¡¯ç¤ºè«‹è¼¸å…¥å¯†ç¢¼&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;åªè¼¸å…¥å¯†ç¢¼ï¼Œæ‡‰è©²é¡¯ç¤ºè«‹è¼¸å…¥å¸³è™Ÿ&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;è¼¸å…¥éŒ¯èª¤å¸³è™Ÿå¯†ç¢¼ï¼Œæ‡‰è©²é¡¯ç¤ºç™»å…¥è³‡è¨ŠéŒ¯èª¤&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ä»¥ä¸Šå°±æ˜¯æ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹æœ€åŸºæœ¬éœ€è¦ç­è§£çš„éƒ¨åˆ†ï¼Œæ¥è‘—æˆ‘å€‘ä¾†é—œæ³¨æ–¼æ¸¬è©¦æ¡ˆä¾‹ä¸­å…§éƒ¨æ‡‰è©²è¦å¦‚ä½•ä¾†æ’°å¯«ã€‚</p><hr><h2 id=æ’°å¯«æ¸¬è©¦ç¨‹å¼ç¢¼çš„å‰è¨€>æ’°å¯«æ¸¬è©¦ç¨‹å¼ç¢¼çš„å‰è¨€</h2><h3 id=æ’°å¯«æ¸¬è©¦ç¨‹å¼ç¢¼éœ€ä¿æŒçš„å¿ƒå¢ƒ>æ’°å¯«æ¸¬è©¦ç¨‹å¼ç¢¼éœ€ä¿æŒçš„å¿ƒå¢ƒ</h3><p>è«‡åˆ°æ’°å¯«æ¸¬è©¦ï¼Œä¸å¾—ä¸æåˆ° Robert Cecil Martin æœ‰æœ¬ç¶“å…¸çš„ã€Šç„¡ç‘•çš„ç¨‹å¼ç¢¼ï¼šæ•æ·è»Ÿé«”é–‹ç™¼æŠ€å·§å®ˆå‰‡ã€‹ï¼Œä½œè€…åœ¨å…¶ä¸­é‡å°äº†ç¨‹å¼ç¢¼çš„éƒ¨åˆ†æäº†å¾ˆå¤šå„ªè‰¯çš„å»ºè­°ï¼Œä¸è«–æ˜¯æ’°å¯«ç¨‹å¼ç¢¼ä¸­çš„å‘½åã€å‡½å¼åƒæ•¸ç­‰ç­‰åšæ¢è¨ï¼Œä¹Ÿåœ¨å¯¦éš›çš„æ¡ˆä¾‹ä¸­åšä¸€äº›è¨è«–èˆ‡é‡æ§‹ï¼Œæœ€å¾Œå›é¡§é‚£äº›ç¨‹å¼ç¢¼ä¸­çš„æ°£å‘³ã€æ¸…ç†ç¨‹å¼ç¢¼ï¼Œä¸€æ°£å‘µæˆã€‚</p><p>è€Œå…¶ä¸­æœ‰ä¸€å€‹ç« ç¯€æœ€ä¸»è¦å°±æ˜¯åœ¨è¬›æœ‰é—œã€Œå–®å…ƒæ¸¬è©¦ã€çš„éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯ç³»åˆ—æ–‡å‰è¨€æåˆ°ã€Œè¢«æ¨å‘ã€çš„éƒ¨åˆ†ï¼Œæˆ‘æŠŠè£¡é¢çš„æ¦‚å¿µçµåˆæˆ‘çš„ç¶“é©—ä¾†é‡æ–°é—¡è¿°ä¸€æ¬¡ï¼š</p><p>è‹¥å¸¶è‘—å–®ç´”å­¸ç¿’çš„å¿ƒæ…‹ä¾†çœ‹å¾…æ¸¬è©¦ç¨‹å¼ç¢¼ï¼Œå…¶å¯¦å¾ˆå®¹æ˜“æŠŠå®ƒç•¶ä½œä¸€é …è¼”åŠ©å·¥å…·åœ¨è™•ç†ï¼Œè¦ºå¾—æ²’æœ‰ä¹Ÿæ²’ä»€éº¼é—œä¿‚ï¼Œç”šè‡³ç¤™æ‰‹ç¤™è…³çš„ï¼Œç”šè‡³å¯èƒ½è¦ºå¾—é‚„è¦ç‰¹åœ°èŠ±äº†ä¸å°‘å¿ƒåŠ›ä¾†ç­è§£å®ƒï¼Œä½†é€™æ˜¯ä¸€é«”å…©é¢çš„ã€‚</p><p>è‹¥ä½ æŠŠå®ƒç•¶ä½œç”¢å“ä¸­çš„ä¸€éƒ¨åˆ†å°±æœƒç™¼ç¾ï¼Œé›–ç„¶é–‹ç™¼æ™‚æœƒå—åˆ°æ¸¬è©¦ç¨‹å¼ç¢¼çš„ã€Œé™åˆ¶ã€ï¼Œä½†åŒæ™‚ä»–å…¶å¯¦ä¹Ÿæ˜¯åœ¨åšã€Œå®ˆè­·ã€ç”¢å“ç¨‹å¼ç¢¼é€™ä»¶äº‹æƒ…ï¼›ç”šè‡³å› ç‚ºæœ‰äº†ã€Œå¯ä¿¡è³´çš„æ¸¬è©¦ã€ï¼Œæ‰€ä»¥ç•¶æˆ‘å€‘åœ¨é€²è¡Œã€Œé‡æ§‹ã€ç­‰ç­‰èª¿æ•´æ™‚ä¹Ÿæ‰èƒ½æ›´æœ‰ä¿¡å¿ƒåœ°å»è™•ç†ã€‚</p><p>å› æ­¤åªè¦ç¢ºä¿æˆ‘å€‘åœ¨é©ç•¶çš„æ™‚æ©ŸåŠ å…¥å®ƒï¼Œé‚£éº¼å®ƒå°±èƒ½å¤ å¸¶ä¾†å¯è§€çš„å¾ŒçºŒæ•ˆç›Šï¼Œè€Œæ—¢ç„¶ä»–èƒ½å¤ æ›¿æˆ‘å€‘å¸¶ä¾†æ•ˆç›Šï¼Œé‚£æˆ‘å€‘å°å¾…æ¸¬è©¦ç¨‹å¼ç¢¼çš„æ…‹åº¦å…¶å¯¦ä¹Ÿæ‡‰è©²è¦åŒç†ç”¢å“ç¨‹å¼ç¢¼ï¼Œå¯æ˜¯é™¤äº†è®“æ¸¬è©¦ç¨‹å¼ç¢¼å¦‚åŒç”¢å“ç¨‹å¼ç¢¼ä¸€æ¨£ä¿æŒã€Œæ•´æ½”ã€èˆ‡ã€Œå¯è®€æ€§ã€ä¹‹å¤–ï¼Œæˆ‘å€‘é‚„æœ‰ä»€éº¼è¾¦æ³•å‘¢ï¼Ÿ</p><p>å°æ–¼é€™å€‹å•é¡Œ Martin çµ¦äº†ä¸€å€‹æ’°å¯«æ¸¬è©¦ç¢¼çš„å„ªè‰¯æº–å‰‡ï¼Œé‚£å°±æ˜¯ F.I.R.S.T æ³•å‰‡ã€‚</p><h3 id=first-æ³•å‰‡>F.I.R.S.T æ³•å‰‡</h3><p>F.I.R.S.T æ³•å‰‡é¡§åæ€ç¾©å…¶å¯¦å°±æ˜¯äº”å€‹è‹±æ–‡å–®å­—çš„ç¸®å¯«ï¼Œä»–å€‘åˆ†åˆ¥æ˜¯ï¼š</p><ul><li>Fast</li><li>Independent</li><li>Repeatable</li><li>Self-Validating</li><li>Timely</li></ul><h4 id=fastå¿«>Fast(å¿«)</h4><p>ç°¡å–®ä¾†èªªå°±æ˜¯å¿«ï¼Œå› ç‚ºå¿«æ‰èƒ½è®“æˆ‘å€‘å¿«é€Ÿé‡è¤‡å¤§é‡åœ°æª¢é©—ç”¢å“ç¨‹å¼ç¢¼ï¼›é€™æ„å‘³è‘—æˆ‘å€‘åœ¨æ¸¬è©¦ç¨‹å¼ç¢¼ä¸­æœ‰å¯èƒ½æœƒé‡åˆ°è¦ call API çš„æƒ…æ³ï¼Œé‚£éº¼æˆ‘å€‘å¯ä»¥å°‡å…¶éš”é›¢ä¸¦ç«‹åˆ»å›å‚³æˆ‘å€‘é å®šå¥½çš„è³‡æ–™ä¾†æ¸›å°‘ç­‰å¾…å›æ‡‰çš„æ™‚é–“ã€‚</p><h4 id=independentç¨ç«‹>Independent(ç¨ç«‹)</h4><p>å¦‚æˆ‘å€‘ä¸Šä¸€ç¯‡æ–‡ç« æ‰€æåˆ°çš„ï¼Œæ¯å€‹æ¸¬è©¦æ¡ˆä¾‹æ‡‰è©²è¦äº’ç›¸ç¨ç«‹ï¼Œå½¼æ­¤ä¸å—å¹²æ“¾ä¹‹å¤–ï¼Œç”šè‡³é€£åŸ·è¡Œé †åºä¸Šéƒ½ä¸æœƒå½±éŸ¿åˆ°æœ€çµ‚çµæœã€‚</p><h4 id=repeatableå¯é‡è¤‡>Repeatable(å¯é‡è¤‡)</h4><p>å¯é‡è¤‡æ€§ä¸»è¦æçš„å°±æ˜¯ä¸è«–åœ¨ä»€éº¼è¨­å‚™ç‹€æ³ä¸‹ï¼Œæ‡‰è©²éƒ½è¦ä¿æŒè‘—ä¸€è‡´çš„çµæœï¼Œé€™æ¨£æˆ‘å€‘æ‰èƒ½æ’é™¤æ‰å…¶ä»–ä¸å¿…è¦çš„åŸå› ï¼Œå°ˆæ³¨åœ¨ç™¼ç”Ÿå•é¡Œçš„ç¨‹å¼ç¢¼ä¸Šã€‚</p><h4 id=self-validatingèƒ½è‡ªæˆ‘é©—è­‰>Self-Validating(èƒ½è‡ªæˆ‘é©—è­‰)</h4><p>æ¸¬è©¦çš„æœ€çµ‚ç‹€æ…‹æ‡‰è©²è¦èƒ½å¤ é¡¯ç¤ºã€Œé€šéèˆ‡å¦ã€ï¼Œè€Œé€™ä¸€éƒ¨åˆ†æ¸¬è©¦å·¥å…·æˆ–æ¡†æ¶éƒ½æœƒå¹«æˆ‘å€‘è™•ç†å¥½ï¼Œç”šè‡³éƒ½é‚„æœ‰æä¾›é¡å¤–çš„ diff å·®ç•°è®“æˆ‘å€‘å¿«é€ŸæŸ¥çœ‹éŒ¯èª¤çš„åœ°æ–¹ã€‚</p><h4 id=timelyå³æ™‚>Timely(å³æ™‚)</h4><p>æ¸¬è©¦ç¨‹å¼ç¢¼è¦ç›¡å¯èƒ½çš„èˆ‡ç”¢å“ç¨‹å¼ç¢¼åŒé€²é€€ï¼Œå¦‚æœæ¸¬è©¦ç¨‹å¼ç¢¼è½å¾Œç”¢å“ç¨‹å¼ç¢¼å¤ªå¤šï¼Œæ¸¬è©¦ç¨‹å¼ç¢¼æœƒè¶Šä¾†è¶Šé›£è·Ÿä¸Šç”¢å“ç¨‹å¼ç¢¼çš„æ­¥èª¿ã€‚</p><p>è€Œæ ¹æ“šå°å¾…æ¸¬è©¦ç¨‹å¼ç¢¼å¿ƒæ…‹çš„å„ªè‰¯æ³•å‰‡ï¼Œåœ¨æ’°å¯«æ¸¬è©¦ç¨‹å¼ç¢¼æ™‚å°±èƒ½æ›´å®¹æ˜“é«”æœƒåˆ°ä»–çš„é­…åŠ›ã€‚</p><hr><h2 id=describe--it-èˆ‡-è¼”åŠ©-api>describe & it èˆ‡ è¼”åŠ© API</h2><h3 id=describe--it-åŸºç¤ç”¨æ³•>describe & it åŸºç¤ç”¨æ³•</h3><p>ç¨æ—©æœ‰æåˆ°çš„æ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹åœ¨ <code>Vitest</code> å·¥å…·ä¸­ä¸»è¦ä¾¿æ˜¯é€é <code>describe</code> èˆ‡ <code>it</code>(æˆ– <code>test</code>) ä¾†æ’°å¯«ï¼Œè€Œä»–å€‘çš„ç”¨æ„é™¤äº†è¦åŠƒæ¸¬è©¦çš„è„ˆçµ¡ä¹‹å¤–ï¼Œæœ€ä¸»è¦æ˜¯ç”¨ä¾†åŒ…è£æ–·è¨€çµæœçš„è³‡è¨Šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span><span class=nx>describe</span><span class=p>,</span> <span class=nx>it</span><span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vitest&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒçš„æè¿°&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;ç¬¬ä¸€å€‹æ¸¬è©¦æ¡ˆä¾‹çš„æè¿°&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>add</span> <span class=o>=</span> <span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>x</span> <span class=o>+</span> <span class=nx>y</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>(</span><span class=nx>add</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å‡è¨­åœ¨çµ‚ç«¯æ©ŸåŸ·è¡Œä¸Šæ–¹çš„æ¸¬è©¦ç¨‹å¼ç¢¼æ™‚ï¼Œä¾æ“šå·¥å…·é è¨­è¨­å®šæœƒåœ¨çµ‚ç«¯æ©Ÿé¡¯ç¤ºã€ŒéŒ¯èª¤çš„ç›¸é—œè³‡è¨Šã€èˆ‡ã€Œç¶œåˆçµæœã€ã€‚</p><p>éŒ¯èª¤çš„ç›¸é—œè³‡è¨Šï¼š</p><p><img src=https://live.staticflickr.com/65535/52593161161_6eaf044f61_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><ul><li>FAILï¼šç™¼ç”Ÿæ–·è¨€éŒ¯èª¤æª”æ¡ˆè·¯å¾‘ + æƒ…å¢ƒæè¿° + æ¡ˆä¾‹æè¿°(è¦–ç•¶ä¸‹éŒ¯èª¤æ‰€å±¬çš„æƒ…å¢ƒèˆ‡æ¡ˆä¾‹)ã€‚</li><li>AssertionErrorï¼šç™¼ç”Ÿæ–·è¨€éŒ¯èª¤çš„åŸå› ï¼Œèˆ‡ç™¼ç”ŸéŒ¯èª¤çš„æ®µè½ã€‚</li><li>Expectedï¼šé æœŸçµæœã€‚</li><li>Receivedï¼šå¯¦éš›çµæœã€‚</li></ul><p>ç¶œåˆçµæœï¼š</p><p><img src=https://live.staticflickr.com/65535/52593421709_7ab116b4c3_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><ul><li>Test Filesï¼šç¸½å…±æ¸¬è©¦äº†å¹¾éš»æ¸¬è©¦æª”æ¡ˆï¼Œä¸¦é¡¯ç¤ºæˆåŠŸã€å¤±æ•—èˆ‡è·³éçš„æ•¸é‡ã€‚</li><li>Testsï¼šç¸½å…±æ¸¬äº†å¹¾å€‹æ¸¬è©¦æ¡ˆä¾‹ï¼Œä¸¦é¡¯ç¤ºæˆåŠŸã€å¤±æ•—èˆ‡è·³éçš„æ•¸é‡ã€‚</li><li>Startï¼šæ¸¬è©¦é–‹å§‹æ™‚é–“ã€‚</li><li>Durationï¼šæ¸¬è©¦éç¨‹ç¸½å…±è€—è²»æ™‚é–“ã€‚</li></ul><p>è€Œé™¤äº†ä¸Šè¿°åŸºæœ¬ç”¨æ³•ä¹‹å¤–ï¼Œåœ¨åŒä¸€å€‹æ¸¬è©¦æƒ…å¢ƒä¸­ä¹Ÿèƒ½å®¹ç´æ•¸å€‹æ¸¬è©¦æ¡ˆä¾‹ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒçš„æè¿°&#39;</span> <span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;ç¬¬ä¸€å€‹æ¸¬è©¦æ¡ˆä¾‹çš„æè¿°&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;ç¬¬äºŒå€‹æ¸¬è©¦æ¡ˆä¾‹çš„æè¿°&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ç”šè‡³æ¸¬è©¦æƒ…å¢ƒè¼ƒç‚ºè¤‡é›œçš„æƒ…æ³ï¼Œæ¸¬è©¦æƒ…å¢ƒ(<code>describe</code>)ä¹Ÿå…è¨±å·¢ç‹€çš„æ–¹å¼ä¾†å»ºæ§‹æ¸¬è©¦ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;çˆ¶å±¤æƒ…å¢ƒ&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;åŸºæ–¼çˆ¶å±¤æƒ…å¢ƒçš„æƒ…å¢ƒä¸€&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;åŸºæ–¼çˆ¶å±¤æƒ…å¢ƒçš„æƒ…å¢ƒäºŒ&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;å‡ºç¾æç¤ºå¯„ä»¶è€…å§“åèˆ‡é›»è©±å°‡ç›´æ¥è¨»å†Šæˆæœƒå“¡&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ç›¸ååœ°ï¼Œè‹¥åœ¨ç°¡å–®çš„æƒ…å¢ƒçš„ä¹‹ä¸‹ï¼Œåªæœ‰æ¸¬è©¦æ¡ˆä¾‹ä¹Ÿæ˜¯å…è¨±çš„æ–¹å¼ä¹‹ä¸€ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=describe--it-è¼”åŠ©-api>describe & it è¼”åŠ© API</h3><p>é™¤äº†ä¸Šè¿°çš„åŸºæœ¬ç”¨æ³•ä¹‹å¤–ï¼Œé€é <code>describe</code> èˆ‡ <code>it</code> æ’°å¯«æ¸¬è©¦çš„éç¨‹ä¸­ä¹Ÿèƒ½é€é<code>è¼”åŠ©çš„ API</code> ä¾†æ•´ç†æ¸¬è©¦ç¨‹å¼ç¢¼ï¼š</p><ul><li><code>.only</code>ï¼šæ¸¬è©¦æƒ…å¢ƒã€æ¸¬è©¦æ¡ˆä¾‹çš†å¯ä½¿ç”¨</li><li><code>.skip</code>ï¼šæ¸¬è©¦æƒ…å¢ƒã€æ¸¬è©¦æ¡ˆä¾‹çš†å¯ä½¿ç”¨</li><li><code>.todo</code>ï¼šæ¸¬è©¦æƒ…å¢ƒã€æ¸¬è©¦æ¡ˆä¾‹çš†å¯ä½¿ç”¨</li><li><code>.fails</code>ï¼šæ¸¬è©¦æ¡ˆä¾‹æ‰èƒ½ä½¿ç”¨</li></ul><h4 id=only>only</h4><p>è‹¥åœ¨<strong>æ¸¬è©¦æƒ…å¢ƒ</strong>ç”¨äº†æ­¤æŒ‡ä»¤ï¼Œå‰‡åœ¨åŒå€‹æ¸¬è©¦æª”æ¡ˆä¸­åªæœƒåŸ·è¡Œå¸¶æœ‰ <code>.only</code> çš„æ¸¬è©¦æƒ…å¢ƒï¼Œè€Œå…¶é¤˜æ¸¬è©¦æƒ…å¢ƒåº•ä¸‹æ‰€æœ‰çš„æ¸¬è©¦æ¡ˆä¾‹å°‡æœƒè¢«è·³é(<code>skipped</code>)ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>.</span><span class=nx>only</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒ 1&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒ 2&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span> <span class=c1>// skipped
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒ 3&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span> <span class=c1>// skipped
</span></span></span></code></pre></td></tr></table></div></div><p>è‹¥åœ¨<strong>æ¸¬è©¦æ¡ˆä¾‹</strong>ä¸­ä½¿ç”¨ï¼Œå‰‡é™¤äº†å¸¶æœ‰ <code>.only</code> ä¹‹å¤–çš„æ¸¬è©¦æ¡ˆä¾‹éƒ½å°‡æœƒè¢«è·³éï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒ 1&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>.</span><span class=nx>only</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span> <span class=c1>// skipped
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒ 2&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>.</span><span class=nx>only</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span> <span class=c1>// skipped
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒ 3&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span> <span class=c1>// skipped
</span></span></span></code></pre></td></tr></table></div></div><h4 id=skip>skip</h4><p>æ¸¬è©¦æƒ…å¢ƒæˆ–æ¸¬è©¦æ¡ˆä¾‹è¢«æ¨™æ³¨æ™‚ï¼Œå°‡è‡ªå‹•è·³éè©²ç¯„ç–‡å…§çš„æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>.</span><span class=nx>skip</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒ 1&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span> <span class=c1>// skipped
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span> <span class=c1>// skipped
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æƒ…å¢ƒ 2&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>.</span><span class=nx>skip</span><span class=p>(</span><span class=s1>&#39;æ¸¬è©¦æ¡ˆä¾‹&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> <span class=cm>/* */</span> <span class=p>})</span> <span class=c1>// skipped
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=todo>todo</h4><p>æ¸¬è©¦æƒ…å¢ƒæˆ–æ¸¬è©¦æ¡ˆä¾‹è¢«æ¨™æ³¨æ™‚ï¼ŒåŒæ¨£å°‡è‡ªå‹•è·³éè©²ç¯„ç–‡å…§çš„æ¸¬è©¦æ¡ˆä¾‹ï¼Œä½† <code>todo</code> å«ç¾©æ¯”è¼ƒæ¥è¿‘å¾…åŠ å…¥æ¸¬è©¦çš„å€å¡Šï¼Œä¸¦ä¸”å°‡ä¾†è‹¥ç”¢å‡ºå ±å‘Šæ™‚ä¹Ÿæœƒç‰¹åˆ¥æ•´ç†å‡ºé‚„æœ‰å“ªäº›åœ°æ–¹éœ€è¦è£œä¸Šæ¸¬è©¦ã€‚</p><h4 id=fails>fails</h4><p>æœ€å¾Œä¸€å€‹ä»‹ç´¹çš„æ˜¯æ¸¬è©¦æ¡ˆä¾‹æ‰èƒ½ä½¿ç”¨çš„è¼”åŠ© APIï¼Œé‚„è¨˜å¾—åˆ—æ¸¬è©¦æ¡ˆä¾‹æ™‚çš„ <code>sad path</code> å—ï¼Ÿç•¶æ¸¬è©¦æ¡ˆä¾‹æ‡‰è©²è¦å¤±æ•—çš„æ™‚å€™å°±å¯ä»¥é€é <code>fails</code> é¡¯æ€§æ¨™è¨»ä»–å€‘ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>.</span><span class=nx>fails</span><span class=p>(</span><span class=sb>`&#39;1&#39; + &#39;1&#39; should not to be &#39;11&#39;`</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>add</span> <span class=o>=</span> <span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>x</span><span class=p>)</span> <span class=o>+</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;1&#39;</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;11&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ç•¶ç„¶ä½ ä¹Ÿå¯ä»¥å–®ç´”è—‰ç”±æ–·è¨€ä¸­çš„ <code>.not</code> é”åˆ°åŒæ¨£çš„æ•ˆæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=sb>`&#39;1&#39; + &#39;1&#39; should not to be &#39;11&#39;`</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>add</span> <span class=o>=</span> <span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>x</span><span class=p>)</span> <span class=o>+</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;1&#39;</span><span class=p>)).</span><span class=nx>not</span><span class=p>.</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;11&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ä»¥ä¸Šä¾¿æ˜¯æ¸¬è©¦ç¨‹å¼ç¢¼ä¸­æ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹çš„éƒ¨åˆ†ï¼Œæœ‰é—œæ–¼è¼”åŠ© API çš„éƒ¨åˆ†æœ‰äº›å…§å®¹ä¸ä¸€å®šæœƒä½¿ç”¨çš„åˆ°ï¼Œè‹¥æƒ³æ›´åŠ ç­è§£æ‰€æœ‰å¯ç”¨çš„éƒ¨åˆ†å¯ä»¥åƒè€ƒ Vitest <a class=link href=https://cn.vitest.dev/api/#describe target=_blank rel=noopener>æ¸¬è©¦æƒ…å¢ƒ</a> èˆ‡ <a class=link href=https://cn.vitest.dev/api/#test target=_blank rel=noopener>æ¸¬è©¦æ¡ˆä¾‹</a> çš„æ–‡ä»¶å›‰ã€‚</p><hr><h2 id=æº–å‚™setupèˆ‡æ¸…ç†teardown>æº–å‚™(Setup)èˆ‡æ¸…ç†(Teardown)</h2><p>ç¶“éäº†åŸºæœ¬çš„æ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹èªæ³•ï¼ŒåŠ ä¸Šç°¡å–®çš„æ–·è¨€èªæ³• <code>expect().toBe()</code> å°±èƒ½å¤ æ¸¬è©¦è¨±å¤šç°¡å–®çš„æ±è¥¿äº†ï¼Œç„¶è€Œåœ¨æ¸¬è©¦éç¨‹ä¸­æœ‰æ™‚æœƒé‡åˆ°å¤§é‡é‡è¤‡çš„ã€Œ<strong>å‰ç½®æ“ä½œ</strong>ã€æˆ–æ˜¯æ¯æ¬¡æ¸¬è©¦å¾Œã€Œ<strong>éœ€è¦æ¸…ç†æ¸¬è©¦ä¸­çš„ç’°å¢ƒ</strong>ã€ï¼Œé€™æ™‚æˆ‘å€‘å¯ä»¥é€é <code>Vitest</code> æä¾›çš„ <code>Setup</code> & <code>Teardown</code> API ä¾†è™•ç†ï¼š</p><ul><li>beforeEachï¼šåœ¨æ¯å€‹æ¸¬è©¦æ¡ˆä¾‹åŸ·è¡Œå‰å‘¼å«ä¸€æ¬¡ã€‚</li><li>beforeAllï¼šåœ¨æ‰€æœ‰æ¸¬è©¦æ¡ˆä¾‹åŸ·è¡Œå‰å‘¼å«ä¸€æ¬¡ã€‚</li><li>afterEachï¼šåœ¨æ¯å€‹æ¸¬è©¦æ¡ˆä¾‹åŸ·è¡Œå¾Œå‘¼å«ä¸€æ¬¡ã€‚</li><li>afterAllï¼šåœ¨æ‰€æœ‰æ¸¬è©¦æ¡ˆä¾‹åŸ·è¡Œå¾Œå‘¼å«ä¸€æ¬¡ã€‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>beforeEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// é‡å°æ¸¬è©¦æ¡ˆä¾‹é‡æ–°åˆå§‹åŒ–
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>initTestEnv</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=setup--teardown-api-çš„ç¯„ç–‡>Setup & Teardown API çš„ç¯„ç–‡</h3><p><code>Setup</code> & <code>Teardown</code> API ã€Œ<strong>æ‰€æœ‰</strong>ã€çš„å®šç¾©æ˜¯æ ¹æ“šç•¶ä¸‹çš„ç¯„ç–‡(<code>context</code>)ä¾†æ±ºå®šï¼Œé™¤äº†æ¸¬è©¦æª”æ¡ˆæœ¬èº«ä¹‹å¤–ï¼Œä½¿ç”¨ <code>describe</code> ä¾†å®šç¾©æ¸¬è©¦æƒ…å¢ƒä¹Ÿæœƒå½¢æˆä¸€å€‹ <code>context</code>ï¼Œå› æ­¤å‡å¦‚æ¸¬è©¦æƒ…å¢ƒæœ‰å·¢ç‹€çš„æƒ…æ³å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>history</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;çˆ¶å±¤æƒ…å¢ƒ&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>beforeAll</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;beforeAll - çˆ¶å±¤æƒ…å¢ƒ&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>beforeEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;beforeEach - çˆ¶å±¤æƒ…å¢ƒ&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>afterAll</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;afterAll - çˆ¶å±¤æƒ…å¢ƒ&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>afterEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;afterEach - çˆ¶å±¤æƒ…å¢ƒ&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;å­å±¤æƒ…å¢ƒ A&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>beforeAll</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;beforeAll - å­å±¤æƒ…å¢ƒ A&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>beforeEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;beforeEach - å­å±¤æƒ…å¢ƒ A&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>afterAll</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;afterAll - å­å±¤æƒ…å¢ƒ A&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>afterEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;afterEach - å­å±¤æƒ…å¢ƒ A&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¡ˆä¾‹ 1&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;å­å±¤æƒ…å¢ƒ A æ¡ˆä¾‹ 1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¡ˆä¾‹ 2&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;å­å±¤æƒ…å¢ƒ A æ¡ˆä¾‹ 2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;å­å±¤æƒ…å¢ƒ B&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>beforeAll</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;beforeAll - å­å±¤æƒ…å¢ƒ B&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>beforeEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;beforeEach - å­å±¤æƒ…å¢ƒ B&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>afterAll</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;afterAll - å­å±¤æƒ…å¢ƒ B&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>afterEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;afterEach - å­å±¤æƒ…å¢ƒ B&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¡ˆä¾‹ 1&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;å­å±¤æƒ…å¢ƒ B æ¡ˆä¾‹ 1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¡ˆä¾‹ 2&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>history</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;å­å±¤æƒ…å¢ƒ B æ¡ˆä¾‹ 2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>æ­¤æ™‚å°‡é€é <code>console.log(history)</code> æŸ¥çœ‹ä¸¦æ­¸ç´æ•´ç†å°±èƒ½å¾—åˆ°ä»¥ä¸‹çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>--- é€²å…¥æ¸¬è©¦ç¨‹å¼ç¢¼æœ¬èº«çš„ Context
</span></span><span class=line><span class=cl>--- é€²å…¥çˆ¶å±¤æƒ…å¢ƒçš„ Context
</span></span><span class=line><span class=cl>beforeAll - çˆ¶å±¤æƒ…å¢ƒ
</span></span><span class=line><span class=cl>--- é€²å…¥å­å±¤æƒ…å¢ƒ A çš„ Context
</span></span><span class=line><span class=cl>beforeAll - å­å±¤æƒ…å¢ƒ A
</span></span><span class=line><span class=cl>beforeEach - çˆ¶å±¤æƒ…å¢ƒ
</span></span><span class=line><span class=cl>beforeEach - å­å±¤æƒ…å¢ƒ A
</span></span><span class=line><span class=cl>å­å±¤æƒ…å¢ƒ A æ¡ˆä¾‹ <span class=m>1</span> // åŸ·è¡Œ æƒ…å¢ƒ A æ¡ˆä¾‹ <span class=m>1</span> çš„æ™‚é–“é»
</span></span><span class=line><span class=cl>afterEach - å­å±¤æƒ…å¢ƒ A
</span></span><span class=line><span class=cl>afterEach - çˆ¶å±¤æƒ…å¢ƒ
</span></span><span class=line><span class=cl>beforeEach - çˆ¶å±¤æƒ…å¢ƒ
</span></span><span class=line><span class=cl>beforeEach - å­å±¤æƒ…å¢ƒ A
</span></span><span class=line><span class=cl>å­å±¤æƒ…å¢ƒ A æ¡ˆä¾‹ <span class=m>2</span> // åŸ·è¡Œ æƒ…å¢ƒ A æ¡ˆä¾‹ <span class=m>2</span> çš„æ™‚é–“é»
</span></span><span class=line><span class=cl>afterEach - å­å±¤æƒ…å¢ƒ A
</span></span><span class=line><span class=cl>afterEach - çˆ¶å±¤æƒ…å¢ƒ
</span></span><span class=line><span class=cl>afterAll - å­å±¤æƒ…å¢ƒ A
</span></span><span class=line><span class=cl>--- é›¢é–‹å­å±¤æƒ…å¢ƒ A çš„ Context
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- é€²å…¥å­å±¤æƒ…å¢ƒ B çš„ Context
</span></span><span class=line><span class=cl>beforeAll - å­å±¤æƒ…å¢ƒ B
</span></span><span class=line><span class=cl>beforeEach - çˆ¶å±¤æƒ…å¢ƒ
</span></span><span class=line><span class=cl>beforeEach - å­å±¤æƒ…å¢ƒ B
</span></span><span class=line><span class=cl>å­å±¤æƒ…å¢ƒ B æ¡ˆä¾‹ <span class=m>1</span> // åŸ·è¡Œ æƒ…å¢ƒ B æ¡ˆä¾‹ <span class=m>1</span> çš„æ™‚é–“é»
</span></span><span class=line><span class=cl>afterEach - å­å±¤æƒ…å¢ƒ B
</span></span><span class=line><span class=cl>afterEach - çˆ¶å±¤æƒ…å¢ƒ
</span></span><span class=line><span class=cl>beforeEach - çˆ¶å±¤æƒ…å¢ƒ
</span></span><span class=line><span class=cl>beforeEach - å­å±¤æƒ…å¢ƒ B
</span></span><span class=line><span class=cl>å­å±¤æƒ…å¢ƒ B æ¡ˆä¾‹ <span class=m>2</span> // åŸ·è¡Œ æƒ…å¢ƒ B æ¡ˆä¾‹ <span class=m>2</span> çš„æ™‚é–“é»
</span></span><span class=line><span class=cl>afterEach - å­å±¤æƒ…å¢ƒ B
</span></span><span class=line><span class=cl>afterEach - çˆ¶å±¤æƒ…å¢ƒ
</span></span><span class=line><span class=cl>afterAll - å­å±¤æƒ…å¢ƒ B
</span></span><span class=line><span class=cl>--- é›¢é–‹å­å±¤æƒ…å¢ƒ B çš„ Context
</span></span><span class=line><span class=cl>afterAll - çˆ¶å±¤æƒ…å¢ƒ
</span></span><span class=line><span class=cl>--- é›¢é–‹çˆ¶å±¤æƒ…å¢ƒçš„ Context
</span></span><span class=line><span class=cl>--- é›¢é–‹æ¸¬è©¦ç¨‹å¼ç¢¼æœ¬èº«çš„ Context
</span></span></code></pre></td></tr></table></div></div><p>å› æ­¤æˆ‘å€‘åœ¨ä½¿ç”¨é€™é¡ API æ™‚è¦æ³¨æ„ç•¶ä¸‹ <code>context</code> æ‰€åŒ…å«çš„ç¯„åœã€‚</p><h3 id=é¿å…èª¤å€åœ¨-expect-å¾Œåšæ¸…æƒè™•ç†>é¿å…èª¤å€ï¼šåœ¨ expect å¾Œåšæ¸…æƒè™•ç†</h3><p>é™¤äº†ä¸Šé¢çš„ç”¨æ³•ï¼Œæœ‰æ™‚å€™ä½ å¯èƒ½æœƒèªç‚ºæ—¢ç„¶è¦æ¸…æƒï¼Œé‚£æˆ‘ä½•ä¸åœ¨æ–·è¨€å¾Œè™•ç†å°±å¥½å‘¢ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>().</span><span class=nx>toBe</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1>// åœ¨é€™è£¡åšæ¸…é™¤
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>resetTestingEnv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>é€™éº¼åšç•¶ä½ åœ¨æ¸¬è©¦æ¡ˆä¾‹éƒ½æ˜¯é€šéçš„æƒ…æ³ä¸‹éƒ½æ²’æœ‰å•é¡Œï¼Œä½†æ˜¯ä¸€ä½†æŸå€‹æ¸¬è©¦æ¡ˆä¾‹ç™¼ç”Ÿäº†éŒ¯èª¤ï¼Œç”±æ–¼æ¸¬è©¦æ¡ˆä¾‹å°±æœƒåœ¨æ–·è¨€æ™‚æ‹‹å‡º <code>AssertionError</code> å¾Œåœæ­¢ï¼Œå› æ­¤å¾ˆæœ‰å¯èƒ½å› ç‚ºä¸€å€‹æ¸¬è©¦æ¡ˆä¾‹å£äº†å°è‡´æ¥ä¸‹ä¾†æ‰€æœ‰æ¸¬è©¦éƒ½å—åˆ°å½±éŸ¿ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>expect</span><span class=p>().</span><span class=nx>toBe</span><span class=p>()</span> <span class=c1>// AssertionErrorï¼Œé€™å€‹æ¸¬è©¦æ¡ˆä¾‹å°±åœåœ¨é€™äº†
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>resetTestingEnv</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// åœ¨æ²’æœ‰ç¶“é `resetTestingEnv()` ä¸‹é€²è¡Œæ¸¬è©¦
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// åœ¨æ²’æœ‰ç¶“é `resetTestingEnv()` ä¸‹é€²è¡Œæ¸¬è©¦
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// åœ¨æ²’æœ‰ç¶“é `resetTestingEnv()` ä¸‹é€²è¡Œæ¸¬è©¦
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// åœ¨æ²’æœ‰ç¶“é `resetTestingEnv()` ä¸‹é€²è¡Œæ¸¬è©¦
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å› æ­¤è¼ƒä½³çš„ä½œæ³•é‚„æ˜¯ä½¿ç”¨ <code>Setup</code> & <code>Teardown</code> API ä¾†è™•ç†æœƒæ¯”è¼ƒå¥½ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>beforeEach</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>setupTestingEnv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>afterEach</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>resetTestingEnv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=é¿å…éåº¦ä½¿ç”¨-setup--teardown-api>é¿å…éåº¦ä½¿ç”¨ Setup & Teardown API</h3><p>ä¸€åå°æ–¼æ¸¬è©¦é ˜åŸŸé —æœ‰ç ”ç©¶çš„ Kent C. Dodds åœ¨ twitter ä¸Šç™¼è¡¨ï¼š</p><p><img src=https://live.staticflickr.com/65535/52593679893_c0af1b393a_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>è¨±å¤šäººä¸€çœ‹äº†ç´›ç´›è¡¨ç¤ºä¸­æ§ï¼Œå¿ƒæƒ³é€™ä¸å°±æ˜¯æˆ‘åœ¨å¯«çš„æ±è¥¿å—ï¼Ÿå› æ­¤ç™¼æ–‡ä¸€å‡ºä¸å°‘äººå°±å¥½å¥‡é‚£éº¼åˆ°åº•ç‚ºä»€éº¼ä¸Šæ–¹çš„ç”¨æ³•æœƒæ¯”è¼ƒå¥½å‘¢ï¼Ÿä¸”è®“æˆ‘å€‘å¾æŠ½è±¡å…‰è­œä»‹ç´¹èµ·ã€‚</p><h3 id=æŠ½è±¡å…‰è­œthe-spectrum-of-abstraction>æŠ½è±¡å…‰è­œ(The Spectrum of Abstraction)</h3><p>Kent C. Dodds <a class=link href=https://kentcdodds.com/blog/aha-testing target=_blank rel=noopener>æå‡º</a>åœ¨æŠ½è±¡å…‰è­œä¸­ä¸»è¦åˆ†æˆäº†ä¸‰ç¨®æ¦‚å¿µï¼š</p><ul><li>ANAï¼šAbsolutely No Abstraction</li><li>AHAï¼šAvoid Hasty Abstraction</li><li>DRYï¼šDon&rsquo;t Repeat Yourself</li></ul><p>è€Œå¾Œä¸¦å°‡æ­¤æ¦‚å¿µæ‡‰ç”¨åœ¨ Testing èº«ä¸Šä¸¦åˆ†åˆ¥è§£èªªäº†ä¸‰ç¨®æŠ½è±¡å‹æ…‹ä¸‹çš„æ¸¬è©¦çš„å„ªåŠ£åˆ†æã€‚</p><p>å…¶ä¸­æˆ‘å€‘å¾€å¾€ä¸€é–‹å§‹å­¸ç¿’å¯èƒ½å› ç‚ºå°èªæ³•ä¸ç†Ÿç¨”ï¼Œå› æ­¤å¯èƒ½æœƒå¯«å‡º ANA Testing å½¢å¼ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span> <span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æº–å‚™
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// æ“ä½œ
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// æ–·è¨€
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span> <span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æº–å‚™ï¼šé‡è¤‡çš„æº–å‚™é¡ä¼¼çš„å…§å®¹
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// æ“ä½œ
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// æ–·è¨€
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span> <span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// æº–å‚™ï¼šé‡è¤‡çš„æº–å‚™é¡ä¼¼çš„å…§å®¹
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// æ“ä½œ
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// æ–·è¨€
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œéš¨è‘—æ¸¬è©¦ç¶“é©—è¶Šä¾†è¶Šç†Ÿç¨”ä¹‹å¾Œï¼Œæˆ‘å€‘å¯èƒ½æœƒæƒ³ç›¡å„ç¨®æ–¹æ³•ä¾†ã€Œç¯€çœã€æ’°å¯«æ¸¬è©¦ä¸Šçš„æ™‚é–“ï¼Œç”šè‡³åƒè€ƒ DRY å¿ƒæ³•å¯«å‡ºé€™æ¨£çš„æ¸¬è©¦ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// çµ±ä¸€çš„äº‹å‰æº–å‚™
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>testEnv</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>TestEnv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>beforeEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>testEnv</span><span class=p>.</span><span class=nx>init</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span> <span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ç›´æ¥æ“ä½œäº‹å…ˆæº–å‚™å¥½çš„å…§å®¹
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// æ–·è¨€
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span> <span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ç›´æ¥æ“ä½œäº‹å…ˆæº–å‚™å¥½çš„å…§å®¹
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// æ–·è¨€
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œé€™æ¨£çš„ä¸‹å ´å°‡æœƒåœ¨è¤‡é›œçš„å·¢ç‹€æ¸¬è©¦æƒ…å¢ƒä¸‹è¶Šä¾†è¶Šé›£ä»¥é–±è®€èˆ‡èª¿æ•´ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>testEnv</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>TestEnv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>beforeEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>testEnv</span><span class=p>.</span><span class=nx>init</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>testEnv</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>TestEnv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>beforeEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>testEnv</span><span class=p>.</span><span class=nx>init</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>testEnv</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>TestEnv</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>beforeEach</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>testEnv</span><span class=p>.</span><span class=nx>init</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ... ç­‰ç­‰ é€™è£¡çš„åˆå§‹æº–å‚™æœ‰ä»€éº¼ ï¼Ÿï¼Ÿï¼Ÿ
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œé™¤äº†å·¢ç‹€æƒ…å¢ƒæœ¬èº«æ˜¯å€‹è­°é¡Œä¹‹å¤–ï¼ŒKent C. Dodds èªç‚ºæˆ‘å€‘æ‡‰è©²å…¼å®¹çš„æ–¹å¼å»çœ‹å¾…ä»–ï¼Œä¹Ÿå°±æ˜¯èªªä»–ä¸æ’æ–¥æˆ‘å€‘å»åšæŠ½è±¡é€™ä»¶äº‹æƒ…ï¼Œä½†æ˜¯é¦–å…ˆè¦åšçš„æ‡‰è©²æ˜¯å…ˆä¿æŒå–®ç´”ï¼Œç›´åˆ°æˆ‘å€‘çœ‹åˆ°è¶³å¤ å¤šå…±åŒçš„æ¡ˆä¾‹ä¾†åˆ†æèƒ½æŠ½å–å‡ºçš„éƒ¨åˆ†ï¼Œå¦‚æœä¸å¤ å¤šé‚£ç”šè‡³åŸå…ˆ <code>inline</code> çš„æ¸¬è©¦æ¡ˆä¾‹ç‰ˆæœ¬ä¹Ÿæ¯”éå¤šæŠ½è±¡çš„ç‰ˆæœ¬è¦å¥½å¾—å¤šã€‚</p><blockquote><p><a class=link href=https://kentcdodds.com/blog/avoid-nesting-when-youre-testing target=_blank rel=noopener>é¿å…éåº¦å·¢ç‹€æƒ…å¢ƒ</a></p></blockquote><p>æœ€å¾Œï¼Œå…±ç”¨çš„éƒ¨åˆ†é™¤éçœŸçš„æœ‰å¿…è¦é€é <code>setup</code> & <code>teardown</code> å¯¦ä½œè™•ç†ï¼Œå¦å‰‡å…±ç”¨çš„éƒ¨åˆ†å¤§å¤šä¹Ÿå¯ä»¥é€éè«¸å¦‚<code>å·¥å» æ¨¡å¼</code>(<code>factory pattern</code>)çš„å½¢å¼ç”¢ç”Ÿã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=cm>/* æ“·å–è‡ªæˆ‘æŸå€‹å°ˆæ¡ˆå…§çš„å…ƒä»¶æ¸¬è©¦ */</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>factory</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nx>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>createSpy</span><span class=o>:</span> <span class=nx>vi</span><span class=p>.</span><span class=nx>fn</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>global</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>plugins</span><span class=o>:</span> <span class=p>[</span><span class=nx>createTestingPinia</span><span class=p>(</span><span class=nx>options</span><span class=p>)],</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>store</span> <span class=o>=</span> <span class=nx>useMainStore</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span> <span class=nx>wrapper</span><span class=p>,</span> <span class=nx>store</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æ‰€ä»¥å¾€å¾Œè‹¥æœ‰ä½¿ç”¨åˆ°é€™é¡ API æ™‚ä¸ä»¿å…ˆæ€è€ƒä¸€ä¸‹æˆ‘å€‘çœŸçš„éœ€è¦å—ï¼Œé‚„æ˜¯æœ‰æ›´åŠ å„ªé›…çš„æ–¹å¼èƒ½å¤ è§£æ±ºé‡è¤‡çš„å•é¡Œå‘¢ï¼Ÿ</p><hr><h2 id=æ–·è¨€èªæ³•èˆ‡-matchers>æ–·è¨€èªæ³•èˆ‡ Matchers</h2><p>æ–·è¨€(Assertion)åœ¨ç¨‹å¼è¨­è¨ˆé ˜åŸŸä¸­ä¸»è¦æŒ‡çš„æ˜¯ã€Œé‡å°ä¸€å€‹çµæœæŒ‡å‡ºç‚ºçœŸ(<code>true</code>)æˆ–å‡(<code>false</code>)ã€çš„é‚è¼¯åˆ¤æ–·å¼ã€‚</p><p>è€Œåœ¨æ¸¬è©¦ä¸­æ–·è¨€ä¸»è¦æŒ‡çš„éƒ¨åˆ†å¦‚å…ˆå‰æåˆ°çš„ 3A æ¨¡å¼ä¸­çš„(Assert)æ­¥é©Ÿï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// æº–å‚™ï¼šArrange
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>content</span><span class=o>:</span> <span class=s1>&#39;Hello, Unit-test!&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=c1>// æ“ä½œï¼šAct
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;button&#34;]&#39;</span><span class=p>).</span><span class=nx>click</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=c1>// æ–·è¨€ï¼šAssert
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;content&#34;]&#39;</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;Hello, Unit-test!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å…¶ä¸­æ–·è¨€(Assert)éšæ®µä¸­åœ¨èªæ³•çš„éƒ¨åˆ†å‰‡æœƒä½¿ç”¨åˆ°æ‰€è¬‚çš„ã€ŒMatchersã€ï¼Œä»¥ä¸Šæ–¹ç¨‹å¼ç¢¼ç‚ºä¾‹çš„è©±å°±æœƒæ˜¯ <code>expect()</code> å¾Œæ–¹çš„ <code>toBe()</code> é€™å€‹èªæ³•ï¼Œè€Œä¸åŒçš„ã€ŒMatchersã€èƒ½æ¯”å°çš„æ±è¥¿ä¹Ÿä¸å¤ªä¸€æ¨£ï¼Œç­è§£ä»€éº¼æ™‚å€™è©²é¸ä»€éº¼ Matchers åŸºæœ¬ä¸Šå¯«æ–·è¨€çš„æ™‚å€™å°±èƒ½ä¿¡æ‰‹æ»ä¾†ã€‚</p><h3 id=æ–·è¨€èªæ³•>æ–·è¨€èªæ³•</h3><p>ä¾æ“šä¸åŒå·¥å…·æˆ–æ¡†æ¶æ‰€æä¾›çš„æ–·è¨€èªæ³•(Assertion)ï¼Œå°æ–¼ Matchers ä¾†èªªå°±æœƒæœ‰ä¸åŒçš„å¯«æ³•ï¼Œæ‰€ä»¥é¦–å…ˆæˆ‘å€‘è¦å…ˆä¾†ç°¡å–®èªè­˜ä¸€ä¸‹ä¸åŒå·¥å…·ä¹‹é–“çš„æ–·è¨€èªæ³•é¢¨æ ¼ä¸Šçš„å·®ç•°ï¼ŒæŒ‘é¸èƒ½æ¥å—çš„æ–·è¨€é¢¨æ ¼å¾Œå†ä¾†çœ‹è©²é¢¨æ ¼çš„ Matcher ç”¨æ³•ï¼Œè€Œé¢¨æ ¼çš„éƒ¨åˆ†ä»¥ä¸‹å°‡ä¾åºä»‹ç´¹ï¼š</p><ul><li>Chai æ–·è¨€åº«</li><li>Jest æ¡†æ¶ä¸­çš„æ–·è¨€èªæ³•</li><li>Vitest ä¸­æ‰€èƒ½ç”¨çš„éƒ¨åˆ†</li></ul><h4 id=chai-assertion>Chai Assertion</h4><p><a class=link href=https://www.chaijs.com/ target=_blank rel=noopener>Chai.js</a> æœ¬èº«æ˜¯ä¸€å€‹å°ˆæ³¨åœ¨æä¾›æ–·è¨€èªæ³•çš„å·¥å…·åº«ï¼Œå®ƒæä¾›äº†<a class=link href=https://www.chaijs.com/guide/styles/ target=_blank rel=noopener>ä¸‰ç¨®å¯«æ³•</a>ï¼š</p><ul><li><code>Assert</code>(TDD style)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;Chai/Assert&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>x</span> <span class=o>=</span> <span class=s1>&#39;Orange tabby cat&#39;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>y</span> <span class=o>=</span> <span class=s1>&#39;fat&#39;</span>
</span></span><span class=line><span class=cl>  <span class=nx>assert</span><span class=p>(</span><span class=nx>x</span> <span class=o>!==</span> <span class=nx>y</span><span class=p>,</span> <span class=s1>&#39;Orange tabby cat is not fat&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>Expect</code>(BDD style)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;Chai/Expect&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]).</span><span class=nx>to</span><span class=p>.</span><span class=nx>be</span><span class=p>.</span><span class=nx>an</span><span class=p>(</span><span class=s1>&#39;array&#39;</span><span class=p>).</span><span class=nx>that</span><span class=p>.</span><span class=nx>does</span><span class=p>.</span><span class=nx>not</span><span class=p>.</span><span class=nx>include</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>Should</code>(BDD style)ï¼šé€éæ“´å……ç‰©ä»¶ <code>prototype</code> çµ¦äºˆ <code>should</code> å±¬æ€§çš„æ–¹å¼ä½¿æˆ‘å€‘å¯ä»¥ç›´æ¥éˆå¼åŠ å…¥ Matchers åœ¨å®šç¾©å¥½çš„è®Šæ•¸å¾Œã€‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// é¸æ“‡ä¸€ï¼šåœ¨æ–·è¨€å‰éœ€è¦å‘¼å« `chai.should` æ–¹æ³•ï¼Œ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>chai</span> <span class=nx>from</span> <span class=s1>&#39;chai&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>chai</span><span class=p>.</span><span class=nx>should</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1>// é¸æ“‡äºŒï¼šç›´æ¥å¼•å…¥ä¸‹æ–¹
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=s1>&#39;chai/register-should&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// åº•ä¸‹çš„æ¸¬è©¦æ¡ˆä¾‹å°±èƒ½ç›´æ¥éˆå¼åŠ ä¸Š Matchers
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;Chai/Assert&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>foo</span> <span class=o>=</span> <span class=s1>&#39;bar&#39;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>beverages</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>tea</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;chai&#39;</span><span class=p>,</span> <span class=s1>&#39;matcha&#39;</span><span class=p>,</span> <span class=s1>&#39;oolong&#39;</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>foo</span><span class=p>.</span><span class=nx>should</span><span class=p>.</span><span class=nx>be</span><span class=p>.</span><span class=nx>a</span><span class=p>(</span><span class=s1>&#39;string&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>foo</span><span class=p>.</span><span class=nx>should</span><span class=p>.</span><span class=nx>equal</span><span class=p>(</span><span class=s1>&#39;bar&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>foo</span><span class=p>.</span><span class=nx>should</span><span class=p>.</span><span class=nx>have</span><span class=p>.</span><span class=nx>lengthOf</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>beverages</span><span class=p>.</span><span class=nx>should</span><span class=p>.</span><span class=nx>have</span><span class=p>.</span><span class=nx>property</span><span class=p>(</span><span class=s1>&#39;tea&#39;</span><span class=p>).</span><span class=kd>with</span><span class=p>.</span><span class=nx>lengthOf</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=jest-assertion>Jest Assertion</h4><p>ä»¥ <a class=link href=https://jestjs.io/ target=_blank rel=noopener>Jest</a> æ¸¬è©¦æ¡†æ¶ä¸­æ‰€æä¾›çš„æ–·è¨€æ–¹æ³•å‰‡åªæœ‰ï¼š</p><ul><li><code>Expect</code>(BDD style)ï¼š</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;expect/ BDD style&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=mi>1</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>éœ€ç‰¹åˆ¥æ³¨æ„çš„æ˜¯ Jest ä¸­çš„ <code>expect</code> èˆ‡ Chai çš„ <code>expect</code> æ‰€æä¾›çš„ Matchers æ˜¯ä¸ä¸€æ¨£çš„ã€‚</p></blockquote><h4 id=vitest>Vitest</h4><p>ä»¥ <a class=link href=https://cn.vitest.dev/ target=_blank rel=noopener>Vitest</a> æ¸¬è©¦å·¥å…·ä¾†èªªï¼Œæ–·è¨€(Assertion)èªæ³•çš„éƒ¨åˆ†ä»–å…§å»ºäº† Chai æ–·è¨€åº«èˆ‡å…¼å®¹äº† Jest ä¸­çš„æ–·è¨€èªæ³•ï¼Œå› æ­¤ä¸»è¦å°±æ˜¯åœ¨ä»¥ä¸Šä»‹ç´¹çš„å››ç¨®å¯«æ³•ä¸­é¸æ“‡ä¸€ç¨®ä½¿ç”¨ï¼</p><p>è€Œæ¥ä¸‹ä¾†ä¸»è¦è‘—é‡ä»‹ç´¹ Jest Assertion ä¸­çš„ <code>expect</code> èªæ³•çš„ Matchers è¦å¦‚ä½•ä½¿ç”¨ï¼</p><h3 id=vitestjest-expect-matchers>Vitest(Jest expect Matchers)</h3><p>è¦å­¸ç¿’é€™é¡ Matchers é™¤äº†æŠŠ API doc ç¿»ä¸€è¼ªä¹‹å¤–ï¼Œæœ€å¿«çš„æ–¹å¼ä¹‹ä¸€å°±æ˜¯é‡å°ä¸åŒçš„æ¸¬è©¦çµæœç›®æ¨™é¡å‹å»æ­¸ç´ï¼Œè€Œä¾ç…§ç¶“é©—å¸¸è¦‹ç¨®é¡æœ‰ï¼š</p><ul><li>å¸¸ç”¨ï¼štoBe, not</li><li>ç´”å€¼æ¯”å°(Primitive)é¡å‹ï¼šString, Number, Boolean&mldr;, etc.</li><li>é™£åˆ—æ¯”å°èˆ‡æª¢æŸ¥</li><li>ç‰©ä»¶æ¯”å°èˆ‡æª¢æŸ¥</li><li>ç›£è½å‡½å¼</li><li>å¿«ç…§</li><li>Error</li></ul><p>ç”±æ–¼ Matchers ç¹å¤šï¼Œæ‰€ä»¥å¾å¸¸ç”¨è·Ÿæ¦‚å¿µå®¹æ˜“ææ··çš„å¹¾å€‹é–‹å§‹å…ˆä»‹ç´¹èµ·ï¼š</p><h4 id=å¸¸ç”¨>å¸¸ç”¨</h4><ul><li>toBeï¼šå°è³‡æ–™é¡å‹ç‚ºç´”å€¼(Primitive Value)ä¾†èªªå°±æ˜¯æ¯”å°å€¼ç›¸ç­‰</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=mi>1</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=c1>// failed
</span></span></span></code></pre></td></tr></table></div></div><p>å°éç´”å€¼(Non-Primitive Value)ä¾†èªªå°±æ˜¯æ¯”è¨˜æ†¶é«”ä½ç½®(reference)æ˜¯å¦ç›¸ç­‰</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>obj2</span> <span class=o>=</span> <span class=nx>obj</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>obj</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=nx>obj2</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>({}).</span><span class=nx>toBe</span><span class=p>({})</span> <span class=c1>// failed
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// `not`ï¼šç”¨æ–¼åè½‰æ–·è¨€çš„é‚è¼¯
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=mi>1</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=mi>1</span><span class=p>).</span><span class=nx>not</span><span class=p>.</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=c1>// failed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=mi>1</span><span class=p>).</span><span class=nx>not</span><span class=p>.</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=c1>// passed
</span></span></span></code></pre></td></tr></table></div></div><h4 id=ç´”å€¼è³‡æ–™é¡å‹æ¯”å°>ç´”å€¼è³‡æ–™é¡å‹æ¯”å°</h4><ul><li>toBeCloseToï¼šè™•ç†æµ®é»æ•¸é‹ç®—æ™‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=mf>0.1</span> <span class=o>+</span> <span class=mf>0.2</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=mf>0.3</span><span class=p>)</span> <span class=c1>// failed ç¬¦é»æº¢å‡ºï¼Œçµæœæ‡‰è©²æœƒç‚º 0.30000000000000004
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=mf>0.1</span> <span class=o>+</span> <span class=mf>0.2</span><span class=p>).</span><span class=nx>toBeCloseTo</span><span class=p>(</span><span class=mf>0.3</span><span class=p>)</span> <span class=c1>// passed
</span></span></span></code></pre></td></tr></table></div></div><ul><li>toBeGreaterThanã€toBeGreaterThanOrEqualã€toBeLessThanã€toBeLessThanOrEqual</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=mi>5</span><span class=p>).</span><span class=nx>toBeGreaterThan</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=mi>5</span><span class=p>).</span><span class=nx>toBeGreaterThanOrEqual</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=mi>6</span><span class=p>).</span><span class=nx>toBeLessThan</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=mi>6</span><span class=p>).</span><span class=nx>toBeLessThanOrEqual</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span> <span class=c1>// passed
</span></span></span></code></pre></td></tr></table></div></div><ul><li>toBeDefinedã€toBeUndefined</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>b</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>a</span><span class=p>).</span><span class=nx>toBeDefined</span><span class=p>()</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>b</span><span class=p>).</span><span class=nx>toBeUndefined</span><span class=p>()</span> <span class=c1>// passed
</span></span></span></code></pre></td></tr></table></div></div><ul><li>toBeTruthyã€toBeFalsy</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=mi>1</span><span class=p>).</span><span class=nx>toBeTruthy</span><span class=p>()</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=mi>0</span><span class=p>).</span><span class=nx>toBeFalsy</span><span class=p>()</span> <span class=c1>// passed
</span></span></span></code></pre></td></tr></table></div></div><ul><li>toBeNullã€toBeNaN</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=kc>null</span><span class=p>).</span><span class=nx>toBeNull</span><span class=p>()</span> <span class=c1>// passed
</span></span></span></code></pre></td></tr></table></div></div><ul><li>toMatchï¼šå­—ä¸²æˆ–æ­£å‰‡æ¯”å°</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=s1>&#39;0912345678&#39;</span><span class=p>).</span><span class=nx>toMatch</span><span class=p>(</span><span class=sr>/^09[0-9]{8}$/</span><span class=p>)</span> <span class=c1>// passed
</span></span></span></code></pre></td></tr></table></div></div><h4 id=é™£åˆ—æ¯”å°èˆ‡æª¢æŸ¥>é™£åˆ—æ¯”å°èˆ‡æª¢æŸ¥</h4><ul><li>toContainï¼šé™£åˆ—æ˜¯å¦å«æœ‰ç›®æ¨™å€¼</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>([</span><span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;2&#39;</span><span class=p>]).</span><span class=nx>toContain</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>([</span><span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;2&#39;</span><span class=p>]).</span><span class=nx>toContain</span><span class=p>(</span><span class=s1>&#39;4&#39;</span><span class=p>)</span> <span class=c1>// failed
</span></span></span></code></pre></td></tr></table></div></div><ul><li>toContainEqualï¼š é™£åˆ—æ˜¯å¦å«æœ‰è©²å€¼(é¡å‹ç‚ºç´”å€¼æ™‚æª¢é©—æ˜¯å¦ç›¸ç­‰ï¼Œé¡å‹ç‚ºç‰©ä»¶æ™‚æª¢é©—çµæ§‹æ˜¯å¦å…¨ç­‰)</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>([</span><span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=s1>&#39;2&#39;</span><span class=p>]).</span><span class=nx>toContainEqual</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>([{</span> <span class=nx>val</span><span class=o>:</span> <span class=s1>&#39;1&#39;</span> <span class=p>},</span> <span class=p>{</span> <span class=nx>val</span><span class=o>:</span> <span class=s1>&#39;2&#39;</span> <span class=p>}]).</span><span class=nx>toContainEqual</span><span class=p>({</span> <span class=nx>val</span><span class=o>:</span> <span class=s1>&#39;1&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// failed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>([{</span> <span class=nx>val</span><span class=o>:</span> <span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=nx>something</span><span class=o>:</span> <span class=s1>&#39;other&#39;</span> <span class=p>}]).</span><span class=nx>toContainEqual</span><span class=p>({</span> <span class=nx>val</span><span class=o>:</span> <span class=s1>&#39;1&#39;</span> <span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>toHaveLengthï¼šç¢ºèªå…¶å±¬æ€§çš„é•·åº¦æ˜¯å¦ç›¸ç­‰</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=s1>&#39;12&#39;</span><span class=p>).</span><span class=nx>toHaveLength</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>]).</span><span class=nx>toHaveLength</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>({</span> <span class=nx>length</span><span class=o>:</span> <span class=mi>2</span> <span class=p>}).</span><span class=nx>toHaveLength</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=c1>// passed
</span></span></span></code></pre></td></tr></table></div></div><h4 id=ç‰©ä»¶æ¯”å°èˆ‡æª¢æŸ¥>ç‰©ä»¶æ¯”å°èˆ‡æª¢æŸ¥</h4><ul><li>toEqualï¼šæ¯”å°ç‰©ä»¶çµæ§‹æ˜¯å¦ç›¸åŒï¼Œè€Œéæ¯”å°åƒç…§ä¾†æº(reference)ï¼Œè€Œçµæ§‹ä¸­è‹¥å€¼ç‚º undefined æœƒå¿½ç•¥</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>A</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>100</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>B</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>100</span><span class=p>,</span> <span class=nx>secret</span><span class=o>:</span> <span class=kc>undefined</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>A</span><span class=p>).</span><span class=nx>toEqual</span><span class=p>(</span><span class=nx>B</span><span class=p>)</span> <span class=c1>// passed
</span></span></span></code></pre></td></tr></table></div></div><ul><li>toStrictEqualï¼šèˆ‡ toEqual é¡ä¼¼ï¼Œä½† undefined ä¸æœƒè¢«å¿½ç•¥</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>A</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>100</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>B</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>100</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>C</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>100</span><span class=p>,</span> <span class=nx>secret</span><span class=o>:</span> <span class=kc>undefined</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>A</span><span class=p>).</span><span class=nx>toStrictEqual</span><span class=p>(</span><span class=nx>B</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>A</span><span class=p>).</span><span class=nx>toStrictEqual</span><span class=p>(</span><span class=nx>C</span><span class=p>)</span> <span class=c1>// failed
</span></span></span></code></pre></td></tr></table></div></div><p>ç”šè‡³ Class æ‰€å‰µé€ çš„ç‰©ä»¶èˆ‡ç‰©ä»¶å¯¦å­—(Object Literals)ç›¸æ¯”ä¹Ÿè¦–ç‚ºä¸åŒã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>MockClass</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>(</span><span class=nx>num</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>num</span> <span class=o>=</span> <span class=nx>num</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>({</span><span class=nx>num</span><span class=o>:</span> <span class=mi>1</span><span class=p>}).</span><span class=nx>toStrictEqual</span><span class=p>({</span><span class=nx>num</span><span class=o>:</span> <span class=mi>1</span><span class=p>})</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=k>new</span> <span class=nx>MockClass</span><span class=p>(</span><span class=mi>1</span><span class=p>)).</span><span class=nx>toStrictEqual</span><span class=p>({</span><span class=nx>num</span><span class=o>:</span> <span class=mi>1</span><span class=p>})</span> <span class=c1>// failed
</span></span></span></code></pre></td></tr></table></div></div><ul><li>toHavePropertyï¼šæª¢æŸ¥ç‰©ä»¶å«æœ‰å±¬æ€§èˆ‡å…¶å±¬æ€§å€¼</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>100</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>obj</span><span class=p>).</span><span class=nx>toHaveProperty</span><span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>obj</span><span class=p>).</span><span class=nx>toHaveProperty</span><span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>obj</span><span class=p>).</span><span class=nx>toHaveProperty</span><span class=p>(</span><span class=s1>&#39;num&#39;</span><span class=p>,</span> <span class=mi>200</span><span class=p>)</span> <span class=c1>// failed
</span></span></span></code></pre></td></tr></table></div></div><ul><li>toMatchObjectï¼š æª¢æŸ¥ç‰©ä»¶çš„å­å±¤</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>obj</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>nested</span><span class=o>:</span> <span class=p>{</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>200</span> <span class=p>},</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>100</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>obj</span><span class=p>).</span><span class=nx>toMatchObject</span><span class=p>({</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>100</span> <span class=p>})</span> <span class=c1>// passed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>obj</span><span class=p>).</span><span class=nx>toMatchObject</span><span class=p>({</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>200</span> <span class=p>})</span> <span class=c1>// failed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>obj</span><span class=p>).</span><span class=nx>toMatchObject</span><span class=p>({</span> <span class=nx>nested</span><span class=o>:</span> <span class=p>{</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>100</span> <span class=p>}</span> <span class=p>})</span> <span class=c1>// failed
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>expect</span><span class=p>(</span><span class=nx>obj</span><span class=p>).</span><span class=nx>toMatchObject</span><span class=p>({</span> <span class=nx>nested</span><span class=o>:</span> <span class=p>{</span> <span class=nx>num</span><span class=o>:</span> <span class=mi>200</span> <span class=p>}</span> <span class=p>})</span> <span class=c1>// passed
</span></span></span></code></pre></td></tr></table></div></div><p>ç¹¼çºŒè¬›è§£ä¸‹åˆ—å¹¾å€‹æ¯”è¼ƒç‰¹åˆ¥çš„ Matcher</p><h4 id=ç›£è½å‡½å¼>ç›£è½å‡½å¼</h4><p>åœ¨æ¸¬è©¦çš„éç¨‹ä¸­ï¼Œæœ‰æ™‚å€™æˆ‘å€‘ä¸åƒ…åªæ˜¯æ–·è¨€å—æ¸¬ç‰©(SUT, System Under Test)çš„ç‹€æ…‹ï¼Œæœ‰æ™‚å€™å¯èƒ½æœƒå°å—æ¸¬ç›®æ¨™çš„ã€Œä¾è³´ç‰©ã€(DOC, Depended-on Component)ç‹€æ…‹æœ‰èˆˆè¶£ï¼Œè€Œé€™æ™‚æˆ‘å€‘å°±ç„¡æ³•å–®ç´”ä»¥ Matchers ä¾†æ–·è¨€ï¼Œå› ç‚ºæˆ‘å€‘éœ€è¦ç›£è½ä¾è³´ç‰©å‰å¾Œçš„è®ŠåŒ–ã€‚</p><p>è€Œåœ¨ç¨‹å¼æ¸¬è©¦é ˜åŸŸä¸­ï¼Œæ¸¬è©¦æ›¿èº«(<code>test double</code>)ä¸»è¦å°±æ˜¯è² è²¬è™•ç†é€™ä¸€é¡éå—æ¸¬ç‰©æœ¬èº«æ‰€åšçš„äº‹æƒ…ï¼Œä¸¦ä¸”åœ¨éœ€è¦æ™‚é‚„èƒ½å¹«æˆ‘å€‘ç´€éŒ„å¿…è¦çš„è³‡è¨Šã€‚</p><p>å‡è‹¥æˆ‘å€‘ä»Šå¤©æ¸¬è©¦æ¡ˆä¾‹å—æ¸¬ç‰©æœ¬èº«æœƒå»å‘¼å«åˆ°çš„ä¾è³´ç›®æ¨™æ˜¯å€‹ã€Œå‡½å¼ã€æ™‚ï¼Œé€™æ™‚æˆ‘å€‘å¯ä»¥é€é <code>Vitest</code> æ‰€æä¾›çš„ <code>vi.fn()</code> ä¾†æ¨¡ä»¿(spy)å‡½å¼ã€‚</p><p><code>vi.fn()</code> æœ¬èº«æœƒå›å‚³ä¸€å€‹å¯¦é«”(<code>CallableMockInstance</code>)ï¼Œåœ¨é€™å€‹å¯¦é«”ä¸­æœƒè¨˜éŒ„è‘—æœ‰é—œæ¸¬è©¦å‡½å¼æ™‚æœƒéœ€è¦çš„è³‡æ–™èˆ‡æ–¹æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>vi</span><span class=p>.</span><span class=nx>fn</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>  called: false,
</span></span></span><span class=line><span class=cl><span class=cm>  callCount: 0,
</span></span></span><span class=line><span class=cl><span class=cm>  results: [],
</span></span></span><span class=line><span class=cl><span class=cm>  calls: [],
</span></span></span><span class=line><span class=cl><span class=cm>  impl: [Function (anonymous)],
</span></span></span><span class=line><span class=cl><span class=cm>  reset: [Function: i],
</span></span></span><span class=line><span class=cl><span class=cm>  nextError: [Function (anonymous)],
</span></span></span><span class=line><span class=cl><span class=cm>  nextResult: [Function (anonymous)],
</span></span></span><span class=line><span class=cl><span class=cm>  restore: [Function: w],
</span></span></span><span class=line><span class=cl><span class=cm>  ...
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span></code></pre></td></tr></table></div></div><p>å› æ­¤å°‡å—æ¸¬çš„ç›®æ¨™å‡½å¼æ”¾å…¥ <code>vi.fn</code> ä¸­ï¼Œå¾ŒçºŒåªè¦æ¸¬è©¦éç¨‹ä¸­å¦‚æœæ¸¬è©¦ç›®æ¨™å»èª¿ç”¨äº†å·²è¢« Spy éçš„å‡½å¼æ™‚ï¼Œ<code>CallableMockInstance</code> å°±æœƒå¹«æˆ‘å€‘ç´€éŒ„ç›¸é—œçš„è³‡è¨Šï¼Œæ¥è‘—æˆ‘å€‘å°±å¯ä»¥ä½¿ç”¨æ–·è¨€èªæ³•ç›¸é—œçš„ Matcher å»æ¯”å°æˆ‘å€‘é æœŸçš„çµæœï¼Œæ¯”æ–¹èªªï¼š</p><ul><li>toHaveBeenCalledï¼šæ–·è¨€å‡½å¼æœ‰è¢«å‘¼å«é</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sayHi</span> <span class=o>=</span> <span class=p>(</span><span class=nx>something</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>something</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>spyOnSayHi</span> <span class=o>=</span> <span class=nx>vi</span><span class=p>.</span><span class=nx>fn</span><span class=p>(</span><span class=nx>sayHi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>spyOnSayHi</span><span class=p>).</span><span class=nx>toHaveBeenCalled</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>toHaveBeenCalledTimesï¼šæ–·è¨€å‡½å¼è¢«å‘¼å«éå¹¾æ¬¡</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sayHi</span> <span class=o>=</span> <span class=p>(</span><span class=nx>something</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>something</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>spyOnSayHi</span> <span class=o>=</span> <span class=nx>vi</span><span class=p>.</span><span class=nx>fn</span><span class=p>(</span><span class=nx>sayHi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>spyOnSayHi</span><span class=p>).</span><span class=nx>toHaveBeenCalledTimes</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>toHaveBeenCalledWithï¼šæ–·è¨€å‡½å¼è¢«å‘¼å«æ™‚æ‰€å¸¶çš„åƒæ•¸</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sayHi</span> <span class=o>=</span> <span class=p>(</span><span class=nx>something</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>something</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>spyOnSayHi</span> <span class=o>=</span> <span class=nx>vi</span><span class=p>.</span><span class=nx>fn</span><span class=p>(</span><span class=nx>sayHi</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>(</span><span class=s1>&#39;Hello, Unit-Test!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>spyOnSayHi</span><span class=p>).</span><span class=nx>toHaveBeenCalledWith</span><span class=p>(</span><span class=s1>&#39;Hello, Unit-Test!&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>toHaveReturnedï¼šæ–·è¨€å‡½å¼å‘¼å«å¾Œæ‡‰è©²è‡³å°‘è¦è¿”å›å€¼ä¸€æ¬¡</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sayHi</span> <span class=o>=</span> <span class=p>(</span><span class=nx>something</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>something</span> <span class=o>+</span> <span class=s1>&#39; Hello, Spy!&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>spyOnSayHi</span> <span class=o>=</span> <span class=nx>vi</span><span class=p>.</span><span class=nx>fn</span><span class=p>((</span><span class=nx>val</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>sayHi</span><span class=p>(</span><span class=nx>val</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>(</span><span class=s1>&#39;Hello, Unit-Test!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>spyOnSayHi</span><span class=p>).</span><span class=nx>toHaveReturned</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>toHaveReturnedTimesï¼šæ–·è¨€å‡½å¼ç¶“éæ“ä½œå¾Œæ‡‰è©²è¦è¿”å›å€¼å¹¾æ¬¡</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sayHi</span> <span class=o>=</span> <span class=p>(</span><span class=nx>something</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>something</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>spyOnSayHi</span> <span class=o>=</span> <span class=nx>vi</span><span class=p>.</span><span class=nx>fn</span><span class=p>((</span><span class=nx>val</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>sayHi</span><span class=p>(</span><span class=nx>val</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>(</span><span class=s1>&#39;Nice to meet you!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>(</span><span class=s1>&#39;See you again!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>spyOnSayHi</span><span class=p>).</span><span class=nx>toHaveReturnedTimes</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>toHaveLastReturnedWithï¼šæ–·è¨€å‡½å¼ç¶“éæ“ä½œå¾Œæœ€å¾Œæ‡‰è©²è¦è¿”å›çš„å€¼</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sayHi</span> <span class=o>=</span> <span class=p>(</span><span class=nx>something</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>something</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>spyOnSayHi</span> <span class=o>=</span> <span class=nx>vi</span><span class=p>.</span><span class=nx>fn</span><span class=p>((</span><span class=nx>val</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>sayHi</span><span class=p>(</span><span class=nx>val</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>(</span><span class=s1>&#39;Nice to meet you!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>(</span><span class=s1>&#39;See you again!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>spyOnSayHi</span><span class=p>).</span><span class=nx>toHaveLastReturnedWith</span><span class=p>(</span><span class=s1>&#39;See you again!&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>toHaveNthReturnedWithï¼šæ–·è¨€å‡½å¼ç¶“éæ“ä½œå¾Œç¬¬ N æ¬¡æ‡‰è©²è¦è¿”å›çš„å€¼</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sayHi</span> <span class=o>=</span> <span class=p>(</span><span class=nx>something</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>something</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>spyOnSayHi</span> <span class=o>=</span> <span class=nx>vi</span><span class=p>.</span><span class=nx>fn</span><span class=p>((</span><span class=nx>val</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>sayHi</span><span class=p>(</span><span class=nx>val</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>(</span><span class=s1>&#39;Nice to meet you!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>(</span><span class=s1>&#39;See you again!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>spyOnSayHi</span><span class=p>).</span><span class=nx>toHaveNthReturnedWith</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;Nice to meet you!&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>toHaveReturnedWithï¼šæ–·è¨€å‡½å¼å‘¼å«å¾Œè¿”å›çš„å€¼</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sayHi</span> <span class=o>=</span> <span class=p>(</span><span class=nx>something</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>something</span> <span class=o>+</span> <span class=s1>&#39; Hello, Spy!&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>spyOnSayHi</span> <span class=o>=</span> <span class=nx>vi</span><span class=p>.</span><span class=nx>fn</span><span class=p>((</span><span class=nx>val</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>sayHi</span><span class=p>(</span><span class=nx>val</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>spyOnSayHi</span><span class=p>(</span><span class=s1>&#39;Hello, Unit-Test!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>spyOnSayHi</span><span class=p>).</span><span class=nx>toHaveReturnedWith</span><span class=p>(</span><span class=s1>&#39;Hello, Unit-Test! Hello, Spy!&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œæ¸¬è©¦æ›¿èº«(test double)é™¤äº†åƒæ˜¯ vi.fn() é€™é¡é–“è«œé¡å‹(Spy)ä¹‹å¤–ï¼Œé‚„æœ‰è¨±å¤šä¸åŒçš„æ¸¬è©¦æ›¿èº«ï¼Œå®ƒå€‘åœ¨æ¸¬è©¦ä¸­éƒ½æœ‰å„è‡ªçš„ç”¨é€”ä¾†å”åŠ©æˆ‘å€‘æ›´å¥½çš„æ¸¬è©¦ã€‚</p><h3 id=å¿«ç…§æ¸¬è©¦snapshot-testingèˆ‡å¿«ç…§-matchers>å¿«ç…§æ¸¬è©¦(Snapshot Testing)èˆ‡å¿«ç…§ matchers</h3><h4 id=jest-snapshot>Jest Snapshot</h4><p>åœ¨ Jest çš„ <a class=link href=https://jestjs.io/docs/snapshot-testing target=_blank rel=noopener>Snapshot Testing</a> èªªæ˜æ–‡ä»¶çš„å®šç¾©ä¸­ä¸»è¦æŒ‡çš„æ˜¯ç”¨ä¾†é˜²æ­¢ UI å‡ºç¾å°šæœªé æœŸçš„è®ŠåŒ–ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>a</span> <span class=na>data-test</span><span class=o>=</span><span class=s>&#34;link&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;http://ithelp.ithome.com.tw&#34;</span><span class=p>&gt;</span> Ithelp  <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>mount</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@vue/test-utils&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¸²æŸ“é€£çµ&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>([</span><span class=nx>data</span><span class=o>-</span><span class=nx>test</span><span class=o>=</span><span class=s2>&#34;link&#34;</span><span class=p>])).</span><span class=nx>toMatchSnapshot</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶è€Œé€™é‚Šçš„è®ŠåŒ–ï¼Œä¸¦éä½ æ‰€æƒ³åƒçš„æŠŠè¦–è¦ºç•«é¢çµ¦ç…§ç›¸ä¸‹ä¾†æ¯”å°åƒç´ æˆ–æ¯”ä¾‹çš„é‚£ç¨®è¦–è¦ºå›æ­¸æ¸¬è©¦(Visual Regression Testing)ï¼Œè€Œæ˜¯è—‰ç”±å°‡ç›®æ¨™å…ƒä»¶é€éæ¸²æŸ“(Render)å…ƒä»¶ç”¢ç”Ÿäº†ä¸€å€‹ DOM çµæ§‹çš„æ–‡å­—ï¼Œä¸¦åœ¨æ¸¬è©¦ç¨‹å¼æª”è·¯å¾‘åº•ä¸‹çš„ <code>__snapshots__</code> è³‡æ–™å¤¾ç”Ÿæˆä¸€å€‹ <code>.snap</code> æª”æ¡ˆä¾†åšç´€éŒ„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>exports</span><span class=p>[</span><span class=sb>`æ¸²æŸ“é€£çµ`</span><span class=p>]</span> <span class=o>=</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>&lt;a
</span></span></span><span class=line><span class=cl><span class=sb>  data-test=&#34;link&#34;
</span></span></span><span class=line><span class=cl><span class=sb>  href=&#34;http://ithelp.ithome.com.tw&#34;
</span></span></span><span class=line><span class=cl><span class=sb>&gt;
</span></span></span><span class=line><span class=cl><span class=sb>  Ithelp
</span></span></span><span class=line><span class=cl><span class=sb>&lt;/a&gt;
</span></span></span><span class=line><span class=cl><span class=sb>`</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>æˆªè‡³ Jest Snapshot é é¢ä¸­çš„<a class=link href=https://jestjs.io/docs/snapshot-testing target=_blank rel=noopener>ç¨‹å¼ç¢¼</a></p></blockquote><p>åœ¨ç¬¬äºŒæ¬¡åŸ·è¡Œæ¸¬è©¦çš„æ™‚å€™ï¼Œå°±æœƒå†æ¬¡åšä¸€æ¬¡åŒæ¨£çš„æµç¨‹ï¼Œè€Œé€™æ¬¡æ‰€ç”¢ç”Ÿçš„çµæœæœƒèˆ‡å…ˆå‰çš„ <code>.snap</code> ç´€éŒ„åšæ¯”å°ã€‚</p><p>å‡è¨­æ¯”å°ä¸Šæœ‰è½å·®å°±æœƒæ‹‹å‡ºéŒ¯èª¤ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>- Snapshot - 1
</span></span><span class=line><span class=cl>+ Received + 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span>
</span></span><span class=line><span class=cl><span class=na>-</span>  <span class=na>href</span><span class=o>=</span><span class=s>&#34;http://ithelp.ithome.com.tw&#34;</span>
</span></span><span class=line><span class=cl><span class=err>+</span>  <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://ithelp.ithome.com.tw&#34;</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span> Ithelp
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>è—‰ç”±é€™å€‹æ¯”å°æ©Ÿåˆ¶å¾è€Œå¯¦ç¾ã€Œ<strong>é˜²æ­¢ UI å‡ºç¾å°šæœªé æœŸçš„è®ŠåŒ–</strong>ã€çš„åŠŸèƒ½ã€‚</p><h4 id=vitest-snapshot>Vitest Snapshot</h4><p>è€Œå‰é¢æœ‰æåˆ° <code>Vitest</code> æœ¬èº«å…¼å®¹äº† <code>Jest</code> çš„æ–·è¨€(assertion)èªæ³•ï¼Œæ‰€ä»¥å¿«ç…§(Snapshot)çš„ matcher è‡ªç„¶ä¹Ÿæ˜¯ä¸èƒ½æ”¾éã€‚</p><p>åœ¨ <code>Vitest</code> ä¸­ä¸»è¦å…¼å®¹çš„ matcher éƒ¨åˆ†æœ‰ï¼š</p><ul><li>toMatchSnapshot</li><li>toMatchInlineSnapshot</li></ul><p>åŸºæœ¬ä¸Šæ¦‚å¿µèˆ‡ Jest Snapshot ç›¸ä¼¼ï¼Œéƒ½æ˜¯åœ¨åšçµæ§‹å¿«ç…§é€™ä»¶äº‹æƒ…ï¼Œç„¶è€Œ <code>Vitest</code> æ–‡ä»¶éƒ¨åˆ†å‰‡æ˜¯æ²’æœ‰ç‰¹åœ°å¼·èª¿ UI çš„éƒ¨åˆ†ï¼Œè€Œæ˜¯é—œæ³¨åœ¨å€¼(<code>value</code>)çš„æ¯”å°ã€‚</p><p>å› æ­¤æˆ‘å€‘å–®ç´”æ”¾å…¥ä¸€å€‹é™£åˆ—ç‰©ä»¶</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;cat snapshot&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>target</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Orange&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>age</span><span class=o>:</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Blank&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>age</span><span class=o>:</span> <span class=mi>6</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>).</span><span class=nx>toMatchSnapshot</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p><code>.snap</code> çš„çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>exports</span><span class=p>[</span><span class=sb>`component &gt; cat snapshot 1`</span><span class=p>]</span> <span class=o>=</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>  [
</span></span></span><span class=line><span class=cl><span class=sb>    {
</span></span></span><span class=line><span class=cl><span class=sb>      &#34;age&#34;: 4,
</span></span></span><span class=line><span class=cl><span class=sb>      &#34;name&#34;: &#34;Orange&#34;,
</span></span></span><span class=line><span class=cl><span class=sb>    },
</span></span></span><span class=line><span class=cl><span class=sb>    {
</span></span></span><span class=line><span class=cl><span class=sb>      &#34;age&#34;: 6,
</span></span></span><span class=line><span class=cl><span class=sb>      &#34;name&#34;: &#34;Blank&#34;,
</span></span></span><span class=line><span class=cl><span class=sb>    },
</span></span></span><span class=line><span class=cl><span class=sb>  ]
</span></span></span><span class=line><span class=cl><span class=sb>`</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>ç”šè‡³ä¹Ÿå¯ä»¥å¼•å…¥ JSON æª”æ¡ˆä¾†åšå¿«ç…§ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>Area</span> <span class=nx>from</span> <span class=s1>&#39;./area.json&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;static json snapshot&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>Area</span><span class=p>).</span><span class=nx>toMatchSnapshot</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ç•¶ç„¶å…ƒä»¶å¿«ç…§ä¹Ÿæ˜¯èƒ½åšçš„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>mount</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@vue/test-utils&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;snapshot&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>target</span> <span class=o>=</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;content&#34;]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>).</span><span class=nx>toMatchSnapshot</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œä»¥ä¸Šå¿«ç…§éƒ¨åˆ†å¦‚æœä½ è¦ºå¾—è¦ç”Ÿæˆä¸€å€‹æª”æ¡ˆä¾†ç®¡ç†æœ‰é»å›‰å”†ï¼Œé‚£éº¼ä½ å¯ä»¥é€é <code>toMatchInlineSnapshot</code> ä¾†è™•ç†é€™é¡çš„éœ€æ±‚ï¼Œå…¶å·®åˆ¥åœ¨æ–¼ç”Ÿæˆçš„ä½ç½®æœƒæ˜¯åœ¨ <code>toMatchInlineSnapshot()</code> å‡½å¼æœ¬èº«è£¡é¢ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;cat snapshot&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>target</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Orange&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>age</span><span class=o>:</span> <span class=mi>4</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Blank&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>age</span><span class=o>:</span> <span class=mi>6</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// åŸå…ˆ toMatchInlineSnapshot å…§æ²’æœ‰ä»»ä½•æ±è¥¿
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// åœ¨åŸ·è¡Œæ¸¬è©¦å¾Œå°±æœƒå°‡å¿«ç…§å…§å®¹è‡ªå‹•ç”Ÿæˆåœ¨ toMatchInlineSnapshot è£¡
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>).</span><span class=nx>toMatchInlineSnapshot</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>    [
</span></span></span><span class=line><span class=cl><span class=sb>      {
</span></span></span><span class=line><span class=cl><span class=sb>        &#34;age&#34;: 4,
</span></span></span><span class=line><span class=cl><span class=sb>        &#34;name&#34;: &#34;Orange&#34;,
</span></span></span><span class=line><span class=cl><span class=sb>      },
</span></span></span><span class=line><span class=cl><span class=sb>      {
</span></span></span><span class=line><span class=cl><span class=sb>        &#34;age&#34;: 6,
</span></span></span><span class=line><span class=cl><span class=sb>        &#34;name&#34;: &#34;Blank&#34;,
</span></span></span><span class=line><span class=cl><span class=sb>      },
</span></span></span><span class=line><span class=cl><span class=sb>    ]
</span></span></span><span class=line><span class=cl><span class=sb>  `</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ€å¾Œï¼Œå¦‚æœé‡åˆ°è®Šæ›´çš„éƒ¨åˆ†æ˜¯æˆ‘å€‘æ‰€é æœŸçš„æ™‚å€™ï¼Œæ­¤æ™‚å°±éœ€è¦æ›´æ–°å¿«ç…§çš„éƒ¨åˆ†ï¼Œå¯ä»¥åœ¨åŸ·è¡Œæ¸¬è©¦çš„ <code>watch</code> æ¨¡å¼æ™‚æŒ‰ä¸‹ <code>u</code> éµï¼Œå°±å°‡æ–°çš„å¿«ç…§ä¿å­˜èµ·ä¾†ï¼Œæˆ–æ˜¯é€éæ–°å¢ <code>npm scripts</code> æŒ‡ä»¤ä¾†åŸ·è¡Œå‘½ä»¤ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;test:update&#34;</span><span class=p>:</span> <span class=s2>&#34;vitest -u&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=error>Error</h3><p>æœ€å¾Œä»‹ç´¹åˆ°çš„å‰‡æ˜¯<strong>éŒ¯èª¤é¡å‹</strong>çš„ Matcherï¼š</p><ul><li>toThrowError</li><li>toThrowErrorMatchingSnapshot</li><li>toThrowErrorMatchingInlineSnapshot</li></ul><p>å…ˆå‰æˆ‘å€‘æœ‰æåˆ°æ¸¬è©¦æ¡ˆä¾‹é æƒ³çš„ä¸‰å€‹è·¯å¾‘(Happy pathã€sad Pathã€Bad Path)ï¼Œ<code>Bad Path</code> å¾ç”¢å“è§’åº¦ä¸Šä¾†èªª End-User ä½¿ç”¨ä¸Šçš„éŒ¯èª¤ï¼Œæ‡‰è©²è€ƒæ…®å¾ç”¢å“ä½¿ç”¨è§’åº¦ä¸Šå»æ€è€ƒè¦æ€éº¼å”åŠ©ä»–å€‘å»ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸æ‡‰è©²ç‚ºäº†æ‹‹å‡ºéŒ¯èª¤è€Œæ‹‹å‡ºã€‚</p><p>ä½†å‡è¨­ä»Šå¤©æ‹‹å‡ºéŒ¯èª¤çš„æƒ…å¢ƒæ˜¯è¼ƒç‚ºåˆç†çš„éƒ¨åˆ†ï¼Œæ¯”æ–¹æ˜¯é‡å°é–‹ç™¼äººå“¡åœ¨é–‹ç™¼æ™‚æœŸèª¤ç”¨å°è‡´çš„éŒ¯èª¤â‹¯â‹¯ç­‰ç­‰æƒ…æ³ï¼Œé€™æ™‚æˆ‘å€‘å°±å¯ä»¥é€éé€™ä¸€é¡ Matcher ä¾†è™•ç†ã€‚</p><p>è€Œä½¿ç”¨ä¸Šè¦æ¯”è¼ƒå°å¿ƒçš„æ˜¯ï¼Œå—æ¸¬ç›®æ¨™è‹¥æœƒæ‹‹å‡ºéŒ¯èª¤å‰‡è¦é€é wrap function çš„å½¢å¼ä¾†è™•ç†ï¼Œå¦å‰‡æ‹‹å‡ºçš„éŒ¯èª¤æœƒé€ æˆæ¸¬è©¦æ¡ˆä¾‹çš„æ–·è¨€éŒ¯èª¤ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()=&gt;{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>food</span> <span class=o>=</span> <span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span><span class=p>(</span><span class=nx>name</span> <span class=o>===</span> <span class=s1>&#39;å°é»ƒç“œ&#39;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;æˆ‘ä¸åƒå°é»ƒç“œ&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>food</span><span class=p>(</span><span class=s1>&#39;å°é»ƒç“œ&#39;</span><span class=p>)).</span><span class=nx>toThrowError</span><span class=p>(</span><span class=s1>&#39;æˆ‘ä¸åƒå°é»ƒç“œ&#39;</span><span class=p>)</span> <span class=c1>// è‹¥é€™æ¨£å¯«çš„è©±è£¡é ­çš„ Error æœƒå°è‡´æ¸¬è©¦æ¡ˆä¾‹å¤±æ•—
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>expect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>food</span><span class=p>(</span><span class=s1>&#39;å°é»ƒç“œ&#39;</span><span class=p>)).</span><span class=nx>toThrowError</span><span class=p>(</span><span class=s1>&#39;æˆ‘ä¸åƒå°é»ƒç“œ&#39;</span><span class=p>)</span> <span class=c1>// éœ€è¦é€éé€™ç¨®æ–¹å¼æ‰èƒ½æ­£ç¢ºæ–·è¨€
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=å…ƒä»¶æ¸¬è©¦>å…ƒä»¶æ¸¬è©¦</h2><h3 id=vue-test-utils-èˆ‡å…ƒä»¶æ¸¬è©¦>Vue Test Utils èˆ‡å…ƒä»¶æ¸¬è©¦</h3><p>æ¥è‘—ï¼Œè‹¥æˆ‘å€‘æƒ³é€²ä¸€æ­¥åœ¨å°ˆæ¡ˆä¸­æ¸¬è©¦ Vue å…ƒä»¶çš„è©±ï¼Œæˆ‘å€‘é™¤äº†åŸºæ–¼å‰é¢çš„æ¦‚å¿µèˆ‡èªæ³•ä¹‹å¤–ï¼Œé‚„å¾—ä¾é èƒ½å¤ å¹«åŠ©èƒ½å¤ è§£æ Vue å…ƒä»¶ä¸¦èˆ‡å…¶æ¨¡æ“¬äº’å‹•çš„å·¥å…·ï¼š</p><ul><li>Vue Test Utils</li><li>Cypress</li><li>Vue Testing Library</li></ul><p>è€Œæœ¬ç¯‡å°‡è‘—é‡åœ¨ä»‹ç´¹è¦æ€éº¼é€é <a class=link href=https://test-utils.vuejs.org/ target=_blank rel=noopener>Vue Test Utils</a> ä¾†é€²è¡Œèˆ‡ Vue å…ƒä»¶æœ‰é—œçš„ã€Œ<strong>å…ƒä»¶æ¸¬è©¦</strong>ã€ï¼Œå› æ­¤æœ¬æ–‡è¦ä¾†ä»‹ç´¹ä¸€ä¸‹ Vue Test Utils èˆ‡å…ƒä»¶æ¸¬è©¦æ˜¯åœ¨åšä»€éº¼ï¼Œåˆé€™åˆè·Ÿå–®å…ƒæ¸¬è©¦æœ‰ä»€éº¼é—œä¿‚å‘¢ã€‚</p><h3 id=vue-test-utils>Vue-Test-Utils</h3><p>é¦–å…ˆå€è¾¨ä¸€ä¸‹ä»–èˆ‡æˆ‘å€‘ç›®å‰ç”¨åˆ°çš„æ¸¬è©¦å·¥å…·çš„å„è‡ªç”¨è™•ï¼Œæ‰èƒ½æ›´ç­è§£æ¥ä¸‹å­¸çš„å…§å®¹æ˜¯ç”±å“ªå€‹å·¥å…·è² è²¬çš„ï¼Œå°‡ä¾†æœ‰å¿…è¦æŸ¥é–±è³‡æ–™æ™‚å°±èƒ½æ›´æ¸…æ¥šçš„å€åˆ¥ä»–å€‘ã€‚</p><p><a class=link href=https://test-utils.vuejs.org/ target=_blank rel=noopener>Vue Test Utils</a> ä¸»è¦æ˜¯ä½œç‚ºæä¾›æ¸¬è©¦ Vue å…ƒä»¶çš„ç›¸é—œå·¥å…·é›†ï¼Œè®“æˆ‘å€‘èƒ½æ›´è¼•æ˜“çš„æ¨¡æ“¬æ“ä½œå…ƒä»¶ä¾†é€²è¡Œæ¸¬è©¦ï¼Œä½†æœ¬èº«ä¸¦æ²’æœ‰é‹è¡Œæ¸¬è©¦ç’°å¢ƒ(test runner)çš„åŠŸèƒ½ï¼Œå› æ­¤æˆ‘å€‘æœƒéœ€è¦è—‰ç”± Vitest ä¾†ä½œç‚ºæ¸¬è©¦ç’°å¢ƒä»¥åŠç›¸é—œçš„æ¸¬è©¦æƒ…å¢ƒæ¡ˆä¾‹èˆ‡æ–·è¨€ Matcherï¼›é™¤æ­¤ä¹‹å¤–æˆ‘å€‘é‚„éœ€è¦ç”¨ä¾†åœ¨ Node ç’°å¢ƒä¸­æ¨¡æ“¬ç€è¦½å™¨ç’°å¢ƒçš„ <code>jsdom</code> ä¾†å”åŠ©è™•ç†æœ‰é—œ DOM ä¸Šçš„æ“ä½œï¼Œå¦‚æ­¤ä¸€ä¾†æ‰èƒ½é †åˆ©åœ°ä½¿ç”¨ <a class=link href=https://test-utils.vuejs.org/ target=_blank rel=noopener>Vue Test Utils</a>ã€‚</p><p>è€Œç‰ˆæœ¬çš„éƒ¨åˆ†è¦ç‰¹åˆ¥æ³¨æ„åˆ°ï¼Œç”±æ–¼ <a class=link href=https://test-utils.vuejs.org/ target=_blank rel=noopener>Vue Test Utils</a> ç‚ºäº†ç›¸å®¹ Vue ä¸åŒç‰ˆæœ¬ä¹‹é–“çš„ API å› æ­¤æˆ‘å€‘è¦å®‰è£å°æ‡‰çš„ç‰ˆæœ¬æœªä¾†æ‰ä¸æœƒå‡ºéŒ¯ï¼š</p><ul><li>Vue 2ï¼šå®‰è£ <a class=link href=https://v1.test-utils.vuejs.org/ target=_blank rel=noopener>Vue Test Utils 1</a></li><li>Vue 3ï¼šå®‰è£ <a class=link href=https://test-utils.vuejs.org/ target=_blank rel=noopener>Vue Test Utils 2</a></li></ul><p>ç¢ºèªç‰ˆæœ¬æ²’å•é¡Œå¾Œï¼Œæ¨¡æ“¬å…ƒä»¶çš„éƒ¨åˆ†äº¤çµ¦ <a class=link href=https://test-utils.vuejs.org/ target=_blank rel=noopener>Vue Test Utils</a> åŸºæœ¬ä¸Šå°±æ²’å•é¡Œäº†ï¼Œä½†é—œæ–¼ã€Œå…ƒä»¶æ¸¬è©¦ã€ç›®æ¨™ä¸»è¦æ˜¯è¦æ¸¬è©¦ä»€éº¼æ±è¥¿å‘¢ï¼Ÿ</p><h3 id=å…ƒä»¶æ¸¬è©¦çš„ç›®æ¨™>å…ƒä»¶æ¸¬è©¦çš„ç›®æ¨™</h3><p>æ¸¬è©¦æœ¬è³ªä¸»è¦æ˜¯åœ¨é æœŸçµæœèˆ‡å¯¦éš›æ˜¯å¦ç›¸ç­‰ï¼Œè€Œåœ¨å…ƒä»¶æ¸¬è©¦ä¸­ä½œç‚ºå—æ¸¬ç‰©çš„å…ƒä»¶ï¼Œå…¶æœ¬èº«ä¸»è¦æ˜¯è² è²¬ UI ä¸Šçš„ä¸€åˆ‡å…§å®¹ï¼Œå› æ­¤æˆ‘å€‘æ¸¬è©¦ç›®æ¨™åœ¨è‘—é‡æ–¼å®ƒçš„ã€Œ<strong>ç•«é¢</strong>ã€èˆ‡ã€Œ<strong>è¡Œç‚º</strong>ã€ä¸Šæ˜¯å¦å¦‚æˆ‘å€‘æ‰€é æœŸã€‚</p><p>å› æ­¤ï¼Œåœ¨æ¸¬è©¦æ¡ˆä¾‹çš„æ“ä½œéç¨‹ä¸­(ä¹Ÿå°±æ˜¯ 3A ä¸­çš„ Action éšæ®µ)ï¼Œæˆ‘å€‘ä¸»è¦æ˜¯è—‰ç”±æ“ä½œå°å…ƒä»¶ä»‹é¢ä¸­çš„ï¼š</p><ul><li>data</li><li>props</li><li>slot</li><li>provide</li><li>directive</li><li>Event(ç€è¦½å™¨ä¸­çš„äº’å‹•è¡Œç‚º)</li><li>API response(æ¨¡æ“¬å›æ‡‰)</li></ul><p>ä¾†åˆ¤æ–·ä¸‹åˆ—æ˜¯å¦å¦‚æˆ‘å€‘æ‰€é æœŸï¼š</p><ul><li>DOM æ¸²æŸ“çµæœ</li><li>emit è¡Œç‚º</li></ul><h3 id=å¥½çš„å…ƒä»¶æ¸¬è©¦>å¥½çš„å…ƒä»¶æ¸¬è©¦</h3><p>ç•¶ç„¶ï¼Œåšåˆ°ä¸Šé¢çš„äº‹é …åŸºæœ¬ä¸Šå·²ç¶“å¯ä»¥ç®—æ˜¯å€‹å…ƒä»¶æ¸¬è©¦äº†ï¼Œè‹¥æˆ‘å€‘æƒ³è®“å…ƒä»¶æ¸¬è©¦å¯«å¾—æ›´å¥½ï¼Œé™¤äº†å…ˆå‰åœ¨å–®å…ƒæ¸¬è©¦æéçš„ä¸€äº›æ¦‚å¿µä¹‹å¤–ï¼Œé‚„æœ‰ä¸€äº›å€¼å¾—æ³¨æ„çš„äº‹é …ï¼š</p><p>é¦–å…ˆï¼Œåœ¨æ’°å¯«å…ƒä»¶æ¸¬è©¦æ™‚çš„è§’åº¦ï¼Œæˆ‘å€‘ä¸¦æ²’æœ‰è¦ç•¶å€‹å…¨èƒ½å…¨çŸ¥çš„ç¥ï¼Œè€Œæ˜¯ä½œç‚ºã€Œ<strong>ä½¿ç”¨è€…çš„è§’åº¦</strong>ã€é—œæ³¨å…ƒä»¶ä»‹é¢ä¸Šä¾†é æœŸçµæœï¼Œæ‰€ä»¥åœ¨æ¸¬è©¦çš„éç¨‹ä¸­æˆ‘å€‘è¦ã€Œ<strong>é¿å…åˆå¯«äº†ä¸€æ¬¡å¯¦ä½œ</strong>ã€ã€‚</p><p>å¦å¤–ï¼Œå¦‚æœå…§éƒ¨é‚è¼¯éæ–¼è¤‡é›œæ™‚ï¼Œæˆ‘å€‘å‰‡æ‡‰è©²å…ˆæŠ½å–(extract)å…¶é‚è¼¯ï¼Œé€é composables çš„å¯«æ³•ä¾†å¼•å…¥ï¼Œå¦‚æ­¤ä¸€ä¾†æˆ‘å€‘å°±èƒ½ã€Œ<strong>å°ˆæ³¨æ–¼åœ¨å…ƒä»¶æœ¬èº«çš„è¡Œç‚ºä¸Š</strong>ã€ï¼Œå¦å¤–ä¹Ÿèƒ½ã€Œ<strong>é‡å° composable çš„é‚è¼¯å–®ç¨åšæ¸¬è©¦</strong>ã€ã€‚</p><p>æœ€å¾Œï¼Œè‹¥å…ƒä»¶ä¸­æœ‰ä½¿ç”¨åˆ° API çš„éƒ¨åˆ†ï¼ŒåŒæ¨£çš„æˆ‘å€‘æ‡‰è©²æŠŠå®ƒç•¶ä½œæˆæ˜¯ä»–æä¾›çµ¦å…ƒä»¶å»ä½¿ç”¨ï¼Œè€Œå…ƒä»¶ä¸»è¦æ˜¯ã€Œ<strong>æ¥æ”¶å›æ‡‰</strong>ã€å¾Œå°±èƒ½è‡ªè¡Œè™•ç†å¾ŒçºŒçš„å…§å®¹äº†ï¼Œæ‰€ä»¥åœ¨æ¸¬è©¦ä¸Šæˆ‘å€‘æ‡‰è©²å°ˆæ³¨åœ¨ API æä¾›äº†ä»€éº¼çµ¦å…ƒä»¶ï¼Œé€éæ¨¡æ“¬è³‡æ–™çš„éƒ¨åˆ†ä¾†é”æˆå…ˆå‰æéçš„ FIRST åŸå‰‡ä¸­çš„ Fastï¼Œæœ€å¾Œæ–·è¨€å…ƒä»¶æœ€çµ‚çš„è¡Œç‚ºæ˜¯å¦å¦‚é æœŸå³å¯ã€‚</p><p>ç¾åœ¨æˆ‘å€‘çŸ¥é“ Vue Test Utils åœ¨åšä»€éº¼äº†ï¼Œä¹ŸçŸ¥é“ã€Œå…ƒä»¶æ¸¬è©¦ã€åœ¨åšä»€éº¼äº†ï¼Œä½†é€™è·Ÿå–®å…ƒæ¸¬è©¦åˆæœ‰ä»€éº¼é—œä¿‚å‘¢ï¼Ÿ</p><h3 id=å…ƒä»¶æ¸¬è©¦èˆ‡å–®å…ƒæ¸¬è©¦çš„é—œä¿‚>å…ƒä»¶æ¸¬è©¦èˆ‡å–®å…ƒæ¸¬è©¦çš„é—œä¿‚</h3><p>åœ¨å®˜æ–¹æ–‡ä»¶ä¸­<a class=link href=https://cn.vuejs.org/guide/scaling-up/testing.html#component-testing target=_blank rel=noopener>æ¸¬è©¦ç« ç¯€</a>æœ‰æåˆ°ï¼Œå…ƒä»¶æ¸¬è©¦(component testing)åœ¨é¡†ç²’åº¦ä¸Šå…¶å¯¦æ˜¯é«˜æ–¼å–®å…ƒæ¸¬è©¦(unit testing)çš„ï¼Œç”šè‡³å¯ä»¥è¢«è¦–ç‚ºæ˜¯æ•´åˆæ¸¬è©¦(integration testing)çš„ä¸€ç¨®å½¢å¼ã€‚</p><p>è€ŒåŠé–“æœ‰ä¸å°‘æ–‡ç« ç¿’æ…£ä»¥å–®å…ƒæ¸¬è©¦ä¾†çµ±ç¨±é€™ä¸€é¡æ¸¬è©¦ï¼Œæœ€ä¸»è¦åŸå› æ˜¯å–®å…ƒæ¸¬è©¦çš„å®šç¾©ç‚ºã€Œè»Ÿé«”è¨­è¨ˆã€ä¸­æœ€å°å–®ä½çš„ç¨‹å¼æˆ–è¡Œç‚ºï¼Œåœ¨ Vue å°ˆæ¡ˆä¸­ï¼Œè‹¥ä»¥ Vue SFC é¡å‹æª”æ¡ˆ(.vue)ä¾†çœ‹å…¶å¯¦æ¸¬è©¦å…ƒä»¶ä¹Ÿç®—æ˜¯æœ€å°å–®ä½æ²’éŒ¯ã€‚</p><p>æ‰€ä»¥å¾æ„ç¾©ä¸Šä¾†åŠƒåˆ†å–®å…ƒæ¸¬è©¦èˆ‡å…ƒä»¶æ¸¬è©¦ï¼ŒæŸæ–¹é¢ä¾†èªªå¾ˆå®¹æ˜“å‡ºç¾æ­§ç•°(ç”šè‡³å–®å…ƒæ¸¬è©¦æœ¬èº«å°±å·²ç¶“æœ‰åˆ†ç‚ºç¨ç«‹å‹èˆ‡ç¤¾äº¤å‹å¯«æ³•äº†)ã€‚</p><p>ç„¶è€Œç‚ºäº†æ¥ä¸‹ä¾†åœ¨æœ¬ç³»åˆ—æ–‡ä¸­æ–¹ä¾¿å€åˆ†æŒ‡çš„æ¸¬è©¦å°è±¡æ˜¯å“ªéƒ¨åˆ†ï¼Œæˆ‘å°‡åç¨±å«ç¾©åˆ†ç‚ºï¼š</p><ul><li>å…ƒä»¶æ¸¬è©¦ï¼šé‡å° Vue å…ƒä»¶æ‰€é€²è¡Œçš„æ¸¬è©¦</li><li>å–®å…ƒæ¸¬è©¦ï¼šé‡å°å…ƒä»¶å¼•å…¥å‡½å¼ã€é¡åˆ¥ç­‰ utilsã€helper èˆ‡ composable çš„æ¸¬è©¦ã€‚</li><li>å·¥å…·æœ¬èº«ï¼šPinia æ¸¬è©¦ã€Vue Router æ¸¬è©¦ã€‚</li></ul><hr><h2 id=å…ƒä»¶æ¸¬è©¦å®¹å™¨wrapper>å…ƒä»¶æ¸¬è©¦ï¼šå®¹å™¨(Wrapper)</h2><h3 id=mount>mount</h3><p>ç•¶æˆ‘å€‘éœ€è¦åœ¨æ¸¬è©¦æ¡ˆä¾‹ä¸­å¼•å…¥å…ƒä»¶æ™‚ï¼Œæˆ‘å€‘å¯ä»¥é€é Vue Test Utils æä¾›çš„æ–¹æ³• <code>mount</code> ä¾†åŒ…è£¹ Vue å…ƒä»¶ã€‚è€Œ <code>mount</code> æ‰€è¿”å›çš„å…§å®¹é™¤äº† Vue å¯¦é«”ä¹‹å¤–ï¼Œé‚„åŒ…å«äº†ä¸€äº›æ–¹æ³•ï¼ˆWrapper methodsï¼‰å¯ä»¥è®“æˆ‘å€‘æ“ä½œå…ƒä»¶ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>component</span> <span class=nx>from</span> <span class=s1>&#39;@/component/BaseButton.vue&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should emit clicked event after clicking button&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Arrange
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Act
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>wrapper</span><span class=p>.</span><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Assert
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>export</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>emitted</span><span class=p>()).</span><span class=nx>toHaveProperty</span><span class=p>(</span><span class=s1>&#39;clicked&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å‡è‹¥æˆ‘å€‘å¸Œæœ›åœ¨æ¸²æŸ“å…ƒä»¶çš„æ™‚å€™åŒæ™‚å¸¶è‘—é è¨­åƒæ•¸èˆ‡ç‹€æ…‹æ™‚ï¼ˆå¦‚ <code>props</code>ã€<code>slots</code>&mldr;ç­‰ï¼‰ï¼Œå°±èƒ½å¤ é€é <code>mount</code> æ–¹æ³•çš„ç¬¬äºŒå€‹åƒæ•¸å‚³å…¥è¨­å®šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>content</span><span class=o>:</span> <span class=s1>&#39;Hello, Props!&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mounted</span><span class=p>(</span><span class=nx>component</span><span class=p>,</span> <span class=nx>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;Hello, Props!&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>è€Œé—œæ–¼æ–¹æ³•ï¼ˆWrapper methodsï¼‰èˆ‡é¸é …ï¼ˆWrapper optionsï¼‰çš„éƒ¨åˆ†ï¼Œæœƒæ ¹æ“šå…ƒä»¶ä½¿ç”¨ <strong>Options API</strong> / <strong>Composition API</strong> / <strong>setup script</strong> èªæ³•ç³– è€Œæœ‰ä¸åŒçš„ç”¨æ³•èˆ‡é™åˆ¶ï¼Œå› æ­¤ä½¿ç”¨æ–¹æ³•èˆ‡å·®ç•°çš„éƒ¨åˆ†å°‡åœ¨å¾ŒçºŒæ¸¬è©¦å„ç¨®å…ƒä»¶æ™‚é™¸çºŒæœƒæåˆ°ã€‚</p></blockquote><h3 id=shallowmount>shallowMount</h3><p>åœ¨æ­£å¸¸çš„å°ˆæ¡ˆé–‹ç™¼ä¸‹ï¼Œå…ƒä»¶æ™‚å¸¸æœƒåµŒå…¥äº†å¦ä¸€å€‹å…ƒä»¶ï¼š</p><h5 id=rootcomponentvue>RootComponent.vue</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>ParentComponent</span><span class=p>&gt;&lt;/</span><span class=nt>ParentComponent</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=parentcomponentvue>ParentComponent.vue</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>ChildComponent</span><span class=p>&gt;&lt;/</span><span class=nt>ChildComponent</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>ChildComponent</span><span class=p>&gt;&lt;/</span><span class=nt>ChildComponent</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>ChildComponent</span><span class=p>&gt;&lt;/</span><span class=nt>ChildComponent</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=childcomponentvue>ChildComponent.vue</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>baby</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>RootComponent çš„å…ƒä»¶æ¸¬è©¦ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>component</span> <span class=nx>from</span> <span class=s1>&#39;./RootComponent.vue&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should render corrent content&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>html</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;p&gt;baby&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;p&gt;baby&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;p&gt;baby&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>  `</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½†å¦‚æ­¤ä¸€ä¾†è‹¥æˆ‘å€‘åœ¨æ¸¬è©¦ RootComponent å…ƒä»¶çš„æ™‚å€™ï¼Œå°±æœ‰å¯èƒ½å› ç‚ºåº•ä¸‹çš„ ChildComponent å…ƒä»¶æ›´æ”¹äº†å…§å®¹å°è‡´ RootComponent æ¸¬è©¦æ¡ˆä¾‹ä¹Ÿè·Ÿè‘—å¤±æ•—ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>baby</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>è‹¥ã€Œæœ‰æ„ã€æƒ³è¦é¿å…é€™ç¨®æƒ…æ³ç™¼ç”Ÿï¼Œæ­¤æ™‚å°±å¯ä»¥å°‡ <code>mount</code> æ›¿æ›æ‰ï¼Œæ”¹ä½¿ç”¨ <code>shallowMount</code> ä¾†ä½œç‚ºå®¹å™¨ä½¿ç”¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>component</span> <span class=nx>from</span> <span class=s1>&#39;./RootComponent.vue&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should render corrent content&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>shallowMount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p><code>shallowMount</code> èˆ‡ <code>mount</code> åœ¨ä½¿ç”¨ä¸Šå¹¾ä¹å¤§åŒå°ç•°ï¼Œè€Œå”¯ä¸€æœ‰å·®åˆ¥åœ¨æ–¼ä»–æœƒå°‡åŸå…ˆå…§éƒ¨æœ‰ç”¨åˆ°å…ƒä»¶çš„éƒ¨åˆ†ä»¥æ›¿æ›ç‚ºä¸€å€‹æ¨¡æ“¬å…ƒä»¶ï¼ˆstub componentï¼‰ï¼Œä¸¦ä¸”å‘½åæ”¹ä»¥çƒ¤è‚‰ä¸²å‘½åæ³•ï¼ˆ<code>Kebab case</code>ï¼‰ä¸¦ä¸”åœ¨æœ€æœ«ç«¯åŠ ä¸Š <code>-stub</code> ä¾›è¾¨è­˜ï¼š</p><h5 id=rootcomponentvue-1>RootComponent.vue</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>ParentComponent</span><span class=p>&gt;&lt;/</span><span class=nt>ParentComponent</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ç¶“ shallowMount æ¸²æŸ“çµæœè®Šæˆï¼š</p><h5 id=rootcomponentvue-2>RootComponent.vue</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>parent-component-stub</span><span class=p>&gt;</span><span class=o>&lt;</span><span class=err>/parent-component-stub&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æ­¤ä¸€ä¾†åœ¨æ’°å¯«æ¸¬è©¦æ¡ˆä¾‹æ™‚ï¼Œå°±å¯ä»¥é—œæ³¨åœ¨ç•¶ä¸‹ã€Œ<strong>çˆ¶å±¤å…ƒä»¶</strong>ã€èˆ‡ã€Œ<strong>å­å±¤å…ƒä»¶</strong>ã€çš„ä¹‹é–“çš„å…§å®¹ï¼Œè€Œä¸ç®¡ã€Œ<strong>å­å±¤å…ƒä»¶</strong>ã€åº•ä¸‹æ‰€ç™¼ç”Ÿçš„äº‹æƒ…ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>component</span> <span class=nx>from</span> <span class=s1>&#39;./RootComponent.vue&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should render corrent content&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>shallowMount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>html</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=sb>`&lt;parent-component-stub&gt;&lt;/parent-component-stub&gt;`</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=å®¹å™¨çš„æ–¹æ³•wrapper-methods---é¸æ“‡å™¨>å®¹å™¨çš„æ–¹æ³•ï¼ˆWrapper methodsï¼‰ - é¸æ“‡å™¨</h2><p>åœ¨é€²è¡Œæ¸¬è©¦æ™‚ï¼Œå‰é¢ç« ç¯€æœ‰æåˆ°æˆ‘å€‘æœƒä½¿ç”¨ <code>mount</code> æˆ– <code>shallowMount</code> ä¾†åŒ…è£¹å…ƒä»¶ï¼Œå¾è€Œå¾—åˆ°ä¸€å€‹ <code>VueWrapper</code>ï¼Œè€Œåœ¨é€™å€‹ <code>VueWrapper</code> è£¡é ­æœ‰è¨±å¤šå¯¦ç”¨çš„å®¹å™¨æ–¹æ³•ï¼ˆWrapper methodsï¼‰ï¼Œé›–ç„¶å®˜æ–¹æ–‡ä»¶ä¸­ä¸¦æ²’æœ‰ç‰¹æ„åˆ†é¡ï¼Œä½†å¤§æ„ä¸Šå¯åˆ†ç‚ºå¹¾ç¨®æ–¹æ³•ï¼š</p><ul><li>æŸ¥è©¢ã€é¸æ“‡æŒ‡å®šçš„å…ƒç´ ã€å…ƒä»¶ç­‰é¸æ“‡å™¨</li><li>å–å¾—ç›®æ¨™å±¬æ€§æˆ–å…§å®¹ï¼ˆclass, attributeï¼‰</li><li>è§¸ç™¼ DOM äº‹ä»¶ï¼ˆå¦‚æ»‘é¼ é»æ“Šã€éµç›¤è¼¸å…¥èˆ‡æŒ‰éµâ‹¯â‹¯ç­‰ï¼‰</li><li>å–å¾— emit äº‹ä»¶ã€è¨­ç½® data æˆ– propã€ç”šè‡³è§¸ç™¼å…ƒä»¶ <code>unmmount</code> ç­‰ Vue API ç›¸é—œçš„æ–¹æ³•</li></ul><p>é€™é‚Šè‘—é‡åœ¨æ–¼ä»‹ç´¹é¸æ“‡å™¨çš„æ–¹æ³•ä½¿ç”¨èˆ‡æ¸¬è©¦æ‡‰ç”¨ï¼Œæœ€å¾Œè£œä¸Šç›¸é—œçš„è¨è«–ï¼š</p><ul><li>å…ƒç´ ã€å…ƒä»¶é¸æ“‡å™¨</li><li>åˆ¤æ–·ç›®æ¨™æ˜¯å¦å­˜åœ¨ï¼š<code>exists</code> èˆ‡ <code>isVisible</code></li><li>ä½¿ç”¨ <code>data-* attribute</code></li></ul><h3 id=é¸æ“‡å™¨>é¸æ“‡å™¨</h3><p>åœ¨é€²è¡Œå…ƒä»¶æ¸¬è©¦ï¼ˆcomponent testingï¼‰çš„éç¨‹ä¸­ï¼Œæœ‰æ™‚æˆ‘å€‘å¯èƒ½åªæƒ³é—œæ³¨åœ¨æŸå€‹ç‰¹å®š DOM æˆ–å…ƒä»¶çš„ç›¸é—œè³‡è¨Šæ™‚ï¼Œé€™æ™‚æˆ‘å€‘å°±å¯ä»¥é€éå®¹å™¨ä¸­çš„é¸æ“‡å™¨æ–¹æ³•ä¾†å°‹æ‰¾ï¼Œè€Œé¸æ“‡å™¨æ ¹æ“šé¸å–å°è±¡çš„ä¸åŒï¼Œä¸»è¦åˆ†ç‚ºï¼š</p><ul><li>å…ƒç´ ï¼ˆelementï¼‰é¸æ“‡å™¨</li><li>å…ƒä»¶ï¼ˆcomponentï¼‰é¸æ“‡å™¨</li></ul><h4 id=å…ƒç´ é¸æ“‡å™¨>å…ƒç´ é¸æ“‡å™¨</h4><p>å…ƒç´ é¸æ“‡å™¨èªæ³•åŸºæœ¬ä¸Šæœ‰å…©ç¨®å¯«æ³•ï¼Œä¸€ç¨®æ˜¯åŸºæ–¼å…ƒç´ çš„ <code>refs</code>ï¼Œå¦ä¸€ç¨®å‰‡æ˜¯ <code>querySelector</code>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>ref</span><span class=o>=</span><span class=s>&#34;dogcat&#34;</span><span class=p>&gt;</span><span class=o>???</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;dog&#34;</span><span class=p>&gt;</span><span class=nx>ç§‘åŸº</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;cat&#34;</span><span class=p>&gt;</span><span class=nx>æ©˜è²“</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;cat&#34;</span><span class=p>&gt;</span><span class=nx>é»‘é»‘</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=cm>/* ref */</span>
</span></span><span class=line><span class=cl><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span> <span class=nx>ref</span><span class=o>:</span> <span class=s1>&#39;span&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/* querySelector */</span>
</span></span><span class=line><span class=cl><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;#dog&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.cat&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œå®¹å™¨æ–¹æ³•æœ‰é—œé¸å–å…ƒç´ çš„é¸æ“‡å™¨ä¸€å…±åˆ†ç‚ºä¸‰ç¨®ï¼š</p><ul><li>find</li><li>findAll</li><li>get</li></ul><p>é€™ä¸‰ç¨®é¸æ“‡å™¨åœ¨é¸å–åˆ°ç›®æ¨™å¾Œä¸»è¦éƒ½æ˜¯è¿”å› <code>DOMWrapper</code>ï¼Œæ­¤æ™‚æˆ‘å€‘å°±å¯ä»¥åœ¨ä¸²é€£å…¶ä»–å®¹å™¨æ–¹æ³•ï¼ˆWrapper methodsï¼‰å¦‚ <code>classes</code> æˆ– <code>text</code> ç­‰ç­‰ä¾†å–å¾—å±¬æ€§æˆ–å…§å®¹è³‡è¨Šï¼Œåªæ˜¯è¿”å›çš„çµæœå…§å®¹æœƒæœ‰äº›å·®ç•°ã€‚</p><p>æ¯”æ–¹ <code>find</code>ã€<code>findAll</code> çš„éƒ¨åˆ†ä¸»è¦å·®åˆ¥åœ¨æ–¼ <code>findAll</code> è¿”å›çš„å…§å®¹æœƒè¢«æ”¾ç½®æ–¼é™£åˆ—ç•¶ä¸­ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;dog&#34;</span><span class=p>&gt;</span><span class=nx>ç§‘åŸº</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;cat&#34;</span><span class=p>&gt;</span><span class=nx>æ©˜è²“</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;cat&#34;</span><span class=p>&gt;</span><span class=nx>é»‘é»‘</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œæˆ‘å€‘å¯ä»¥é€éåƒé€™æ¨£çš„æ–¹å¼å–å¾—é™£åˆ—å…§çš„è³‡è¨Šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should be display correct content&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>target</span><span class=o>=</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;#dog&#39;</span><span class=p>)</span> <span class=c1>// &lt;DOMWrapper&gt; 
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;ç§‘åŸº&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should be display correct content&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>target</span><span class=o>=</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>findAll</span><span class=p>(</span><span class=s1>&#39;.cat&#39;</span><span class=p>)</span> <span class=c1>// &lt;DOMWrapper&gt;[]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;æ©˜è²“&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;é»‘é»‘&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>æ³¨æ„ï¼šé€é findAll æ–·è¨€æ™‚æ˜¯ã€Œ<strong>æœ‰åº</strong>ã€çš„ï¼Œå¾ˆå®¹æ˜“å—åˆ°é †åºæ”¹è®Šè€Œå°è‡´æ¸¬è©¦æ¡ˆä¾‹å¤±æ•—ï¼Œé™¤éæ’°å¯«æ¸¬è©¦æ¡ˆä¾‹ç›®æ¨™ä¹‹ä¸€å°±æ˜¯è¦ç¢ºä¿é †åºä¸æœƒèª¿å‹•ï¼Œå¦å‰‡æ”¹ç”¨ find æ–·è¨€æœƒæ¯”è¼ƒä¸å®¹æ˜“å—å½±éŸ¿ã€‚</p></blockquote><p>è€Œ <code>find</code> èˆ‡ <code>get</code> çš„å·®åˆ¥åœ¨æ–¼ <code>find</code> æ‰¾ä¸åˆ°ç›®æ¨™æ™‚è¿”å›çš„æ˜¯ <code>{}</code> å¾ŒçºŒè‹¥ä»ç¹¼çºŒæ“ä½œã€æ–·è¨€æ™‚æ‰æœƒç”±æ‹‹å‡ºéŒ¯èª¤ï¼ˆç”± <code>ErrorWrapper</code> æä¾›ï¼‰ï¼›ç„¶è€Œ <code>get</code> ä¸€é–‹å§‹è‹¥æ‰¾ä¸åˆ°ç›®æ¨™æ™‚å°±ç›´æ¥æ‹‹å‡ºéŒ¯èª¤ï¼ˆ<code>throw Error</code>ï¼‰äº†ã€‚</p><p>æ ¹æ“š <a class=link href=https://github.com/vuejs/test-utils/blob/f61b8aeb84352b29e29666326939531cd81c3bd6/src/errorWrapper.ts target=_blank rel=noopener>ErrorWrapper åŸå§‹ç¢¼</a>ï¼Œå¯ä»¥çœ‹è¦‹ä»–ä¸»è¦æ˜¯é‡å°å®¹å™¨æ–¹æ³•ä¸­çš„ <code>exists()</code> æœƒè¿”å› <code>false</code>ã€‚</p><p>å› æ­¤åœ¨é‡å°æ‰¾ä¸åˆ°å…ƒç´ çš„æ¸¬è©¦æ¡ˆä¾‹åˆæ³•çš„å¯«æ³•å¯ä»¥é€™éº¼åšï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;.something-that-does-not-exist&#39;</span><span class=p>)).</span><span class=nx>toThrowError</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.something-that-does-not-exist&#39;</span><span class=p>).</span><span class=nx>exists</span><span class=p>()).</span><span class=nx>toBeFalsy</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=find-åˆ¤æ–·å…ƒç´ é™·é˜±>find åˆ¤æ–·å…ƒç´ é™·é˜±</h4><p>é­”é¬¼è—åœ¨ç´°ç¯€è£¡ï¼Œæˆ–è¨±ä½ å¯èƒ½æœƒæƒ³èªªç‚ºä»€éº¼ä¸ç›´æ¥ç”¨ <code>find</code> é‚„è¦å†å¦å¤–é€é <code>exists</code> åˆ¤æ–·å‘¢ï¼Œè®“æˆ‘å€‘çœ‹çœ‹ä¸€å€‹æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>ç„¡é—œç·Šè¦çš„æ±è¥¿</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœé€™æ™‚ä½ é€™éº¼å¯«äº†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.something-that-does-not-exist&#39;</span><span class=p>)).</span><span class=nx>toBeTruthy</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1>// é€šé ï¼ï¼Ÿ
</span></span></span></code></pre></td></tr></table></div></div><p>åŸå› åœ¨æ–¼ <code>find</code> åœ¨æ‰¾ä¸åˆ°çš„æƒ…æ³ä¸‹ç›®æ¨™çš„æƒ…æ³æ‰€è¿”å›çš„å€¼æœƒæ˜¯ <code>ErrorWrapper</code> ç‰©ä»¶ï¼Œæ‰€ä»¥é€é <code>toBeTruthy</code> æ–·è¨€å°±æœƒé€šéã€‚</p><blockquote><p>è€Œç‚ºäº†é¿å…é€™ç¨®æƒ…æ³ç™¼ç”Ÿï¼Œå®˜æ–¹æ–‡ä»¶å…¶å¯¦åªæœ‰è¼•ææ·¡è¿°åœ°èªªé“ï¼š</p><blockquote><p><strong>As a rule of thumb</strong>, always use get except when you are asserting something doesn&rsquo;t exist. In that case use find.<br>ä½†ä¸Šæ–¹ç¶“é©—è€ƒé‡åœ¨å“ªï¼Œåªæœ‰åœ¨è¿½äº†ä»–å€‘ç›¸é—œçš„ <a class=link href=https://github.com/vuejs/test-utils/issues/138 target=_blank rel=noopener>issue</a> æ‰æœƒé€æ¼¸æ˜ç™½è€ƒé‡çš„æ ¹æ“šï¼Œè€Œé—œæ–¼é€™éƒ¨åˆ†ï¼Œç”šè‡³é–‹ç™¼åœ˜éšŠæœªä¾†å¯èƒ½ä¹Ÿæœƒè€ƒæ…®å°‡ find æ–¹æ³•çµ¦æ‹”æ‰ï¼Œå‰©ä¸‹ exists æœ¬èº«ï¼Œä½†ç¤™æ–¼é€™æœƒæ˜¯å€‹ breaking change çš„åšæ³•ï¼Œæ‰€ä»¥åœ¨ vue-test-utils è·³å¤§ç‰ˆæœ¬è™Ÿä¹‹å‰æ‡‰è©²éƒ½æœƒæš«æ™‚ç¶­æŒåŸæ¨£ã€‚</p></blockquote></blockquote><h4 id=å…ƒä»¶componenté¸æ“‡å™¨>å…ƒä»¶ï¼ˆcomponentï¼‰é¸æ“‡å™¨</h4><ul><li>findComponent</li><li>findAllfindComponents (æ³¨æ„æœ‰å€‹ sï¼‰</li><li>getComponent</li></ul><p>åŸå‰‡ä¸Šä½¿ç”¨æ–¹å¼èˆ‡å…ƒç´ é¸æ“‡å™¨å·®ä¸å¤šï¼Œåªæ˜¯é¸å–èªæ³•ä¸Šé™¤äº† <code>refs</code> èˆ‡ <code>querySelector</code> èªæ³•ä¹‹å¤–ï¼Œé‚„å¤šäº†ï¼š</p><ul><li>Component nameï¼š <code>findComponent({name: 'å…ƒä»¶åç¨±'})</code></li><li>å°‡ import SFC ç›´æ¥æ”¾å…¥æ–¹æ³•ä¸­ï¼š <code>findComponent(Component)</code></li></ul><p>ä½†ç”±æ–¼ä½¿ç”¨ <code>querySelector</code> ä¸Šä¹Ÿæœ‰ä¸€äº›<a class=link href=https://test-utils.vuejs.org/api/#findcomponent target=_blank rel=noopener>å°é™·é˜±</a>ï¼Œæ‰€ä»¥å€‹äººå»ºè­°ä»¥ SFC æ–¹å¼å¼•å…¥æˆ–æ˜¯ä¹¾è„†é€é <code>shallowMount</code> å°‡å­å±¤å…ƒä»¶ stub æ‰ä¹Ÿæ˜¯ä¸€ç¨®æ–¹å¼ã€‚</p><h3 id=åˆ¤æ–·ç›®æ¨™å­˜åœ¨>åˆ¤æ–·ç›®æ¨™å­˜åœ¨</h3><p>ç¶“ç”±å‰›å‰›é™·é˜±çš„éƒ¨åˆ†å¤§å®¶æ‡‰è©²éƒ½å¾ˆæ¸…æ¥š <code>exists()</code> çš„å­˜åœ¨äº†ï¼Œè€Œåˆ¤æ–·é¸å–ç›®æ¨™å…¶å¯¦ä»–é‚„æœ‰å€‹å¥½æœ‹å‹å°±æ˜¯ <code>isVisible()</code>ï¼Œä½†ä»–å€‘åˆ¤æ–·å­˜åœ¨çš„å®šç¾©ä¸Šæœ‰ä¸€äº›å·®åˆ¥ï¼š</p><ul><li>exists()ï¼šä¸»è¦åˆ¤æ–·çš„æ˜¯è©²ç›®æ¨™å­˜ä¸å­˜åœ¨ DOM ä¸Šï¼š</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>Hello</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=nx>exist</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>Component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;p&#39;</span><span class=p>).</span><span class=nx>exists</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;span&#39;</span><span class=p>).</span><span class=nx>exists</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>isVisable()ï¼šä¸»è¦åˆ¤æ–·çš„æ˜¯è©²ç›®æ¨™å­˜åœ¨ DOM ä¸Šä¹‹å¤–ï¼Œè¦–è¦ºä¸Šæœ‰ç„¡é¡¯ç¤ºåœ¨ç•«é¢ä¸­ï¼š</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=nt>v-if</span><span class=s>=&#34;false&#34; class=&#34;dog&#34;&gt;ç§‘åŸº&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>  &lt;p v-show=&#34;true&#34; class=&#34;orange-cat&#34;&gt;æ©˜è²“&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>  &lt;p v-show=&#34;false&#34; class=&#34;black-cat&#34;</span><span class=p>&gt;</span><span class=err>é»‘é»‘</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;v-if false&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.dog&#39;</span><span class=p>).</span><span class=nx>isVisible</span><span class=p>()).</span><span class=nx>toBeFalsy</span><span class=p>()</span> <span class=c1>// Errorï¼š ç›´æ¥å™´éŒ¯
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;v-show true&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.orange-cat&#39;</span><span class=p>).</span><span class=nx>isVisible</span><span class=p>()).</span><span class=nx>toBeTruthy</span><span class=p>()</span> <span class=c1>// æ¸¬è©¦é€šé
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;v-show false&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.black-cat&#39;</span><span class=p>).</span><span class=nx>isVisible</span><span class=p>()).</span><span class=nx>toBeFalsy</span><span class=p>()</span> <span class=c1>// æ¸¬è©¦é€šé
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>é—œæ–¼ <code>isVibile</code> æ›´ç‚ºè©³ç´°çš„åˆ¤æ–·å¦‚ä¸‹ï¼š</p><ul><li>CSS style ä¸­ å«æœ‰ display: none => <code>false</code></li><li>CSS style ä¸­ å«æœ‰ visibility: hidden => <code>false</code></li><li>CSS style ä¸­ å«æœ‰ opacity :0 => <code>false</code></li><li>å…ƒç´ ä¸­ hidden å±¬æ€§ç‚º true => <code>false</code></li></ul><p>ç¶œåˆçµè«–ä¸Šæ–¹é™·é˜±èˆ‡åˆ¤æ–·æ–¹æ³•ï¼š</p><ul><li>è‹¥è¦åˆ¤æ–·å…ƒç´ æ˜¯å¦å­˜åœ¨ æˆ– <code>v-if</code>ï¼šä½¿ç”¨ <code>get</code> æ–¹æ³•æ˜¯æœ€ä¿éšªçš„ï¼ŒçœŸçš„è¦ç”¨ <code>find</code> å‰‡ä¸€å®šè¦æ­é… <code>exists</code></li><li>è‹¥è¦åˆ¤æ–· <code>v-show</code>ï¼šä½¿ç”¨ <code>find().isVisible()</code></li></ul><h3 id=ä½¿ç”¨-data--attribute>ä½¿ç”¨ data-* attribute</h3><p>åœ¨æ’°å¯«æ¸¬è©¦æƒ…å¢ƒæ™‚ï¼Œè‹¥ä¾ç…§ä¸Šé¢çš„ <code>querySelector</code> é¸äº†å…ƒç´ ã€id æˆ– class æ™‚ï¼ŒåˆæœŸä¸€å®šæœƒå¾ˆé–‹å¿ƒï¼Œå› ç‚ºä¸æœƒé‡åˆ°å¤ªå¤šå›°é›£ï¼Œä½†å¾€å¾Œåœ¨é–‹ç™¼çš„éç¨‹åŸ·è¡Œæ¸¬è©¦æ™‚å°±å¾ˆå®¹æ˜“æœ‰æ©Ÿæœƒé‡åˆ°å„ç¨®å•é¡Œã€‚</p><p>åŸå…ˆï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;content&#34;</span><span class=p>&gt;</span><span class=nx>content</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>æ”¹æˆï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;content&#34;</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>content</span><span class=err>&#34;</span><span class=p>&gt;</span><span class=nx>content</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨ <code>data-*</code> ä½œç‚ºé¸æ“‡ç›®æ¨™å¥½è™•æœ€ä¸»è¦åœ¨æ–¼é¡¯è‘—æ¨™è¨˜æ¸¬è©¦å…§å®¹ï¼Œè€Œé€™å½±éŸ¿åˆ°çš„ç¯„åœæœ‰ï¼š</p><ul><li>é–‹ç™¼æœŸï¼Œéç¨‹ä¸ç”¨æ“”å¿ƒæœƒå½±éŸ¿åˆ°æ¸¬è©¦ï¼Œå¦‚ä¸Šæ–¹æ‰€è¦‹ï¼Œæˆ‘åªè¦è®Šæ›´ data-test ä»¥å¤–çš„å…§å®¹ï¼Œé æœŸæ‡‰è©²ä¸æœƒå½±éŸ¿åˆ°æ¸¬è©¦é¸æ“‡çš„ç›®æ¨™ï¼Œä½¿æ¸¬è©¦æ¡ˆä¾‹éŒ¯èª¤èƒ½æ›´å°ˆæ³¨åœ¨æ–·è¨€çš„ç›®æ¨™ä¸Šï¼Œè€Œéé¸æ“‡ç›®æ¨™è¢«æ›¿æ›å°è‡´çš„éŒ¯èª¤ã€‚</li><li>é‡æ§‹ï¼ˆrefactorï¼‰éç¨‹ï¼Œèƒ½æ¸…æ¥šæ¯”è¼ƒç¯„åœï¼Œè‹¥å°‡ä¾†èª¿æ•´çµæ§‹ï¼Œåªè¦å°‡å±¬æ€§è½‰ç§»åˆ°å°æ‡‰çš„ä½ç½®å³å¯ã€‚</li><li>ç”Ÿç”¢æœŸï¼Œèƒ½å¤ é‡å°ç‰¹å®šçš„å±¬æ€§ç§»é™¤ï¼Œé¿å…ç•™ä¸‹å„ç¨®æ¸¬è©¦ç—•è·¡ï¼Œå°æ–¼åƒæ˜¯è¼”åŠ©é–±è®€è£ç½®ç­‰æŠ€è¡“ä¾†èªªå°±ä¸æœƒè¢«å½±éŸ¿åˆ°ã€‚</li></ul><h4 id=åœ¨ç”Ÿç”¢ç’°å¢ƒåˆªé™¤-data--attribute>åœ¨ç”Ÿç”¢ç’°å¢ƒåˆªé™¤ data-* attribute</h4><p>è‹¥æƒ³åœ¨ <code>vitest</code> ä¸­ç§»é™¤ <code>data-*</code> ä¹Ÿéå¸¸çš„ç°¡å–®ï¼Œæˆ‘å€‘åªéœ€è¦åœ¨ <code>vite.config.js</code> è¨­å®šä¸­ï¼Œé‡å° Vue åº•ä¸‹çš„ç·¨è­¯é¸é …åšä¸€äº›èª¿æ•´å³å¯ï¼ˆåº•ä¸‹ç¤ºç¯„çš„ç‰ˆæœ¬ç‚ºç§»é™¤ <code>data-test</code>ï¼Œè‹¥ä½¿ç”¨å…¶ä»–å‘½åè«‹è‡ªè¡Œèª¿æ•´å›‰ï¼‰ï¼š</p><h5 id=viteconfigjs-2>vite.config.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>isProd</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>NODE_ENV</span> <span class=o>===</span> <span class=s1>&#39;production&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>removeDataTestAttrs</span> <span class=o>=</span> <span class=p>(</span><span class=nx>node</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>NodeTypes</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>freeze</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>ELEMENT</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>ATTRIBUTE</span><span class=o>:</span> <span class=mi>6</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>node</span><span class=p>.</span><span class=nx>type</span> <span class=o>===</span> <span class=nx>NodeTypes</span><span class=p>[</span><span class=s1>&#39;ELEMENT&#39;</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>node</span><span class=p>.</span><span class=nx>props</span> <span class=o>=</span> <span class=nx>node</span><span class=p>.</span><span class=nx>props</span><span class=p>.</span><span class=nx>filter</span><span class=p>((</span><span class=nx>prop</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>(</span><span class=nx>prop</span><span class=p>.</span><span class=nx>type</span> <span class=o>===</span> <span class=nx>NodeTypes</span><span class=p>[</span><span class=s1>&#39;ATTRIBUTE&#39;</span><span class=p>]</span> <span class=o>?</span> <span class=nx>prop</span><span class=p>.</span><span class=nx>name</span> <span class=o>!==</span> <span class=s1>&#39;data-test&#39;</span> <span class=o>:</span> <span class=kc>true</span><span class=p>))</span> <span class=c1>// è«‹è‡ªè¡Œæ›¿æ›å‘½å data-test 
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=nx>defineConfig</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>plugins</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=nx>vue</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>template</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>compilerOptions</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>nodeTransforms</span><span class=o>:</span> <span class=nx>isProd</span> <span class=o>?</span> <span class=p>[</span><span class=nx>removeDataTestAttrs</span><span class=p>]</span> <span class=o>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>          <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=å®¹å™¨çš„æ–¹æ³•wrapper-methods---å–å¾—ç›®æ¨™è³‡è¨Š>å®¹å™¨çš„æ–¹æ³•(Wrapper methods) - å–å¾—ç›®æ¨™è³‡è¨Š</h2><h3 id=åˆ¤æ–·å±¬æ€§>åˆ¤æ–·å±¬æ€§</h3><h4 id=attributes>attributes</h4><p>ç•¶ä½ æƒ³è¦ç¢ºèª <code>&lt;a></code> ä¸­çš„ <code>href</code> æ˜¯å¦å¸¶æœ‰æŒ‡å®šçš„é€£çµæˆ–æ˜¯æª¢æŸ¥ <code>&lt;img></code> ä¸Šçš„å±¬æ€§æ™‚ï¼Œé€™æ™‚å°±å¯ä»¥é€é <code>attributes</code> å–å¾—å±¬æ€§ã€‚</p><p>è€Œ <code>attributes</code> ç”¨æ³•ä¸»è¦æœ‰å…©ç¨®ï¼Œç›´æ¥ä½¿ç”¨æ™‚æœƒç²å–ç›®æ¨™ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>a</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>link</span><span class=err>&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://ithelp.ithome.com.tw/&#34;</span> <span class=na>target</span><span class=o>=</span><span class=s>&#34;_blank&#34;</span><span class=p>&gt;</span><span class=nx>ithelp</span><span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;link&#34;]&#39;</span><span class=p>).</span><span class=nx>attributes</span><span class=p>()</span> <span class=c1>// { href: &#39;https://ithelp.ithome.com.tw/&#39;, &#39;target&#39;: &#39;_blank&#39; }
</span></span></span></code></pre></td></tr></table></div></div><p>ç•¶æƒ³è¦ç›´æ¥å–å¾—ç‰¹å®šå±¬æ€§å€¼æ™‚ä¹Ÿå¯ä»¥ç›´æ¥å°‡å±¬æ€§åç¨±å¸¶å…¥åƒæ•¸ä¸­ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>).</span><span class=nx>attributes</span><span class=p>(</span><span class=s1>&#39;target&#39;</span><span class=p>)</span> <span class=c1>// &#39;_blank&#39;
</span></span></span></code></pre></td></tr></table></div></div><h4 id=classes>classes</h4><p>åŒæ¨£çš„ï¼Œè‹¥æƒ³è¦å°‹æ‰¾ <code>class</code> å±¬æ€§çš„è©±å¯ä»¥é€é <code>classes</code> èªæ³•å–å¾—è³‡è¨Šã€‚ä½ å¯èƒ½æœƒç›´è¦ºåœ°æƒ³åˆ° <code>class</code> ä¹Ÿæ˜¯å±¬æ€§çš„ä¸€ç¨®é‚£æ‡‰è©²ç”¨ <code>attributes('class')</code> æŸ¥è©¢ï¼Œç„¶è€Œé€™å…©è€…çš„å·®åˆ¥æœ€ä¸»è¦åœ¨æ–¼ç”¢å‡ºçš„çµæœæœƒæœ‰æ‰€ä¸åŒã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>section</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>wrap</span><span class=err>&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container w-full h-full&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>Title</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>section</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>è‹¥ä½¿ç”¨ <code>attributes('class')</code> æŸ¥è©¢çµæœå°‡æœƒæ˜¯å­—ä¸²å½¢å¼çš„è³‡æ–™ï¼Œå¾ŒçºŒè¦è™•ç†æ¯”å°ä¸Šçš„å•é¡Œæœƒç¨å¾®éº»ç…©ä¸€é»ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;wrap&#34;]&#39;</span><span class=p>).</span><span class=nx>attributes</span><span class=p>(</span><span class=s1>&#39;class&#39;</span><span class=p>)</span> <span class=c1>// &#34;container w-full h-full&#34;
</span></span></span></code></pre></td></tr></table></div></div><p>è‹¥æ˜¯ä½¿ç”¨ <code>classes</code> èªæ³•æŸ¥è©¢çš„è©±å°‡å¾—åˆ°ä¸€å€‹é™£åˆ—çš„çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;wrap&#34;]&#39;</span><span class=p>).</span><span class=nx>classes</span><span class=p>()</span> <span class=c1>// [&#34;container&#34;, &#34;w-full&#34;, &#34;h-full&#34;]
</span></span></span></code></pre></td></tr></table></div></div><p>æ­¤æ™‚å°±å¯ä»¥é…åˆ <code>toContain</code> ç­‰é™£åˆ—çš„æ–·è¨€ Matcher å¿«é€Ÿè™•ç†æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;wrap&#34;]&#39;</span><span class=p>).</span><span class=nx>classes</span><span class=p>()).</span><span class=nx>toContain</span><span class=p>(</span><span class=s1>&#39;container&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>é€™å°æ–¼æ¸¬è©¦æ¨£å¼æ¡ç”¨åŸå­åŒ–è¨­è¨ˆçš„å·¥å…·ï¼ˆTailwind CSSã€Windi CSS ç­‰ï¼‰æœ‰å¥‡æ•ˆï¼Œæˆ‘å€‘å¯ä»¥å°‡è¦–è¦ºå±¤çš„é‚è¼¯é€é <code>classes</code> çš„çµæœæ–·è¨€ã€‚</p><p>å› ç‚ºé€™é¡åŸå­åŒ–è¨­è¨ˆå·¥å…·å¾€å¾€ä¾è³´ <code>class</code> å±¬æ€§ä¾†åšæ¨£å¼ä¸Šçš„èª¿æ•´èˆ‡æ“´å……ï¼Œé€šå¸¸ç‚ºäº†ç¾è§€èˆ‡ç®¡ç†æ–¹ä¾¿æœƒé †ä¾¿åœ¨ä½¿ç”¨é€™é¡å·¥å…·æ™‚åŠ è£è‡ªå‹•æ’åºï¼ˆsortingï¼‰ <code>class</code> å±¬æ€§ç­‰æ“´å……å·¥å…·ï¼Œå› æ­¤ <code>class</code> çš„é †åºå°‡è®Šæˆä¸ç©©å®šçš„ç‹€æ…‹ã€‚</p><p>å› æ­¤å…ƒç´ è‹¥å¾ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>content</span><span class=err>&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;A B C&#34;</span><span class=p>&gt;</span><span class=nx>content</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>è®Šæˆï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span>  <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>content</span><span class=err>&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;A C B&#34;</span><span class=p>&gt;</span><span class=nx>content</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>å°æ–¼å¿«ç…§æ¸¬è©¦ç­‰ Matcher (<code>toMatchSnapshot</code>ã€<code>toMatchInlineSnapshot</code>)ä¾†èªªå°‡æœƒé¡¯ç¤ºæ¸¬è©¦å¤±æ•—ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.content&#39;</span><span class=p>)).</span><span class=nx>toMatchSnapshot</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>å¿«ç…§æ¯”å°çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>-     <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;A B C&#34;</span>
</span></span><span class=line><span class=cl>+     <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;A C B&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œä»¥é™£åˆ—æ¯”å°æ˜¯å¦ã€ŒåŒ…å«ã€çš„æ–¹å¼ï¼Œå°‡ä¸å—å½±éŸ¿ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.content&#39;</span><span class=p>).</span><span class=nx>classes</span><span class=p>()).</span><span class=nx>toContain</span><span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.content&#39;</span><span class=p>).</span><span class=nx>classes</span><span class=p>()).</span><span class=nx>toContain</span><span class=p>(</span><span class=s1>&#39;B&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.content&#39;</span><span class=p>).</span><span class=nx>classes</span><span class=p>()).</span><span class=nx>toContain</span><span class=p>(</span><span class=s1>&#39;C&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=åˆ¤æ–·å…§å®¹ç‰©>åˆ¤æ–·å…§å®¹ç‰©</h3><h4 id=text>text</h4><p><code>text</code> ä¸»è¦æ˜¯å–å¾—ç›®æ¨™å…ƒç´ ç¯€é»å¾Œä»£çš„æ‰€æœ‰æ–‡å­—ï¼š</p><h5 id=rootcomponentvue-3>RootComponent.vue</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>target</span><span class=err>&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>Root</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>child-component</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>child-component</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>child-component</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=childcomponentvue-1>ChildComponent.vue</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>child</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨ <code>mount</code> åŒ…è£å…ƒä»¶æ™‚ <code>wrapper.find('[data-test="target"]').text()</code> çš„çµæœå°‡æœƒæ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Rootchildchildchild
</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨ <code>shallowMount</code> åŒ…è£å…ƒä»¶æ™‚ <code>wrapper.find('[data-test="target"]').text()</code> çš„çµæœå°‡æœƒæ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Root
</span></span></code></pre></td></tr></table></div></div><h4 id=html>html</h4><p>èˆ‡ <code>text</code> é¡ä¼¼ï¼Œä½† <code>html</code> æœƒå°‡ç›®æ¨™å…ƒç´ å¾Œä»£æ‰€æœ‰å…ƒç´ éƒ½è¨˜éŒ„ä¸‹ä¾†ï¼š</p><h5 id=rootcomponentvue-4>RootComponent.vue</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>target</span><span class=err>&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>Root</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>child-component</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>child-component</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>child-component</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=childcomponentvue-2>ChildComponent.vue</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>child</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨ <code>mount</code> åŒ…è£å…ƒä»¶æ™‚ <code>wrapper.find('[data-test="target"]').html()</code> çš„çµæœå°‡æœƒæ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>Root
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>child<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>child<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>child<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½¿ç”¨ <code>shallowMount</code> åŒ…è£å…ƒä»¶æ™‚ <code>wrapper.find('[data-test="target"]').html()</code> çš„çµæœå°‡æœƒæ˜¯ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>Root
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>child-component-stub</span><span class=p>&gt;&lt;/</span><span class=nt>child-component-stub</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>child-component-stub</span><span class=p>&gt;&lt;/</span><span class=nt>child-component-stub</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>child-component-stub</span><span class=p>&gt;&lt;/</span><span class=nt>child-component-stub</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>å› æ­¤åœ¨ä½¿ç”¨ <code>text</code> èˆ‡ <code>html</code> ä¾†é€²è¡Œæ–·è¨€æ™‚ï¼Œè¦æ³¨æ„åˆ°ã€Œ<strong>æ¸¬è©¦æ‰€éœ€åŒ…å«çš„ç¯„åœ</strong>ã€ä»¥åŠã€Œ<strong>å…ƒä»¶å®¹å™¨</strong>ã€æ‡‰æ¡ç”¨ <code>mount</code> é‚„æ˜¯ <code>shallowMount</code> ç­‰è­°é¡Œï¼Œæ‰èƒ½è®“æ¸¬è©¦æ›´åŠ å¼·éŸŒä¸”ä¸æœƒè®“å¾ŒçºŒé–‹ç™¼ç„¡ç›¸é—œçš„å…§å®¹æ™‚ä¸€ç›´è¢«æ¸¬è©¦æ””ä½ã€‚</p><hr><h2 id=å®¹å™¨çš„æ–¹æ³•wrapper-methods---æ¨¡æ“¬äº‹ä»¶>å®¹å™¨çš„æ–¹æ³•(Wrapper methods) - æ¨¡æ“¬äº‹ä»¶</h2><h3 id=æ»‘é¼ äº‹ä»¶>æ»‘é¼ äº‹ä»¶</h3><p>å¸¸è¦‹çš„ DOM äº‹ä»¶æœ‰ä¸‹åˆ—å¹¾ç¨®ï¼š</p><ul><li>æ»‘é¼ äº‹ä»¶ï¼šé»æ“Šï¼ˆclickï¼‰</li><li>éµç›¤äº‹ä»¶ï¼šæŒ‰ä¸‹æŸéµï¼ˆkeydownï¼‰ã€é¬†é–‹æŸéµï¼ˆkeyupï¼‰</li><li>è¡¨å–®äº‹ä»¶ï¼šé‡å° <code>&lt;input></code> è¼¸å…¥å…§å®¹ã€<code>checkbox</code> èˆ‡ <code>radio</code> å‹¾é¸æˆ– <code>&lt;select></code> ä¸­çš„é¸æ“‡å…§å®¹</li></ul><p>é¦–å…ˆï¼Œèªæ³•æ–¹é¢é™¤äº†è¡¨å–®äº‹ä»¶ä¹‹å¤–ï¼Œè¦æ¨¡æ“¬å¤§éƒ¨åˆ†çš„äº‹ä»¶æˆ‘å€‘å¯ä»¥é€éå®¹å™¨æ–¹æ³•ä¸­çš„ <code>trigger</code> æ–¹æ³•å³å¯è§¸ç™¼äº‹ä»¶ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>wrapper</span><span class=p>.</span><span class=nx>trigger</span><span class=p>(</span><span class=nx>event</span><span class=p>,</span> <span class=nx>options</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>ç”¨æ³•æ˜¯åœ¨ç¬¬ä¸€å€‹åƒæ•¸ä¸­å‚³å…¥è¦è§¸ç™¼çš„ <code>DOM</code> äº‹ä»¶åç¨±ï¼ˆe.g. <code>click</code>ã€<code>drag</code>ï¼‰ï¼Œå¦‚æœæœ‰éœ€è¦è£œå……è§¸ç™¼äº‹ä»¶çš„æ¢ä»¶ï¼Œæ¯”æ–¹åƒæ˜¯æŒ‰ä¸‹å“ªå€‹éµç›¤ï¼Œå°±å¯ä»¥é€éç¬¬äºŒå€‹åƒæ•¸å¸¶å…¥è³‡è¨Šï¼ˆe.g. <code>{ keyCode: 65 }</code>ï¼‰ã€‚</p><p>è€Œè¦æ³¨æ„åˆ°çš„æ˜¯ç”±æ–¼é€™äº›äº‹ä»¶åŸºæœ¬ä¸Šéƒ½æœƒæ˜¯<strong>éåŒæ­¥</strong>çš„ç”¨æ³•ï¼Œæ‰€ä»¥åœ¨æ’°å¯«æ¸¬è©¦æ¡ˆä¾‹æ™‚å¯ä»¥ä½¿ç”¨ <code>async/await</code> ä¾†è®“æ–·è¨€ï¼ˆAssertionï¼‰ä¿æŒæ­£ç¢ºçš„çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Arrange
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Act
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>trigger</span><span class=p>(</span><span class=nx>event</span><span class=p>,</span> <span class=nx>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// Assert
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>expect</span><span class=p>(</span><span class=cm>/* ... */</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=cm>/* ... */</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ‰äº†é€™å€‹æ¦‚å¿µä¹‹å¾Œï¼Œæ¥ä¸‹ä¾†ä¾¿å¯ä»¥å¿«é€Ÿä¾†çœ‹çœ‹å¯¦éš›ä¸Šå„å€‹äº‹ä»¶è§¸ç™¼çš„å¯¦éš›æ¡ˆä¾‹èˆ‡äº‹ä»¶åç¨±ï¼Œä¸¦ä¸”è‘—é‡é—œæ³¨è¦ç‰¹åˆ¥æ³¨æ„çš„åœ°æ–¹ã€‚</p><h3 id=æ»‘é¼ äº‹ä»¶-1>æ»‘é¼ äº‹ä»¶</h3><ul><li>é»æ“Šï¼š <code>click</code></li><li>é›™æ“Šï¼š <code>dblclick</code></li><li>æŒ‡å®šé»æ“Šï¼š <code>click.left</code>ã€<code>click.middle</code>ã€<code>click.right</code></li></ul><h4 id=é»æ“Šèˆ‡é›™æ“Š>é»æ“Šèˆ‡é›™æ“Š</h4><p>é»æ“Šèˆ‡é›™æ“Šçš„éƒ¨åˆ†æœ€ä¸»è¦éœ€è¦æ³¨æ„çš„éƒ¨åˆ†æ˜¯ï¼Œä»¥äº‹ä»¶ä¾†èªªçš„æ¦‚å¿µã€Œ<strong>é›™æ“Šï¼ˆdblclickï¼‰</strong>ã€æ˜¯ä¸€å€‹äº‹ä»¶ï¼Œä¸¦éã€Œå…©å€‹ã€ã€Œ<strong>é»æ“Šï¼ˆclickï¼‰</strong>ã€äº‹ä»¶ï¼š</p><h5 id=å…ƒä»¶>å…ƒä»¶</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>ref</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>content</span><span class=err>&#34;</span><span class=p>&gt;{{</span> <span class=nx>count</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>button</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>button</span><span class=err>&#34;</span> <span class=nt>@click</span><span class=s>=&#34;count++&#34;</span><span class=p>&gt;</span><span class=na>Add</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=æ¸¬è©¦ç¨‹å¼ç¢¼>æ¸¬è©¦ç¨‹å¼ç¢¼</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;after click button should display correct content&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;button&#34;]&#39;</span><span class=p>).</span><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;content&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;button&#34;]&#39;</span><span class=p>).</span><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;content&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;button&#34;]&#39;</span><span class=p>).</span><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;dblclick&#39;</span><span class=p>)</span> <span class=c1>// è§¸ç™¼ä¸åˆ° @click äº‹ä»¶
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;content&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;4&#39;</span><span class=p>)</span> <span class=c1>// AssertionError
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æŒ‡å®šæŒ‰éµé»æ“Š>æŒ‡å®šæŒ‰éµé»æ“Š</h4><p>æœ‰æ™‚å€™ä½ å¯ä»¥æœƒæƒ³è¦æŒ‡å®šæ»‘é¼ çš„æŒ‰éµä¾†è§¸ç™¼äº‹ä»¶ï¼Œé€™æ™‚å°±å¯ä»¥ä½¿ç”¨é¡ä¼¼ä¿®é£¾ç¬¦ï¼ˆmodifierï¼‰ä¸€æ¨£çš„æ–¹å¼ä¾†è§¸ç™¼äº‹ä»¶ï¼š</p><ul><li><code>click.left</code></li><li><code>click.middle</code></li><li><code>click.right</code></li></ul><h5 id=å…ƒä»¶-1>å…ƒä»¶</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>button</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>button</span><span class=err>&#34;</span> <span class=err>@</span><span class=na>click.right</span><span class=err>=&#34;</span><span class=na>result </span><span class=o>=</span> <span class=s>&#39;here we go!&#39;</span><span class=err>&#34;</span><span class=p>&gt;</span><span class=nx>Are</span> <span class=nx>You</span> <span class=nx>ready</span><span class=o>?</span><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>target</span><span class=err>&#34;</span><span class=p>&gt;{{</span> <span class=nx>result</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=æ¸¬è©¦ç¨‹å¼ç¢¼-1>æ¸¬è©¦ç¨‹å¼ç¢¼</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should be display correct text&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;button&#34;]&#39;</span><span class=p>).</span><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;click.right&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;here we go!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>é™¤æ­¤ä¹‹å¤–ï¼Œéµç›¤èˆ‡æ»‘é¼ çš„æ“ä½œä¹Ÿå¯ä»¥èåˆå†ä¸€èµ·ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;click.ctrl.left&#39;</span><span class=p>)</span> <span class=c1>// å·¦éµé»æ“Šæ™‚åŒæ™‚æŒ‰è‘— ctrl éµ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;click.alt.right&#39;</span><span class=p>)</span> <span class=c1>// å³éµé»æ“Šæ™‚åŒæ™‚æŒ‰è‘— alt éµ
</span></span></span></code></pre></td></tr></table></div></div><h3 id=éµç›¤äº‹ä»¶>éµç›¤äº‹ä»¶</h3><p>éµç›¤æœ€å¸¸è¦‹çš„æ ¸å¿ƒäº‹ä»¶ä¸»è¦ç‚ºï¼š</p><ul><li>æŒ‰ä¸‹æŸå€‹æŒ‰éˆ• <code>keydown</code></li><li>é¬†é–‹æŸå€‹æŒ‰éˆ• <code>keyup</code></li></ul><p>ä¸Šè¿°äº‹ä»¶å¦‚åŒæŒ‡å®šæ»‘é¼ æŒ‰éµçš„å¯«æ³•ï¼Œä¸€æ¨£æ“æœ‰ä¿®é£¾ç¬¦çš„ç›¸é—œèªæ³•ï¼Œè€Œå¾Œæ–¹å¸¶çš„ä¿®é£¾ç¬¦ä¸»è¦ç‚ºæŒ‰éµçš„åç¨±ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;keydown.enter&#39;</span><span class=p>)</span> <span class=c1>// æŒ‰ä¸‹ enter éµ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;keyup.up&#39;</span><span class=p>)</span> <span class=c1>// é¬†é–‹ ä¸Šæ–¹å‘éµ
</span></span></span></code></pre></td></tr></table></div></div><p>åŒæ¨£åœ°ï¼Œéµç›¤äº‹ä»¶ä¹Ÿæ”¯æ´å¤šé‡çš„çµ„åˆä¿®é£¾ç¬¦å¯«æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;keydown.ctrl.tab&#39;</span><span class=p>)</span> <span class=c1>// æŒ‰ä¸‹ ctrl éµ + tab éµ
</span></span></span></code></pre></td></tr></table></div></div><p>è‹¥ä½ æƒ³è¦æ›´éˆæ´»çš„ä½¿ç”¨éµç›¤äº‹ä»¶ï¼Œä¹Ÿå¯ä»¥ç”¨ <code>trigger</code> æ–¹æ³•çš„ç¬¬äºŒå€‹åƒæ•¸å¸¶å…¥éµç›¤çš„åç¨±ï¼Œè€Œç›®å‰æœ‰æ”¯æ´çš„å¯«æ³•ä¸»è¦æœ‰ä¸‹åˆ—ä¸‰ç¨®ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;äº‹ä»¶åç¨±&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>code?</span>: <span class=kt>event.code</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>key?</span>: <span class=kt>event.key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>keyCode?</span>: <span class=kt>event.keycode</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>è‹¥ä¸æ¸…æ¥šéµç›¤å°æ‡‰çš„ä»£è™Ÿä¹Ÿæ²’æœ‰é—œä¿‚ï¼Œæœ‰ä¸å°‘ç¶²ç«™å°ˆé–€æä¾›é¡ä¼¼çš„æœå‹™ä¾›æŸ¥è©¢ï¼Œæ¯”æ–¹åƒé€™å€‹ <a class=link href=https://www.toptal.com/developers/keycode/for/enter target=_blank rel=noopener>ç¶²ç«™</a> åªè¦æŒ‰ä¸‹ä»»ä¸€æŒ‰éµå°±æœƒå³æ™‚é¡¯ç¤ºéµç›¤å°æ‡‰çš„ä»£è™Ÿã€åç¨±ç­‰ç­‰ç›¸é—œè³‡è¨Šã€‚</p><p>åœ¨æŸ¥åˆ°ä»£è™Ÿå¾Œæˆ‘å€‘å°±å¯ä»¥å°‡å…¶å¸¶å…¥å‰›æ‰çš„æ–¹æ³•ä¸­ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;keydown&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>keyCode</span><span class=o>:</span> <span class=mi>13</span> <span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>è‡³æ–¼è¦é¸æ“‡å“ªç¨®å¯«æ³•å°±çœ‹å ´æ™¯æœ¬èº«çš„éœ€æ±‚ä¾†åšæ±ºå®šå›‰ï¼</p><h3 id=è¡¨å–®äº‹ä»¶>è¡¨å–®äº‹ä»¶</h3><ul><li><code>input</code> è¼¸å…¥</li><li><code>checkbox</code> / <code>radio</code> å‹¾é¸</li><li><code>&lt;select></code> ä¸­çš„é¸æ“‡å…§å®¹</li></ul><blockquote><p>åŸå…ˆç‚ºäº†é‡å°ä¸åŒè¡¨å–®é¡å‹ï¼ŒVue Test Utils 1 ç‰ˆï¼ˆfor Vue2ï¼‰å·¥å…·æä¾›äº†ä¸€å€‹å°ˆå±¬çš„ <code>setChecked</code> çš„ä¾†å°æ‡‰ <code>checkbox</code> / <code>radio</code> å‹¾é¸ç‹€æ…‹ï¼ˆcheckedï¼‰ï¼›é™¤æ­¤ä¹‹å¤–æ›¿ <code>&lt;select></code> å…ƒç´ çš„é¸æ“‡æä¾›äº† <code>setSelected</code> æ–¹æ³•ä¾†æ¨¡æ“¬é¸æ“‡è¡Œç‚ºã€‚</p></blockquote><p>è€Œåœ¨ Vue Test utils 2 ç‰ˆæ™‚ï¼Œæˆ‘å€‘å°‡åªè¦çµ±ä¸€ä½¿ç”¨ <code>setValue</code> å³å¯è‡ªå‹•å°æ‡‰æ‰€æœ‰è¡¨å–®çš„è¡Œç‚ºï¼</p><h4 id=æ¨¡æ“¬-input-è¼¸å…¥>æ¨¡æ“¬ input è¼¸å…¥</h4><p>è¼¸å…¥è¡¨å–®æˆ–æ˜¯æ“ä½œæ—¥æœŸé¸æ“‡å™¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>input</span> <span class=nt>v-model</span><span class=s>=&#34;textResult&#34; type=&#34;text&#34; data-test=&#34;text&#34;/&gt;
</span></span></span><span class=line><span class=cl><span class=s>  &lt;p data-test=&#34;result_text&#34;&gt;{{textResult}}&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=s>  &lt;input v-model=&#34;dateResult&#34; type=&#34;date&#34; data-test=&#34;date&#34;/&gt;
</span></span></span><span class=line><span class=cl><span class=s>  &lt;p data-test=&#34;result_date&#34;</span><span class=p>&gt;{{</span><span class=na>dateResult</span><span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>æ–‡å­—è¼¸å…¥ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¨¡æ“¬ input è¼¸å…¥&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>([</span><span class=nx>data</span><span class=o>-</span><span class=nx>test</span><span class=o>=</span><span class=s2>&#34;text&#34;</span><span class=p>]).</span><span class=nx>setValue</span><span class=p>(</span><span class=s1>&#39;Hello, World!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>([</span><span class=nx>data</span><span class=o>-</span><span class=nx>test</span><span class=o>=</span><span class=s2>&#34;result_text&#34;</span><span class=p>]).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;Hello, World!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>é¸æ“‡æ—¥æœŸï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¨¡æ“¬ æ—¥æœŸ è¼¸å…¥&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>([</span><span class=nx>data</span><span class=o>-</span><span class=nx>test</span><span class=o>=</span><span class=s2>&#34;date&#34;</span><span class=p>]).</span><span class=nx>setValue</span><span class=p>(</span><span class=s1>&#39;2022/10/06&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>([</span><span class=nx>data</span><span class=o>-</span><span class=nx>test</span><span class=o>=</span><span class=s2>&#34;result_date&#34;</span><span class=p>]).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;2022/10/06&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ¨¡æ“¬-radio-å‹¾é¸>æ¨¡æ“¬ radio å‹¾é¸</h4><h5 id=å…ƒä»¶-2>å…ƒä»¶</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>input</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>radio_1</span><span class=err>&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;radio&#34;</span> <span class=nt>v-model</span><span class=s>=&#34;radioResult&#34; value=&#34;1&#34; /&gt;
</span></span></span><span class=line><span class=cl><span class=s>  &lt;input data-test=&#34;radio_2&#34; type=&#34;radio&#34; v-model=&#34;radioResult&#34; value=&#34;2&#34; /&gt;
</span></span></span><span class=line><span class=cl><span class=s>  &lt;p data-test=&#34;result&#34;</span><span class=p>&gt;{{</span> <span class=na>radioResult</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=æ¸¬è©¦ç¨‹å¼ç¢¼-2>æ¸¬è©¦ç¨‹å¼ç¢¼</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¨¡æ“¬ radio å‹¾é¸è¡Œç‚º&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;radio_1&#34;]&#39;</span><span class=p>).</span><span class=nx>setValue</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;result&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;radio_2&#34;]&#39;</span><span class=p>).</span><span class=nx>setValue</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;result&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ¨¡æ“¬-checkbox-å‹¾é¸>æ¨¡æ“¬ checkbox å‹¾é¸</h4><h5 id=å…ƒä»¶-3>å…ƒä»¶</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>input</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>checkbox_1</span><span class=err>&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;checkbox&#34;</span> <span class=nt>v-model</span><span class=s>=&#34;checkboxResult&#34; value=&#34;1&#34; /&gt;
</span></span></span><span class=line><span class=cl><span class=s>  &lt;input data-test=&#34;checkbox_2&#34; type=&#34;checkbox&#34; v-model=&#34;checkboxResult&#34; value=&#34;2&#34; /&gt;
</span></span></span><span class=line><span class=cl><span class=s>  &lt;p data-test=&#34;result&#34;</span><span class=p>&gt;{{</span> <span class=na>checkboxResult.join</span><span class=err>(&#39;,&#39;)</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=æ¸¬è©¦ç¨‹å¼ç¢¼-3>æ¸¬è©¦ç¨‹å¼ç¢¼</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¨¡æ“¬ checkbox å‹¾é¸è¡Œç‚º&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;checkbox_1&#34;]&#39;</span><span class=p>).</span><span class=nx>setValue</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;result&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;checkbox_2&#34;]&#39;</span><span class=p>).</span><span class=nx>setValue</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;result&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;1,2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;checkbox_1&#34;]&#39;</span><span class=p>).</span><span class=nx>setValue</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;result&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ¨¡æ“¬-select-é¸æ“‡>æ¨¡æ“¬ select é¸æ“‡</h4><h5 id=å…ƒä»¶-4>å…ƒä»¶</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>select</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>target</span><span class=err>&#34;</span> <span class=nt>v-model</span><span class=s>=&#34;result&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;orange&#34;</span><span class=p>&gt;</span><span class=nx>Orange</span><span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>option</span> <span class=na>value</span><span class=o>=</span><span class=s>&#34;black&#34;</span><span class=p>&gt;</span><span class=nx>Black</span><span class=p>&lt;/</span><span class=nt>option</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>select</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>result</span><span class=err>&#34;</span><span class=p>&gt;{{</span> <span class=nx>result</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=æ¸¬è©¦ç¨‹å¼ç¢¼-4>æ¸¬è©¦ç¨‹å¼ç¢¼</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;æ¨¡æ“¬ select é¸æ“‡&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>setValue</span><span class=p>(</span><span class=s1>&#39;orange&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;result&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;orange&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=æ¨¡æ“¬-vue-apis>æ¨¡æ“¬ Vue APIs</h2><h3 id=data>data</h3><p>æ³¨æ„ï¼šåœ¨æ¨¡æ“¬ data ä¹‹å‰éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¤§éƒ¨åˆ†çš„æ¸¬è©¦æ™‚æˆ‘å€‘é€šå¸¸ä¸å¿…ç‰¹æ„å»æ¨¡æ“¬ dataï¼Œæ‡‰è©²è®“å…¶èˆ‡å…ƒä»¶æœ¬èº«çš„ç§æœ‰æ–¹æ³•ï¼ˆprivate methodï¼‰è‡ªç„¶äº’å‹•å³å¯ï¼Œè‹¥æœƒéœ€è¦é€éæ¨¡æ“¬ data ä¾†æ“ä½œå…ƒä»¶å‰‡è¦è§€å¯Ÿæ˜¯å¦è³‡æ–™èˆ‡å…ƒä»¶æœ¬èº«è€¦åˆäº†ï¼Œé€™ç¨®æƒ…æ³ä¸‹å¯èƒ½é€ æˆå…ƒä»¶æœ¬èº«ç„¡æ³•é«˜åº¦é‡è¤‡åˆ©ç”¨ã€‚</p><h4 id=ç§æœ‰æ–¹æ³•private-method>ç§æœ‰æ–¹æ³•ï¼ˆprivate methodï¼‰</h4><p>å°é–‰åœ¨å…ƒä»¶ã€ç‰©ä»¶&mldr;ç­‰ç­‰ä¸­çš„å‡½å¼ï¼Œåœ¨å¤–éƒ¨ç„¡æ³•å­˜å–å¾—åˆ°ï¼Œe.gï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>add5</span><span class=p>(</span><span class=nx>x</span><span class=p>){</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>add</span> <span class=o>=</span> <span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>,)</span> <span class=p>=&gt;</span> <span class=nx>x</span> <span class=o>+</span> <span class=nx>y</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>add5</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=nx>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// è£¡é ­çš„ add å‡½å¼å³ç‚ºç§æœ‰æ–¹æ³•ã€‚
</span></span></span></code></pre></td></tr></table></div></div><p>è‹¥æ˜¯çœŸçš„æœ‰éœ€è¦ç”¨åˆ°æ¨¡æ“¬ <code>data</code> å±¬æ€§æ™‚ï¼Œé¦–å…ˆè¦æ³¨æ„å…ƒä»¶æ˜¯ç”¨ä½•ç¨®æ–¹å¼ï¼ˆ<strong>options API</strong> /<strong>composition API</strong> èˆ‡ <strong><code>&lt;script setup></code></strong>ï¼‰ä¾†ä½¿ç”¨ <code>data</code>ï¼Œå› ç‚ºå¯«æ³•ä¸Šå°‡æœƒæœ‰æ‰€ä¸åŒï¼›ä¸”ä¾ç…§è¨­å®šçš„æ™‚æ©Ÿé‚„å¯åˆ†ç‚ºã€Œ<strong>åˆå§‹ç‹€æ…‹</strong>ã€èˆ‡ã€Œ<strong>å¾ŒçºŒæ“ä½œ</strong>ã€ã€‚</p><h3 id=dataoptions-api>dataï¼ˆoptions APIï¼‰</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>target</span><span class=err>&#34;</span><span class=p>&gt;{{</span> <span class=nx>content</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>data</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>content</span><span class=o>:</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>dataï¼ˆoption APIï¼‰åˆå§‹ç‹€æ…‹æ¨¡æ“¬ï¼Œå¯é€éå®¹å™¨ï¼ˆwrapperï¼‰çš„ç¬¬äºŒå€‹åƒæ•¸å¸¶å…¥ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=cm>/* æ¸¬è©¦ç¨‹å¼ç¢¼ */</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>data</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>content</span><span class=o>:</span> <span class=s1>&#39;test&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;test&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>è‹¥è¦æ¨¡æ“¬å¾ŒçºŒæ‰è¨­å®š dataï¼ˆoption APIï¼‰ï¼Œå‰‡å¯ä»¥é€éå®¹å™¨æ–¹æ³•ä¸­çš„ <code>setData()</code> è¨­ç½®ï¼Œæ­¤å¤–ç”±æ–¼æ˜¯éåŒæ­¥çš„æ–¹æ³•ï¼Œè¦è¨˜å¾— <code>async/await</code> æ‰èƒ½ç¢ºä¿æ–·è¨€æ­£ç¢ºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>setData</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>content</span><span class=o>:</span> <span class=s1>&#39;test&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;test&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=datacomposition-api-script-setup-èªæ³•ç³–>dataï¼ˆcomposition API, <code>&lt;script setup></code> èªæ³•ç³–ï¼‰</h3><h4 id=composition-api>composition APIï¼š</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>content</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>content</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=script-setup-èªæ³•ç³–><code>&lt;script setup></code> èªæ³•ç³–ï¼š</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kr>import</span> <span class=p>{</span> <span class=nx>ref</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>content</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>é€™ä¸€é¡é€é <code>setup()</code> æ‰€è™•ç†çš„è³‡æ–™ï¼Œè‹¥è¦æ¨¡æ“¬æœƒé‡åˆ°ä¸å°‘å•é¡Œã€‚</p><p>åœ¨å®¹å™¨æ–¹æ³•ä¸­çš„ç¬¬äºŒå€‹åƒæ•¸æ‰€æä¾›çš„æ–¹å¼ï¼ŒåŸå…ˆæ˜¯ä¾›æ‡‰çµ¦ <code>options</code> API ä¸­çš„ <code>data</code> å±¬æ€§æ‰€ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘å€‘å¿…é ˆæ”¹ä»¥æ³¨å…¥çš„æ–¹å¼åµŒå…¥ <code>setup()</code>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=cm>/* æ¸¬è©¦ç¨‹å¼ç¢¼ */</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>monut</span><span class=p>(</span><span class=nx>component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setup</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>content</span><span class=o>:</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>ä½†å¦‚æ­¤ä¸€ä¾†ï¼Œå…ƒä»¶ä¸­åŸå…ˆå…¶ä»–å¯«åœ¨ <code>setup()</code> å…§çš„ç‹€æ…‹ç­‰å°±å¿…é ˆä¸€èµ·æ¨¡æ“¬ï¼Œé‚„è¨˜å¾—å¥½çš„å…ƒä»¶æ¸¬è©¦å®ˆå‰‡ä¹‹ä¸€å—ï¼Ÿæ²’éŒ¯ï¼Œå°±æ˜¯ä¸è¦é‡è¤‡å¯¦è¸å¯¦ä½œã€‚</p><p>é‚£æ¯”è¼ƒå¥½çš„æ–¹å¼ä¹‹ä¸€å°±æ˜¯é€éå®¹å™¨æ–¹æ³•ä¸­ï¼ˆwrapperï¼‰å–å¾—å¯¦é«”ä¾†è¨­ç½®è®Šæ•¸ï¼Œä¸¦ä¸”é€é <code>nextTick</code> æ–¹æ³•ç¢ºä¿æ¸²æŸ“çµæœï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;...&#39;</span> <span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=cm>/* æ¸¬è©¦ç¨‹å¼ç¢¼ */</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>monut</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>wrapper</span><span class=p>.</span><span class=nx>vm</span><span class=p>.</span><span class=nx>content</span> <span class=o>=</span> <span class=s1>&#39;text&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// ç‰ˆæœ¬1: ç›´æ¥ä½¿ç”¨ vm å…§çš„ $nextTick
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>vm</span><span class=p>.</span><span class=nx>$nextTick</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// ç‰ˆæœ¬2: ä½¿ç”¨ vue çš„ nextTick
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// import { nextTick } from &#39;vue&#39;
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// await nextTick()
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;test&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œé—œæ–¼ç§æœ‰æ–¹æ³•æˆ–è®Šæ•¸çš„æ¨¡æ“¬ï¼Œæˆ–è¨±å°‡ä¾† Vue Test Utils é–‹ç™¼åœ˜éšŠæœƒå°æ­¤æœ‰äº›æ”¹è§€æä¾›ä¸€äº›é€ƒç”Ÿè‰™çš„æ–¹æ³•ï¼Œä¸éç›®å‰æ¯”è¼ƒä¸€è‡´çš„è§’åº¦æ˜¯ç›¡é‡åˆ¥å°é€™ä¸€é¡çš„ç§æœ‰ç’°å¢ƒæ‰æœ‰çš„è®Šæ•¸èˆ‡æ–¹æ³•å»åšæ¨¡æ“¬ï¼Œå³æ™‚çš„ç›¸é—œè¨è«–å¯è¦‹æ–¼<a class=link href="https://github.com/vuejs/test-utils/pulls?q=composition" target=_blank rel=noopener>é€™è£¡</a>ã€‚</p><h3 id=props>props</h3><p>åœ¨ä¸æ¨¡æ“¬ç§æœ‰æƒ…å¢ƒçš„å‰æä¹‹ä¸‹ï¼Œprop ç›¸è¼ƒèµ·ä¾†å–®ç´”å¤šäº†ï¼Œè€Œé—œæ–¼æ¸¬è©¦ props çš„éƒ¨åˆ†ä¸»è¦æœ‰ï¼š</p><ul><li>æ¨¡æ“¬ props å‚³å…¥å¾Œï¼Œæ–·è¨€ã€Œå¾ŒçºŒçš„ç‹€æ…‹ã€ã€‚</li><li>æ–·è¨€ã€Œæ˜¯å¦å‚³å…¥å°çš„åƒæ•¸çµ¦å­å…ƒä»¶ã€ã€‚</li></ul><h4 id=æ¨¡æ“¬-props-å‚³å…¥>æ¨¡æ“¬ props å‚³å…¥</h4><p>è¦æ¨¡æ“¬ props å‚³å…¥çš„æ–¹æ³•ä¾ç…§æ™‚æ©Ÿå¯åˆ†ç‚ºã€Œ<strong>åˆå§‹ç‹€æ…‹</strong>ã€èˆ‡ã€Œ<strong>å¾ŒçºŒæ“ä½œ</strong>ã€ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>target</span><span class=err>&#34;</span><span class=p>&gt;{{</span> <span class=nx>content</span> <span class=p>}}&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>åˆå§‹ç‹€æ…‹åŒæ¨£æ˜¯è—‰ç”±å®¹å™¨ï¼ˆWrapperï¼‰ä¸­çš„ç¬¬äºŒå€‹åƒæ•¸å‚³å…¥ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>content</span><span class=o>:</span> <span class=s1>&#39;Hello&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;Hello&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>è‹¥æƒ³è¦å¾ŒçºŒæ‰å‚³å…¥ <code>props</code> å‰‡å¯ä»¥é€éå®¹å™¨æ–¹æ³• <code>setProps</code> æ¨¡æ“¬ï¼Œä¸¦ä¸”ä¸€æ¨£è¦å°å¿ƒéåŒæ­¥çš„å•é¡Œï¼Œè¨˜å¾—è£œä¸Š <code>async / await</code> ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>props</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>content</span><span class=o>:</span> <span class=s1>&#39;Hello&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;Hello&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>setProps</span><span class=p>({</span> <span class=nx>content</span><span class=o>:</span> <span class=s1>&#39;Good bye&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;Good bye&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ–·è¨€æ˜¯å¦å‚³å…¥å°-props-åƒæ•¸çµ¦å­å…ƒä»¶>æ–·è¨€æ˜¯å¦å‚³å…¥å° props åƒæ•¸çµ¦å­å…ƒä»¶</h3><p>æ—¢ç„¶æœ‰æ¥æ”¶çš„ä¸€æ–¹ï¼Œé‚£å°±è‡³å°‘æœƒæœ‰çµ¦äºˆçš„ä¸€æ–¹ã€‚</p><p>åœ¨ <code>props</code> é©—è­‰ä¸­çš„å¦ä¸€ç¨®æ–¹å¼å°±æ˜¯é©—è­‰çµ¦äºˆå…¶ä»–å…ƒä»¶çš„åƒæ•¸æ˜¯å¦æ­£ç¢ºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>BaseLightbox</span> <span class=na>content</span><span class=err>&#34;</span><span class=na>Hello</span><span class=err>&#34;</span> <span class=na>enableMask</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>é¦–å…ˆæˆ‘å€‘è¦åšçš„æ˜¯é€éä¹‹å‰å­¸çš„é¸æ“‡å™¨æ–¹æ³•é¸åˆ°ç‰¹å®šçš„å…ƒä»¶ï¼Œæ¥è‘—é€éå®¹å™¨æ–¹æ³•åº•ä¸‹çš„ <code>props()</code> ä¾†å–çš„å‚³é€è³‡è¨Šï¼Œæ¥è‘—å°±å¯ä»¥é€éæ–·è¨€ Matcher ä¾†æ¯”å° props çµ¦å…ƒä»¶çš„è³‡è¨Šæ˜¯å¦æ­£ç¢ºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>BaseLightbox</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;./BaseLightbox.vue&#39;</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>target</span> <span class=o>=</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>BaseLightbox</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>props</span><span class=p>(</span><span class=nx>content</span><span class=p>)).</span><span class=nx>toEqual</span><span class=p>(</span><span class=s1>&#39;Hello&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>props</span><span class=p>(</span><span class=nx>enableMask</span><span class=p>)).</span><span class=nx>toEqual</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>target</span><span class=p>.</span><span class=nx>props</span><span class=p>()).</span><span class=nx>toEqual</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>content</span><span class=o>:</span> <span class=s1>&#39;Hello&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>enableMask</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=emit>emit</h3><p>åœ¨æ–·è¨€ä¸­æˆ‘å€‘è¦æ¸¬è©¦ <code>emit</code> ä¸»è¦æ˜¯è©¦åœ–æ•ç²å…ƒä»¶æ‰€ç™¼ç”Ÿçš„äº‹ä»¶ï¼Œä¸¦æ–·è¨€äº‹ä»¶èˆ‡å€¼æ˜¯å¦å¦‚æˆ‘å€‘æ‰€é æœŸï¼Œè€Œé€™æ™‚å¯ä»¥é€éå®¹å™¨æ–¹æ³•ä¸­çš„ <code>emitted()</code> ä¾†å–å¾—äº‹ä»¶ç™¼é€æ‰€æœ‰çš„ç´€éŒ„ã€‚</p><p>è€Œ <code>emitted</code> ä¸­æ‰€ç´€éŒ„çš„æ ¼å¼å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>&#39;äº‹ä»¶åç¨±&#39;:</span> <span class=err>[</span>
</span></span><span class=line><span class=cl>    <span class=err>[/*</span> <span class=err>ç¬¬ä¸€æ¬¡ç™¼é€çš„å€¼</span> <span class=err>*/],</span>
</span></span><span class=line><span class=cl>    <span class=err>[/*</span> <span class=err>ç¬¬äºŒæ¬¡ç™¼é€çš„å€¼</span> <span class=err>*/],</span>
</span></span><span class=line><span class=cl>    <span class=err>[/*</span> <span class=err>ç¬¬</span> <span class=err>n</span> <span class=err>æ¬¡ç™¼é€çš„å€¼</span> <span class=err>*/]</span>
</span></span><span class=line><span class=cl>  <span class=err>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å› æ­¤å‡è¨­æˆ‘å€‘æœ‰ä¸€å€‹ <code>pagination</code> å…ƒä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>first</span><span class=err>&#34;</span> <span class=err>@</span><span class=na>click</span><span class=o>=</span><span class=s>&#34;$emit(&#39;changePage&#39;, &#39;first&#39;)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nx>ç¬¬ä¸€é </span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>prev</span><span class=err>&#34;</span> <span class=err>@</span><span class=na>click</span><span class=o>=</span><span class=s>&#34;$emit(&#39;changePage&#39;, &#39;prev&#39;)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nx>ä¸Šä¸€é </span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>next</span><span class=err>&#34;</span> <span class=err>@</span><span class=na>click</span><span class=o>=</span><span class=s>&#34;$emit(&#39;changePage&#39;, &#39;next&#39;)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nx>ä¸‹ä¸€é </span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>last</span><span class=err>&#34;</span> <span class=err>@</span><span class=na>click</span><span class=o>=</span><span class=s>&#34;$emit(&#39;changePage&#39;, &#39;last&#39;)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nx>æœ€å¾Œä¸€é </span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨æ–·è¨€çš„æ™‚å€™æˆ‘å€‘å¯ä»¥é€éä¸‹åˆ—æ–¹å¼æª¢æŸ¥æ˜¯å¦ç™¼é€å°æ‡‰çš„ emit äº‹ä»¶ï¼š</p><ul><li>é€é <code>toHaveProperty</code> ç¢ºèª <code>emitted</code> å±¬æ€§ç¢ºèªæ˜¯å¦ç™¼é€ã€Œ<strong>é æœŸäº‹ä»¶åç¨±</strong>ã€</li><li>é€é <code>emitted().äº‹ä»¶åç¨±</code> ç¢ºèªè©²äº‹ä»¶åç¨±ã€Œ<strong>ç™¼ç”Ÿæ¬¡æ•¸</strong>ã€</li><li>é€é <code>emitted().äº‹ä»¶åç¨±[index]</code> ç¢ºèªè©²äº‹ä»¶åç¨±ï¼Œç¬¬å¹¾æ¬¡é€å‡ºçš„ã€Œ<strong>å€¼</strong>ã€</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>Component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>await</span> <span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;first&#34;]&#39;</span><span class=p>).</span><span class=nx>trigger</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>emitted</span><span class=p>()).</span><span class=nx>toHaveProperty</span><span class=p>(</span><span class=s1>&#39;changePage&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>emitted</span><span class=p>().</span><span class=nx>changePage</span><span class=p>).</span><span class=nx>toHaveLength</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>emitted</span><span class=p>().</span><span class=nx>changePage</span><span class=p>[</span><span class=mi>0</span><span class=p>]).</span><span class=nx>toEqual</span><span class=p>([</span><span class=s1>&#39;first&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=provide>provide</h3><p>å°æ–¼æœ‰ä½¿ç”¨åˆ° <code>provide</code> çš„å…ƒä»¶ä¾†èªªï¼Œæˆ‘å€‘éœ€è¦ç¢ºä¿ä»–æä¾›é æœŸçš„ <code>inject</code> å…§å®¹ï¼Œå› æ­¤æˆ‘å€‘è¦å»ºç«‹ä¸€å€‹ç”¨ä¾†æ¥æ”¶ <code>provide</code> çš„å…ƒä»¶ï¼Œæ¥è‘—æ‰èƒ½é€éæ–·è¨€ä¾†æ¸¬è©¦å‚³éçš„å…§å®¹æ˜¯å¦å¦‚é æœŸã€‚</p><p>æ¥ä¸‹ä¾†æˆ‘å€‘ä»¥é€™å€‹å…ƒä»¶ç‚ºä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>ChildComponent</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>ref</span><span class=p>,</span> <span class=nx>provide</span><span class=p>,</span> <span class=nx>readonly</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>provide</span><span class=p>(</span><span class=s1>&#39;count&#39;</span><span class=p>,</span> <span class=nx>readonly</span><span class=p>(</span><span class=nx>count</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶è€Œæˆ‘å€‘ç‚ºäº†è®“æ¸¬è©¦æ¡ˆä¾‹ä¿æŒç¨ç«‹æ€§ï¼Œå› æ­¤æˆ‘å€‘è¦é€éé€ å‡çš„å…ƒä»¶ä¾†æ¸¬è©¦ <code>inject</code> æ‰€æ¥æ”¶åˆ°çš„æ˜¯å¦å¦‚é æœŸã€‚</p><h4 id=é€éå…ƒä»¶å®¹å™¨ä¸­çš„-globalstubs-æ¨¡æ“¬å‡å…ƒä»¶>é€éå…ƒä»¶å®¹å™¨ä¸­çš„ global.stubs æ¨¡æ“¬å‡å…ƒä»¶</h4><p>é€éå…ƒä»¶å®¹å™¨ï¼ˆWrapperï¼‰ä¸­çš„ç¬¬äºŒå€‹åƒæ•¸ <code>global.stubs</code> æˆ‘å€‘å¯ä»¥å°‡å­å…ƒä»¶æ¸²æŸ“æˆæˆ‘å€‘æƒ³è¦çš„æ¨£å­ï¼Œè€Œæ¨¡æ“¬çš„æ–¹å¼ä¸€å…±åˆ†ç‚ºå…©ç¨®ï¼š</p><ul><li>æ¸²æŸ“æˆ <code>&lt;-stub></code> å…ƒä»¶</li></ul><p>ç•¶ <code>global.stub[ç›®æ¨™å…ƒä»¶åç¨±]</code> ç‚º <code>true</code> æ™‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>TargetComponent</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>global</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>stubs</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>ChildComponent</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘å€‘çš„ç›®æ¨™å…ƒä»¶å°‡æœƒè¢«æ¸²æŸ“ç‚ºå¸¶æœ‰ <code>-stub</code> å¾Œç¶´çš„å…ƒç´ ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>ChildComponent</span> <span class=p>/&gt;</span> <span class=c>&lt;!--</span> <span class=nx>æœƒè®Šæˆ</span> <span class=p>&lt;</span><span class=nt>child-component-stub</span><span class=p>&gt;</span><span class=o>&lt;</span><span class=err>/child-component-stub&gt;  --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ç„¶è€Œé€™å°æ–¼æˆ‘å€‘è¦æ¸¬è©¦ <code>provide</code> ä¾†èªªæ²’æœ‰å¹«åŠ©ï¼Œå› ç‚ºä»–æ²’æœ‰è¾¦æ³•æ¥æ”¶ <code>inject</code> è³‡è¨Šï¼Œå› æ­¤æˆ‘å€‘è¦æ¡ç”¨ä¸‹é¢ç¬¬äºŒç¨®æ–¹æ³•ã€‚</p><ul><li>æ¸²æŸ“æˆç‰¹å®šå…ƒä»¶</li></ul><p>è¦æ¸²æŸ“æˆç‰¹å®šå…ƒä»¶çš„æ–¹å¼ï¼Œå°±æ˜¯å…ˆè£½ä½œä¸€å€‹å‡å…ƒä»¶ï¼Œæ¥è‘—å†æä¾›çµ¦ <code>global.stubs</code> ä¾†ç•¶ä½œåŸå…ˆæ‡‰è©²è¦æ¸²æŸ“çš„å…ƒä»¶ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘å€‘å¯ä»¥é€é Vue æä¾›çš„ <code>defineComponent</code> å»ºé€ å…ƒä»¶ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>TestComponent</span> <span class=o>=</span> <span class=nx>defineComponent</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=s1>&#39;&lt;p data-test=&#34;target&#34;&gt;{{ count }}&lt;/p&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>value</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=s1>&#39;count&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span> <span class=nx>value</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥è‘—åœ¨æ¸¬è©¦æ¡ˆä¾‹å°±å¯ä»¥é€é <code>global.stubs</code> ä¸­ç›´æ¥ä½¿ç”¨é€™å€‹æ¸¬è©¦å…ƒä»¶ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineComponent</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>TestComponent</span> <span class=o>=</span> <span class=nx>defineComponent</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=s1>&#39;&lt;p data-test=&#34;target&#34;&gt;{{ count }}&lt;/p&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>value</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=s1>&#39;count&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span> <span class=nx>value</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;...&#39;</span> <span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>TargetComponent</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>global</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>stubs</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ChildComponent</span><span class=o>:</span> <span class=nx>TestComponent</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æ­¤ä¸€ä¾†å…ƒä»¶ <code>ChildComponent</code> åœ¨æ¸¬è©¦æ¡ˆä¾‹ä¸­çš„æ¸²æŸ“çµæœå°‡è®Šæˆæˆ‘å€‘æŒ‡å®šçš„æ¨£å­ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>p</span> <span class=na>data-test</span><span class=o>=</span><span class=s>&#34;target&#34;</span><span class=p>&gt;</span>1<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>å› æ­¤æˆ‘å€‘ç¾åœ¨å°±å¯ä»¥æ–·è¨€ <code>provide</code> æä¾›çš„å…§å®¹æ˜¯å¦æ­£ç¢ºäº†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>TestComponent</span> <span class=o>=</span> <span class=nx>defineComponent</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=s1>&#39;&lt;p data-test=&#34;target&#34;&gt;{{ count }}&lt;/p&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=s1>&#39;count&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span> <span class=nx>count</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;...&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>TargetComponent</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>global</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>stubs</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ChildComponent</span><span class=o>:</span> <span class=nx>TestComponent</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=inject>inject</h3><p>å°æ–¼æœ‰ä½¿ç”¨åˆ° <code>inject</code> çš„å…ƒä»¶ä¾†èªªï¼Œæˆ‘å€‘åœ¨æ„çš„æ˜¯æä¾› <code>provide</code> ç‰¹å®šçš„å€¼ä¹‹å¾Œï¼Œç•«é¢ä¸Šæ¸²æŸ“çš„çµæœæ˜¯å¦æ­£ç¢ºã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>data</span><span class=nt>-test</span><span class=err>=&#34;</span><span class=na>target</span><span class=err>&#34;</span><span class=p>&gt;{{</span> <span class=nx>count</span> <span class=p>}}&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>inject</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setup</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>inject</span><span class=p>(</span><span class=s1>&#39;count&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span> <span class=nx>count</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>æ­¤æ™‚æˆ‘å€‘å¯ä»¥é€éå…ƒä»¶å®¹å™¨ï¼ˆWrapperï¼‰ä¸­çš„ç¬¬äºŒå€‹åƒæ•¸ <code>global</code> ä¾†æŒ‡å®šè¦æä¾›çš„ <code>provide</code> å€¼ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>TargetComponent</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>global</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>provide</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>count</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ€å¾Œæˆ‘å€‘å°±å¯ä»¥ç›´æ¥æ–·è¨€æ¸²æŸ“çš„çµæœæ˜¯å¦å¦‚é æœŸï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should be render correct content after providing count&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>TargetComponent</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>global</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>provide</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>count</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>text</span><span class=p>()).</span><span class=nx>toBe</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=slots>slots</h3><p>è€Œåœ¨é‡å° <code>slots</code> æ’°å¯«æ¸¬è©¦æ™‚ï¼Œè¦æ³¨æ„çš„åœ°æ–¹æœ‰ï¼š</p><ul><li><code>slots</code> è‡³å°‘æœƒæœ‰é è¨­æœªå‚³å…¥çš„ç‹€æ…‹èˆ‡å‚³å…¥è³‡æ–™å¾Œçš„ç‹€æ…‹å…©ç¨®ï¼Œæ–·è¨€æ™‚æ‡‰è©²è‡³å°‘åŒ…å«é€™å…©ç¨®ç‹€æ…‹ã€‚</li><li>ä»¥ <code>slots</code> è¡Œç‚ºä½œç‚ºæ¡ˆä¾‹æ–·è¨€æ™‚ï¼Œæ–·è¨€å…§å®¹è¦å°ˆæ³¨åœ¨ <code>slots</code> æ‰€å½±éŸ¿ç¯„åœå…§ï¼Œå¦å‰‡å¯èƒ½æœƒå—å…¶ä»–å› ç´ å¹²æ“¾ã€‚</li></ul><h4 id=é è¨­æ’æ§½default-slots>é è¨­æ’æ§½ï¼ˆDefault slotsï¼‰</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>slot</span><span class=p>&gt;&lt;/</span><span class=nt>slot</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>è¦é‡å°æœ€åŸºæœ¬çš„é è¨­æ’æ§½åšæ–·è¨€æ™‚ï¼Œæˆ‘å€‘å¯ä»¥é€éå®¹å™¨ä¸­ç¬¬äºŒå€‹åƒæ•¸å¸¶å…¥ <code>slots</code> æ¬„ä½ä¾†æ¨¡æ“¬å¸¶å…¥å…§å®¹ä¸¦é€é <code>default</code> å±¬æ€§å‚³å…¥æŒ‡å®šçš„ç¯„åœå…§ã€‚</p><p>æœªå‚³å…¥æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;default slot&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>Component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>html</span><span class=p>()).</span><span class=nx>toMatchInlineSnapshot</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å‚³å…¥æ™‚æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;default slot&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>Component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>slots</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>default</span><span class=o>:</span> <span class=s1>&#39;Slot Content&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>html</span><span class=p>()).</span><span class=nx>toContain</span><span class=p>(</span><span class=s1>&#39;Slot Content&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å…·åæ’æ§½named-slots>å…·åæ’æ§½ï¼ˆNamed slotsï¼‰</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>slot</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;header&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>slot</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>slot</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;body&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>slot</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>slot</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;footer&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>slot</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>è‹¥åœ¨æ’æ§½çš„å‹æ…‹ç‚ºå…·åæ’æ§½ï¼Œåœ¨æ’°å¯«æ¸¬è©¦æ¡ˆä¾‹æ™‚çš„å®¹å™¨é¸é … <code>slots</code> å°±å¯ä»¥ä¾æ“šæ’æ§½åç¨± <code>name</code> æŒ‡å®šè¦å‚³å…¥çš„å…§å®¹ã€‚</p><p>æœªå‚³å…¥æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;named slot&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>Component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>html</span><span class=p>()).</span><span class=nx>toMatchInlineSnapshot</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å‚³å…¥æ™‚æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;named slot&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>Component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>slots</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>header</span><span class=o>:</span> <span class=s1>&#39;ithelp 2022 éµäººè³½&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>body</span><span class=o>:</span> <span class=s1>&#39;vue3 å–®å…ƒæ¸¬è©¦&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>footer</span><span class=o>:</span> <span class=s1>&#39;by Shawn&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>html</span><span class=p>()).</span><span class=nx>toMatchInlineSnapshot</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=ä½œç”¨åŸŸæ’æ§½scoped-slots>ä½œç”¨åŸŸæ’æ§½ï¼ˆScoped slotsï¼‰</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>è²“å’ªå’–å•¡å»³</span><span class=err>ï¼š</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span><span class=nx>åº—é•·</span><span class=err>ï¼š</span><span class=nx>Shawn</span><span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>slot</span> <span class=nt>:staffInfo</span><span class=s>=&#34;staffInfo&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>slot</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>staffInfo</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;black-cat&#39;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;é»‘é»‘&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;signature-dish&#39;</span><span class=o>:</span> <span class=s1>&#39;æ‹¿éµ&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;orange-cat&#39;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;é˜¿æ©˜&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;signature-dish&#39;</span><span class=o>:</span> <span class=s1>&#39;ç„¦ç³–ç‘ªå¥‡æœµ&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ‰æ™‚å€™æˆ‘å€‘å¯èƒ½æƒ³è¦çµ¦äºˆæ›´é«˜åº¦çš„å½ˆæ€§ï¼Œä½¿å…ƒä»¶é€é <code>&lt;slot></code> å‚³éè³‡æ–™çµ¦çˆ¶å±¤æ™‚ï¼Œé€™æ™‚å€™å°±æœƒç”¨åˆ°ä½œç”¨åŸŸæ’æ§½ã€‚</p><p>æœªå‚³å…¥æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;scoped slots&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>Component</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>html</span><span class=p>()).</span><span class=nx>toMatchInlineSnapshot</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>    &#34;&lt;div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;p&gt;è²“å’ªå’–å•¡å»³ï¼š&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;p&gt;åº—é•·ï¼šShawn&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;/div&gt;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>  `</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å‚³å…¥æ™‚æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;scoped slots&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>Component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>slots</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>default</span><span class=o>:</span> <span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;template #staffInfo&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;p&gt;åº—å“¡ï¼š{{ staffInfo[&#39;orange-cat&#39;][&#39;name&#39;] }}&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>          &lt;p&gt;é™å®šé …ç›®ï¼š{{ staffInfo[&#39;black-cat&#39;][&#39;signature-dish&#39;] }}&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;/template&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      `</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>html</span><span class=p>()).</span><span class=nx>toMatchInlineSnapshot</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>    &#34;&lt;div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;p&gt;è²“å’ªå’–å•¡å»³ï¼š&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;p&gt;åº—é•·ï¼šShawn&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;p&gt;åº—å“¡ï¼šé˜¿æ©˜&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>      &lt;p&gt;é™å®šé …ç›®ï¼šæ‹¿éµ&lt;/p&gt;
</span></span></span><span class=line><span class=cl><span class=sb>    &lt;/div&gt;&#34;
</span></span></span><span class=line><span class=cl><span class=sb>  `</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ’æ§½è¼‰å…¥é¸é …mounting-options>æ’æ§½è¼‰å…¥é¸é …ï¼ˆMounting optionsï¼‰</h4><p>è‹¥æƒ³åœ¨æ¸¬è©¦æ¡ˆä¾‹ä¸­ç”¨ä¸åŒçš„æ–¹å¼ä¾†æ¨¡æ“¬ slotsï¼Œå¯ä»¥é€éä¸‹é¢å››ç¨®èªæ³•ï¼š</p><ul><li>å‚³å…¥ SFC æª”æ¡ˆ</li><li><code>render function</code></li><li>åŒ…å« <code>template</code> å±¬æ€§çš„ç‰©ä»¶</li><li>ç›´æ¥å‚³å…¥ä¸€å€‹å­—ä¸²</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should render same layout&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>Layout</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>slots</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>default</span><span class=o>:</span> <span class=nx>Component</span>
</span></span><span class=line><span class=cl>      <span class=c1>// default: h(&#39;div&#39;, &#39;ç›¸åŒå…§å®¹&#39;),
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// default: { template: &#39;&lt;div&gt;ç›¸åŒå…§å®¹&lt;/div&gt;&#39; },
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// default: &#39;&lt;div&gt;ç›¸åŒå…§å®¹&lt;/div&gt;&#39;,
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>html</span><span class=p>()).</span><span class=nx>toContain</span><span class=p>(</span><span class=s1>&#39;&lt;div&gt;ç›¸åŒå…§å®¹&lt;/div&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=custom-directives>custom directives</h3><p>å®¢è£½åŒ–æŒ‡ä»¤æœ¬èº«æ­é…äº†é¡ä¼¼å…ƒä»¶ç”Ÿå‘½é€±æœŸçš„ Hooksï¼Œè€Œæˆ‘å€‘å¯ä»¥åœ¨é‚£äº› Hook ä¸­ä»»æ„å°æˆ‘å€‘æ‰€ç¶å®šçš„å…ƒç´ åšé–‹ç™¼ï¼Œè®“ç¹è¤‡çš„é‚è¼¯é€éç°¡å–®çš„æŒ‡ä»¤å°±èƒ½å¤ é‡è¤‡åˆ©ç”¨ï¼Œä½¿æˆ‘å€‘åœ¨é–‹ç™¼éç¨‹ä¸­çš„é–‹ç™¼è€…é«”é©—ï¼ˆDeveloper experience, DXï¼‰æœ‰éå¸¸è‰¯å¥½çš„é«”é©—ã€‚</p><p>ä½†ç›¸å°çš„ä¾†èªªï¼Œè¦æ¸¬è©¦å®¢è£½åŒ–æŒ‡ä»¤å°±æœ‰æ©Ÿæœƒé‹ç”¨åˆ°å„ç¨®æˆ‘å€‘è‡³ä»Šå­¸éçš„è¨±å¤šæŠ€å·§ä¾†æ–·è¨€ï¼Œå¾è€Œä½¿é›£åº¦å¤§å¤§æå‡ï¼Œä½†æˆ‘å€‘åªè¦ç†Ÿæ‚‰ä¹‹å‰çš„æ¨¡æ“¬æŠ€å·§å¾Œï¼Œæœ€å¾Œåªéœ€è¦é—œæ³¨çš„ä¸€å€‹åœ°æ–¹å°±æ˜¯ï¼Œé æœŸæŒ‡ä»¤æ”¾å…¥å¾Œæ‡‰é”æˆä»€éº¼ç›®æ¨™ï¼Œæ¥è‘—å†å»å°‹æ‰¾è¦å¾ä»€éº¼è§’åº¦æˆ–å¯å–å¾—çš„è³‡è¨Šå»æ¯”å°ä¾†ä½œç‚ºæˆ‘å€‘æ–·è¨€çš„å…§å®¹å³å¯ã€‚</p><p>è€Œæ¥ä¸‹ä¾†æˆ‘å€‘ä»¥ä¸€å€‹ <code>v-foucs</code> çš„å®¢è£½åŒ–æŒ‡ä»¤ä¾†ä»‹ç´¹å¦‚ä½•æ–·è¨€å®¢è£½åŒ–æŒ‡ä»¤èˆ‡å°‹æ‰¾æ¯”å°è³‡è¨Šï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>vFocus</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>mounted</span><span class=o>:</span> <span class=p>(</span><span class=nx>el</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>el</span><span class=p>.</span><span class=nx>focus</span><span class=p>(),</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ol><li>è¨»å†ŠæŒ‡ä»¤</li></ol><p>é¦–å…ˆï¼Œè¦é€²è¡Œæ–·è¨€æˆ‘å€‘å¯ä»¥é€éå®¹å™¨ä¸­ç¬¬äºŒå€‹åƒæ•¸çš„ <code>global.directives</code> ä¾†è¨»å†Šæˆ‘å€‘çš„å®¢è£½åŒ–æŒ‡ä»¤ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(...,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>global</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>directives</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>Focus</span><span class=o>:</span> <span class=nx>vFocus</span><span class=p>,</span> <span class=c1>// å±¬æ€§åŒ¹é…çš„åç¨±è¦å‰‡ Abc æœƒ match åˆ° v-abc
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>ä»¿é€ å…ƒä»¶ä¸¦æ”¾å…¥æŒ‡ä»¤</li></ol><p>æ¥è‘—æˆ‘å€‘è¦ä½¿ç”¨åˆ°ä»¿é€ å…ƒä»¶çš„æŠ€å·§ï¼Œè®“å®¹å™¨ä¸€é–‹å§‹å°±è¼‰å…¥ä¸€å€‹å‡çš„å…ƒä»¶ï¼Œä¸¦ä¸”æ”¾å…¥æŒ‡ä»¤èˆ‡ <code>data-test</code> å±¬æ€§ä¾›æ•ç²ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>Component</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>template</span><span class=o>:</span> <span class=s1>&#39;&lt;input v-focus data-test=&#34;target&#34; type=&#34;text&#34;/&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(...,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>global</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>directives</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>Focus</span><span class=o>:</span> <span class=nx>vFocus</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>å°‹æ‰¾æ¯”å°ç›®æ¨™</li></ol><p>å†ä¾†ï¼Œç”±æ–¼ç›®æ¨™æ˜¯ç‚ºäº†é©—è­‰æ˜¯å¦è©²å…ƒç´ ç‚ºç€è¦½å™¨ä¸­çš„ <code>focus</code> å…ƒç´ ï¼Œå› æ­¤è¦åˆ©ç”¨åˆ°ç€è¦½å™¨ç‰©ä»¶ <code>Document</code> ä¸­çš„ <a class=link href=https://developer.mozilla.org/en-US/docs/Web/API/Document/activeElement target=_blank rel=noopener>activeElement</a> å±¬æ€§ï¼Œè‹¥æœ‰è¢«èšç„¦çš„æƒ…æ³ä¸‹é‚£æ‡‰è©²è¦èƒ½å¤ æ¯”å°åˆ°åŒå€‹å…ƒç´ ã€‚ï¼ˆç”± <code>jsdom</code> æä¾›æ¨¡æ“¬çš„ç€è¦½å™¨ç’°å¢ƒï¼‰</p><ol start=4><li>æ–·è¨€</li></ol><p>æœ€å¾Œåœ¨æ–·è¨€çš„éƒ¨åˆ†ï¼Œç‚ºäº†å–å¾—ç›®æ¨™å…ƒç´ ï¼Œæˆ‘å€‘å¯ä»¥é€é <code>wrapper.find().element</code> å–å¾—ç›®æ¨™çš„å…ƒç´ å¯¦é«”ï¼Œæœ€å¾Œå°±å¯ä»¥æ‹¿ä»–èˆ‡ <code>document.activeElement</code> åšæ¯”å°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;v-focus&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>Component</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>template</span><span class=o>:</span> <span class=s1>&#39;&lt;input v-focus data-test=&#34;target&#34; type=&#34;text&#34;/&gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>wrapper</span> <span class=o>=</span> <span class=nx>mount</span><span class=p>(</span><span class=nx>Component</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>attachTo</span><span class=o>:</span> <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>global</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>directives</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>Focus</span><span class=o>:</span> <span class=nx>vFocus</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>wrapper</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;[data-test=&#34;target&#34;]&#39;</span><span class=p>).</span><span class=nx>element</span><span class=p>).</span><span class=nx>toBe</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>activeElement</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æ­¤ä¸€ä¾†æˆ‘å€‘å°±å¯ä»¥ç¢ºä¿å°‡ä¾†åœ¨ä½¿ç”¨ <code>v-focus</code> æŒ‡ä»¤æ™‚ï¼Œè©²å…ƒç´ åœ¨ <code>mounted</code> å¾Œæœƒæ˜¯èšç„¦çš„å…ƒç´ ã€‚</p><hr><h2 id=vitest-ui>Vitest UI</h2><p><a class=link href=https://cn.vitest.dev/guide/ui.html target=_blank rel=noopener>Vitest UI</a></p><p><img src=https://live.staticflickr.com/65535/52593161206_9aa54df3c4_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p><a class=link href=https://cn.vitest.dev/guide/ui.html target=_blank rel=noopener>Vitest UI</a> ç°¡å–®ä¾†èªªï¼Œæ˜¯å¦ä¸€ç¨®ä¾›æˆ‘å€‘æŸ¥çœ‹æ¸¬è©¦èˆ‡ç·¨å¯«æ¸¬è©¦çš„æ–¹å¼ï¼Œå®ƒçš„ç‰¹è‰²åœ¨æ–¼åŸºæ–¼ Vite çš„ dev server ç’°å¢ƒï¼Œè®“æˆ‘å€‘å¯ä»¥ç›´æ¥åœ¨ç€è¦½å™¨ä¸Šç›´æ¥è§€çœ‹æ¸¬è©¦æ¡ˆä¾‹çš„æ¸¬è©¦çµæœï¼Œç”šè‡³æ”¯æ´ç›´æ¥åœ¨ç€è¦½å™¨ä¸­ç·¨å¯«æ¸¬è©¦æ¡ˆä¾‹å¾ŒåŒæ­¥æ›´æ–°æ¸¬è©¦æª”æ¡ˆã€‚</p><p>è€Œåœ¨ä½¿ç”¨é€™é …é…·é…·çš„åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘å€‘éœ€è¦å¦å¤–å®‰è£ <code>@vitest/ui</code>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm i -D @vitest/ui
</span></span></code></pre></td></tr></table></div></div><p>æ¥è‘—å°±å¯ä»¥åœ¨ <code>package.json</code> ä¸­æ–°å¢ä¸€å€‹ <code>vitest</code> æŒ‡ä»¤ï¼Œä¸¦å¸¶ä¸Šåƒæ•¸ <code>--ui</code>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;vitest:ui&#34;</span><span class=p>:</span> <span class=s2>&#34;vitest --ui&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æ­¤ä¸€ä¾†å¾Œå€‘åªè¦åŸ·è¡Œ <code>npm run vitest:ui</code>ï¼Œå°±å¯ä»¥åœ¨å•Ÿå‹•é€™é …åŠŸèƒ½ï¼Œä¸¦çœ‹åˆ°ä¸‹åˆ—ç•«é¢ï¼š</p><p><img src=https://live.staticflickr.com/65535/52593421744_551a7db867_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><h3 id=ä»‹é¢>ä»‹é¢</h3><p>åœ¨ Vitest UI ä¸­ï¼Œå·¦å´æ˜¯æ‰€æœ‰æ¸¬è©¦æ¡ˆä¾‹çš„æ¸¬è©¦çµæœï¼ˆPass / Fail / Skipï¼‰ï¼Œæˆ‘å€‘å¯ä»¥é€éä¸Šæ–¹çš„æœå°‹æ¬„è¼¸å…¥æª”åæˆ–è·¯å¾‘æ‰¾åˆ°æˆ‘å€‘è¦è§€å¯Ÿçš„æ¸¬è©¦ã€‚</p><p><img src=https://live.staticflickr.com/65535/52593587045_97da336a0d_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>é»æ“Šå·¦å´çš„æ¸¬è©¦è·¯å¾‘å¾Œï¼Œå³å´æœƒå‡ºç¾æ¸¬è©¦æƒ…å¢ƒèˆ‡æ¸¬è©¦æ¡ˆä¾‹çš„æè¿°è®“æˆ‘å€‘æ›´å¥½è§€å¯Ÿç•¶ä¸‹æª”æ¡ˆä¸­çš„æ‰€æœ‰æ¡ˆä¾‹</p><p><img src=https://live.staticflickr.com/65535/52593161251_c8b36c5b5e_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå†å¾€å³å´æœƒçœ‹åˆ°å››é …è³‡è¨Šï¼Œåˆ†åˆ¥ç‚ºï¼š</p><p><img src=https://live.staticflickr.com/65535/52593421784_8bdb3d761f_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><ul><li>Reportï¼ˆé è¨­é¡¯ç¤ºé …ç›®ï¼‰</li><li>Module Graph</li><li>Console</li><li>Code</li></ul><h3 id=report>Report</h3><p>é»æ“Š Report é ç±¤æ™‚ï¼Œæœƒåœ¨å³å´é¡¯ç¤ºè©²æ¸¬è©¦æª”æ¡ˆä¸­çš„æ‰€æœ‰æ¸¬è©¦æ¡ˆä¾‹çµæœã€‚</p><p>è‹¥ç‚ºå…¨é€šéçš„æƒ…æ³æœƒé¡¯ç¤º <code>All tests passed in this file</code>ï¼š</p><p><img src=https://live.staticflickr.com/65535/52593161276_9256c5cd61_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>è‹¥æœ‰éŒ¯èª¤æœƒé¡¯ç¤ºæ˜¯å“ªä¸€æ¢æ¸¬è©¦æ¡ˆä¾‹ç™¼ç”ŸéŒ¯èª¤ï¼š</p><p><img src=https://live.staticflickr.com/65535/52592678942_4d1f1140cd_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>æˆ‘å€‘ç”šè‡³èƒ½é»æ“ŠéŒ¯èª¤è¨Šæ¯å³æ–¹çš„é–‹å•Ÿè¦–çª— Iconï¼ŒVitest UI å°‡æœƒç›´æ¥å•Ÿå‹•ç³»çµ±é è¨­çš„ç¨‹å¼ç¢¼ç·¨è¼¯å™¨ï¼Œé–‹å•Ÿæ¸¬è©¦æª”æ¡ˆå¾Œå°‡è¼¸å…¥æ¸¸æ¨™èšç„¦åœ¨éŒ¯èª¤çš„è¡Œæ•¸èˆ‡ä½ç½®ã€‚ï¼ˆe.g. åœ–ä¸­çš„ <code>toEqual</code> Assertion Matcherï¼‰</p><p><img src=https://live.staticflickr.com/65535/52593161331_e16935173c_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><h3 id=module-graph>Module Graph</h3><p>æ¥è‘—æ˜¯ç¬¬äºŒå€‹é ç±¤çš„ <code>Module Graph</code>ï¼Œé€™é çš„å…§å®¹ä¸»è¦æ˜¯é€éæª¢æ¸¬è¡Œå…§å¼•å…¥æ¨¡çµ„ï¼Œå‘ˆç¾æª”æ¡ˆä¹‹é–“ä¾è³´é—œä¿‚ã€‚</p><p><img src=https://live.staticflickr.com/65535/52593421854_0fbbe57891_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>é»æ“Šåœ–ä¸­çš„ç¯€é»å¯ä»¥çœ‹åˆ°è©²æ¨¡çµ„çš„ Source æª”èˆ‡ç¶“ç”± Transformed å¾Œçš„ç¨‹å¼ç¢¼ã€‚</p><p><img src=https://live.staticflickr.com/65535/52593587155_3ee1de6d49_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>è€Œé€™å€‹åœ–è¡¨æœ€å¤§çš„ç”¨è™•åœ¨æ–¼ï¼Œé€éå¯è¦–åŒ–çš„æ–¹å¼å‘ˆç¾å‡ºæ¸¬è©¦ç¨‹å¼ç¢¼ä¸­å—æ¸¬ç‰©ï¼ˆSUTï¼‰èˆ‡ä¾è³´ç‰©ï¼ˆDOCï¼‰çš„ä¾è³´ç‹€æ³ã€‚</p><h3 id=console>Console</h3><p>Console é ç±¤ä¸»è¦æ˜¯é¡¯ç¤ºåœ¨æ¸¬è©¦ç¨‹å¼ç¢¼ä¸­çš„ <code>console.log</code> è³‡è¨Šï¼Œç”±æ–¼èˆ‡æ¸¬è©¦çµæœåˆ†é›¢çš„æƒ…æ³ä¸‹ï¼Œç›¸è¼ƒæ–¼åœ¨çµ‚ç«¯æ©Ÿä¸­è§€å¯Ÿ Consoleï¼Œé€™è£¡æœƒé¡¯ç¤ºå¾—æ›´åŠ æ¸…æ¥šã€‚</p><p><img src=https://live.staticflickr.com/65535/52593421919_3ea6a5b14f_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><h3 id=code>Code</h3><p>æœ€å¾Œå£“è»¸ä»‹ç´¹çš„éƒ¨åˆ†ï¼Œå‰‡æ˜¯ Code é ç±¤ï¼Œä½ å¯èƒ½æœƒè¦ºå¾—é€™æœ‰ä»€éº¼ç‰¹åˆ¥çš„ï¼Œä¸å°±æ˜¯é¡¯ç¤ºæ¸¬è©¦æª”æ¡ˆç¨‹å¼ç¢¼å—ï¼Ÿ</p><p><img src=https://live.staticflickr.com/65535/52593161396_0a9ca152a2_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>ç„¶è€Œï¼Œé€™è£¡çš„æ¸¬è©¦ç¨‹å¼ç¢¼é™¤äº†é è¦½ä¹‹å¤–ï¼Œé‚„èƒ½å¤ ç›´æ¥åœ¨ç€è¦½å™¨ä¸­ç›´æ¥ç·¨å¯«ä¸¦åŸ·è¡Œæ¸¬è©¦æŸ¥çœ‹çµæœï¼Œæ›´é‡è¦çš„æ˜¯å¯«å®Œçš„ç•¶ä¸‹æŒ‰ä¸‹å„²å­˜å®ƒé‚„èƒ½å¤ åŒæ­¥èª¿æ•´åˆ°å¯¦éš›çš„ç¨‹å¼ç¢¼ä¸­ï¼</p><p>æ¯”æ–¹åœ¨ç€è¦½å™¨ä¸­çš„æ¸¬è©¦ç¨‹å¼ç¢¼ä¸­åŠ å€‹è¨»è§£ï¼Œä¸¦å„²å­˜ï¼š</p><p><img src=https://live.staticflickr.com/65535/52593421979_128985ea34_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>å¯¦éš›æ¸¬è©¦ç¨‹å¼ç¢¼æª”æ¡ˆä¹ŸåŠ ä¸Šäº†è¨»è§£ï¼</p><p><img src=https://live.staticflickr.com/65535/52593680043_347cf27fd6_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>å¦‚æ­¤ä¸€ä¾†ï¼Œæˆ‘å€‘å°±å¯ä»¥ç›´æ¥åœ¨é€™å€‹è¦–çª—å…§æ’°å¯«æˆ‘å€‘çš„æ¸¬è©¦æ¡ˆä¾‹ï¼Œä¸¦ä¸”åœ¨ç€è¦½å™¨ä¸­å³æ™‚çœ‹åˆ°æ¸¬è©¦çµæœã€‚</p><p>ä¸éé€™è£¡æœ‰å€‹å°å°ç¼ºé»æ˜¯ï¼Œè‹¥åœ¨å°ˆæ¡ˆä¸­æœ‰è¨­å®š eslint + prettier çš„è©±ï¼Œåœ¨ç¨‹å¼ç·¨è¼¯å™¨æ’°å¯«æ¸¬è©¦æ™‚å¯ä»¥è¨­å®šå„²å­˜ç•¶ä¸‹çš„è‡ªå‹•åšæ ¼å¼åŒ–ï¼Œä½†æ˜¯ç€è¦½å™¨ä¸­çš„ç·¨è¼¯å™¨ç’°å¢ƒä¸åŒï¼Œæ‰€ä»¥å¯«æ¸¬è©¦æ™‚æœƒæ”¶åˆ°æ ¼å¼éŒ¯èª¤çš„è­¦å‘Šï¼Œä½†åœ¨ä¸è€ƒæ…®é€™é»çš„æƒ…æ³ä¸‹ï¼Œé€™å€‹å·¥å…·æ˜¯å€‹ç”¨ä¾†æª¢è¦–æ¸¬è©¦çµæœèˆ‡ä¾è³´é—œä¿‚çš„å¥½å·¥å…·ã€‚</p><p><img src=https://live.staticflickr.com/65535/52592679007_e8b05c17bd_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><hr><h2 id=ç¨‹å¼ç¢¼è¦†è“‹ç‡code-coverage>ç¨‹å¼ç¢¼è¦†è“‹ç‡ï¼ˆCode Coverageï¼‰</h2><p>åœ¨æ¸¬è©¦é ˜åŸŸä¸­ï¼Œè¦†è“‹ç‡ï¼ˆCoverageï¼‰ä¸€è©æ³›æŒ‡çš„æ˜¯ä»¥ç™¾åˆ†æ¯”è¡¨ç¤ºæ¸¬è©¦ç¨‹å¼ç¢¼èƒ½å¤ æ¶µè“‹å¤šå°‘ç”¢å“ç¨‹å¼ç¢¼çš„ç¯„åœï¼Œè€Œä¾æ“šä¸åŒçš„è¦†è“‹ç‡ç¨®é¡ï¼Œå…¶ç´°å¾®çš„å®šç¾©ä¹Ÿæœƒæœ‰æ‰€ä¸åŒã€‚</p><p>æ¥ä¸‹ä¾†æˆ‘å€‘ä»¥è¦†è“‹ç‡å·¥å…·åº« <a class=link href=https://cn.vitest.dev/guide/coverage.html target=_blank rel=noopener>c8</a> ä¾†èªªæ˜è¦†è“‹ç‡çš„æ¦‚å¿µèˆ‡å¦‚ä½•é€é <a class=link href=https://cn.vitest.dev/guide/coverage.html target=_blank rel=noopener>c8</a> åœ¨ Vitest æ¸¬è©¦ç’°å¢ƒä¸­æª¢è¦–ç•¶ä¸‹çš„æ¸¬è©¦è¦†è“‹ç‡ï¼Œæœ€å¾Œå†ä¾†è«‡è«‡æœ‰é—œæ–¼è¦†è“‹ç‡çš„ç›¸é—œè­°é¡Œã€‚</p><h3 id=c8>c8</h3><p>è¦åœ¨ Vitest æ¸¬è©¦ç’°å¢ƒä¸­ä½¿ç”¨ c8 ç”¢ç”Ÿè¦†è“‹ç‡å ±å‘Šï¼Œæˆ‘å€‘é¦–å…ˆéœ€è¦å®‰è£ <code>@vitest/coverage-c8</code>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm i -D @vitest/coverage-c8
</span></span></code></pre></td></tr></table></div></div><p>æ¥è‘—å°±å¯ä»¥åœ¨ <code>package.json</code> ä¸­æ–°å¢æŒ‡ä»¤ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;test:coverage&#34;</span><span class=p>:</span> <span class=s2>&#34;vitest --environment jsdom --coverage&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åŸ·è¡Œ <code>npm run test:coverage</code> å¾Œï¼Œé è¨­æœƒåœ¨çµ‚ç«¯æ©Ÿç”¢ç”Ÿå‡ºè¦†è“‹ç‡å ±å‘Šï¼š</p><p><img src=https://live.staticflickr.com/65535/52593680098_635ca46745_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>è€Œ c8 è¦†è“‹ç‡å ±å‘Šç¸½å…±æœ‰å››ç¨®é¡å‹ï¼š</p><ul><li>è¡Œæ•¸è¦†è“‹ç‡ï¼ˆline coverageï¼‰ï¼šä»¥è¡Œæ•¸ç‚ºå–®ä½ä¾†è¨ˆç®—ã€‚</li><li>å‡½å¼è¦†è“‹ç‡ï¼ˆfunction coverageï¼‰ï¼šä»¥å…§éƒ¨çš„å‡½å¼ç‚ºå–®ä½ä¾†è¨ˆç®—ã€‚</li><li>åˆ†æè¦†è“‹ç‡ï¼ˆbranch coverageï¼‰ï¼šä»¥æ¯å€‹åˆ¤æ–·å¼ç‚ºå–®ä½ä¾†è¨ˆç®—ã€‚</li><li>èªå¥è¦†è“‹ç‡ï¼ˆstatement coverageï¼‰ï¼šä»¥æ¯å€‹èªå¥ï¼ˆstatementï¼‰ç‚ºå–®ä½è¨ˆç®—ã€‚</li></ul><p>æ¸¬è©¦ç¨‹å¼ç¢¼æ¶µè“‹å¤šå°‘ç¯„åœçš„ç”¢å“ç¨‹å¼ç¢¼ï¼Œç”šè‡³æ–¼æ¯è¡Œç¨‹å¼ç¢¼å€‹è¢«åŸ·è¡Œäº†å¹¾æ¬¡</p><p>ä¸¦ä¸”è‹¥æœ‰æœªè¦†è“‹è¡Œæ•¸çš„æƒ…æ³ï¼Œ c8 å‰‡æœƒåœ¨ Uncovered Line ä¸­é¡¯ç¤ºæœªæ¶µè“‹çš„è¡Œæ•¸ç¯„åœï¼Œå¦‚ä¸‹åœ–ä¸­çš„ <code>13-17</code>ã€<code>19-28</code></p><p><img src=https://live.staticflickr.com/65535/52593587235_4ceba72a25_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>å€˜è‹¥ä½ è¦ºå¾—é€™ç¨®å ±å‘Šå½¢å¼ä¸æ–¹ä¾¿è§€çœ‹ï¼Œæˆ–æ˜¯å¸Œæœ›å°‡å®ƒè£½ä½œæˆæ–‡ä»¶ï¼Œå‰‡å¯ä»¥åœ¨ config.js æª”ä¸­è¨­å®š <code>coverage.reporter</code> çš„å½¢å¼ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// vite.config.js or vitest.config.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=k>default</span> <span class=nx>defineConfig</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>test</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>coverage</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>reporter</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;text&#39;</span><span class=p>,</span> <span class=s1>&#39;json&#39;</span><span class=p>,</span> <span class=s1>&#39;html&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>å…¶ä¸­ c8 æä¾›çš„å ±å‘Šï¼ˆreporterï¼‰é¸é …æœ‰ä»¥ä¸‹ä¸‰ç¨®ï¼š</p><ul><li>textï¼š åœ¨çµ‚ç«¯æ©Ÿä¸­å‘ˆç¾è¦†è“‹ç‡å ±å‘Šã€‚</li></ul><p><img src=https://live.staticflickr.com/65535/52593587245_730913e23b_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><ul><li>jsonï¼š ä»¥ JSON æ ¼å¼ç”¢ç”Ÿè¦†è“‹ç‡å ±å‘Šã€‚</li></ul><p><img src=https://live.staticflickr.com/65535/52593161446_55167b6751_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><ul><li>htmlï¼š ç”¢ç”Ÿä¸€å€‹å¯äº’å‹•çš„ HTML è¦†è“‹ç‡å ±å‘Šã€‚</li></ul><p><img src=https://live.staticflickr.com/65535/52593161441_82a1a13832_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>å…¶ä¸­ HTML çš„ç‰ˆæœ¬ä¸­ï¼Œæˆ‘å€‘é‚„å¯ä»¥é»æ“Šæ¸¬è©¦æª”æ¡ˆä¾†æŸ¥çœ‹æœªè¦†è“‹çš„è¡Œæ•¸æœ‰å“ªäº›ï¼Œç›¸è¼ƒçµ‚ç«¯æ©Ÿçš„ç‰ˆæœ¬ï¼Œæˆ‘å€‘å°±ä¸å¿…å†æ‹¿è‘—è¡Œæ•¸å»å°ç¨‹å¼ç¢¼äº†ï¼š</p><p><img src=https://live.staticflickr.com/65535/52593422039_9e7c2cf245_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><h3 id=è¦†è“‹ç‡ç›®æ¨™>è¦†è“‹ç‡ç›®æ¨™</h3><p>è€Œåœ¨ç­è§£æ€éº¼æŸ¥çœ‹è¦†è“‹ç‡å ±å‘Šå¾Œï¼Œé‚£éº¼ç©¶ç«Ÿè¦†è“‹ç‡ç›®æ¨™è¦é”åˆ°å¤šå°‘æ‰æ˜¯åˆç†å‘¢ï¼Ÿ</p><p>ä»¥ ã€Šå¯æ¸¬è©¦çš„ JavaScriptã€‹ä¸€æ›¸ä½œè€… Mark Ethan Trostler æä¾›çš„ç­”æ¡ˆæ˜¯å–®å…ƒæ¸¬è©¦å¤§ç´„è¦ä»‹æ–¼ 80 % å·¦å³ã€‚</p><p>ä»¥ Martin Fowler æ–¼ <a class=link href=https://martinfowler.com/bliki/TestCoverage.html target=_blank rel=noopener>Test Coverage</a> ä¸€æ–‡ä¸­ï¼Œå‰‡æ˜¯æŒ‡å‡ºå¤§ç´„æœƒåœ¨æ–¼ 80 è‡³ 90 % é™„è¿‘ã€‚</p><p>è‡³æ–¼ç‚ºä»€éº¼ä¸æ˜¯é”åˆ°ç™¾åˆ†ä¹‹ç™¾å‘¢ï¼Ÿæ¥ä¸‹ä¾†æˆ‘å€‘ä¾†æ¢è¨æœ‰é—œæ–¼è¦†è“‹ç‡ç›¸é—œçš„è­°é¡Œã€‚</p><h3 id=è¦†è“‹ç‡è­°é¡Œ>è¦†è“‹ç‡è­°é¡Œ</h3><h4 id=è¦†è“‹ç‡èˆ‡ä»˜å‡ºçš„å¿ƒåŠ›>è¦†è“‹ç‡èˆ‡ä»˜å‡ºçš„å¿ƒåŠ›</h4><p>é›–ç„¶ä»¥ç†è«–ä¸Šä¾†èªªç›¡å¯èƒ½å¾—é”åˆ°é«˜è¦†è“‹ç‡ï¼Œæ¸¬è©¦ç¨‹å¼ç¢¼å°‡æ¶µè“‹çš„è¶Šå®Œå…¨ï¼Œç„¶è€Œç‚ºäº†è¿½æ±‚ 100 % çš„è¦†è“‹ç‡æ‰€è¦ä»˜å‡ºçš„å¿ƒç†å°‡æœƒæˆªç„¶ä¸åŒã€‚</p><p>Jeroen Mols åœ¨ <a class=link href=https://jeroenmols.com/blog/2017/11/28/coveragproblem/ target=_blank rel=noopener>The 100% code coverage problem</a> ä¸€æ–‡ä¸­çš„æåˆ°äº†å¿ƒåŠ›ä»˜å‡ºèˆ‡è¦†è“‹ç‡çš„é—œä¿‚è¡¨ã€‚</p><p><img src=https://live.staticflickr.com/65535/52593422044_6d565f4119_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><blockquote><p>å¼•ç”¨è‡ª Jeroen Mols ã€ŠThe 100% code coverage problemã€‹ä¸€æ–‡ä¸­çš„åœ–</p></blockquote><p>å¾ä¸Šåœ–ä¸­å¯ä»¥çœ‹è¦‹ï¼Œåœ¨è¦†è“‹ç‡å¾ 0 æå‡è‡³ 80% æˆ‘å€‘åƒ…éœ€è¦ä»˜å‡ºä¸€äº›å¿ƒåŠ›å°±å¯ä»¥è¼•æ˜“é”æˆï¼Œç„¶è€Œè¦å°‡ 90% æå‡è‡³æ¥è¿‘ 100% æˆ‘å€‘å‰‡å¹¾ä¹è¦æŠ•å…¥å…©åˆ°ä¸‰å€ä»¥ä¸Šçš„å¿ƒåŠ›æ‰èƒ½å®Œæˆã€‚</p><p>å› æ­¤ï¼Œæœ‰äº›äººé›–ç„¶æœƒèªç‚º 100% çš„è¦†è“‹ç‡æ˜¯ä¸€å€‹ä¸éŒ¯çš„ç›®æ¨™ï¼Œä½†æ˜¯åœ¨å¯¦éš›ä¸Šï¼Œæˆ‘å€‘å¯èƒ½æœƒå› ç‚ºè¿½æ±‚ 100% çš„è¦†è“‹ç‡è€Œä»˜å‡ºéå¤šçš„å¿ƒåŠ›ï¼Œè€Œå°è‡´æ¸¬è©¦ç¨‹å¼ç¢¼çš„å“è³ªåè€Œè®Šå·®ã€‚</p><h4 id=è¦†è“‹ç‡-100-çš„èª¤å€>è¦†è“‹ç‡ 100% çš„èª¤å€</h4><p>åœ¨è²»ç›¡åƒè¾›è¬è‹¦å¾Œï¼Œæˆ‘å€‘çµ‚æ–¼é”åˆ°äº† 100% è¦†è“‹ç‡çš„æƒ…æ³äº†ã€‚</p><p>ç„¶è€Œï¼Œ100 % çš„è¦†è“‹ç‡åƒ…èƒ½ä»£è¡¨æ¸¬è©¦ç¨‹å¼ç¢¼å®Œæ•´ï¼ˆCompleteï¼‰çš„è¦†è“‹äº†ç”¢å“ç¨‹å¼ç¢¼ï¼Œä¸¦éä»£è¡¨æ¸¬è©¦ç¨‹å¼ç¢¼çš„å“è³ªé”åˆ°å®Œç¾ï¼ˆPerfectï¼‰ï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘ç”¨å€‹ç°¡å–®çš„ä¾‹å­ä¾†èªªæ˜ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>max</span> <span class=o>=</span> <span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=k>return</span> <span class=nx>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>test</span><span class=p>(</span><span class=s1>&#39;max&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>max</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨ä¸Šæ–¹æ¡ˆä¾‹ä¸­ï¼Œæˆ‘å€‘å¯ä»¥çœ‹è¦‹ max æ¸¬è©¦æ¡ˆä¾‹åŸºæœ¬ä¸Šå·²ç¶“å®Œå…¨è¦†è“‹äº† max å‡½å¼çš„å¯¦ä½œæƒ…æ³ï¼Œè€Œæˆ‘å€‘å¯ä»¥å¾é€™å€‹æ¡ˆä¾‹ä¸­çœ‹å‡ºå…©å€‹å•é¡Œï¼š</p><ul><li>ç”¢å“ç¨‹å¼ç¢¼æœ¬èº«æœ‰å•é¡Œï¼Œå³ä¾¿æ¸¬è©¦ç¨‹å¼ç¢¼è¦†è“‹äº† 100% çš„æƒ…æ³ä¸‹ï¼Œç”¢å“ç¨‹å¼ç¢¼æœ¬èº«ä»ç„¶æ˜¯æœ‰å•é¡Œçš„ã€‚</li><li>æ¸¬è©¦ç¨‹å¼ç¢¼æ¡ˆä¾‹èˆ‡è·¯å¾‘ä¸è¶³ï¼Œå°è‡´è¦†è“‹ç‡ç‚º 100% çš„æƒ…æ³ä¸‹ï¼Œä¸¦æ²’æœ‰æ¸¬å‡ºç”¢å“ç¨‹å¼ç¢¼ä¸­çš„å•é¡Œèˆ‡é‚Šéš›æ¡ˆä¾‹ï¼ˆedge caseï¼‰ã€‚</li></ul><p>å› æ­¤è¦†è“‹ç‡ 100% å……å…¶é‡åªæ˜¯ä¸€å€‹æŒ‡æ¨™ï¼Œç”¨ä¾†å‘Šè¨´æˆ‘å€‘æ¸¬è©¦ç¨‹å¼ç¢¼æ˜¯å¦å®Œæ•´çš„è¦†è“‹äº†ç”¢å“ç¨‹å¼ç¢¼ï¼Œè€Œéã€Œå®Œå…¨æ²’æœ‰å•é¡Œã€ã€‚</p><p>å€˜è‹¥æˆ‘å€‘æƒ³è¦ç›¡å¯èƒ½é¿å…é€™ç¨®æƒ…æ³çš„ç™¼ç”Ÿï¼Œé€™æ™‚æˆ‘å€‘å°±å¯ä»¥é€éçªè®Šæ¸¬è©¦ï¼ˆMutation Testingï¼‰ä¾†å”åŠ©æˆ‘å€‘ã€‚</p><h4 id=çªè®Šæ¸¬è©¦mutation-testing>çªè®Šæ¸¬è©¦ï¼ˆmutation testingï¼‰</h4><p>çªè®Šæ¸¬è©¦ï¼ˆMutation Testingï¼‰æ˜¯ä¸€ç¨®é©—è­‰èˆ‡æ”¹å–„æ¸¬è©¦ç¨‹å¼ç¢¼çš„æ¸¬è©¦æ–¹æ³•ï¼Œæ¦‚å¿µä¸Šä¾†èªªï¼Œä»–æœƒç›¡å¯èƒ½çš„æŠ½æ›ç”¢å“ç¨‹å¼ç¢¼ä¸­çš„æ¯å€‹è§’è½ï¼Œæ¥è‘—ä¾ç…§æŠ½æ›è¦å‰‡ä¾†é æœŸæ¸¬è©¦ç¨‹å¼ç¢¼çš„æª¢æ¸¬çµæœã€‚</p><p>å‡è¨­æˆ‘å€‘æœ‰å€‹æ¯”è¼ƒå‡½å¼å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>greaterThan</span> <span class=o>=</span> <span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>x</span> <span class=o>&gt;</span> <span class=nx>y</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œé€™æ™‚æˆ‘å€‘æ¸¬è©¦ç¨‹å¼ç¢¼å¯èƒ½æœƒé€™éº¼è™•ç†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should return true if x is greater than y&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should return false if x is less than y&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥è‘—çªè®Šæ¸¬è©¦å¯èƒ½æœƒå°‡ <code>greaterThan</code> å‡½å¼ä¸­çš„ <code>></code> ç¬¦è™Ÿæ›¿æ›æˆ <code>>=</code> ç¬¦è™Ÿï¼Œæ­¤æ™‚ç†è«–ä¸Šä¾†èªªæ‡‰è©²æœƒæœ‰æ¸¬è©¦æ¡ˆä¾‹å¤±æ•—ï¼Œä½†æ˜¯å¯¦éš›ä¸Šæ¸¬è©¦ç¨‹å¼ç¢¼å»æ²’æœ‰æª¢æ¸¬åˆ°é€™å€‹å•é¡Œï¼Œé‚£å°±è¡¨ç¤ºæˆ‘å€‘çš„æ¸¬è©¦ç¨‹å¼ç¢¼ä¸¦æ²’æœ‰è¦†è“‹åˆ°é€™å€‹æ¡ˆä¾‹ã€‚</p><p>æ­¤æ™‚æˆ‘å€‘å°±å¯ä»¥é‡å°é€™ç¨®æƒ…æ³ï¼Œå†è£œä¸Šå°æ‡‰çš„æ¸¬è©¦æ¡ˆä¾‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should return true if x is greater than y&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>0</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should return false if x is less than y&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>100</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=c1>// æ–°å¢æ¡ˆä¾‹
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>it</span><span class=p>(</span><span class=s1>&#39;should return false if x is equal y&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>expect</span><span class=p>(</span><span class=nx>greaterThan</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)).</span><span class=nx>toBe</span><span class=p>(</span><span class=kc>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><p>æ¥è‘—çªè®Šæ¸¬è©¦å†åº¦å°‡ <code>></code> ç¬¦è™Ÿæ›¿æ›æˆå„ç¨®ç¬¦è™Ÿï¼ˆe.g. <code>&lt;=</code>ï¼‰ï¼Œç”šè‡³æ˜¯å°‡ <code>{}</code> èªå¥ï¼ˆstatementï¼‰æ¸…ç©ºï¼Œè€Œè«¸å¦‚æ­¤é¡çš„æ‰‹æ³•ï¼Œå°±æ˜¯çªè®Šæ¸¬è©¦çš„æ ¸å¿ƒæ¦‚å¿µã€‚</p><blockquote><p>è‹¥æƒ³æ‰‹å‹•ç½®æ›ç”¢å“ç¨‹å¼ç¢¼ä¸­çš„ç¬¦è™Ÿï¼Œå¯ä»¥å¾é€™äº›æ–¹æ³•ä¸‹æ‰‹</p><ul><li>operator: +, -, *, /</li><li>condition: &lt;, >, &lt;=, >=, ==, ===, !=, !==</li><li>statement: {}, if, else, for, return, throw, try, catch</li><li>expression: &&, ||, !</li></ul></blockquote><h4 id=çªè®Šæ¸¬è©¦çš„å·¥å…·>çªè®Šæ¸¬è©¦çš„å·¥å…·</h4><p>é›–ç„¶èªªæˆ‘å€‘å¯ä»¥æ‰‹å‹•ç½®æ›ç”¢å“ç¨‹å¼ç¢¼ä¸­çš„å„ç¨®ç¬¦è™Ÿï¼Œä½†æ˜¯é€™æ¨£çš„ä½œæ³•æœƒè®“æˆ‘å€‘çš„å·¥ä½œé‡è®Šå¾—éå¸¸é¾å¤§ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥é€éå·¥å…·ä¾†å”åŠ©æˆ‘å€‘å®Œæˆé€™äº›å·¥ä½œã€‚</p><p>ä»¥å‰ç«¯é ˜åŸŸä¾†èªªï¼Œæˆ‘å€‘å¯ä»¥é€é <a class=link href=https://stryker-mutator.io/ target=_blank rel=noopener>Stryker Mutator</a> åº•ä¸‹çš„ <code>stryker-js</code> å·¥å…·ä¾†å®Œæˆé€™äº›å·¥ä½œã€‚</p><p><img src=https://live.staticflickr.com/65535/52593422049_ccee2eefd4_o.png max-width=100% max-height=100% class=gallery-image loading=lazy></p><p>Stryker Mutator çš„æ¦‚å¿µå°±æ˜¯é€éæ›¿æ›ä¸åŒçš„ç¬¦è™Ÿç”¢ç”Ÿå‡ºçªè®Šçš„å…§å®¹ï¼Œè€Œæˆ‘å€‘çš„æ¸¬è©¦ç¨‹å¼ç¢¼æ‡‰è©²è¦æ•æ‰åˆ°é‚£äº›ä¸åˆç†çš„æƒ…æ³ï¼Œè—‰æ­¤ä¾†ä¿è­‰æˆ‘å€‘çš„æ¸¬è©¦æ¡ˆä¾‹æœ‰ä¸€å®šçš„ç©©å›ºæ€§ã€‚</p><p>ç„¶è€Œï¼Œå¯æƒœçš„æ˜¯ <code>stryker-js</code> ç›®å‰åƒ…æ”¯æ´åˆ° Jest ç’°å¢ƒï¼Œå°šæœªæ”¯æ´ Vitest çš„ç’°å¢ƒï¼Œå› æ­¤æˆ‘é€™é‚Šå°±æš«ä¸åšä»‹ç´¹äº†ï¼Œæœ‰èˆˆè¶£è€…å¯ä»¥è¿½è¹¤è©² <a class=link href=https://github.com/stryker-mutator/stryker-js/issues/3465 target=_blank rel=noopener>issue</a> ç›®å‰çš„æœ€æ–°é€²åº¦ã€‚</p><hr></section><footer class=article-footer><section class=article-tags><a href=https://wayneblog.ga/tags/vitest/>vitest</a>
<a href=https://wayneblog.ga/tags/typescript/>typescript</a>
<a href=https://wayneblog.ga/tags/javascript/>javascript</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸é—œæ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=https://wayneblog.ga/2023-03-10/petite-vue-introduction/><div class=article-image><img src=https://live.staticflickr.com/65535/52736941727_b3a1dcf3c3_o.jpg loading=lazy data-key=petite-vue-introduction data-hash=https://live.staticflickr.com/65535/52736941727_b3a1dcf3c3_o.jpg></div><div class=article-details><h2 class=article-title>ã€Petite-Vueã€‘å¤§å°åªæœ‰ ~6KB çš„ mini Vueï¼</h2></div></a></article><article class=has-image><a href=https://wayneblog.ga/2023-02-21/ts-express-server/><div class=article-image><img src=https://live.staticflickr.com/65535/52702210344_fe78a142e7_o.png loading=lazy data-key=ts-express-server data-hash=https://live.staticflickr.com/65535/52702210344_fe78a142e7_o.png></div><div class=article-details><h2 class=article-title>ã€Node.jsã€‘ç”¨ Typescript èˆ‡ Express å»ºç«‹ä¸€å€‹ server</h2></div></a></article><article class=has-image><a href=https://wayneblog.ga/2023-01-16/nuxt-nuxt3-practice-project/><div class=article-image><img src=https://live.staticflickr.com/65535/52630283696_c93e29e870_o.png loading=lazy data-key=nuxt-nuxt3-practice-project data-hash=https://live.staticflickr.com/65535/52630283696_c93e29e870_o.png></div><div class=article-details><h2 class=article-title>ã€Nuxt3ã€‘å¯¦æˆ°ç·´ç¿’ - å¯¦ä½œéƒ¨è½æ ¼</h2></div></a></article><article class=has-image><a href=https://wayneblog.ga/2023-01-14/nuxt-try-nuxt3/><div class=article-image><img src=https://live.staticflickr.com/65535/52616698791_b7b8bbce05_o.jpg loading=lazy data-key=nuxt-try-nuxt3 data-hash=https://live.staticflickr.com/65535/52616698791_b7b8bbce05_o.jpg></div><div class=article-details><h2 class=article-title>ã€Nuxt3ã€‘é–‹ç®±å³ç”¨çš„ Nuxt3 ç©è½‰ç­†è¨˜</h2></div></a></article><article class=has-image><a href=https://wayneblog.ga/2022-11-22/create-own-vscode-extension/><div class=article-image><img src=https://live.staticflickr.com/65535/52516420035_bc4b9df19c_o.png loading=lazy data-key=create-own-vscode-extension data-hash=https://live.staticflickr.com/65535/52516420035_bc4b9df19c_o.png></div><div class=article-details><h2 class=article-title>ä»Šå¤©ä¾†æä¸€å€‹å±¬æ–¼è‡ªå·±çš„ VScode Extension å§ï¼</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-blog-wayne.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 Wayne's blog | å‰æ©çš„éƒ¨è½æ ¼ | æŠ€è¡“åšå®¢</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=https://wayneblog.ga/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script>"serviceWorker"in navigator&&(console.log("Check service worker register?"),navigator.serviceWorker.register("./service-worker.js").then(function(){console.log("service worker registed.")}).catch(function(e){console.log("service worker registed fail. This happened: ",e)}));function toggleBtnScrollTop(){let t=document.documentElement.scrollTop||document.body.scrollTop;const e=document.getElementById("btnScrollTop");if(t){e&&!e.classList.contains("show")&&e.classList.add("show");return}e&&e.classList.contains("show")&&e.classList.remove("show")}window.addEventListener("scroll",toggleBtnScrollTop),document.addEventListener("DOMContentLoaded",toggleBtnScrollTop);function clickToScrollTop(){window.scrollTo({top:0,behavior:"smooth"})}</script><button id=btnScrollTop onclick=clickToScrollTop() title=å›åˆ°é é ‚>
<img src=https://wayneblog.ga/img/top_huf0c1dc16de3f1372c70e7aced5d60e6d_660_30x0_resize_box_3.png alt=scroll-top></button><div id=fb-root></div><div id=fb-customer-chat class=fb-customerchat></div><script>var chatbox=document.getElementById("fb-customer-chat");chatbox.setAttribute("page_id","100278986238046"),chatbox.setAttribute("attribution","biz_inbox")</script><script>window.fbAsyncInit=function(){FB.init({appId:"588798512613170",status:!0,xfbml:!0,version:"v16.0"})},function(e,t,n){var s,o=e.getElementsByTagName(t)[0];if(e.getElementById(n))return;s=e.createElement(t),s.id=n,s.src="https://connect.facebook.net/zh_TW/sdk/xfbml.customerchat.js",o.parentNode.insertBefore(s,o)}(document,"script","facebook-jssdk")</script></body></html>