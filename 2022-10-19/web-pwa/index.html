<!doctype html><html lang=zh-tw dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="æ¼¸é€²å¼ç¶²è·¯æ‡‰ç”¨ç¨‹å¼ï¼ˆè‹±èªï¼šProgressive Web Appsï¼Œç°¡ç¨±ï¼šPWAï¼‰æ˜¯ä¸€ç¨®æ™®é€šç¶²é æˆ–ç¶²ç«™æ¶æ§‹èµ·ä¾†çš„ç¶²è·¯æ‡‰ç”¨ç¨‹å¼ï¼Œä½†å®ƒå¯ä»¥ä»¥å‚³çµ±æ‡‰ç”¨ç¨‹å¼æˆ–åŸç”Ÿè¡Œå‹•æ‡‰ç”¨ç¨‹å¼å½¢å¼å±•ç¤ºçµ¦ä½¿ç”¨è€…ã€‚é€™ç¨®æ‡‰ç”¨ç¨‹å¼å½¢æ…‹è¦–åœ–å°‡ç›®å‰æœ€ç‚ºç¾ä»£åŒ–çš„ç€è¦½å™¨æä¾›çš„åŠŸèƒ½èˆ‡è¡Œå‹•è£ç½®çš„é«”é©—å„ªå‹¢ç›¸çµåˆã€‚"><meta name=keywords content="progressive web application,pwa,web app,manifest,manifest.json,service-worker,service-worker.js,web push,firebase,sw"><title>å°‡ç¶²é è®ŠæˆProgressive Web Application(PWA)ï¼Œæ¼¸é€²å¼çš„ç¶²é æ‡‰ç”¨ç¨‹å¼</title><link rel=canonical href=https://wayneblog.ga/2022-10-19/web-pwa/><link rel=stylesheet href=https://wayneblog.ga/scss/style.min.144cc1234ba1d1388a6e1b3581fd085e42c24bba86f794bcaeadf65410d5faf7.css><script>!function(e,t,n,s,o,i,a){if(e.fbq)return;o=e.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)},e._fbq||(e._fbq=o),o.push=o,o.loaded=!0,o.version="2.0",o.queue=[],i=t.createElement(n),i.async=!0,i.src=s,a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(i,a)}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js"),fbq("init","843131703668116"),fbq("track","PageView")</script><noscript><img height=1 width=1 style=display:none src="https://www.facebook.com/tr?id=843131703668116&ev=PageView&noscript=1"></noscript><meta property="og:title" content="å°‡ç¶²é è®ŠæˆProgressive Web Application(PWA)ï¼Œæ¼¸é€²å¼çš„ç¶²é æ‡‰ç”¨ç¨‹å¼"><meta property="og:description" content="æ¼¸é€²å¼ç¶²è·¯æ‡‰ç”¨ç¨‹å¼ï¼ˆè‹±èªï¼šProgressive Web Appsï¼Œç°¡ç¨±ï¼šPWAï¼‰æ˜¯ä¸€ç¨®æ™®é€šç¶²é æˆ–ç¶²ç«™æ¶æ§‹èµ·ä¾†çš„ç¶²è·¯æ‡‰ç”¨ç¨‹å¼ï¼Œä½†å®ƒå¯ä»¥ä»¥å‚³çµ±æ‡‰ç”¨ç¨‹å¼æˆ–åŸç”Ÿè¡Œå‹•æ‡‰ç”¨ç¨‹å¼å½¢å¼å±•ç¤ºçµ¦ä½¿ç”¨è€…ã€‚é€™ç¨®æ‡‰ç”¨ç¨‹å¼å½¢æ…‹è¦–åœ–å°‡ç›®å‰æœ€ç‚ºç¾ä»£åŒ–çš„ç€è¦½å™¨æä¾›çš„åŠŸèƒ½èˆ‡è¡Œå‹•è£ç½®çš„é«”é©—å„ªå‹¢ç›¸çµåˆã€‚"><meta property="og:url" content="https://wayneblog.ga/2022-10-19/web-pwa/"><meta property="og:site_name" content="Wayne's blog | å‰æ©çš„éƒ¨è½æ ¼ | æŠ€è¡“åšå®¢"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="pwa"><meta property="article:tag" content="seo"><meta property="article:published_time" content="2022-10-19T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-19T00:00:00+00:00"><meta property="og:image" content="https://live.staticflickr.com/65535/52438994804_33f71b7e35_o.jpg"><meta name=twitter:site content="@4006wayne"><meta name=twitter:creator content="@4006wayne"><meta name=twitter:title content="å°‡ç¶²é è®ŠæˆProgressive Web Application(PWA)ï¼Œæ¼¸é€²å¼çš„ç¶²é æ‡‰ç”¨ç¨‹å¼"><meta name=twitter:description content="æ¼¸é€²å¼ç¶²è·¯æ‡‰ç”¨ç¨‹å¼ï¼ˆè‹±èªï¼šProgressive Web Appsï¼Œç°¡ç¨±ï¼šPWAï¼‰æ˜¯ä¸€ç¨®æ™®é€šç¶²é æˆ–ç¶²ç«™æ¶æ§‹èµ·ä¾†çš„ç¶²è·¯æ‡‰ç”¨ç¨‹å¼ï¼Œä½†å®ƒå¯ä»¥ä»¥å‚³çµ±æ‡‰ç”¨ç¨‹å¼æˆ–åŸç”Ÿè¡Œå‹•æ‡‰ç”¨ç¨‹å¼å½¢å¼å±•ç¤ºçµ¦ä½¿ç”¨è€…ã€‚é€™ç¨®æ‡‰ç”¨ç¨‹å¼å½¢æ…‹è¦–åœ–å°‡ç›®å‰æœ€ç‚ºç¾ä»£åŒ–çš„ç€è¦½å™¨æä¾›çš„åŠŸèƒ½èˆ‡è¡Œå‹•è£ç½®çš„é«”é©—å„ªå‹¢ç›¸çµåˆã€‚"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://live.staticflickr.com/65535/52438994804_33f71b7e35_o.jpg"><link rel="shortcut icon" href=https://live.staticflickr.com/65535/52275825736_808b1fd4a8_o.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-FG6KQD7H6C"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FG6KQD7H6C",{anonymize_ip:!1})}</script><script></script><style>:root{--zh-font-family:"Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”";--code-font-family:Menlo, Monaco, Consolas, "Courier New"}</style><meta name=theme-color content="#57BCB9"><link rel=manifest href=./manifest.json><link rel=apple-touch-icon sizes=57x57 href=./apple-touch-icon-57x57.webp><link rel=apple-touch-icon sizes=114x114 href=./apple-touch-icon-114x114.webp><link rel=apple-touch-icon sizes=120x120 href=./apple-touch-icon-120x120.webp><link rel=apple-touch-icon sizes=180x180 href=./apple-touch-icon-180x180.webp><link rel=apple-touch-icon sizes=192x192 href=./apple-touch-icon-192x192.webp><link rel=apple-touch-icon sizes=512x512 href=./apple-touch-icon-512x512.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ›é¸å–®>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=https://wayneblog.ga/><img src=https://wayneblog.ga/img/avatar2d.webp width=256 height=256 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>ğŸ’µ</span></figure><div class=site-meta><h1 class=site-name><a href=https://wayneblog.ga/>Wayne (å‰æ©)</a></h1><h2 class=site-description>Web App | Javascript | æŠ€è¡“åšå®¢</h2></div></header><ol class=social-menu><li><a href='https://www.facebook.com/profile.php?id=100072246543642' target=_blank title=Facebook><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48" height="48"><linearGradient id="CXanuwD9EGkBgTn76_1mxa" x1="9.993" x2="40.615" y1="-299.993" y2="-330.615" gradientTransform="matrix(1 0 0 -1 0 -290)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#2aa4f4"/><stop offset="1" stop-color="#007ad9"/></linearGradient><path fill="url(#CXanuwD9EGkBgTn76_1mxa)" d="M24 4C12.954 4 4 12.954 4 24c0 10.028 7.379 18.331 17.004 19.777C21.981 43.924 22.982 41 24 41c.919.0 1.824 2.938 2.711 2.818C36.475 42.495 44 34.127 44 24 44 12.954 35.046 4 24 4z"/><path d="M27.707 21.169c0-1.424.305-3.121 1.757-3.121h4.283l-.001-5.617-.05-.852-.846-.114c-.608-.082-1.873-.253-4.206-.253-5.569.0-8.636 3.315-8.636 9.334v2.498H15.06v7.258h4.948V43.6C21.298 43.861 22.633 44 24 44c1.268.0 2.504-.131 3.707-.357V30.301h5.033l1.122-7.258h-6.155V21.169z" opacity=".05"/><path d="M27.207 21.169c0-1.353.293-3.621 2.257-3.621h3.783V12.46l-.026-.44-.433-.059c-.597-.081-1.838-.249-4.143-.249-5.323.0-8.136 3.055-8.136 8.834v2.998H15.56v6.258h4.948v13.874C21.644 43.876 22.806 44 24 44c1.094.0 2.16-.112 3.207-.281V29.801h5.104l.967-6.258h-6.072V21.169z" opacity=".05"/><path fill="#fff" d="M26.707 29.301h5.176l.813-5.258h-5.989v-2.874c0-2.184.714-4.121 2.757-4.121h3.283V12.46c-.577-.078-1.797-.248-4.102-.248-4.814.0-7.636 2.542-7.636 8.334v3.498H16.06v5.258h4.948v14.475C21.988 43.923 22.981 44 24 44c.921.0 1.82-.062 2.707-.182V29.301z"/></svg></a></li><li><a href=https://github.com/wjdesign target=_blank title=GitHub><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.instagram.com/huai_lin/ target=_blank title=Instagram><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48" height="48"><path fill="#304ffe" d="M41.67 13.48c-.4.26-.97.5-1.21.77-.09.09-.14.19-.12.29v1.03l-.3 1.01-.3 1-.33 1.1-.68 2.25-.66 2.22-.5 1.67c0 .26-.01.52-.03.77-.07.96-.27 1.88-.59 2.74-.19.53-.42 1.04-.7 1.52-.1.19-.22.38-.34.56-.4.63-.88 1.21-1.41 1.72-.41.41-.86.79-1.35 1.11h-.01c-.08.07-.17.13-.27.18-.31.21-.64.39-.98.55-.23.12-.46.22-.7.31-.05.03-.11.05-.16.07-.57.27-1.23.45-1.89.54-.04.01-.07.01-.11.02-.4.07-.79.13-1.19.16-.18.02-.37.03-.55.03l-.71-.04-3.42-.18c0-.01-.01.0-.01.0l-1.72-.09c-.13.0-.27.0-.4-.01-.54-.02-1.06-.08-1.58-.19h-.01c-.95-.18-1.86-.5-2.71-.93-.47-.24-.93-.51-1.36-.82-.18-.13-.35-.27-.52-.42-.48-.4-.91-.83-1.31-1.27-.06-.06-.11-.12-.16-.18-.06-.06-.12-.13-.17-.19-.38-.48-.7-.97-.96-1.49-.24-.46-.43-.95-.58-1.49-.06-.19-.11-.37-.15-.57-.01-.01-.02-.03-.02-.05-.1-.41-.19-.84-.24-1.27-.06-.33-.09-.66-.09-1-.02-.13-.02-.27-.02-.4l1.91-2.95 1.87-2.88.85-1.31.77-1.18.26-.41v-1.03c.02-.23.03-.47.02-.69-.01-.7-.15-1.38-.38-2.03-.22-.69-.53-1.34-.85-1.94-.38-.69-.78-1.31-1.11-1.87C14 7.4 13.66 6.73 13.75 6.26 14.47 6.09 15.23 6 16 6h16c4.18.0 7.78 2.6 9.27 6.26C41.43 12.65 41.57 13.06 41.67 13.48z"/><path fill="#4928f4" d="M42 16v.27l-1.38.8-.88.51-.97.56-1.94 1.13-1.9 1.1-1.94 1.12-.77.45c0 .48-.12.92-.34 1.32-.31.58-.83 1.06-1.49 1.47-.67.41-1.49.74-2.41.98.0.0.0-.01-.01.0-3.56.92-8.42.5-10.78-1.26-.66-.49-1.12-1.09-1.32-1.78-.06-.23-.09-.48-.09-.73v-7.19c.01-.15-.09-.3-.27-.45-.54-.43-1.81-.84-3.23-1.25-1.11-.31-2.3-.62-3.3-.92-.79-.24-1.46-.48-1.86-.71.18-.35.39-.7.61-1.03 1.4-2.05 3.54-3.56 6.02-4.13C14.47 6.09 15.23 6 16 6h10.8c5.37.94 10.32 3.13 14.47 6.26.16.39.3.8.4 1.22.18.66.29 1.34.32 2.05C42 15.68 42 15.84 42 16z"/><path fill="#6200ea" d="M42 16v4.41l-.22.68-.75 2.33-.78 2.4-.41 1.28-.38 1.19-.37 1.13-.36 1.12-.19.59-.25.78c0 .76-.02 1.43-.07 2-.01.06-.02.12-.02.18-.06.53-.14.98-.27 1.36-.01.06-.03.12-.05.17-.26.72-.65 1.18-1.23 1.48-.14.08-.3.14-.47.2-.53.18-1.2.27-2.02.32-.6.04-1.29.05-2.07.05H31.4l-1.19-.05L30 37.61l-2.17-.09-2.2-.09-7.25-.3-1.88-.08h-.26c-.78-.01-1.45-.06-2.03-.14-.84-.13-1.49-.35-1.98-.68-.7-.45-1.11-1.11-1.35-2.03-.06-.22-.11-.45-.14-.7-.1-.58-.15-1.25-.18-2 0-.15.0-.3-.01-.46-.01-.01.0-.01.0-.01v-.58c-.01-.29-.01-.59-.01-.9l.05-1.61.03-1.15.04-1.34v-.19l.07-2.46.07-2.46.07-2.31.06-2.27.02-.6c0-.31-1.05-.49-2.22-.64-.93-.12-1.95-.23-2.56-.37.05-.23.1-.46.16-.68.18-.72.45-1.4.79-2.05.18-.35.39-.7.61-1.03 2.16-.95 4.41-1.69 6.76-2.17 2.06-.43 4.21-.66 6.43-.66 7.36.0 14.16 2.49 19.54 6.69.52.4 1.03.83 1.53 1.28C42 15.68 42 15.84 42 16z"/><path fill="#673ab7" d="M42 18.37v4.54l-.55 1.06-1.05 2.05-.56 1.08-.51.99-.22.43c0 .31.0.61-.02.9.0.43-.02.84-.05 1.22-.04.45-.1.86-.16 1.24-.15.79-.36 1.47-.66 2.03-.04.07-.08.14-.12.2-.11.18-.24.35-.38.51-.18.22-.38.41-.61.57-.34.26-.74.47-1.2.63-.57.21-1.23.35-2.01.43-.51.05-1.07.08-1.68.08l-.42.02-2.08.12h-.01L27.5 36.6l-2.25.13-3.1.18-3.77.22-.55.03c-.51.0-.99-.03-1.45-.09-.05-.01-.09-.02-.14-.02-.68-.11-1.3-.29-1.86-.54-.68-.3-1.27-.7-1.77-1.18-.44-.43-.82-.92-1.13-1.47-.07-.13-.14-.25-.2-.39-.3-.59-.54-1.25-.72-1.97-.03-.12-.06-.25-.08-.38-.06-.23-.11-.47-.14-.72-.11-.64-.17-1.32-.2-2.03v-.01c-.01-.29-.02-.57-.02-.87l-.49-1.17-.07-.18L9.5 25.99 8.75 24.2l-.12-.29-.72-1.73-.8-1.93H7.1L6.29 18.3 6 17.59V16c0-.63.06-1.25.17-1.85.05-.23.1-.46.16-.68.85-.49 1.74-.94 2.65-1.34 2.08-.93 4.31-1.62 6.62-2.04 1.72-.31 3.51-.48 5.32-.48 7.31.0 13.94 2.65 19.12 6.97.2.16.39.32.58.49C41.09 17.48 41.55 17.91 42 18.37z"/><path fill="#8e24aa" d="M42 21.35v5.14l-.57 1.19-1.08 2.25-.01.03c0 .43-.02.82-.05 1.17-.1 1.15-.38 1.88-.84 2.33-.33.34-.74.53-1.25.63-.03.01-.07.01-.1.02-.16.03-.33.05-.51.05-.62.06-1.35.02-2.19-.04-.09.0-.19-.01-.29-.02-.61-.04-1.26-.08-1.98-.11-.39-.01-.8-.02-1.22-.02h-.02l-1.01.08h-.01l-2.27.16-2.59.2-.38.03-3.03.22-1.57.12-1.55.11c-.27.0-.53.0-.79-.01.0.0-.01-.01-.01.0-1.13-.02-2.14-.09-3.04-.26-.83-.14-1.56-.36-2.18-.69-.64-.31-1.17-.75-1.6-1.31-.41-.55-.71-1.24-.9-2.07v-.01c-.14-.67-.22-1.45-.22-2.33l-.15-.27L9.7 26.35l-.13-.22L9.5 25.99l-.93-1.65-.46-.83-.58-1.03-1-1.79L6 19.75v-3.68c.88-.58 1.79-1.09 2.73-1.55 1.14-.58 2.32-1.07 3.55-1.47 1.34-.44 2.74-.79 4.17-1.02 1.45-.24 2.94-.36 4.47-.36 6.8.0 13.04 2.43 17.85 6.47.22.17.43.36.64.54.84.75 1.64 1.56 2.37 2.41C41.86 21.18 41.94 21.26 42 21.35z"/><path fill="#c2185b" d="M42 24.71v7.23c-.24-.14-.57-.31-.98-.49-.22-.11-.47-.22-.73-.32-.38-.17-.79-.33-1.25-.49-.1-.04-.2-.07-.31-.1-.18-.07-.37-.13-.56-.19-.59-.18-1.24-.35-1.92-.5-.26-.05-.53-.1-.8-.14-.87-.15-1.8-.24-2.77-.25-.08-.01-.17-.01-.25-.01l-2.57.02-3.5.02h-.01l-7.49.06c-2.38.0-3.84.57-4.72.8.0.0-.01.0-.01.01-.93.24-1.22.09-1.3-1.54-.02-.45-.03-1.03-.03-1.74l-.56-.43-.98-.74-.6-.46-.12-.09L8.88 24.1l-.25-.19-.52-.4-.96-.72L6 21.91v-3.4c.1-.08.19-.15.29-.21 1.45-1 3-1.85 4.64-2.54 1.46-.62 3-1.11 4.58-1.46.43-.09.87-.18 1.32-.24 1.33-.23 2.7-.34 4.09-.34 6.01.0 11.53 2.09 15.91 5.55.66.52 1.3 1.07 1.9 1.66.82.78 1.59 1.61 2.3 2.49.14.18.28.36.42.55C41.64 24.21 41.82 24.46 42 24.71z"/><path fill="#d81b60" d="M42 28.72V32c0 .65-.06 1.29-.18 1.91-.18.92-.49 1.8-.91 2.62-.22.05-.47.05-.75.01-.63-.11-1.37-.44-2.17-.87-.04-.01-.08-.03-.11-.05-.25-.13-.51-.27-.77-.43-.53-.29-1.09-.61-1.65-.91-.12-.06-.24-.12-.35-.18-.64-.33-1.3-.63-1.96-.86h-.01c-.14-.05-.29-.1-.44-.14-.57-.16-1.15-.26-1.71-.26l-1.1-.32-4.87-1.41h-.01l-2.99-.87h-.01l-1.3-.38c-3.76.0-6.07 1.6-7.19.99-.44-.23-.7-.81-.79-1.95-.03-.32-.04-.68-.04-1.1l-1.17-.57-.05-.02h-.01l-.84-.42L9.7 26.35l-.07-.03-.17-.09L7.5 25.28 6 24.55v-3.43c.17-.15.35-.29.53-.43.19-.15.38-.29.57-.44h.01c1.18-.85 2.43-1.6 3.76-2.22 1.55-.74 3.2-1.31 4.91-1.68.25-.06.51-.12.77-.16 1.42-.27 2.88-.41 4.37-.41 5.27.0 10.11 1.71 14.01 4.59 1.13.84 2.18 1.77 3.14 2.78.79.83 1.52 1.73 2.18 2.67.05.07.1.14.15.2.37.54.71 1.09 1.03 1.66C41.64 28.02 41.82 28.37 42 28.72z"/><path fill="#f50057" d="M41.82 33.91c-.18.92-.49 1.8-.91 2.62-.19.37-.4.72-.63 1.06-.14.21-.29.41-.44.6-.36-.14-.89-.34-1.54-.56v-.01c-.49-.17-1.05-.35-1.65-.52-.17-.05-.34-.1-.52-.15-.71-.19-1.45-.36-2.17-.46-.6-.1-1.19-.16-1.74-.16l-.46-.13h-.01l-2.42-.7-1.49-.43-1.66-.48h-.01l-.54-.15-6.53-1.88-1.88-.54-1.4-.33-2.28-.54-.28-.07h-.01l-2.29-.53v-.01l-.41-.09-.21-.05-1.67-.39-.19-.05-1.42-1.17L6 27.9v-4.08c.37-.36.75-.7 1.15-1.03.12-.11.25-.21.38-.31.12-.1.25-.2.38-.3.91-.69 1.87-1.31 2.89-1.84 1.3-.7 2.68-1.26 4.13-1.66.28-.09.56-.17.85-.23 1.64-.41 3.36-.62 5.14-.62 4.47.0 8.63 1.35 12.07 3.66 1.71 1.15 3.25 2.53 4.55 4.1.66.79 1.26 1.62 1.79 2.5.05.07.09.13.13.2.32.53.62 1.08.89 1.64.25.5.47 1 .67 1.52C41.34 32.25 41.6 33.07 41.82 33.91z"/><path fill="#ff1744" d="M40.28 37.59c-.14.21-.29.41-.44.6-.44.55-.92 1.05-1.46 1.49-.47.39-.97.74-1.5 1.04-.2-.05-.4-.11-.61-.19-.66-.23-1.35-.61-1.99-1.01-.96-.61-1.79-1.27-2.16-1.57-.14-.12-.21-.18-.21-.18l-1.7-.15L30 37.6l-2.2-.19-2.28-.2-3.37-.3-5.34-.47-.02-.01-1.88-.91-1.9-.92-1.53-.74-.33-.16-.41-.2-1.42-.69L7.43 31.9l-.59-.29L6 31.35v-4.47c.47-.56.97-1.09 1.5-1.6.34-.32.7-.64 1.07-.94.06-.05.12-.1.18-.14.04-.05.09-.08.13-.1.59-.48 1.21-.91 1.85-1.3.74-.47 1.52-.89 2.33-1.24.87-.39 1.78-.72 2.72-.97 1.63-.46 3.36-.7 5.14-.7 4.08.0 7.85 1.24 10.96 3.37 1.99 1.36 3.71 3.08 5.07 5.07.45.64.85 1.32 1.22 2.02.13.26.26.52.37.78.12.25.23.5.34.75.21.52.4 1.04.57 1.58.32 1 .56 2.02.71 3.08C40.21 36.89 40.25 37.24 40.28 37.59z"/><path fill="#ff5722" d="M38.39 39.42c0 .08.0.17-.01.26-.47.39-.97.74-1.5 1.04-.22.12-.44.24-.67.34-.23.11-.46.21-.7.3-.34-.18-.8-.4-1.29-.61-.69-.31-1.44-.59-2.02-.68-.14-.03-.27-.04-.39-.04l-1.64-.21h-.02l-2.04-.27-2.06-.27-.96-.12-7.56-.98c-.49.0-1.01-.03-1.55-.1-.66-.06-1.35-.16-2.04-.3-.68-.12-1.37-.28-2.03-.45-.69-.16-1.37-.35-2-.53-.73-.22-1.41-.43-1.98-.62-.47-.15-.87-.29-1.18-.4-.18-.43-.33-.88-.44-1.34C6.1 33.66 6 32.84 6 32v-1.67c.32-.53.67-1.05 1.06-1.54.71-.94 1.52-1.8 2.4-2.56.03-.04.07-.07.1-.09l.01-.01c.31-.28.63-.53.97-.77.04-.04.08-.07.12-.1.16-.12.33-.24.51-.35 1.43-.97 3.01-1.73 4.7-2.24 1.6-.48 3.29-.73 5.05-.73 3.49.0 6.75 1.03 9.47 2.79 2.01 1.29 3.74 2.99 5.06 4.98.16.23.31.46.46.7.69 1.17 1.26 2.43 1.68 3.75.05.15.09.3.13.46.08.27.15.55.21.83.02.07.04.14.06.22.14.63.24 1.29.31 1.95v.01C38.36 38.22 38.39 38.82 38.39 39.42z"/><path fill="#ff6f00" d="M36.33 39.42c0 .35-.02.73-.06 1.11-.02.18-.04.36-.06.53-.23.11-.46.21-.7.3-.45.17-.91.31-1.38.41-.32.07-.65.13-.98.16h-.01c-.31-.19-.67-.42-1.04-.68-.67-.47-1.37-1-1.93-1.43-.01-.01-.01-.01-.02-.02-.59-.45-1.01-.79-1.01-.79l-1.06.04-2.04.07-.95.04-3.82.14-3.23.12c-.21.01-.46.01-.77.0h-.01c-.42-.01-.92-.04-1.47-.09-.64-.05-1.34-.11-2.05-.18-.69-.08-1.39-.16-2.06-.24-.74-.08-1.44-.17-2.04-.25-.47-.06-.88-.11-1.21-.15-.28-.32-.53-.65-.77-1.01-.36-.54-.67-1.11-.91-1.72-.18-.43-.33-.88-.44-1.34.29-.89.67-1.73 1.12-2.54.36-.66.78-1.29 1.24-1.89.45-.59.94-1.14 1.47-1.64v-.01c.15-.15.3-.29.45-.42.28-.26.57-.5.87-.73h.01c.01-.02.02-.02.03-.03.24-.19.49-.36.74-.53 1.48-1.01 3.15-1.76 4.95-2.2 1.19-.29 2.44-.45 3.73-.45 2.54.0 4.94.61 7.05 1.71h.01c1.81.93 3.41 2.21 4.7 3.75.71.82 1.32 1.72 1.82 2.67.35.64.65 1.31.9 1.99.02.06.04.11.06.16.17.5.32 1.02.45 1.54.09.37.16.75.22 1.13.02.12.04.23.05.35C36.28 37.99 36.33 38.7 36.33 39.42z"/><path fill="#ff9800" d="M34.28 39.42v.1c0 .34-.03.77-.06 1.23-.03.34-.06.69-.09 1.02-.32.07-.65.13-.98.16h-.01C32.76 41.98 32.39 42 32 42h-1.75l-.38-.11-1.97-.6-2-.6-4.63-1.39-2-.6s-.83.33-2 .72h-.01c-.45.15-.94.31-1.46.47-.65.19-1.34.38-2.02.53-.7.16-1.39.28-2.01.33-.19.02-.38.03-.55.03-.56-.31-1.1-.68-1.59-1.09-.43-.36-.83-.75-1.2-1.18-.28-.32-.53-.65-.77-1.01.07-.45.15-.89.27-1.32.3-1.19.77-2.33 1.39-3.37.34-.59.72-1.16 1.16-1.69.01-.03.04-.06.07-.08-.01-.01.0-.01.0-.01.13-.17.27-.33.41-.48v-.01c.41-.44.83-.86 1.29-1.25.16-.13.31-.26.48-.39.03-.03.06-.05.1-.08 2.25-1.72 5.06-2.76 8.09-2.76 3.44.0 6.57 1.29 8.94 3.41 1.14 1.03 2.11 2.26 2.84 3.63.06.1.12.21.17.32.09.18.18.37.26.57.33.72.59 1.48.77 2.26.02.08.04.16.06.24.08.37.15.75.2 1.13C34.24 38.21 34.28 38.81 34.28 39.42z"/><path fill="#ffc107" d="M32.22 39.42c0 .2-.01.42-.02.65-.02.37-.05.77-.1 1.18-.02.25-.06.5-.1.75h-5.48l-1.06-.17-4.14-.66-.59-.09-1.35-.22c-.59.0-1.87.26-3.22.51-.71.13-1.43.27-2.08.36-.08.01-.16.02-.23.03h-.01c-.7-.15-1.38-.38-2.02-.68-.2-.09-.4-.19-.6-.3-.56-.31-1.1-.68-1.59-1.09-.01-.12-.02-.22-.02-.27.0-.26.01-.51.03-.76.04-.64.13-1.26.27-1.86.22-.91.54-1.79.97-2.6.08-.17.17-.34.27-.5.04-.08.09-.15.13-.23.18-.29.38-.57.58-.85.42-.55.89-1.07 1.39-1.54h.01c.04-.04.08-.08.12-.11.05-.04.09-.09.14-.12.2-.18.4-.34.61-.49.0-.01.01-.01.01-.01 1.89-1.41 4.23-2.24 6.78-2.24 1.98.0 3.82.5 5.43 1.38h.01c1.38.76 2.58 1.79 3.53 3.03.37.48.7.99.98 1.53h.01c.05.1.1.2.15.3.3.59.54 1.21.72 1.85h.01c.01.05.03.1.04.15.12.43.22.87.29 1.32.01.09.02.19.03.28C32.19 38.43 32.22 38.92 32.22 39.42z"/><path fill="#ffd54f" d="M30.17 39.31c0 .16.0.33-.02.49v.01.01c-.02.72-.12 1.43-.28 2.07.0.04-.01.07-.03.11h-4.67l-3.85-.83-.51-.11-.08.02-4.27.88L16.27 42H16c-.64.0-1.27-.06-1.88-.18-.09-.02-.18-.04-.27-.06h-.01c-.7-.15-1.38-.38-2.02-.68-.02-.11-.04-.22-.05-.33-.07-.43-.1-.88-.1-1.33.0-.17.0-.34.01-.51.03-.54.11-1.07.23-1.58.08-.38.19-.75.32-1.1.11-.31.24-.61.38-.9.12-.25.26-.49.4-.73.14-.23.29-.45.45-.67.4-.55.87-1.06 1.39-1.51.3-.26.63-.51.97-.73 1.46-.96 3.21-1.52 5.1-1.52.37.0.73.02 1.08.07h.02c1.07.12 2.07.42 2.99.87h.01c1.45.71 2.68 1.78 3.58 3.1.15.22.3.46.43.7.11.19.21.39.3.59.14.31.27.64.38.97h.01c.11.37.21.74.28 1.13v.01C30.11 38.16 30.17 38.73 30.17 39.31z"/><path fill="#ffe082" d="M28.11 39.52v.03c0 .59-.07 1.17-.21 1.74-.05.24-.12.48-.21.71h-4.48l-2.29-.63L18.63 42H16c-.64.0-1.27-.06-1.88-.18-.02-.03-.03-.06-.04-.09-.14-.43-.25-.86-.3-1.31-.04-.29-.06-.59-.06-.9.0-.12.0-.25.02-.37.01-.47.08-.93.2-1.37.06-.3.15-.59.27-.87.04-.14.1-.27.17-.4.15-.34.33-.67.53-.99.22-.32.46-.62.73-.9.32-.36.68-.69 1.09-.96.7-.51 1.5-.89 2.37-1.1.58-.16 1.19-.24 1.82-.24 2 0 3.79.8 5.09 2.09.05.05.11.11.16.18h.01c.14.15.27.3.4.47.37.47.68.98.92 1.54.12.26.22.53.3.81.01.04.02.07.03.11.14.49.23 1 .25 1.53C28.1 39.2 28.11 39.36 28.11 39.52z"/><path fill="#ffecb3" d="M26.06 39.52c0 .41-.05.8-.16 1.17-.1.4-.25.78-.44 1.14-.03.06-.1.17-.1.17h-8.88c-.01-.01-.02-.03-.02-.04-.12-.19-.22-.38-.3-.59-.2-.46-.32-.96-.36-1.48-.02-.12-.02-.25-.02-.37.0-.06.0-.13.01-.19.01-.44.07-.86.19-1.25.1-.36.23-.69.4-1.01.0.0.01-.01.01-.02.12-.21.25-.42.4-.62.49-.66 1.14-1.2 1.89-1.55h.01c.24-.12.49-.22.75-.29h.01c.46-.14.96-.21 1.47-.21.59.0 1.16.09 1.68.28.19.05.37.13.55.22h.01c.86.41 1.59 1.05 2.09 1.85.1.15.19.31.27.48.04.07.08.15.11.22.23.52.37 1.09.41 1.69.01.05.01.1.01.16C26.06 39.36 26.06 39.44 26.06 39.52z"/><g><path fill="none" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M30 11H18c-3.9.0-7 3.1-7 7v12c0 3.9 3.1 7 7 7h12c3.9.0 7-3.1 7-7V18c0-3.9-3.1-7-7-7z"/><circle cx="31" cy="16" r="1" fill="#fff"/></g><g><circle cx="24" cy="24" r="6" fill="none" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2"/></g></svg></a></li><li><a href=https://twitter.com/4006wayne target=_blank title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=https://wayneblog.ga/%E9%97%9C%E6%96%BC%E6%9C%AC%E7%AB%99/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>é—œæ–¼æœ¬ç«™</span></a></li><li><a href=https://wayneblog.ga/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>æ–‡ç« å·å®—</span></a></li><li><a href=https://wayneblog.ga/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>æœå°‹æª¢ç´¢</span></a></li><li><a href=https://wayneblog.ga/%E7%9B%B8%E9%97%9C%E9%80%A3%E7%B5%90/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>ç›¸é—œé€£çµ</span></a></li><li><a href=https://wayneblog.ga/index.xml target=_blank><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg><span>RSS Feed</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://wayneblog.ga/ selected>ç¹é«”ä¸­æ–‡</option><option value=https://wayneblog.ga/en/>English</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>å¤œæ™šæ¨¡å¼</span></li></div></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=https://wayneblog.ga/2022-10-19/web-pwa/><img src=https://live.staticflickr.com/65535/52438994804_33f71b7e35_o.jpg loading=lazy alt="Featured image of post å°‡ç¶²é è®ŠæˆProgressive Web Application(PWA)ï¼Œæ¼¸é€²å¼çš„ç¶²é æ‡‰ç”¨ç¨‹å¼"></a></div><div class=article-details><header class=article-category><a href=https://wayneblog.ga/categories/pwa/ style=background-color:#161617;color:#fff>PWA</a>
<a href=https://wayneblog.ga/categories/seo/ style=background-color:#6eccce;color:#fff>SEO</a></header><div class=article-title-wrapper><h2 class=article-title><a href=https://wayneblog.ga/2022-10-19/web-pwa/>å°‡ç¶²é è®ŠæˆProgressive Web Application(PWA)ï¼Œæ¼¸é€²å¼çš„ç¶²é æ‡‰ç”¨ç¨‹å¼</a></h2><h3 class=article-subtitle>æ¼¸é€²å¼ç¶²è·¯æ‡‰ç”¨ç¨‹å¼ï¼ˆè‹±èªï¼šProgressive Web Appsï¼Œç°¡ç¨±ï¼šPWAï¼‰æ˜¯ä¸€ç¨®æ™®é€šç¶²é æˆ–ç¶²ç«™æ¶æ§‹èµ·ä¾†çš„ç¶²è·¯æ‡‰ç”¨ç¨‹å¼ï¼Œä½†å®ƒå¯ä»¥ä»¥å‚³çµ±æ‡‰ç”¨ç¨‹å¼æˆ–åŸç”Ÿè¡Œå‹•æ‡‰ç”¨ç¨‹å¼å½¢å¼å±•ç¤ºçµ¦ä½¿ç”¨è€…ã€‚é€™ç¨®æ‡‰ç”¨ç¨‹å¼å½¢æ…‹è¦–åœ–å°‡ç›®å‰æœ€ç‚ºç¾ä»£åŒ–çš„ç€è¦½å™¨æä¾›çš„åŠŸèƒ½èˆ‡è¡Œå‹•è£ç½®çš„é«”é©—å„ªå‹¢ç›¸çµåˆã€‚</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Oct 19, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>é–±è®€æ™‚é–“: 14 åˆ†é˜</time></div></footer></div></header><section class=article-content><style>.article-content p code{background-color:#f5f5f5;color:#ff3860}.focus{background:#f1e2e2;color:#d62c2c;padding:0 5px}</style><p><a class=link href=https://www.letswrite.tw/pwa-manifest/ target=_blank rel=noopener>åƒè€ƒç¶²ç«™</a><br><a class=link href=https://www.letswrite.tw/pwa-web-push/ target=_blank rel=noopener>åƒè€ƒç¶²ç«™</a><br><a class=link href=https://www.minwt.com/pc/pc-browser/21592.html target=_blank rel=noopener>åƒè€ƒç¶²ç«™</a></p><p>å‰å¹¾å¤©èˆ‡å¤§å®¶åˆ†äº«ï¼Œç•¶é–‹å•ŸChromeå…§å»ºçš„PWAåŠŸèƒ½ï¼Œå°±å¯å°‡PWAçš„ç¶²é ï¼Œä¸€éµè®Šæˆä¸€å€‹æ‡‰ç”¨ç¨‹å¼ï¼Œé›–ç„¶èªªPWAåªæ˜¯åœ¨æ‡‰ç”¨ç¨‹å¼è£¡ï¼ŒåŒ…äº†Chromeçš„ç€è¦½å™¨ï¼Œä½†é–‹å•Ÿæ™‚å°±åƒæ‡‰ç”¨ç¨‹å¼ä¸€èˆ¬ï¼Œè®“ç¶²é å°±åƒæ‡‰ç”¨ç¨‹å¼ä¸€èˆ¬ï¼Œå…¶å¯¦ç°¡å–®çš„ä¾†èªªï¼Œé€™å°±æœ‰é»åƒPhoneGapçš„æ„Ÿè¦ºï¼Œä½†æ¯”PhoneGapè¦ä¾†çš„ç°¡å–®è¨±å¤šã€‚</p><p>å› æ­¤åªè¦å°‡ç¶²é åŠ å…¥ä¸€äº›ç°¡å–®çš„å®£å‘Šèˆ‡è¨­å®šï¼Œç«‹å³å°±å¯å°‡ä¸€èˆ¬çš„ç¶²é è®ŠæˆPWAçš„ç¶²é æ‡‰ç”¨ç¨‹å¼ï¼ŒçœŸå¿ƒè¦ºå¾—PWAæ˜¯å€‹å¥½ç‰©ï¼Œå› æ­¤åªè¦ä½ æœƒå¯«ç¶²é ï¼Œå°±å¯å°‡ä½ æ‰€è¨­è¨ˆçš„ç¶²é è®Šæˆä¸€éš»æ‡‰ç”¨ç¨‹å¼ï¼</p><hr><h2 id=å°‡ç¶²é è®Šæˆprogressive-web-applicationpwa>å°‡ç¶²é è®ŠæˆProgressive Web Application(PWA)</h2><h3 id=step1ä¸‹è¼‰-chrome-æ“´å……å¥—ä»¶>Step1ï¼šä¸‹è¼‰ Chrome æ“´å……å¥—ä»¶</h3><blockquote><p><a class=link href=https://chrome.google.com/webstore/detail/web-server-for-chrome/ofhbbkphhbklhfoeikjpcbhemlocgigb target=_blank rel=noopener>é»æˆ‘å‰å¾€ ã€Œ<strong>Web Server</strong>ã€ æ“´å……å¥—ä»¶</a></p></blockquote><p>é¦–å…ˆï¼Œä½ å¯å…ˆä¸‹è¼‰Chromeçš„ã€Œ<a class=link href=https://chrome.google.com/webstore/detail/web-server-for-chrome/ofhbbkphhbklhfoeikjpcbhemlocgigb target=_blank rel=noopener><strong>Web Server</strong></a>ã€æ“´å……ç¨‹å¼ï¼Œå†é»ã€Œ<strong>CHOSOSE FOLDER</strong>ã€éˆ•ï¼Œé¸æ“‡å·²è£½ä½œå¥½çš„ç¶²é ç›®éŒ„ã€‚</p><p><img src=https://live.staticflickr.com/65535/52439025049_38acceb28e_o.png max-width=100% max-height=100% class=gallery-image></p><hr><h3 id=step2æª¢æŸ¥ç¶²é >Step2ï¼šæª¢æŸ¥ç¶²é </h3><p>é»ä¸€ä¸‹é€£çµï¼Œä¸¦æª¢æŸ¥ç¶²é æ˜¯å¦èƒ½æ­£å¸¸å‘ˆç¾ã€‚</p><p><img src=https://live.staticflickr.com/65535/52438749096_6e0af3876b_o.png max-width=100% max-height=100% class=gallery-image></p><hr><h3 id=step3å»ºç«‹-manifestjson>Step3ï¼šå»ºç«‹ manifest.json</h3><blockquote><p><a class=link href=./#manifestjson-%e4%bb%8b%e7%b4%b9>æ›´å¤š manifest.json ä»‹ç´¹ï¼Œé»æˆ‘å‰å¾€</a></p></blockquote><p>æ¥è‘—å»ºç«‹ä¸€å€‹æ–°çš„æ–‡ä»¶æª”ï¼Œä¸¦ä¾çš„è¼¸å…¥æ‡‰ç”¨ç¨‹å¼åç¨±ã€åœ–ç¤ºã€èˆ‡æ‡‰ç”¨ç¨‹å¼çš„URLï¼Œå†å°‡å®ƒå„²å­˜ç‚ºã€Œ<strong>manifest.json</strong>ã€æª”ã€‚</p><h5 id=manifestjson>manifest.json</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;short_name&#34;</span><span class=p>:</span> <span class=s2>&#34;Wayne&#39;s blog&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Wayne&#39;s blog&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;å‰æ©çš„éƒ¨è½æ ¼ï¼Œç”¨æ–¼ç´€éŒ„coding lifeæŸ¥æ‰¾çš„è³‡æ–™ã€ç­†è¨˜èˆ‡æ–‡ç« ï¼Œçµ±æ•´èµ·ä¾†é™¤äº†è‡ªå·±ä½¿ç”¨ï¼Œä¹Ÿå¸Œæœ›å°å„ä½æœ‰å¹«åŠ©ã€‚&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;icons&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-57x57.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;57x57&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-114x114.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;114x114&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-120x120.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;120x120&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-180x180.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;180x180&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-192x192.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;192x192&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-512x512.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;512x512&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./maskable_icon.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;512x512&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;purpose&#34;</span><span class=p>:</span> <span class=s2>&#34;any maskable&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;lang&#34;</span><span class=p>:</span> <span class=s2>&#34;zh-Hant-TW&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;start_url&#34;</span><span class=p>:</span> <span class=s2>&#34;./?utm_source=web_app_manifest&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;background_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#f5f5fa&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;theme_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#57BCB9&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;display&#34;</span><span class=p>:</span> <span class=s2>&#34;standalone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;orientation&#34;</span><span class=p>:</span> <span class=s2>&#34;landscape&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;prefer_related_applications&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=step4html-åŠ å…¥-manifestjson>Step4ï¼šhtml åŠ å…¥ manifest.json</h3><p><img src=https://live.staticflickr.com/65535/52438247082_37e5c1b64e_o.png max-width=100% max-height=100% class=gallery-image></p><p>åœ¨headæ¨™ç±¤ä¸­åŠ å…¥ <code>manifest.json</code>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- ... --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;manifest&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;./manifest.json&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- ... --&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>ç”±æ–¼ <code>manifest</code> åœ¨ IOS ä¸Šé‚„ä¸æ”¯æ´ï¼Œå› æ­¤å¦‚æœ IOS ä¸Šä¹Ÿæƒ³è¦<code>è‡ªè¨‚ icon</code>ï¼Œå°±è¦æ”¹ç”¨ HTML è£¡çš„ meta ä¾†è¨­å®šï¼Œå¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- ... --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;manifest&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;./manifest.json&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-icon&#34;</span> <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;57x57&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;./apple-touch-icon-57x57.webp&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-icon&#34;</span> <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;114x114&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;./apple-touch-icon-114x114.webp&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-icon&#34;</span> <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;120x120&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;./apple-touch-icon-120x120.webp&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-icon&#34;</span> <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;180x180&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;./apple-touch-icon-180x180.webp&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-icon&#34;</span> <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;192x192&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;./apple-touch-icon-192x192.webp&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-icon&#34;</span> <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;512x512&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;./apple-touch-icon-512x512.png&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- ... --&gt;</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=step5æ‰“é–‹é–‹ç™¼äººå“¡å·¥å…·æª¢æŸ¥-manifestjson-çš„è¨­å®š>Step5ï¼šæ‰“é–‹é–‹ç™¼äººå“¡å·¥å…·æª¢æŸ¥ manifest.json çš„è¨­å®š</h3><p><img src=https://live.staticflickr.com/65535/52439205970_f9a2704fb2_o.png max-width=100% max-height=100% class=gallery-image></p><hr><h3 id=step6åŠ å…¥-serviceworker-èªæ³•>Step6ï¼šåŠ å…¥ <code>serviceWorker</code> èªæ³•</h3><blockquote><p><a class=link href=./#service-worker-%e4%bb%8b%e7%b4%b9>æ›´å¤š Service Worker ä»‹ç´¹ï¼Œé»æˆ‘å‰å¾€</a></p></blockquote><p>åœ¨ç¶²é å‰åŠ å…¥ä¸‹æ–¹çš„èªæ³•ã€‚</p><p><img src=https://live.staticflickr.com/65535/52439205965_51d524f499_o.png max-width=100% max-height=100% class=gallery-image></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=s2>&#34;serviceWorker&#34;</span> <span class=k>in</span> <span class=nx>navigator</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Will service worker register?&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>navigator</span><span class=p>.</span><span class=nx>serviceWorker</span><span class=p>.</span><span class=nx>register</span><span class=p>(</span><span class=s2>&#34;./service-worker.js&#34;</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>reg</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Yes it did.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}).</span><span class=k>catch</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;No, it didn&#39;t. This happened: &#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=step7å»ºç«‹-service-workerjs-æª”æ¡ˆ>Step7ï¼šå»ºç«‹ <code>service-worker.js</code> æª”æ¡ˆ</h3><p>æ¥è‘—å†å»ºç«‹ä¸€å€‹æ–‡ä»¶ï¼Œä¸¦è²¼ä¸Šä¸‹æ–¹çš„èªæ³•ï¼Œå„²å­˜ç‚º <strong>service-worker.js</strong>ï¼Œé€™æ™‚å¯çœ‹åˆ°åœ¨åŸä¾†çš„ç¶²é ä¸­ï¼Œåˆ†åˆ¥æœƒå¤šäº† <code>manifest.json</code> èˆ‡ <code>service-worker.js</code> å’Œåœ–ç‰‡è³‡æ–™å¤¾ã€‚</p><h5 id=service-workerjs>service-worker.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>self</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;install&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>self</span><span class=p>.</span><span class=nx>skipWaiting</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>offlinePage</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Request</span><span class=p>(</span><span class=s1>&#39;offline.html&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>event</span><span class=p>.</span><span class=nx>waitUntil</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nx>fetch</span><span class=p>(</span><span class=nx>offlinePage</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>response</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>caches</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s1>&#39;offline2&#39;</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>cache</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>put</span><span class=p>(</span><span class=nx>offlinePage</span><span class=p>,</span> <span class=nx>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}));</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>self</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;fetch&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>event</span><span class=p>.</span><span class=nx>respondWith</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>fetch</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>request</span><span class=p>).</span><span class=k>catch</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>caches</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s1>&#39;offline2&#39;</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>cache</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>match</span><span class=p>(</span><span class=s1>&#39;offline.html&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}));</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>self</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;refreshOffline&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>response</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>caches</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s1>&#39;offline2&#39;</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>cache</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>put</span><span class=p>(</span><span class=nx>offlinePage</span><span class=p>,</span> <span class=nx>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>self</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;push&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>   <span class=kd>var</span> <span class=nx>opts</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>body</span><span class=o>:</span> <span class=nx>data</span><span class=p>.</span><span class=nx>body</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>icon</span><span class=o>:</span> <span class=nx>data</span><span class=p>.</span><span class=nx>icon</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>url</span><span class=o>:</span> <span class=nx>data</span><span class=p>.</span><span class=nx>url</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=nx>event</span><span class=p>.</span><span class=nx>waitUntil</span><span class=p>(</span><span class=nx>self</span><span class=p>.</span><span class=nx>registration</span><span class=p>.</span><span class=nx>showNotification</span><span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>title</span><span class=p>,</span> <span class=nx>opts</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>self</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;notificationclick&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>notification</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>   <span class=nx>event</span><span class=p>.</span><span class=nx>notification</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>   <span class=nx>event</span><span class=p>.</span><span class=nx>waitUntil</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>clients</span><span class=p>.</span><span class=nx>openWindow</span><span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=step8ç¢ºèª-service-workers-æ˜¯å¦æ­£å¸¸>Step8ï¼šç¢ºèª Service Workers æ˜¯å¦æ­£å¸¸</h3><p>æ¥è‘—å†å›åˆ°ç¶²é çš„ã€Œé–‹ç™¼äººå“¡å·¥å…·ã€çš„ <strong>Service Workers</strong> æ™‚ï¼Œå°±æœƒçœ‹åˆ°ç¶ è‰²ç‡ˆè™Ÿã€‚</p><p><img src=https://live.staticflickr.com/65535/52438247047_03b64fc6a7_o.png max-width=100% max-height=100% class=gallery-image></p><hr><h3 id=step9å®‰è£é é¢>Step9ï¼šå®‰è£ã€Œé é¢ã€</h3><p>éƒ½å®Œæˆå¾Œï¼Œå†é» Chrome å³ä¸Šçš„é¸å–®åœ–ç¤ºï¼Œå°±å¯çœ‹åˆ°ã€Œå®‰è£XXXã€ã€‚</p><p><img src=https://live.staticflickr.com/65535/52439271878_297265b0bc_o.png max-width=100% max-height=100% class=gallery-image></p><hr><h3 id=step10å®‰è£>Step10ï¼šå®‰è£</h3><p>é»ä¸€ä¸‹ï¼Œå°±æœƒå‡ºç¾å®‰è£ç•«é¢ï¼Œå†é»ã€Œ<strong>å®‰è£</strong>ã€ã€‚</p><p><img src=https://live.staticflickr.com/65535/52439024999_3a2b4105e7_o.png max-width=100% max-height=100% class=gallery-image></p><p>ç•¶å®‰è£å®Œç•¢å¾Œï¼Œå°±æœƒé–‹å•Ÿå‰›æ‰€å®‰è£çš„æ‡‰ç”¨ç¨‹å¼ï¼Œå“ˆï¼æ˜¯ä¸æ˜¯ç•«é¢ä¹¾æ·¨è¨±å¤šï¼Œå°±åƒåœ¨ä½¿ç”¨ä¸€èˆ¬çš„æ‡‰ç”¨ç¨‹å¼ä¸€æ¨£ï¼Œæœ‰äº†PWAå¾Œå¯å¯¦ç¾é€éç¶²é å°±èƒ½æ‰“é€ å°ˆå±¬çš„æ‡‰ç”¨ç¨‹å¼çš„å¤¢æƒ³ï¼Œä¸”å®Œå…¨ä¸ç”¨å†å­¸æ–°èªè¨€ï¼ŒçœŸæ˜¯è¶…æ–¹ä¾¿çš„ã€‚</p><p><img src=https://live.staticflickr.com/65535/52439205910_65be017ebf_o.png max-width=100% max-height=100% class=gallery-image></p><hr><h2 id=manifestjson-ä»‹ç´¹>manifest.json ä»‹ç´¹</h2><p>ä»¥ä¸‹ä¾†èªªæ˜ä¸€ä¸‹ manifest.json</p><p>manifest.json æ˜¯åœ¨å­¸ PWA é€™å¡Šæ™‚æœ€ç°¡å–®çš„éƒ¨ä»½ï¼Œä¸»è¦æ˜¯å»ºä¸€æ”¯ JSON æª”å°±å¯ä»¥ï¼Œç›¸é—œçš„åƒæ•¸ MDNä¸Š æˆ–æ˜¯ Google ä¸€ä¸‹å°±æœƒçœ‹åˆ°ï¼Œä¸ç”¨èŠ±å¤ªå¤šçš„æ™‚é–“å»è¨˜ã€‚</p><h3 id=manifestjsonæ˜¯åšä»€éº¼ç”¨çš„>manifest.jsonæ˜¯åšä»€éº¼ç”¨çš„ï¼Ÿ</h3><p>æ ¹æ“š MDN ä¸Šçš„è§£é‡‹ï¼Œmanifest.json æ˜¯é€™æ¨£å­çš„ï¼š</p><blockquote><p>å®ƒæä¾›äº†æ‡‰ç”¨ç¨‹å¼ç›¸é—œçš„è³‡è¨Šï¼ˆåƒæ˜¯åç¨±ã€ä½œè€…ã€åœ–ç¤ºã€æè¿°ï¼‰ã€‚ manifest çš„åŠŸç”¨æ˜¯å°‡ Web æ‡‰ç”¨ç¨‹å¼å®‰è£åˆ°è¨­å‚™çš„ä¸»ç•«é¢ï¼Œç‚ºä½¿ç”¨è€…æä¾›æ›´å¿«é€Ÿçš„è¨ªå•å’Œæ›´è±å¯Œçš„é«”é©—ã€‚</p></blockquote><p>ç°¡å–®çš„èªªæ˜å°±æ˜¯ï¼ŒPWA ä¸»è¦å°±æ˜¯<code>è®“ç¶²é </code>å¯ä»¥<code>æ¨¡æ“¬</code>æˆä¸€å€‹æ‰‹æ©Ÿçš„ <code>App</code> ä¾†ä½¿ç”¨ï¼Œè¦ç•¶æˆ Appï¼Œå°±è¦æœ‰ App çš„æ¨£å­ï¼Œå°±è¦èƒ½åœ¨æ‰‹æ©Ÿçš„æ¡Œé¢ä¸Šæœ‰ä¸€å€‹ icon å¯ä»¥æŒ‰ï¼ŒæŒ‰ä¸‹å»å¾Œæœ‰ä¸€å€‹å¹¾ç§’é˜çš„å•Ÿå‹•ç•«é¢è®“ä½¿ç”¨è€…çŸ¥é“é–‹å•Ÿçš„ App æ˜¯ä»€éº¼ï¼Œmanifest å°±æ˜¯åœ¨è™•ç†é€™æ®µã€‚</p><p>å¦å¤–ï¼Œä¸€èˆ¬æˆ‘å€‘åœ¨æ‰‹æ©Ÿä¸Šé–‹ Chrome æˆ– Safari çœ‹ç¶²é æ™‚ï¼Œæœ€é ‚éƒ¨æœƒæœ‰ä¸€æ¢ç¶²å€åˆ—ï¼Œä½†ä¸€èˆ¬ App æ˜¯ä¸æœƒæœ‰çš„ï¼Œè€Œ manifest.json ä¹Ÿå¯ä»¥è¨­å®šé–‹å•Ÿé é¢æ™‚ä¸é¡¯ç¤ºç¶²å€åˆ—ã€‚</p><p>PWA æ˜¯æŠŠé é¢æ¨¡æ“¬æˆ App çš„ä¸€å€‹æ–¹æ³•ï¼Œå¦‚æœå…¬å¸æœ¬èº«ä¹Ÿæœ‰è£½ä½œ App å‘¢ï¼Ÿmanifest.json ä¸Šä¹Ÿå¯ä»¥è¨­å®š App åœ¨ Google Playã€App Store ä¸Šçš„é€£çµï¼Œä¸¦å‘ˆç¾ä¸€å€‹æ¨è–¦é€šçŸ¥è®“ä½¿ç”¨è€…å¯ä»¥é€²å…¥ä¸¦ä¸‹è¼‰ã€‚</p><p>æœ€å¾Œè£œå……ä¸€é»ï¼Œä¸è«–æ˜¯ PWA çš„ Cache æˆ–æ˜¯æ¨æ’­åŠŸèƒ½ï¼Œéƒ½è¦æ±‚ç¶²ç«™è¦æ˜¯ <code>https</code>ï¼Œmanifest.json é€™é»ä¹Ÿä¸æ„å¤–ï¼Œå¦‚æœç¶²ç«™ä¸æ˜¯ <code>https</code>ï¼Œå³ä¾¿å¼•ç”¨äº† manifest.jsonï¼Œä¹Ÿ<code>ä¸æœƒ</code>è¢« Chrome ä¸»å‹•è©¢å•æ˜¯å¦è¦å°‡ç¶²ç«™åŠ å…¥åˆ°ä¸»ç•«é¢ã€‚</p><p>é—œæ–¼ manifest çš„åŠŸèƒ½ï¼ŒGoogle æœ‰ä¸€éš»å½±ç‰‡ä»‹ç´¹ï¼š</p><iframe width=804 height=452 src=https://www.youtube.com/embed/yQhFmPExcbs title="Web App Manifest: Totally Tooling Tips (S3, E4)" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>Web App Manifest: Totally Tooling Tips</p><hr><h3 id=manifestjson-æˆå“¡>manifest.json æˆå“¡</h3><p>æˆå“¡åˆ—è¡¨æ•´ç†å¦‚ä¸‹ï¼š</p><div class=table-wrapper><table><thead><tr><th>æ¬„ä½</th><th>èªªæ˜</th></tr></thead><tbody><tr><td><a class=link href=./#theme_color>theme_color</a></td><td>æ‡‰ç”¨ç¨‹å¼çš„ä¸»è¦é¡è‰²</td></tr><tr><td><a class=link href=./#background_color>background_color</a></td><td>å•Ÿå‹•ç•«é¢ï¼ˆsplash screenï¼‰çš„èƒŒæ™¯è‰²</td></tr><tr><td><a class=link href=./#icons>icons</a></td><td>æ‡‰ç”¨ç¨‹å¼çš„åœ–ç¤º</td></tr><tr><td><a class=link href=./#name>name</a></td><td>æ‡‰ç”¨ç¨‹å¼çš„åç¨±</td></tr><tr><td><a class=link href=./#short_name>short_name</a></td><td>æ‡‰ç”¨ç¨‹å¼çš„ç°¡å¯«</td></tr><tr><td><a class=link href=./#lang>lang</a></td><td>ä¸»è¦èªè¨€</td></tr><tr><td><a class=link href=./#description>description</a></td><td>æ‡‰ç”¨ç¨‹å¼çš„æè¿°</td></tr><tr><td><a class=link href=./#dir>dir</a></td><td>æ–‡å­—æ›¸å¯«æ–¹å‘</td></tr><tr><td><a class=link href=./#display>display</a></td><td>æ‡‰ç”¨ç¨‹å¼çš„é¡¯ç¤ºæ¨¡å¼</td></tr><tr><td><a class=link href=./#orientation>orientation</a></td><td>é è¨­é¡¯ç¤ºçš„æ–¹å‘æ˜¯ç›´çš„æˆ–æ©«çš„</td></tr><tr><td><a class=link href=./#prefer_related_applications>prefer_related_applications</a></td><td>æ˜¯å¦è¦æ¨è–¦ä¸€å€‹åŸç”Ÿçš„ App</td></tr><tr><td><a class=link href=./#related_applications>related_applications</a></td><td>æ¨è–¦åŸç”Ÿ App çš„é€£çµ</td></tr><tr><td><a class=link href=./#start_url>start_url</a></td><td>é–‹å•Ÿæ‡‰ç”¨ç¨‹å¼æ™‚çš„é è¨­ç¶²å€</td></tr><tr><td><a class=link href=./#scope>scope</a></td><td>æ‡‰ç”¨ç¨‹å¼çš„ä½¿ç”¨ç¯„åœ</td></tr></tbody></table></div><h4 id=theme_color>theme_color</h4><p><strong>æ‡‰ç”¨ç¨‹å¼çš„ä¸»è¦é¡è‰²</strong>ï¼Œä¸»è¦å¯ä»¥æ”¹è®Šç¶²å€åˆ—é‚£ä¸€æ¢çš„é¡è‰²ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;theme_color&#34;</span><span class=err>:</span> <span class=s2>&#34;#57BCB9&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=background_color>background_color</h4><p><strong>å•Ÿå‹•ç•«é¢ï¼ˆsplash screenï¼‰çš„èƒŒæ™¯è‰²</strong>ï¼ŒApp å•Ÿå‹•æ™‚ï¼Œæœƒæœ‰ä¸€å€‹ Splash Screenï¼Œç¿»è­¯æˆå¿«é–ƒé ã€éå ´é ï¼Œæœ¬ç¯‡ç¨±ç‚ºå•Ÿå‹•ç•«é¢ã€‚</p><p>Splash Screen éœ€è¦3å€‹æˆå“¡ï¼šbackground_colorã€iconsã€nameã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;background_color&#34;</span><span class=err>:</span> <span class=s2>&#34;red&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>è£œå……ä¸€é»ï¼ŒSplash Screenï¼Œåœ¨ <code>IOS</code> ä¸Šæ˜¯<code>ä¸æ”¯æ´</code>çš„ï¼Œä½†å¯ä»¥ç›´æ¥è®€å–ä¸€å¼µåœ–æª”ä¾†ç•¶ä½œå•Ÿå‹•é é¢ï¼Œåœ¨ <code>head</code> è£¡åŠ å…¥ä»¥ä¸‹å°±è¡Œï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-startup-image&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;images/splash-640x1136.png&#34;</span> <span class=na>media</span><span class=o>=</span><span class=s>&#34;(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-startup-image&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;images/splash-750x1294.png&#34;</span> <span class=na>media</span><span class=o>=</span><span class=s>&#34;(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-startup-image&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;images/splash-1125x2436.png&#34;</span> <span class=na>media</span><span class=o>=</span><span class=s>&#34;(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-startup-image&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;images/splash-1242x2148.png&#34;</span> <span class=na>media</span><span class=o>=</span><span class=s>&#34;(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-startup-image&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;images/splash-1536x2048.png&#34;</span> <span class=na>media</span><span class=o>=</span><span class=s>&#34;(min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-startup-image&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;images/splash-1668x2224.png&#34;</span> <span class=na>media</span><span class=o>=</span><span class=s>&#34;(min-device-width: 834px) and (max-device-width: 834px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-startup-image&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;images/splash-2048x2732.png&#34;</span> <span class=na>media</span><span class=o>=</span><span class=s>&#34;(min-device-width: 1024px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=icons>icons</h4><p><strong>æ‡‰ç”¨ç¨‹å¼çš„åœ–ç¤º</strong>ï¼Œicons è£¡æ”¾é™£åˆ—ï¼Œæ”¾ä¸åŒå°ºå¯¸ä¸‹çš„ä¸»è¦åœ–ç¤ºï¼Œå¦‚æœ Splash Screen è£¡è¦ç”¨çš„åœ–ç¤ºï¼Œå¤§å°<code>å¿…é ˆ</code>åŒ…å« <code>192px</code>ã€<code>512px</code>ã€‚</p><p>icons è£¡ï¼Œé™£åˆ—è£¡çš„æ¯ä¸€å€‹ç‰©ä»¶æœ‰ 3 å€‹æˆå“¡ï¼š</p><ul><li><code>sizes</code> åœ–ç‰‡å°ºå¯¸ï¼Œå¯ç”¨åœ¨å¤šå€‹å°ºå¯¸ä¸Šçš„è©±ç”¨ç©ºç™½éµå€éš”ã€‚</li><li><code>src</code> åœ–ç‰‡çš„è·¯å¾‘ï¼Œå¦‚æœæ˜¯ç›¸å°è·¯å¾‘ï¼Œæ˜¯<code>ä»¥ manifest æ‰€åœ¨çš„ä½ç½®</code>ç‚ºåŸºæº–ã€‚</li><li><code>type</code> åœ–æª”é¡å‹ï¼Œé€™é …æ’å¿…å¡«ï¼Œä¸»è¦æ˜¯å‘ŠçŸ¥è£ç½®é¡å‹ï¼Œè®“ä¸æ”¯æ´çš„è£ç½®å¯ä»¥å¿«é€Ÿç•¥éã€‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;icons&#34;</span><span class=err>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;icon/lowres.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;48x48&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;icon/lowres&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;48x48&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;icon/hd_hi.ico&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;72x72 96x96 128x128 256x256&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;icon/hd_hi.svg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;72x72&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>ç”±æ–¼ <code>manifest</code> åœ¨ IOS ä¸Šé‚„<code>ä¸æ”¯æ´</code>ï¼Œå› æ­¤å¦‚æœ IOS ä¸Šä¹Ÿæƒ³è¦<code>è‡ªè¨‚ icon</code>ï¼Œå°±è¦æ”¹ç”¨ HTML è£¡çš„ <code>meta</code> ä¾†è¨­å®šï¼Œå¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-icon&#34;</span> <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;57x57&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;apple-icon-57x57.png&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-icon&#34;</span> <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;72x72&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;apple-icon-72x72.png&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;apple-touch-icon&#34;</span> <span class=na>sizes</span><span class=o>=</span><span class=s>&#34;114x114&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;apple-icon-114x114.png&#34;</span> <span class=p>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=name>name</h4><p><strong>æ‡‰ç”¨ç¨‹å¼çš„å®Œæ•´åç¨±</strong>ï¼Œæœƒé¡¯ç¤ºåœ¨ Splash Screenä¸Šï¼Œä»¥åŠä¸»ç•«é¢ä¸Šçš„åç¨±ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;name&#34;</span><span class=err>:</span> <span class=s2>&#34;Wayne&#39;s blog&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=short_name>short_name</h4><p><strong>æ‡‰ç”¨ç¨‹å¼çš„ç°¡å¯«</strong>ï¼Œç•¶ name å¤ªé•·è€Œç„¡æ³•é¡¯ç¤ºæ™‚ï¼Œæœƒæ”¹æˆé¡¯ç¤ºç°¡å¯«ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;short_name&#34;</span><span class=err>:</span> <span class=s2>&#34;Wayne&#39;s blog&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=lang>lang</h4><p><strong>ä¸»è¦èªè¨€</strong>ï¼Œé‡å° nameã€short_name é€™å…©å€‹ä½¿ç”¨çš„ã€‚</p><p>èªè¨€åˆ—è¡¨å¯ä»¥åœ¨é€™æ‰¾ï¼š<a class=link href=https://www.iana.org target=_blank rel=noopener>https://www.iana.org</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;lang&#34;</span><span class=err>:</span> <span class=s2>&#34;zh-Hant-TW&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=description>description</h4><p><strong>æ‡‰ç”¨ç¨‹å¼çš„æè¿°</strong>ï¼Œæè¿°é€™å€‹æ‡‰ç”¨ç¨‹å¼æ˜¯åšä»€éº¼çš„ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;description&#34;</span><span class=err>:</span> <span class=s2>&#34;å‰æ©çš„éƒ¨è½æ ¼ï¼Œç”¨æ–¼ç´€éŒ„coding lifeæŸ¥æ‰¾çš„è³‡æ–™ã€ç­†è¨˜èˆ‡æ–‡ç« ï¼Œçµ±æ•´èµ·ä¾†é™¤äº†è‡ªå·±ä½¿ç”¨ï¼Œä¹Ÿå¸Œæœ›å°å„ä½æœ‰å¹«åŠ©ã€‚&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=dir>dir</h4><p><strong>æ–‡å­—æ›¸å¯«æ–¹å‘</strong>ï¼Œå€¼æœ‰ 3 å€‹ï¼š<code>ltr</code>ï¼ˆå·¦è‡³å³ï¼‰ã€<code>rtl</code>ï¼ˆå³è‡³å·¦ï¼‰ã€<code>auto</code>ï¼ˆè®“ç€è¦½å™¨è‡ªå·±æ±ºå®šï¼‰ï¼Œä¸å¡«çš„è©±é è¨­å€¼æ˜¯ <code>auto</code>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;dir&#34;</span><span class=err>:</span> <span class=s2>&#34;ltr&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=display>display</h4><p><strong>æ‡‰ç”¨ç¨‹å¼çš„é¡¯ç¤ºæ¨¡å¼</strong>ï¼Œé¡¯ç¤ºæ¨¡å¼æŒ‡çš„æ˜¯å¾ä¸»ç•«é¢é»é–‹ App å¾Œï¼Œè¦é¡¯ç¤ºçš„æ¨£å­ï¼Œæœ‰ 4 å€‹å€¼å¯ç”¨ï¼š</p><ul><li><code>fullscreen</code>ï¼š å…¨è¢å¹•ï¼Œå°±åƒåœ¨ç”¨åŸç”Ÿ App ä¸€æ¨£ï¼Œæœƒéš±è—æ‰€æœ‰çš„ç€è¦½å™¨ UIã€‚</li><li><code>standalone</code>ï¼š æœƒéš±è—æ¨™æº–ç€è¦½å™¨ UI å…ƒç´ ï¼Œå¦‚ URL æ¬„ç­‰ã€‚</li><li><code>browser</code>ï¼š é è¨­å€¼ï¼Œå°±åƒä¸€èˆ¬ç”¨ç€è¦½å™¨ä¸€æ¨£ã€‚</li><li><code>minimal</code>ï¼š ui æœƒæœ‰å°è¦½åˆ—æœ€å°çš„ UIï¼Œé€™å€‹å€¼ Chrome ä¸æ”¯æ´ã€‚</li></ul><p>å¦‚æœè¦ Chrome <code>ä¸»å‹•æç¤º</code>åŠ å…¥ä¸»ç•«é¢çš„è©±ï¼Œè¨­å®šå€¼å¿…é ˆè¦æ˜¯ <code>standalone</code>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;display&#34;</span><span class=err>:</span> <span class=s2>&#34;standalone&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=orientation>orientation</h4><p><strong>é è¨­é¡¯ç¤ºçš„æ–¹å‘æ˜¯ç›´çš„æˆ–æ©«çš„</strong>ï¼Œå¯ä»¥å¼·åˆ¶è®“ä½¿ç”¨è€…å¿…é ˆè£ç½®æ‹¿ç›´çš„ï¼ˆ<code>landscape</code>ï¼‰æˆ–æ‹¿æ©«çš„ï¼ˆ<code>portrait</code>ï¼‰çœ‹ã€‚é€™é»è¦è¨­è¦ä»”ç´°æ€è€ƒéæ‰è¡Œï¼Œå› ç‚ºä½¿ç”¨éƒ½å¤§éƒ¨ä»½éƒ½å–œæ­¡è‡ªå·±æ±ºå®šæ˜¯ç›´çœ‹æˆ–æ¨ªçœ‹ã€‚</p><p>å¦‚æœæ˜¯éŠæˆ²é¡å‹çš„ï¼Œå¯ä»¥è¨­å®šç”¨æ©«çš„ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;orientation&#34;</span><span class=err>:</span> <span class=s2>&#34;landscape&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=prefer_related_applications>prefer_related_applications</h4><p><strong>æ˜¯å¦è¦æ¨è–¦ä¸€å€‹åŸç”Ÿçš„ App</strong>ï¼ŒPWA æ˜¯æ¨¡æ“¬é é¢ç‚º Appï¼Œå¦‚æœç¶²ç«™æœ¬èº«æœ‰å‡º Appï¼Œé€™é …å°±å¯ä»¥è¨­æˆ <code>true</code>ï¼Œå¾ä¸»ç•«é¢é»é–‹é é¢æ™‚å°±æœƒå‡ºç¾å¯ä»¥ä¸‹è¼‰ App çš„æç¤ºã€‚</p><p>å¦‚æœé€™é …ç‚º <code>true</code>ï¼Œå‰‡ä¸‹é¢çš„ <code>related_applications</code> å°±è¦å¡«å…¥å€¼ï¼›é€™é …çš„é è¨­å€¼ç‚º <code>false</code>ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;prefer_related_applications&#34;</span><span class=err>:</span> <span class=kc>false</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=related_applications>related_applications</h4><p><strong>æ¨è–¦åŸç”Ÿ App çš„é€£çµ</strong>ï¼Œå€¼æ˜¯é™£åˆ—ï¼Œè£¡é¢æ”¾ App è³‡è¨Šçš„ç‰©ä»¶ï¼Œæ¯é …ç‰©ä»¶æœ‰ 2 å€‹æˆå“¡è¦å¡«ï¼Œæ˜¯ Google Play ä¸Šçš„è©±å‰‡æœ‰ 3 å€‹æˆå“¡ã€‚</p><ul><li><code>platform</code>ï¼š æ‡‰ç”¨ç¨‹å¼çš„å¹³å°ï¼Œå¯å¡« playã€itunesã€‚</li><li><code>url</code>ï¼š æ‡‰ç”¨ç¨‹å¼çš„ç¶²å€ã€‚</li><li><code>id</code>ï¼š Google Playä¸Šè¦å¡«çš„ IDã€‚</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;related_applications&#34;</span><span class=err>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;platform&#34;</span><span class=p>:</span> <span class=s2>&#34;play&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://play.google.com/store/apps/details?id=com.example.app1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;com.example.app1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;platform&#34;</span><span class=p>:</span> <span class=s2>&#34;itunes&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://itunes.apple.com/app/example-app1/id123456789&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=start_url>start_url</h4><p><strong>é–‹å•Ÿæ‡‰ç”¨ç¨‹å¼æ™‚çš„é è¨­ç¶²å€</strong>ï¼Œå¦‚æœæœ‰è¨­å®šçš„è©±ï¼Œé–‹å•Ÿæ‡‰ç”¨ç¨‹å¼æ™‚å°±æœƒé€²åˆ°è¨­å®šçš„ç¶²å€ã€‚æ²’è¨­å®šçš„è©±å°±æ˜¯ä½¿ç”¨è€…æŒ‰åŠ å…¥ä¸»ç•«é¢æ™‚çš„é‚£å€‹ç¶²å€ã€‚<br>å¦‚æœå¡«å¯«çš„æ˜¯ç›¸å°è·¯å¾‘ï¼Œæ˜¯ä»¥ manifest æ‰€åœ¨çš„ä½ç½®ç‚ºåŸºæº–ã€‚<br>å»ºè­°å¯ä»¥åœ¨ç¶²å€ä¸ŠåŠ å…¥ <code>Google Analytics</code> çš„ <code>utm</code> åƒæ•¸ï¼Œé€™æ¨£åœ¨ GA ä¸Šå°±å¯ä»¥çœ‹è¦‹å¤šå°‘ä¾†æºæ˜¯ä¾†è‡ªæ–¼ <code>PWA</code>ï¼Œå¯ä»¥æª¢æ¸¬æˆæ•ˆã€‚</p><blockquote><p>å¦‚æœè¦ Chrome <code>ä¸»å‹•æç¤ºåŠ å…¥ä¸»ç•«é¢</code>çš„è©±ï¼Œé€™é …å¿…é ˆå¡«å¯«ã€‚</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;start_url&#34;</span><span class=err>:</span> <span class=s2>&#34;./?utm_source=web_app_manifest&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=scope>scope</h4><p><strong>æ‡‰ç”¨ç¨‹å¼çš„ä½¿ç”¨ç¯„åœ</strong>ï¼Œé€™é …å¦‚æœæœ‰å¡«ï¼Œé‚£æ‡‰ç”¨ç¨‹å¼çš„ä½œç”¨åŸŸå°±æœƒé™åœ¨æŒ‡å®šçš„ç›®éŒ„è£¡ï¼Œè¶…éæŒ‡å®šç›®éŒ„ï¼Œå°±æœƒç•¶æˆä¸€èˆ¬çš„ç¶²é ç€è¦½ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;scope&#34;</span><span class=err>:</span> <span class=s2>&#34;/myapp/&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=manifestjson-åŸºæœ¬æª”æ¡ˆå…§å®¹>manifest.json åŸºæœ¬æª”æ¡ˆå…§å®¹</h4><p>manifest è£¡çš„æˆå“¡ä¸æ˜¯æ¯é …éƒ½ä¸€å®šè¦å¡«å¯«çš„ï¼Œä»¥ä¸‹é™„ä¸Š manifest.json çš„åŸºæœ¬æª”å…§å®¹ï¼š</p><h5 id=manifestjson-1>manifest.json</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;short_name&#34;</span><span class=p>:</span> <span class=s2>&#34;Wayne&#39;s blog&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Wayne&#39;s blog&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;å‰æ©çš„éƒ¨è½æ ¼ï¼Œç”¨æ–¼ç´€éŒ„coding lifeæŸ¥æ‰¾çš„è³‡æ–™ã€ç­†è¨˜èˆ‡æ–‡ç« ï¼Œçµ±æ•´èµ·ä¾†é™¤äº†è‡ªå·±ä½¿ç”¨ï¼Œä¹Ÿå¸Œæœ›å°å„ä½æœ‰å¹«åŠ©ã€‚&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;icons&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-57x57.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;57x57&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-114x114.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;114x114&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-120x120.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;120x120&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-180x180.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;180x180&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-192x192.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;192x192&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./apple-touch-icon-512x512.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;512x512&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./maskable_icon.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;512x512&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;purpose&#34;</span><span class=p>:</span> <span class=s2>&#34;any maskable&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;lang&#34;</span><span class=p>:</span> <span class=s2>&#34;zh-Hant-TW&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;start_url&#34;</span><span class=p>:</span> <span class=s2>&#34;./?utm_source=web_app_manifest&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;background_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#f5f5fa&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;theme_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#57BCB9&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;display&#34;</span><span class=p>:</span> <span class=s2>&#34;standalone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;orientation&#34;</span><span class=p>:</span> <span class=s2>&#34;landscape&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;prefer_related_applications&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=é—œæ–¼chrome-ä¸»å‹•æç¤ºåŠ å…¥ä¸»ç•«é¢>é—œæ–¼ã€ŒChrome ä¸»å‹•æç¤ºåŠ å…¥ä¸»ç•«é¢ã€</h3><p>PWA èº«ç‚º Google çš„è¦ªèº«å…’å­ï¼Œåœ¨ Android æ‰‹æ©Ÿæ˜¯å¾ˆæœ‰åƒé¦™çš„é»ã€‚<br>é é¢å¼•ç”¨äº† <code>manifest.json</code> å¾Œï¼Œä½¿ç”¨è€…åœ¨æ‰‹æ©Ÿä¸Šé»é¸åŠ å…¥ä¸»ç•«é¢ï¼Œé é¢å°±å¯ä»¥åƒ App ä¸€æ¨£é¡¯ç¤ºåœ¨æ‰‹æ©Ÿçš„ä¸»ç•«é¢ä¸Šã€‚</p><p>ä½†å¾ˆå¤šä½¿ç”¨è€…å…¶å¯¦ä¸çŸ¥é“æœ‰é€™åŠŸèƒ½ï¼Œæˆ–æ˜¯çŸ¥é“äº†ä¹Ÿä¸å¸¸æœƒå»æŒ‰ã€‚<br>è²¼å¿ƒçš„ Google é‡å°é€™é»åšäº†ä¸€é …æªæ–½ï¼Œå°±æ˜¯<code>ä¸»å‹•è©¢å•</code>ä½¿ç”¨è€…è¦ä¸è¦å°‡é é¢åŠ å…¥ä¸»ç•«é¢ã€‚</p><p>æ ¹æ“š Google çš„èªªæ˜æ–‡ä»¶ï¼š<code>Add to Home Screen</code>ï¼Œè§¸ç™¼ Chrome ä¸»å‹•è©¢å•æ˜¯å¦åŠ å…¥ä¸»ç•«é¢çš„æ¢ä»¶å¦‚ä¸‹ï¼š</p><ol><li>ä½¿ç”¨è€…<code>é‚„æ²’</code>åŠ å…¥ä¸»ç•«é¢</li><li>åœ¨æœ‰ manifes.json çš„ç¶²åŸŸä¸‹ï¼Œäº’å‹•äº†è‡³å°‘ <code>30</code> ç§’</li><li>manifset.json è£¡æœ‰å¹¾é …æˆå“¡ä¸€å®šè¦æœ‰ï¼š<code>name</code> æˆ– <code>short_name</code>ã€<code>icons</code>ã€<code>start_url</code>ã€<code>display</code></li><li>é é¢è¦æ˜¯ <code>https</code></li><li>é é¢æœ‰è£ <code>service-workerï¼ˆsw.jsï¼‰</code>ï¼Œè£¡é¢æœ‰ç›£è½ä¸¦è™•ç† <code>beforeinstallprompt</code> äº‹ä»¶</li></ol><p>ç¬¬ 5 é»ï¼Œæ˜¯å¦è¦æœ‰å¯« <code>beforeinstallprompt</code>ï¼Œå¥½åƒä¸æ˜¯å¿…å¡«é …ç›®ï¼Œå³ä¾¿æ²’å¡«ï¼Œåœ¨æ¸¬è©¦æ™‚ä¹Ÿæœƒåœ¨åº•éƒ¨å‡ºç¾ä¸€æ¢è©¢å•æ¡†ã€‚</p><p>åœ¨åƒè€ƒäº†é€™ç¯‡ä»¥å¾Œï¼š<a class=link href=https://blog.techbridge.cc/2018/10/13/pwa-in-action/ target=_blank rel=noopener>PWA å¯¦æˆ°ç¶“é©—åˆ†äº«</a><br>ç™¼ç¾åˆ¥äººæ˜¯ç”¨åœ¨ UX ä¸Šæ›´å„ªåŒ–çš„åœ°æ–¹ï¼Œå°±æ˜¯è‡ªå·±é¸æ“‡è¦å‡ºç¾è©¢å•æ¡†æ™‚ç”¨çš„ã€‚</p><h3 id=manifest-è§€æ‘©>manifest è§€æ‘©</h3><p>æˆ‘å€‘ä¾†çœ‹çœ‹å¹¾å€‹çŸ¥åçš„ PWA éƒ½æ˜¯æ€éº¼å¯«ä»–å€‘çš„ <code>manifest.json</code>ã€‚</p><p>ç¬¬ä¸€å€‹æ˜¯ PWA ç•Œä¸­å¾ˆæœ‰åçš„ <a class=link href=https://www.flipkart.com/ target=_blank rel=noopener>flipkart</a>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Flipkart Lite&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;short_name&#34;</span><span class=p>:</span> <span class=s2>&#34;Flipkart Lite&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;icons&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;https:/https://static.coderbridge.com/img/techbridge/images1a.flixcart.com/www/linchpin/batman-returns/logo_lite-cbb3574d.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;192x192&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;gcm_sender_id&#34;</span><span class=p>:</span> <span class=s2>&#34;656085505957&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;gcm_user_visible_only&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;start_url&#34;</span><span class=p>:</span> <span class=s2>&#34;/?start_url=homescreenicon&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;permissions&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;gcm&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;orientation&#34;</span><span class=p>:</span> <span class=s2>&#34;portrait&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;display&#34;</span><span class=p>:</span> <span class=s2>&#34;standalone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;theme_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#2874f0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;background_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#2874f0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å†ä¾†æ˜¯é¼é¼å¤§åçš„ <a class=link href=https://mobile.twitter.com/manifest.json target=_blank rel=noopener>twitter</a>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;background_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#ffffff&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;It&#39;s what&#39;s happening. From breaking news and entertainment, sports and politics, to big events and everyday interests.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;display&#34;</span><span class=p>:</span> <span class=s2>&#34;standalone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;gcm_sender_id&#34;</span><span class=p>:</span> <span class=s2>&#34;49625052041&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;gcm_user_visible_only&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;icons&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;https://abs.twimg.com/responsive-web/web/ltr/icon-default.604e2486a34a2f6e.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;192x192&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;https://abs.twimg.com/responsive-web/web/ltr/icon-default.604e2486a34a2f6e.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;512x512&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Twitter&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;share_target&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;action&#34;</span><span class=p>:</span> <span class=s2>&#34;compose/tweet&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;params&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;title&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;text&#34;</span><span class=p>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;url&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;short_name&#34;</span><span class=p>:</span> <span class=s2>&#34;Twitter&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;start_url&#34;</span><span class=p>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;theme_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#ffffff&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scope&#34;</span><span class=p>:</span> <span class=s2>&#34;/&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ€å¾Œå‰‡æ˜¯ <a class=link href=https://events.google.com/io target=_blank rel=noopener>Google I/O 2018</a>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Google I/O 2018&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;short_name&#34;</span><span class=p>:</span> <span class=s2>&#34;I/O 2018&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;start_url&#34;</span><span class=p>:</span> <span class=s2>&#34;./?utm_source=web_app_manifest&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;display&#34;</span><span class=p>:</span> <span class=s2>&#34;standalone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;theme_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#6284F3&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;background_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#6284F3&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;icons&#34;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;static/images/homescreen/homescreen57.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;57x57&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;static/images/homescreen/homescreen114.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;114x114&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;static/images/homescreen/homescreen128.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;128x128&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;static/images/homescreen/homescreen144.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;144x144&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;static/images/homescreen/homescreen192.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;192x192&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;static/images/homescreen/homescreen512.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;512x512&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;prefer_related_applications&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;related_applications&#34;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;platform&#34;</span><span class=p>:</span> <span class=s2>&#34;play&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;com.google.samples.apps.iosched&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;gcm_sender_id&#34;</span><span class=p>:</span> <span class=s2>&#34;103953800507&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘æ»¿å–œæ­¡è§€å¯Ÿåˆ¥äººå®¶çš„é€™äº›æ±è¥¿ï¼Œå› ç‚ºä½ æœƒç™¼ç¾å¾ˆå¤šä½ æŸ¥è³‡æ–™æ™‚éºæ¼æˆ–æ˜¯æ ¹æœ¬æ‰¾ä¸åˆ°çš„è³‡è¨Šï¼Œè€Œä¸”é€™äº›çœ‹ä¹…äº†ä½ ä¹Ÿæœƒæœ‰å€‹æ¦‚å¿µï¼ŒçŸ¥é“å“ªäº›å±¬æ€§ç‰¹åˆ¥å¸¸ç”¨ï¼Œé™¤äº† <code>manifest.json</code> ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥åƒè€ƒ html è£¡é¢çš„ tagï¼Œä¸€æ¨£èƒ½å­¸ç¿’åˆ°å¾ˆå¤šã€‚</p><hr><h2 id=service-worker-ä»‹ç´¹>Service Worker ä»‹ç´¹</h2><p>åŠ å…¥ Service Worker çš„ç›®çš„å°±åªæœ‰ä¸€å€‹ï¼Œé‚£å°±æ˜¯<code>å¿«å–</code>ã€‚é€é Service Workerï¼ˆä»¥ä¸‹ç°¡ç¨± SWï¼‰ï¼Œå¯ä»¥å¹«åŠ©æˆ‘å€‘åœ¨ç™¼é€ request ä¹‹å‰å°±å…ˆæ””æˆªåˆ°ä¸¦ä¸”åšè™•ç†ï¼Œè€Œé›¢ç·šé‹è¡Œçš„åŸç†ä¹Ÿæ˜¯é€™æ¨£çš„ï¼Œæˆ‘å€‘å…ˆåœ¨ç¬¬ä¸€æ¬¡é–‹å•Ÿæ™‚è¨»å†Š SWï¼Œä¸¦ä¸”åˆ©ç”¨ SW ä¸‹è¼‰éœæ…‹æª”æ¡ˆä¸¦å¿«å–ä½ï¼Œä¹‹å¾Œè‹¥ä½¿ç”¨è€…é›¢ç·šï¼Œæˆ‘å€‘å†ç”¨å·²ç¶“å¿«å–ä½çš„æª”æ¡ˆä¾†å›è¦†ï¼Œå°±ä¸æœƒç™¼é€çœŸçš„ requestï¼Œè‡ªç„¶ä¹Ÿä¸æœƒç™¼ç”Ÿç„¡æ³•é€£ç·šçš„æƒ…æ³ã€‚</p><p>è€Œ Google æœ‰æä¾›äº†ä¸€å€‹æ–¹ä¾¿çš„å·¥å…·ï¼š<a class=link href=https://developers.google.com/web/tools/workbox/ target=_blank rel=noopener>Workbox</a> ä¾†å¹«åŠ©æˆ‘å€‘è‡ªå‹•ç”¢ç”Ÿå‡º SW ä»¥åŠåˆ©ç”¨æ›´æ–¹ä¾¿çš„èªæ³•ä¾†æ””æˆª requestã€‚</p><p>èˆ‰ä¾‹ä¾†èªªï¼Œæˆ‘è‡ªå·±ç”¨çš„æ˜¯ Webpack çš„ pluginï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>new</span> <span class=nx>workboxPlugin</span><span class=p>.</span><span class=nx>InjectManifest</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>swSrc</span><span class=o>:</span> <span class=nx>path</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=nx>__dirname</span><span class=p>,</span> <span class=s1>&#39;..&#39;</span><span class=p>,</span> <span class=nx>SRC_DIR</span><span class=p>,</span> <span class=s1>&#39;sw.js&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>swDest</span><span class=o>:</span> <span class=nx>path</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=nx>__dirname</span><span class=p>,</span> <span class=s1>&#39;..&#39;</span><span class=p>,</span> <span class=nx>DIST_DIR</span><span class=p>,</span> <span class=s1>&#39;sw.js&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>globDirectory</span><span class=o>:</span> <span class=nx>path</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=nx>__dirname</span><span class=p>,</span> <span class=s1>&#39;..&#39;</span><span class=p>,</span> <span class=nx>DIST_DIR</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>globPatterns</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;**/*.{js,css}&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}),</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//sw.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>let</span> <span class=nx>precacheList</span> <span class=o>=</span> <span class=nx>self</span><span class=p>.</span><span class=nx>__precacheManifest</span> <span class=o>||</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=nx>workbox</span><span class=p>.</span><span class=nx>precaching</span><span class=p>.</span><span class=nx>precacheAndRoute</span><span class=p>(</span><span class=nx>precacheList</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>åªè¦é€™æ¨£ä¸€å¯«ï¼Œå°±æœƒè‡ªå‹•å»æ‰¾ç¬¦åˆè¦å‰‡çš„æª”æ¡ˆä¸¦ä¸”åŠ å…¥å¿«å–æ¸…å–®è£¡é¢ï¼Œä½ åªè¦ä¸€è¨»å†Š SW çš„æ™‚å€™å°±æœƒæŠŠé‚£äº›æª”æ¡ˆçµ¦å¿«å–èµ·ä¾†ã€‚</p><p>é™¤æ­¤ä¹‹å¤–å‘¢ï¼ŒWorkbox ä¹Ÿå¯ä»¥é‡å° URL ä¾†ç›£è½ï¼š</p><h5 id=swjs>sw.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// sw.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>workbox</span><span class=p>.</span><span class=nx>routing</span><span class=p>.</span><span class=nx>registerRoute</span><span class=p>(</span><span class=sr>/(https?:\/\/)(.*)\/api\/(.*)/</span><span class=p>,</span> <span class=nx>args</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>workbox</span><span class=p>.</span><span class=nx>strategies</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>networkFirst</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>cacheName</span><span class=o>:</span> <span class=s1>&#39;data-cache&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>plugins</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=nx>workbox</span><span class=p>.</span><span class=nx>expiration</span><span class=p>.</span><span class=nx>Plugin</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>maxEntries</span><span class=o>:</span> <span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>maxAgeSeconds</span><span class=o>:</span> <span class=mi>2592000</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>handle</span><span class=p>(</span><span class=nx>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>response</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>err</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;err:&#39;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>åƒä¸Šé¢çš„ç¨‹å¼ç¢¼å°±æ˜¯é‡å°è·¯å¾‘ä¸­å«æœ‰ <code>api</code> çš„ request åšå¿«å–ï¼Œé€™æ¨£åœ¨é›¢ç·šæ™‚ä¹Ÿå¯ä»¥åˆ©ç”¨ä»¥å‰å¿«å–ä½çš„ API responseã€‚</p><p>Workbox é‡å°é€™ç¨®å‹•æ…‹çš„å¿«å–æä¾›å¹¾ç¨®ç­–ç•¥ï¼Œåˆ†åˆ¥æ˜¯ï¼š<code>staleWhileRevalidate</code>ã€<code>cacheFirst</code>ã€<code>networkFirst</code>ã€<code>networkOnly</code>èˆ‡<code>cacheOnly</code>ï¼Œå…¶å¯¦çœ‹åå­—å°±å¯ä»¥å¤§æ¦‚ç†è§£ç­–ç•¥æ˜¯ä»€éº¼äº†ï¼Œæƒ³çŸ¥é“è©³ç´°çš„å…§å®¹å¯ä»¥åƒè€ƒå®˜æ–¹æ–‡ä»¶ï¼š<a class=link href=https://developers.google.com/web/tools/workbox/modules/workbox-strategies target=_blank rel=noopener>Workbox Strategies</a>ã€‚</p><p>ç¸½ä¹‹è‡ªå¾æœ‰äº† Workbox ä¹‹å¾Œï¼ŒåŸºæœ¬ä¸Šå°±ä¸ç”¨è‡ªå·±æ‰‹å¯« SW äº†ï¼Œéƒ½é è‘—å®ƒæä¾›çš„ API ä»¥åŠåŠŸèƒ½å°±è¡Œäº†ï¼Œå°±å¯ä»¥è‡ªå‹•ç”¢ç”Ÿå‡ºç¬¦åˆéœ€æ±‚çš„ SWã€‚</p><h3 id=add-to-home-screen-banner>Add to home screen banner</h3><p>æœ€å¾Œè¦ä¾†è«‡çš„æ˜¯ã€Œ<code>å®‰è£ PWA</code>ã€é€™ä¸€å¡Šï¼Œåœ¨ iOS Safari ä¸Šé¢åˆ¥ç„¡ä»–æ³•ï¼Œå°±åªèƒ½è‡ªå·±å«å‡ºé¸å–®ç„¶å¾Œé¸å–ã€ŒAdd to home screenã€ï¼Œå¯æ˜¯åœ¨ Android Chrome ä¸Šé¢ï¼Œå¦‚æœä½ ç¬¦åˆä¸€å®šçš„æ¢ä»¶ï¼ˆæœ‰è¨­ç½® <code>mainfest.json</code> ä»¥åŠæœ‰è¨»å†Š Service Workerï¼‰ï¼Œå°±æœƒè‡ªå‹•å¹«ä½ è·³å‡ºä¸€å€‹å¯æ„›çš„ Install bannerã€‚</p><p><img src=https://live.staticflickr.com/65535/52438831646_c2bf748711_o.png max-width=100% max-height=100% class=gallery-image></p><p>ï¼ˆåœ–ç‰‡ä¾†è‡ªï¼š<a class=link href=https://developers.google.com/web/updates/2018/06/a2hs-updates target=_blank rel=noopener>Changes to Add to Home Screen Behavior</a>ï¼‰</p><p>æ ¹æ“š Chrome ç‰ˆæœ¬çš„ä¸åŒï¼Œè¡Œç‚ºä¹Ÿæœ‰æ‰€ä¸åŒã€‚</p><p>åœ¨ Chrome 67ï¼ˆå«ï¼‰ä»¥å‰çš„ç‰ˆæœ¬ï¼Œå¦‚æœä½ åœ¨ <code>beforeinstallprompt</code> äº‹ä»¶è£¡é¢æ²’æœ‰ç‰¹åˆ¥ç”¨ <code>preventDefault()</code>ï¼Œæˆ–æ˜¯é¡¯å¼çš„å‘¼å«äº† <code>prompt()</code>ï¼Œå°±æœƒå‡ºç¾æœ€å·¦é‚Šé‚£å€‹é —å¤§çš„ A2HS bannerã€‚</p><p>ç„¶å¾Œåœ¨ Chrome 68ï¼ˆå«ï¼‰ä¹‹å¾Œçš„ç‰ˆæœ¬ï¼Œç„¡è«–ä½ åšäº†ä»€éº¼ï¼Œç³»çµ±éƒ½æœƒè‡ªå‹•å‡ºç¾é‚£å€‹ Mini-infobarï¼Œä½†å¦‚æœä½¿ç”¨è€…é—œæ‰çš„è©±ï¼Œè¦éš”ä¸‰å€‹æœˆæ‰æœƒå†å‡ºç¾ä¸€æ¬¡ï¼Œå¯¦åœ¨æ˜¯æœ‰å¤ ä¹…ã€‚</p><p>æ¥è‘—å‘¢ï¼Œä¸Šé¢é€™å…©å€‹ A2HS banner è·Ÿ Mini-infobarï¼Œä½¿ç”¨è€…é»æ“Šä¹‹å¾Œéƒ½æœƒå‡ºç¾æœ€å³é‚Šçš„ A2HS Dialogï¼Œæç¤ºä½¿ç”¨è€…è¦ä¸è¦å®‰è£ PWAã€‚</p><p>ä½†æ˜¯åœ¨ Chrome 68 ä»¥å¾Œï¼Œä½ ä¹Ÿå¯ä»¥åˆ©ç”¨ç¨‹å¼å»å‘¼å« <code>beforeinstallprompt</code> è£¡é¢æ‹¿åˆ°çš„ <code>event.prompt()</code> æŠŠé€™å€‹ dialog é¡¯ç¤ºå‡ºä¾†ã€‚</p><p>è½èµ·ä¾†æœ‰é»è¤‡é›œå°å§ï¼Ÿ</p><p>å…ˆä¾†ä»‹ç´¹ <code>beforeinstallprompt</code> é€™å€‹ event å¥½äº†ï¼Œé€™å€‹ event åœ¨ä¸€åˆ‡éƒ½æº–å‚™å°±ç·’ï¼Œç¢ºèªä½ æ»¿è¶³æ¢ä»¶å¯ä»¥é¡¯ç¤º prompt çš„æ™‚å€™æœƒè¢«è§¸ç™¼ï¼Œæœƒå‚³ä¾†ä¸€å€‹ eventï¼Œä½ å¯ä»¥é˜»æ­¢é¡¯ç¤º promptï¼ŒæŠŠé€™å€‹ event å­˜èµ·ä¾†ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// æ­¤ç¯„ä¾‹ä¾†è‡ªä¸Šé¢çš„å®˜æ–¹æ–‡ä»¶
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>let</span> <span class=nx>installPromptEvent</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;beforeinstallprompt&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Prevent Chrome &lt;= 67 from automatically showing the prompt
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>event</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Stash the event so it can be triggered later.
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>installPromptEvent</span> <span class=o>=</span> <span class=nx>event</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Update the install UI to notify the user app can be installed
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#install-button&#39;</span><span class=p>).</span><span class=nx>disabled</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>ç‚ºä»€éº¼è¦å­˜èµ·ä¾†å‘¢ï¼Ÿå› ç‚ºä½¿ç”¨è€…å¯èƒ½ä¸æƒ³ä¸€æ‰“é–‹ç¶²ç«™å°±çœ‹åˆ°é€™å€‹å½ˆçª—ï¼Œæˆ–è€…ä»–å¯èƒ½æ­£åœ¨çµå¸³çµæœä½ è·³é€™å€‹æ±è¥¿ä¾†å¹²æ“¾ä»–ï¼Œæ‰€ä»¥å…ˆæŠŠå®ƒå­˜èµ·ä¾†ï¼Œç­‰é©ç•¶çš„æ™‚æ©Ÿå†å‘¼å« <code>installPromptEvent.prompt()</code> ä¾†è·³å‡º Dialogã€‚</p><p>ä½†è¦æ³¨æ„çš„äº‹æƒ…æ˜¯ä½ ç›´æ¥å‘¼å« <code>installPromptEvent.prompt()</code> æ˜¯æ²’ç”¨çš„ï¼Œä½ å¿…é ˆè¦ <code>within a user gesture</code>ï¼Œæ„æ€å°±æ˜¯ä½ è¦æ”¾åœ¨æŒ‰éˆ•çš„ click äº‹ä»¶ï¼ˆæˆ–å…¶ä»–ç”±ä½¿ç”¨è€…è§¸ç™¼çš„äº‹ä»¶ï¼‰è£¡æ‰æœ‰æ•ˆï¼Œç›´æ¥å‘¼å«æ˜¯æ²’æœ‰ç”¨çš„ï¼Œè€Œä¸”æœƒçœ‹åˆ° console è·³å‡ºéŒ¯èª¤è¨Šæ¯ã€‚</p><p>æˆ‘ä¹‹å‰ä¸€åº¦å¾ˆå¥½å¥‡å®ƒæ˜¯æ€éº¼åšåˆ¤æ–·çš„ï¼Œå¾Œä¾†ç™¼ç¾åŸä¾†æœ‰ <code>event.isTrusted</code> å¯ä»¥ç”¨ï¼Œå¯ä»¥åˆ¤æ–·ä¸€å€‹äº‹ä»¶æ˜¯ä¸æ˜¯è¢«ä½¿ç”¨è€…ä¸»å‹•è§¸ç™¼çš„ï¼Œåƒè€ƒè³‡æ–™ï¼š<a class=link href=https://developer.mozilla.org/en-US/docs/Web/API/Event/isTrusted target=_blank rel=noopener>MDN - Event.isTrusted</a>ã€‚</p><p>ç¸½ä¹‹å‘¢ï¼Œå› ç‚ºåœ¨ä¸åŒç‰ˆæœ¬ä¸Šçš„ Chrome æœ‰ä¸åŒè¡Œç‚ºï¼Œæ‰€ä»¥æœ€å¾Œæˆ‘å€‘æ±ºå®šç”¨ä¸‹é¢çš„ç¨‹å¼ç¢¼é‡å°ä¸åŒç‰ˆæœ¬æœ‰ä¸åŒçš„åæ‡‰ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// æŠŠ event å­˜èµ·ä¾†
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>installPromptEvent</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// è¦é¡¯ç¤º prompt çš„å»¶é²
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>showTime</span> <span class=o>=</span> <span class=mi>30</span> <span class=o>*</span> <span class=mi>1000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;beforeinstallprompt&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>e</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=nx>installPromptEvent</span> <span class=o>=</span> <span class=nx>e</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>navigator</span><span class=p>.</span><span class=nx>userAgent</span><span class=p>.</span><span class=nx>match</span><span class=p>(</span><span class=sr>/Chrom(e|ium)\\/</span><span class=p>([</span><span class=mi>0</span><span class=o>-</span><span class=mi>9</span><span class=p>]</span><span class=o>+</span><span class=p>)</span><span class=err>\\</span><span class=p>.</span><span class=o>/</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>version</span> <span class=o>=</span> <span class=p>(</span><span class=nx>data</span> <span class=o>&amp;&amp;</span> <span class=nx>data</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;=</span> <span class=mi>2</span><span class=p>)</span> <span class=o>?</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>data</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=mi>10</span><span class=p>)</span> <span class=o>:</span> <span class=kc>null</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>version</span> <span class=o>&amp;&amp;</span> <span class=nx>installPromptEvent</span><span class=p>.</span><span class=nx>prompt</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// å»¶é²ä¸€æ®µæ™‚é–“æ‰é¡¯ç¤º prompt
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// å¦‚æœ Chrome ç‰ˆæœ¬æ˜¯ 67ï¼ˆå«ï¼‰ä»¥ä¸‹ï¼Œå¯ä»¥ç›´æ¥å‘¼å«
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span> <span class=p>(</span><span class=nx>version</span> <span class=o>&lt;=</span> <span class=mi>67</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>installPromptEvent</span><span class=p>.</span><span class=nx>prompt</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1>// å¦å‰‡çš„è©±å¿…é ˆé€é user action ä¸»å‹•è§¸ç™¼
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=c1>// é€™é‚Šå¹« #root åŠ ä¸Š event listenerï¼Œä»£è¡¨é»æ“Šè¢å¹•ä»»ä½•ä¸€è™•éƒ½æœƒé¡¯ç¤º prompt
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#root&#39;</span><span class=p>).</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=nx>addToHomeScreen</span><span class=p>)</span>    
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=nx>showTime</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>addToHomeScreen</span><span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>installPromptEvent</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>installPromptEvent</span><span class=p>.</span><span class=nx>prompt</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nx>installPromptEvent</span> <span class=o>=</span> <span class=kc>null</span>
</span></span><span class=line><span class=cl>    <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#root&#39;</span><span class=p>).</span><span class=nx>removeEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=nx>addToHomeScreen</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœæ˜¯ 67 ä»¥ä¸‹ï¼Œç›´æ¥å‘¼å«å°±å¯ä»¥é¡¯ç¤º <code>prompt</code>ï¼Œå¦å‰‡çš„è©±é‚„è¦å†ä¸€æ­¥ï¼Œè¦åŠ å€‹ <code>event listener</code> æ‰è¡Œï¼Œè€Œæˆ‘å€‘ä¹Ÿé¸æ“‡å»¶é² 30 ç§’æ‰é¡¯ç¤ºã€‚</p><p>å‡ºä¹æ„æ–™åœ°ï¼Œé€™æ¨£ä¸€å€‹å°æ”¹å‹•å¸¶ä¾†é©šäººçš„æˆé•·ï¼ŒåŸæœ¬ä¸€å¤©å¤§æ¦‚æ‰ 20ã€30 å€‹äººå®‰è£ PWAï¼Œç¶“éé€™æ¨£èª¿æ•´ä¹‹å¾Œç¬é–“è®Šæˆå…«åˆ°åå€ï¼Œçœ‹åˆ° GA çš„é‚£å€‹çµ±è¨ˆåœ–æˆ‘ä¹Ÿåš‡äº†ä¸€è·³ï¼Œæ²’æƒ³åˆ°æ•ˆæœé€™éº¼å¥½ã€‚</p><p>èˆ‡å…¶ä¸€ç›´ç©æ¥µåœ°è¦åˆ¥äººå¿«é»å®‰è£ PWAï¼Œé‚„ä¸å¦‚åªè¦æ±‚çœŸçš„å°ä½ ç”¢å“æœ‰èˆˆè¶£ï¼ˆåœç•™è¶…é 30 ç§’é˜ï¼‰çš„äººã€‚</p><hr><h2 id=ç”¨-firebase-åš-web-push>ç”¨ Firebase åš Web Push</h2><h3 id=ç”¨åˆ°çš„è³‡æº>ç”¨åˆ°çš„è³‡æº</h3><p>Web Push æ¨æ’­åŠŸèƒ½ï¼Œé€™é™£å­å¾ˆå¸¸çœ‹åˆ°çš„ä¸€å€‹åŠŸèƒ½ï¼Œå¦‚æœä¸€é€²å…¥ç¶²ç«™ï¼Œçœ‹åˆ°ç¶²ç«™è¦æ±‚é¡¯ç¤ºé€šçŸ¥çš„æ¬Šé™ï¼Œå°±ä»£è¡¨é€™å€‹ç¶²ç«™æœ‰ç”¨é€™åŠŸèƒ½ï¼š</p><p><img src=https://live.staticflickr.com/65535/52438850656_3ce5330b21_o.png max-width=100% max-height=100% class=gallery-image></p><p>é‚£é€šå¸¸ï¼Œå¾ˆå¤šç¶²ç«™ UX è¨­è¨ˆä¸è‰¯ï¼Œåœ¨ä½¿ç”¨è€…æ ¹æœ¬å°±é‚„æä¸æ¸…æ¥šé€™ç¶²ç«™æ˜¯å¹¹éº»çš„æƒ…æ³ä¸‹å°±è·³é€šçŸ¥ï¼Œæ‰€ä»¥å¤§éƒ¨ä»½éƒ½ç›´æ¥æŒ‰å°é–äº†å§ XDï¼Ÿ</p><p>ç¸½ä¹‹ï¼Œåœ¨è¸©äº†å¹¾å€‹å‘ä»¥å¾Œï¼Œçµ‚æ–¼å®Œæ•´çš„å¯«å‡ºäº† Web Push çš„åŠŸèƒ½ã€‚</p><p>å®Œæ•´æ˜¯æŒ‡æœƒåœ¨æ¡Œæ©Ÿã€å®‰å“æ‰‹æ©Ÿç™¼å‡ºæ¨æ’­é€šçŸ¥ï¼Œä¸¦ä¸”é»äº†æœƒé€²åˆ°æŒ‡å®šçš„é é¢ï¼ŒåŒæ™‚åœ¨ Firebase å„²å­˜ç™¼é€è¨Šæ¯çš„è¨˜éŒ„ã€‚</p><p>ç”¨åˆ°çš„è³‡æºå¦‚ä¸‹ï¼š</p><ul><li>è³‡æ–™åº«ï¼š<a class=link href=https://firebase.google.com/products/realtime-database/ target=_blank rel=noopener>Firebase Realtime Database</a></li><li>æ¨æ’­åŠŸèƒ½ï¼š<a class=link href=https://firebase.google.com/docs/cloud-messaging/ target=_blank rel=noopener>Firebase Cloud Messaging</a></li><li>JS frameworkï¼š<a class=link href=https://vuejs.org/ target=_blank rel=noopener>Vue.js</a></li></ul><p><code>Web Push</code> æ˜¯ PWA ä¸€å€‹å¾ˆé‡è¦çš„åŠŸèƒ½ï¼</p><h3 id=å–å¾—-fcm-é‡‘é‘°>å–å¾— FCM é‡‘é‘°</h3><p>æœ¬ç¯‡æ˜¯ç”¨ Firebase çš„ Cloud MessagingåŠŸèƒ½ï¼ˆä»¥ä¸‹ç¨± FCMï¼‰ï¼Œå»å¯¦ä½œ Web Pushã€‚æ‰€ä»¥ç¬¬ä¸€æ­¥æ˜¯è¦å…ˆåœ¨ Firebase ä¸Šé–‹ä¸€å€‹å°ˆæ¡ˆã€‚</p><p><strong>ä»¥ä¸‹æˆªåœ–æ‰€ç”¨åˆ°çš„ Firebase å°ˆæ¡ˆä¹‹å¾Œæœƒåˆªæ‰ï¼Œå„ç¨®é‡‘é‘°æœ€å¾Œéƒ½ä¸æœƒå­˜åœ¨ï¼Œç´”ç¤ºç¯„ç”¨ã€‚</strong></p><p>é–‹å®Œå°ˆæ¡ˆå¾Œï¼Œè¦å–å¾—æ¨æ’­é‡‘é‘°ï¼Œæœ‰äº†é‡‘é‘°æ‰èƒ½å§‹ç”¨ FCM çš„åŠŸèƒ½ã€‚</p><p>é¦–å…ˆé€²åˆ° Firebase å¾Œå°ï¼Œé»é¸é½’è¼ªå¾Œï¼Œå†é»é¸å°ˆæ¡ˆè¨­å®šï¼š</p><p><img src=https://live.staticflickr.com/65535/52439127899_efedc17195_o.png max-width=100% max-height=100% class=gallery-image></p><p>é»æ“Š Cloud Messagingï¼š</p><p><img src=https://live.staticflickr.com/65535/52439308150_dcc89eebfd_o.png max-width=100% max-height=100% class=gallery-image></p><p>é é¢å¾€ä¸‹æ‹‰ï¼Œæœƒçœ‹åˆ°ä¸€å€‹ã€Œç¶²è·¯è¨­å®šã€çš„å€å¡Šï¼Œæœ‰ä¸€å€‹ã€Œç”¢ç”Ÿé‡‘é‘°çµ„ã€çš„æŒ‰é‡‘ï¼ŒæŒ‰ä¸‹å»ï¼š</p><p><img src=https://live.staticflickr.com/65535/52439127849_20fb7aee04_o.png max-width=100% max-height=100% class=gallery-image></p><p>å°±æœƒç”¢ç”Ÿä¸€çµ„ Web Push ç”¨çš„<code>é‡‘é‘°</code>ï¼Œå…ˆå­˜ä¸‹ä¾†ï¼ŒFirebase Config è£¡æœƒç”¨åˆ°ï¼š</p><p><img src=https://live.staticflickr.com/65535/52439127839_7ae66a876d_o.png max-width=100% max-height=100% class=gallery-image></p><h3 id=æ–°å¢-manifestjsonfirebase-config>æ–°å¢ manifest.jsonã€Firebase Config</h3><p>å–å¾—é‡‘é‘°å¾Œï¼Œç¬¬äºŒæ­¥å°±æ˜¯æ–°å¢ä¸€å€‹ <code>manifest.json</code> çš„æª”æ¡ˆï¼Œæª”æ¡ˆå…§å®¹å¤§æ¦‚å¦‚ä¸‹ï¼š</p><h5 id=manifestjson-2>manifest.json</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;short_name&#34;</span><span class=p>:</span> <span class=s2>&#34;XXX&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;XXXXXX&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;icons&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;./logo/logo192.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;192x192&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span> <span class=s2>&#34;./logo/logo512.png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/png&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;512x512&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;src&#34;</span><span class=p>:</span><span class=s2>&#34;./logo/maskable_icon.webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;sizes&#34;</span><span class=p>:</span> <span class=s2>&#34;512x512&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;image/webp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;purpose&#34;</span><span class=p>:</span> <span class=s2>&#34;any maskable&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;start_url&#34;</span><span class=p>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;background_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#ffffff&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;display&#34;</span><span class=p>:</span> <span class=s2>&#34;standalone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scope&#34;</span><span class=p>:</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;theme_color&#34;</span><span class=p>:</span> <span class=s2>&#34;#000000&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;gcm_sender_id&#34;</span><span class=p>:</span> <span class=s2>&#34;103953800507&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ€é‡è¦çš„æ˜¯é€™ä¸€è¡Œï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;gcm_sender_id&#34;</span><span class=err>:</span> <span class=s2>&#34;103953800507&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>é€™è¡Œ<code>ä¸€å®šè¦æœ‰</code>ï¼Œkeyã€value æ˜¯å›ºå®šçš„ï¼Œcopy è²¼ä¸Šå°±è¡Œã€‚</p><h3 id=firebase-config>Firebase Config</h3><p>å»ºç«‹ä¸€å€‹é¦–é çš„æª”æ¡ˆ <code>index.html</code>ï¼Œåœ¨é å°¾çš„éƒ¨ä»½å¼•ç”¨ Firebase Configã€‚<br>Firebase Config ä¸€æ¨£æ˜¯å¾Œå°æœ‰æä¾›ï¼Œé»å°é½’è¼ªï¼Œå†é»å°ˆæ¡ˆè¨­å®šå¾Œï¼Œæ¥è‘—é»ä»£è¡¨ Web çš„é‚£å€‹æŒ‰éˆ•ï¼š</p><p><img src=https://live.staticflickr.com/65535/52439127824_fe5bb89da2_o.png max-width=100% max-height=100% class=gallery-image></p><p>å°±æœƒå‡ºç¾ Config äº†ï¼š</p><p><img src=https://live.staticflickr.com/65535/52439308100_319e8310b7_o.png max-width=100% max-height=100% class=gallery-image></p><p>copy ä»¥å¾Œè²¼åˆ° <code>index.html</code>ï¼Œå¦å¤–ä¹Ÿä¸€ä½µè²¼ä¸Š FCM çš„å¼•ç”¨ï¼Œæ•´åˆå¾Œå¦‚ä¸‹ï¼š</p><h5 id=fcm-web-push-firebase-confightml>fcm-web-push-firebase-config.html</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://www.gstatic.com/firebasejs/5.9.1/firebase.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>config</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>apiKey</span><span class=o>:</span> <span class=s2>&#34;XXXXXXXXXX&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>authDomain</span><span class=o>:</span> <span class=s2>&#34;XXXXXXXXXX.firebaseapp.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>databaseURL</span><span class=o>:</span> <span class=s2>&#34;https://XXXXXXXXXX.firebaseio.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>projectId</span><span class=o>:</span> <span class=s2>&#34;XXXXXXXXXX&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>storageBucket</span><span class=o>:</span> <span class=s2>&#34;XXXXXXXXXX.appspot.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>messagingSenderId</span><span class=o>:</span> <span class=s2>&#34;XXXXXXXXXX&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=nx>firebase</span><span class=p>.</span><span class=nx>initializeApp</span><span class=p>(</span><span class=nx>config</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>database</span> <span class=o>=</span> <span class=nx>firebase</span><span class=p>.</span><span class=nx>database</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>messaging</span> <span class=o>=</span> <span class=nx>firebase</span><span class=p>.</span><span class=nx>messaging</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nx>messaging</span><span class=p>.</span><span class=nx>usePublicVapidKey</span><span class=p>(</span><span class=s1>&#39;XXXXXXXXXXXXXXXXXXXX&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ€å¾Œä¸€è¡Œçš„ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>messaging</span><span class=p>.</span><span class=nx>usePublicVapidKey</span><span class=p>(</span><span class=s1>&#39;XXXXXXXXXXXXXXXXXXXX&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>XXX å°±æ˜¯è¦æ›¿æ›æˆç¬¬ä¸€æ­¥æ‹¿åˆ°çš„ <code>FCM é‡‘é‘°</code>ã€‚</p><h3 id=å–å¾—ä½¿ç”¨è€…çš„-token>å–å¾—ä½¿ç”¨è€…çš„ token</h3><p>ç°¡å–®ä¾†èªªï¼ŒWeb Push æ¨æ’­åŠŸèƒ½çš„æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>è¨»å†Š service-worker â†’ å‘ä½¿ç”¨è€…è¦æ±‚å…è¨±é€šçŸ¥æ¬Šé™ â†’</li><li>FCM ç”¢ç”Ÿé€™å€‹è£ç½®çš„ token â†’ token å¯«é€²è³‡æ–™åº« â†’</li><li>å¾å¾Œå°ä½¿ç”¨ Web Push â†’ Server ç™¼ Web Push åˆ°è£ç½®ä¸Š â†’</li><li>è£ç½®ä¸Šçš„ service worker æ¥æ”¶ â†’ service worker åŸ·è¡Œ notification</li></ul><p>token æ˜¯æ¯ä¸€å€‹è£ç½®æœƒæœ‰çš„ï¼Œä¹‹æ‰€ä»¥æœƒä»¥è£ç½®ç‚ºå–®ä½ï¼Œè€Œä¸æ˜¯ä»¥ä½¿ç”¨è€…ç‚ºå–®ä½ï¼Œæ˜¯å› ç‚ºæ¯ä¸€å€‹è£ç½®éƒ½å¯ä»¥è¨»å†Šservice workerï¼Œè€Œä¸”æ¯æ¬¡å­˜çš„ token éƒ½æœƒä¸åŒï¼Œæ‰€ä»¥ä¸€å€‹ä½¿ç”¨è€…åœ¨æ¡Œæ©Ÿçš„ Chromeã€Fireoxï¼Œæˆ–æ˜¯å®‰å“æ‰‹æ©Ÿçš„Chromeã€Firefoxï¼Œéƒ½æœ‰ä¸åŒçš„ tokenã€‚</p><p>å‡è¨­ç‹å°æ˜åœ¨æ¡Œæ©Ÿçš„ Chromeã€Firefoxï¼Œéƒ½æŒ‰ä¸‹äº†å…è¨±é€šçŸ¥ï¼Œåœ¨å®‰å“æ‰‹æ©Ÿçš„ Chromeã€Firefox ä¹ŸæŒ‰äº†å…è¨±é€šçŸ¥ï¼Œé‚£ç•¶æˆ‘å€‘æŒ‰ä¸‹ç™¼é€æ¨æ’­å¾Œï¼Œç‹å°æ˜å°±æœƒåœ¨ 4 å€‹åœ°æ–¹æ”¶åˆ°ç›¸åŒçš„é€šçŸ¥ã€‚å› ç‚ºæ˜¯ç”¨è£ç½®ä¾†å€åˆ†çš„ã€‚</p><blockquote><p><strong>IOS ç›®å‰é‚„ä¸æ”¯æ´ Web Pushã€‚</strong><br>2020.04.10æ›´æ–°ï¼š<br>ä»Šå¤©çœ‹åˆ° iZooto çš„ <a class=link href=https://www.izooto.com/blog/ios-push-notifications-safari target=_blank rel=noopener>ä¸€ç¯‡æ–‡ç« </a> ä¸Šå¯«ï¼Œåœ¨æ¯”å°äº†ä¸€ä¸‹ <a class=link href="https://caniuse.com/#search=service%20workers" target=_blank rel=noopener>Can I Use</a> ä¸­çš„ service workers æ”¯æ´æƒ…æ³ï¼Œå¯ä»¥çœ‹åˆ° IOS11.3 é–‹å§‹æ”¯æ´ Service Workers äº†ï¼Œä½† <code>Web Push</code> çš„åŠŸèƒ½åªæ”¯æ´åœ¨ MACï¼Œå°šæœªæ”¯æ´åˆ° iPhone ä¸Šã€‚</p></blockquote><h3 id=æ–°å¢-swjs>æ–°å¢ sw.js</h3><p>ç”¨ <a class=link href=https://developers.google.com/web/tools/workbox/ target=_blank rel=noopener>Workbox</a> æ–°å¢ä¸€å€‹ sw.js æª”æ¡ˆï¼ŒæŠŠ Firebase çš„ Config æ”¾é€²å»ï¼Œç¨‹å¼ç¢¼å¦‚ä¸‹ï¼š</p><h5 id=fcm-web-push-sw1js>fcm-web-push-sw1.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>importScripts</span><span class=p>(</span><span class=s2>&#34;https://storage.googleapis.com/workbox-cdn/releases/3.6.3/workbox-sw.js&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>importScripts</span><span class=p>(</span><span class=s1>&#39;https://www.gstatic.com/firebasejs/5.7.0/firebase-app.js&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>importScripts</span><span class=p>(</span><span class=s1>&#39;https://www.gstatic.com/firebasejs/5.7.0/firebase-messaging.js&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>workbox</span><span class=p>.</span><span class=nx>clientsClaim</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>workbox</span><span class=p>.</span><span class=nx>skipWaiting</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>workbox</span><span class=p>.</span><span class=nx>precaching</span><span class=p>.</span><span class=nx>precacheAndRoute</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=c1>// è¦å¿«å–çš„æª”æ¡ˆ
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// firebase config
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>config</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>apiKey</span><span class=o>:</span> <span class=s2>&#34;XXXXXXXXXX&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>authDomain</span><span class=o>:</span> <span class=s2>&#34;XXXXXXXXXX.firebaseapp.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>databaseURL</span><span class=o>:</span> <span class=s2>&#34;https://XXXXXXXXXX.firebaseio.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>projectId</span><span class=o>:</span> <span class=s2>&#34;XXXXXXXXXX&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>storageBucket</span><span class=o>:</span> <span class=s2>&#34;XXXXXXXXXX.appspot.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>messagingSenderId</span><span class=o>:</span> <span class=s2>&#34;XXXXXXXXXX&#34;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nx>firebase</span><span class=p>.</span><span class=nx>initializeApp</span><span class=p>(</span><span class=nx>config</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>messaging</span> <span class=o>=</span> <span class=nx>firebase</span><span class=p>.</span><span class=nx>messaging</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>å¦‚æœæ¨æ’­è£¡è¦æ”¾å…¬å¸çš„ Logoï¼Œé‚£ Logo çš„åœ–æª”å°±è¦å¯«é€²å¿«å–æª”æ¡ˆçš„æ¸…å–®è£¡ï¼Œåˆ°æ™‚æ¨æ’­æ‰æœ‰åœ–æª”å¯ä»¥é¡¯ç¤ºã€‚</p></blockquote><h3 id=è¨»å†Š-swjså­˜-cookieså­˜-firebase>è¨»å†Š sw.jsã€å­˜ Cookiesã€å­˜ Firebase</h3><p>å¦‚æœæ‹¿åˆ°çš„ token ä¸å­˜åœ¨ Cookies è£¡ï¼Œç”¨ Cookies åˆ¤æ–·æ˜¯å¦æ‹¿é tokenï¼Œé‚£ä½¿ç”¨è€…å°±æœƒå­˜åˆ° 2 çµ„ä»¥ä¸Šçš„ tokenï¼Œåœ¨ç™¼æ¨æ’­æ™‚ï¼Œå°±æœƒæ”¶åˆ°ç›¸åŒçš„è¨Šæ¯å¤šæ¬¡ã€‚</p><p><strong>ç•¶ç„¶ï¼Œå¦‚æœä½¿ç”¨è€…æ¸…é™¤äº†å¿«å–ï¼Œå°±æœƒæœ‰åˆ¥ç¨®æƒ…æ³ç™¼ç”Ÿï¼Œæœ€å¥½çš„æ–¹å¼é‚„æ˜¯è®“ä½¿ç”¨è€…ç™»å…¥æœƒå“¡å¾Œï¼Œå†å–å¾— tokenï¼ŒæŠŠ token è·Ÿæœƒå“¡ç¶ä¸€èµ·ï¼Œå°±ä¸æœƒæœ‰å¥‡å¥‡æ€ªæ€ªçš„æƒ…å½¢å‡ºç¾ã€‚</strong></p><p>ä»¥ä¸‹ç‚º JS codeï¼š</p><h5 id=fcm-web-push-get-tokenjs>fcm-web-push-get-token.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;load&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=s1>&#39;serviceWorker&#39;</span> <span class=k>in</span> <span class=nx>navigator</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>navigator</span><span class=p>.</span><span class=nx>serviceWorker</span><span class=p>.</span><span class=nx>register</span><span class=p>(</span><span class=s1>&#39;/sw.js&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>reg</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// firebase methodsï¼Œç”¨åŒä¸€æ”¯sw.js
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>messaging</span><span class=p>.</span><span class=nx>useServiceWorker</span><span class=p>(</span><span class=nx>reg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=c1>// è¨»å†Šå¤±æ•—
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;error: &#39;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>messaging</span><span class=p>.</span><span class=nx>requestPermission</span><span class=p>().</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// å…ˆåˆ¤æ–·cookiesæœ‰æ²’æœ‰tokenï¼Œæ²’æœ‰å†å–token
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kd>var</span> <span class=nx>ckv</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/(?:(?:^|.*;\\s*)augustusWsPush\s*\=\s*([^;]*).*$)|^.*$/</span><span class=p>,</span> <span class=s2>&#34;$1&#34;</span><span class=p>)</span> <span class=o>||</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// cookiesä¸å­˜åœ¨ï¼Œè·Ÿä½¿ç”¨è€…è¦æ±‚é€šçŸ¥æ¬Šé™
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span><span class=p>(</span><span class=nx>ckv</span> <span class=o>===</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// æ‹¿åˆ°tokenï¼Œfirebase-messaging-sw.js å°±æœƒå­˜ Service Workers è£¡
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>messaging</span><span class=p>.</span><span class=nx>getToken</span><span class=p>().</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>currentToken</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// tokenå­˜è‡³firebase
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=nx>id</span> <span class=o>=</span> <span class=nx>currentToken</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=nx>firebase</span><span class=p>.</span><span class=nx>database</span><span class=p>().</span><span class=nx>ref</span><span class=p>(</span><span class=s1>&#39;pushUsers/&#39;</span> <span class=o>+</span> <span class=nx>id</span><span class=p>).</span><span class=nx>set</span><span class=p>({</span><span class=s1>&#39;token&#39;</span><span class=o>:</span> <span class=nx>currentToken</span><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// tokenå­˜è‡³cookies
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span> <span class=o>=</span> <span class=s2>&#34;augustusWsPush=&#34;</span> <span class=o>+</span> <span class=nx>currentToken</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// cookies å·²å­˜åœ¨ï¼Œå¾ cookies å–å‡ºå¾Œå‚³è‡³ firebase
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>var</span> <span class=nx>id</span> <span class=o>=</span> <span class=nx>ckv</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=nx>firebase</span><span class=p>.</span><span class=nx>database</span><span class=p>().</span><span class=nx>ref</span><span class=p>(</span><span class=s1>&#39;pushUsers/&#39;</span> <span class=o>+</span> <span class=nx>id</span><span class=p>).</span><span class=nx>set</span><span class=p>({</span><span class=s1>&#39;token&#39;</span><span class=o>:</span> <span class=nx>ckv</span><span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>}).</span><span class=k>catch</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;ä½¿ç”¨è€…æœªå…è¨±é€šçŸ¥&#39;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>è£¡é¢æœ‰ä¸€è¡Œ<code>å¾ˆé‡è¦</code>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>messaging</span><span class=p>.</span><span class=nx>useServiceWorker</span><span class=p>(</span><span class=nx>xxx</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>é€™æ˜¯é€™æ¬¡è¸©åˆ°çš„<code>å‘</code>ã€‚</p><p>å¦‚æœæ²’å¯«é€™è¡Œï¼Œå°±æœƒç™¼ç¾ç¶²ç«™å­˜äº† 2 å€‹ service workerï¼Œåˆ†åˆ¥æ˜¯ Firebase çš„ï¼Œä»¥åŠæˆ‘å€‘è‡ªå·±çš„ã€‚é€™è¡Œå¯ä»¥è®“ FCM åªå­˜æˆ‘å€‘è¨»å†Šçš„ sw.jsï¼Œæ‰å¯ä»¥åœ¨ç”¨ FCM æ¨æ’­æ™‚ï¼Œé †åˆ©çš„åŸ·è¡Œæ¨æ’­åŠé»æ“Šå¾Œé–‹å•ŸæŒ‡å®šçš„é é¢ã€‚</p><p>æˆåŠŸçš„è©±ï¼Œé–‹å•Ÿ <code>index.html</code>ï¼Œåœ¨é–‹ç™¼äººå“¡å·¥å…·çš„ Application â†’ Service Workersï¼Œå°±æœƒçœ‹è¦‹è¨»å†Šäº† sw.js æª”æ¡ˆï¼š</p><p><img src=https://live.staticflickr.com/65535/52439127809_134d9e2d7f_o.png max-width=100% max-height=100% class=gallery-image></p><p><strong>è¨»å†Š sw.js åªèƒ½åœ¨ https ä¸‹ï¼Œå› æ­¤ç¶²åŸŸå¿…é ˆæœ‰S SLï¼Œä¸ç„¶æœƒè¨»å†Šå¤±æ•—ã€‚</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>messaging</span><span class=p>.</span><span class=nx>requestPermission</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>é€™è¡Œæœƒè·Ÿä½¿ç”¨è€…è¦å…è¨±é€šçŸ¥ï¼Œä½¿ç”¨è€…æŒ‰ä¸‹å…è¨±å¾Œ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>messaging</span><span class=p>.</span><span class=nx>requestPermission</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>é€™è¡Œå°±æœƒç”¢ç”Ÿ FCM çš„ tokenï¼Œä¹‹å¾Œå°±æ˜¯å­˜é€² Firebase è·Ÿ Cookiesã€‚<br>Firebase ä¸Šæœƒçœ‹åˆ°ä»¥ä¸‹ï¼š</p><p><img src=https://live.staticflickr.com/65535/52439308070_338f1a11b0_o.png max-width=100% max-height=100% class=gallery-image></p><p>ä¹‹å¾Œåªè¦è·‘å€‹è¿´åœˆï¼Œå°±å¯ä»¥ä¸€å€‹å€‹å»ç™¼é€ Web Pushã€‚</p><h3 id=ç™¼é€-web-push>ç™¼é€ Web Push</h3><p>é€™é‚Šæ–°å¢ä¸€å€‹ admin.html ä¾†ç•¶åšç™¼é€ Web Push çš„å¾Œå°ä»‹é¢ï¼Œç›´æ¥ç”¨ Vue.js æŠ“æ¯å€‹ <code>input</code> çš„å€¼ã€‚</p><p><img src=https://live.staticflickr.com/65535/52438349427_3b8f4d712c_o.png max-width=100% max-height=100% class=gallery-image></p><p>Web Push å¦‚æœè¦åˆ¤æ–·æˆæ•ˆï¼Œç›´æ¥ç”¨ Google Analytics çš„ utm åƒæ•¸å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥å¾Œå°æ¬„ä½æœ‰çµ¦ utm ç”¨çš„ 3 å€‹ä¸»è¦åƒæ•¸ã€‚<br>ä¸å«æ¨£å¼çš„åŸå§‹ç¢¼æ–‡æœ«æœƒé™„ä¸Š GitHub ç¶²å€ã€‚<br>åœ¨ç™¼é€ Web Push æ™‚ï¼Œé‚„è¦å¡«å…¥ä¼ºæœå™¨çš„é‡‘é‘°ï¼Œé€™ä¹Ÿæ˜¯å¾ Firebase å¾Œå°å¯ä»¥æ‹¿åˆ°ã€‚é»å°é½’è¼ª â†’ å°ˆæ¡ˆè¨­å®š â†’ Cloud Messagingï¼Œç¬¬ä¸€å€‹ã€Œä¼ºæœå™¨é‡‘é‘°ã€çš„å€¼å°±æ˜¯äº†ï¼š</p><p><img src=https://live.staticflickr.com/65535/52439308040_f09728ee96_o.png max-width=100% max-height=100% class=gallery-image></p><p>ç™¼é€ Web Push çš„ JS å¦‚ä¸‹ï¼Œå¯«åœ¨ <code>admin.html</code> è£¡ï¼š</p><h5 id=fcm-web-push-triggerjs>fcm-web-push-trigger.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>notification</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;title&#39;</span><span class=o>:</span> <span class=s1>&#39;web pushæ¨™é¡Œ&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;body&#39;</span><span class=o>:</span> <span class=s1>&#39;web pushå…§æ–‡&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;badge&#39;</span><span class=o>:</span> <span class=s1>&#39;logoåœ–æª”è·¯å¾‘&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;icon&#39;</span><span class=o>:</span> <span class=s1>&#39;logoåœ–æª”è·¯å¾‘&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;click_action&#39;</span><span class=o>:</span> <span class=s1>&#39;https://www.domain.com.tw&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;data&#39;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;url&#39;</span><span class=o>:</span> <span class=s1>&#39;https://www.domain.com.tw&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;https://fcm.googleapis.com/fcm/send&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;method&#39;</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;headers&#39;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Authorization&#39;</span><span class=o>:</span> <span class=s1>&#39;key=å¾firebaseä¸Šå–å¾—ä¼ºæœå™¨é‡‘é‘°&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;body&#39;</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;data&#39;</span><span class=o>:</span> <span class=nx>notification</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;to&#39;</span><span class=o>:</span> <span class=s1>&#39;ä½¿ç”¨è€…çš„token&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>response</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=k>catch</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>alert</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=æ¥æ”¶-web-push>æ¥æ”¶ Web Push</h3><p>æ¥å— Web Push æœ‰ 2 ç¨®æƒ…æ³ï¼š</p><ol><li>ä½¿ç”¨è€…æ­£é–‹å•Ÿå®˜ç¶²é é¢</li><li>ä½¿ç”¨è€…æ²’æœ‰é–‹å•Ÿå®˜ç¶²é é¢</li></ol><p>ç¬¬ä¸€ç¨®æƒ…æ³ï¼Œæ˜¯åœ¨ index.js ä¸‹å¯«ä¸€å€‹ <code>messaging.onMessage</code> çš„ function è™•ç†ã€‚<br>ç¬¬äºŒç¨®æƒ…æ³ï¼Œæ˜¯åœ¨ sw.js ä¸‹å¯«ä¸€å€‹ <code>messaging.setBackgroundMessageHandler</code> çš„ function è™•ç†ã€‚</p><h4 id=ä½¿ç”¨è€…æ­£é–‹å•Ÿå®˜ç¶²é é¢>ä½¿ç”¨è€…æ­£é–‹å•Ÿå®˜ç¶²é é¢</h4><p>å®˜ç¶²æ­£é–‹å•Ÿçš„ç‹€æ³ä¸‹ï¼Œå±¬æ–¼ JS çš„ notification åŠŸèƒ½ï¼Œfunction ç¯„ä¾‹å¦‚ä¸‹ï¼š</p><h5 id=fcm-web-push-notificationjs>fcm-web-push-notification.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>messaging</span><span class=p>.</span><span class=nx>onMessage</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>payload</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>msgTitle</span> <span class=o>=</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>url</span> <span class=o>=</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>click_action</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>notification</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Notification</span><span class=p>(</span><span class=nx>msgTitle</span><span class=p>,</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// é»æ“Šæ¨æ’­å¾Œè¦é€£å»å“ª
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>notification</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>e</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=nx>url</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p><code>payload</code> å°±æ˜¯å‚³ä¾†çš„å€¼ï¼Œé»æ“Šå¾Œè¦å°åˆ°çš„é é¢å°±ç”¨ <code>location.href</code> ä¾†è™•ç†ã€‚</p><h4 id=ä½¿ç”¨è€…æ²’æœ‰é–‹å•Ÿå®˜ç¶²é é¢>ä½¿ç”¨è€…æ²’æœ‰é–‹å•Ÿå®˜ç¶²é é¢</h4><p>ä½¿ç”¨è€…åœ¨ä¸Šç¶²ï¼Œä½†æ²’æœ‰é–‹å•Ÿå®˜ç¶²çš„é é¢ï¼Œå°±æ˜¯ç”±ä¹‹å‰è¨»å†Šçš„ <code>sw.js</code> è™•ç†ï¼Œåœ¨ <code>sw.js</code> åŠ å…¥ä»¥ä¸‹ï¼š</p><h5 id=fcm-web-push-sw2js>fcm-web-push-sw2.js</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>click_action</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ç›£è½notifictioné»æ“Šäº‹ä»¶
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>self</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;notificationclick&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>url</span> <span class=o>=</span> <span class=nx>click_action</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>event</span><span class=p>.</span><span class=nx>notification</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nx>event</span><span class=p>.</span><span class=nx>waitUntil</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>clients</span><span class=p>.</span><span class=nx>matchAll</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;window&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}).</span><span class=nx>then</span><span class=p>(</span><span class=nx>windowClients</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// å¦‚æœtabæ˜¯é–‹è‘—çš„ï¼Œå°± focus é€™å€‹tab
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>for</span> <span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>windowClients</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>client</span> <span class=o>=</span> <span class=nx>windowClients</span><span class=p>[</span><span class=nx>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=nx>client</span><span class=p>.</span><span class=nx>url</span> <span class=o>===</span> <span class=nx>url</span> <span class=o>&amp;&amp;</span> <span class=s1>&#39;focus&#39;</span> <span class=k>in</span> <span class=nx>client</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=nx>client</span><span class=p>.</span><span class=nx>focus</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=c1>// å¦‚æœæ²’æœ‰ï¼Œå°±æ–°å¢tab
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span><span class=p>(</span><span class=nx>clients</span><span class=p>.</span><span class=nx>openWindow</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>clients</span><span class=p>.</span><span class=nx>openWindow</span><span class=p>(</span><span class=nx>click_action</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// FCM
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>messaging</span><span class=p>.</span><span class=nx>setBackgroundMessageHandler</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>payload</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>title</span> <span class=o>=</span> <span class=nx>data</span><span class=p>.</span><span class=nx>title</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>body</span><span class=o>:</span> <span class=nx>data</span><span class=p>.</span><span class=nx>body</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>icon</span><span class=o>:</span> <span class=s1>&#39;/logo/logo192.png&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>badge</span><span class=o>:</span> <span class=s1>&#39;/logo/logo192.png&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=nx>click_action</span> <span class=o>=</span> <span class=nx>data</span><span class=p>.</span><span class=nx>click_action</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>self</span><span class=p>.</span><span class=nx>registration</span><span class=p>.</span><span class=nx>showNotification</span><span class=p>(</span><span class=nx>title</span><span class=p>,</span> <span class=nx>options</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p><code>click_action</code> æ˜¯é»æ“Šå¾Œè¦é–‹å•Ÿçš„é é¢ç¶²å€ï¼Œä½†è¦å¦å¤–å¯«ä¸€å€‹ <code>notificationclick</code> ä¾†è™•ç†ã€‚</p><p><strong>é€™é‚Šè¸©äº†ä¸€å€‹å‘ï¼Œå¦‚æœæŒ‰ç…§ä¸€èˆ¬é †åºä¾†å¯«ï¼Œæœƒå…ˆå¯«äº† <code>messaging.setBackgroundMessageHandler</code> å¾Œï¼Œå†å¯« <code>notificationclick</code>ã€‚ç„¶å¾Œå°±æœƒç™¼ç¾ï¼ŒChrome ä¸Šå¯ä»¥æ­£å¸¸é‹ä½œï¼Œä½†åœ¨ Firefox ä¸Šæ€éº¼é»å°±æ˜¯ä¸æœƒé–‹å•Ÿé é¢ã€‚</strong></p><p>Google äº†å¾ˆä¹…ï¼Œæ‰çœ‹åˆ°é€™ç¯‡ï¼š<a class=link href=https://stackoverflow.com/questions/53595019/service-worker-notificationclick-event-doesnt-focus-or-open-my-website-in-tab target=_blank rel=noopener>service worker notificationclick event doesnâ€™t focus or open my website in tab</a></p><p><code>click_action</code> æ˜¯ Chrome ç”¨çš„ï¼Œå¦‚æœ <code>messaging.setBackgroundMessageHandler</code> å…ˆå¯«äº†ï¼Œé‚£ FCM å°±æœƒå…¨éƒ¨æ¥æ”¶ Web Push çš„åŠŸèƒ½ï¼Œå°±ä¸æœƒè®“åŸç”Ÿçš„ <code>notificationclick</code> äº‹ä»¶è¢«é‹ä½œï¼Œå› æ­¤ <code>notificationclick</code> å¾—å¯«åœ¨å‰ï¼Œè®“åŸç”Ÿäº‹ä»¶é‹ä½œå¾Œï¼Œå†åŸ·è¡Œ FCM çš„äº‹ä»¶ã€‚</p><h3 id=è£œå……è³‡æº>è£œå……è³‡æº</h3><p>æœ‰äº†ç™¼é€ã€æ¥æ”¶ï¼ŒåŸºæœ¬ä¸Š Web Push å°±å¯ä»¥é †åˆ©é‹ä½œäº†ã€‚<br>è¦æ³¨æ„çš„æ˜¯ Web Push åªæ¥å—åœ¨ https ä»¥ä¸‹é‹è¡Œã€‚<br>æœ€å¾Œé™„ä¸Šå­¸ç¿’æ™‚åƒè€ƒçš„æ•™å­¸æ–‡ï¼Œä»¥åŠæœ¬ç¯‡çš„ GitHub åŸå§‹ç¢¼ã€‚</p><p>å¾å»º Firebase å°±é–‹å§‹æ•™å­¸çš„ï¼ˆè‹±æ–‡ï¼‰ï¼š<a class=link href=https://www.itwonders-web.com/blog/push-notification-using-firebase-demo-tutorial target=_blank rel=noopener>Tutorial: Web Push notification using Firebase</a></p><p><a class=link href=https://medium.com/@Whien/%E5%BB%BA%E7%AB%8B-service-worker-web-push-notification-firebase-push-notification%E5%AF%A6%E4%BD%9C%E7%B4%80%E9%8C%84-da5e0ffbead4 target=_blank rel=noopener>å»ºç«‹ Service Worker Web Push Notification â€” (Firebase Push Notificationå¯¦ä½œç´€éŒ„)</a></p><p><a class=link href=https://ithelp.ithome.com.tw/articles/10196898 target=_blank rel=noopener>Push Notificationä¹‹æˆç‚ºè¨‚é–±ç”¨æˆ¶(Firebaseå¯¦ä½œ)</a></p><p>Google å®˜æ–¹æ•™å­¸çš„åŸå§‹ç¢¼ï¼š<a class=link href=https://github.com/GoogleChrome/samples/tree/gh-pages/push-messaging-and-notifications target=_blank rel=noopener>GitHub</a><br>Google å®˜æ–¹æ•™å­¸çš„åŠŸèƒ½ç¤ºç¯„ï¼š<a class=link href=https://web-push-book.gauntface.com/demos/notification-examples/ target=_blank rel=noopener>Notification Examples</a></p><hr></section><footer class=article-footer><section class=article-tags><a href=https://wayneblog.ga/tags/pwa/>pwa</a>
<a href=https://wayneblog.ga/tags/seo/>seo</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸é—œæ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=https://wayneblog.ga/2022-08-17/seo-backlinks-building-guide/><div class=article-image><img src=https://live.staticflickr.com/65535/52290179402_693c7086dc_o.jpg loading=lazy data-key=seo-backlinks-building-guide data-hash=https://live.staticflickr.com/65535/52290179402_693c7086dc_o.jpg></div><div class=article-details><h2 class=article-title>SEO åå‘é€£çµå»ºç«‹ï¼šçµ‚æ¥µæŒ‡å—(2022)</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-blog-wayne.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2022 Wayne's blog | å‰æ©çš„éƒ¨è½æ ¼ | æŠ€è¡“åšå®¢</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®éŒ„</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#å°‡ç¶²é è®Šæˆprogressive-web-applicationpwa>å°‡ç¶²é è®ŠæˆProgressive Web Application(PWA)</a><ol><li><a href=#step1ä¸‹è¼‰-chrome-æ“´å……å¥—ä»¶>Step1ï¼šä¸‹è¼‰ Chrome æ“´å……å¥—ä»¶</a></li><li><a href=#step2æª¢æŸ¥ç¶²é >Step2ï¼šæª¢æŸ¥ç¶²é </a></li><li><a href=#step3å»ºç«‹-manifestjson>Step3ï¼šå»ºç«‹ manifest.json</a><ol><li></li></ol></li><li><a href=#step4html-åŠ å…¥-manifestjson>Step4ï¼šhtml åŠ å…¥ manifest.json</a></li><li><a href=#step5æ‰“é–‹é–‹ç™¼äººå“¡å·¥å…·æª¢æŸ¥-manifestjson-çš„è¨­å®š>Step5ï¼šæ‰“é–‹é–‹ç™¼äººå“¡å·¥å…·æª¢æŸ¥ manifest.json çš„è¨­å®š</a></li><li><a href=#step6åŠ å…¥-serviceworker-èªæ³•>Step6ï¼šåŠ å…¥ <code>serviceWorker</code> èªæ³•</a></li><li><a href=#step7å»ºç«‹-service-workerjs-æª”æ¡ˆ>Step7ï¼šå»ºç«‹ <code>service-worker.js</code> æª”æ¡ˆ</a><ol><li></li></ol></li><li><a href=#step8ç¢ºèª-service-workers-æ˜¯å¦æ­£å¸¸>Step8ï¼šç¢ºèª Service Workers æ˜¯å¦æ­£å¸¸</a></li><li><a href=#step9å®‰è£é é¢>Step9ï¼šå®‰è£ã€Œé é¢ã€</a></li><li><a href=#step10å®‰è£>Step10ï¼šå®‰è£</a></li></ol></li><li><a href=#manifestjson-ä»‹ç´¹>manifest.json ä»‹ç´¹</a><ol><li><a href=#manifestjsonæ˜¯åšä»€éº¼ç”¨çš„>manifest.jsonæ˜¯åšä»€éº¼ç”¨çš„ï¼Ÿ</a></li><li><a href=#manifestjson-æˆå“¡>manifest.json æˆå“¡</a><ol><li><a href=#theme_color>theme_color</a></li><li><a href=#background_color>background_color</a></li><li><a href=#icons>icons</a></li><li><a href=#name>name</a></li><li><a href=#short_name>short_name</a></li><li><a href=#lang>lang</a></li><li><a href=#description>description</a></li><li><a href=#dir>dir</a></li><li><a href=#display>display</a></li><li><a href=#orientation>orientation</a></li><li><a href=#prefer_related_applications>prefer_related_applications</a></li><li><a href=#related_applications>related_applications</a></li><li><a href=#start_url>start_url</a></li><li><a href=#scope>scope</a></li><li><a href=#manifestjson-åŸºæœ¬æª”æ¡ˆå…§å®¹>manifest.json åŸºæœ¬æª”æ¡ˆå…§å®¹</a></li></ol></li><li><a href=#é—œæ–¼chrome-ä¸»å‹•æç¤ºåŠ å…¥ä¸»ç•«é¢>é—œæ–¼ã€ŒChrome ä¸»å‹•æç¤ºåŠ å…¥ä¸»ç•«é¢ã€</a></li><li><a href=#manifest-è§€æ‘©>manifest è§€æ‘©</a></li></ol></li><li><a href=#service-worker-ä»‹ç´¹>Service Worker ä»‹ç´¹</a><ol><li><ol><li></li></ol></li><li><a href=#add-to-home-screen-banner>Add to home screen banner</a></li></ol></li><li><a href=#ç”¨-firebase-åš-web-push>ç”¨ Firebase åš Web Push</a><ol><li><a href=#ç”¨åˆ°çš„è³‡æº>ç”¨åˆ°çš„è³‡æº</a></li><li><a href=#å–å¾—-fcm-é‡‘é‘°>å–å¾— FCM é‡‘é‘°</a></li><li><a href=#æ–°å¢-manifestjsonfirebase-config>æ–°å¢ manifest.jsonã€Firebase Config</a><ol><li></li></ol></li><li><a href=#firebase-config>Firebase Config</a><ol><li></li></ol></li><li><a href=#å–å¾—ä½¿ç”¨è€…çš„-token>å–å¾—ä½¿ç”¨è€…çš„ token</a></li><li><a href=#æ–°å¢-swjs>æ–°å¢ sw.js</a><ol><li></li></ol></li><li><a href=#è¨»å†Š-swjså­˜-cookieså­˜-firebase>è¨»å†Š sw.jsã€å­˜ Cookiesã€å­˜ Firebase</a><ol><li></li></ol></li><li><a href=#ç™¼é€-web-push>ç™¼é€ Web Push</a><ol><li></li></ol></li><li><a href=#æ¥æ”¶-web-push>æ¥æ”¶ Web Push</a><ol><li><a href=#ä½¿ç”¨è€…æ­£é–‹å•Ÿå®˜ç¶²é é¢>ä½¿ç”¨è€…æ­£é–‹å•Ÿå®˜ç¶²é é¢</a></li><li><a href=#ä½¿ç”¨è€…æ²’æœ‰é–‹å•Ÿå®˜ç¶²é é¢>ä½¿ç”¨è€…æ²’æœ‰é–‹å•Ÿå®˜ç¶²é é¢</a></li></ol></li><li><a href=#è£œå……è³‡æº>è£œå……è³‡æº</a></li></ol></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=https://wayneblog.ga/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><script>"serviceWorker"in navigator&&(console.log("Will service worker register?"),navigator.serviceWorker.register("./service-worker.js").then(function(){console.log("Yes it did.")}).catch(function(e){console.log("No, it didn't. This happened: ",e)}))</script><div id=fb-root></div><div id=fb-customer-chat class=fb-customerchat></div><script>var chatbox=document.getElementById("fb-customer-chat");chatbox.setAttribute("page_id","100278986238046"),chatbox.setAttribute("attribution","biz_inbox")</script><script>window.fbAsyncInit=function(){FB.init({xfbml:!0,version:"v15.0"})},function(e,t,n){var s,o=e.getElementsByTagName(t)[0];if(e.getElementById(n))return;s=e.createElement(t),s.id=n,s.src="https://connect.facebook.net/zh_TW/sdk/xfbml.customerchat.js",o.parentNode.insertBefore(s,o)}(document,"script","facebook-jssdk")</script></body></html>