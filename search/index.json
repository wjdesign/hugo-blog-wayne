[{"content":" åƒè€ƒç¶²ç«™ - gRPC èªªæ˜å½±ç‰‡ @ BESG\nSOURCE CODE\nå°æ‡‰çš„ç¨‹å¼ç¢¼å¯æª¢è¦– besg-grpc çš„ repositoryã€‚\ngRPC æ˜¯ä»€éº¼ï¼šä»¥ Golang èªªæ˜èˆ‡å¯¦ä½œ èªªæ˜ RPC çš„å…¨åæ˜¯ remote procedure callï¼Œä¸»è¦æ˜¯ä½œç‚ºé›»è…¦å’Œé›»è…¦é–“æºé€šä½¿ç”¨ã€‚A é›»è…¦å¯ä»¥å‘¼å« B é›»è…¦åŸ·è¡ŒæŸäº›ç¨‹å¼ï¼ŒB é›»è…¦æœƒå°‡çµæœå›å‚³çµ¦ A é›»è…¦ï¼ŒA é›»è…¦åœ¨æ”¶åˆ°å›æ‡‰å¾Œæœƒå†ç¹¼çºŒè™•ç†å…¶ä»–ä»»å‹™ã€‚RPC çš„å¥½è™•åœ¨æ–¼ï¼Œé›–ç„¶ A é›»è…¦æ˜¯ç™¼é€è«‹æ±‚å»è«‹ B é›»è…¦åšäº‹ï¼Œä½†å…¶å‘¼å«çš„æ–¹å¼ï¼Œå°±å¾ˆåƒæ˜¯ A é›»è…¦ç›´æ¥åœ¨å‘¼å«è‡ªå·±å…§éƒ¨çš„å‡½å¼ä¸€èˆ¬ã€‚\ngRPC ä¹Ÿæ˜¯åŸºæ–¼é€™æ¨£çš„æ¦‚å¿µï¼Œè®“æƒ³è¦å‘¼å« server è™•ç†è«‹æ±‚çš„ clientï¼Œåœ¨ä½¿ç”¨é€™æ”¯ API æ™‚å°±å¥½åƒæ˜¯å‘¼å«è‡ªå·±å…§éƒ¨çš„å‡½å¼ä¸€æ¨£ç°¡å–®è‡ªç„¶ã€‚å¾åŠŸèƒ½é¢ä¾†èªªï¼ŒgRPC å°±åƒ Web å¸¸ç”¨çš„ Restful API ä¸€æ¨£ï¼Œéƒ½æ˜¯åœ¨è™•ç†è«‹æ±‚å’Œå›æ‡‰ï¼Œä¸¦ä¸”é€²è¡Œè³‡æ–™äº¤æ›ï¼Œä½† gRPC é‚„å¤šäº†å…¶ä»–çš„åŠŸèƒ½å’Œç‰¹è‰²ã€‚\ngRPC æ˜¯ç”± Google é–‹ç™¼çš„é–‹æºæ¡†æ¶ï¼Œå®ƒå¿«é€Ÿæœ‰æ•ˆã€å¥ åŸºåœ¨ HTTP/2 ä¸Šæä¾›ä½å»¶é²ï¼ˆlow latencyï¼‰ï¼Œæ”¯æ´ä¸²æµï¼Œæ›´å®¹æ˜“åšåˆ°æ¬Šé™é©—è­‰ï¼ˆauthenticationï¼‰ã€‚åœ¨ä¸‹é¢çš„æ–‡ç« ä¸­ï¼Œå°‡æœƒå°æ–¼ gRPC èƒ½æä¾›çš„ç‰¹è‰²æœ‰æ›´å¤šèªªæ˜ã€‚\nProtocol Buffers æ˜¯ä»€éº¼ Protocol Buffers @ Google Developer Protocol Buffers ç­†è¨˜ @ pjchender.dev åœ¨å­¸ç¿’ gRPC æ™‚ï¼Œéœ€è¦åŒæ™‚äº†è§£ä»€éº¼æ˜¯ Protocol Buffersã€‚åœ¨å‚³çµ±çš„ Restful API ä¸­ï¼Œæœ€å¸¸ä½¿ç”¨çš„è³‡æ–™äº¤æ›æ ¼å¼é€šå¸¸æ˜¯ JSONï¼›ä½†åˆ°äº† gRPC ä¸­ï¼Œè³‡æ–™äº¤æ›çš„æ ¼å¼å‰‡æ˜¯ä½¿ç”¨åç‚º Protocol Buffers çš„è¦ç¯„ï¼èªè¨€ã€‚\njson 1 2 3 4 5 { \u0026#34;firstName\u0026#34;: \u0026#34;Sushiro\u0026#34;, \u0026#34;lastName\u0026#34;: \u0026#34;Global\u0026#34;, \u0026#34;age\u0026#34;: 6 } protocol buffers 1 2 3 4 5 6 // Protocol Buffers message User { string first_name = 1; string last_name = 2; int32 age = 3; } ä¹Ÿå°±æ˜¯èªªï¼Œç•¶æˆ‘å€‘æƒ³è¦ä½¿ç”¨ gRPC çš„æœå‹™ä¾†äº¤æ›è³‡æ–™å‰ï¼Œå¿…é ˆå…ˆæŠŠè³‡æ–™ã€Œæ ¼å¼ã€å’Œã€Œæ–¹æ³•ã€éƒ½å®šç¾©æ¸…æ¥šã€‚\nTIP:\nä½¿ç”¨ gRPC å‰ï¼Œä¸åªéœ€è¦å…ˆæŠŠè³‡æ–™äº¤æ›çš„æ ¼å¼å®šç¾©æ¸…æ¥šï¼ŒåŒæ™‚ä¹Ÿéœ€è¦æŠŠè³‡æ–™äº¤æ›çš„æ–¹æ³•å®šç¾©æ¸…æ¥šã€‚\né€™è£¡è¦ç¨å¾®é‡æ¸…ä¸€é»å¾ˆé‡è¦çš„æ˜¯ï¼ŒProtocol Buffers å¯ä»¥ç¨ç«‹ä½¿ç”¨ï¼Œä¸ä¸€å®šè¦æ­é… gRPCï¼›ä½†ä½¿ç”¨ gRPC ä¸€å®šè¦æ­é… Protocol Buffersã€‚\nå¯¦ä½œå°‡ Protocol Buffers ç·¨è­¯æˆåœ¨ Golang ä¸­å¯ä½¿ç”¨çš„æª”æ¡ˆ å°æ‡‰çš„ç¨‹å¼ç¢¼å¯æª¢è¦– besg-grpc repository ä¸­çš„ proto è³‡æ–™å¤¾ã€‚\nSTEP 1ï¼šæ’°å¯« Protocol Buffers æª”æ¡ˆ ä½¿ç”¨ message å®šç¾©è³‡æ–™äº¤æ›çš„æ ¼å¼ã€‚ ä½¿ç”¨ service å®šç¾©å‘¼å« API çš„æ–¹æ³•åç¨±ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 syntax = \u0026#34;proto3\u0026#34;; // å®šç¾©è¦ä½¿ç”¨çš„ protocol buffer ç‰ˆæœ¬ package calculator; // for name space option go_package = \u0026#34;proto/calculator\u0026#34;; // generated code çš„ full Go import path message CalculatorRequest { int64 a = 1; int64 b = 2; } message CalculatorResponse { int64 result = 1; } service CalculatorService { rpc Sum(CalculatorRequest) returns (CalculatorResponse) {}; } STEP 2ï¼šå®‰è£ç·¨è­¯ Protocol Buffer æ‰€éœ€çš„å¥—ä»¶ æ­¤éƒ¨ä»½å¯åƒè€ƒ ç·¨è­¯ Protocol Buffersï¼ˆCompilingï¼‰ æ®µè½ã€‚\nå®‰è£ compiler (macOS) 1 2 3 4 5 6 7 8 9 10 11 # å®‰è£ compilerï¼Œå®‰è£å®Œå¾Œå°±æœƒæœ‰ protoc CLI å·¥å…· brew install protobuf protoc --version # Ensure compiler version is 3+ # --- ä½¿ç”¨ golang æ‰éœ€è¦å®‰è£ä»¥ä¸‹å…©å€‹å¥—ä»¶ --- # å®‰è£ protoc-gen-go å¾Œå¯ä»¥å°‡ proto buffer ç·¨è­¯æˆ Golang å¯ä½¿ç”¨çš„æª”æ¡ˆ go get github.com/golang/protobuf/protoc-gen-go # å®‰è£ grpc-go å¾Œï¼Œå¯ä»¥åœ¨ Golang ä¸­ä½¿ç”¨ gRPC go get -u google.golang.org/grpc STEP 3ï¼šç·¨è­¯ Protocol Buffer æª”æ¡ˆ é€²åˆ°æ”¾æœ‰ .proto æª”çš„è³‡æ–™å¤¾å¾Œï¼Œåœ¨çµ‚ç«¯æ©Ÿè¼¸å…¥ä¸‹è¿°æŒ‡ä»¤ï¼š\n1 protoc *.proto --go_out=plugins=grpc:. --go_opt=paths=source_relative åœ¨æˆåŠŸç·¨è­¯å¥½å¾Œï¼Œæ‡‰è©²æœƒçœ‹åˆ°åŒæ¨£çš„è³‡æ–™å¤¾ä½ç½®å‡ºç¾ *.pb.go çš„æª”æ¡ˆï¼Œé€™å°±æ˜¯ç·¨è­¯å¥½å¾Œå¯ä»¥åœ¨ Golang ä¸­ä½¿ç”¨ Protocol Buffer å’Œ gRPC çš„æª”æ¡ˆã€‚\nå¯¦ä½œ gRPC Server å°æ‡‰çš„ç¨‹å¼ç¢¼å¯æª¢è¦– besg-grpc repository ä¸­çš„ server è³‡æ–™å¤¾ã€‚\nSTEP 1ï¼šå»ºç«‹ gRPC server 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 type Server struct {} func main() { fmt.Println(\u0026#34;starting gRPC server...\u0026#34;) lis, err := net.Listen(\u0026#34;tcp\u0026#34;, \u0026#34;localhost:50051\u0026#34;) if err != nil { log.Fatalf(\u0026#34;failed to listen: %v \\n\u0026#34;, err) } grpcServer := grpc.NewServer() calculatorPB.RegisterCalculatorServiceServer(grpcServer, \u0026amp;Server{}) if err := grpcServer.Serve(lis); err != nil { log.Fatalf(\u0026#34;failed to serve: %v \\n\u0026#34;, err) } } STEP 2ï¼šå¯¦ä½œ Protocol Buffer ä¸­çš„ service 1 2 3 4 5 6 7 8 9 10 11 12 func (*Server) Sum(ctx context.Context, req *calculatorPB.CalculatorRequest) (*calculatorPB.CalculatorResponse, error) { fmt.Printf(\u0026#34;Sum function is invoked with %v \\n\u0026#34;, req) a := req.GetA() b := req.GetB() res := \u0026amp;calculatorPB.CalculatorResponse{ Result: a + b, } return res, nil } STEP 3ï¼šå•Ÿå‹• server åœ¨çµ‚ç«¯æ©Ÿä¸­è¼¸å…¥ï¼š\n1 go run server/server.go å³å¯å•Ÿå‹• gRPC serverã€‚\nè£œå……ï¼šä½¿ç”¨ Bloom RPC é€²è¡Œæ¸¬è©¦ åœ¨åªæœ‰ server çš„æƒ…æ³ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ BloomRPC é€™å¥—å·¥å…·ä¾†æ¨¡æ“¬ Client å° gRPC server ç™¼é€è«‹æ±‚ï¼ŒåŠŸèƒ½å°±é¡ä¼¼åœ¨ Restful ä¸­ä½¿ç”¨çš„ Postmanã€‚\nä½¿ç”¨æ™‚åªéœ€è¦åŒ¯å…¥ proto æª”å¾Œï¼Œå³å¯çœ‹åˆ°å°æ‡‰å¯å‘¼å«çš„æ–¹æ³•å’Œå¯å¸¶å…¥çš„åƒæ•¸ï¼Œèƒ½é€™éº¼æ–¹ä¾¿ä¹Ÿæ˜¯å› ç‚ºåœ¨ protocol buffer ä¸­å·²ç¶“æŠŠå‚³è¼¸çš„è³‡æ–™æ ¼å¼å’Œèƒ½å°æ‡‰å‘¼å«çš„æ–¹æ³•éƒ½å®šå¥½çš„ç·£æ•…ã€‚\nå¯¦ä½œ gRPC Client å®Œæ•´ç¨‹å¼ç¢¼å¯æª¢è¦– besg-grpc repository ä¸­çš„ client è³‡æ–™å¤¾ã€‚\nSTEP 1ï¼šèˆ‡ gRPC server å»ºç«‹é€£ç·š 1 2 3 4 5 6 7 8 9 10 11 12 func main() { conn, err := grpc.Dial(\u0026#34;localhost:50051\u0026#34;, grpc.WithInsecure()) if err != nil { log.Fatalf(\u0026#34;failed to dial: %v\u0026#34;, err) } defer conn.Close() client := calculatorPB.NewCalculatorServiceClient(conn) doUnary(client) } STEP 2ï¼šä½¿ç”¨ Protocol Buffers ä¸­å®šç¾©å¥½çš„ Service 1 2 3 4 5 6 7 8 9 10 11 12 13 14 func doUnary(client calculatorPB.CalculatorServiceClient) { fmt.Println(\u0026#34;Staring to do a Unary RPC\u0026#34;) req := \u0026amp;calculatorPB.CalculatorRequest{ A: 3, B: 10, } res, err := client.Sum(context.Background(), req) if err != nil { log.Fatalf(\u0026#34;error while calling CalculatorService: %v \\n\u0026#34;, err) } log.Printf(\u0026#34;Response from CalculatorService: %v\u0026#34;, res.Result) } STEP 3ï¼šå‘ server ç™¼é€è«‹æ±‚ åœ¨çµ‚ç«¯æ©Ÿä¸­è¼¸å…¥ï¼š\n1 go run client/client.go å³å¯åŸ·è¡Œ client.go ä¸¦å‘å‰›å‰›èµ·å‹•å¥½çš„ server ç™¼é€è«‹æ±‚ã€‚\ngRPC è§£æ±ºäº†ä»€éº¼ gRPC å’Œ REST API çš„æ¯”è¼ƒ æ¯”è¼ƒ gRPC æœå‹™èˆ‡ HTTP API @ microsoft docs\nç°¡å–®ä¾†èªªï¼ŒgRPC åœ¨æ•ˆèƒ½ä¸Šæ¯”èµ· REST API å¥½éå¸¸å¤šï¼š\né …ç›® gRPC Restful API è³‡æ–™å‚³è¼¸æ ¼å¼ï¼ˆPayloadï¼‰ Protocol Buffer - æ›´å¿«ä¸”æ›´å° JSON, XML, formData - è¼ƒæ…¢ä¸”è¼ƒå¤§ é€šè¨Šå”å®š HTTP/2 HTTP å‚³è¼¸æ–¹å¼ æ”¯æ´ä¸€èˆ¬çš„ã€Œè«‹æ±‚-å›æ‡‰ã€ã€ä¼ºæœå™¨ç«¯ä¸²æµã€Client ç«¯ä¸²æµã€èˆ‡é›™å‘ä¸²æµï¼ˆstreamingï¼‰ åƒ…èƒ½é€é Client ç™¼é€è«‹æ±‚ã€Server çµ¦äºˆå›æ‡‰ API æ–¹æ³•å‘½å æ²’æœ‰é™åˆ¶ï¼Œä¸€èˆ¬æœƒç›´æ¥æè¿°è©²æ–¹æ³•è¦åšçš„äº‹ï¼Œä¾‹å¦‚ createUser, getUserã€‚ä¸éœ€è¦æ€è€ƒè·¯ç”±å‘½åã€‚ ä½¿ç”¨å‹•è©ï¼ˆGET, POST, PUT, PATCH, DELETEï¼‰æ­é…è³‡æºä¾†å‘½åã€‚éœ€è¦æ ¹æ“šä¸åŒçš„è¡Œç‚ºä¾†å®šç¾©ä¸åŒçš„è·¯ç”±ã€‚ Client å‘¼å« API çš„æ–¹å¼ å°±åƒå‘¼å«ä¸€èˆ¬çš„å‡½å¼ é€éç‰¹å®šçš„ Endpointï¼Œçµ¦äºˆç¬¦åˆçš„è³‡æ–™å‹åˆ¥ Server å»ºç«‹ API çš„æ–¹å¼ æ ¹æ“šæ–‡ä»¶ï¼ˆProtocol Bufferï¼‰å¯¦ä½œåŠŸèƒ½ï¼Œä¸éœ€è¦é¡å¤–æª¢æŸ¥è³‡æ–™å‹åˆ¥èˆ‡æ–¹æ³•æ­£ç¢ºæ€§ã€‚ æ ¹æ“šæ–‡ä»¶ï¼ˆSwaggerï¼‰å¯¦ä½œåŠŸèƒ½ï¼Œä½†é ˆé¡å¤–æª¢æŸ¥è³‡æ–™å‹åˆ¥ã€‚ æ ¹æ“šæ–‡ä»¶ç”¢ç”Ÿç¨‹å¼ç¢¼ Protocol Buffers OpenAPI / Swagger æ­¤å¤–ï¼ŒgRPC çš„ serverï¼Œé è¨­å°±æ˜¯éåŒæ­¥çš„ï¼Œå› æ­¤ä¸æœƒé˜»å¡ä»»ä½•é€²ä¾†çš„è«‹æ±‚ï¼Œä¸¦å¯ä»¥å¹³è¡Œè™•ç†å¤šå€‹è«‹æ±‚ã€‚gRPC Client å‰‡å¯ä»¥é¸æ“‡è¦ç”¨åŒæ­¥ï¼ˆé˜»å¡ï¼‰æˆ–éåŒæ­¥çš„æ–¹å¼è™•ç†ã€‚\nä½¿ç”¨ Protocol Buffers çš„å¥½è™• ç¯€çœç¶²è·¯å‚³è¼¸é‡ï¼šé€Ÿåº¦æ›´å¿«ã€æª”æ¡ˆæ›´å° ç¯€çœ CPU æ¶ˆè€—ï¼šParse JSON æœ¬èº«æ˜¯ CPU intensive çš„ä»»å‹™ï¼›Parse Protocol Bufferï¼ˆbinary formatï¼‰å› ç‚ºæ›´æ¥è¿‘åº•å±¤æ©Ÿå™¨è¡¨å¾µè³‡æ–™çš„æ–¹å¼ï¼Œæ¶ˆè€—çš„ CPU è³‡æºè¼ƒä½ è·¨ç¨‹å¼èªè¨€ï¼šProtocol Buffer å¯ä»¥æ ¹æ“šä¸åŒçš„ç¨‹å¼èªè¨€ç·¨è­¯å‡ºä¸åŒçš„æª”æ¡ˆ å¯ä»¥å¯«è¨»è§£ã€å‹åˆ¥æ¸…æ¥šæ˜ç¢º TIP\nç¯€çœç¶²è·¯å‚³è¼¸é‡å’Œ CPU æ¶ˆè€—åœ¨è¡Œå‹•è£ç½®ä¸Šçš„å½±éŸ¿å¯èƒ½æ›´é‡è¦ã€‚\nè·¨ç¨‹å¼èªè¨€çš„å¥½è™• é€é Protocol Buffer å®šç¾©å¥½è³‡æ–™çš„å‚³è¼¸æ¬„ä½ï¼ˆmessageï¼‰å’Œå‘¼å«çš„æ–¹æ³•ï¼ˆserviceï¼‰å¾Œï¼ŒgRPC å³å¯åœ¨ä¸åŒç¨‹å¼èªè¨€ä¸Šé‹è¡Œï¼Œé€™éå¸¸é©åˆå¾®æœå‹™ï¼ˆmicro-servicesï¼‰çš„æ‡‰ç”¨æƒ…å¢ƒï¼Œåªè¦é›™æ–¹ä¸€èµ·å®šç¾©å¥½ schema å¾Œï¼Œå°±å¯ä»¥ç”¨ä¸åŒçš„ç¨‹å¼èªè¨€é€²è¡Œé–‹ç™¼ã€‚\nä½¿ç”¨ HTTP/2 çš„å¥½è™• HTTP/2 vs HTTP/1 - Performance Comparison? Demoï¼šPerformance difference between HTTP2 and HTTP1.1 ç€è¦½å™¨å…è¨±çš„ä½µç™¼è«‹æ±‚è³‡æºæ•¸æ˜¯æœ‰é™åˆ¶çš„-åˆ†æ @ ITRead01 å‚³çµ±çš„ HTTP/1.1 åœ¨æ¯å€‹ TCP é€£ç·šä¸­åªå…è¨±å‘ server ç™¼é€å–®ä¸€å€‹è«‹æ±‚ï¼Œä½†ç•¶ç¶²é è¼‰å…¥æ™‚ï¼Œå¾€å¾€æœƒéœ€è¦å‘åŒä¸€å€‹ä¼ºæœå™¨ç™¼é€å¤šå€‹è«‹æ±‚ï¼ˆä¾‹å¦‚ã€åœ–æª”ã€CSSã€éœæ…‹æª”ã€JS ç­‰ï¼‰ï¼Œå› æ­¤ç‚ºäº†è¦é¿é–‹é€™æ¨£çš„é™åˆ¶ã€åŠ å¿«è¼‰å…¥çš„é€Ÿåº¦ï¼Œç€è¦½å™¨æœƒå¯¦ä½œå¤šå€‹å¹³è¡Œçš„ï¼ˆparallelï¼‰ TPC é€£ç·šï¼ˆæ¯å€‹ç€è¦½å™¨å¯¦ä½œä¸åŒï¼Œå› æ­¤æ•¸é‡çš„ä¸Šé™ä¹Ÿä¸åŒï¼‰ï¼Œä»¥è™•ç†åŒæ™‚å‘ä¼ºæœå™¨ç™¼å‡ºçš„å¤šå€‹è«‹æ±‚ã€‚\nåœ¨ HTTP/2 ä¸­å‰‡å¯åœ¨åŒä¸€å€‹ TCP é€£ç·šä¸­é€²è¡Œå¤šå€‹è«‹æ±‚å’Œå›æ‡‰ï¼Œä¸¦ä¸”å¯ä»¥ç”± server ä¸»å‹•æ¨é€è³‡æºçµ¦ clientï¼Œè€Œä¸¦éä¸€å®šè¦é€é client ä¸»å‹•è«‹æ±‚ï¼›æ­¤å¤–æ”¯æ´ HTTP Header çš„å£“ç¸®ï¼Œæ¸›å°‘è³‡æ–™å‚³æ•¸é‡ï¼›HTTP/2 ä¹Ÿæ˜¯ä½¿ç”¨ binary çš„æ–¹å¼åœ¨å‚³è¼¸è³‡æ–™ã€‚\ngRPC çš„å››ç¨®é¡å‹ Unaryï¼šé¡ä¼¼å‚³çµ± APIï¼Œclient ç™¼é€ request è€Œ server å›å‚³ response Server Streamingï¼šé€é HTTP/2ï¼Œclient ç™¼é€ä¸€æ¬¡ requestï¼Œè€Œ server å¯ä»¥å›å‚³å¤šæ¬¡è³‡æ–™ Client Streamingï¼šclient ç™¼é€å¤šæ¬¡è³‡æ–™ï¼Œç›´åˆ°å‘ŠçŸ¥ server è³‡æ–™å‚³å®Œå¾Œï¼Œserver å†çµ¦äºˆ response Bi Directional Streamingï¼šå…©é‚Šéƒ½ç”¨ä¸²æµçš„æ–¹å¼å‚³é€è³‡æ–™ åœ–ç‰‡ä¾†æºï¼šgRPC Golang - Master Class: Build Modern API \u0026amp; MicroServices @ Udemy\n1 2 3 4 5 6 7 8 9 10 11 12 13 service GreetService { // Unary rpc Greet(GreetRequest) returns (GreetResponse) {}; // Streaming Server rpc GreetManyTimes(GreetManyTimesRequest) returns (stream GreetManyTimesResponse) {}; // Streaming Client rpc LongGreet(stream LongGreetRequest) returns (LongGreetResponse) {}; // Bi-directional Streaming rpc GreetEveryone(stream GreetEveryoneRequest) returns (stream GreetEveryoneResponse) {}; } gRPC çš„ç¼ºé» Protocol Buffer ä¸åƒ JSON æ˜¯ Human Readableã€‚ éœ€è¦é¡å¤–çš„å­¸ç¿’æ™‚é–“å’Œå°å…¥æˆæœ¬ã€‚ ç€è¦½å™¨åŸç”Ÿç›®å‰é‚„ä¸æ”¯æ´ï¼Œé ˆé€éå¥—ä»¶ grpc-web ä¾†è™•ç†ã€‚ å…¶ä»– æ¨è–¦å·¥å…· BloomRPCï¼šæ–¹ä¾¿ç”¨ä¾†æ¨¡æ“¬ Client å° gRPC server ç™¼é€è«‹æ±‚ï¼ŒåŠŸèƒ½å°±é¡ä¼¼åœ¨ Restful ä¸­ä½¿ç”¨çš„ Postmanã€‚ éŒ¯èª¤æ’é™¤ protoc-gen-go: program not found or is not executable\n1 2 # éœ€è¦æŠŠ $GOPATH/bin åŠ åˆ° .zshrc/.bashrc ç­‰ $ echo \u0026#39;export PATH=$PATH:$GOPATH/bin\u0026#39; \u0026gt;\u0026gt; $HOME/.zshrc åƒè€ƒè³‡æ–™ Go Tutorial @ gRPC.io Introduction to gRPC @ gRPC.io Protocol Buffers @ Google Developer gRPC - Golang Master Class: Build Modern API \u0026amp; MicroServices @ Udemy æ¯”è¼ƒ gRPC æœå‹™èˆ‡ HTTP API @ Microsoft Docs ","date":"2022-07-22T00:00:00Z","image":"https://i.imgur.com/Wby0iiz.png","permalink":"https://wjdesign.github.io/hugo-blog-wayne/p/grpc-%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%B4%B9/","title":"gRPC åŸºæœ¬ä»‹ç´¹"},{"content":" åƒè€ƒç¶²ç«™ - JavaScript è³‡æ–™çµæ§‹èˆ‡æ¼”ç®—æ³•ï¼šæ°£æ³¡æ’åº Bubble Sortã€æ’å…¥æ’åº Insertion Sort å¯¦ä½œèˆ‡åˆ†æ - å½­å½­ç›´æ’­\næ’åºæ¼”ç®—æ³• æ°£æ³¡æ’åºæ³•(bubble sort) æ¦‚è¦ ä½¿ç”¨é›™å±¤è¿´åœˆï¼Œç”±å¾Œå¾€å‰ã€‚ æ¯è¼ªå›ºå®šæœ€å³é‚Šçš„å€¼ï¼Œæ¥è‘—å€†å€†æ¯”è¼ƒå¤§å°ï¼Œå°‡å¤§çš„æ”¾å³é‚Šã€‚ ä¸‹è¼ªå‰‡ - 1ã€‚ å®Œç•¢å¾Œå³å¯æ’åºå®Œç•¢ã€‚ åŸ·è¡Œçš„ç¸½è¼ªæ•¸ç‚ºé™£åˆ—é•·åº¦ - 1ã€‚ æ™‚é–“è¤‡é›œåº¦ å¦‚æœé™£åˆ—é•·åº¦æ˜¯ 4ï¼Œè¦æ¯”å° 3+2+1 ç¸½å…± 6 æ¬¡ã€‚ å¦‚æœé™£åˆ—é•·åº¦æ˜¯ 7ï¼Œè¦æ¯”å° 6+5+\u0026hellip;+1 ç¸½å…± 21 æ¬¡ã€‚ å¦‚æœé™£åˆ—é•·åº¦æ˜¯ nï¼Œè¦æ¯”å° (n-1)+(n-2)+\u0026hellip;+1 ç¸½å…±\n(n * (n - 1)) / 2 = nÂ²/2 - n/2 æ¬¡ æœå°‹æ‰€éœ€æ™‚é–“éš¨è‘—é™£åˆ—çš„é•·åº¦\nå‘ˆå¹³æ–¹æˆé•· O(NÂ²)ã€‚ å‡è¨­ å¯ä»¥åŠ å…¥ä¸€å€‹ flag ä¾†åšåˆ¤å®šï¼Œå‡è¨­æ¯”è¼ƒå®Œç¬¬ä¸€è¼ªç™¼ç¾æ²’æœ‰äº¤æ›çš„æƒ…æ³ç™¼ç”Ÿï¼Œå‰‡ä»£è¡¨å·²ç¶“æ’åºå®Œæˆï¼Œä¸éœ€è¦å†è·‘ä¸‹ä¸€è¼ªï¼Œå³å¯ç¨å¾®å„ªåŒ–æ’åºã€‚ å¯¦ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 // å¯¦ä½œæ°£æ³¡æ’åºæ¼”ç®—æ³• function bubbleSort(arr){ // arr æ˜¯ä¸€å€‹æ•¸å­—é™£åˆ— for(let i=arr.length-1;i\u0026gt;=1;i--){ let swap=false; // å‡è¨­æ²’æœ‰äº¤æ›ç™¼ç”Ÿ for(let j=0;j\u0026lt;i;j++){ if(arr[j]\u0026gt;arr[j+1]){ // å¦‚æœé †åºä¸å°ï¼Œäº¤æ› let temp=arr[j]; arr[j]=arr[j+1]; arr[j+1]=temp; swap=true; // ç´€éŒ„ç™¼ç”Ÿäº¤æ› } } if(!swap){ // ç™¼ç¾ä¸€æ•´è¼ªä¸­éƒ½æ²’æœ‰äº¤æ›ç™¼ç”Ÿï¼Œç›´æ¥åˆ¤å®šæ’åºå®Œæˆ break; } } } let data = [1, 6, 3, 4]; console.log(bubbleSort(data)); è¼¸å‡ºï¼š 1 \u0026gt; [1, 3, 4, 6] æ’å…¥æ’åºæ³•(insertion sort) æ¦‚è¦ ä½¿ç”¨é›™å±¤è¿´åœˆï¼Œç”±å‰å¾€å¾Œã€‚ å¾ç¬¬äºŒç­†é–‹å§‹ï¼Œæ¯è¼ªå°‡è©²ç­†è³‡æ–™å¾€å‰æ¯”è¼ƒå¤§å°ï¼Œå°‡å¤§çš„æ”¾å³é‚Šï¼šæ¯è¼ªæ¯”è¼ƒå¾ (i - 1) ~ 0ã€‚ ä¸‹è¼ªå‰‡ + 1ã€‚ å®Œç•¢å¾Œå³å¯æ’åºå®Œç•¢ã€‚ åŸ·è¡Œçš„ç¸½è¼ªæ•¸ç‚ºé™£åˆ—é•·åº¦ - 1ã€‚ æ™‚é–“è¤‡é›œåº¦(è¤‡é›œåº¦åŒæ°£æ³¡æ’åºæ³•) å¦‚æœé™£åˆ—é•·åº¦æ˜¯ 4ï¼Œè¦æ¯”å° 1+2+3 ç¸½å…± 6 æ¬¡ã€‚ å¦‚æœé™£åˆ—é•·åº¦æ˜¯ 7ï¼Œè¦æ¯”å° 1+2+\u0026hellip;+6 ç¸½å…± 21 æ¬¡ã€‚ å¦‚æœé™£åˆ—é•·åº¦æ˜¯ nï¼Œè¦æ¯”å° 1+2+\u0026hellip;+(n-1) ç¸½å…±\n(n * (n - 1)) / 2 = nÂ²/2 - n/2 æ¬¡ æœå°‹æ‰€éœ€æ™‚é–“éš¨è‘—é™£åˆ—çš„é•·åº¦\nå‘ˆå¹³æ–¹æˆé•· O(NÂ²)ã€‚ å‡è¨­ å‡è¨­ç•¶å‰æ¯”å°çš„å€¼èˆ‡ç¬¬ä¸€å€‹è¦æ¯”è¼ƒçš„å€¼ä¸€æ¯”è¼ƒï¼Œæ°å¥½æ­£ç¢ºï¼Œå‰‡ä»£è¡¨å‰é¢çš†å·²ç¶“æ’åºå®Œæˆï¼Œå¯ä»¥é€²åˆ°ä¸‹ä¸€è¼ªã€‚ å¯¦ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // å¯¦ä½œæ’å…¥æ’åºæ¼”ç®—æ³• function insertionSort(arr){ // arr æ˜¯ä¸€å€‹æ•¸å­—é™£åˆ— for(let i=1;i\u0026lt;arr.length;i++){ for(let j=i-1;j\u0026gt;=0;j--){ if(arr[j]\u0026gt;arr[j+1]){ // å¦‚æœé †åºä¸å°ï¼Œäº¤æ› [arr[j], arr[j+1]]=[arr[j+1], arr[j]]; // javascript äº¤æ›çš„èªæ³•ç³– }else{ // ä»»ä½•ä¸€æ¬¡æ¯”è¼ƒï¼Œç™¼ç¾é †åºå°äº†ï¼Œé€™ä¸€è¼ªå°±ä¸ç”¨ç¹¼çºŒäº† break; } } } } let data = [1, 6, 3, 4]; console.log(insertionSort(data)); è¼¸å‡ºï¼š 1 \u0026gt; [1, 3, 4, 6] å¤§å‹è³‡æ–™é‡çš„é€²éšæ¢è¨ O(NÂ²)ï¼š(è®€ä½œ big-O Nå¹³æ–¹) æ˜¯ç›¸ç•¶å¯æ€•çš„ï¼Œæ’åºçš„åŸ·è¡Œæ™‚é–“å°‡æœƒæ˜¯è³‡æ–™é‡çš„å¹³æ–¹å€æ•¸æˆé•·ã€‚\næ¼”ç¤ºï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // ç”¢ç”Ÿéš¨æ©Ÿè³‡æ–™ let data=[]; for(let i=0;i\u0026lt;100000;i++){ data.push(Math.random()*1000000); } // è³‡æ–™é‡æ˜¯ 100,000ï¼Œæˆ‘çš„æ¼”ç®—æ³•æ™‚é–“è¤‡é›œåº¦æ˜¯ O(N^2)ï¼Œé æœŸè¦èŠ± 100,000^2 = 10,000,000,000 æ¬¡çš„æ¯”è¼ƒé‹ç®— // æˆ‘å€‘çš„é›»è…¦ä¸€ç§’é˜è·‘ 10 å„„å€‹æŒ‡ä»¤(ç²—ç•¥é ä¼° 1 GB) console.time(); // æ’å…¥æ’åºæ³•ï¼Œå¤§ç´„è·‘äº†10å¹¾ç§’ //insertionSort(data); // ä½¿ç”¨ JavaScript å…§å»ºçš„æ’åºåŠŸèƒ½ sort()ï¼Œå¤§ç´„è·‘äº† 0.2 ~ 0.3 ç§’ // å¾ˆæœ‰æ©Ÿæœƒæ˜¯ä½¿ç”¨å¿«é€Ÿæ’åº Quick Sort(å¿«é€Ÿæ’åºæ³•) æˆ–å…¶è®Šå½¢ data.sort(); console.timeEnd(); ","date":"2022-07-21T00:00:00Z","image":"https://wjdesign.github.io/hugo-blog-wayne/p/%E5%BD%AD%E5%BD%AD%E7%9A%84%E8%AA%B2%E7%A8%8B-%E6%B0%A3%E6%B3%A1%E6%8E%92%E5%BA%8F%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%9A%84%E5%AF%A6%E4%BD%9C%E8%88%87%E5%88%86%E6%9E%90/hqdefault_huc19c1d5e8083f3ca093a0303b2a8247b_19175_120x120_fill_q75_box_smart1.jpg","permalink":"https://wjdesign.github.io/hugo-blog-wayne/p/%E5%BD%AD%E5%BD%AD%E7%9A%84%E8%AA%B2%E7%A8%8B-%E6%B0%A3%E6%B3%A1%E6%8E%92%E5%BA%8F%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%9A%84%E5%AF%A6%E4%BD%9C%E8%88%87%E5%88%86%E6%9E%90/","title":"å½­å½­çš„èª²ç¨‹ - æ°£æ³¡æ’åºã€æ’å…¥æ’åºçš„å¯¦ä½œèˆ‡åˆ†æ"},{"content":" åƒè€ƒç¶²ç«™ - å°šç¡…è°·Vue3æŠ€è¡“\nå‰µå»º Vue 3.0 å·¥ç¨‹ ä½¿ç”¨ vue cli å‰µå»º å®˜æ–¹æ–‡æª”ï¼šhttps://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create 1 2 3 4 5 6 7 8 9 10 11 12 ## æŸ¥çœ‹ @vue/cli ç‰ˆæœ¬ï¼Œç¢ºä¿ @vue/cli ç‰ˆæœ¬åœ¨ 4.5.0 ä»¥ä¸Š vue --version ## å®‰è£æˆ–å‡ç´šä½ çš„ @vue/cli npm install -g @vue/cli ## å‰µå»º vue create vue_test ## å•Ÿå‹• cd vue_test npm run serve ä½¿ç”¨ vite å‰µå»º(Vueä½œè€…çš„åœ˜éšŠé–‹ç™¼) å®˜æ–¹æ–‡æª”ï¼šhttps://v3.cn.vuejs.org/guide/installation.html#vite viteå®˜ç¶²ï¼šhttps://vitejs.cn/ å„ªå‹¢ï¼š é–‹ç™¼ç’°å¢ƒä¸­ï¼Œç„¡éœ€æ‰“åŒ…æ“ä½œï¼Œå¯å¿«é€Ÿçš„å†·å•Ÿå‹•ã€‚ è¼•é‡å¿«é€Ÿçš„ç†±é‡è¼‰(HMR)ã€‚ çœŸæ­£çš„æŒ‰éœ€ç·¨è­¯ï¼Œä¸å†ç­‰å¾…æ•´å€‹æ‡‰ç”¨ç·¨è­¯å®Œæˆã€‚ å‚³çµ± gruntã€gulpã€webpack èˆ‡ vite æ§‹å»ºå°æ¯”åœ–ï¼š 1 2 3 4 5 6 7 8 9 10 11 ## å‰µå»ºå·¥ç¨‹ npm init vite-app \u0026lt;project-name\u0026gt; ## é€²å…¥å·¥ç¨‹ç›®éŒ„ cd \u0026lt;project-name\u0026gt; ## å®‰è£ä¾è³´ npm install ## å•Ÿå‹• npm run dev å®‰è£ Vue é–‹ç™¼è€…å·¥å…· Vue.js devtools\næ‹‰é–‹åºå¹•çš„ Setup Vue3.0 ä¸­ä¸€å€‹æ–°çš„é…ç½®é …ï¼Œå€¼ç‚ºä¸€å€‹å‡½æ•¸ã€‚ æ˜¯æ‰€æœ‰ Composition API (çµ„åˆå¼API) çš„è¡¨æ¼”èˆå°ã€‚ çµ„ä»¶ä¸­æ‰€ç”¨åˆ°çš„æ•¸æ“šã€æ–¹æ³•ç­‰ç­‰ï¼Œå‡è¦é…ç½®åœ¨ setup ä¸­ã€‚ setup å‡½æ•¸çš„ï¼š è‹¥è¿”å›ä¸€å€‹å°è±¡ï¼Œå‰‡å°è±¡ä¸­çš„å±¬æ€§ã€æ–¹æ³•ï¼Œåœ¨æ¨¡æ¿ä¸­å‡å¯ç›´æ¥ä½¿ç”¨ã€‚(é‡é»é—œæ³¨!) è‹¥è¿”å›ä¸€å€‹æ¸²æŸ“å‡½æ•¸ï¼Œå‰‡å¯ä»¥è‡ªå®šç¾©æ¸²æŸ“å…§å®¹ã€‚(äº†è§£å³å¯) è¿”å›å°è±¡ 1 2 3 4 5 6 7 8 export default { setup() { const name = \u0026#34;æ¸¬è©¦\u0026#34; return { name } } } è¿”å›æ¸²æŸ“å‡½æ•¸(éœ€å¼•å…¥ h ) 1 2 3 4 5 6 import { h } from \u0026#34;vue\u0026#34; export default { setup() { return () =\u0026gt; { return h(\u0026#39;h1\u0026#39;, \u0026#39;å°šç¡…è°·\u0026#39;)} } } æ³¨æ„ï¼š ä¸è¦èˆ‡Vue2.xé…ç½®æ··ç”¨ã€‚ Vue2.xé…ç½®(dataã€methodsã€computed\u0026hellip;)ä¸­å¯ä»¥è¨ªå•åˆ°setupä¸­çš„å±¬æ€§ã€æ–¹æ³•ï¼Œä½†åœ¨setupä¸­ä¸èƒ½è¨ªå•åˆ°Vue2.xé…ç½®(dataã€methodsã€computed\u0026hellip;)ã€‚ å¦‚æœæœ‰é‡åï¼Œsetupå„ªå…ˆã€‚ setup ä¸èƒ½æ˜¯ä¸€å€‹ async å‡½æ•¸ï¼Œå› ç‚ºè¿”å›å€¼ä¸å†æ˜¯ return çš„å°è±¡ï¼Œè€Œæ˜¯ä¸€å€‹ promiseï¼Œæ¨¡æ¿çœ‹ä¸åˆ° return å°è±¡ä¸­çš„å±¬æ€§ï¼›å¾ŒæœŸå¯ä»¥è¿”å›ä¸€å€‹ Promise å¯¦ä¾‹ï¼Œä½†éœ€è¦ Suspense èˆ‡ ç•°æ­¥çµ„ä»¶(å‹•æ…‹çµ„ä»¶) çš„é…åˆï¼šé»æˆ‘å‰å¾€ Suspense ref å‡½æ•¸ ä½œç”¨ï¼šå®šç¾©ä¸€å€‹éŸ¿æ‡‰å¼çš„æ•¸æ“šã€‚ èªæ³•ï¼š 1 const xxx = ref(initValue) å°‡æ•¸æ“šåŠ å·¥æˆä¸€å€‹ RefImpl (Reference: å¼•ç”¨ï¼›Implete: å¯¦ç¾) = (å¼•ç”¨å¯¦ç¾çš„å¯¦ä¾‹å°è±¡)ã€‚ js ä¸­æ“ä½œæ•¸æ“šï¼šxxx.valueã€‚ æ¨¡æ¿ä¸­è®€å–æ•¸æ“šï¼š\u0026lt;div\u0026gt;{{xxx}}\u0026lt;/div\u0026gt; å‚™è¨»ï¼š æ¥æ”¶çš„æ•¸æ“šå¯ä»¥æ˜¯åŸºæœ¬é¡å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å°è±¡é¡å‹ã€‚ åŸºæœ¬é¡å‹çš„æ•¸æ“šï¼šéŸ¿æ‡‰å¼ä¾ç„¶æ˜¯é  Object.defineProperty() çš„ get èˆ‡ set å®Œæˆçš„ã€‚ å°è±¡é¡å‹çš„æ•¸æ“šï¼šå…§éƒ¨æ±‚åŠ©äº† Vue3.0 ä¸­çš„ä¸€å€‹æ–°å‡½æ•¸\u0026mdash;- reactive reactive å‡½æ•¸ ä½œç”¨ï¼šå®šç¾©ä¸€å€‹å°è±¡é¡å‹çš„éŸ¿æ‡‰å¼æ•¸æ“š(åŸºæœ¬é¡å‹åˆ¥ç”¨ä»–ï¼Œç”¨refå‡½æ•¸)ã€‚ èªæ³•ï¼š 1 2 3 4 const xxx = reactive({ name: \u0026#34;æ¸¬è©¦\u0026#34;, age: 18 }) æ¥æ”¶ä¸€å€‹å°è±¡æˆ–æ•¸çµ„ï¼Œè¿”å›ä¸€å€‹ä»£ç†å°è±¡(Proxyå°è±¡)ã€‚ reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šæ˜¯æ·±å±¤æ¬¡çš„ã€‚ å…§éƒ¨åŸºæ–¼ ES6 çš„ Proxy å¯¦ç¾ï¼Œé€šéä»£ç†å°è±¡æ“ä½œæºå°è±¡å…§éƒ¨æ•¸æ“šéƒ½æ˜¯éŸ¿æ‡‰å¼çš„ï¼Œä¸¦é€šé Reflect æ“ä½œæºå°è±¡å…§éƒ¨çš„æ•¸æ“šã€‚ jsã€æ¨¡æ¿ä¸­æ“ä½œæ•¸æ“šå‡ä¸éœ€è¦ .value Vue 2.0 ä¸­çš„éŸ¿æ‡‰å¼åŸç† å¯¦ç¾åŸç†ï¼š å°è±¡é¡å‹ï¼šé€šé Object.defineProperty() å°å±¬æ€§çš„è®€å–ã€ä¿®æ”¹é€²è¡Œæ””æˆª(æ•¸æ“šåŠ«æŒ)ã€‚ æ•¸çµ„é¡å‹ï¼šé€šéé‡å¯«æ›´æ–°æ•¸çµ„çš„ä¸€ç³»åˆ—æ–¹å¼ä¾†å¯¦ç¾æ””æˆªã€‚(å°æ•¸çµ„çš„è®Šæ›´æ–¹æ³•é€²è¡Œäº†åŒ…è£¹)ã€‚ 1 2 3 4 5 6 7 8 Object.defineProperty(data, \u0026#34;count\u0026#34;, { get() { }, set() { } }) åŸç†æ¨¡æ“¬ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 let person = { name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18 } // æ¨¡æ“¬ Vue2 ä¸­å¯¦ç¾éŸ¿æ‡‰å¼ let p = {} Object.defineProperty(p, \u0026#34;name\u0026#34;, { configurable: true, // å…è¨±åˆªé™¤ï¼Œä½†æ•ç²ä¸åˆ° get() { // æœ‰äººè®€å– name æ™‚èª¿ç”¨ return person.name }, set(value) { console.log(\u0026#34;æœ‰äººä¿®æ”¹äº† name å±¬æ€§ï¼Œæˆ‘ç™¼ç¾äº†ã„›ï¼Œæˆ‘è¦å»æ›´æ–°ä»‹é¢ï¼\u0026#34;) person.name = value } }) Object.defineProperty(p, \u0026#34;age\u0026#34;, { configurable: true, // å…è¨±åˆªé™¤ï¼Œä½†æ•ç²ä¸åˆ° get() { // æœ‰äººè®€å– age æ™‚èª¿ç”¨ return person.age }, set(value) { console.log(\u0026#34;æœ‰äººä¿®æ”¹äº† age å±¬æ€§ï¼Œæˆ‘ç™¼ç¾äº†ã„›ï¼Œæˆ‘è¦å»æ›´æ–°ä»‹é¢ï¼\u0026#34;) person.age = value } }) å­˜åœ¨å•é¡Œï¼š æ–°å¢å±¬æ€§ã€åˆªé™¤å±¬æ€§ï¼Œä»‹é¢ä¸æœƒæ›´æ–°ï¼Œéœ€ä½¿ç”¨ $setã€$deleteã€‚ ç›´æ¥é€šéä¸‹æ¨™ä¿®æ”¹æ•¸çµ„ï¼Œä»‹é¢ä¸æœƒæ›´æ–°ï¼Œéœ€ä½¿ç”¨ $setã€$deleteã€‚ å•é¡Œæƒ…æ³æ¼”ç¤ºï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 export default { data() { return { person: { name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, hobby: [\u0026#34;å­¸ç¿’\u0026#34;, \u0026#34;åƒé£¯\u0026#34;] } } }, methods: { addSex() { this.person.sex = \u0026#34;å¥³\u0026#34; // æ­¤æ™‚ç•«é¢ä¸æœƒæ›´æ–° this.$set(this.person, \u0026#34;sex\u0026#34;, \u0026#34;å¥³\u0026#34;) // éœ€ä½¿ç”¨ $set ç•«é¢æ‰æœƒæ›´æ–° // æˆ–æ˜¯ä½¿ç”¨ Vue.set() // Vue.set(this.person, \u0026#34;sex\u0026#34;, \u0026#34;å¥³\u0026#34;) }, deleteName() { delete this.person.name // æ­¤æ™‚ç•«é¢ä¸æœƒæ›´æ–° this.$delete(this.person, \u0026#34;name\u0026#34;) // éœ€ä½¿ç”¨ $delete ç•«é¢æ‰æœƒæ›´æ–° // æˆ–æ˜¯ä½¿ç”¨ Vue.delete() // Vue.delete(this.person, \u0026#34;name\u0026#34;) }, updateHobby() { this.person.hobby[0] = \u0026#34;é€›è¡—\u0026#34; // æ­¤æ™‚ç•«é¢ä¸æœƒæ›´æ–° this.$set(this.person.hobby, 0, \u0026#34;é€›è¡—\u0026#34;) // éœ€ä½¿ç”¨ $set ç•«é¢æ‰æœƒæ›´æ–° // æˆ–æ˜¯ä½¿ç”¨ splice() // this.person.hobby.splice(0, 1, \u0026#34;é€›è¡—\u0026#34;) } } } Vue 3.0 ä¸­çš„éŸ¿æ‡‰å¼åŸç† å¯¦ç¾åŸç†ï¼š é€šé Proxy(ä»£ç†)ï¼šæ””æˆªå°è±¡ä¸­ä»»æ„å±¬æ€§çš„è®ŠåŒ–ï¼ŒåŒ…å«å±¬æ€§å€¼çš„è®€å¯«ã€å±¬æ€§çš„æ–°å¢ã€å±¬æ€§çš„åˆªé™¤ç­‰ã€‚ é€šé Reflect(åå°„)ï¼šå°è¢«ä»£ç†å°è±¡çš„å±¬æ€§é€²è¡Œæ“ä½œã€‚ åŸç†æ¨¡æ“¬ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 let person = { name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18 } // æ¨¡æ“¬ Vue3 ä¸­å¯¦ç¾éŸ¿æ‡‰å¼ const p = new Proxy(person, { // æœ‰äººè®€å–pçš„æŸå€‹å±¬æ€§æ™‚èª¿ç”¨ get(target, propName) { console.log(`æœ‰äººè®€å–äº†pèº«ä¸Šçš„${propName}å±¬æ€§`) return Reflect.get(target, propName) }, // æœ‰äººæ–°å¢æˆ–ä¿®æ”¹pçš„æŸå€‹å±¬æ€§æ™‚èª¿ç”¨ set(target, propName, value) { console.log(`æœ‰äººä¿®æ”¹äº†pèº«ä¸Šçš„${propName}å±¬æ€§ï¼Œæˆ‘è¦å»æ›´æ–°ä»‹é¢äº†ï¼`) Reflect.set(target, propName, value) }, // æœ‰äººåˆªé™¤pçš„æŸå€‹å±¬æ€§æ™‚èª¿ç”¨ deleteProperty(target, propName) { console.log(`æœ‰äººåˆªé™¤äº†pèº«ä¸Šçš„${propName}å±¬æ€§ï¼Œæˆ‘è¦å»æ›´æ–°ä»‹é¢äº†ï¼`) return Reflect.deleteProperty(target, propName) } }) setup çš„å…©å€‹æ³¨æ„é» setup åŸ·è¡Œçš„æ™‚æ©Ÿï¼šåœ¨ beforeCreate ä¹‹å‰åŸ·è¡Œä¸€æ¬¡ï¼Œthis æ˜¯ undefinedã€‚ setup çš„åƒæ•¸ propsï¼šå€¼ç‚ºå°è±¡ï¼ŒåŒ…å«ï¼šçµ„ä»¶å¤–éƒ¨å‚³ééä¾†ï¼Œä¸”çµ„ä»¶å…§éƒ¨è²æ˜æ¥æ”¶äº†çš„å±¬æ€§ã€‚ contextï¼šä¸Šä¸‹æ–‡å°è±¡ï¼š attrsï¼šå€¼ç‚ºå°è±¡ï¼ŒåŒ…å«ï¼šçµ„ä»¶å¤–éƒ¨å‚³ééä¾†ï¼Œä½†æ²’æœ‰åœ¨ props é…ç½®ä¸­è²æ˜çš„å±¬æ€§ï¼Œç›¸ç•¶æ–¼ Vue 2.0 çš„ this.$attrsã€‚ slotsï¼šæ¥æ”¶çš„æ’æ§½å…§å®¹ï¼Œç›¸ç•¶æ–¼ Vue 2.0 çš„ this.$slotsã€‚ emitï¼šåˆ†ç™¼è‡ªå®šç¾©äº‹ä»¶çš„å‡½æ•¸ï¼Œç›¸ç•¶æ–¼ Vue 2.0 çš„ this.$emitã€‚ watch å‡½æ•¸ èˆ‡ Vue 2.0 ä¸­çš„ watch é…ç½®åŠŸèƒ½ä¸€è‡´ã€‚ å…©å€‹å°\u0026quot;å‘\u0026quot;ï¼š ç›£è¦– ref å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šæ™‚ï¼Œä¸éœ€åŠ  .valueã€‚ ç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šæ™‚ï¼ŒoldValue ç„¡æ³•æ­£ç¢ºæ•ç²ã€å¼·åˆ¶é–‹å•Ÿäº†æ·±åº¦ç›£è¦–(deepé…ç½®å¤±æ•ˆ)ã€‚ ç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šä¸­çš„æŸå€‹å±¬æ€§æ™‚ï¼Œdeep é…ç½®æœ‰æ•ˆã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 import { ref, reactive, watch } from \u0026#34;vue\u0026#34; export default { setup() { const sum = ref(10) const msg = ref(\u0026#34;æ¸¬è©¦\u0026#34;) const person = reactive({ name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, job: { job1: { salary: 20 } } }) // æƒ…æ³ä¸€ï¼šç›£è¦– ref å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“š watch(sum, (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;sumè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true }) // æƒ…æ³äºŒï¼šåŒæ™‚ç›£è¦–å¤šå€‹ ref å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“š watch([sum, msg], (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;sumæˆ–msgè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true }) /* * æƒ…æ³ä¸‰ï¼šç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šçš„å…¨éƒ¨å±¬æ€§ * 1. æ³¨æ„: æ­¤æ•¸ç„¡æ³•æ­£ç¢ºçš„ç²å– oldValue * 2. æ³¨æ„: å¼·åˆ¶é–‹å•Ÿäº†æ·±åº¦ç›£è¦–(deepé…ç½®ç„¡æ•ˆ) */ watch(person, (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;personè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true, deep: false }) // æ­¤è™•çš„ deep é…ç½®ç„¡æ•ˆ // æƒ…æ³å››ï¼šç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šçš„æŸå€‹å±¬æ€§ watch(() =\u0026gt; person.name, (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;personçš„nameè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true }) // æƒ…æ³äº”ï¼šç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šçš„æŸäº›å±¬æ€§ watch([() =\u0026gt; person.name, () =\u0026gt; person.age], (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;personçš„nameæˆ–ageè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true }) // ç‰¹æ®Šæƒ…æ³ï¼šç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šçš„æŸäº›å°è±¡å±¬æ€§ watch(() =\u0026gt; person.job, (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;personçš„jobè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true, deep: true }) // æ­¤è™•ç”±æ–¼ç›£è¦–çš„æ˜¯ reactive æ‰€å®šç¾©çš„å°è±¡ä¸­çš„æŸå€‹å±¬æ€§ï¼Œæ‰€ä»¥ deep é…ç½®æœ‰æ•ˆ return { sum, msg } } } watch æ™‚ value çš„å•é¡Œ è‹¥ç›£è¦–çš„æ•¸æ“šç‚º ref æ±‚åŠ© reactive ç”Ÿæˆçš„éŸ¿æ‡‰å¼æ•¸æ“šï¼Œå‰‡å¯ä½¿ç”¨ä»¥ä¸‹å…©ç¨®æ–¹å¼é€²è¡Œç›£è¦–ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 import { ref, watch } from \u0026#34;vue\u0026#34; export default { setup() { const sum = ref(0) const person = ref({ name: \u0026#34;å¼µä¸‰\u0026#34;, name: 18, job: { job1: { salary: 20 } } }) watch(sum, (newValue, oldValue) =\u0026gt; { // ç›£è¦–çš„æ˜¯ sum é€™å€‹ RefImpl æ•¸æ“šï¼Œå› æ­¤ä¸éœ€è¦ .value console.log(\u0026#34;sumçš„å€¼è®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }) // æ–¹æ³•ä¸€: watch(person.value, (newValue, oldValue) =\u0026gt; { // ç›£è¦– person.value çš„ Proxy å°è±¡ console.log(\u0026#34;personçš„å€¼è®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }) // æ–¹æ³•äºŒ: watch(person, (newValue, oldValue) =\u0026gt; { // æ·±åº¦ç›£è¦– person çš„ Proxy å°è±¡çš„å±¬æ€§ console.log(\u0026#34;personçš„å€¼è®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { deep: true }) return { person } } } watchEffect æ™ºèƒ½ç‰ˆ watchï¼Œä¸ç”¨æŒ‡åç›£è¦–å“ªå€‹å±¬æ€§ï¼Œç›£è¦–çš„å›èª¿ä¸­ç”¨åˆ°å“ªå€‹å±¬æ€§ï¼Œå°±ç›£è¦–å“ªå€‹å±¬æ€§(è€Œä¸”æ˜¯æ·±å±¤æ¬¡çš„)ã€‚ watchEffect æœ‰é»åƒ computedï¼š ä½† computed æ³¨é‡è¨ˆç®—å‡ºä¾†çš„å€¼(å›èª¿å‡½æ•¸çš„è¿”å›å€¼)ï¼Œæ‰€ä»¥å¿…é ˆè¦å¯«è¿”å›å€¼ã€‚ è€Œ watchEffect æ›´æ³¨é‡çš„æ˜¯éç¨‹(å›èª¿å‡½æ•¸çš„å‡½æ•¸é«”)ï¼Œæ‰€ä»¥ä¸ç”¨å¯«è¿”å›å€¼ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 import { ref, reactive, watchEffect } from \u0026#34;vue\u0026#34; export default { setup() { const sum = ref(0) const person = reactive({ name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, job: { job1: { salary: 20 } } }) watchEffect(() =\u0026gt; { const x1 = sum.value const x2 = person.job.job1.salary console.log(\u0026#34;watchEffect é…ç½®çš„å›èª¿åŸ·è¡Œäº†\u0026#34;) }) } } è‡ªå®šç¾© hook å‡½æ•¸ hook æœ¬è³ªæ˜¯ä¸€å€‹å‡½æ•¸ï¼ŒæŠŠ setup å‡½æ•¸ä¸­ä½¿ç”¨çš„ Composition API é€²è¡Œäº†å°è£ã€‚ é¡ä¼¼æ–¼ vue 2.0 ä¸­çš„ mixinã€‚ è‡ªå®šç¾© hook çš„å„ªå‹¢ï¼šé‡è¤‡ä½¿ç”¨ä»£ç¢¼ï¼Œè®“ setup ä¸­çš„é‚è¼¯æ›´æ¸…æ¥šæ˜“æ‡‚ã€‚ å‘½åé€šå¸¸å»ºè­°ä»¥ \u0026ldquo;use\u0026rdquo; é–‹é ­ï¼Œä¾‹å¦‚ï¼š ä¸€å€‹ç²å–é¼ æ¨™é»æ“Šä½ç½®çš„ hook src/hooks/usePoint.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import { reactive, onMounted, onBeforeUnmount} from \u0026#34;vue\u0026#34; export default function() { // ç²å–é¼ æ¨™é»æ“Šä½ç½® ç›¸é—œçš„æ•¸æ“š let point = reactive({ x: 0, y: 0 }) // ç²å–é¼ æ¨™é»æ“Šä½ç½® ç›¸é—œçš„æ–¹æ³• function savePoint(event) { console.log(event.pageX, event.pageY) point.x = event.pageX point.y = event.pageY } // ç²å–é¼ æ¨™é»æ“Šä½ç½® ç›¸é—œçš„ç”Ÿå‘½é€±æœŸé‰¤å­ onMounted(() =\u0026gt; { window.addEventListener(\u0026#34;click\u0026#34;, savePoint) }) onBeforeUnmount(() =\u0026gt; { window.removeEventListener(\u0026#34;click\u0026#34;, savePoint) }) return point } Demo.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 import usePoint from \u0026#34;@/hooks/usePoint\u0026#34; export default { name: \u0026#34;Demo\u0026#34;, setup() { // ä½¿ç”¨è‡ªå®šç¾©çš„ hook const point = usePoint() return { point } } } toRef ä½œç”¨ï¼šå‰µå»ºä¸€å€‹ ref å°è±¡ï¼Œå…¶ value å€¼æŒ‡å‘(å¼•ç”¨)å¦ä¸€å€‹å°è±¡ä¸­çš„æŸå€‹å±¬æ€§(è¿”å›å€¼ç‚ºä¸€å€‹ ObjectRefImpl å°è±¡ï¼Œç‚ºéŸ¿æ‡‰å¼)ã€‚ èªæ³•ï¼š 1 const name = toRef(person, \u0026#34;name\u0026#34;) æ‡‰ç”¨ï¼šè¦å°‡éŸ¿æ‡‰å¼å°è±¡ä¸­çš„æŸå€‹å±¬æ€§å–®ç¨æä¾›çµ¦å¤–éƒ¨ä½¿ç”¨æ™‚ã€‚ æ“´å±•ï¼štoRefs èˆ‡ toRef åŠŸèƒ½ä¸€è‡´ï¼Œä½†å¯ä»¥æ‰¹é‡å‰µå»ºå¤šå€‹ ref å°è±¡ï¼Œèªæ³•ï¼š 1 toRefs(person) ä½¿ç”¨ç¯„ä¾‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 import { reactive, toRef, toRefs} from \u0026#34;vue\u0026#34; export default { setup() { let person = reactive({ name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, job: { job1: { salary: 20 } } }) const name1 = person.name // name1 åƒ…ç‚ºè³¦å€¼ï¼Œç„¡éŸ¿æ‡‰å¼ const name2 = toRef(person, \u0026#34;name\u0026#34;) // name2 çš„å€¼æœƒæŒ‡å‘(å¼•ç”¨) person çš„ name return { // errorsï¼š // name1: person.name, // åƒ…ç‚ºè³¦å€¼ï¼Œç„¡éŸ¿æ‡‰å¼ // name2: ref(person.name) // åˆå§‹å€¼æ­£å¸¸ï¼Œä½†ä¿®æ”¹æ™‚ä¸æœƒæ”¹åˆ° person çš„ nameï¼Œå› ç‚ºæ­¤å¯«æ³•åƒ…æ˜¯å°‡ \u0026#34;ref(pserson.name)\u0026#34; è³¦å€¼çµ¦ name2ï¼Œè€Œéå°‡ name2 æŒ‡å‘ person çš„ name // successï¼š // æ¨¡æ¿ä¸­ä½¿ç”¨ {{ person.name }}...ç­‰ï¼š // person, // ä¸€å€‹ä¸€å€‹çµ¦å‡ºï¼Œæ¨¡æ¿ä¸­ä½¿ç”¨ {{ name }}...ç­‰ï¼š // name: toRef(person, \u0026#34;name\u0026#34;), // age: toRef(person, \u0026#34;age\u0026#34;), // salary: toRef(person.job.job1, \u0026#34;salary\u0026#34;) // ä¸€æ¬¡å…¨çµ¦å‡ºï¼Œæ¨¡æ¿ä¸­å¯ç›´æ¥ä½¿ç”¨ {{ name }}ã€{{ age }}ã€{{ job.job1.salary }} ...toRefs(person) } } } å…¶ä»–çš„ Composition API 1. shallowReactive èˆ‡ shallowRef shallowï¼šæ·ºå±¤çš„ shallowReactiveï¼šåªè™•ç†å°è±¡æœ€å¤–å±¤å±¬æ€§çš„éŸ¿æ‡‰å¼(æ·ºéŸ¿æ‡‰å¼)ã€‚ shallowRefï¼šåªè™•ç†åŸºæœ¬æ•¸æ“šé¡å‹çš„éŸ¿æ‡‰å¼ï¼Œä¸é€²è¡Œå°è±¡çš„éŸ¿æ‡‰å¼è™•ç†ã€‚ ä»€éº¼æ™‚å€™ä½¿ç”¨ï¼Ÿ å¦‚æœæœ‰ä¸€å€‹å°è±¡æ•¸æ“šï¼Œçµæ§‹æ¯”è¼ƒæ·±ï¼Œä½†è®ŠåŒ–æ™‚åªæ˜¯å¤–å±¤å±¬æ€§è®ŠåŒ– =\u0026gt; shallowReactiveã€‚ å¦‚æœæœ‰ä¸€å€‹å°è±¡æ•¸æ“šï¼Œå¾ŒçºŒåŠŸèƒ½ä¸æœƒä¿®æ”¹è©²å°è±¡ä¸­çš„å±¬æ€§ï¼Œè€Œæ˜¯ç”Ÿæˆæ–°çš„å°è±¡ä¾†æ›¿æ› =\u0026gt; shallowRefã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 import { shallowRef, shallowReactive, toRefs} from \u0026#34;vue\u0026#34; export default { setup() { let person = shallowReactive({ // åªè€ƒæ…®ç¬¬ä¸€å±¤æ•¸æ“šçš„éŸ¿æ‡‰å¼ name: \u0026#34;å¼µä¸‰\u0026#34;, // éŸ¿æ‡‰å¼ age: 18, // éŸ¿æ‡‰å¼ job: { // ééŸ¿æ‡‰å¼ job1: { salary: 20 } } }) let x = shallowRef({ // åŸºæœ¬é¡å‹æ™‚åŒ refï¼Œä½†å°è±¡é¡å‹ä¸æ˜¯éŸ¿æ‡‰å¼(value æœƒè®Šæˆä¸€èˆ¬çš„ Object è€Œä¸æ˜¯ Proxy ) y: 0 }) return { x, ...toRefs(person) } } } 2. readonly èˆ‡ shallowReadonly readonlyï¼šè®“ä¸€å€‹éŸ¿æ‡‰å¼æ•¸æ“šè®Šç‚ºå”¯è®€çš„(æ·±å±¤å”¯è®€)ã€‚ shallowReadonlyï¼šè®“ä¸€å€‹éŸ¿æ‡‰å¼æ•¸æ“šè®Šç‚ºå”¯è®€çš„(æ·ºå±¤å”¯è®€)ã€‚ æ‡‰ç”¨å ´æ™¯ï¼šä¸å¸Œæœ›æ•¸æ“šè¢«ä¿®æ”¹æ™‚ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 import { ref, reactive, toRefs, readonly, shallowReadonly} from \u0026#34;vue\u0026#34; export default { setup() { let sum = ref(0) let person = reactive({ name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, job: { job1: { salary: 20 } } }) // å°‡ sum è®Šç‚ºå”¯è®€ï¼Œä¿è­·æ•¸æ“šä¸è¢«ä¿®æ”¹ sum = readonly(sum) // å°‡ person çš„æ‰€æœ‰å±¬æ€§è®Šç‚ºå”¯è®€ï¼Œä¿è­·æ‰€æœ‰å±¬æ€§æ•¸æ“šä¸è¢«ä¿®æ”¹ person = readonly(person) // å°‡ person çš„\u0026#34;ç¬¬ä¸€å±¤å±¬æ€§æ•¸æ“š\u0026#34;è®Šç‚ºå”¯è®€(nameã€ageç„¡æ³•ä¿®æ”¹ï¼Œä½† job å¯ä»¥) person = shallowReadonly(person) return { sum, ...toRefs(person) } } } toRaw èˆ‡ markRaw rawï¼šåŸå§‹ã€‚ toRawï¼š ä½œç”¨ï¼šå°‡ä¸€å€‹ç”± reactive ç”Ÿæˆçš„éŸ¿æ‡‰å¼å°è±¡è½‰ç‚ºæ™®é€šå°è±¡ã€‚ æ‡‰ç”¨å ´æ™¯ï¼šç”¨æ–¼è®€å–éŸ¿æ‡‰å¼å°è±¡å°æ‡‰çš„æ™®é€šå°è±¡ï¼Œå°é€™å€‹æ™®é€šå°è±¡çš„æ‰€æœ‰æ“ä½œï¼Œä¸æœƒå¼•èµ·é é¢æ›´æ–°ã€‚ markRawï¼š ä½œç”¨ï¼šæ¨™è¨˜ä¸€å€‹å°è±¡ï¼Œä½¿å…¶æ°¸é ä¸æœƒå†æˆç‚ºéŸ¿æ‡‰å¼å°è±¡ã€‚ æ‡‰ç”¨å ´æ™¯ï¼š æœ‰äº›å€¼ä¸æ‡‰è¢«è¨­ç½®ç‚ºéŸ¿æ‡‰å¼çš„ï¼Œä¾‹å¦‚è¤‡é›œçš„ç¬¬ä¸‰æ–¹é¡åº«ç­‰ã€‚ ç•¶æ¸²æŸ“å…·æœ‰ä¸å¯è®Šæ•¸æ“šæºçš„å¤§åˆ—è¡¨æ™‚ï¼Œè·³ééŸ¿æ‡‰å¼è½‰æ›å¯ä»¥æé«˜æ€§èƒ½ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 import { ref, reactive, toRaw, markRaw} from \u0026#34;vue\u0026#34; export default { setup() { let sum = ref(0) let person = reactive({ name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, job: { job1: { salary: 20 } } }) function showRawPerson() { const p = toRaw(person) console.log(p) // è¿”å›çš„ä¸å†æ˜¯ Proxyï¼Œè€Œæ˜¯ Object } function addCar() { let car = { name: \u0026#34;å¥”é¦³\u0026#34;, price: 40} person.car = markRaw(car) // æ¨™è¨˜ person.car ä¸æ˜¯éŸ¿æ‡‰å¼çš„æ•¸æ“š(æ•¸æ“šä¾èˆŠå¯ä¿®æ”¹ï¼Œä½†ç•«é¢ä¸æœƒè®Š) } return { sum, ...toRefs(person), showRawPerson, addCar } } } customRef ä½œç”¨ï¼šå‰µå»ºä¸€å€‹è‡ªå®šç¾©çš„ refï¼Œä¸¦å°å…¶ä¾è³´é …è·Ÿè¹¤å’Œæ›´æ–°è§¸ç™¼é€²è¡Œé¡¯ç¤ºæ§åˆ¶ã€‚ å¯¦ç¾é˜²æŠ–æ•ˆæœï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 \u0026lt;template\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; v-model=\u0026#34;keyWord\u0026#34; /\u0026gt; \u0026lt;h3\u0026gt; {{ keyWord }} \u0026lt;/h3\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; import { ref, customRef } from \u0026#34;vue\u0026#34; export default { setup() { // ä½¿ç”¨ vue æä¾›çš„ ref // let keyWord = ref(\u0026#34;hello\u0026#34;) // è‡ªå®šç¾©çš„ä¸€å€‹ ref function myRef(value, delay) { let timer return customRef((track, trigger) =\u0026gt; { return { get() { console.log(`æœ‰äººå¾ myRef é€™å€‹å®¹å™¨ä¸­è®€å–æ•¸æ“šäº†ï¼Œæˆ‘æŠŠ${value}çµ¦ä»–äº†`) track() // é€šçŸ¥ Vue è¿½è¹¤æ•¸æ“šçš„è®ŠåŒ–(æå‰èˆ‡ get å•†é‡ä¸€ä¸‹ï¼Œè®“å®ƒèªç‚ºé€™å€‹ value æ˜¯æœ‰ç”¨çš„) return value }, set(newValue) { console.log(`æœ‰äººæŠŠ myRef é€™å€‹å®¹å™¨ä¸­çš„æ•¸æ“šæ”¹ç‚ºäº†${newValue}`) clearTimeout(timer) timer = setTimeout(() =\u0026gt; { value = newValue trigger() // é€šçŸ¥ Vue å»é‡æ–°è§£ææ¨¡æ¿ï¼Œä»¥ä¾¿è§¸ç™¼ get }, delay) } } }) } // ä½¿ç”¨è‡ªå®šç¾©çš„é˜²æŠ– ref let keyWord = myRef(\u0026#34;hello\u0026#34;, 500) return { keyWord } } } \u0026lt;/script\u0026gt; provide èˆ‡ inject ä½œç”¨ï¼šå¯¦ç¾ç¥–å­«çµ„ä»¶é–“é€šä¿¡ã€‚ å¥—è·¯ï¼šçˆ¶çµ„ä»¶æœ‰ä¸€å€‹ provide é¸é …ä¾†æä¾›æ•¸æ“šï¼Œå¾Œä»£çµ„ä»¶æœ‰ä¸€å€‹ inject é¸é …ä¾†é–‹å§‹ä½¿ç”¨é€™äº›æ•¸æ“šã€‚ å…·é«”å¯«æ³•ï¼š 1. ç¥–çµ„ä»¶ä¸­ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 import { reactive, toRefs, provide } from \u0026#34;vue\u0026#34; export default { name: \u0026#34;App\u0026#34;, setup() { let car = reactive({ name: \u0026#34;å¥”é¦³\u0026#34;, price: \u0026#34;40W\u0026#34; }) provide(\u0026#34;car\u0026#34;, car) // çµ¦è‡ªå·±çš„å¾Œä»£çµ„ä»¶å‚³éæ•¸æ“š return { ...toRefs(car) } } } 2. å¾Œä»£çµ„ä»¶ä¸­ï¼š 1 2 3 4 5 6 7 8 9 import { inject } from \u0026#34;vue\u0026#34; export default { name: \u0026#34;Son\u0026#34;, setup() { let car = inject(\u0026#34;car\u0026#34;) console.log(car) return { car } } } éŸ¿æ‡‰å¼æ•¸æ“šçš„åˆ¤æ–· isRefï¼šæª¢æŸ¥ä¸€å€‹å€¼æ˜¯å¦ç‚ºä¸€å€‹ ref å°è±¡ã€‚ isReactiveï¼šæª¢æŸ¥ä¸€å€‹å°è±¡æ˜¯å¦æ˜¯ç”± reactive å‰µå»ºçš„éŸ¿æ‡‰å¼ä»£ç†ã€‚ isReadonlyï¼šæª¢æŸ¥ä¸€å€‹å°è±¡æ˜¯å¦æ˜¯ç”± readonly å‰µå»ºçš„å”¯è®€ä»£ç†ã€‚ isProxyï¼šæª¢æŸ¥ä¸€å€‹å°è±¡æ˜¯å¦æ˜¯ç”± reactive æˆ–æ˜¯ readonly æ–¹æ³•å‰µå»ºçš„ä»£ç†ã€‚ Teleport teleportï¼šå‚³é€ã€ç¬é–“ç§»å‹•ã€‚ ä½œç”¨ï¼šèƒ½å¤ å°‡æˆ‘å€‘çš„ çµ„ä»¶ html çµæ§‹ ç§»å‹•åˆ°æŒ‡å®šçš„ä½ç½®ã€‚ å…·é«”å¯«æ³•ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;teleport to=\u0026#34;body\u0026#34;\u0026gt; \u0026lt;!-- to ä¹Ÿèƒ½å¯« css selectï¼Œä¾‹å¦‚ to=\u0026#34;#app\u0026#34; --\u0026gt; \u0026lt;div v-if=\u0026#34;isShow\u0026#34; class=\u0026#34;mask\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;dialog\u0026#34;\u0026gt; \u0026lt;h3\u0026gt; æˆ‘æ˜¯ä¸€å€‹å½ˆçª— \u0026lt;/h3\u0026gt; \u0026lt;button @click=\u0026#34;isShow = false\u0026#34;\u0026gt; é—œé–‰å½ˆçª— \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/teleport\u0026gt; Suspense suspenseï¼šæ‡¸ç–‘ã€æ‡¸è€Œæœªæ±ºçš„ã€‚ ä½œç”¨ï¼šç­‰å¾…ç•°æ­¥çµ„ä»¶æ™‚ï¼Œæ¸²æŸ“ä¸€äº›é¡å¤–å…§å®¹ï¼Œè®“ä½¿ç”¨è€…æœ‰æ›´å¥½çš„ç”¨æˆ¶é«”é©—ã€‚ ä½¿ç”¨æ­¥é©Ÿï¼š ç•°æ­¥å¼•ç”¨çµ„ä»¶ 1 2 import { defineAsyncComponent } from \u0026#34;vue\u0026#34; // å®£å‘Šç•°æ­¥çµ„ä»¶æ™‚ä½¿ç”¨ const Child = defineAsyncComponent(() =\u0026gt;. import (\u0026#34;./components/Child.vue\u0026#34;)) ä½¿ç”¨ Suspense åŒ…è£¹çµ„ä»¶ï¼Œä¸¦é…ç½®å¥½ default èˆ‡ fallback 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;template\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;æˆ‘æ˜¯Appçµ„ä»¶\u0026lt;/h3\u0026gt; \u0026lt;Suspense\u0026gt; \u0026lt;template v-slot:default\u0026gt; \u0026lt;Child /\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;template v-slot:fallback\u0026gt; \u0026lt;h3\u0026gt;åŠ è¼‰ä¸­......\u0026lt;/h3\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;/Suspense\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; å…¨å±€ API çš„è½‰ç§» Vue 2.0 æœ‰è¨±å¤šå…¨å±€ API å’Œé…ç½®ã€‚ ä¾‹å¦‚ï¼šè¨»å†Šå…¨å±€çµ„ä»¶ã€è¨»å†Šå…¨å±€æŒ‡ä»¤ç­‰ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 // è¨»å†Šå…¨å±€çµ„ä»¶ Vue.component(\u0026#34;MyButton\u0026#34;, { data() { return { count: 0 } }, template: \u0026#34;\u0026lt;button @click=\u0026#39;count++\u0026#39;\u0026gt;Clicked {{ count }}\u0026lt;/button\u0026gt;\u0026#34; }) // è¨»å†Šå…¨å±€æŒ‡ä»¤ Vue.directive(\u0026#34;focus\u0026#34;, { inserted: el =\u0026gt; el.focus() }) Vue 3.0 ä¸­å°é€™äº› API åšå‡ºäº†èª¿æ•´ï¼š å°‡å…¨å±€çš„ APIï¼Œå³ï¼š Vue.xxx èª¿æ•´åˆ°æ‡‰ç”¨å¯¦ä¾‹(app)ä¸Š 2.0 å…¨å±€ API(Vue) 3.0 å¯¦ä¾‹ API(app) Vue.config.xxxx app.config.xxxx Vue.config.productionTip ç§»é™¤ Vue.component app.component Vue.directive app.directive Vue.mixin app.mixin Vue.use app.use Vue.prototype app.config.globalProperties ","date":"2022-07-17T00:00:00Z","image":"https://wjdesign.github.io/hugo-blog-wayne/p/%E5%B0%9A%E7%A1%85%E8%B0%B7-vue3-%E8%A6%96%E9%A0%BB%E7%AD%86%E8%A8%98/143400003_253834612811965_4864474600445741482_n_huc185496ed55e6f95ddd80689badb475a_232407_120x120_fill_q75_box_smart1.jpeg","permalink":"https://wjdesign.github.io/hugo-blog-wayne/p/%E5%B0%9A%E7%A1%85%E8%B0%B7-vue3-%E8%A6%96%E9%A0%BB%E7%AD%86%E8%A8%98/","title":"å°šç¡…è°· Vue3 è¦–é »ç­†è¨˜"},{"content":"Markdown æ˜¯è®“ä½ å¿«é€Ÿæ’°å¯«ç­†è¨˜ï¼Œæµæš¢ç®¡ç†çŸ¥è­˜ï¼Œæ”¯æ´å¤šç¨®è¡ç”ŸåŠŸèƒ½çš„ç”Ÿç”¢åŠ›å·¥å…·\næ¨™é¡Œ ç•¶æ‚¨æƒ³è¦å°‡ä¸€æ®µæ–‡å­—æ¨™ç¤ºç‚ºæ¨™é¡Œçš„æ™‚å€™ï¼Œè«‹ä½¿ç”¨é€™å€‹èªæ³•ã€‚\nè«‹åœ¨è¡Œé¦–è¼¸å…¥ # ç¬¦è™Ÿï¼Œä¸¦åœ¨å¾Œé¢åŠ ä¸Šä¸€å€‹ç©ºç™½å¾Œï¼Œå†è¼¸å…¥æ¨™é¡Œæ–‡å­—ã€‚\næ¨™é¡Œæœ‰åˆ†æˆ 6 å€‹å±¤ç´šï¼Œ# çš„æ•¸é‡æ„ˆå¤šï¼Œå±¤ç´šè¶Šä½ã€‚\n1 2 3 4 5 6 # ç¬¬ä¸€å±¤ç´šæ¨™é¡Œ h1 ## ç¬¬äºŒå±¤ç´šæ¨™é¡Œ h2 ### ç¬¬ä¸‰å±¤ç´šæ¨™é¡Œ h3 #### ç¬¬å››å±¤ç´šæ¨™é¡Œ h4 ##### ç¬¬äº”å±¤ç´šæ¨™é¡Œ h5 ###### ç¬¬å…­å±¤ç´šæ¨™é¡Œ h6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Diff code block 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL+ALT+Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nHyperlinked image The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2022-07-16T00:00:00Z","image":"https://wjdesign.github.io/hugo-blog-wayne/p/markdown-%E8%AA%9E%E6%B3%95%E6%8C%87%E5%8D%97/pawel-czerwinski-8uZPynIu-rQ-unsplash_hud7e36f7e20e71be184458283bdae4646_55974_120x120_fill_q75_box_smart1.jpg","permalink":"https://wjdesign.github.io/hugo-blog-wayne/p/markdown-%E8%AA%9E%E6%B3%95%E6%8C%87%E5%8D%97/","title":"Markdown èªæ³•æŒ‡å—"},{"content":"Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.\nIn this example we will be using KaTeX\nCreate a partial under /layouts/partials/math.html Within this partial reference the Auto-render Extension or host these scripts locally. Include the partial in your templates like so: 1 2 3 {{ if or .Params.math .Site.Params.math }} {{ partial \u0026#34;math.html\u0026#34; . }} {{ end }} To enable KaTex globally set the parameter math to true in a project\u0026rsquo;s configuration To enable KaTex on a per page basis include the parameter math: true in content files Note: Use the online reference of Supported TeX Functions\nExamples Block math: $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$\n","date":"2019-03-08T00:00:00Z","permalink":"https://wjdesign.github.io/hugo-blog-wayne/p/math-typesetting/","title":"Math Typesetting"},{"content":"Emoji can be enabled in a Hugo project in a number of ways.\nThe emojify function can be called directly in templates or Inline Shortcodes.\nTo enable emoji globally, set enableEmoji to true in your site\u0026rsquo;s configuration and then you can type emoji shorthand codes directly in content files; e.g.\nğŸ™ˆ :see_no_evil: ğŸ™‰ :hear_no_evil: ğŸ™Š :speak_no_evil:\nThe Emoji cheat sheet is a useful reference for emoji shorthand codes.\nN.B. The above steps enable Unicode Standard emoji characters and sequences in Hugo, however the rendering of these glyphs depends on the browser and the platform. To style the emoji you can either use a third party emoji font or a font stack; e.g.\n1 2 3 .emoji { font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols; } ","date":"2019-03-05T00:00:00Z","image":"https://wjdesign.github.io/hugo-blog-wayne/p/emoji-support/the-creative-exchange-d2zvqp3fpro-unsplash_huf941de4769045cdfa8c9ee7036519a2a_35369_120x120_fill_q75_box_smart1.jpg","permalink":"https://wjdesign.github.io/hugo-blog-wayne/p/emoji-support/","title":"Emoji Support"}]